(function(){const da=document.createElement("link").relList;if(da&&da.supports&&da.supports("modulepreload"))return;for(const V of document.querySelectorAll('link[rel="modulepreload"]'))B(V);new MutationObserver(V=>{for(const t of V)if(t.type==="childList")for(const h of t.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&B(h)}).observe(document,{childList:!0,subtree:!0});function i(V){const t={};return V.integrity&&(t.integrity=V.integrity),V.referrerPolicy&&(t.referrerPolicy=V.referrerPolicy),V.crossOrigin==="use-credentials"?t.credentials="include":V.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function B(V){if(V.ep)return;V.ep=!0;const t=i(V);fetch(V.href,t)}})();var zi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mh(Gn){return Gn&&Gn.__esModule&&Object.prototype.hasOwnProperty.call(Gn,"default")?Gn.default:Gn}function ru(Gn){throw new Error('Could not dynamically require "'+Gn+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vh={exports:{}};(function(Gn,da){(function(i){Gn.exports=i()})(function(){return function i(B,V,t){function h(e,l){if(!V[e]){if(!B[e]){var o=typeof ru=="function"&&ru;if(!l&&o)return o(e,!0);if(p)return p(e,!0);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}var n=V[e]={exports:{}};B[e][0].call(n.exports,function(s){return h(B[e][1][s]||s)},n,n.exports,i,B,V,t)}return V[e].exports}for(var p=typeof ru=="function"&&ru,u=0;u<t.length;u++)h(t[u]);return h}({1:[function(i,B,V){var t=i("../src/lib"),h={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:#fff;","X .select-outline-2":"stroke:#000;stroke-dasharray:2px 2px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var p in h){var u=p.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");t.addStyleRule(u,h[p])}},{"../src/lib":803}],2:[function(i,B,V){B.exports=i("../src/transforms/aggregate")},{"../src/transforms/aggregate":1399}],3:[function(i,B,V){B.exports=i("../src/traces/bar")},{"../src/traces/bar":949}],4:[function(i,B,V){B.exports=i("../src/traces/barpolar")},{"../src/traces/barpolar":962}],5:[function(i,B,V){B.exports=i("../src/traces/box")},{"../src/traces/box":972}],6:[function(i,B,V){B.exports=i("../src/components/calendars")},{"../src/components/calendars":664}],7:[function(i,B,V){B.exports=i("../src/traces/candlestick")},{"../src/traces/candlestick":981}],8:[function(i,B,V){B.exports=i("../src/traces/carpet")},{"../src/traces/carpet":1e3}],9:[function(i,B,V){B.exports=i("../src/traces/choropleth")},{"../src/traces/choropleth":1014}],10:[function(i,B,V){B.exports=i("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":1021}],11:[function(i,B,V){B.exports=i("../src/traces/cone")},{"../src/traces/cone":1027}],12:[function(i,B,V){B.exports=i("../src/traces/contour")},{"../src/traces/contour":1042}],13:[function(i,B,V){B.exports=i("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":1053}],14:[function(i,B,V){B.exports=i("../src/core")},{"../src/core":781}],15:[function(i,B,V){B.exports=i("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":1061}],16:[function(i,B,V){B.exports=i("../src/transforms/filter")},{"../src/transforms/filter":1400}],17:[function(i,B,V){B.exports=i("../src/traces/funnel")},{"../src/traces/funnel":1071}],18:[function(i,B,V){B.exports=i("../src/traces/funnelarea")},{"../src/traces/funnelarea":1080}],19:[function(i,B,V){B.exports=i("../src/transforms/groupby")},{"../src/transforms/groupby":1401}],20:[function(i,B,V){B.exports=i("../src/traces/heatmap")},{"../src/traces/heatmap":1093}],21:[function(i,B,V){B.exports=i("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":1103}],22:[function(i,B,V){B.exports=i("../src/traces/histogram")},{"../src/traces/histogram":1115}],23:[function(i,B,V){B.exports=i("../src/traces/histogram2d")},{"../src/traces/histogram2d":1121}],24:[function(i,B,V){B.exports=i("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":1125}],25:[function(i,B,V){B.exports=i("../src/traces/icicle")},{"../src/traces/icicle":1131}],26:[function(i,B,V){B.exports=i("../src/traces/image")},{"../src/traces/image":1144}],27:[function(i,B,V){var t=i("./core");t.register([i("./bar"),i("./box"),i("./heatmap"),i("./histogram"),i("./histogram2d"),i("./histogram2dcontour"),i("./contour"),i("./scatterternary"),i("./violin"),i("./funnel"),i("./waterfall"),i("./image"),i("./pie"),i("./sunburst"),i("./treemap"),i("./icicle"),i("./funnelarea"),i("./scatter3d"),i("./surface"),i("./isosurface"),i("./volume"),i("./mesh3d"),i("./cone"),i("./streamtube"),i("./scattergeo"),i("./choropleth"),i("./scattergl"),i("./splom"),i("./pointcloud"),i("./heatmapgl"),i("./parcoords"),i("./parcats"),i("./scattermapbox"),i("./choroplethmapbox"),i("./densitymapbox"),i("./sankey"),i("./indicator"),i("./table"),i("./carpet"),i("./scattercarpet"),i("./contourcarpet"),i("./ohlc"),i("./candlestick"),i("./scatterpolar"),i("./scatterpolargl"),i("./barpolar"),i("./aggregate"),i("./filter"),i("./groupby"),i("./sort"),i("./calendars")]),B.exports=t},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scatterternary":44,"./sort":45,"./splom":46,"./streamtube":47,"./sunburst":48,"./surface":49,"./table":50,"./treemap":51,"./violin":52,"./volume":53,"./waterfall":54}],28:[function(i,B,V){B.exports=i("../src/traces/indicator")},{"../src/traces/indicator":1152}],29:[function(i,B,V){B.exports=i("../src/traces/isosurface")},{"../src/traces/isosurface":1158}],30:[function(i,B,V){B.exports=i("../src/traces/mesh3d")},{"../src/traces/mesh3d":1163}],31:[function(i,B,V){B.exports=i("../src/traces/ohlc")},{"../src/traces/ohlc":1168}],32:[function(i,B,V){B.exports=i("../src/traces/parcats")},{"../src/traces/parcats":1177}],33:[function(i,B,V){B.exports=i("../src/traces/parcoords")},{"../src/traces/parcoords":1187}],34:[function(i,B,V){B.exports=i("../src/traces/pie")},{"../src/traces/pie":1198}],35:[function(i,B,V){B.exports=i("../src/traces/pointcloud")},{"../src/traces/pointcloud":1207}],36:[function(i,B,V){B.exports=i("../src/traces/sankey")},{"../src/traces/sankey":1213}],37:[function(i,B,V){B.exports=i("../src/traces/scatter3d")},{"../src/traces/scatter3d":1251}],38:[function(i,B,V){B.exports=i("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1258}],39:[function(i,B,V){B.exports=i("../src/traces/scattergeo")},{"../src/traces/scattergeo":1266}],40:[function(i,B,V){B.exports=i("../src/traces/scattergl")},{"../src/traces/scattergl":1279}],41:[function(i,B,V){B.exports=i("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1289}],42:[function(i,B,V){B.exports=i("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1297}],43:[function(i,B,V){B.exports=i("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1304}],44:[function(i,B,V){B.exports=i("../src/traces/scatterternary")},{"../src/traces/scatterternary":1312}],45:[function(i,B,V){B.exports=i("../src/transforms/sort")},{"../src/transforms/sort":1403}],46:[function(i,B,V){B.exports=i("../src/traces/splom")},{"../src/traces/splom":1321}],47:[function(i,B,V){B.exports=i("../src/traces/streamtube")},{"../src/traces/streamtube":1329}],48:[function(i,B,V){B.exports=i("../src/traces/sunburst")},{"../src/traces/sunburst":1337}],49:[function(i,B,V){B.exports=i("../src/traces/surface")},{"../src/traces/surface":1346}],50:[function(i,B,V){B.exports=i("../src/traces/table")},{"../src/traces/table":1354}],51:[function(i,B,V){B.exports=i("../src/traces/treemap")},{"../src/traces/treemap":1365}],52:[function(i,B,V){B.exports=i("../src/traces/violin")},{"../src/traces/violin":1378}],53:[function(i,B,V){B.exports=i("../src/traces/volume")},{"../src/traces/volume":1386}],54:[function(i,B,V){B.exports=i("../src/traces/waterfall")},{"../src/traces/waterfall":1394}],55:[function(i,B,V){B.exports=function(l){var o=(l=l||{}).eye||[0,0,1],a=l.center||[0,0,0],n=l.up||[0,1,0],s=l.distanceLimits||[0,1/0],r=l.mode||"turntable",c=t(),f=h(),d=p();return c.setDistanceLimits(s[0],s[1]),c.lookAt(0,o,a,n),f.setDistanceLimits(s[0],s[1]),f.lookAt(0,o,a,n),d.setDistanceLimits(s[0],s[1]),d.lookAt(0,o,a,n),new u({turntable:c,orbit:f,matrix:d},r)};var t=i("turntable-camera-controller"),h=i("orbit-camera-controller"),p=i("matrix-camera-controller");function u(l,o){this._controllerNames=Object.keys(l),this._controllerList=this._controllerNames.map(function(a){return l[a]}),this._mode=o,this._active=l[o],this._active||(this._mode="turntable",this._active=l.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var e=u.prototype;[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]].forEach(function(l){for(var o=l[0],a=[],n=0;n<l[1];++n)a.push("a"+n);var s="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+l[0]+"("+a.join()+")}";e[o]=Function.apply(null,a.concat(s))}),e.recalcMatrix=function(l){this._active.recalcMatrix(l)},e.getDistance=function(l){return this._active.getDistance(l)},e.getDistanceLimits=function(l){return this._active.getDistanceLimits(l)},e.lastT=function(){return this._active.lastT()},e.setMode=function(l){if(l!==this._mode){var o=this._controllerNames.indexOf(l);if(!(o<0)){var a=this._active,n=this._controllerList[o],s=Math.max(a.lastT(),n.lastT());a.recalcMatrix(s),n.setMatrix(s,a.computedMatrix),this._active=n,this._mode=l,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},e.getMode=function(){return this._mode}},{"matrix-camera-controller":468,"orbit-camera-controller":489,"turntable-camera-controller":603}],56:[function(i,B,V){(function(t,h){typeof V=="object"&&B!==void 0?h(V,i("d3-array"),i("d3-collection"),i("d3-shape"),i("elementary-circuits-directed-graph")):h(t.d3=t.d3||{},t.d3,t.d3,t.d3,null)})(this,function(t,h,p,u,e){function l(ae){return ae.target.depth}function o(ae,ie){return ae.sourceLinks.length?ae.depth:ie-1}function a(ae){return function(){return ae}}e=e&&e.hasOwnProperty("default")?e.default:e;var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae};function s(ae,ie){return c(ae.source,ie.source)||ae.index-ie.index}function r(ae,ie){return c(ae.target,ie.target)||ae.index-ie.index}function c(ae,ie){return ae.partOfCycle===ie.partOfCycle?ae.y0-ie.y0:ae.circularLinkType==="top"||ie.circularLinkType==="bottom"?-1:1}function f(ae){return ae.value}function d(ae){return(ae.y0+ae.y1)/2}function g(ae){return d(ae.source)}function m(ae){return d(ae.target)}function y(ae){return ae.index}function v(ae){return ae.nodes}function T(ae){return ae.links}function _(ae,ie){var he=ae.get(ie);if(!he)throw new Error("missing: "+ie);return he}function k(ae,ie){return ie(ae)}function E(ae,ie,he){var se=0;if(he===null){for(var de=[],ce=0;ce<ae.links.length;ce++){var ve=ae.links[ce],Ee=ve.source.index,Le=ve.target.index;de[Ee]||(de[Ee]=[]),de[Le]||(de[Le]=[]),de[Ee].indexOf(Le)===-1&&de[Ee].push(Le)}var Te=e(de);Te.sort(function(ge,ke){return ge.length-ke.length});var xe={};for(ce=0;ce<Te.length;ce++){var fe=Te[ce].slice(-2);xe[fe[0]]||(xe[fe[0]]={}),xe[fe[0]][fe[1]]=!0}ae.links.forEach(function(ge){var ke=ge.target.index,Me=ge.source.index;ke===Me||xe[Me]&&xe[Me][ke]?(ge.circular=!0,ge.circularLinkID=se,se+=1):ge.circular=!1})}else ae.links.forEach(function(ge){ge.source[he]<ge.target[he]?ge.circular=!1:(ge.circular=!0,ge.circularLinkID=se,se+=1)})}function A(ae,ie){var he=0,se=0;ae.links.forEach(function(de){de.circular&&(de.source.circularLinkType||de.target.circularLinkType?de.circularLinkType=de.source.circularLinkType?de.source.circularLinkType:de.target.circularLinkType:de.circularLinkType=he<se?"top":"bottom",de.circularLinkType=="top"?he+=1:se+=1,ae.nodes.forEach(function(ce){k(ce,ie)!=k(de.source,ie)&&k(ce,ie)!=k(de.target,ie)||(ce.circularLinkType=de.circularLinkType)}))}),ae.links.forEach(function(de){de.circular&&(de.source.circularLinkType==de.target.circularLinkType&&(de.circularLinkType=de.source.circularLinkType),re(de,ie)&&(de.circularLinkType=de.source.circularLinkType))})}function b(ae){var ie=Math.abs(ae.y1-ae.y0),he=Math.abs(ae.target.x0-ae.source.x1);return Math.atan(he/ie)}function L(ae,ie){var he=0;ae.sourceLinks.forEach(function(de){he=de.circular&&!re(de,ie)?he+1:he});var se=0;return ae.targetLinks.forEach(function(de){se=de.circular&&!re(de,ie)?se+1:se}),he+se}function w(ae){var ie=ae.source.sourceLinks,he=0;ie.forEach(function(ce){he=ce.circular?he+1:he});var se=ae.target.targetLinks,de=0;return se.forEach(function(ce){de=ce.circular?de+1:de}),!(he>1||de>1)}function C(ae,ie,he){return ae.sort(P),ae.forEach(function(se,de){var ce,ve,Ee=0;if(re(se,he)&&w(se))se.circularPathData.verticalBuffer=Ee+se.width/2;else{for(var Le=0;Le<de;Le++)if(ce=ae[de],ve=ae[Le],!(ce.source.column<ve.target.column||ce.target.column>ve.source.column)){var Te=ae[Le].circularPathData.verticalBuffer+ae[Le].width/2+ie;Ee=Te>Ee?Te:Ee}se.circularPathData.verticalBuffer=Ee+se.width/2}}),ae}function S(ae,ie,he,se){var de=h.min(ae.links,function(ce){return ce.source.y0});ae.links.forEach(function(ce){ce.circular&&(ce.circularPathData={})}),C(ae.links.filter(function(ce){return ce.circularLinkType=="top"}),ie,se),C(ae.links.filter(function(ce){return ce.circularLinkType=="bottom"}),ie,se),ae.links.forEach(function(ce){if(ce.circular){if(ce.circularPathData.arcRadius=ce.width+10,ce.circularPathData.leftNodeBuffer=5,ce.circularPathData.rightNodeBuffer=5,ce.circularPathData.sourceWidth=ce.source.x1-ce.source.x0,ce.circularPathData.sourceX=ce.source.x0+ce.circularPathData.sourceWidth,ce.circularPathData.targetX=ce.target.x0,ce.circularPathData.sourceY=ce.y0,ce.circularPathData.targetY=ce.y1,re(ce,se)&&w(ce))ce.circularPathData.leftSmallArcRadius=10+ce.width/2,ce.circularPathData.leftLargeArcRadius=10+ce.width/2,ce.circularPathData.rightSmallArcRadius=10+ce.width/2,ce.circularPathData.rightLargeArcRadius=10+ce.width/2,ce.circularLinkType=="bottom"?(ce.circularPathData.verticalFullExtent=ce.source.y1+25+ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.rightLargeArcRadius):(ce.circularPathData.verticalFullExtent=ce.source.y0-25-ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.rightLargeArcRadius);else{var ve=ce.source.column,Ee=ce.circularLinkType,Le=ae.links.filter(function(fe){return fe.source.column==ve&&fe.circularLinkType==Ee});ce.circularLinkType=="bottom"?Le.sort(F):Le.sort(z);var Te=0;Le.forEach(function(fe,ge){fe.circularLinkID==ce.circularLinkID&&(ce.circularPathData.leftSmallArcRadius=10+ce.width/2+Te,ce.circularPathData.leftLargeArcRadius=10+ce.width/2+ge*ie+Te),Te+=fe.width}),ve=ce.target.column,Le=ae.links.filter(function(fe){return fe.target.column==ve&&fe.circularLinkType==Ee}),ce.circularLinkType=="bottom"?Le.sort(W):Le.sort(q),Te=0,Le.forEach(function(fe,ge){fe.circularLinkID==ce.circularLinkID&&(ce.circularPathData.rightSmallArcRadius=10+ce.width/2+Te,ce.circularPathData.rightLargeArcRadius=10+ce.width/2+ge*ie+Te),Te+=fe.width}),ce.circularLinkType=="bottom"?(ce.circularPathData.verticalFullExtent=Math.max(he,ce.source.y1,ce.target.y1)+25+ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.rightLargeArcRadius):(ce.circularPathData.verticalFullExtent=de-25-ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.rightLargeArcRadius)}ce.circularPathData.leftInnerExtent=ce.circularPathData.sourceX+ce.circularPathData.leftNodeBuffer,ce.circularPathData.rightInnerExtent=ce.circularPathData.targetX-ce.circularPathData.rightNodeBuffer,ce.circularPathData.leftFullExtent=ce.circularPathData.sourceX+ce.circularPathData.leftLargeArcRadius+ce.circularPathData.leftNodeBuffer,ce.circularPathData.rightFullExtent=ce.circularPathData.targetX-ce.circularPathData.rightLargeArcRadius-ce.circularPathData.rightNodeBuffer}if(ce.circular)ce.path=function(fe){var ge="";return ge=fe.circularLinkType=="top"?"M"+fe.circularPathData.sourceX+" "+fe.circularPathData.sourceY+" L"+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.sourceY+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftSmallArcRadius+" 0 0 0 "+fe.circularPathData.leftFullExtent+" "+(fe.circularPathData.sourceY-fe.circularPathData.leftSmallArcRadius)+" L"+fe.circularPathData.leftFullExtent+" "+fe.circularPathData.verticalLeftInnerExtent+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftLargeArcRadius+" 0 0 0 "+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.verticalFullExtent+" L"+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.verticalFullExtent+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightLargeArcRadius+" 0 0 0 "+fe.circularPathData.rightFullExtent+" "+fe.circularPathData.verticalRightInnerExtent+" L"+fe.circularPathData.rightFullExtent+" "+(fe.circularPathData.targetY-fe.circularPathData.rightSmallArcRadius)+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightSmallArcRadius+" 0 0 0 "+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.targetY+" L"+fe.circularPathData.targetX+" "+fe.circularPathData.targetY:"M"+fe.circularPathData.sourceX+" "+fe.circularPathData.sourceY+" L"+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.sourceY+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftSmallArcRadius+" 0 0 1 "+fe.circularPathData.leftFullExtent+" "+(fe.circularPathData.sourceY+fe.circularPathData.leftSmallArcRadius)+" L"+fe.circularPathData.leftFullExtent+" "+fe.circularPathData.verticalLeftInnerExtent+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftLargeArcRadius+" 0 0 1 "+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.verticalFullExtent+" L"+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.verticalFullExtent+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightLargeArcRadius+" 0 0 1 "+fe.circularPathData.rightFullExtent+" "+fe.circularPathData.verticalRightInnerExtent+" L"+fe.circularPathData.rightFullExtent+" "+(fe.circularPathData.targetY+fe.circularPathData.rightSmallArcRadius)+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightSmallArcRadius+" 0 0 1 "+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.targetY+" L"+fe.circularPathData.targetX+" "+fe.circularPathData.targetY,ge}(ce);else{var xe=u.linkHorizontal().source(function(fe){return[fe.source.x0+(fe.source.x1-fe.source.x0),fe.y0]}).target(function(fe){return[fe.target.x0,fe.y1]});ce.path=xe(ce)}})}function P(ae,ie){return X(ae)==X(ie)?ae.circularLinkType=="bottom"?F(ae,ie):z(ae,ie):X(ie)-X(ae)}function z(ae,ie){return ae.y0-ie.y0}function F(ae,ie){return ie.y0-ae.y0}function q(ae,ie){return ae.y1-ie.y1}function W(ae,ie){return ie.y1-ae.y1}function X(ae){return ae.target.column-ae.source.column}function Q(ae){return ae.target.x0-ae.source.x1}function Z(ae,ie){var he=b(ae),se=Q(ie)/Math.tan(he);return K(ae)=="up"?ae.y1+se:ae.y1-se}function Y(ae,ie){var he=b(ae),se=Q(ie)/Math.tan(he);return K(ae)=="up"?ae.y1-se:ae.y1+se}function N(ae,ie,he,se){ae.links.forEach(function(de){if(!de.circular&&de.target.column-de.source.column>1){var ce=de.source.column+1,ve=de.target.column-1,Ee=1,Le=ve-ce+1;for(Ee=1;ce<=ve;ce++,Ee++)ae.nodes.forEach(function(Te){if(Te.column==ce){var xe,fe=Ee/(Le+1),ge=Math.pow(1-fe,3),ke=3*fe*Math.pow(1-fe,2),Me=3*Math.pow(fe,2)*(1-fe),Se=Math.pow(fe,3),De=ge*de.y0+ke*de.y0+Me*de.y1+Se*de.y1,Be=De-de.width/2,We=De+de.width/2;Be>Te.y0&&Be<Te.y1?(xe=Te.y1-Be+10,xe=Te.circularLinkType=="bottom"?xe:-xe,Te=D(Te,xe,ie,he),ae.nodes.forEach(function(Qe){k(Qe,se)!=k(Te,se)&&Qe.column==Te.column&&J(Te,Qe)&&D(Qe,xe,ie,he)})):(We>Te.y0&&We<Te.y1||Be<Te.y0&&We>Te.y1)&&(xe=We-Te.y0+10,Te=D(Te,xe,ie,he),ae.nodes.forEach(function(Qe){k(Qe,se)!=k(Te,se)&&Qe.column==Te.column&&Qe.y0<Te.y1&&Qe.y1>Te.y1&&D(Qe,xe,ie,he)}))}})}})}function J(ae,ie){return ae.y0>ie.y0&&ae.y0<ie.y1||ae.y1>ie.y0&&ae.y1<ie.y1||ae.y0<ie.y0&&ae.y1>ie.y1}function D(ae,ie,he,se){return ae.y0+ie>=he&&ae.y1+ie<=se&&(ae.y0=ae.y0+ie,ae.y1=ae.y1+ie,ae.targetLinks.forEach(function(de){de.y1=de.y1+ie}),ae.sourceLinks.forEach(function(de){de.y0=de.y0+ie})),ae}function U(ae,ie,he,se){ae.nodes.forEach(function(de){se&&de.y+(de.y1-de.y0)>ie&&(de.y=de.y-(de.y+(de.y1-de.y0)-ie));var ce=ae.links.filter(function(Le){return k(Le.source,he)==k(de,he)}),ve=ce.length;ve>1&&ce.sort(function(Le,Te){if(!Le.circular&&!Te.circular){if(Le.target.column==Te.target.column||!$(Le,Te))return Le.y1-Te.y1;if(Le.target.column>Te.target.column){var xe=Y(Te,Le);return Le.y1-xe}if(Te.target.column>Le.target.column)return Y(Le,Te)-Te.y1}return Le.circular&&!Te.circular?Le.circularLinkType=="top"?-1:1:Te.circular&&!Le.circular?Te.circularLinkType=="top"?1:-1:Le.circular&&Te.circular?Le.circularLinkType===Te.circularLinkType&&Le.circularLinkType=="top"?Le.target.column===Te.target.column?Le.target.y1-Te.target.y1:Te.target.column-Le.target.column:Le.circularLinkType===Te.circularLinkType&&Le.circularLinkType=="bottom"?Le.target.column===Te.target.column?Te.target.y1-Le.target.y1:Le.target.column-Te.target.column:Le.circularLinkType=="top"?-1:1:void 0});var Ee=de.y0;ce.forEach(function(Le){Le.y0=Ee+Le.width/2,Ee+=Le.width}),ce.forEach(function(Le,Te){if(Le.circularLinkType=="bottom"){for(var xe=Te+1,fe=0;xe<ve;xe++)fe+=ce[xe].width;Le.y0=de.y1-fe-Le.width/2}})})}function G(ae,ie,he){ae.nodes.forEach(function(se){var de=ae.links.filter(function(Ee){return k(Ee.target,he)==k(se,he)}),ce=de.length;ce>1&&de.sort(function(Ee,Le){if(!Ee.circular&&!Le.circular){if(Ee.source.column==Le.source.column||!$(Ee,Le))return Ee.y0-Le.y0;if(Le.source.column<Ee.source.column){var Te=Z(Le,Ee);return Ee.y0-Te}if(Ee.source.column<Le.source.column)return Z(Ee,Le)-Le.y0}return Ee.circular&&!Le.circular?Ee.circularLinkType=="top"?-1:1:Le.circular&&!Ee.circular?Le.circularLinkType=="top"?1:-1:Ee.circular&&Le.circular?Ee.circularLinkType===Le.circularLinkType&&Ee.circularLinkType=="top"?Ee.source.column===Le.source.column?Ee.source.y1-Le.source.y1:Ee.source.column-Le.source.column:Ee.circularLinkType===Le.circularLinkType&&Ee.circularLinkType=="bottom"?Ee.source.column===Le.source.column?Ee.source.y1-Le.source.y1:Le.source.column-Ee.source.column:Ee.circularLinkType=="top"?-1:1:void 0});var ve=se.y0;de.forEach(function(Ee){Ee.y1=ve+Ee.width/2,ve+=Ee.width}),de.forEach(function(Ee,Le){if(Ee.circularLinkType=="bottom"){for(var Te=Le+1,xe=0;Te<ce;Te++)xe+=de[Te].width;Ee.y1=se.y1-xe-Ee.width/2}})})}function $(ae,ie){return K(ae)==K(ie)}function K(ae){return ae.y0-ae.y1>0?"up":"down"}function re(ae,ie){return k(ae.source,ie)==k(ae.target,ie)}function ne(ae,ie,he){var se=ae.nodes,de=ae.links,ce=!1,ve=!1;if(de.forEach(function(Te){Te.circularLinkType=="top"?ce=!0:Te.circularLinkType=="bottom"&&(ve=!0)}),ce==0||ve==0){var Ee=h.min(se,function(Te){return Te.y0}),Le=(he-ie)/(h.max(se,function(Te){return Te.y1})-Ee);se.forEach(function(Te){var xe=(Te.y1-Te.y0)*Le;Te.y0=(Te.y0-Ee)*Le,Te.y1=Te.y0+xe}),de.forEach(function(Te){Te.y0=(Te.y0-Ee)*Le,Te.y1=(Te.y1-Ee)*Le,Te.width=Te.width*Le})}}t.sankeyCircular=function(){var ae,ie,he=0,se=0,de=1,ce=1,ve=24,Ee=y,Le=o,Te=v,xe=T,fe=32,ge=2,ke=null;function Me(){var Oe={nodes:Te.apply(null,arguments),links:xe.apply(null,arguments)};Se(Oe),E(Oe,Ee,ke),De(Oe),Be(Oe),A(Oe,Ee),We(Oe,fe,Ee),Qe(Oe);for(var Ue=4,Xe=0;Xe<Ue;Xe++)U(Oe,ce,Ee),G(Oe,ce,Ee),N(Oe,se,ce,Ee),U(Oe,ce,Ee),G(Oe,ce,Ee);return ne(Oe,se,ce),S(Oe,ge,ce,Ee),Oe}function Se(Oe){Oe.nodes.forEach(function(Xe,Ye){Xe.index=Ye,Xe.sourceLinks=[],Xe.targetLinks=[]});var Ue=p.map(Oe.nodes,Ee);return Oe.links.forEach(function(Xe,Ye){Xe.index=Ye;var $e=Xe.source,it=Xe.target;($e===void 0?"undefined":n($e))!=="object"&&($e=Xe.source=_(Ue,$e)),(it===void 0?"undefined":n(it))!=="object"&&(it=Xe.target=_(Ue,it)),$e.sourceLinks.push(Xe),it.targetLinks.push(Xe)}),Oe}function De(Oe){Oe.nodes.forEach(function(Ue){Ue.partOfCycle=!1,Ue.value=Math.max(h.sum(Ue.sourceLinks,f),h.sum(Ue.targetLinks,f)),Ue.sourceLinks.forEach(function(Xe){Xe.circular&&(Ue.partOfCycle=!0,Ue.circularLinkType=Xe.circularLinkType)}),Ue.targetLinks.forEach(function(Xe){Xe.circular&&(Ue.partOfCycle=!0,Ue.circularLinkType=Xe.circularLinkType)})})}function Be(Oe){var Ue,Xe,Ye;for(Ue=Oe.nodes,Xe=[],Ye=0;Ue.length;++Ye,Ue=Xe,Xe=[])Ue.forEach(function($e){$e.depth=Ye,$e.sourceLinks.forEach(function(it){Xe.indexOf(it.target)<0&&!it.circular&&Xe.push(it.target)})});for(Ue=Oe.nodes,Xe=[],Ye=0;Ue.length;++Ye,Ue=Xe,Xe=[])Ue.forEach(function($e){$e.height=Ye,$e.targetLinks.forEach(function(it){Xe.indexOf(it.source)<0&&!it.circular&&Xe.push(it.source)})});Oe.nodes.forEach(function($e){$e.column=Math.floor(Le.call(null,$e,Ye))})}function We(Oe,Ue,Xe){var Ye=p.nest().key(function(mt){return mt.column}).sortKeys(h.ascending).entries(Oe.nodes).map(function(mt){return mt.values});(function(mt){if(ie){var tt=1/0;Ye.forEach(function($t){var je=ce*ie/($t.length+1);tt=je<tt?je:tt}),ae=tt}var Ke=h.min(Ye,function($t){return(ce-se-($t.length-1)*ae)/h.sum($t,f)});Ke*=.3,Oe.links.forEach(function($t){$t.width=$t.value*Ke});var Mt=function($t){var je=0,Ge=0,Ct=0,Ie=0,be=h.max($t.nodes,function(Ae){return Ae.column});return $t.links.forEach(function(Ae){Ae.circular&&(Ae.circularLinkType=="top"?je+=Ae.width:Ge+=Ae.width,Ae.target.column==0&&(Ie+=Ae.width),Ae.source.column==be&&(Ct+=Ae.width))}),{top:je=je>0?je+25+10:je,bottom:Ge=Ge>0?Ge+25+10:Ge,left:Ie=Ie>0?Ie+25+10:Ie,right:Ct=Ct>0?Ct+25+10:Ct}}(Oe),Jt=function($t,je){var Ge=h.max($t.nodes,function(Pe){return Pe.column}),Ct=de-he,Ie=ce-se,be=Ct/(Ct+je.right+je.left),Ae=Ie/(Ie+je.top+je.bottom);return he=he*be+je.left,de=je.right==0?de:de*be,se=se*Ae+je.top,ce*=Ae,$t.nodes.forEach(function(Pe){Pe.x0=he+Pe.column*((de-he-ve)/Ge),Pe.x1=Pe.x0+ve}),Ae}(Oe,Mt);Ke*=Jt,Oe.links.forEach(function($t){$t.width=$t.value*Ke}),Ye.forEach(function($t){var je=$t.length;$t.forEach(function(Ge,Ct){Ge.depth==Ye.length-1&&je==1||Ge.depth==0&&je==1?(Ge.y0=ce/2-Ge.value*Ke,Ge.y1=Ge.y0+Ge.value*Ke):Ge.partOfCycle?L(Ge,mt)==0?(Ge.y0=ce/2+Ct,Ge.y1=Ge.y0+Ge.value*Ke):Ge.circularLinkType=="top"?(Ge.y0=se+Ct,Ge.y1=Ge.y0+Ge.value*Ke):(Ge.y0=ce-Ge.value*Ke-Ct,Ge.y1=Ge.y0+Ge.value*Ke):Mt.top==0||Mt.bottom==0?(Ge.y0=(ce-se)/je*Ct,Ge.y1=Ge.y0+Ge.value*Ke):(Ge.y0=(ce-se)/2-je/2+Ct,Ge.y1=Ge.y0+Ge.value*Ke)})})})(Xe),Et();for(var $e=1,it=Ue;it>0;--it)ot($e*=.99,Xe),Et();function ot(mt,tt){var Ke=Ye.length;Ye.forEach(function(Mt){var Jt=Mt.length,$t=Mt[0].depth;Mt.forEach(function(je){var Ge;if((je.sourceLinks.length||je.targetLinks.length)&&!(je.partOfCycle&&L(je,tt)>0))if($t==0&&Jt==1)Ge=je.y1-je.y0,je.y0=ce/2-Ge/2,je.y1=ce/2+Ge/2;else if($t==Ke-1&&Jt==1)Ge=je.y1-je.y0,je.y0=ce/2-Ge/2,je.y1=ce/2+Ge/2;else{var Ct=h.mean(je.sourceLinks,m),Ie=h.mean(je.targetLinks,g),be=((Ct&&Ie?(Ct+Ie)/2:Ct||Ie)-d(je))*mt;je.y0+=be,je.y1+=be}})})}function Et(){Ye.forEach(function(mt){var tt,Ke,Mt,Jt=se,$t=mt.length;for(mt.sort(c),Mt=0;Mt<$t;++Mt)(Ke=Jt-(tt=mt[Mt]).y0)>0&&(tt.y0+=Ke,tt.y1+=Ke),Jt=tt.y1+ae;if((Ke=Jt-ae-ce)>0)for(Jt=tt.y0-=Ke,tt.y1-=Ke,Mt=$t-2;Mt>=0;--Mt)(Ke=(tt=mt[Mt]).y1+ae-Jt)>0&&(tt.y0-=Ke,tt.y1-=Ke),Jt=tt.y0})}}function Qe(Oe){Oe.nodes.forEach(function(Ue){Ue.sourceLinks.sort(r),Ue.targetLinks.sort(s)}),Oe.nodes.forEach(function(Ue){var Xe=Ue.y0,Ye=Xe,$e=Ue.y1,it=$e;Ue.sourceLinks.forEach(function(ot){ot.circular?(ot.y0=$e-ot.width/2,$e-=ot.width):(ot.y0=Xe+ot.width/2,Xe+=ot.width)}),Ue.targetLinks.forEach(function(ot){ot.circular?(ot.y1=it-ot.width/2,it-=ot.width):(ot.y1=Ye+ot.width/2,Ye+=ot.width)})})}return Me.nodeId=function(Oe){return arguments.length?(Ee=typeof Oe=="function"?Oe:a(Oe),Me):Ee},Me.nodeAlign=function(Oe){return arguments.length?(Le=typeof Oe=="function"?Oe:a(Oe),Me):Le},Me.nodeWidth=function(Oe){return arguments.length?(ve=+Oe,Me):ve},Me.nodePadding=function(Oe){return arguments.length?(ae=+Oe,Me):ae},Me.nodes=function(Oe){return arguments.length?(Te=typeof Oe=="function"?Oe:a(Oe),Me):Te},Me.links=function(Oe){return arguments.length?(xe=typeof Oe=="function"?Oe:a(Oe),Me):xe},Me.size=function(Oe){return arguments.length?(he=se=0,de=+Oe[0],ce=+Oe[1],Me):[de-he,ce-se]},Me.extent=function(Oe){return arguments.length?(he=+Oe[0][0],de=+Oe[1][0],se=+Oe[0][1],ce=+Oe[1][1],Me):[[he,se],[de,ce]]},Me.iterations=function(Oe){return arguments.length?(fe=+Oe,Me):fe},Me.circularLinkGap=function(Oe){return arguments.length?(ge=+Oe,Me):ge},Me.nodePaddingRatio=function(Oe){return arguments.length?(ie=+Oe,Me):ie},Me.sortNodes=function(Oe){return arguments.length?(ke=Oe,Me):ke},Me.update=function(Oe){return A(Oe,Ee),Qe(Oe),Oe.links.forEach(function(Ue){Ue.circular&&(Ue.circularLinkType=Ue.y0+Ue.y1<ce?"top":"bottom",Ue.source.circularLinkType=Ue.circularLinkType,Ue.target.circularLinkType=Ue.circularLinkType)}),U(Oe,ce,Ee,!1),G(Oe,ce,Ee),S(Oe,ge,ce,Ee),Oe},Me},t.sankeyCenter=function(ae){return ae.targetLinks.length?ae.depth:ae.sourceLinks.length?h.min(ae.sourceLinks,l)-1:0},t.sankeyLeft=function(ae){return ae.depth},t.sankeyRight=function(ae,ie){return ie-1-ae.height},t.sankeyJustify=o,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":162,"d3-collection":163,"d3-shape":174,"elementary-circuits-directed-graph":188}],57:[function(i,B,V){(function(t,h){typeof V=="object"&&B!==void 0?h(V,i("d3-array"),i("d3-collection"),i("d3-shape")):h(t.d3=t.d3||{},t.d3,t.d3,t.d3)})(this,function(t,h,p,u){function e(k){return k.target.depth}function l(k,E){return k.sourceLinks.length?k.depth:E-1}function o(k){return function(){return k}}function a(k,E){return s(k.source,E.source)||k.index-E.index}function n(k,E){return s(k.target,E.target)||k.index-E.index}function s(k,E){return k.y0-E.y0}function r(k){return k.value}function c(k){return(k.y0+k.y1)/2}function f(k){return c(k.source)*k.value}function d(k){return c(k.target)*k.value}function g(k){return k.index}function m(k){return k.nodes}function y(k){return k.links}function v(k,E){var A=k.get(E);if(!A)throw new Error("missing: "+E);return A}function T(k){return[k.source.x1,k.y0]}function _(k){return[k.target.x0,k.y1]}t.sankey=function(){var k=0,E=0,A=1,b=1,L=24,w=8,C=g,S=l,P=m,z=y,F=32;function q(){var N={nodes:P.apply(null,arguments),links:z.apply(null,arguments)};return W(N),X(N),Q(N),Z(N),Y(N),N}function W(N){N.nodes.forEach(function(D,U){D.index=U,D.sourceLinks=[],D.targetLinks=[]});var J=p.map(N.nodes,C);N.links.forEach(function(D,U){D.index=U;var G=D.source,$=D.target;typeof G!="object"&&(G=D.source=v(J,G)),typeof $!="object"&&($=D.target=v(J,$)),G.sourceLinks.push(D),$.targetLinks.push(D)})}function X(N){N.nodes.forEach(function(J){J.value=Math.max(h.sum(J.sourceLinks,r),h.sum(J.targetLinks,r))})}function Q(N){var J,D,U;for(J=N.nodes,D=[],U=0;J.length;++U,J=D,D=[])J.forEach(function($){$.depth=U,$.sourceLinks.forEach(function(K){D.indexOf(K.target)<0&&D.push(K.target)})});for(J=N.nodes,D=[],U=0;J.length;++U,J=D,D=[])J.forEach(function($){$.height=U,$.targetLinks.forEach(function(K){D.indexOf(K.source)<0&&D.push(K.source)})});var G=(A-k-L)/(U-1);N.nodes.forEach(function($){$.x1=($.x0=k+Math.max(0,Math.min(U-1,Math.floor(S.call(null,$,U))))*G)+L})}function Z(N){var J=p.nest().key(function(re){return re.x0}).sortKeys(h.ascending).entries(N.nodes).map(function(re){return re.values});(function(){var re=h.max(J,function(ie){return ie.length}),ne=2/3*(b-E)/(re-1);w>ne&&(w=ne);var ae=h.min(J,function(ie){return(b-E-(ie.length-1)*w)/h.sum(ie,r)});J.forEach(function(ie){ie.forEach(function(he,se){he.y1=(he.y0=se)+he.value*ae})}),N.links.forEach(function(ie){ie.width=ie.value*ae})})(),K();for(var D=1,U=F;U>0;--U)$(D*=.99),K(),G(D),K();function G(re){J.forEach(function(ne){ne.forEach(function(ae){if(ae.targetLinks.length){var ie=(h.sum(ae.targetLinks,f)/h.sum(ae.targetLinks,r)-c(ae))*re;ae.y0+=ie,ae.y1+=ie}})})}function $(re){J.slice().reverse().forEach(function(ne){ne.forEach(function(ae){if(ae.sourceLinks.length){var ie=(h.sum(ae.sourceLinks,d)/h.sum(ae.sourceLinks,r)-c(ae))*re;ae.y0+=ie,ae.y1+=ie}})})}function K(){J.forEach(function(re){var ne,ae,ie,he=E,se=re.length;for(re.sort(s),ie=0;ie<se;++ie)(ae=he-(ne=re[ie]).y0)>0&&(ne.y0+=ae,ne.y1+=ae),he=ne.y1+w;if((ae=he-w-b)>0)for(he=ne.y0-=ae,ne.y1-=ae,ie=se-2;ie>=0;--ie)(ae=(ne=re[ie]).y1+w-he)>0&&(ne.y0-=ae,ne.y1-=ae),he=ne.y0})}}function Y(N){N.nodes.forEach(function(J){J.sourceLinks.sort(n),J.targetLinks.sort(a)}),N.nodes.forEach(function(J){var D=J.y0,U=D;J.sourceLinks.forEach(function(G){G.y0=D+G.width/2,D+=G.width}),J.targetLinks.forEach(function(G){G.y1=U+G.width/2,U+=G.width})})}return q.update=function(N){return Y(N),N},q.nodeId=function(N){return arguments.length?(C=typeof N=="function"?N:o(N),q):C},q.nodeAlign=function(N){return arguments.length?(S=typeof N=="function"?N:o(N),q):S},q.nodeWidth=function(N){return arguments.length?(L=+N,q):L},q.nodePadding=function(N){return arguments.length?(w=+N,q):w},q.nodes=function(N){return arguments.length?(P=typeof N=="function"?N:o(N),q):P},q.links=function(N){return arguments.length?(z=typeof N=="function"?N:o(N),q):z},q.size=function(N){return arguments.length?(k=E=0,A=+N[0],b=+N[1],q):[A-k,b-E]},q.extent=function(N){return arguments.length?(k=+N[0][0],A=+N[1][0],E=+N[0][1],b=+N[1][1],q):[[k,E],[A,b]]},q.iterations=function(N){return arguments.length?(F=+N,q):F},q},t.sankeyCenter=function(k){return k.targetLinks.length?k.depth:k.sourceLinks.length?h.min(k.sourceLinks,e)-1:0},t.sankeyLeft=function(k){return k.depth},t.sankeyRight=function(k,E){return E-1-k.height},t.sankeyJustify=l,t.sankeyLinkHorizontal=function(){return u.linkHorizontal().source(T).target(_)},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":162,"d3-collection":163,"d3-shape":174}],58:[function(i,B,V){(function(){var t={version:"3.8.0"},h=[].slice,p=function(oe){return h.call(oe)},u=self.document;function e(oe){return oe&&(oe.ownerDocument||oe.document||oe).documentElement}function l(oe){return oe&&(oe.ownerDocument&&oe.ownerDocument.defaultView||oe.document&&oe||oe.defaultView)}if(u)try{p(u.documentElement.childNodes)[0].nodeType}catch{p=function(M){for(var O=M.length,R=new Array(O);O--;)R[O]=M[O];return R}}if(Date.now||(Date.now=function(){return+new Date}),u)try{u.createElement("DIV").style.setProperty("opacity",0,"")}catch{var o=this.Element.prototype,a=o.setAttribute,n=o.setAttributeNS,s=this.CSSStyleDeclaration.prototype,r=s.setProperty;o.setAttribute=function(M,O){a.call(this,M,O+"")},o.setAttributeNS=function(M,O,R){n.call(this,M,O,R+"")},s.setProperty=function(M,O,R){r.call(this,M,O+"",R)}}function c(oe,M){return oe<M?-1:oe>M?1:oe>=M?0:NaN}function f(oe){return oe===null?NaN:+oe}function d(oe){return!isNaN(oe)}function g(oe){return{left:function(M,O,R,j){for(arguments.length<3&&(R=0),arguments.length<4&&(j=M.length);R<j;){var te=R+j>>>1;oe(M[te],O)<0?R=te+1:j=te}return R},right:function(M,O,R,j){for(arguments.length<3&&(R=0),arguments.length<4&&(j=M.length);R<j;){var te=R+j>>>1;oe(M[te],O)>0?j=te:R=te+1}return R}}}t.ascending=c,t.descending=function(oe,M){return M<oe?-1:M>oe?1:M>=oe?0:NaN},t.min=function(oe,M){var O,R,j=-1,te=oe.length;if(arguments.length===1){for(;++j<te;)if((R=oe[j])!=null&&R>=R){O=R;break}for(;++j<te;)(R=oe[j])!=null&&O>R&&(O=R)}else{for(;++j<te;)if((R=M.call(oe,oe[j],j))!=null&&R>=R){O=R;break}for(;++j<te;)(R=M.call(oe,oe[j],j))!=null&&O>R&&(O=R)}return O},t.max=function(oe,M){var O,R,j=-1,te=oe.length;if(arguments.length===1){for(;++j<te;)if((R=oe[j])!=null&&R>=R){O=R;break}for(;++j<te;)(R=oe[j])!=null&&R>O&&(O=R)}else{for(;++j<te;)if((R=M.call(oe,oe[j],j))!=null&&R>=R){O=R;break}for(;++j<te;)(R=M.call(oe,oe[j],j))!=null&&R>O&&(O=R)}return O},t.extent=function(oe,M){var O,R,j,te=-1,le=oe.length;if(arguments.length===1){for(;++te<le;)if((R=oe[te])!=null&&R>=R){O=j=R;break}for(;++te<le;)(R=oe[te])!=null&&(O>R&&(O=R),j<R&&(j=R))}else{for(;++te<le;)if((R=M.call(oe,oe[te],te))!=null&&R>=R){O=j=R;break}for(;++te<le;)(R=M.call(oe,oe[te],te))!=null&&(O>R&&(O=R),j<R&&(j=R))}return[O,j]},t.sum=function(oe,M){var O,R=0,j=oe.length,te=-1;if(arguments.length===1)for(;++te<j;)d(O=+oe[te])&&(R+=O);else for(;++te<j;)d(O=+M.call(oe,oe[te],te))&&(R+=O);return R},t.mean=function(oe,M){var O,R=0,j=oe.length,te=-1,le=j;if(arguments.length===1)for(;++te<j;)d(O=f(oe[te]))?R+=O:--le;else for(;++te<j;)d(O=f(M.call(oe,oe[te],te)))?R+=O:--le;if(le)return R/le},t.quantile=function(oe,M){var O=(oe.length-1)*M+1,R=Math.floor(O),j=+oe[R-1],te=O-R;return te?j+te*(oe[R]-j):j},t.median=function(oe,M){var O,R=[],j=oe.length,te=-1;if(arguments.length===1)for(;++te<j;)d(O=f(oe[te]))&&R.push(O);else for(;++te<j;)d(O=f(M.call(oe,oe[te],te)))&&R.push(O);if(R.length)return t.quantile(R.sort(c),.5)},t.variance=function(oe,M){var O,R,j=oe.length,te=0,le=0,pe=-1,ye=0;if(arguments.length===1)for(;++pe<j;)d(O=f(oe[pe]))&&(le+=(R=O-te)*(O-(te+=R/++ye)));else for(;++pe<j;)d(O=f(M.call(oe,oe[pe],pe)))&&(le+=(R=O-te)*(O-(te+=R/++ye)));if(ye>1)return le/(ye-1)},t.deviation=function(){var oe=t.variance.apply(this,arguments);return oe&&Math.sqrt(oe)};var m=g(c);function y(oe){return oe.length}t.bisectLeft=m.left,t.bisect=t.bisectRight=m.right,t.bisector=function(oe){return g(oe.length===1?function(M,O){return c(oe(M),O)}:oe)},t.shuffle=function(oe,M,O){(te=arguments.length)<3&&(O=oe.length,te<2&&(M=0));for(var R,j,te=O-M;te;)j=Math.random()*te--|0,R=oe[te+M],oe[te+M]=oe[j+M],oe[j+M]=R;return oe},t.permute=function(oe,M){for(var O=M.length,R=new Array(O);O--;)R[O]=oe[M[O]];return R},t.pairs=function(oe){for(var M=0,O=oe.length-1,R=oe[0],j=new Array(O<0?0:O);M<O;)j[M]=[R,R=oe[++M]];return j},t.transpose=function(oe){if(!(j=oe.length))return[];for(var M=-1,O=t.min(oe,y),R=new Array(O);++M<O;)for(var j,te=-1,le=R[M]=new Array(j);++te<j;)le[te]=oe[te][M];return R},t.zip=function(){return t.transpose(arguments)},t.keys=function(oe){var M=[];for(var O in oe)M.push(O);return M},t.values=function(oe){var M=[];for(var O in oe)M.push(oe[O]);return M},t.entries=function(oe){var M=[];for(var O in oe)M.push({key:O,value:oe[O]});return M},t.merge=function(oe){for(var M,O,R,j=oe.length,te=-1,le=0;++te<j;)le+=oe[te].length;for(O=new Array(le);--j>=0;)for(M=(R=oe[j]).length;--M>=0;)O[--le]=R[M];return O};var v=Math.abs;function T(oe){for(var M=1;oe*M%1;)M*=10;return M}function _(oe,M){for(var O in M)Object.defineProperty(oe.prototype,O,{value:M[O],enumerable:!1})}function k(){this._=Object.create(null)}t.range=function(oe,M,O){if(arguments.length<3&&(O=1,arguments.length<2&&(M=oe,oe=0)),(M-oe)/O==1/0)throw new Error("infinite range");var R,j=[],te=T(v(O)),le=-1;if(oe*=te,M*=te,(O*=te)<0)for(;(R=oe+O*++le)>M;)j.push(R/te);else for(;(R=oe+O*++le)<M;)j.push(R/te);return j},t.map=function(oe,M){var O=new k;if(oe instanceof k)oe.forEach(function(pe,ye){O.set(pe,ye)});else if(Array.isArray(oe)){var R,j=-1,te=oe.length;if(arguments.length===1)for(;++j<te;)O.set(j,oe[j]);else for(;++j<te;)O.set(M.call(oe,R=oe[j],j),R)}else for(var le in oe)O.set(le,oe[le]);return O};function E(oe){return(oe+="")=="__proto__"||oe[0]==="\0"?"\0"+oe:oe}function A(oe){return(oe+="")[0]==="\0"?oe.slice(1):oe}function b(oe){return E(oe)in this._}function L(oe){return(oe=E(oe))in this._&&delete this._[oe]}function w(){var oe=[];for(var M in this._)oe.push(A(M));return oe}function C(){var oe=0;for(var M in this._)++oe;return oe}function S(){for(var oe in this._)return!1;return!0}function P(){this._=Object.create(null)}function z(oe){return oe}function F(oe,M,O){return function(){var R=O.apply(M,arguments);return R===M?oe:R}}function q(oe,M){if(M in oe)return M;M=M.charAt(0).toUpperCase()+M.slice(1);for(var O=0,R=W.length;O<R;++O){var j=W[O]+M;if(j in oe)return j}}_(k,{has:b,get:function(oe){return this._[E(oe)]},set:function(oe,M){return this._[E(oe)]=M},remove:L,keys:w,values:function(){var oe=[];for(var M in this._)oe.push(this._[M]);return oe},entries:function(){var oe=[];for(var M in this._)oe.push({key:A(M),value:this._[M]});return oe},size:C,empty:S,forEach:function(oe){for(var M in this._)oe.call(this,A(M),this._[M])}}),t.nest=function(){var oe,M,O={},R=[],j=[];function te(le,pe,ye){if(ye>=R.length)return M?M.call(O,pe):oe?pe.sort(oe):pe;for(var _e,Ne,He,et,yt=-1,kt=pe.length,_t=R[ye++],wt=new k;++yt<kt;)(et=wt.get(_e=_t(Ne=pe[yt])))?et.push(Ne):wt.set(_e,[Ne]);return le?(Ne=le(),He=function(vt,Dt){Ne.set(vt,te(le,Dt,ye))}):(Ne={},He=function(vt,Dt){Ne[vt]=te(le,Dt,ye)}),wt.forEach(He),Ne}return O.map=function(le,pe){return te(pe,le,0)},O.entries=function(le){return function pe(ye,_e){if(_e>=R.length)return ye;var Ne=[],He=j[_e++];return ye.forEach(function(et,yt){Ne.push({key:et,values:pe(yt,_e)})}),He?Ne.sort(function(et,yt){return He(et.key,yt.key)}):Ne}(te(t.map,le,0),0)},O.key=function(le){return R.push(le),O},O.sortKeys=function(le){return j[R.length-1]=le,O},O.sortValues=function(le){return oe=le,O},O.rollup=function(le){return M=le,O},O},t.set=function(oe){var M=new P;if(oe)for(var O=0,R=oe.length;O<R;++O)M.add(oe[O]);return M},_(P,{has:b,add:function(oe){return this._[E(oe+="")]=!0,oe},remove:L,values:w,size:C,empty:S,forEach:function(oe){for(var M in this._)oe.call(this,A(M))}}),t.behavior={},t.rebind=function(oe,M){for(var O,R=1,j=arguments.length;++R<j;)oe[O=arguments[R]]=F(oe,M,M[O]);return oe};var W=["webkit","ms","moz","Moz","o","O"];function X(){}function Q(){}function Z(oe){var M=[],O=new k;function R(){for(var j,te=M,le=-1,pe=te.length;++le<pe;)(j=te[le].on)&&j.apply(this,arguments);return oe}return R.on=function(j,te){var le,pe=O.get(j);return arguments.length<2?pe&&pe.on:(pe&&(pe.on=null,M=M.slice(0,le=M.indexOf(pe)).concat(M.slice(le+1)),O.remove(j)),te&&M.push(O.set(j,{on:te})),oe)},R}function Y(){t.event.preventDefault()}function N(){for(var oe,M=t.event;oe=M.sourceEvent;)M=oe;return M}function J(oe){for(var M=new Q,O=0,R=arguments.length;++O<R;)M[arguments[O]]=Z(M);return M.of=function(j,te){return function(le){try{var pe=le.sourceEvent=t.event;le.target=oe,t.event=le,M[le.type].apply(j,te)}finally{t.event=pe}}},M}t.dispatch=function(){for(var oe=new Q,M=-1,O=arguments.length;++M<O;)oe[arguments[M]]=Z(oe);return oe},Q.prototype.on=function(oe,M){var O=oe.indexOf("."),R="";if(O>=0&&(R=oe.slice(O+1),oe=oe.slice(0,O)),oe)return arguments.length<2?this[oe].on(R):this[oe].on(R,M);if(arguments.length===2){if(M==null)for(oe in this)this.hasOwnProperty(oe)&&this[oe].on(R,null);return this}},t.event=null,t.requote=function(oe){return oe.replace(D,"\\$&")};var D=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,U={}.__proto__?function(oe,M){oe.__proto__=M}:function(oe,M){for(var O in M)oe[O]=M[O]};function G(oe){return U(oe,ne),oe}var $=function(oe,M){return M.querySelector(oe)},K=function(oe,M){return M.querySelectorAll(oe)},re=function(oe,M){var O=oe.matches||oe[q(oe,"matchesSelector")];return(re=function(R,j){return O.call(R,j)})(oe,M)};typeof Sizzle=="function"&&($=function(oe,M){return Sizzle(oe,M)[0]||null},K=Sizzle,re=Sizzle.matchesSelector),t.selection=function(){return t.select(u.documentElement)};var ne=t.selection.prototype=[];function ae(oe){return typeof oe=="function"?oe:function(){return $(oe,this)}}function ie(oe){return typeof oe=="function"?oe:function(){return K(oe,this)}}ne.select=function(oe){var M,O,R,j,te=[];oe=ae(oe);for(var le=-1,pe=this.length;++le<pe;){te.push(M=[]),M.parentNode=(R=this[le]).parentNode;for(var ye=-1,_e=R.length;++ye<_e;)(j=R[ye])?(M.push(O=oe.call(j,j.__data__,ye,le)),O&&"__data__"in j&&(O.__data__=j.__data__)):M.push(null)}return G(te)},ne.selectAll=function(oe){var M,O,R=[];oe=ie(oe);for(var j=-1,te=this.length;++j<te;)for(var le=this[j],pe=-1,ye=le.length;++pe<ye;)(O=le[pe])&&(R.push(M=p(oe.call(O,O.__data__,pe,j))),M.parentNode=O);return G(R)};var he="http://www.w3.org/1999/xhtml",se={svg:"http://www.w3.org/2000/svg",xhtml:he,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function de(oe,M){return oe=t.ns.qualify(oe),M==null?oe.local?function(){this.removeAttributeNS(oe.space,oe.local)}:function(){this.removeAttribute(oe)}:typeof M=="function"?oe.local?function(){var O=M.apply(this,arguments);O==null?this.removeAttributeNS(oe.space,oe.local):this.setAttributeNS(oe.space,oe.local,O)}:function(){var O=M.apply(this,arguments);O==null?this.removeAttribute(oe):this.setAttribute(oe,O)}:oe.local?function(){this.setAttributeNS(oe.space,oe.local,M)}:function(){this.setAttribute(oe,M)}}function ce(oe){return oe.trim().replace(/\s+/g," ")}function ve(oe){return new RegExp("(?:^|\\s+)"+t.requote(oe)+"(?:\\s+|$)","g")}function Ee(oe){return(oe+"").trim().split(/^|\s+/)}function Le(oe,M){var O=(oe=Ee(oe).map(Te)).length;return typeof M=="function"?function(){for(var R=-1,j=M.apply(this,arguments);++R<O;)oe[R](this,j)}:function(){for(var R=-1;++R<O;)oe[R](this,M)}}function Te(oe){var M=ve(oe);return function(O,R){if(j=O.classList)return R?j.add(oe):j.remove(oe);var j=O.getAttribute("class")||"";R?(M.lastIndex=0,M.test(j)||O.setAttribute("class",ce(j+" "+oe))):O.setAttribute("class",ce(j.replace(M," ")))}}function xe(oe,M,O){return M==null?function(){this.style.removeProperty(oe)}:typeof M=="function"?function(){var R=M.apply(this,arguments);R==null?this.style.removeProperty(oe):this.style.setProperty(oe,R,O)}:function(){this.style.setProperty(oe,M,O)}}function fe(oe,M){return M==null?function(){delete this[oe]}:typeof M=="function"?function(){var O=M.apply(this,arguments);O==null?delete this[oe]:this[oe]=O}:function(){this[oe]=M}}function ge(oe){return typeof oe=="function"?oe:(oe=t.ns.qualify(oe)).local?function(){return this.ownerDocument.createElementNS(oe.space,oe.local)}:function(){var M=this.ownerDocument,O=this.namespaceURI;return O===he&&M.documentElement.namespaceURI===he?M.createElement(oe):M.createElementNS(O,oe)}}function ke(){var oe=this.parentNode;oe&&oe.removeChild(this)}function Me(oe){return{__data__:oe}}function Se(oe){return function(){return re(this,oe)}}function De(oe){return arguments.length||(oe=c),function(M,O){return M&&O?oe(M.__data__,O.__data__):!M-!O}}function Be(oe,M){for(var O=0,R=oe.length;O<R;O++)for(var j,te=oe[O],le=0,pe=te.length;le<pe;le++)(j=te[le])&&M(j,le,O);return oe}function We(oe){return U(oe,Qe),oe}t.ns={prefix:se,qualify:function(oe){var M=oe.indexOf(":"),O=oe;return M>=0&&(O=oe.slice(0,M))!=="xmlns"&&(oe=oe.slice(M+1)),se.hasOwnProperty(O)?{space:se[O],local:oe}:oe}},ne.attr=function(oe,M){if(arguments.length<2){if(typeof oe=="string"){var O=this.node();return(oe=t.ns.qualify(oe)).local?O.getAttributeNS(oe.space,oe.local):O.getAttribute(oe)}for(M in oe)this.each(de(M,oe[M]));return this}return this.each(de(oe,M))},ne.classed=function(oe,M){if(arguments.length<2){if(typeof oe=="string"){var O=this.node(),R=(oe=Ee(oe)).length,j=-1;if(M=O.classList){for(;++j<R;)if(!M.contains(oe[j]))return!1}else for(M=O.getAttribute("class");++j<R;)if(!ve(oe[j]).test(M))return!1;return!0}for(M in oe)this.each(Le(M,oe[M]));return this}return this.each(Le(oe,M))},ne.style=function(oe,M,O){var R=arguments.length;if(R<3){if(typeof oe!="string"){for(O in R<2&&(M=""),oe)this.each(xe(O,oe[O],M));return this}if(R<2){var j=this.node();return l(j).getComputedStyle(j,null).getPropertyValue(oe)}O=""}return this.each(xe(oe,M,O))},ne.property=function(oe,M){if(arguments.length<2){if(typeof oe=="string")return this.node()[oe];for(M in oe)this.each(fe(M,oe[M]));return this}return this.each(fe(oe,M))},ne.text=function(oe){return arguments.length?this.each(typeof oe=="function"?function(){var M=oe.apply(this,arguments);this.textContent=M??""}:oe==null?function(){this.textContent=""}:function(){this.textContent=oe}):this.node().textContent},ne.html=function(oe){return arguments.length?this.each(typeof oe=="function"?function(){var M=oe.apply(this,arguments);this.innerHTML=M??""}:oe==null?function(){this.innerHTML=""}:function(){this.innerHTML=oe}):this.node().innerHTML},ne.append=function(oe){return oe=ge(oe),this.select(function(){return this.appendChild(oe.apply(this,arguments))})},ne.insert=function(oe,M){return oe=ge(oe),M=ae(M),this.select(function(){return this.insertBefore(oe.apply(this,arguments),M.apply(this,arguments)||null)})},ne.remove=function(){return this.each(ke)},ne.data=function(oe,M){var O,R,j=-1,te=this.length;if(!arguments.length){for(oe=new Array(te=(O=this[0]).length);++j<te;)(R=O[j])&&(oe[j]=R.__data__);return oe}function le(Ne,He){var et,yt,kt,_t=Ne.length,wt=He.length,vt=Math.min(_t,wt),Dt=new Array(wt),Pt=new Array(wt),Ft=new Array(_t);if(M){var er,cr=new k,Ar=new Array(_t);for(et=-1;++et<_t;)(yt=Ne[et])&&(cr.has(er=M.call(yt,yt.__data__,et))?Ft[et]=yt:cr.set(er,yt),Ar[et]=er);for(et=-1;++et<wt;)(yt=cr.get(er=M.call(He,kt=He[et],et)))?yt!==!0&&(Dt[et]=yt,yt.__data__=kt):Pt[et]=Me(kt),cr.set(er,!0);for(et=-1;++et<_t;)et in Ar&&cr.get(Ar[et])!==!0&&(Ft[et]=Ne[et])}else{for(et=-1;++et<vt;)yt=Ne[et],kt=He[et],yt?(yt.__data__=kt,Dt[et]=yt):Pt[et]=Me(kt);for(;et<wt;++et)Pt[et]=Me(He[et]);for(;et<_t;++et)Ft[et]=Ne[et]}Pt.update=Dt,Pt.parentNode=Dt.parentNode=Ft.parentNode=Ne.parentNode,pe.push(Pt),ye.push(Dt),_e.push(Ft)}var pe=We([]),ye=G([]),_e=G([]);if(typeof oe=="function")for(;++j<te;)le(O=this[j],oe.call(O,O.parentNode.__data__,j));else for(;++j<te;)le(O=this[j],oe);return ye.enter=function(){return pe},ye.exit=function(){return _e},ye},ne.datum=function(oe){return arguments.length?this.property("__data__",oe):this.property("__data__")},ne.filter=function(oe){var M,O,R,j=[];typeof oe!="function"&&(oe=Se(oe));for(var te=0,le=this.length;te<le;te++){j.push(M=[]),M.parentNode=(O=this[te]).parentNode;for(var pe=0,ye=O.length;pe<ye;pe++)(R=O[pe])&&oe.call(R,R.__data__,pe,te)&&M.push(R)}return G(j)},ne.order=function(){for(var oe=-1,M=this.length;++oe<M;)for(var O,R=this[oe],j=R.length-1,te=R[j];--j>=0;)(O=R[j])&&(te&&te!==O.nextSibling&&te.parentNode.insertBefore(O,te),te=O);return this},ne.sort=function(oe){oe=De.apply(this,arguments);for(var M=-1,O=this.length;++M<O;)this[M].sort(oe);return this.order()},ne.each=function(oe){return Be(this,function(M,O,R){oe.call(M,M.__data__,O,R)})},ne.call=function(oe){var M=p(arguments);return oe.apply(M[0]=this,M),this},ne.empty=function(){return!this.node()},ne.node=function(){for(var oe=0,M=this.length;oe<M;oe++)for(var O=this[oe],R=0,j=O.length;R<j;R++){var te=O[R];if(te)return te}return null},ne.size=function(){var oe=0;return Be(this,function(){++oe}),oe};var Qe=[];function Oe(oe){var M,O;return function(R,j,te){var le,pe=oe[te].update,ye=pe.length;for(te!=O&&(O=te,M=0),j>=M&&(M=j+1);!(le=pe[M])&&++M<ye;);return le}}function Ue(oe,M,O){var R="__on"+oe,j=oe.indexOf("."),te=Ye;j>0&&(oe=oe.slice(0,j));var le=Xe.get(oe);function pe(){var ye=this[R];ye&&(this.removeEventListener(oe,ye,ye.$),delete this[R])}return le&&(oe=le,te=$e),j?M?function(){var ye=te(M,p(arguments));pe.call(this),this.addEventListener(oe,this[R]=ye,ye.$=O),ye._=M}:pe:M?X:function(){var ye,_e=new RegExp("^__on([^.]+)"+t.requote(oe)+"$");for(var Ne in this)if(ye=Ne.match(_e)){var He=this[Ne];this.removeEventListener(ye[1],He,He.$),delete this[Ne]}}}t.selection.enter=We,t.selection.enter.prototype=Qe,Qe.append=ne.append,Qe.empty=ne.empty,Qe.node=ne.node,Qe.call=ne.call,Qe.size=ne.size,Qe.select=function(oe){for(var M,O,R,j,te,le=[],pe=-1,ye=this.length;++pe<ye;){R=(j=this[pe]).update,le.push(M=[]),M.parentNode=j.parentNode;for(var _e=-1,Ne=j.length;++_e<Ne;)(te=j[_e])?(M.push(R[_e]=O=oe.call(j.parentNode,te.__data__,_e,pe)),O.__data__=te.__data__):M.push(null)}return G(le)},Qe.insert=function(oe,M){return arguments.length<2&&(M=Oe(this)),ne.insert.call(this,oe,M)},t.select=function(oe){var M;return typeof oe=="string"?(M=[$(oe,u)]).parentNode=u.documentElement:(M=[oe]).parentNode=e(oe),G([M])},t.selectAll=function(oe){var M;return typeof oe=="string"?(M=p(K(oe,u))).parentNode=u.documentElement:(M=p(oe)).parentNode=null,G([M])},ne.on=function(oe,M,O){var R=arguments.length;if(R<3){if(typeof oe!="string"){for(O in R<2&&(M=!1),oe)this.each(Ue(O,oe[O],M));return this}if(R<2)return(R=this.node()["__on"+oe])&&R._;O=!1}return this.each(Ue(oe,M,O))};var Xe=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});function Ye(oe,M){return function(O){var R=t.event;t.event=O,M[0]=this.__data__;try{oe.apply(this,M)}finally{t.event=R}}}function $e(oe,M){var O=Ye(oe,M);return function(R){var j=R.relatedTarget;j&&(j===this||8&j.compareDocumentPosition(this))||O.call(this,R)}}u&&Xe.forEach(function(oe){"on"+oe in u&&Xe.remove(oe)});var it,ot=0;function Et(oe){var M=".dragsuppress-"+ ++ot,O="click"+M,R=t.select(l(oe)).on("touchmove"+M,Y).on("dragstart"+M,Y).on("selectstart"+M,Y);if(it==null&&(it=!("onselectstart"in oe)&&q(oe.style,"userSelect")),it){var j=e(oe).style,te=j[it];j[it]="none"}return function(le){if(R.on(M,null),it&&(j[it]=te),le){var pe=function(){R.on(O,null)};R.on(O,function(){Y(),pe()},!0),setTimeout(pe,0)}}}t.mouse=function(oe){return tt(oe,N())};var mt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function tt(oe,M){M.changedTouches&&(M=M.changedTouches[0]);var O=oe.ownerSVGElement||oe;if(O.createSVGPoint){var R=O.createSVGPoint();if(mt<0){var j=l(oe);if(j.scrollX||j.scrollY){var te=(O=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();mt=!(te.f||te.e),O.remove()}}return mt?(R.x=M.pageX,R.y=M.pageY):(R.x=M.clientX,R.y=M.clientY),[(R=R.matrixTransform(oe.getScreenCTM().inverse())).x,R.y]}var le=oe.getBoundingClientRect();return[M.clientX-le.left-oe.clientLeft,M.clientY-le.top-oe.clientTop]}function Ke(){return t.event.changedTouches[0].identifier}t.touch=function(oe,M,O){if(arguments.length<3&&(O=M,M=N().changedTouches),M){for(var R,j=0,te=M.length;j<te;++j)if((R=M[j]).identifier===O)return tt(oe,R)}},t.behavior.drag=function(){var oe=J(j,"drag","dragstart","dragend"),M=null,O=te(X,t.mouse,l,"mousemove","mouseup"),R=te(Ke,t.touch,z,"touchmove","touchend");function j(){this.on("mousedown.drag",O).on("touchstart.drag",R)}function te(le,pe,ye,_e,Ne){return function(){var He,et=this,yt=t.event.target.correspondingElement||t.event.target,kt=et.parentNode,_t=oe.of(et,arguments),wt=0,vt=le(),Dt=".drag"+(vt==null?"":"-"+vt),Pt=t.select(ye(yt)).on(_e+Dt,cr).on(Ne+Dt,Ar),Ft=Et(yt),er=pe(kt,vt);function cr(){var Tr,Yr,Gr=pe(kt,vt);Gr&&(Tr=Gr[0]-er[0],Yr=Gr[1]-er[1],wt|=Tr|Yr,er=Gr,_t({type:"drag",x:Gr[0]+He[0],y:Gr[1]+He[1],dx:Tr,dy:Yr}))}function Ar(){pe(kt,vt)&&(Pt.on(_e+Dt,null).on(Ne+Dt,null),Ft(wt),_t({type:"dragend"}))}He=M?[(He=M.apply(et,arguments)).x-er[0],He.y-er[1]]:[0,0],_t({type:"dragstart"})}}return j.origin=function(le){return arguments.length?(M=le,j):M},t.rebind(j,oe,"on")},t.touches=function(oe,M){return arguments.length<2&&(M=N().touches),M?p(M).map(function(O){var R=tt(oe,O);return R.identifier=O.identifier,R}):[]};var Mt=1e-6,Jt=Math.PI,$t=2*Jt,je=$t-Mt,Ge=Jt/2,Ct=Jt/180,Ie=180/Jt;function be(oe){return oe>1?Ge:oe<-1?-Ge:Math.asin(oe)}function Ae(oe){return((oe=Math.exp(oe))+1/oe)/2}var Pe=Math.SQRT2;t.interpolateZoom=function(oe,M){var O,R,j=oe[0],te=oe[1],le=oe[2],pe=M[0],ye=M[1],_e=M[2],Ne=pe-j,He=ye-te,et=Ne*Ne+He*He;if(et<1e-12)R=Math.log(_e/le)/Pe,O=function(Dt){return[j+Dt*Ne,te+Dt*He,le*Math.exp(Pe*Dt*R)]};else{var yt=Math.sqrt(et),kt=(_e*_e-le*le+4*et)/(2*le*2*yt),_t=(_e*_e-le*le-4*et)/(2*_e*2*yt),wt=Math.log(Math.sqrt(kt*kt+1)-kt),vt=Math.log(Math.sqrt(_t*_t+1)-_t);R=(vt-wt)/Pe,O=function(Dt){var Pt,Ft=Dt*R,er=Ae(wt),cr=le/(2*yt)*(er*(Pt=Pe*Ft+wt,((Pt=Math.exp(2*Pt))-1)/(Pt+1))-function(Ar){return((Ar=Math.exp(Ar))-1/Ar)/2}(wt));return[j+cr*Ne,te+cr*He,le*er/Ae(Pe*Ft+wt)]}}return O.duration=1e3*R,O},t.behavior.zoom=function(){var oe,M,O,R,j,te,le,pe,ye,_e={x:0,y:0,k:1},Ne=[960,500],He=ht,et=250,yt=0,kt="mousedown.zoom",_t="mousemove.zoom",wt="mouseup.zoom",vt="touchstart.zoom",Dt=J(Pt,"zoomstart","zoom","zoomend");function Pt(jr){jr.on(kt,$r).on(qe+".zoom",jn).on("dblclick.zoom",ia).on(vt,In)}function Ft(jr){return[(jr[0]-_e.x)/_e.k,(jr[1]-_e.y)/_e.k]}function er(jr){_e.k=Math.max(He[0],Math.min(He[1],jr))}function cr(jr,mn){mn=function(Un){return[Un[0]*_e.k+_e.x,Un[1]*_e.k+_e.y]}(mn),_e.x+=jr[0]-mn[0],_e.y+=jr[1]-mn[1]}function Ar(jr,mn,Un,Fn){jr.__chart__={x:_e.x,y:_e.y,k:_e.k},er(Math.pow(2,Fn)),cr(M=mn,Un),jr=t.select(jr),et>0&&(jr=jr.transition().duration(et)),jr.call(Pt.event)}function Tr(){le&&le.domain(te.range().map(function(jr){return(jr-_e.x)/_e.k}).map(te.invert)),ye&&ye.domain(pe.range().map(function(jr){return(jr-_e.y)/_e.k}).map(pe.invert))}function Yr(jr){yt++||jr({type:"zoomstart"})}function Gr(jr){Tr(),jr({type:"zoom",scale:_e.k,translate:[_e.x,_e.y]})}function an(jr){--yt||(jr({type:"zoomend"}),M=null)}function $r(){var jr=this,mn=Dt.of(jr,arguments),Un=0,Fn=t.select(l(jr)).on(_t,ka).on(wt,qn),Jn=Ft(t.mouse(jr)),sa=Et(jr);function ka(){Un=1,cr(t.mouse(jr),Jn),Gr(mn)}function qn(){Fn.on(_t,null).on(wt,null),sa(Un),an(mn)}ks.call(jr),Yr(mn)}function In(){var jr,mn=this,Un=Dt.of(mn,arguments),Fn={},Jn=0,sa=".zoom-"+t.event.changedTouches[0].identifier,ka="touchmove"+sa,qn="touchend"+sa,va=[],pa=t.select(mn),Ea=Et(mn);function ya(){var Ei=t.touches(mn);return jr=_e.k,Ei.forEach(function(Li){Li.identifier in Fn&&(Fn[Li.identifier]=Ft(Li))}),Ei}function La(){var Ei=t.event.target;t.select(Ei).on(ka,Fa).on(qn,si),va.push(Ei);for(var Li=t.event.changedTouches,oi=0,_i=Li.length;oi<_i;++oi)Fn[Li[oi].identifier]=null;var hi=ya(),mo=Date.now();if(hi.length===1){if(mo-j<500){var Vi=hi[0];Ar(mn,Vi,Fn[Vi.identifier],Math.floor(Math.log(_e.k)/Math.LN2)+1),Y()}j=mo}else if(hi.length>1){Vi=hi[0];var Oo=hi[1],xs=Vi[0]-Oo[0],Ns=Vi[1]-Oo[1];Jn=xs*xs+Ns*Ns}}function Fa(){var Ei,Li,oi,_i,hi=t.touches(mn);ks.call(mn);for(var mo=0,Vi=hi.length;mo<Vi;++mo,_i=null)if(oi=hi[mo],_i=Fn[oi.identifier]){if(Li)break;Ei=oi,Li=_i}if(_i){var Oo=(Oo=oi[0]-Ei[0])*Oo+(Oo=oi[1]-Ei[1])*Oo,xs=Jn&&Math.sqrt(Oo/Jn);Ei=[(Ei[0]+oi[0])/2,(Ei[1]+oi[1])/2],Li=[(Li[0]+_i[0])/2,(Li[1]+_i[1])/2],er(xs*jr)}j=null,cr(Ei,Li),Gr(Un)}function si(){if(t.event.touches.length){for(var Ei=t.event.changedTouches,Li=0,oi=Ei.length;Li<oi;++Li)delete Fn[Ei[Li].identifier];for(var _i in Fn)return void ya()}t.selectAll(va).on(sa,null),pa.on(kt,$r).on(vt,In),Ea(),an(Un)}La(),Yr(Un),pa.on(kt,null).on(vt,La)}function jn(){var jr=Dt.of(this,arguments);R?clearTimeout(R):(ks.call(this),oe=Ft(M=O||t.mouse(this)),Yr(jr)),R=setTimeout(function(){R=null,an(jr)},50),Y(),er(Math.pow(2,.002*ze())*_e.k),cr(M,oe),Gr(jr)}function ia(){var jr=t.mouse(this),mn=Math.log(_e.k)/Math.LN2;Ar(this,jr,Ft(jr),t.event.shiftKey?Math.ceil(mn)-1:Math.floor(mn)+1)}return qe||(qe="onwheel"in u?(ze=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in u?(ze=function(){return t.event.wheelDelta},"mousewheel"):(ze=function(){return-t.event.detail},"MozMousePixelScroll")),Pt.event=function(jr){jr.each(function(){var mn=Dt.of(this,arguments),Un=_e;ps?t.select(this).transition().each("start.zoom",function(){_e=this.__chart__||{x:0,y:0,k:1},Yr(mn)}).tween("zoom:zoom",function(){var Fn=Ne[0],Jn=Ne[1],sa=M?M[0]:Fn/2,ka=M?M[1]:Jn/2,qn=t.interpolateZoom([(sa-_e.x)/_e.k,(ka-_e.y)/_e.k,Fn/_e.k],[(sa-Un.x)/Un.k,(ka-Un.y)/Un.k,Fn/Un.k]);return function(va){var pa=qn(va),Ea=Fn/pa[2];this.__chart__=_e={x:sa-pa[0]*Ea,y:ka-pa[1]*Ea,k:Ea},Gr(mn)}}).each("interrupt.zoom",function(){an(mn)}).each("end.zoom",function(){an(mn)}):(this.__chart__=_e,Yr(mn),Gr(mn),an(mn))})},Pt.translate=function(jr){return arguments.length?(_e={x:+jr[0],y:+jr[1],k:_e.k},Tr(),Pt):[_e.x,_e.y]},Pt.scale=function(jr){return arguments.length?(_e={x:_e.x,y:_e.y,k:null},er(+jr),Tr(),Pt):_e.k},Pt.scaleExtent=function(jr){return arguments.length?(He=jr==null?ht:[+jr[0],+jr[1]],Pt):He},Pt.center=function(jr){return arguments.length?(O=jr&&[+jr[0],+jr[1]],Pt):O},Pt.size=function(jr){return arguments.length?(Ne=jr&&[+jr[0],+jr[1]],Pt):Ne},Pt.duration=function(jr){return arguments.length?(et=+jr,Pt):et},Pt.x=function(jr){return arguments.length?(le=jr,te=jr.copy(),_e={x:0,y:0,k:1},Pt):le},Pt.y=function(jr){return arguments.length?(ye=jr,pe=jr.copy(),_e={x:0,y:0,k:1},Pt):ye},t.rebind(Pt,Dt,"on")};var ze,qe,ht=[0,1/0];function at(){}function nt(oe,M,O){return this instanceof nt?(this.h=+oe,this.s=+M,void(this.l=+O)):arguments.length<2?oe instanceof nt?new nt(oe.h,oe.s,oe.l):Lr(""+oe,dr,nt):new nt(oe,M,O)}t.color=at,at.prototype.toString=function(){return this.rgb()+""},t.hsl=nt;var xt=nt.prototype=new at;function Lt(oe,M,O){var R,j;function te(le){return Math.round(255*function(pe){return pe>360?pe-=360:pe<0&&(pe+=360),pe<60?R+(j-R)*pe/60:pe<180?j:pe<240?R+(j-R)*(240-pe)/60:R}(le))}return oe=isNaN(oe)?0:(oe%=360)<0?oe+360:oe,M=isNaN(M)||M<0?0:M>1?1:M,R=2*(O=O<0?0:O>1?1:O)-(j=O<=.5?O*(1+M):O+M-O*M),new Ht(te(oe+120),te(oe),te(oe-120))}function bt(oe,M,O){return this instanceof bt?(this.h=+oe,this.c=+M,void(this.l=+O)):arguments.length<2?oe instanceof bt?new bt(oe.h,oe.c,oe.l):Ce(oe instanceof It?oe.l:(oe=Kt((oe=t.rgb(oe)).r,oe.g,oe.b)).l,oe.a,oe.b):new bt(oe,M,O)}xt.brighter=function(oe){return oe=Math.pow(.7,arguments.length?oe:1),new nt(this.h,this.s,this.l/oe)},xt.darker=function(oe){return oe=Math.pow(.7,arguments.length?oe:1),new nt(this.h,this.s,oe*this.l)},xt.rgb=function(){return Lt(this.h,this.s,this.l)},t.hcl=bt;var St=bt.prototype=new at;function st(oe,M,O){return isNaN(oe)&&(oe=0),isNaN(M)&&(M=0),new It(O,Math.cos(oe*=Ct)*M,Math.sin(oe)*M)}function It(oe,M,O){return this instanceof It?(this.l=+oe,this.a=+M,void(this.b=+O)):arguments.length<2?oe instanceof It?new It(oe.l,oe.a,oe.b):oe instanceof bt?st(oe.h,oe.c,oe.l):Kt((oe=Ht(oe)).r,oe.g,oe.b):new It(oe,M,O)}St.brighter=function(oe){return new bt(this.h,this.c,Math.min(100,this.l+jt*(arguments.length?oe:1)))},St.darker=function(oe){return new bt(this.h,this.c,Math.max(0,this.l-jt*(arguments.length?oe:1)))},St.rgb=function(){return st(this.h,this.c,this.l).rgb()},t.lab=It;var jt=18,Ut=It.prototype=new at;function zt(oe,M,O){var R=(oe+16)/116,j=R+M/500,te=R-O/200;return new Ht(Bt(3.2404542*(j=.95047*lt(j))-1.5371385*(R=1*lt(R))-.4985314*(te=1.08883*lt(te))),Bt(-.969266*j+1.8760108*R+.041556*te),Bt(.0556434*j-.2040259*R+1.0572252*te))}function Ce(oe,M,O){return oe>0?new bt(Math.atan2(O,M)*Ie,Math.sqrt(M*M+O*O),oe):new bt(NaN,NaN,oe)}function lt(oe){return oe>.206893034?oe*oe*oe:(oe-4/29)/7.787037}function At(oe){return oe>.008856?Math.pow(oe,1/3):7.787037*oe+4/29}function Bt(oe){return Math.round(255*(oe<=.00304?12.92*oe:1.055*Math.pow(oe,1/2.4)-.055))}function Ht(oe,M,O){return this instanceof Ht?(this.r=~~oe,this.g=~~M,void(this.b=~~O)):arguments.length<2?oe instanceof Ht?new Ht(oe.r,oe.g,oe.b):Lr(""+oe,Ht,Lt):new Ht(oe,M,O)}function or(oe){return new Ht(oe>>16,oe>>8&255,255&oe)}function ar(oe){return or(oe)+""}Ut.brighter=function(oe){return new It(Math.min(100,this.l+jt*(arguments.length?oe:1)),this.a,this.b)},Ut.darker=function(oe){return new It(Math.max(0,this.l-jt*(arguments.length?oe:1)),this.a,this.b)},Ut.rgb=function(){return zt(this.l,this.a,this.b)},t.rgb=Ht;var Nt=Ht.prototype=new at;function nr(oe){return oe<16?"0"+Math.max(0,oe).toString(16):Math.min(255,oe).toString(16)}function Lr(oe,M,O){var R,j,te,le=0,pe=0,ye=0;if(R=/([a-z]+)\((.*)\)/.exec(oe=oe.toLowerCase()))switch(j=R[2].split(","),R[1]){case"hsl":return O(parseFloat(j[0]),parseFloat(j[1])/100,parseFloat(j[2])/100);case"rgb":return M(xr(j[0]),xr(j[1]),xr(j[2]))}return(te=gr.get(oe))?M(te.r,te.g,te.b):(oe==null||oe.charAt(0)!=="#"||isNaN(te=parseInt(oe.slice(1),16))||(oe.length===4?(le=(3840&te)>>4,le|=le>>4,pe=240&te,pe|=pe>>4,ye=15&te,ye|=ye<<4):oe.length===7&&(le=(16711680&te)>>16,pe=(65280&te)>>8,ye=255&te)),M(le,pe,ye))}function dr(oe,M,O){var R,j,te=Math.min(oe/=255,M/=255,O/=255),le=Math.max(oe,M,O),pe=le-te,ye=(le+te)/2;return pe?(j=ye<.5?pe/(le+te):pe/(2-le-te),R=oe==le?(M-O)/pe+(M<O?6:0):M==le?(O-oe)/pe+2:(oe-M)/pe+4,R*=60):(R=NaN,j=ye>0&&ye<1?0:R),new nt(R,j,ye)}function Kt(oe,M,O){var R=At((.4124564*(oe=yr(oe))+.3575761*(M=yr(M))+.1804375*(O=yr(O)))/.95047),j=At((.2126729*oe+.7151522*M+.072175*O)/1);return It(116*j-16,500*(R-j),200*(j-At((.0193339*oe+.119192*M+.9503041*O)/1.08883)))}function yr(oe){return(oe/=255)<=.04045?oe/12.92:Math.pow((oe+.055)/1.055,2.4)}function xr(oe){var M=parseFloat(oe);return oe.charAt(oe.length-1)==="%"?Math.round(2.55*M):M}Nt.brighter=function(oe){oe=Math.pow(.7,arguments.length?oe:1);var M=this.r,O=this.g,R=this.b,j=30;return M||O||R?(M&&M<j&&(M=j),O&&O<j&&(O=j),R&&R<j&&(R=j),new Ht(Math.min(255,M/oe),Math.min(255,O/oe),Math.min(255,R/oe))):new Ht(j,j,j)},Nt.darker=function(oe){return new Ht((oe=Math.pow(.7,arguments.length?oe:1))*this.r,oe*this.g,oe*this.b)},Nt.hsl=function(){return dr(this.r,this.g,this.b)},Nt.toString=function(){return"#"+nr(this.r)+nr(this.g)+nr(this.b)};var gr=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function wr(oe){return typeof oe=="function"?oe:function(){return oe}}function zr(oe){return function(M,O,R){return arguments.length===2&&typeof O=="function"&&(R=O,O=null),Rr(M,O,oe,R)}}function Rr(oe,M,O,R){var j={},te=t.dispatch("beforesend","progress","load","error"),le={},pe=new XMLHttpRequest,ye=null;function _e(){var Ne,He=pe.status;if(!He&&function(et){var yt=et.responseType;return yt&&yt!=="text"?et.response:et.responseText}(pe)||He>=200&&He<300||He===304){try{Ne=O.call(j,pe)}catch(et){return void te.error.call(j,et)}te.load.call(j,Ne)}else te.error.call(j,pe)}return self.XDomainRequest&&!("withCredentials"in pe)&&/^(http(s)?:)?\/\//.test(oe)&&(pe=new XDomainRequest),"onload"in pe?pe.onload=pe.onerror=_e:pe.onreadystatechange=function(){pe.readyState>3&&_e()},pe.onprogress=function(Ne){var He=t.event;t.event=Ne;try{te.progress.call(j,pe)}finally{t.event=He}},j.header=function(Ne,He){return Ne=(Ne+"").toLowerCase(),arguments.length<2?le[Ne]:(He==null?delete le[Ne]:le[Ne]=He+"",j)},j.mimeType=function(Ne){return arguments.length?(M=Ne==null?null:Ne+"",j):M},j.responseType=function(Ne){return arguments.length?(ye=Ne,j):ye},j.response=function(Ne){return O=Ne,j},["get","post"].forEach(function(Ne){j[Ne]=function(){return j.send.apply(j,[Ne].concat(p(arguments)))}}),j.send=function(Ne,He,et){if(arguments.length===2&&typeof He=="function"&&(et=He,He=null),pe.open(Ne,oe,!0),M==null||"accept"in le||(le.accept=M+",*/*"),pe.setRequestHeader)for(var yt in le)pe.setRequestHeader(yt,le[yt]);return M!=null&&pe.overrideMimeType&&pe.overrideMimeType(M),ye!=null&&(pe.responseType=ye),et!=null&&j.on("error",et).on("load",function(kt){et(null,kt)}),te.beforesend.call(j,pe),pe.send(He??null),j},j.abort=function(){return pe.abort(),j},t.rebind(j,te,"on"),R==null?j:j.get(function(Ne){return Ne.length===1?function(He,et){Ne(He==null?et:null)}:Ne}(R))}gr.forEach(function(oe,M){gr.set(oe,or(M))}),t.functor=wr,t.xhr=zr(z),t.dsv=function(oe,M){var O=new RegExp('["'+oe+`
]`),R=oe.charCodeAt(0);function j(_e,Ne,He){arguments.length<3&&(He=Ne,Ne=null);var et=Rr(_e,M,Ne==null?te:le(Ne),He);return et.row=function(yt){return arguments.length?et.response((Ne=yt)==null?te:le(yt)):Ne},et}function te(_e){return j.parse(_e.responseText)}function le(_e){return function(Ne){return j.parse(Ne.responseText,_e)}}function pe(_e){return _e.map(ye).join(oe)}function ye(_e){return O.test(_e)?'"'+_e.replace(/\"/g,'""')+'"':_e}return j.parse=function(_e,Ne){var He;return j.parseRows(_e,function(et,yt){if(He)return He(et,yt-1);var kt=function(_t){for(var wt={},vt=et.length,Dt=0;Dt<vt;++Dt)wt[et[Dt]]=_t[Dt];return wt};He=Ne?function(_t,wt){return Ne(kt(_t),wt)}:kt})},j.parseRows=function(_e,Ne){var He,et,yt={},kt={},_t=[],wt=_e.length,vt=0,Dt=0;function Pt(){if(vt>=wt)return kt;if(et)return et=!1,yt;var er=vt;if(_e.charCodeAt(er)===34){for(var cr=er;cr++<wt;)if(_e.charCodeAt(cr)===34){if(_e.charCodeAt(cr+1)!==34)break;++cr}return vt=cr+2,(Ar=_e.charCodeAt(cr+1))===13?(et=!0,_e.charCodeAt(cr+2)===10&&++vt):Ar===10&&(et=!0),_e.slice(er+1,cr).replace(/""/g,'"')}for(;vt<wt;){var Ar,Tr=1;if((Ar=_e.charCodeAt(vt++))===10)et=!0;else if(Ar===13)et=!0,_e.charCodeAt(vt)===10&&(++vt,++Tr);else if(Ar!==R)continue;return _e.slice(er,vt-Tr)}return _e.slice(er)}for(;(He=Pt())!==kt;){for(var Ft=[];He!==yt&&He!==kt;)Ft.push(He),He=Pt();Ne&&(Ft=Ne(Ft,Dt++))==null||_t.push(Ft)}return _t},j.format=function(_e){if(Array.isArray(_e[0]))return j.formatRows(_e);var Ne=new P,He=[];return _e.forEach(function(et){for(var yt in et)Ne.has(yt)||He.push(Ne.add(yt))}),[He.map(ye).join(oe)].concat(_e.map(function(et){return He.map(function(yt){return ye(et[yt])}).join(oe)})).join(`
`)},j.formatRows=function(_e){return _e.map(pe).join(`
`)},j},t.csv=t.dsv(",","text/csv"),t.tsv=t.dsv("	","text/tab-separated-values");var Wr,gn,rn,Zr,bn=this[q(this,"requestAnimationFrame")]||function(oe){setTimeout(oe,17)};function Dr(oe,M,O){var R=arguments.length;R<2&&(M=0),R<3&&(O=Date.now());var j=O+M,te={c:oe,t:j,n:null};return gn?gn.n=te:Wr=te,gn=te,rn||(Zr=clearTimeout(Zr),rn=1,bn(br)),te}function br(){var oe=Xr(),M=fn()-oe;M>24?(isFinite(M)&&(clearTimeout(Zr),Zr=setTimeout(br,M)),rn=0):(rn=1,bn(br))}function Xr(){for(var oe=Date.now(),M=Wr;M;)oe>=M.t&&M.c(oe-M.t)&&(M.c=null),M=M.n;return oe}function fn(){for(var oe,M=Wr,O=1/0;M;)M.c?(M.t<O&&(O=M.t),M=(oe=M).n):M=oe?oe.n=M.n:Wr=M.n;return gn=oe,O}function Qr(oe){return oe[0]}function un(oe){return oe[1]}function Pn(oe){for(var M,O,R,j=oe.length,te=[0,1],le=2,pe=2;pe<j;pe++){for(;le>1&&(M=oe[te[le-2]],O=oe[te[le-1]],R=oe[pe],(O[0]-M[0])*(R[1]-M[1])-(O[1]-M[1])*(R[0]-M[0])<=0);)--le;te[le++]=pe}return te.slice(0,le)}function kn(oe,M){return oe[0]-M[0]||oe[1]-M[1]}t.timer=function(){Dr.apply(this,arguments)},t.timer.flush=function(){Xr(),fn()},t.round=function(oe,M){return M?Math.round(oe*(M=Math.pow(10,M)))/M:Math.round(oe)},t.geom={},t.geom.hull=function(oe){var M=Qr,O=un;if(arguments.length)return R(oe);function R(j){if(j.length<3)return[];var te,le=wr(M),pe=wr(O),ye=j.length,_e=[],Ne=[];for(te=0;te<ye;te++)_e.push([+le.call(this,j[te],te),+pe.call(this,j[te],te),te]);for(_e.sort(kn),te=0;te<ye;te++)Ne.push([_e[te][0],-_e[te][1]]);var He=Pn(_e),et=Pn(Ne),yt=et[0]===He[0],kt=et[et.length-1]===He[He.length-1],_t=[];for(te=He.length-1;te>=0;--te)_t.push(j[_e[He[te]][2]]);for(te=+yt;te<et.length-kt;++te)_t.push(j[_e[et[te]][2]]);return _t}return R.x=function(j){return arguments.length?(M=j,R):M},R.y=function(j){return arguments.length?(O=j,R):O},R},t.geom.polygon=function(oe){return U(oe,Hn),oe};var Hn=t.geom.polygon.prototype=[];function aa(oe,M,O){return(O[0]-M[0])*(oe[1]-M[1])<(O[1]-M[1])*(oe[0]-M[0])}function gt(oe,M,O,R){var j=oe[0],te=O[0],le=M[0]-j,pe=R[0]-te,ye=oe[1],_e=O[1],Ne=M[1]-ye,He=R[1]-_e,et=(pe*(ye-_e)-He*(j-te))/(He*le-pe*Ne);return[j+et*le,ye+et*Ne]}function Qt(oe){var M=oe[0],O=oe[oe.length-1];return!(M[0]-O[0]||M[1]-O[1])}Hn.area=function(){for(var oe,M=-1,O=this.length,R=this[O-1],j=0;++M<O;)oe=R,R=this[M],j+=oe[1]*R[0]-oe[0]*R[1];return .5*j},Hn.centroid=function(oe){var M,O,R=-1,j=this.length,te=0,le=0,pe=this[j-1];for(arguments.length||(oe=-1/(6*this.area()));++R<j;)M=pe,pe=this[R],O=M[0]*pe[1]-pe[0]*M[1],te+=(M[0]+pe[0])*O,le+=(M[1]+pe[1])*O;return[te*oe,le*oe]},Hn.clip=function(oe){for(var M,O,R,j,te,le,pe=Qt(oe),ye=-1,_e=this.length-Qt(this),Ne=this[_e-1];++ye<_e;){for(M=oe.slice(),oe.length=0,j=this[ye],te=M[(R=M.length-pe)-1],O=-1;++O<R;)aa(le=M[O],Ne,j)?(aa(te,Ne,j)||oe.push(gt(te,le,Ne,j)),oe.push(le)):aa(te,Ne,j)&&oe.push(gt(te,le,Ne,j)),te=le;pe&&oe.push(oe[0]),Ne=j}return oe};var Zt,pr,Mr,Vr,kr,ur=[],Ir=[];function mr(){ri(this),this.edge=this.site=this.circle=null}function _r(oe){var M=ur.pop()||new mr;return M.site=oe,M}function Nr(oe){Nn(oe),Mr.remove(oe),ur.push(oe),ri(oe)}function vn(oe){var M=oe.circle,O=M.x,R=M.cy,j={x:O,y:R},te=oe.P,le=oe.N,pe=[oe];Nr(oe);for(var ye=te;ye.circle&&v(O-ye.circle.x)<Mt&&v(R-ye.circle.cy)<Mt;)te=ye.P,pe.unshift(ye),Nr(ye),ye=te;pe.unshift(ye),Nn(ye);for(var _e=le;_e.circle&&v(O-_e.circle.x)<Mt&&v(R-_e.circle.cy)<Mt;)le=_e.N,pe.push(_e),Nr(_e),_e=le;pe.push(_e),Nn(_e);var Ne,He=pe.length;for(Ne=1;Ne<He;++Ne)_e=pe[Ne],ye=pe[Ne-1],ua(_e.edge,ye.site,_e.site,j);ye=pe[0],(_e=pe[He-1]).edge=cn(ye.site,_e.site,null,j),On(ye),On(_e)}function xn(oe){for(var M,O,R,j,te=oe.x,le=oe.y,pe=Mr._;pe;)if((R=wn(pe,le)-te)>Mt)pe=pe.L;else{if(!((j=te-ln(pe,le))>Mt)){R>-Mt?(M=pe.P,O=pe):j>-Mt?(M=pe,O=pe.N):M=O=pe;break}if(!pe.R){M=pe;break}pe=pe.R}var ye=_r(oe);if(Mr.insert(M,ye),M||O){if(M===O)return Nn(M),O=_r(M.site),Mr.insert(ye,O),ye.edge=O.edge=cn(M.site,ye.site),On(M),void On(O);if(O){Nn(M),Nn(O);var _e=M.site,Ne=_e.x,He=_e.y,et=oe.x-Ne,yt=oe.y-He,kt=O.site,_t=kt.x-Ne,wt=kt.y-He,vt=2*(et*wt-yt*_t),Dt=et*et+yt*yt,Pt=_t*_t+wt*wt,Ft={x:(wt*Dt-yt*Pt)/vt+Ne,y:(et*Pt-_t*Dt)/vt+He};ua(O.edge,_e,kt,Ft),ye.edge=cn(_e,oe,null,Ft),O.edge=cn(oe,kt,null,Ft),On(M),On(O)}else ye.edge=cn(M.site,ye.site)}}function wn(oe,M){var O=oe.site,R=O.x,j=O.y,te=j-M;if(!te)return R;var le=oe.P;if(!le)return-1/0;var pe=(O=le.site).x,ye=O.y,_e=ye-M;if(!_e)return pe;var Ne=pe-R,He=1/te-1/_e,et=Ne/_e;return He?(-et+Math.sqrt(et*et-2*He*(Ne*Ne/(-2*_e)-ye+_e/2+j-te/2)))/He+R:(R+pe)/2}function ln(oe,M){var O=oe.N;if(O)return wn(O,M);var R=oe.site;return R.y===M?R.x:1/0}function zn(oe){this.site=oe,this.edges=[]}function ca(oe,M){return M.angle-oe.angle}function Kn(){ri(this),this.x=this.y=this.arc=this.site=this.cy=null}function On(oe){var M=oe.P,O=oe.N;if(M&&O){var R=M.site,j=oe.site,te=O.site;if(R!==te){var le=j.x,pe=j.y,ye=R.x-le,_e=R.y-pe,Ne=te.x-le,He=2*(ye*(wt=te.y-pe)-_e*Ne);if(!(He>=-1e-12)){var et=ye*ye+_e*_e,yt=Ne*Ne+wt*wt,kt=(wt*et-_e*yt)/He,_t=(ye*yt-Ne*et)/He,wt=_t+pe,vt=Ir.pop()||new Kn;vt.arc=oe,vt.site=j,vt.x=kt+le,vt.y=wt+Math.sqrt(kt*kt+_t*_t),vt.cy=wt,oe.circle=vt;for(var Dt=null,Pt=kr._;Pt;)if(vt.y<Pt.y||vt.y===Pt.y&&vt.x<=Pt.x){if(!Pt.L){Dt=Pt.P;break}Pt=Pt.L}else{if(!Pt.R){Dt=Pt;break}Pt=Pt.R}kr.insert(Dt,vt),Dt||(Vr=vt)}}}}function Nn(oe){var M=oe.circle;M&&(M.P||(Vr=M.N),kr.remove(M),Ir.push(M),ri(M),oe.circle=null)}function ba(oe,M){var O=oe.b;if(O)return!0;var R,j,te=oe.a,le=M[0][0],pe=M[1][0],ye=M[0][1],_e=M[1][1],Ne=oe.l,He=oe.r,et=Ne.x,yt=Ne.y,kt=He.x,_t=He.y,wt=(et+kt)/2,vt=(yt+_t)/2;if(_t===yt){if(wt<le||wt>=pe)return;if(et>kt){if(te){if(te.y>=_e)return}else te={x:wt,y:ye};O={x:wt,y:_e}}else{if(te){if(te.y<ye)return}else te={x:wt,y:_e};O={x:wt,y:ye}}}else if(j=vt-(R=(et-kt)/(_t-yt))*wt,R<-1||R>1)if(et>kt){if(te){if(te.y>=_e)return}else te={x:(ye-j)/R,y:ye};O={x:(_e-j)/R,y:_e}}else{if(te){if(te.y<ye)return}else te={x:(_e-j)/R,y:_e};O={x:(ye-j)/R,y:ye}}else if(yt<_t){if(te){if(te.x>=pe)return}else te={x:le,y:R*le+j};O={x:pe,y:R*pe+j}}else{if(te){if(te.x<le)return}else te={x:pe,y:R*pe+j};O={x:le,y:R*le+j}}return oe.a=te,oe.b=O,!0}function Wn(oe,M){this.l=oe,this.r=M,this.a=this.b=null}function cn(oe,M,O,R){var j=new Wn(oe,M);return Zt.push(j),O&&ua(j,oe,M,O),R&&ua(j,M,oe,R),pr[oe.i].edges.push(new Xa(j,oe,M)),pr[M.i].edges.push(new Xa(j,M,oe)),j}function $n(oe,M,O){var R=new Wn(oe,null);return R.a=M,R.b=O,Zt.push(R),R}function ua(oe,M,O,R){oe.a||oe.b?oe.l===O?oe.b=R:oe.a=R:(oe.a=R,oe.l=M,oe.r=O)}function Xa(oe,M,O){var R=oe.a,j=oe.b;this.edge=oe,this.site=M,this.angle=O?Math.atan2(O.y-M.y,O.x-M.x):oe.l===M?Math.atan2(j.x-R.x,R.y-j.y):Math.atan2(R.x-j.x,j.y-R.y)}function Ci(){this._=null}function ri(oe){oe.U=oe.C=oe.L=oe.R=oe.P=oe.N=null}function vi(oe,M){var O=M,R=M.R,j=O.U;j?j.L===O?j.L=R:j.R=R:oe._=R,R.U=j,O.U=R,O.R=R.L,O.R&&(O.R.U=O),R.L=O}function Aa(oe,M){var O=M,R=M.L,j=O.U;j?j.L===O?j.L=R:j.R=R:oe._=R,R.U=j,O.U=R,O.L=R.R,O.L&&(O.L.U=O),R.R=O}function Na(oe){for(;oe.L;)oe=oe.L;return oe}function co(oe,M){var O,R,j,te=oe.sort(Fo).pop();for(Zt=[],pr=new Array(oe.length),Mr=new Ci,kr=new Ci;;)if(j=Vr,te&&(!j||te.y<j.y||te.y===j.y&&te.x<j.x))te.x===O&&te.y===R||(pr[te.i]=new zn(te),xn(te),O=te.x,R=te.y),te=oe.pop();else{if(!j)break;vn(j.arc)}M&&(function(pe){for(var ye,_e,Ne,He,et,yt=Zt,kt=(_e=pe[0][0],Ne=pe[0][1],He=pe[1][0],et=pe[1][1],function(wt){var vt,Dt=wt.a,Pt=wt.b,Ft=Dt.x,er=Dt.y,cr=0,Ar=1,Tr=Pt.x-Ft,Yr=Pt.y-er;if(vt=_e-Ft,Tr||!(vt>0)){if(vt/=Tr,Tr<0){if(vt<cr)return;vt<Ar&&(Ar=vt)}else if(Tr>0){if(vt>Ar)return;vt>cr&&(cr=vt)}if(vt=He-Ft,Tr||!(vt<0)){if(vt/=Tr,Tr<0){if(vt>Ar)return;vt>cr&&(cr=vt)}else if(Tr>0){if(vt<cr)return;vt<Ar&&(Ar=vt)}if(vt=Ne-er,Yr||!(vt>0)){if(vt/=Yr,Yr<0){if(vt<cr)return;vt<Ar&&(Ar=vt)}else if(Yr>0){if(vt>Ar)return;vt>cr&&(cr=vt)}if(vt=et-er,Yr||!(vt<0)){if(vt/=Yr,Yr<0){if(vt>Ar)return;vt>cr&&(cr=vt)}else if(Yr>0){if(vt<cr)return;vt<Ar&&(Ar=vt)}return cr>0&&(wt.a={x:Ft+cr*Tr,y:er+cr*Yr}),Ar<1&&(wt.b={x:Ft+Ar*Tr,y:er+Ar*Yr}),wt}}}}}),_t=yt.length;_t--;)(!ba(ye=yt[_t],pe)||!kt(ye)||v(ye.a.x-ye.b.x)<Mt&&v(ye.a.y-ye.b.y)<Mt)&&(ye.a=ye.b=null,yt.splice(_t,1))}(M),function(pe){for(var ye,_e,Ne,He,et,yt,kt,_t,wt,vt,Dt=pe[0][0],Pt=pe[1][0],Ft=pe[0][1],er=pe[1][1],cr=pr,Ar=cr.length;Ar--;)if((et=cr[Ar])&&et.prepare())for(_t=(kt=et.edges).length,yt=0;yt<_t;)Ne=(vt=kt[yt].end()).x,He=vt.y,ye=(wt=kt[++yt%_t].start()).x,_e=wt.y,(v(Ne-ye)>Mt||v(He-_e)>Mt)&&(kt.splice(yt,0,new Xa($n(et.site,vt,v(Ne-Dt)<Mt&&er-He>Mt?{x:Dt,y:v(ye-Dt)<Mt?_e:er}:v(He-er)<Mt&&Pt-Ne>Mt?{x:v(_e-er)<Mt?ye:Pt,y:er}:v(Ne-Pt)<Mt&&He-Ft>Mt?{x:Pt,y:v(ye-Pt)<Mt?_e:Ft}:v(He-Ft)<Mt&&Ne-Dt>Mt?{x:v(_e-Ft)<Mt?ye:Dt,y:Ft}:null),et.site,null)),++_t)}(M));var le={cells:pr,edges:Zt};return Mr=kr=Zt=pr=null,le}function Fo(oe,M){return M.y-oe.y||M.x-oe.x}zn.prototype.prepare=function(){for(var oe,M=this.edges,O=M.length;O--;)(oe=M[O].edge).b&&oe.a||M.splice(O,1);return M.sort(ca),M.length},Xa.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Ci.prototype={insert:function(oe,M){var O,R,j;if(oe){if(M.P=oe,M.N=oe.N,oe.N&&(oe.N.P=M),oe.N=M,oe.R){for(oe=oe.R;oe.L;)oe=oe.L;oe.L=M}else oe.R=M;O=oe}else this._?(oe=Na(this._),M.P=null,M.N=oe,oe.P=oe.L=M,O=oe):(M.P=M.N=null,this._=M,O=null);for(M.L=M.R=null,M.U=O,M.C=!0,oe=M;O&&O.C;)O===(R=O.U).L?(j=R.R)&&j.C?(O.C=j.C=!1,R.C=!0,oe=R):(oe===O.R&&(vi(this,O),O=(oe=O).U),O.C=!1,R.C=!0,Aa(this,R)):(j=R.L)&&j.C?(O.C=j.C=!1,R.C=!0,oe=R):(oe===O.L&&(Aa(this,O),O=(oe=O).U),O.C=!1,R.C=!0,vi(this,R)),O=oe.U;this._.C=!1},remove:function(oe){oe.N&&(oe.N.P=oe.P),oe.P&&(oe.P.N=oe.N),oe.N=oe.P=null;var M,O,R,j=oe.U,te=oe.L,le=oe.R;if(O=te?le?Na(le):te:le,j?j.L===oe?j.L=O:j.R=O:this._=O,te&&le?(R=O.C,O.C=oe.C,O.L=te,te.U=O,O!==le?(j=O.U,O.U=oe.U,oe=O.R,j.L=oe,O.R=le,le.U=O):(O.U=j,j=O,oe=O.R)):(R=oe.C,oe=O),oe&&(oe.U=j),!R)if(oe&&oe.C)oe.C=!1;else{do{if(oe===this._)break;if(oe===j.L){if((M=j.R).C&&(M.C=!1,j.C=!0,vi(this,j),M=j.R),M.L&&M.L.C||M.R&&M.R.C){M.R&&M.R.C||(M.L.C=!1,M.C=!0,Aa(this,M),M=j.R),M.C=j.C,j.C=M.R.C=!1,vi(this,j),oe=this._;break}}else if((M=j.L).C&&(M.C=!1,j.C=!0,Aa(this,j),M=j.L),M.L&&M.L.C||M.R&&M.R.C){M.L&&M.L.C||(M.R.C=!1,M.C=!0,vi(this,M),M=j.L),M.C=j.C,j.C=M.L.C=!1,Aa(this,j),oe=this._;break}M.C=!0,oe=j,j=j.U}while(!oe.C);oe&&(oe.C=!1)}}},t.geom.voronoi=function(oe){var M=Qr,O=un,R=M,j=O,te=Yo;if(oe)return le(oe);function le(ye){var _e=new Array(ye.length),Ne=te[0][0],He=te[0][1],et=te[1][0],yt=te[1][1];return co(pe(ye),te).cells.forEach(function(kt,_t){var wt=kt.edges,vt=kt.site;(_e[_t]=wt.length?wt.map(function(Dt){var Pt=Dt.start();return[Pt.x,Pt.y]}):vt.x>=Ne&&vt.x<=et&&vt.y>=He&&vt.y<=yt?[[Ne,yt],[et,yt],[et,He],[Ne,He]]:[]).point=ye[_t]}),_e}function pe(ye){return ye.map(function(_e,Ne){return{x:Math.round(R(_e,Ne)/Mt)*Mt,y:Math.round(j(_e,Ne)/Mt)*Mt,i:Ne}})}return le.links=function(ye){return co(pe(ye)).edges.filter(function(_e){return _e.l&&_e.r}).map(function(_e){return{source:ye[_e.l.i],target:ye[_e.r.i]}})},le.triangles=function(ye){var _e=[];return co(pe(ye)).cells.forEach(function(Ne,He){for(var et,yt,kt,_t,wt=Ne.site,vt=Ne.edges.sort(ca),Dt=-1,Pt=vt.length,Ft=vt[Pt-1].edge,er=Ft.l===wt?Ft.r:Ft.l;++Dt<Pt;)et=er,er=(Ft=vt[Dt].edge).l===wt?Ft.r:Ft.l,He<et.i&&He<er.i&&(kt=et,_t=er,((yt=wt).x-_t.x)*(kt.y-yt.y)-(yt.x-kt.x)*(_t.y-yt.y)<0)&&_e.push([ye[He],ye[et.i],ye[er.i]])}),_e},le.x=function(ye){return arguments.length?(R=wr(M=ye),le):M},le.y=function(ye){return arguments.length?(j=wr(O=ye),le):O},le.clipExtent=function(ye){return arguments.length?(te=ye??Yo,le):te===Yo?null:te},le.size=function(ye){return arguments.length?le.clipExtent(ye&&[[0,0],ye]):te===Yo?null:te&&te[1]},le};var Yo=[[-1e6,-1e6],[1e6,1e6]];function Hi(oe){return oe.x}function Wi(oe){return oe.y}function Bo(oe,M,O,R,j,te){if(!oe(M,O,R,j,te)){var le=.5*(O+j),pe=.5*(R+te),ye=M.nodes;ye[0]&&Bo(oe,ye[0],O,R,le,pe),ye[1]&&Bo(oe,ye[1],le,R,j,pe),ye[2]&&Bo(oe,ye[2],O,pe,le,te),ye[3]&&Bo(oe,ye[3],le,pe,j,te)}}function Va(oe,M,O,R,j,te,le){var pe,ye=1/0;return function _e(Ne,He,et,yt,kt){if(!(He>te||et>le||yt<R||kt<j)){if(_t=Ne.point){var _t,wt=M-Ne.x,vt=O-Ne.y,Dt=wt*wt+vt*vt;if(Dt<ye){var Pt=Math.sqrt(ye=Dt);R=M-Pt,j=O-Pt,te=M+Pt,le=O+Pt,pe=_t}}for(var Ft=Ne.nodes,er=.5*(He+yt),cr=.5*(et+kt),Ar=(O>=cr)<<1|M>=er,Tr=Ar+4;Ar<Tr;++Ar)if(Ne=Ft[3&Ar])switch(3&Ar){case 0:_e(Ne,He,et,er,cr);break;case 1:_e(Ne,er,et,yt,cr);break;case 2:_e(Ne,He,cr,er,kt);break;case 3:_e(Ne,er,cr,yt,kt)}}}(oe,R,j,te,le),pe}function ko(oe,M){oe=t.rgb(oe),M=t.rgb(M);var O=oe.r,R=oe.g,j=oe.b,te=M.r-O,le=M.g-R,pe=M.b-j;return function(ye){return"#"+nr(Math.round(O+te*ye))+nr(Math.round(R+le*ye))+nr(Math.round(j+pe*ye))}}function uo(oe,M){var O,R={},j={};for(O in oe)O in M?R[O]=Di(oe[O],M[O]):j[O]=oe[O];for(O in M)O in oe||(j[O]=M[O]);return function(te){for(O in R)j[O]=R[O](te);return j}}function yi(oe,M){return oe=+oe,M=+M,function(O){return oe*(1-O)+M*O}}function Xi(oe,M){var O,R,j,te=fo.lastIndex=_o.lastIndex=0,le=-1,pe=[],ye=[];for(oe+="",M+="";(O=fo.exec(oe))&&(R=_o.exec(M));)(j=R.index)>te&&(j=M.slice(te,j),pe[le]?pe[le]+=j:pe[++le]=j),(O=O[0])===(R=R[0])?pe[le]?pe[le]+=R:pe[++le]=R:(pe[++le]=null,ye.push({i:le,x:yi(O,R)})),te=_o.lastIndex;return te<M.length&&(j=M.slice(te),pe[le]?pe[le]+=j:pe[++le]=j),pe.length<2?ye[0]?(M=ye[0].x,function(_e){return M(_e)+""}):function(){return M}:(M=ye.length,function(_e){for(var Ne,He=0;He<M;++He)pe[(Ne=ye[He]).i]=Ne.x(_e);return pe.join("")})}t.geom.delaunay=function(oe){return t.geom.voronoi().triangles(oe)},t.geom.quadtree=function(oe,M,O,R,j){var te,le=Qr,pe=un;if(te=arguments.length)return le=Hi,pe=Wi,te===3&&(j=O,R=M,O=M=0),ye(oe);function ye(_e){var Ne,He,et,yt,kt,_t,wt,vt,Dt,Pt=wr(le),Ft=wr(pe);if(M!=null)_t=M,wt=O,vt=R,Dt=j;else if(vt=Dt=-(_t=wt=1/0),He=[],et=[],kt=_e.length,te)for(yt=0;yt<kt;++yt)(Ne=_e[yt]).x<_t&&(_t=Ne.x),Ne.y<wt&&(wt=Ne.y),Ne.x>vt&&(vt=Ne.x),Ne.y>Dt&&(Dt=Ne.y),He.push(Ne.x),et.push(Ne.y);else for(yt=0;yt<kt;++yt){var er=+Pt(Ne=_e[yt],yt),cr=+Ft(Ne,yt);er<_t&&(_t=er),cr<wt&&(wt=cr),er>vt&&(vt=er),cr>Dt&&(Dt=cr),He.push(er),et.push(cr)}var Ar=vt-_t,Tr=Dt-wt;function Yr($r,In,jn,ia,jr,mn,Un,Fn){if(!isNaN(jn)&&!isNaN(ia))if($r.leaf){var Jn=$r.x,sa=$r.y;if(Jn!=null)if(v(Jn-jn)+v(sa-ia)<.01)Gr($r,In,jn,ia,jr,mn,Un,Fn);else{var ka=$r.point;$r.x=$r.y=$r.point=null,Gr($r,ka,Jn,sa,jr,mn,Un,Fn),Gr($r,In,jn,ia,jr,mn,Un,Fn)}else $r.x=jn,$r.y=ia,$r.point=In}else Gr($r,In,jn,ia,jr,mn,Un,Fn)}function Gr($r,In,jn,ia,jr,mn,Un,Fn){var Jn=.5*(jr+Un),sa=.5*(mn+Fn),ka=jn>=Jn,qn=ia>=sa,va=qn<<1|ka;$r.leaf=!1,ka?jr=Jn:Un=Jn,qn?mn=sa:Fn=sa,Yr($r=$r.nodes[va]||($r.nodes[va]={leaf:!0,nodes:[],point:null,x:null,y:null}),In,jn,ia,jr,mn,Un,Fn)}Ar>Tr?Dt=wt+Ar:vt=_t+Tr;var an={leaf:!0,nodes:[],point:null,x:null,y:null,add:function($r){Yr(an,$r,+Pt($r,++yt),+Ft($r,yt),_t,wt,vt,Dt)},visit:function($r){Bo($r,an,_t,wt,vt,Dt)},find:function($r){return Va(an,$r[0],$r[1],_t,wt,vt,Dt)}};if(yt=-1,M==null){for(;++yt<kt;)Yr(an,_e[yt],He[yt],et[yt],_t,wt,vt,Dt);--yt}else _e.forEach(an.add);return He=et=_e=Ne=null,an}return ye.x=function(_e){return arguments.length?(le=_e,ye):le},ye.y=function(_e){return arguments.length?(pe=_e,ye):pe},ye.extent=function(_e){return arguments.length?(_e==null?M=O=R=j=null:(M=+_e[0][0],O=+_e[0][1],R=+_e[1][0],j=+_e[1][1]),ye):M==null?null:[[M,O],[R,j]]},ye.size=function(_e){return arguments.length?(_e==null?M=O=R=j=null:(M=O=0,R=+_e[0],j=+_e[1]),ye):M==null?null:[R-M,j-O]},ye},t.interpolateRgb=ko,t.interpolateObject=uo,t.interpolateNumber=yi,t.interpolateString=Xi;var fo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_o=new RegExp(fo.source,"g");function Di(oe,M){for(var O,R=t.interpolators.length;--R>=0&&!(O=t.interpolators[R](oe,M)););return O}function ui(oe,M){var O,R=[],j=[],te=oe.length,le=M.length,pe=Math.min(oe.length,M.length);for(O=0;O<pe;++O)R.push(Di(oe[O],M[O]));for(;O<te;++O)j[O]=oe[O];for(;O<le;++O)j[O]=M[O];return function(ye){for(O=0;O<pe;++O)j[O]=R[O](ye);return j}}t.interpolate=Di,t.interpolators=[function(oe,M){var O=typeof M;return(O==="string"?gr.has(M.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(M)?ko:Xi:M instanceof at?ko:Array.isArray(M)?ui:O==="object"&&isNaN(M)?uo:yi)(oe,M)}],t.interpolateArray=ui;var Gi=function(){return z},ms=t.map({linear:Gi,poly:function(oe){return function(M){return Math.pow(M,oe)}},quad:function(){return _s},cubic:function(){return ws},sin:function(){return Ts},exp:function(){return Mo},circle:function(){return Ao},elastic:function(oe,M){var O;return arguments.length<2&&(M=.45),arguments.length?O=M/$t*Math.asin(1/oe):(oe=1,O=M/4),function(R){return 1+oe*Math.pow(2,-10*R)*Math.sin((R-O)*$t/M)}},back:function(oe){return oe||(oe=1.70158),function(M){return M*M*((oe+1)*M-oe)}},bounce:function(){return No}}),bs=t.map({in:z,out:us,"in-out":Ko,"out-in":function(oe){return Ko(us(oe))}});function qa(oe){return function(M){return M<=0?0:M>=1?1:oe(M)}}function us(oe){return function(M){return 1-oe(1-M)}}function Ko(oe){return function(M){return .5*(M<.5?oe(2*M):2-oe(2-2*M))}}function _s(oe){return oe*oe}function ws(oe){return oe*oe*oe}function vs(oe){if(oe<=0)return 0;if(oe>=1)return 1;var M=oe*oe,O=M*oe;return 4*(oe<.5?O:3*(oe-M)+O-.75)}function Ts(oe){return 1-Math.cos(oe*Ge)}function Mo(oe){return Math.pow(2,10*(oe-1))}function Ao(oe){return 1-Math.sqrt(1-oe*oe)}function No(oe){return oe<1/2.75?7.5625*oe*oe:oe<2/2.75?7.5625*(oe-=1.5/2.75)*oe+.75:oe<2.5/2.75?7.5625*(oe-=2.25/2.75)*oe+.9375:7.5625*(oe-=2.625/2.75)*oe+.984375}function jo(oe,M){return M-=oe,function(O){return Math.round(oe+M*O)}}function Uo(oe){var M,O,R,j=[oe.a,oe.b],te=[oe.c,oe.d],le=ho(j),pe=Qo(j,te),ye=ho(((M=te)[0]+=(R=-pe)*(O=j)[0],M[1]+=R*O[1],M))||0;j[0]*te[1]<te[0]*j[1]&&(j[0]*=-1,j[1]*=-1,le*=-1,pe*=-1),this.rotate=(le?Math.atan2(j[1],j[0]):Math.atan2(-te[0],te[1]))*Ie,this.translate=[oe.e,oe.f],this.scale=[le,ye],this.skew=ye?Math.atan2(pe,ye)*Ie:0}function Qo(oe,M){return oe[0]*M[0]+oe[1]*M[1]}function ho(oe){var M=Math.sqrt(Qo(oe,oe));return M&&(oe[0]/=M,oe[1]/=M),M}t.ease=function(oe){var M=oe.indexOf("-"),O=M>=0?oe.slice(0,M):oe,R=M>=0?oe.slice(M+1):"in";return O=ms.get(O)||Gi,qa((R=bs.get(R)||z)(O.apply(null,h.call(arguments,1))))},t.interpolateHcl=function(oe,M){oe=t.hcl(oe),M=t.hcl(M);var O=oe.h,R=oe.c,j=oe.l,te=M.h-O,le=M.c-R,pe=M.l-j;return isNaN(le)&&(le=0,R=isNaN(R)?M.c:R),isNaN(te)?(te=0,O=isNaN(O)?M.h:O):te>180?te-=360:te<-180&&(te+=360),function(ye){return st(O+te*ye,R+le*ye,j+pe*ye)+""}},t.interpolateHsl=function(oe,M){oe=t.hsl(oe),M=t.hsl(M);var O=oe.h,R=oe.s,j=oe.l,te=M.h-O,le=M.s-R,pe=M.l-j;return isNaN(le)&&(le=0,R=isNaN(R)?M.s:R),isNaN(te)?(te=0,O=isNaN(O)?M.h:O):te>180?te-=360:te<-180&&(te+=360),function(ye){return Lt(O+te*ye,R+le*ye,j+pe*ye)+""}},t.interpolateLab=function(oe,M){oe=t.lab(oe),M=t.lab(M);var O=oe.l,R=oe.a,j=oe.b,te=M.l-O,le=M.a-R,pe=M.b-j;return function(ye){return zt(O+te*ye,R+le*ye,j+pe*ye)+""}},t.interpolateRound=jo,t.transform=function(oe){var M=u.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(O){if(O!=null){M.setAttribute("transform",O);var R=M.transform.baseVal.consolidate()}return new Uo(R?R.matrix:fs)})(oe)},Uo.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var fs={a:1,b:0,c:0,d:1,e:0,f:0};function oo(oe){return oe.length?oe.pop()+",":""}function Vo(oe,M){var O=[],R=[];return oe=t.transform(oe),M=t.transform(M),function(j,te,le,pe){if(j[0]!==te[0]||j[1]!==te[1]){var ye=le.push("translate(",null,",",null,")");pe.push({i:ye-4,x:yi(j[0],te[0])},{i:ye-2,x:yi(j[1],te[1])})}else(te[0]||te[1])&&le.push("translate("+te+")")}(oe.translate,M.translate,O,R),function(j,te,le,pe){j!==te?(j-te>180?te+=360:te-j>180&&(j+=360),pe.push({i:le.push(oo(le)+"rotate(",null,")")-2,x:yi(j,te)})):te&&le.push(oo(le)+"rotate("+te+")")}(oe.rotate,M.rotate,O,R),function(j,te,le,pe){j!==te?pe.push({i:le.push(oo(le)+"skewX(",null,")")-2,x:yi(j,te)}):te&&le.push(oo(le)+"skewX("+te+")")}(oe.skew,M.skew,O,R),function(j,te,le,pe){if(j[0]!==te[0]||j[1]!==te[1]){var ye=le.push(oo(le)+"scale(",null,",",null,")");pe.push({i:ye-4,x:yi(j[0],te[0])},{i:ye-2,x:yi(j[1],te[1])})}else te[0]===1&&te[1]===1||le.push(oo(le)+"scale("+te+")")}(oe.scale,M.scale,O,R),oe=M=null,function(j){for(var te,le=-1,pe=R.length;++le<pe;)O[(te=R[le]).i]=te.x(j);return O.join("")}}function hs(oe,M){return M=(M-=oe=+oe)||1/M,function(O){return(O-oe)/M}}function So(oe,M){return M=(M-=oe=+oe)||1/M,function(O){return Math.max(0,Math.min(1,(O-oe)/M))}}function ja(oe){for(var M=oe.source,O=oe.target,R=function(le,pe){if(le===pe)return le;for(var ye=Fe(le),_e=Fe(pe),Ne=ye.pop(),He=_e.pop(),et=null;Ne===He;)et=Ne,Ne=ye.pop(),He=_e.pop();return et}(M,O),j=[M];M!==R;)M=M.parent,j.push(M);for(var te=j.length;O!==R;)j.splice(te,0,O),O=O.parent;return j}function Fe(oe){for(var M=[],O=oe.parent;O!=null;)M.push(oe),oe=O,O=O.parent;return M.push(oe),M}function Ve(oe){oe.fixed|=2}function Je(oe){oe.fixed&=-7}function rt(oe){oe.fixed|=4,oe.px=oe.x,oe.py=oe.y}function dt(oe){oe.fixed&=-5}t.interpolateTransform=Vo,t.layout={},t.layout.bundle=function(){return function(oe){for(var M=[],O=-1,R=oe.length;++O<R;)M.push(ja(oe[O]));return M}},t.layout.chord=function(){var oe,M,O,R,j,te,le,pe={},ye=0;function _e(){var He,et,yt,kt,_t,wt={},vt=[],Dt=t.range(R),Pt=[];for(oe=[],M=[],He=0,kt=-1;++kt<R;){for(et=0,_t=-1;++_t<R;)et+=O[kt][_t];vt.push(et),Pt.push(t.range(R)),He+=et}for(j&&Dt.sort(function(an,$r){return j(vt[an],vt[$r])}),te&&Pt.forEach(function(an,$r){an.sort(function(In,jn){return te(O[$r][In],O[$r][jn])})}),He=($t-ye*R)/He,et=0,kt=-1;++kt<R;){for(yt=et,_t=-1;++_t<R;){var Ft=Dt[kt],er=Pt[Ft][_t],cr=O[Ft][er],Ar=et,Tr=et+=cr*He;wt[Ft+"-"+er]={index:Ft,subindex:er,startAngle:Ar,endAngle:Tr,value:cr}}M[Ft]={index:Ft,startAngle:yt,endAngle:et,value:vt[Ft]},et+=ye}for(kt=-1;++kt<R;)for(_t=kt-1;++_t<R;){var Yr=wt[kt+"-"+_t],Gr=wt[_t+"-"+kt];(Yr.value||Gr.value)&&oe.push(Yr.value<Gr.value?{source:Gr,target:Yr}:{source:Yr,target:Gr})}le&&Ne()}function Ne(){oe.sort(function(He,et){return le((He.source.value+He.target.value)/2,(et.source.value+et.target.value)/2)})}return pe.matrix=function(He){return arguments.length?(R=(O=He)&&O.length,oe=M=null,pe):O},pe.padding=function(He){return arguments.length?(ye=He,oe=M=null,pe):ye},pe.sortGroups=function(He){return arguments.length?(j=He,oe=M=null,pe):j},pe.sortSubgroups=function(He){return arguments.length?(te=He,oe=null,pe):te},pe.sortChords=function(He){return arguments.length?(le=He,oe&&Ne(),pe):le},pe.chords=function(){return oe||_e(),oe},pe.groups=function(){return M||_e(),M},pe},t.layout.force=function(){var oe,M,O,R,j,te,le={},pe=t.dispatch("start","tick","end"),ye=[1,1],_e=.9,Ne=ft,He=Tt,et=-30,yt=Wt,kt=.1,_t=.64,wt=[],vt=[];function Dt(Ft){return function(er,cr,Ar,Tr){if(er.point!==Ft){var Yr=er.cx-Ft.x,Gr=er.cy-Ft.y,an=Tr-cr,$r=Yr*Yr+Gr*Gr;if(an*an/_t<$r){if($r<yt){var In=er.charge/$r;Ft.px-=Yr*In,Ft.py-=Gr*In}return!0}er.point&&$r&&$r<yt&&(In=er.pointCharge/$r,Ft.px-=Yr*In,Ft.py-=Gr*In)}return!er.charge}}function Pt(Ft){Ft.px=t.event.x,Ft.py=t.event.y,le.resume()}return le.tick=function(){if((O*=.99)<.005)return oe=null,pe.end({type:"end",alpha:O=0}),!0;var Ft,er,cr,Ar,Tr,Yr,Gr,an,$r,In=wt.length,jn=vt.length;for(er=0;er<jn;++er)Ar=(cr=vt[er]).source,(Yr=(an=(Tr=cr.target).x-Ar.x)*an+($r=Tr.y-Ar.y)*$r)&&(an*=Yr=O*j[er]*((Yr=Math.sqrt(Yr))-R[er])/Yr,$r*=Yr,Tr.x-=an*(Gr=Ar.weight+Tr.weight?Ar.weight/(Ar.weight+Tr.weight):.5),Tr.y-=$r*Gr,Ar.x+=an*(Gr=1-Gr),Ar.y+=$r*Gr);if((Gr=O*kt)&&(an=ye[0]/2,$r=ye[1]/2,er=-1,Gr))for(;++er<In;)(cr=wt[er]).x+=(an-cr.x)*Gr,cr.y+=($r-cr.y)*Gr;if(et)for(function ia(jr,mn,Un){var Fn=0,Jn=0;if(jr.charge=0,!jr.leaf)for(var sa,ka=jr.nodes,qn=ka.length,va=-1;++va<qn;)(sa=ka[va])!=null&&(ia(sa,mn,Un),jr.charge+=sa.charge,Fn+=sa.charge*sa.cx,Jn+=sa.charge*sa.cy);if(jr.point){jr.leaf||(jr.point.x+=Math.random()-.5,jr.point.y+=Math.random()-.5);var pa=mn*Un[jr.point.index];jr.charge+=jr.pointCharge=pa,Fn+=pa*jr.point.x,Jn+=pa*jr.point.y}jr.cx=Fn/jr.charge,jr.cy=Jn/jr.charge}(Ft=t.geom.quadtree(wt),O,te),er=-1;++er<In;)(cr=wt[er]).fixed||Ft.visit(Dt(cr));for(er=-1;++er<In;)(cr=wt[er]).fixed?(cr.x=cr.px,cr.y=cr.py):(cr.x-=(cr.px-(cr.px=cr.x))*_e,cr.y-=(cr.py-(cr.py=cr.y))*_e);pe.tick({type:"tick",alpha:O})},le.nodes=function(Ft){return arguments.length?(wt=Ft,le):wt},le.links=function(Ft){return arguments.length?(vt=Ft,le):vt},le.size=function(Ft){return arguments.length?(ye=Ft,le):ye},le.linkDistance=function(Ft){return arguments.length?(Ne=typeof Ft=="function"?Ft:+Ft,le):Ne},le.distance=le.linkDistance,le.linkStrength=function(Ft){return arguments.length?(He=typeof Ft=="function"?Ft:+Ft,le):He},le.friction=function(Ft){return arguments.length?(_e=+Ft,le):_e},le.charge=function(Ft){return arguments.length?(et=typeof Ft=="function"?Ft:+Ft,le):et},le.chargeDistance=function(Ft){return arguments.length?(yt=Ft*Ft,le):Math.sqrt(yt)},le.gravity=function(Ft){return arguments.length?(kt=+Ft,le):kt},le.theta=function(Ft){return arguments.length?(_t=Ft*Ft,le):Math.sqrt(_t)},le.alpha=function(Ft){return arguments.length?(Ft=+Ft,O?Ft>0?O=Ft:(oe.c=null,oe.t=NaN,oe=null,pe.end({type:"end",alpha:O=0})):Ft>0&&(pe.start({type:"start",alpha:O=Ft}),oe=Dr(le.tick)),le):O},le.start=function(){var Ft,er,cr,Ar=wt.length,Tr=vt.length,Yr=ye[0],Gr=ye[1];for(Ft=0;Ft<Ar;++Ft)(cr=wt[Ft]).index=Ft,cr.weight=0;for(Ft=0;Ft<Tr;++Ft)typeof(cr=vt[Ft]).source=="number"&&(cr.source=wt[cr.source]),typeof cr.target=="number"&&(cr.target=wt[cr.target]),++cr.source.weight,++cr.target.weight;for(Ft=0;Ft<Ar;++Ft)cr=wt[Ft],isNaN(cr.x)&&(cr.x=an("x",Yr)),isNaN(cr.y)&&(cr.y=an("y",Gr)),isNaN(cr.px)&&(cr.px=cr.x),isNaN(cr.py)&&(cr.py=cr.y);if(R=[],typeof Ne=="function")for(Ft=0;Ft<Tr;++Ft)R[Ft]=+Ne.call(this,vt[Ft],Ft);else for(Ft=0;Ft<Tr;++Ft)R[Ft]=Ne;if(j=[],typeof He=="function")for(Ft=0;Ft<Tr;++Ft)j[Ft]=+He.call(this,vt[Ft],Ft);else for(Ft=0;Ft<Tr;++Ft)j[Ft]=He;if(te=[],typeof et=="function")for(Ft=0;Ft<Ar;++Ft)te[Ft]=+et.call(this,wt[Ft],Ft);else for(Ft=0;Ft<Ar;++Ft)te[Ft]=et;function an($r,In){if(!er){for(er=new Array(Ar),mn=0;mn<Ar;++mn)er[mn]=[];for(mn=0;mn<Tr;++mn){var jn=vt[mn];er[jn.source.index].push(jn.target),er[jn.target.index].push(jn.source)}}for(var ia,jr=er[Ft],mn=-1,Un=jr.length;++mn<Un;)if(!isNaN(ia=jr[mn][$r]))return ia;return Math.random()*In}return le.resume()},le.resume=function(){return le.alpha(.1)},le.stop=function(){return le.alpha(0)},le.drag=function(){if(M||(M=t.behavior.drag().origin(z).on("dragstart.force",Ve).on("drag.force",Pt).on("dragend.force",Je)),!arguments.length)return M;this.on("mouseover.force",rt).on("mouseout.force",dt).call(M)},t.rebind(le,pe,"on")};var ft=20,Tt=1,Wt=1/0;function Xt(oe,M){return t.rebind(oe,M,"sort","children","value"),oe.nodes=oe,oe.links=Pr,oe}function Gt(oe,M){for(var O=[oe];(oe=O.pop())!=null;)if(M(oe),(j=oe.children)&&(R=j.length))for(var R,j;--R>=0;)O.push(j[R])}function tr(oe,M){for(var O=[oe],R=[];(oe=O.pop())!=null;)if(R.push(oe),(te=oe.children)&&(j=te.length))for(var j,te,le=-1;++le<j;)O.push(te[le]);for(;(oe=R.pop())!=null;)M(oe)}function lr(oe){return oe.children}function hr(oe){return oe.value}function vr(oe,M){return M.value-oe.value}function Pr(oe){return t.merge(oe.map(function(M){return(M.children||[]).map(function(O){return{source:M,target:O}})}))}t.layout.hierarchy=function(){var oe=vr,M=lr,O=hr;function R(j){var te,le=[j],pe=[];for(j.depth=0;(te=le.pop())!=null;)if(pe.push(te),(_e=M.call(R,te,te.depth))&&(ye=_e.length)){for(var ye,_e,Ne;--ye>=0;)le.push(Ne=_e[ye]),Ne.parent=te,Ne.depth=te.depth+1;O&&(te.value=0),te.children=_e}else O&&(te.value=+O.call(R,te,te.depth)||0),delete te.children;return tr(j,function(He){var et,yt;oe&&(et=He.children)&&et.sort(oe),O&&(yt=He.parent)&&(yt.value+=He.value)}),pe}return R.sort=function(j){return arguments.length?(oe=j,R):oe},R.children=function(j){return arguments.length?(M=j,R):M},R.value=function(j){return arguments.length?(O=j,R):O},R.revalue=function(j){return O&&(Gt(j,function(te){te.children&&(te.value=0)}),tr(j,function(te){var le;te.children||(te.value=+O.call(R,te,te.depth)||0),(le=te.parent)&&(le.value+=te.value)})),j},R},t.layout.partition=function(){var oe=t.layout.hierarchy(),M=[1,1];function O(R,j){var te=oe.call(this,R,j);return function le(pe,ye,_e,Ne){var He=pe.children;if(pe.x=ye,pe.y=pe.depth*Ne,pe.dx=_e,pe.dy=Ne,He&&(et=He.length)){var et,yt,kt,_t=-1;for(_e=pe.value?_e/pe.value:0;++_t<et;)le(yt=He[_t],ye,kt=yt.value*_e,Ne),ye+=kt}}(te[0],0,M[0],M[1]/function le(pe){var ye=pe.children,_e=0;if(ye&&(Ne=ye.length))for(var Ne,He=-1;++He<Ne;)_e=Math.max(_e,le(ye[He]));return 1+_e}(te[0])),te}return O.size=function(R){return arguments.length?(M=R,O):M},Xt(O,oe)},t.layout.pie=function(){var oe=Number,M=Jr,O=0,R=$t,j=0;function te(le){var pe,ye=le.length,_e=le.map(function(Dt,Pt){return+oe.call(te,Dt,Pt)}),Ne=+(typeof O=="function"?O.apply(this,arguments):O),He=(typeof R=="function"?R.apply(this,arguments):R)-Ne,et=Math.min(Math.abs(He)/ye,+(typeof j=="function"?j.apply(this,arguments):j)),yt=et*(He<0?-1:1),kt=t.sum(_e),_t=kt?(He-ye*yt)/kt:0,wt=t.range(ye),vt=[];return M!=null&&wt.sort(M===Jr?function(Dt,Pt){return _e[Pt]-_e[Dt]}:function(Dt,Pt){return M(le[Dt],le[Pt])}),wt.forEach(function(Dt){vt[Dt]={data:le[Dt],value:pe=_e[Dt],startAngle:Ne,endAngle:Ne+=pe*_t+yt,padAngle:et}}),vt}return te.value=function(le){return arguments.length?(oe=le,te):oe},te.sort=function(le){return arguments.length?(M=le,te):M},te.startAngle=function(le){return arguments.length?(O=le,te):O},te.endAngle=function(le){return arguments.length?(R=le,te):R},te.padAngle=function(le){return arguments.length?(j=le,te):j},te};var Jr={};function on(oe){return oe.x}function _n(oe){return oe.y}function Mn(oe,M,O){oe.y0=M,oe.y=O}t.layout.stack=function(){var oe=z,M=ha,O=wa,R=Mn,j=on,te=_n;function le(pe,ye){if(!(et=pe.length))return pe;var _e=pe.map(function(Dt,Pt){return oe.call(le,Dt,Pt)}),Ne=_e.map(function(Dt){return Dt.map(function(Pt,Ft){return[j.call(le,Pt,Ft),te.call(le,Pt,Ft)]})}),He=M.call(le,Ne,ye);_e=t.permute(_e,He),Ne=t.permute(Ne,He);var et,yt,kt,_t,wt=O.call(le,Ne,ye),vt=_e[0].length;for(kt=0;kt<vt;++kt)for(R.call(le,_e[0][kt],_t=wt[kt],Ne[0][kt][1]),yt=1;yt<et;++yt)R.call(le,_e[yt][kt],_t+=Ne[yt-1][kt][1],Ne[yt][kt][1]);return pe}return le.values=function(pe){return arguments.length?(oe=pe,le):oe},le.order=function(pe){return arguments.length?(M=typeof pe=="function"?pe:Rn.get(pe)||ha,le):M},le.offset=function(pe){return arguments.length?(O=typeof pe=="function"?pe:An.get(pe)||wa,le):O},le.x=function(pe){return arguments.length?(j=pe,le):j},le.y=function(pe){return arguments.length?(te=pe,le):te},le.out=function(pe){return arguments.length?(R=pe,le):R},le};var Rn=t.map({"inside-out":function(oe){var M,O,R=oe.length,j=oe.map(Da),te=oe.map(za),le=t.range(R).sort(function(He,et){return j[He]-j[et]}),pe=0,ye=0,_e=[],Ne=[];for(M=0;M<R;++M)O=le[M],pe<ye?(pe+=te[O],_e.push(O)):(ye+=te[O],Ne.push(O));return Ne.reverse().concat(_e)},reverse:function(oe){return t.range(oe.length).reverse()},default:ha}),An=t.map({silhouette:function(oe){var M,O,R,j=oe.length,te=oe[0].length,le=[],pe=0,ye=[];for(O=0;O<te;++O){for(M=0,R=0;M<j;M++)R+=oe[M][O][1];R>pe&&(pe=R),le.push(R)}for(O=0;O<te;++O)ye[O]=(pe-le[O])/2;return ye},wiggle:function(oe){var M,O,R,j,te,le,pe,ye,_e,Ne=oe.length,He=oe[0],et=He.length,yt=[];for(yt[0]=ye=_e=0,O=1;O<et;++O){for(M=0,j=0;M<Ne;++M)j+=oe[M][O][1];for(M=0,te=0,pe=He[O][0]-He[O-1][0];M<Ne;++M){for(R=0,le=(oe[M][O][1]-oe[M][O-1][1])/(2*pe);R<M;++R)le+=(oe[R][O][1]-oe[R][O-1][1])/pe;te+=le*oe[M][O][1]}yt[O]=ye-=j?te/j*pe:0,ye<_e&&(_e=ye)}for(O=0;O<et;++O)yt[O]-=_e;return yt},expand:function(oe){var M,O,R,j=oe.length,te=oe[0].length,le=1/j,pe=[];for(O=0;O<te;++O){for(M=0,R=0;M<j;M++)R+=oe[M][O][1];if(R)for(M=0;M<j;M++)oe[M][O][1]/=R;else for(M=0;M<j;M++)oe[M][O][1]=le}for(O=0;O<te;++O)pe[O]=0;return pe},zero:wa});function ha(oe){return t.range(oe.length)}function wa(oe){for(var M=-1,O=oe[0].length,R=[];++M<O;)R[M]=0;return R}function Da(oe){for(var M,O=1,R=0,j=oe[0][1],te=oe.length;O<te;++O)(M=oe[O][1])>j&&(R=O,j=M);return R}function za(oe){return oe.reduce(Ra,0)}function Ra(oe,M){return oe+M[1]}function xi(oe,M){return gi(oe,Math.ceil(Math.log(M.length)/Math.LN2+1))}function gi(oe,M){for(var O=-1,R=+oe[0],j=(oe[1]-R)/M,te=[];++O<=M;)te[O]=j*O+R;return te}function ni(oe){return[t.min(oe),t.max(oe)]}function ai(oe,M){return oe.value-M.value}function mi(oe,M){var O=oe._pack_next;oe._pack_next=M,M._pack_prev=oe,M._pack_next=O,O._pack_prev=M}function Ri(oe,M){oe._pack_next=M,M._pack_prev=oe}function Zi(oe,M){var O=M.x-oe.x,R=M.y-oe.y,j=oe.r+M.r;return .999*j*j>O*O+R*R}function Ji(oe){if((M=oe.children)&&(ye=M.length)){var M,O,R,j,te,le,pe,ye,_e=1/0,Ne=-1/0,He=1/0,et=-1/0;if(M.forEach(Ki),(O=M[0]).x=-O.r,O.y=0,Pt(O),ye>1&&((R=M[1]).x=R.r,R.y=0,Pt(R),ye>2))for(Ca(O,R,j=M[2]),Pt(j),mi(O,j),O._pack_prev=j,mi(j,R),R=O._pack_next,te=3;te<ye;te++){Ca(O,R,j=M[te]);var yt=0,kt=1,_t=1;for(le=R._pack_next;le!==R;le=le._pack_next,kt++)if(Zi(le,j)){yt=1;break}if(yt==1)for(pe=O._pack_prev;pe!==le._pack_prev&&!Zi(pe,j);pe=pe._pack_prev,_t++);yt?(kt<_t||kt==_t&&R.r<O.r?Ri(O,R=le):Ri(O=pe,R),te--):(mi(O,j),R=j,Pt(j))}var wt=(_e+Ne)/2,vt=(He+et)/2,Dt=0;for(te=0;te<ye;te++)(j=M[te]).x-=wt,j.y-=vt,Dt=Math.max(Dt,j.r+Math.sqrt(j.x*j.x+j.y*j.y));oe.r=Dt,M.forEach(Qi)}function Pt(Ft){_e=Math.min(Ft.x-Ft.r,_e),Ne=Math.max(Ft.x+Ft.r,Ne),He=Math.min(Ft.y-Ft.r,He),et=Math.max(Ft.y+Ft.r,et)}}function Ki(oe){oe._pack_next=oe._pack_prev=oe}function Qi(oe){delete oe._pack_next,delete oe._pack_prev}function Ca(oe,M,O){var R=oe.r+O.r,j=M.x-oe.x,te=M.y-oe.y;if(R&&(j||te)){var le=M.r+O.r,pe=j*j+te*te,ye=.5+((R*=R)-(le*=le))/(2*pe),_e=Math.sqrt(Math.max(0,2*le*(R+pe)-(R-=pe)*R-le*le))/(2*pe);O.x=oe.x+ye*j+_e*te,O.y=oe.y+ye*te-_e*j}else O.x=oe.x+R,O.y=oe.y}function ut(oe,M){return oe.parent==M.parent?1:2}function Ot(oe){var M=oe.children;return M.length?M[0]:oe.t}function ir(oe){var M,O=oe.children;return(M=O.length)?O[M-1]:oe.t}function Vt(oe,M,O){var R=O/(M.i-oe.i);M.c-=R,M.s+=O,oe.c+=R,M.z+=O,M.m+=O}function sr(oe,M,O){return oe.a.parent===M.parent?oe.a:O}function Cr(oe){return{x:oe.x,y:oe.y,dx:oe.dx,dy:oe.dy}}function Or(oe,M){var O=oe.x+M[3],R=oe.y+M[0],j=oe.dx-M[1]-M[3],te=oe.dy-M[0]-M[2];return j<0&&(O+=j/2,j=0),te<0&&(R+=te/2,te=0),{x:O,y:R,dx:j,dy:te}}function qr(oe){var M=oe[0],O=oe[oe.length-1];return M<O?[M,O]:[O,M]}function en(oe){return oe.rangeExtent?oe.rangeExtent():qr(oe.range())}function Kr(oe,M,O,R){var j=O(oe[0],oe[1]),te=R(M[0],M[1]);return function(le){return te(j(le))}}function sn(oe,M){var O,R=0,j=oe.length-1,te=oe[R],le=oe[j];return le<te&&(O=R,R=j,j=O,O=te,te=le,le=O),oe[R]=M.floor(te),oe[j]=M.ceil(le),oe}function pn(oe){return oe?{floor:function(M){return Math.floor(M/oe)*oe},ceil:function(M){return Math.ceil(M/oe)*oe}}:tn}t.layout.histogram=function(){var oe=!0,M=Number,O=ni,R=xi;function j(te,le){for(var pe,ye,_e=[],Ne=te.map(M,this),He=O.call(this,Ne,le),et=R.call(this,He,Ne,le),yt=(le=-1,Ne.length),kt=et.length-1,_t=oe?1:1/yt;++le<kt;)(pe=_e[le]=[]).dx=et[le+1]-(pe.x=et[le]),pe.y=0;if(kt>0)for(le=-1;++le<yt;)(ye=Ne[le])>=He[0]&&ye<=He[1]&&((pe=_e[t.bisect(et,ye,1,kt)-1]).y+=_t,pe.push(te[le]));return _e}return j.value=function(te){return arguments.length?(M=te,j):M},j.range=function(te){return arguments.length?(O=wr(te),j):O},j.bins=function(te){return arguments.length?(R=typeof te=="number"?function(le){return gi(le,te)}:wr(te),j):R},j.frequency=function(te){return arguments.length?(oe=!!te,j):oe},j},t.layout.pack=function(){var oe,M=t.layout.hierarchy().sort(ai),O=0,R=[1,1];function j(te,le){var pe=M.call(this,te,le),ye=pe[0],_e=R[0],Ne=R[1],He=oe==null?Math.sqrt:typeof oe=="function"?oe:function(){return oe};if(ye.x=ye.y=0,tr(ye,function(yt){yt.r=+He(yt.value)}),tr(ye,Ji),O){var et=O*(oe?1:Math.max(2*ye.r/_e,2*ye.r/Ne))/2;tr(ye,function(yt){yt.r+=et}),tr(ye,Ji),tr(ye,function(yt){yt.r-=et})}return function yt(kt,_t,wt,vt){var Dt=kt.children;if(kt.x=_t+=vt*kt.x,kt.y=wt+=vt*kt.y,kt.r*=vt,Dt)for(var Pt=-1,Ft=Dt.length;++Pt<Ft;)yt(Dt[Pt],_t,wt,vt)}(ye,_e/2,Ne/2,oe?1:1/Math.max(2*ye.r/_e,2*ye.r/Ne)),pe}return j.size=function(te){return arguments.length?(R=te,j):R},j.radius=function(te){return arguments.length?(oe=te==null||typeof te=="function"?te:+te,j):oe},j.padding=function(te){return arguments.length?(O=+te,j):O},Xt(j,M)},t.layout.tree=function(){var oe=t.layout.hierarchy().sort(null).value(null),M=ut,O=[1,1],R=null;function j(ye,_e){var Ne=oe.call(this,ye,_e),He=Ne[0],et=function(Pt){for(var Ft,er={A:null,children:[Pt]},cr=[er];(Ft=cr.pop())!=null;)for(var Ar,Tr=Ft.children,Yr=0,Gr=Tr.length;Yr<Gr;++Yr)cr.push((Tr[Yr]=Ar={_:Tr[Yr],parent:Ft,children:(Ar=Tr[Yr].children)&&Ar.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Yr}).a=Ar);return er.children[0]}(He);if(tr(et,te),et.parent.m=-et.z,Gt(et,le),R)Gt(He,pe);else{var yt=He,kt=He,_t=He;Gt(He,function(Pt){Pt.x<yt.x&&(yt=Pt),Pt.x>kt.x&&(kt=Pt),Pt.depth>_t.depth&&(_t=Pt)});var wt=M(yt,kt)/2-yt.x,vt=O[0]/(kt.x+M(kt,yt)/2+wt),Dt=O[1]/(_t.depth||1);Gt(He,function(Pt){Pt.x=(Pt.x+wt)*vt,Pt.y=Pt.depth*Dt})}return Ne}function te(ye){var _e=ye.children,Ne=ye.parent.children,He=ye.i?Ne[ye.i-1]:null;if(_e.length){(function(yt){for(var kt,_t=0,wt=0,vt=yt.children,Dt=vt.length;--Dt>=0;)(kt=vt[Dt]).z+=_t,kt.m+=_t,_t+=kt.s+(wt+=kt.c)})(ye);var et=(_e[0].z+_e[_e.length-1].z)/2;He?(ye.z=He.z+M(ye._,He._),ye.m=ye.z-et):ye.z=et}else He&&(ye.z=He.z+M(ye._,He._));ye.parent.A=function(yt,kt,_t){if(kt){for(var wt,vt=yt,Dt=yt,Pt=kt,Ft=vt.parent.children[0],er=vt.m,cr=Dt.m,Ar=Pt.m,Tr=Ft.m;Pt=ir(Pt),vt=Ot(vt),Pt&&vt;)Ft=Ot(Ft),(Dt=ir(Dt)).a=yt,(wt=Pt.z+Ar-vt.z-er+M(Pt._,vt._))>0&&(Vt(sr(Pt,yt,_t),yt,wt),er+=wt,cr+=wt),Ar+=Pt.m,er+=vt.m,Tr+=Ft.m,cr+=Dt.m;Pt&&!ir(Dt)&&(Dt.t=Pt,Dt.m+=Ar-cr),vt&&!Ot(Ft)&&(Ft.t=vt,Ft.m+=er-Tr,_t=yt)}return _t}(ye,He,ye.parent.A||Ne[0])}function le(ye){ye._.x=ye.z+ye.parent.m,ye.m+=ye.parent.m}function pe(ye){ye.x*=O[0],ye.y=ye.depth*O[1]}return j.separation=function(ye){return arguments.length?(M=ye,j):M},j.size=function(ye){return arguments.length?(R=(O=ye)==null?pe:null,j):R?null:O},j.nodeSize=function(ye){return arguments.length?(R=(O=ye)==null?null:pe,j):R?O:null},Xt(j,oe)},t.layout.cluster=function(){var oe=t.layout.hierarchy().sort(null).value(null),M=ut,O=[1,1],R=!1;function j(te,le){var pe,ye=oe.call(this,te,le),_e=ye[0],Ne=0;tr(_e,function(_t){var wt=_t.children;wt&&wt.length?(_t.x=function(vt){return vt.reduce(function(Dt,Pt){return Dt+Pt.x},0)/vt.length}(wt),_t.y=function(vt){return 1+t.max(vt,function(Dt){return Dt.y})}(wt)):(_t.x=pe?Ne+=M(_t,pe):0,_t.y=0,pe=_t)});var He=function _t(wt){var vt=wt.children;return vt&&vt.length?_t(vt[0]):wt}(_e),et=function _t(wt){var vt,Dt=wt.children;return Dt&&(vt=Dt.length)?_t(Dt[vt-1]):wt}(_e),yt=He.x-M(He,et)/2,kt=et.x+M(et,He)/2;return tr(_e,R?function(_t){_t.x=(_t.x-_e.x)*O[0],_t.y=(_e.y-_t.y)*O[1]}:function(_t){_t.x=(_t.x-yt)/(kt-yt)*O[0],_t.y=(1-(_e.y?_t.y/_e.y:1))*O[1]}),ye}return j.separation=function(te){return arguments.length?(M=te,j):M},j.size=function(te){return arguments.length?(R=(O=te)==null,j):R?null:O},j.nodeSize=function(te){return arguments.length?(R=(O=te)!=null,j):R?O:null},Xt(j,oe)},t.layout.treemap=function(){var oe,M=t.layout.hierarchy(),O=Math.round,R=[1,1],j=null,te=Cr,le=!1,pe="squarify",ye=.5*(1+Math.sqrt(5));function _e(_t,wt){for(var vt,Dt,Pt=-1,Ft=_t.length;++Pt<Ft;)Dt=(vt=_t[Pt]).value*(wt<0?0:wt),vt.area=isNaN(Dt)||Dt<=0?0:Dt}function Ne(_t){var wt=_t.children;if(wt&&wt.length){var vt,Dt,Pt,Ft=te(_t),er=[],cr=wt.slice(),Ar=1/0,Tr=pe==="slice"?Ft.dx:pe==="dice"?Ft.dy:pe==="slice-dice"?1&_t.depth?Ft.dy:Ft.dx:Math.min(Ft.dx,Ft.dy);for(_e(cr,Ft.dx*Ft.dy/_t.value),er.area=0;(Pt=cr.length)>0;)er.push(vt=cr[Pt-1]),er.area+=vt.area,pe!=="squarify"||(Dt=et(er,Tr))<=Ar?(cr.pop(),Ar=Dt):(er.area-=er.pop().area,yt(er,Tr,Ft,!1),Tr=Math.min(Ft.dx,Ft.dy),er.length=er.area=0,Ar=1/0);er.length&&(yt(er,Tr,Ft,!0),er.length=er.area=0),wt.forEach(Ne)}}function He(_t){var wt=_t.children;if(wt&&wt.length){var vt,Dt=te(_t),Pt=wt.slice(),Ft=[];for(_e(Pt,Dt.dx*Dt.dy/_t.value),Ft.area=0;vt=Pt.pop();)Ft.push(vt),Ft.area+=vt.area,vt.z!=null&&(yt(Ft,vt.z?Dt.dx:Dt.dy,Dt,!Pt.length),Ft.length=Ft.area=0);wt.forEach(He)}}function et(_t,wt){for(var vt,Dt=_t.area,Pt=0,Ft=1/0,er=-1,cr=_t.length;++er<cr;)(vt=_t[er].area)&&(vt<Ft&&(Ft=vt),vt>Pt&&(Pt=vt));return wt*=wt,(Dt*=Dt)?Math.max(wt*Pt*ye/Dt,Dt/(wt*Ft*ye)):1/0}function yt(_t,wt,vt,Dt){var Pt,Ft=-1,er=_t.length,cr=vt.x,Ar=vt.y,Tr=wt?O(_t.area/wt):0;if(wt==vt.dx){for((Dt||Tr>vt.dy)&&(Tr=vt.dy);++Ft<er;)(Pt=_t[Ft]).x=cr,Pt.y=Ar,Pt.dy=Tr,cr+=Pt.dx=Math.min(vt.x+vt.dx-cr,Tr?O(Pt.area/Tr):0);Pt.z=!0,Pt.dx+=vt.x+vt.dx-cr,vt.y+=Tr,vt.dy-=Tr}else{for((Dt||Tr>vt.dx)&&(Tr=vt.dx);++Ft<er;)(Pt=_t[Ft]).x=cr,Pt.y=Ar,Pt.dx=Tr,Ar+=Pt.dy=Math.min(vt.y+vt.dy-Ar,Tr?O(Pt.area/Tr):0);Pt.z=!1,Pt.dy+=vt.y+vt.dy-Ar,vt.x+=Tr,vt.dx-=Tr}}function kt(_t){var wt=oe||M(_t),vt=wt[0];return vt.x=vt.y=0,vt.value?(vt.dx=R[0],vt.dy=R[1]):vt.dx=vt.dy=0,oe&&M.revalue(vt),_e([vt],vt.dx*vt.dy/vt.value),(oe?He:Ne)(vt),le&&(oe=wt),wt}return kt.size=function(_t){return arguments.length?(R=_t,kt):R},kt.padding=function(_t){if(!arguments.length)return j;function wt(Pt){var Ft=_t.call(kt,Pt,Pt.depth);return Ft==null?Cr(Pt):Or(Pt,typeof Ft=="number"?[Ft,Ft,Ft,Ft]:Ft)}function vt(Pt){return Or(Pt,_t)}var Dt;return te=(j=_t)==null?Cr:(Dt=typeof _t)=="function"?wt:(Dt==="number"&&(_t=[_t,_t,_t,_t]),vt),kt},kt.round=function(_t){return arguments.length?(O=_t?Math.round:Number,kt):O!=Number},kt.sticky=function(_t){return arguments.length?(le=_t,oe=null,kt):le},kt.ratio=function(_t){return arguments.length?(ye=_t,kt):ye},kt.mode=function(_t){return arguments.length?(pe=_t+"",kt):pe},Xt(kt,M)},t.random={normal:function(oe,M){var O=arguments.length;return O<2&&(M=1),O<1&&(oe=0),function(){var R,j,te;do te=(R=2*Math.random()-1)*R+(j=2*Math.random()-1)*j;while(!te||te>1);return oe+M*R*Math.sqrt(-2*Math.log(te)/te)}},logNormal:function(){var oe=t.random.normal.apply(t,arguments);return function(){return Math.exp(oe())}},bates:function(oe){var M=t.random.irwinHall(oe);return function(){return M()/oe}},irwinHall:function(oe){return function(){for(var M=0,O=0;O<oe;O++)M+=Math.random();return M}}},t.scale={};var tn={floor:z,ceil:z};function dn(oe,M,O,R){var j=[],te=[],le=0,pe=Math.min(oe.length,M.length)-1;for(oe[pe]<oe[0]&&(oe=oe.slice().reverse(),M=M.slice().reverse());++le<=pe;)j.push(O(oe[le-1],oe[le])),te.push(R(M[le-1],M[le]));return function(ye){var _e=t.bisect(oe,ye,1,pe)-1;return te[_e](j[_e](ye))}}function Sn(oe,M){return t.rebind(oe,M,"range","rangeRound","interpolate","clamp")}function Dn(oe,M){return sn(oe,pn(Qn(oe,M)[2])),sn(oe,pn(Qn(oe,M)[2])),oe}function Qn(oe,M){M==null&&(M=10);var O=qr(oe),R=O[1]-O[0],j=Math.pow(10,Math.floor(Math.log(R/M)/Math.LN10)),te=M/R*j;return te<=.15?j*=10:te<=.35?j*=5:te<=.75&&(j*=2),O[0]=Math.ceil(O[0]/j)*j,O[1]=Math.floor(O[1]/j)*j+.5*j,O[2]=j,O}function Hr(oe,M){return t.range.apply(t,Qn(oe,M))}t.scale.linear=function(){return function oe(M,O,R,j){var te,le;function pe(){var _e=Math.min(M.length,O.length)>2?dn:Kr,Ne=j?So:hs;return te=_e(M,O,Ne,R),le=_e(O,M,Ne,Di),ye}function ye(_e){return te(_e)}return ye.invert=function(_e){return le(_e)},ye.domain=function(_e){return arguments.length?(M=_e.map(Number),pe()):M},ye.range=function(_e){return arguments.length?(O=_e,pe()):O},ye.rangeRound=function(_e){return ye.range(_e).interpolate(jo)},ye.clamp=function(_e){return arguments.length?(j=_e,pe()):j},ye.interpolate=function(_e){return arguments.length?(R=_e,pe()):R},ye.ticks=function(_e){return Hr(M,_e)},ye.tickFormat=function(_e,Ne){return d3_scale_linearTickFormat(M,_e,Ne)},ye.nice=function(_e){return Dn(M,_e),pe()},ye.copy=function(){return oe(M,O,R,j)},pe()}([0,1],[0,1],Di,!1)},t.scale.log=function(){return function oe(M,O,R,j){function te(ye){return(R?Math.log(ye<0?0:ye):-Math.log(ye>0?0:-ye))/Math.log(O)}function le(ye){return R?Math.pow(O,ye):-Math.pow(O,-ye)}function pe(ye){return M(te(ye))}return pe.invert=function(ye){return le(M.invert(ye))},pe.domain=function(ye){return arguments.length?(R=ye[0]>=0,M.domain((j=ye.map(Number)).map(te)),pe):j},pe.base=function(ye){return arguments.length?(O=+ye,M.domain(j.map(te)),pe):O},pe.nice=function(){var ye=sn(j.map(te),R?Math:Xn);return M.domain(ye),j=ye.map(le),pe},pe.ticks=function(){var ye=qr(j),_e=[],Ne=ye[0],He=ye[1],et=Math.floor(te(Ne)),yt=Math.ceil(te(He)),kt=O%1?2:O;if(isFinite(yt-et)){if(R){for(;et<yt;et++)for(var _t=1;_t<kt;_t++)_e.push(le(et)*_t);_e.push(le(et))}else for(_e.push(le(et));et++<yt;)for(_t=kt-1;_t>0;_t--)_e.push(le(et)*_t);for(et=0;_e[et]<Ne;et++);for(yt=_e.length;_e[yt-1]>He;yt--);_e=_e.slice(et,yt)}return _e},pe.copy=function(){return oe(M.copy(),O,R,j)},Sn(pe,M)}(t.scale.linear().domain([0,1]),10,!0,[1,10])};var Xn={floor:function(oe){return-Math.ceil(-oe)},ceil:function(oe){return-Math.floor(-oe)}};function Tn(oe){return function(M){return M<0?-Math.pow(-M,oe):Math.pow(M,oe)}}t.scale.pow=function(){return function oe(M,O,R){var j=Tn(O),te=Tn(1/O);function le(pe){return M(j(pe))}return le.invert=function(pe){return te(M.invert(pe))},le.domain=function(pe){return arguments.length?(M.domain((R=pe.map(Number)).map(j)),le):R},le.ticks=function(pe){return Hr(R,pe)},le.tickFormat=function(pe,ye){return d3_scale_linearTickFormat(R,pe,ye)},le.nice=function(pe){return le.domain(Dn(R,pe))},le.exponent=function(pe){return arguments.length?(j=Tn(O=pe),te=Tn(1/O),M.domain(R.map(j)),le):O},le.copy=function(){return oe(M.copy(),O,R)},Sn(le,M)}(t.scale.linear(),1,[0,1])},t.scale.sqrt=function(){return t.scale.pow().exponent(.5)},t.scale.ordinal=function(){return function oe(M,O){var R,j,te;function le(ye){return j[((R.get(ye)||(O.t==="range"?R.set(ye,M.push(ye)):NaN))-1)%j.length]}function pe(ye,_e){return t.range(M.length).map(function(Ne){return ye+_e*Ne})}return le.domain=function(ye){if(!arguments.length)return M;M=[],R=new k;for(var _e,Ne=-1,He=ye.length;++Ne<He;)R.has(_e=ye[Ne])||R.set(_e,M.push(_e));return le[O.t].apply(le,O.a)},le.range=function(ye){return arguments.length?(j=ye,te=0,O={t:"range",a:arguments},le):j},le.rangePoints=function(ye,_e){arguments.length<2&&(_e=0);var Ne=ye[0],He=ye[1],et=M.length<2?(Ne=(Ne+He)/2,0):(He-Ne)/(M.length-1+_e);return j=pe(Ne+et*_e/2,et),te=0,O={t:"rangePoints",a:arguments},le},le.rangeRoundPoints=function(ye,_e){arguments.length<2&&(_e=0);var Ne=ye[0],He=ye[1],et=M.length<2?(Ne=He=Math.round((Ne+He)/2),0):(He-Ne)/(M.length-1+_e)|0;return j=pe(Ne+Math.round(et*_e/2+(He-Ne-(M.length-1+_e)*et)/2),et),te=0,O={t:"rangeRoundPoints",a:arguments},le},le.rangeBands=function(ye,_e,Ne){arguments.length<2&&(_e=0),arguments.length<3&&(Ne=_e);var He=ye[1]<ye[0],et=ye[He-0],yt=ye[1-He],kt=(yt-et)/(M.length-_e+2*Ne);return j=pe(et+kt*Ne,kt),He&&j.reverse(),te=kt*(1-_e),O={t:"rangeBands",a:arguments},le},le.rangeRoundBands=function(ye,_e,Ne){arguments.length<2&&(_e=0),arguments.length<3&&(Ne=_e);var He=ye[1]<ye[0],et=ye[He-0],yt=ye[1-He],kt=Math.floor((yt-et)/(M.length-_e+2*Ne));return j=pe(et+Math.round((yt-et-(M.length-_e)*kt)/2),kt),He&&j.reverse(),te=Math.round(kt*(1-_e)),O={t:"rangeRoundBands",a:arguments},le},le.rangeBand=function(){return te},le.rangeExtent=function(){return qr(O.a[0])},le.copy=function(){return oe(M,O)},le.domain(M)}([],{t:"range",a:[[]]})},t.scale.category10=function(){return t.scale.ordinal().range(Cn)},t.scale.category20=function(){return t.scale.ordinal().range(Yn)},t.scale.category20b=function(){return t.scale.ordinal().range(_a)},t.scale.category20c=function(){return t.scale.ordinal().range(Sa)};var Cn=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ar),Yn=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ar),_a=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ar),Sa=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ar);function yn(){return 0}t.scale.quantile=function(){return function oe(M,O){var R;function j(){var le=0,pe=O.length;for(R=[];++le<pe;)R[le-1]=t.quantile(M,le/pe);return te}function te(le){if(!isNaN(le=+le))return O[t.bisect(R,le)]}return te.domain=function(le){return arguments.length?(M=le.map(f).filter(d).sort(c),j()):M},te.range=function(le){return arguments.length?(O=le,j()):O},te.quantiles=function(){return R},te.invertExtent=function(le){return(le=O.indexOf(le))<0?[NaN,NaN]:[le>0?R[le-1]:M[0],le<R.length?R[le]:M[M.length-1]]},te.copy=function(){return oe(M,O)},j()}([],[])},t.scale.quantize=function(){return function oe(M,O,R){var j,te;function le(ye){return R[Math.max(0,Math.min(te,Math.floor(j*(ye-M))))]}function pe(){return j=R.length/(O-M),te=R.length-1,le}return le.domain=function(ye){return arguments.length?(M=+ye[0],O=+ye[ye.length-1],pe()):[M,O]},le.range=function(ye){return arguments.length?(R=ye,pe()):R},le.invertExtent=function(ye){return[ye=(ye=R.indexOf(ye))<0?NaN:ye/j+M,ye+1/j]},le.copy=function(){return oe(M,O,R)},pe()}(0,1,[0,1])},t.scale.threshold=function(){return function oe(M,O){function R(j){if(j<=j)return O[t.bisect(M,j)]}return R.domain=function(j){return arguments.length?(M=j,R):M},R.range=function(j){return arguments.length?(O=j,R):O},R.invertExtent=function(j){return j=O.indexOf(j),[M[j-1],M[j]]},R.copy=function(){return oe(M,O)},R}([.5],[0,1])},t.scale.identity=function(){return function oe(M){function O(R){return+R}return O.invert=O,O.domain=O.range=function(R){return arguments.length?(M=R.map(O),O):M},O.ticks=function(R){return Hr(M,R)},O.tickFormat=function(R,j){return d3_scale_linearTickFormat(M,R,j)},O.copy=function(){return oe(M)},O}([0,1])},t.svg={},t.svg.arc=function(){var oe=Ma,M=fa,O=yn,R=Pa,j=Ia,te=Ta,le=Ja;function pe(){var _e=Math.max(0,+oe.apply(this,arguments)),Ne=Math.max(0,+M.apply(this,arguments)),He=j.apply(this,arguments)-Ge,et=te.apply(this,arguments)-Ge,yt=Math.abs(et-He),kt=He>et?0:1;if(Ne<_e&&(_t=Ne,Ne=_e,_e=_t),yt>=je)return ye(Ne,kt)+(_e?ye(_e,1-kt):"")+"Z";var _t,wt,vt,Dt,Pt,Ft,er,cr,Ar,Tr,Yr,Gr,an=0,$r=0,In=[];if((Dt=(+le.apply(this,arguments)||0)/2)&&(vt=R===Pa?Math.sqrt(_e*_e+Ne*Ne):+R.apply(this,arguments),kt||($r*=-1),Ne&&($r=be(vt/Ne*Math.sin(Dt))),_e&&(an=be(vt/_e*Math.sin(Dt)))),Ne){Pt=Ne*Math.cos(He+$r),Ft=Ne*Math.sin(He+$r),er=Ne*Math.cos(et-$r),cr=Ne*Math.sin(et-$r);var jn=Math.abs(et-He-2*$r)<=Jt?0:1;if($r&&Zn(Pt,Ft,er,cr)===kt^jn){var ia=(He+et)/2;Pt=Ne*Math.cos(ia),Ft=Ne*Math.sin(ia),er=cr=null}}else Pt=Ft=0;if(_e){Ar=_e*Math.cos(et-an),Tr=_e*Math.sin(et-an),Yr=_e*Math.cos(He+an),Gr=_e*Math.sin(He+an);var jr=Math.abs(He-et+2*an)<=Jt?0:1;if(an&&Zn(Ar,Tr,Yr,Gr)===1-kt^jr){var mn=(He+et)/2;Ar=_e*Math.cos(mn),Tr=_e*Math.sin(mn),Yr=Gr=null}}else Ar=Tr=0;if(yt>Mt&&(_t=Math.min(Math.abs(Ne-_e)/2,+O.apply(this,arguments)))>.001){wt=_e<Ne^kt?0:1;var Un=_t,Fn=_t;if(yt<Jt){var Jn=Yr==null?[Ar,Tr]:er==null?[Pt,Ft]:gt([Pt,Ft],[Yr,Gr],[er,cr],[Ar,Tr]),sa=Pt-Jn[0],ka=Ft-Jn[1],qn=er-Jn[0],va=cr-Jn[1],pa=1/Math.sin(Math.acos((sa*qn+ka*va)/(Math.sqrt(sa*sa+ka*ka)*Math.sqrt(qn*qn+va*va)))/2),Ea=Math.sqrt(Jn[0]*Jn[0]+Jn[1]*Jn[1]);Fn=Math.min(_t,(_e-Ea)/(pa-1)),Un=Math.min(_t,(Ne-Ea)/(pa+1))}if(er!=null){var ya=Ha(Yr==null?[Ar,Tr]:[Yr,Gr],[Pt,Ft],Ne,Un,kt),La=Ha([er,cr],[Ar,Tr],Ne,Un,kt);_t===Un?In.push("M",ya[0],"A",Un,",",Un," 0 0,",wt," ",ya[1],"A",Ne,",",Ne," 0 ",1-kt^Zn(ya[1][0],ya[1][1],La[1][0],La[1][1]),",",kt," ",La[1],"A",Un,",",Un," 0 0,",wt," ",La[0]):In.push("M",ya[0],"A",Un,",",Un," 0 1,",wt," ",La[0])}else In.push("M",Pt,",",Ft);if(Yr!=null){var Fa=Ha([Pt,Ft],[Yr,Gr],_e,-Fn,kt),si=Ha([Ar,Tr],er==null?[Pt,Ft]:[er,cr],_e,-Fn,kt);_t===Fn?In.push("L",si[0],"A",Fn,",",Fn," 0 0,",wt," ",si[1],"A",_e,",",_e," 0 ",kt^Zn(si[1][0],si[1][1],Fa[1][0],Fa[1][1]),",",1-kt," ",Fa[1],"A",Fn,",",Fn," 0 0,",wt," ",Fa[0]):In.push("L",si[0],"A",Fn,",",Fn," 0 0,",wt," ",Fa[0])}else In.push("L",Ar,",",Tr)}else In.push("M",Pt,",",Ft),er!=null&&In.push("A",Ne,",",Ne," 0 ",jn,",",kt," ",er,",",cr),In.push("L",Ar,",",Tr),Yr!=null&&In.push("A",_e,",",_e," 0 ",jr,",",1-kt," ",Yr,",",Gr);return In.push("Z"),In.join("")}function ye(_e,Ne){return"M0,"+_e+"A"+_e+","+_e+" 0 1,"+Ne+" 0,"+-_e+"A"+_e+","+_e+" 0 1,"+Ne+" 0,"+_e}return pe.innerRadius=function(_e){return arguments.length?(oe=wr(_e),pe):oe},pe.outerRadius=function(_e){return arguments.length?(M=wr(_e),pe):M},pe.cornerRadius=function(_e){return arguments.length?(O=wr(_e),pe):O},pe.padRadius=function(_e){return arguments.length?(R=_e==Pa?Pa:wr(_e),pe):R},pe.startAngle=function(_e){return arguments.length?(j=wr(_e),pe):j},pe.endAngle=function(_e){return arguments.length?(te=wr(_e),pe):te},pe.padAngle=function(_e){return arguments.length?(le=wr(_e),pe):le},pe.centroid=function(){var _e=(+oe.apply(this,arguments)+ +M.apply(this,arguments))/2,Ne=(+j.apply(this,arguments)+ +te.apply(this,arguments))/2-Ge;return[Math.cos(Ne)*_e,Math.sin(Ne)*_e]},pe};var Pa="auto";function Ma(oe){return oe.innerRadius}function fa(oe){return oe.outerRadius}function Ia(oe){return oe.startAngle}function Ta(oe){return oe.endAngle}function Ja(oe){return oe&&oe.padAngle}function Zn(oe,M,O,R){return(oe-O)*M-(M-R)*oe>0?0:1}function Ha(oe,M,O,R,j){var te=oe[0]-M[0],le=oe[1]-M[1],pe=(j?R:-R)/Math.sqrt(te*te+le*le),ye=pe*le,_e=-pe*te,Ne=oe[0]+ye,He=oe[1]+_e,et=M[0]+ye,yt=M[1]+_e,kt=(Ne+et)/2,_t=(He+yt)/2,wt=et-Ne,vt=yt-He,Dt=wt*wt+vt*vt,Pt=O-R,Ft=Ne*yt-et*He,er=(vt<0?-1:1)*Math.sqrt(Math.max(0,Pt*Pt*Dt-Ft*Ft)),cr=(Ft*vt-wt*er)/Dt,Ar=(-Ft*wt-vt*er)/Dt,Tr=(Ft*vt+wt*er)/Dt,Yr=(-Ft*wt+vt*er)/Dt,Gr=cr-kt,an=Ar-_t,$r=Tr-kt,In=Yr-_t;return Gr*Gr+an*an>$r*$r+In*In&&(cr=Tr,Ar=Yr),[[cr-ye,Ar-_e],[cr*O/Pt,Ar*O/Pt]]}function Fi(){return!0}function Wo(oe){var M=Qr,O=un,R=Fi,j=po,te=j.key,le=.7;function pe(ye){var _e,Ne=[],He=[],et=-1,yt=ye.length,kt=wr(M),_t=wr(O);function wt(){Ne.push("M",j(oe(He),le))}for(;++et<yt;)R.call(this,_e=ye[et],et)?He.push([+kt.call(this,_e,et),+_t.call(this,_e,et)]):He.length&&(wt(),He=[]);return He.length&&wt(),Ne.length?Ne.join(""):null}return pe.x=function(ye){return arguments.length?(M=ye,pe):M},pe.y=function(ye){return arguments.length?(O=ye,pe):O},pe.defined=function(ye){return arguments.length?(R=ye,pe):R},pe.interpolate=function(ye){return arguments.length?(te=typeof ye=="function"?j=ye:(j=Io.get(ye)||po).key,pe):te},pe.tension=function(ye){return arguments.length?(le=ye,pe):le},pe}t.svg.line=function(){return Wo(z)};var Io=t.map({linear:po,"linear-closed":ga,step:function(oe){for(var M=0,O=oe.length,R=oe[0],j=[R[0],",",R[1]];++M<O;)j.push("H",(R[0]+(R=oe[M])[0])/2,"V",R[1]);return O>1&&j.push("H",R[0]),j.join("")},"step-before":fi,"step-after":go,basis:Ui,"basis-open":function(oe){if(oe.length<4)return po(oe);for(var M,O=[],R=-1,j=oe.length,te=[0],le=[0];++R<3;)M=oe[R],te.push(M[0]),le.push(M[1]);for(O.push(Qa($i,te)+","+Qa($i,le)),--R;++R<j;)M=oe[R],te.shift(),te.push(M[0]),le.shift(),le.push(M[1]),is(O,te,le);return O.join("")},"basis-closed":function(oe){for(var M,O,R=-1,j=oe.length,te=j+4,le=[],pe=[];++R<4;)O=oe[R%j],le.push(O[0]),pe.push(O[1]);for(M=[Qa($i,le),",",Qa($i,pe)],--R;++R<te;)O=oe[R%j],le.shift(),le.push(O[0]),pe.shift(),pe.push(O[1]),is(M,le,pe);return M.join("")},bundle:function(oe,M){var O=oe.length-1;if(O)for(var R,j,te=oe[0][0],le=oe[0][1],pe=oe[O][0]-te,ye=oe[O][1]-le,_e=-1;++_e<=O;)R=oe[_e],j=_e/O,R[0]=M*R[0]+(1-M)*(te+j*pe),R[1]=M*R[1]+(1-M)*(le+j*ye);return Ui(oe)},cardinal:function(oe,M){return oe.length<3?po(oe):oe[0]+Ga(oe,bi(oe,M))},"cardinal-open":function(oe,M){return oe.length<4?po(oe):oe[1]+Ga(oe.slice(1,-1),bi(oe,M))},"cardinal-closed":function(oe,M){return oe.length<3?ga(oe):oe[0]+Ga((oe.push(oe[0]),oe),bi([oe[oe.length-2]].concat(oe,[oe[1]]),M))},monotone:function(oe){return oe.length<3?po(oe):oe[0]+Ga(oe,function(M){for(var O,R,j,te,le=[],pe=function(Ne){for(var He=0,et=Ne.length-1,yt=[],kt=Ne[0],_t=Ne[1],wt=yt[0]=$o(kt,_t);++He<et;)yt[He]=(wt+(wt=$o(kt=_t,_t=Ne[He+1])))/2;return yt[He]=wt,yt}(M),ye=-1,_e=M.length-1;++ye<_e;)O=$o(M[ye],M[ye+1]),v(O)<Mt?pe[ye]=pe[ye+1]=0:(R=pe[ye]/O,j=pe[ye+1]/O,(te=R*R+j*j)>9&&(te=3*O/Math.sqrt(te),pe[ye]=te*R,pe[ye+1]=te*j));for(ye=-1;++ye<=_e;)te=(M[Math.min(_e,ye+1)][0]-M[Math.max(0,ye-1)][0])/(6*(1+pe[ye]*pe[ye])),le.push([te||0,pe[ye]*te||0]);return le}(oe))}});function po(oe){return oe.length>1?oe.join("L"):oe+"Z"}function ga(oe){return oe.join("L")+"Z"}function fi(oe){for(var M=0,O=oe.length,R=oe[0],j=[R[0],",",R[1]];++M<O;)j.push("V",(R=oe[M])[1],"H",R[0]);return j.join("")}function go(oe){for(var M=0,O=oe.length,R=oe[0],j=[R[0],",",R[1]];++M<O;)j.push("H",(R=oe[M])[0],"V",R[1]);return j.join("")}function Ga(oe,M){if(M.length<1||oe.length!=M.length&&oe.length!=M.length+2)return po(oe);var O=oe.length!=M.length,R="",j=oe[0],te=oe[1],le=M[0],pe=le,ye=1;if(O&&(R+="Q"+(te[0]-2*le[0]/3)+","+(te[1]-2*le[1]/3)+","+te[0]+","+te[1],j=oe[1],ye=2),M.length>1){pe=M[1],te=oe[ye],ye++,R+="C"+(j[0]+le[0])+","+(j[1]+le[1])+","+(te[0]-pe[0])+","+(te[1]-pe[1])+","+te[0]+","+te[1];for(var _e=2;_e<M.length;_e++,ye++)te=oe[ye],pe=M[_e],R+="S"+(te[0]-pe[0])+","+(te[1]-pe[1])+","+te[0]+","+te[1]}if(O){var Ne=oe[ye];R+="Q"+(te[0]+2*pe[0]/3)+","+(te[1]+2*pe[1]/3)+","+Ne[0]+","+Ne[1]}return R}function bi(oe,M){for(var O,R=[],j=(1-M)/2,te=oe[0],le=oe[1],pe=1,ye=oe.length;++pe<ye;)O=te,te=le,le=oe[pe],R.push([j*(le[0]-O[0]),j*(le[1]-O[1])]);return R}function Ui(oe){if(oe.length<3)return po(oe);var M=1,O=oe.length,R=oe[0],j=R[0],te=R[1],le=[j,j,j,(R=oe[1])[0]],pe=[te,te,te,R[1]],ye=[j,",",te,"L",Qa($i,le),",",Qa($i,pe)];for(oe.push(oe[O-1]);++M<=O;)R=oe[M],le.shift(),le.push(R[0]),pe.shift(),pe.push(R[1]),is(ye,le,pe);return oe.pop(),ye.push("L",R),ye.join("")}function Qa(oe,M){return oe[0]*M[0]+oe[1]*M[1]+oe[2]*M[2]+oe[3]*M[3]}Io.forEach(function(oe,M){M.key=oe,M.closed=/-closed$/.test(oe)});var so=[0,2/3,1/3,0],$a=[0,1/3,2/3,0],$i=[0,1/6,2/3,1/6];function is(oe,M,O){oe.push("C",Qa(so,M),",",Qa(so,O),",",Qa($a,M),",",Qa($a,O),",",Qa($i,M),",",Qa($i,O))}function $o(oe,M){return(M[1]-oe[1])/(M[0]-oe[0])}function Ds(oe){for(var M,O,R,j=-1,te=oe.length;++j<te;)O=(M=oe[j])[0],R=M[1]-Ge,M[0]=O*Math.cos(R),M[1]=O*Math.sin(R);return oe}function Pi(oe){var M=Qr,O=Qr,R=0,j=un,te=Fi,le=po,pe=le.key,ye=le,_e="L",Ne=.7;function He(et){var yt,kt,_t,wt=[],vt=[],Dt=[],Pt=-1,Ft=et.length,er=wr(M),cr=wr(R),Ar=M===O?function(){return kt}:wr(O),Tr=R===j?function(){return _t}:wr(j);function Yr(){wt.push("M",le(oe(Dt),Ne),_e,ye(oe(vt.reverse()),Ne),"Z")}for(;++Pt<Ft;)te.call(this,yt=et[Pt],Pt)?(vt.push([kt=+er.call(this,yt,Pt),_t=+cr.call(this,yt,Pt)]),Dt.push([+Ar.call(this,yt,Pt),+Tr.call(this,yt,Pt)])):vt.length&&(Yr(),vt=[],Dt=[]);return vt.length&&Yr(),wt.length?wt.join(""):null}return He.x=function(et){return arguments.length?(M=O=et,He):O},He.x0=function(et){return arguments.length?(M=et,He):M},He.x1=function(et){return arguments.length?(O=et,He):O},He.y=function(et){return arguments.length?(R=j=et,He):j},He.y0=function(et){return arguments.length?(R=et,He):R},He.y1=function(et){return arguments.length?(j=et,He):j},He.defined=function(et){return arguments.length?(te=et,He):te},He.interpolate=function(et){return arguments.length?(pe=typeof et=="function"?le=et:(le=Io.get(et)||po).key,ye=le.reverse||le,_e=le.closed?"M":"L",He):pe},He.tension=function(et){return arguments.length?(Ne=et,He):Ne},He}function Rs(oe){return oe.source}function Ii(oe){return oe.target}function es(oe){return oe.radius}function na(oe){return[oe.x,oe.y]}function ma(oe){return function(){var M=oe.apply(this,arguments),O=M[0],R=M[1]-Ge;return[O*Math.cos(R),O*Math.sin(R)]}}function Fs(){return 64}function Bs(){return"circle"}function ts(oe){var M=Math.sqrt(oe/Jt);return"M0,"+M+"A"+M+","+M+" 0 1,1 0,"+-M+"A"+M+","+M+" 0 1,1 0,"+M+"Z"}t.svg.line.radial=function(){var oe=Wo(Ds);return oe.radius=oe.x,delete oe.x,oe.angle=oe.y,delete oe.y,oe},fi.reverse=go,go.reverse=fi,t.svg.area=function(){return Pi(z)},t.svg.area.radial=function(){var oe=Pi(Ds);return oe.radius=oe.x,delete oe.x,oe.innerRadius=oe.x0,delete oe.x0,oe.outerRadius=oe.x1,delete oe.x1,oe.angle=oe.y,delete oe.y,oe.startAngle=oe.y0,delete oe.y0,oe.endAngle=oe.y1,delete oe.y1,oe},t.svg.chord=function(){var oe=Rs,M=Ii,O=es,R=Ia,j=Ta;function te(_e,Ne){var He,et,yt=le(this,oe,_e,Ne),kt=le(this,M,_e,Ne);return"M"+yt.p0+pe(yt.r,yt.p1,yt.a1-yt.a0)+(et=kt,((He=yt).a0==et.a0&&He.a1==et.a1?ye(yt.r,yt.p1,yt.r,yt.p0):ye(yt.r,yt.p1,kt.r,kt.p0)+pe(kt.r,kt.p1,kt.a1-kt.a0)+ye(kt.r,kt.p1,yt.r,yt.p0))+"Z")}function le(_e,Ne,He,et){var yt=Ne.call(_e,He,et),kt=O.call(_e,yt,et),_t=R.call(_e,yt,et)-Ge,wt=j.call(_e,yt,et)-Ge;return{r:kt,a0:_t,a1:wt,p0:[kt*Math.cos(_t),kt*Math.sin(_t)],p1:[kt*Math.cos(wt),kt*Math.sin(wt)]}}function pe(_e,Ne,He){return"A"+_e+","+_e+" 0 "+ +(He>Jt)+",1 "+Ne}function ye(_e,Ne,He,et){return"Q 0,0 "+et}return te.radius=function(_e){return arguments.length?(O=wr(_e),te):O},te.source=function(_e){return arguments.length?(oe=wr(_e),te):oe},te.target=function(_e){return arguments.length?(M=wr(_e),te):M},te.startAngle=function(_e){return arguments.length?(R=wr(_e),te):R},te.endAngle=function(_e){return arguments.length?(j=wr(_e),te):j},te},t.svg.diagonal=function(){var oe=Rs,M=Ii,O=na;function R(j,te){var le=oe.call(this,j,te),pe=M.call(this,j,te),ye=(le.y+pe.y)/2,_e=[le,{x:le.x,y:ye},{x:pe.x,y:ye},pe];return"M"+(_e=_e.map(O))[0]+"C"+_e[1]+" "+_e[2]+" "+_e[3]}return R.source=function(j){return arguments.length?(oe=wr(j),R):oe},R.target=function(j){return arguments.length?(M=wr(j),R):M},R.projection=function(j){return arguments.length?(O=j,R):O},R},t.svg.diagonal.radial=function(){var oe=t.svg.diagonal(),M=na,O=oe.projection;return oe.projection=function(R){return arguments.length?O(ma(M=R)):M},oe},t.svg.symbol=function(){var oe=Bs,M=Fs;function O(R,j){return(Eo.get(oe.call(this,R,j))||ts)(M.call(this,R,j))}return O.type=function(R){return arguments.length?(oe=wr(R),O):oe},O.size=function(R){return arguments.length?(M=wr(R),O):M},O};var Eo=t.map({circle:ts,cross:function(oe){var M=Math.sqrt(oe/5)/2;return"M"+-3*M+","+-M+"H"+-M+"V"+-3*M+"H"+M+"V"+-M+"H"+3*M+"V"+M+"H"+M+"V"+3*M+"H"+-M+"V"+M+"H"+-3*M+"Z"},diamond:function(oe){var M=Math.sqrt(oe/(2*Js)),O=M*Js;return"M0,"+-M+"L"+O+",0 0,"+M+" "+-O+",0Z"},square:function(oe){var M=Math.sqrt(oe)/2;return"M"+-M+","+-M+"L"+M+","+-M+" "+M+","+M+" "+-M+","+M+"Z"},"triangle-down":function(oe){var M=Math.sqrt(oe/qo),O=M*qo/2;return"M0,"+O+"L"+M+","+-O+" "+-M+","+-O+"Z"},"triangle-up":function(oe){var M=Math.sqrt(oe/qo),O=M*qo/2;return"M0,"+-O+"L"+M+","+O+" "+-M+","+O+"Z"}});t.svg.symbolTypes=Eo.keys();var qo=Math.sqrt(3),Js=Math.tan(30*Ct);ne.transition=function(oe){for(var M,O,R=ps||++ds,j=As(oe),te=[],le=os||{time:Date.now(),ease:vs,delay:0,duration:250},pe=-1,ye=this.length;++pe<ye;){te.push(M=[]);for(var _e=this[pe],Ne=-1,He=_e.length;++Ne<He;)(O=_e[Ne])&&ss(O,Ne,j,R,le),M.push(O)}return ei(te,j,R)},ne.interrupt=function(oe){return this.each(oe==null?ks:Ya(As(oe)))};var ks=Ya(As());function Ya(oe){return function(){var M,O,R;(M=this[oe])&&(R=M[O=M.active])&&(R.timer.c=null,R.timer.t=NaN,--M.count?delete M[O]:delete this[oe],M.active+=.5,R.event&&R.event.interrupt.call(this,this.__data__,R.index))}}function ei(oe,M,O){return U(oe,Si),oe.namespace=M,oe.id=O,oe}var ps,os,Si=[],ds=0;function Ms(oe,M,O,R){var j=oe.id,te=oe.namespace;return Be(oe,typeof O=="function"?function(le,pe,ye){le[te][j].tween.set(M,R(O.call(le,le.__data__,pe,ye)))}:(O=R(O),function(le){le[te][j].tween.set(M,O)}))}function ys(oe){return oe==null&&(oe=""),function(){this.textContent=oe}}function As(oe){return oe==null?"__transition__":"__transition_"+oe+"__"}function ss(oe,M,O,R,j){var te,le,pe,ye,_e,Ne=oe[O]||(oe[O]={active:0,count:0}),He=Ne[R];function et(kt){var _t=Ne.active,wt=Ne[_t];for(var vt in wt&&(wt.timer.c=null,wt.timer.t=NaN,--Ne.count,delete Ne[_t],wt.event&&wt.event.interrupt.call(oe,oe.__data__,wt.index)),Ne)if(+vt<R){var Dt=Ne[vt];Dt.timer.c=null,Dt.timer.t=NaN,--Ne.count,delete Ne[vt]}le.c=yt,Dr(function(){return le.c&&yt(kt||1)&&(le.c=null,le.t=NaN),1},0,te),Ne.active=R,He.event&&He.event.start.call(oe,oe.__data__,M),_e=[],He.tween.forEach(function(Pt,Ft){(Ft=Ft.call(oe,oe.__data__,M))&&_e.push(Ft)}),ye=He.ease,pe=He.duration}function yt(kt){for(var _t=kt/pe,wt=ye(_t),vt=_e.length;vt>0;)_e[--vt].call(oe,wt);if(_t>=1)return He.event&&He.event.end.call(oe,oe.__data__,M),--Ne.count?delete Ne[R]:delete oe[O],1}He||(te=j.time,le=Dr(function(kt){var _t=He.delay;if(le.t=_t+te,_t<=kt)return et(kt-_t);le.c=et},0,te),He=Ne[R]={tween:new k,time:te,timer:le,delay:j.delay,duration:j.duration,ease:j.ease,index:M},j=null,++Ne.count)}Si.call=ne.call,Si.empty=ne.empty,Si.node=ne.node,Si.size=ne.size,t.transition=function(oe,M){return oe&&oe.transition?ps?oe.transition(M):oe:t.selection().transition(oe)},t.transition.prototype=Si,Si.select=function(oe){var M,O,R,j=this.id,te=this.namespace,le=[];oe=ae(oe);for(var pe=-1,ye=this.length;++pe<ye;){le.push(M=[]);for(var _e=this[pe],Ne=-1,He=_e.length;++Ne<He;)(R=_e[Ne])&&(O=oe.call(R,R.__data__,Ne,pe))?("__data__"in R&&(O.__data__=R.__data__),ss(O,Ne,te,j,R[te][j]),M.push(O)):M.push(null)}return ei(le,te,j)},Si.selectAll=function(oe){var M,O,R,j,te,le=this.id,pe=this.namespace,ye=[];oe=ie(oe);for(var _e=-1,Ne=this.length;++_e<Ne;)for(var He=this[_e],et=-1,yt=He.length;++et<yt;)if(R=He[et]){te=R[pe][le],O=oe.call(R,R.__data__,et,_e),ye.push(M=[]);for(var kt=-1,_t=O.length;++kt<_t;)(j=O[kt])&&ss(j,kt,pe,le,te),M.push(j)}return ei(ye,pe,le)},Si.filter=function(oe){var M,O,R=[];typeof oe!="function"&&(oe=Se(oe));for(var j=0,te=this.length;j<te;j++){R.push(M=[]);for(var le,pe=0,ye=(le=this[j]).length;pe<ye;pe++)(O=le[pe])&&oe.call(O,O.__data__,pe,j)&&M.push(O)}return ei(R,this.namespace,this.id)},Si.tween=function(oe,M){var O=this.id,R=this.namespace;return arguments.length<2?this.node()[R][O].tween.get(oe):Be(this,M==null?function(j){j[R][O].tween.remove(oe)}:function(j){j[R][O].tween.set(oe,M)})},Si.attr=function(oe,M){if(arguments.length<2){for(M in oe)this.attr(M,oe[M]);return this}var O=oe=="transform"?Vo:Di,R=t.ns.qualify(oe);function j(){this.removeAttribute(R)}function te(){this.removeAttributeNS(R.space,R.local)}function le(ye){return ye==null?j:(ye+="",function(){var _e,Ne=this.getAttribute(R);return Ne!==ye&&(_e=O(Ne,ye),function(He){this.setAttribute(R,_e(He))})})}function pe(ye){return ye==null?te:(ye+="",function(){var _e,Ne=this.getAttributeNS(R.space,R.local);return Ne!==ye&&(_e=O(Ne,ye),function(He){this.setAttributeNS(R.space,R.local,_e(He))})})}return Ms(this,"attr."+oe,M,R.local?pe:le)},Si.attrTween=function(oe,M){var O=t.ns.qualify(oe);return this.tween("attr."+oe,O.local?function(R,j){var te=M.call(this,R,j,this.getAttributeNS(O.space,O.local));return te&&function(le){this.setAttributeNS(O.space,O.local,te(le))}}:function(R,j){var te=M.call(this,R,j,this.getAttribute(O));return te&&function(le){this.setAttribute(O,te(le))}})},Si.style=function(oe,M,O){var R=arguments.length;if(R<3){if(typeof oe!="string"){for(O in R<2&&(M=""),oe)this.style(O,oe[O],M);return this}O=""}function j(){this.style.removeProperty(oe)}function te(le){return le==null?j:(le+="",function(){var pe,ye=l(this).getComputedStyle(this,null).getPropertyValue(oe);return ye!==le&&(pe=Di(ye,le),function(_e){this.style.setProperty(oe,pe(_e),O)})})}return Ms(this,"style."+oe,M,te)},Si.styleTween=function(oe,M,O){function R(j,te){var le=M.call(this,j,te,l(this).getComputedStyle(this,null).getPropertyValue(oe));return le&&function(pe){this.style.setProperty(oe,le(pe),O)}}return arguments.length<3&&(O=""),this.tween("style."+oe,R)},Si.text=function(oe){return Ms(this,"text",oe,ys)},Si.remove=function(){var oe=this.namespace;return this.each("end.transition",function(){var M;this[oe].count<2&&(M=this.parentNode)&&M.removeChild(this)})},Si.ease=function(oe){var M=this.id,O=this.namespace;return arguments.length<1?this.node()[O][M].ease:(typeof oe!="function"&&(oe=t.ease.apply(t,arguments)),Be(this,function(R){R[O][M].ease=oe}))},Si.delay=function(oe){var M=this.id,O=this.namespace;return arguments.length<1?this.node()[O][M].delay:Be(this,typeof oe=="function"?function(R,j,te){R[O][M].delay=+oe.call(R,R.__data__,j,te)}:(oe=+oe,function(R){R[O][M].delay=oe}))},Si.duration=function(oe){var M=this.id,O=this.namespace;return arguments.length<1?this.node()[O][M].duration:Be(this,typeof oe=="function"?function(R,j,te){R[O][M].duration=Math.max(1,oe.call(R,R.__data__,j,te))}:(oe=Math.max(1,oe),function(R){R[O][M].duration=oe}))},Si.each=function(oe,M){var O=this.id,R=this.namespace;if(arguments.length<2){var j=os,te=ps;try{ps=O,Be(this,function(le,pe,ye){os=le[R][O],oe.call(le,le.__data__,pe,ye)})}finally{os=j,ps=te}}else Be(this,function(le){var pe=le[R][O];(pe.event||(pe.event=t.dispatch("start","end","interrupt"))).on(oe,M)});return this},Si.transition=function(){for(var oe,M,O,R=this.id,j=++ds,te=this.namespace,le=[],pe=0,ye=this.length;pe<ye;pe++){le.push(oe=[]);for(var _e,Ne=0,He=(_e=this[pe]).length;Ne<He;Ne++)(M=_e[Ne])&&ss(M,Ne,te,j,{time:(O=M[te][R]).time,ease:O.ease,delay:O.delay+O.duration,duration:O.duration}),oe.push(M)}return ei(le,te,j)},t.svg.axis=function(){var oe,M=t.scale.linear(),O=Ks,R=6,j=6,te=3,le=[10],pe=null;function ye(_e){_e.each(function(){var Ne,He=t.select(this),et=this.__chart__||M,yt=this.__chart__=M.copy(),kt=pe??(yt.ticks?yt.ticks.apply(yt,le):yt.domain()),_t=oe??(yt.tickFormat?yt.tickFormat.apply(yt,le):z),wt=He.selectAll(".tick").data(kt,yt),vt=wt.enter().insert("g",".domain").attr("class","tick").style("opacity",Mt),Dt=t.transition(wt.exit()).style("opacity",Mt).remove(),Pt=t.transition(wt.order()).style("opacity",1),Ft=Math.max(R,0)+te,er=en(yt),cr=He.selectAll(".domain").data([0]),Ar=(cr.enter().append("path").attr("class","domain"),t.transition(cr));vt.append("line"),vt.append("text");var Tr,Yr,Gr,an,$r=vt.select("line"),In=Pt.select("line"),jn=wt.select("text").text(_t),ia=vt.select("text"),jr=Pt.select("text"),mn=O==="top"||O==="left"?-1:1;if(O==="bottom"||O==="top"?(Ne=gs,Tr="x",Gr="y",Yr="x2",an="y2",jn.attr("dy",mn<0?"0em":".71em").style("text-anchor","middle"),Ar.attr("d","M"+er[0]+","+mn*j+"V0H"+er[1]+"V"+mn*j)):(Ne=Qs,Tr="y",Gr="x",Yr="y2",an="x2",jn.attr("dy",".32em").style("text-anchor",mn<0?"end":"start"),Ar.attr("d","M"+mn*j+","+er[0]+"H0V"+er[1]+"H"+mn*j)),$r.attr(an,mn*R),ia.attr(Gr,mn*Ft),In.attr(Yr,0).attr(an,mn*R),jr.attr(Tr,0).attr(Gr,mn*Ft),yt.rangeBand){var Un=yt,Fn=Un.rangeBand()/2;et=yt=function(Jn){return Un(Jn)+Fn}}else et.rangeBand?et=yt:Dt.call(Ne,yt,et);vt.call(Ne,et,yt),Pt.call(Ne,yt,yt)})}return ye.scale=function(_e){return arguments.length?(M=_e,ye):M},ye.orient=function(_e){return arguments.length?(O=_e in ol?_e+"":Ks,ye):O},ye.ticks=function(){return arguments.length?(le=p(arguments),ye):le},ye.tickValues=function(_e){return arguments.length?(pe=_e,ye):pe},ye.tickFormat=function(_e){return arguments.length?(oe=_e,ye):oe},ye.tickSize=function(_e){var Ne=arguments.length;return Ne?(R=+_e,j=+arguments[Ne-1],ye):R},ye.innerTickSize=function(_e){return arguments.length?(R=+_e,ye):R},ye.outerTickSize=function(_e){return arguments.length?(j=+_e,ye):j},ye.tickPadding=function(_e){return arguments.length?(te=+_e,ye):te},ye.tickSubdivide=function(){return arguments.length&&ye},ye};var Ks="bottom",ol={top:1,right:1,bottom:1,left:1};function gs(oe,M,O){oe.attr("transform",function(R){var j=M(R);return"translate("+(isFinite(j)?j:O(R))+",0)"})}function Qs(oe,M,O){oe.attr("transform",function(R){var j=M(R);return"translate(0,"+(isFinite(j)?j:O(R))+")"})}t.svg.brush=function(){var oe,M,O=J(Ne,"brushstart","brush","brushend"),R=null,j=null,te=[0,0],le=[0,0],pe=!0,ye=!0,_e=eo[0];function Ne(_t){_t.each(function(){var wt=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",kt).on("touchstart.brush",kt),vt=wt.selectAll(".background").data([0]);vt.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),wt.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var Dt=wt.selectAll(".resize").data(_e,z);Dt.exit().remove(),Dt.enter().append("g").attr("class",function(cr){return"resize "+cr}).style("cursor",function(cr){return Ss[cr]}).append("rect").attr("x",function(cr){return/[ew]$/.test(cr)?-3:null}).attr("y",function(cr){return/^[ns]/.test(cr)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),Dt.style("display",Ne.empty()?"none":null);var Pt,Ft=t.transition(wt),er=t.transition(vt);R&&(Pt=en(R),er.attr("x",Pt[0]).attr("width",Pt[1]-Pt[0]),et(Ft)),j&&(Pt=en(j),er.attr("y",Pt[0]).attr("height",Pt[1]-Pt[0]),yt(Ft)),He(Ft)})}function He(_t){_t.selectAll(".resize").attr("transform",function(wt){return"translate("+te[+/e$/.test(wt)]+","+le[+/^s/.test(wt)]+")"})}function et(_t){_t.select(".extent").attr("x",te[0]),_t.selectAll(".extent,.n>rect,.s>rect").attr("width",te[1]-te[0])}function yt(_t){_t.select(".extent").attr("y",le[0]),_t.selectAll(".extent,.e>rect,.w>rect").attr("height",le[1]-le[0])}function kt(){var _t,wt,vt=this,Dt=t.select(t.event.target),Pt=O.of(vt,arguments),Ft=t.select(vt),er=Dt.datum(),cr=!/^(n|s)$/.test(er)&&R,Ar=!/^(e|w)$/.test(er)&&j,Tr=Dt.classed("extent"),Yr=Et(vt),Gr=t.mouse(vt),an=t.select(l(vt)).on("keydown.brush",jn).on("keyup.brush",ia);if(t.event.changedTouches?an.on("touchmove.brush",jr).on("touchend.brush",Un):an.on("mousemove.brush",jr).on("mouseup.brush",Un),Ft.interrupt().selectAll("*").interrupt(),Tr)Gr[0]=te[0]-Gr[0],Gr[1]=le[0]-Gr[1];else if(er){var $r=+/w$/.test(er),In=+/^n/.test(er);wt=[te[1-$r]-Gr[0],le[1-In]-Gr[1]],Gr[0]=te[$r],Gr[1]=le[In]}else t.event.altKey&&(_t=Gr.slice());function jn(){t.event.keyCode==32&&(Tr||(_t=null,Gr[0]-=te[1],Gr[1]-=le[1],Tr=2),Y())}function ia(){t.event.keyCode==32&&Tr==2&&(Gr[0]+=te[1],Gr[1]+=le[1],Tr=0,Y())}function jr(){var Fn=t.mouse(vt),Jn=!1;wt&&(Fn[0]+=wt[0],Fn[1]+=wt[1]),Tr||(t.event.altKey?(_t||(_t=[(te[0]+te[1])/2,(le[0]+le[1])/2]),Gr[0]=te[+(Fn[0]<_t[0])],Gr[1]=le[+(Fn[1]<_t[1])]):_t=null),cr&&mn(Fn,R,0)&&(et(Ft),Jn=!0),Ar&&mn(Fn,j,1)&&(yt(Ft),Jn=!0),Jn&&(He(Ft),Pt({type:"brush",mode:Tr?"move":"resize"}))}function mn(Fn,Jn,sa){var ka,qn,va=en(Jn),pa=va[0],Ea=va[1],ya=Gr[sa],La=sa?le:te,Fa=La[1]-La[0];if(Tr&&(pa-=ya,Ea-=Fa+ya),ka=(sa?ye:pe)?Math.max(pa,Math.min(Ea,Fn[sa])):Fn[sa],Tr?qn=(ka+=ya)+Fa:(_t&&(ya=Math.max(pa,Math.min(Ea,2*_t[sa]-ka))),ya<ka?(qn=ka,ka=ya):qn=ya),La[0]!=ka||La[1]!=qn)return sa?M=null:oe=null,La[0]=ka,La[1]=qn,!0}function Un(){jr(),Ft.style("pointer-events","all").selectAll(".resize").style("display",Ne.empty()?"none":null),t.select("body").style("cursor",null),an.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),Yr(),Pt({type:"brushend"})}Ft.style("pointer-events","none").selectAll(".resize").style("display",null),t.select("body").style("cursor",Dt.style("cursor")),Pt({type:"brushstart"}),jr()}return Ne.event=function(_t){_t.each(function(){var wt=O.of(this,arguments),vt={x:te,y:le,i:oe,j:M},Dt=this.__chart__||vt;this.__chart__=vt,ps?t.select(this).transition().each("start.brush",function(){oe=Dt.i,M=Dt.j,te=Dt.x,le=Dt.y,wt({type:"brushstart"})}).tween("brush:brush",function(){var Pt=ui(te,vt.x),Ft=ui(le,vt.y);return oe=M=null,function(er){te=vt.x=Pt(er),le=vt.y=Ft(er),wt({type:"brush",mode:"resize"})}}).each("end.brush",function(){oe=vt.i,M=vt.j,wt({type:"brush",mode:"resize"}),wt({type:"brushend"})}):(wt({type:"brushstart"}),wt({type:"brush",mode:"resize"}),wt({type:"brushend"}))})},Ne.x=function(_t){return arguments.length?(_e=eo[!(R=_t)<<1|!j],Ne):R},Ne.y=function(_t){return arguments.length?(_e=eo[!R<<1|!(j=_t)],Ne):j},Ne.clamp=function(_t){return arguments.length?(R&&j?(pe=!!_t[0],ye=!!_t[1]):R?pe=!!_t:j&&(ye=!!_t),Ne):R&&j?[pe,ye]:R?pe:j?ye:null},Ne.extent=function(_t){var wt,vt,Dt,Pt,Ft;return arguments.length?(R&&(wt=_t[0],vt=_t[1],j&&(wt=wt[0],vt=vt[0]),oe=[wt,vt],R.invert&&(wt=R(wt),vt=R(vt)),vt<wt&&(Ft=wt,wt=vt,vt=Ft),wt==te[0]&&vt==te[1]||(te=[wt,vt])),j&&(Dt=_t[0],Pt=_t[1],R&&(Dt=Dt[1],Pt=Pt[1]),M=[Dt,Pt],j.invert&&(Dt=j(Dt),Pt=j(Pt)),Pt<Dt&&(Ft=Dt,Dt=Pt,Pt=Ft),Dt==le[0]&&Pt==le[1]||(le=[Dt,Pt])),Ne):(R&&(oe?(wt=oe[0],vt=oe[1]):(wt=te[0],vt=te[1],R.invert&&(wt=R.invert(wt),vt=R.invert(vt)),vt<wt&&(Ft=wt,wt=vt,vt=Ft))),j&&(M?(Dt=M[0],Pt=M[1]):(Dt=le[0],Pt=le[1],j.invert&&(Dt=j.invert(Dt),Pt=j.invert(Pt)),Pt<Dt&&(Ft=Dt,Dt=Pt,Pt=Ft))),R&&j?[[wt,Dt],[vt,Pt]]:R?[wt,vt]:j&&[Dt,Pt])},Ne.clear=function(){return Ne.empty()||(te=[0,0],le=[0,0],oe=M=null),Ne},Ne.empty=function(){return!!R&&te[0]==te[1]||!!j&&le[0]==le[1]},t.rebind(Ne,O,"on")};var Ss={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},eo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function sl(oe){return JSON.parse(oe.responseText)}function ll(oe){var M=u.createRange();return M.selectNode(u.body),M.createContextualFragment(oe.responseText)}t.text=zr(function(oe){return oe.responseText}),t.json=function(oe,M){return Rr(oe,"application/json",sl,M)},t.html=function(oe,M){return Rr(oe,"text/html",ll,M)},t.xml=zr(function(oe){return oe.responseXML}),typeof B=="object"&&B.exports?B.exports=t:this.d3=t}).apply(self)},{}],59:[function(i,B,V){B.exports=i("./quad")},{"./quad":60}],60:[function(i,B,V){var t=i("binary-search-bounds"),h=i("clamp"),p=i("parse-rect"),u=i("array-bounds"),e=i("pick-by-alias"),l=i("defined"),o=i("flatten-vertex-data"),a=i("is-obj"),n=i("dtype"),s=i("math-log2");function r(c,f){for(var d=f[0],g=f[1],m=1/(f[2]-d),y=1/(f[3]-g),v=new Array(c.length),T=0,_=c.length/2;T<_;T++)v[2*T]=h((c[2*T]-d)*m,0,1),v[2*T+1]=h((c[2*T+1]-g)*y,0,1);return v}B.exports=function(c,f){f||(f={}),c=o(c,"float64"),f=e(f,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var d=l(f.maxDepth,255),g=l(f.bounds,u(c,2));g[0]===g[2]&&g[2]++,g[1]===g[3]&&g[3]++;var m,y=r(c,g),v=c.length>>>1;f.dtype||(f.dtype="array"),typeof f.dtype=="string"?m=new(n(f.dtype))(v):f.dtype&&(m=f.dtype,Array.isArray(m)&&(m.length=v));for(var T=0;T<v;++T)m[T]=T;var _=[],k=[],E=[],A=[];(function q(W,X,Q,Z,Y,N){if(!Z.length)return null;var J=_[Y]||(_[Y]=[]),D=E[Y]||(E[Y]=[]),U=k[Y]||(k[Y]=[]),G=J.length;if(++Y>d||N>1073741824){for(var $=0;$<Z.length;$++)J.push(Z[$]),D.push(N),U.push(null,null,null,null);return G}if(J.push(Z[0]),D.push(N),Z.length<=1)return U.push(null,null,null,null),G;for(var K=.5*Q,re=W+K,ne=X+K,ae=[],ie=[],he=[],se=[],de=1,ce=Z.length;de<ce;de++){var ve=Z[de],Ee=y[2*ve],Le=y[2*ve+1];Ee<re?Le<ne?ae.push(ve):ie.push(ve):Le<ne?he.push(ve):se.push(ve)}return N<<=2,U.push(q(W,X,K,ae,Y,N),q(W,ne,K,ie,Y,N+1),q(re,X,K,he,Y,N+2),q(re,ne,K,se,Y,N+3)),G})(0,0,1,m,0,1);for(var b=0,L=0;L<_.length;L++){var w=_[L];if(m.set)m.set(w,b);else for(var C=0,S=w.length;C<S;C++)m[C+b]=w[C];var P=b+_[L].length;A[L]=[b,P],b=P}return m.range=function(){for(var q,W=[],X=arguments.length;X--;)W[X]=arguments[X];if(a(W[W.length-1])){var Q=W.pop();W.length||Q.x==null&&Q.l==null&&Q.left==null||(W=[Q],q={}),q=e(Q,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else q={};W.length||(W=g);var Z=p.apply(void 0,W),Y=[Math.min(Z.x,Z.x+Z.width),Math.min(Z.y,Z.y+Z.height),Math.max(Z.x,Z.x+Z.width),Math.max(Z.y,Z.y+Z.height)],N=Y[0],J=Y[1],D=Y[2],U=Y[3],G=r([N,J,D,U],g),$=G[0],K=G[1],re=G[2],ne=G[3],ae=l(q.level,_.length);if(q.d!=null){var ie;typeof q.d=="number"?ie=[q.d,q.d]:q.d.length&&(ie=q.d),ae=Math.min(Math.max(Math.ceil(-s(Math.abs(ie[0])/(g[2]-g[0]))),Math.ceil(-s(Math.abs(ie[1])/(g[3]-g[1])))),ae)}if(ae=Math.min(ae,_.length),q.lod)return z($,K,re,ne,ae);var he=[];function se(ce,ve,Ee,Le,Te,xe){if(Te!==null&&xe!==null&&!($>ce+Ee||K>ve+Ee||re<ce||ne<ve||Le>=ae||Te===xe)){var fe=_[Le];xe===void 0&&(xe=fe.length);for(var ge=Te;ge<xe;ge++){var ke=fe[ge],Me=c[2*ke],Se=c[2*ke+1];Me>=N&&Me<=D&&Se>=J&&Se<=U&&he.push(ke)}var De=k[Le],Be=De[4*Te+0],We=De[4*Te+1],Qe=De[4*Te+2],Oe=De[4*Te+3],Ue=de(De,Te+1),Xe=.5*Ee,Ye=Le+1;se(ce,ve,Xe,Ye,Be,We||Qe||Oe||Ue),se(ce,ve+Xe,Xe,Ye,We,Qe||Oe||Ue),se(ce+Xe,ve,Xe,Ye,Qe,Oe||Ue),se(ce+Xe,ve+Xe,Xe,Ye,Oe,Ue)}}function de(ce,ve){for(var Ee=null,Le=0;Ee===null;)if(Ee=ce[4*ve+Le],++Le>ce.length)return null;return Ee}return se(0,0,1,0,0,1),he},m;function z(q,W,X,Q,Z){for(var Y=[],N=0;N<Z;N++){var J=E[N],D=A[N][0],U=F(q,W,N),G=F(X,Q,N),$=t.ge(J,U),K=t.gt(J,G,$,J.length-1);Y[N]=[$+D,K+D]}return Y}function F(q,W,X){for(var Q=1,Z=.5,Y=.5,N=.5,J=0;J<X;J++)Q<<=2,Q+=q<Z?W<Y?0:1:W<Y?2:3,N*=.5,Z+=q<Z?-N:N,Y+=W<Y?-N:N;return Q}}},{"array-bounds":76,"binary-search-bounds":103,clamp:126,defined:179,dtype:184,"flatten-vertex-data":252,"is-obj":456,"math-log2":467,"parse-rect":492,"pick-by-alias":498}],61:[function(i,B,V){Object.defineProperty(V,"__esModule",{value:!0});var t=i("@turf/meta");function h(e){var l=0;if(e&&e.length>0){l+=Math.abs(p(e[0]));for(var o=1;o<e.length;o++)l-=Math.abs(p(e[o]))}return l}function p(e){var l,o,a,n,s,r,c=0,f=e.length;if(f>2){for(r=0;r<f;r++)r===f-2?(a=f-2,n=f-1,s=0):r===f-1?(a=f-1,n=0,s=1):(a=r,n=r+1,s=r+2),l=e[a],o=e[n],c+=(u(e[s][0])-u(l[0]))*Math.sin(u(o[1]));c=6378137*c*6378137/2}return c}function u(e){return e*Math.PI/180}V.default=function(e){return t.geomReduce(e,function(l,o){return l+function(a){var n,s=0;switch(a.type){case"Polygon":return h(a.coordinates);case"MultiPolygon":for(n=0;n<a.coordinates.length;n++)s+=h(a.coordinates[n]);return s;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(o)},0)}},{"@turf/meta":63}],62:[function(i,B,V){function t(f,d,g){g===void 0&&(g={});var m={type:"Feature"};return(g.id===0||g.id)&&(m.id=g.id),g.bbox&&(m.bbox=g.bbox),m.properties=d||{},m.geometry=f,m}function h(f,d,g){if(g===void 0&&(g={}),!f)throw new Error("coordinates is required");if(!Array.isArray(f))throw new Error("coordinates must be an Array");if(f.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!c(f[0])||!c(f[1]))throw new Error("coordinates must contain numbers");return t({type:"Point",coordinates:f},d,g)}function p(f,d,g){g===void 0&&(g={});for(var m=0,y=f;m<y.length;m++){var v=y[m];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var T=0;T<v[v.length-1].length;T++)if(v[v.length-1][T]!==v[0][T])throw new Error("First and last Position are not equivalent.")}return t({type:"Polygon",coordinates:f},d,g)}function u(f,d,g){if(g===void 0&&(g={}),f.length<2)throw new Error("coordinates must be an array of two or more positions");return t({type:"LineString",coordinates:f},d,g)}function e(f,d){d===void 0&&(d={});var g={type:"FeatureCollection"};return d.id&&(g.id=d.id),d.bbox&&(g.bbox=d.bbox),g.features=f,g}function l(f,d,g){return g===void 0&&(g={}),t({type:"MultiLineString",coordinates:f},d,g)}function o(f,d,g){return g===void 0&&(g={}),t({type:"MultiPoint",coordinates:f},d,g)}function a(f,d,g){return g===void 0&&(g={}),t({type:"MultiPolygon",coordinates:f},d,g)}function n(f,d){d===void 0&&(d="kilometers");var g=V.factors[d];if(!g)throw new Error(d+" units is invalid");return f*g}function s(f,d){d===void 0&&(d="kilometers");var g=V.factors[d];if(!g)throw new Error(d+" units is invalid");return f/g}function r(f){return 180*(f%(2*Math.PI))/Math.PI}function c(f){return!isNaN(f)&&f!==null&&!Array.isArray(f)}Object.defineProperty(V,"__esModule",{value:!0}),V.earthRadius=63710088e-1,V.factors={centimeters:100*V.earthRadius,centimetres:100*V.earthRadius,degrees:V.earthRadius/111325,feet:3.28084*V.earthRadius,inches:39.37*V.earthRadius,kilometers:V.earthRadius/1e3,kilometres:V.earthRadius/1e3,meters:V.earthRadius,metres:V.earthRadius,miles:V.earthRadius/1609.344,millimeters:1e3*V.earthRadius,millimetres:1e3*V.earthRadius,nauticalmiles:V.earthRadius/1852,radians:1,yards:1.0936*V.earthRadius},V.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/V.earthRadius,yards:1.0936133},V.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},V.feature=t,V.geometry=function(f,d,g){switch(f){case"Point":return h(d).geometry;case"LineString":return u(d).geometry;case"Polygon":return p(d).geometry;case"MultiPoint":return o(d).geometry;case"MultiLineString":return l(d).geometry;case"MultiPolygon":return a(d).geometry;default:throw new Error(f+" is invalid")}},V.point=h,V.points=function(f,d,g){return g===void 0&&(g={}),e(f.map(function(m){return h(m,d)}),g)},V.polygon=p,V.polygons=function(f,d,g){return g===void 0&&(g={}),e(f.map(function(m){return p(m,d)}),g)},V.lineString=u,V.lineStrings=function(f,d,g){return g===void 0&&(g={}),e(f.map(function(m){return u(m,d)}),g)},V.featureCollection=e,V.multiLineString=l,V.multiPoint=o,V.multiPolygon=a,V.geometryCollection=function(f,d,g){return g===void 0&&(g={}),t({type:"GeometryCollection",geometries:f},d,g)},V.round=function(f,d){if(d===void 0&&(d=0),d&&!(d>=0))throw new Error("precision must be a positive number");var g=Math.pow(10,d||0);return Math.round(f*g)/g},V.radiansToLength=n,V.lengthToRadians=s,V.lengthToDegrees=function(f,d){return r(s(f,d))},V.bearingToAzimuth=function(f){var d=f%360;return d<0&&(d+=360),d},V.radiansToDegrees=r,V.degreesToRadians=function(f){return f%360*Math.PI/180},V.convertLength=function(f,d,g){if(d===void 0&&(d="kilometers"),g===void 0&&(g="kilometers"),!(f>=0))throw new Error("length must be a positive number");return n(s(f,d),g)},V.convertArea=function(f,d,g){if(d===void 0&&(d="meters"),g===void 0&&(g="kilometers"),!(f>=0))throw new Error("area must be a positive number");var m=V.areaFactors[d];if(!m)throw new Error("invalid original units");var y=V.areaFactors[g];if(!y)throw new Error("invalid final units");return f/m*y},V.isNumber=c,V.isObject=function(f){return!!f&&f.constructor===Object},V.validateBBox=function(f){if(!f)throw new Error("bbox is required");if(!Array.isArray(f))throw new Error("bbox must be an Array");if(f.length!==4&&f.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");f.forEach(function(d){if(!c(d))throw new Error("bbox must only contain numbers")})},V.validateId=function(f){if(!f)throw new Error("id is required");if(["string","number"].indexOf(typeof f)===-1)throw new Error("id must be a number or a string")}},{}],63:[function(i,B,V){Object.defineProperty(V,"__esModule",{value:!0});var t=i("@turf/helpers");function h(n,s,r){if(n!==null)for(var c,f,d,g,m,y,v,T,_=0,k=0,E=n.type,A=E==="FeatureCollection",b=E==="Feature",L=A?n.features.length:1,w=0;w<L;w++){m=(T=!!(v=A?n.features[w].geometry:b?n.geometry:n)&&v.type==="GeometryCollection")?v.geometries.length:1;for(var C=0;C<m;C++){var S=0,P=0;if((g=T?v.geometries[C]:v)!==null){y=g.coordinates;var z=g.type;switch(_=!r||z!=="Polygon"&&z!=="MultiPolygon"?0:1,z){case null:break;case"Point":if(s(y,k,w,S,P)===!1)return!1;k++,S++;break;case"LineString":case"MultiPoint":for(c=0;c<y.length;c++){if(s(y[c],k,w,S,P)===!1)return!1;k++,z==="MultiPoint"&&S++}z==="LineString"&&S++;break;case"Polygon":case"MultiLineString":for(c=0;c<y.length;c++){for(f=0;f<y[c].length-_;f++){if(s(y[c][f],k,w,S,P)===!1)return!1;k++}z==="MultiLineString"&&S++,z==="Polygon"&&P++}z==="Polygon"&&S++;break;case"MultiPolygon":for(c=0;c<y.length;c++){for(P=0,f=0;f<y[c].length;f++){for(d=0;d<y[c][f].length-_;d++){if(s(y[c][f][d],k,w,S,P)===!1)return!1;k++}P++}S++}break;case"GeometryCollection":for(c=0;c<g.geometries.length;c++)if(h(g.geometries[c],s,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function p(n,s){var r;switch(n.type){case"FeatureCollection":for(r=0;r<n.features.length&&s(n.features[r].properties,r)!==!1;r++);break;case"Feature":s(n.properties,0)}}function u(n,s){if(n.type==="Feature")s(n,0);else if(n.type==="FeatureCollection")for(var r=0;r<n.features.length&&s(n.features[r],r)!==!1;r++);}function e(n,s){var r,c,f,d,g,m,y,v,T,_,k=0,E=n.type==="FeatureCollection",A=n.type==="Feature",b=E?n.features.length:1;for(r=0;r<b;r++){for(m=E?n.features[r].geometry:A?n.geometry:n,v=E?n.features[r].properties:A?n.properties:{},T=E?n.features[r].bbox:A?n.bbox:void 0,_=E?n.features[r].id:A?n.id:void 0,g=(y=!!m&&m.type==="GeometryCollection")?m.geometries.length:1,f=0;f<g;f++)if((d=y?m.geometries[f]:m)!==null)switch(d.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(s(d,k,v,T,_)===!1)return!1;break;case"GeometryCollection":for(c=0;c<d.geometries.length;c++)if(s(d.geometries[c],k,v,T,_)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(s(null,k,v,T,_)===!1)return!1;k++}}function l(n,s){e(n,function(r,c,f,d,g){var m,y=r===null?null:r.type;switch(y){case null:case"Point":case"LineString":case"Polygon":return s(t.feature(r,f,{bbox:d,id:g}),c,0)!==!1&&void 0}switch(y){case"MultiPoint":m="Point";break;case"MultiLineString":m="LineString";break;case"MultiPolygon":m="Polygon"}for(var v=0;v<r.coordinates.length;v++){var T={type:m,coordinates:r.coordinates[v]};if(s(t.feature(T,f),c,v)===!1)return!1}})}function o(n,s){l(n,function(r,c,f){var d=0;if(r.geometry){var g=r.geometry.type;if(g!=="Point"&&g!=="MultiPoint"){var m,y=0,v=0,T=0;return h(r,function(_,k,E,A,b){if(m===void 0||c>y||A>v||b>T)return m=_,y=c,v=A,T=b,void(d=0);var L=t.lineString([m,_],r.properties);if(s(L,c,f,b,d)===!1)return!1;d++,m=_})!==!1&&void 0}}})}function a(n,s){if(!n)throw new Error("geojson is required");l(n,function(r,c,f){if(r.geometry!==null){var d=r.geometry.type,g=r.geometry.coordinates;switch(d){case"LineString":if(s(r,c,f,0,0)===!1)return!1;break;case"Polygon":for(var m=0;m<g.length;m++)if(s(t.lineString(g[m],r.properties),c,f,m)===!1)return!1}}})}V.coordEach=h,V.coordReduce=function(n,s,r,c){var f=r;return h(n,function(d,g,m,y,v){f=g===0&&r===void 0?d:s(f,d,g,m,y,v)},c),f},V.propEach=p,V.propReduce=function(n,s,r){var c=r;return p(n,function(f,d){c=d===0&&r===void 0?f:s(c,f,d)}),c},V.featureEach=u,V.featureReduce=function(n,s,r){var c=r;return u(n,function(f,d){c=d===0&&r===void 0?f:s(c,f,d)}),c},V.coordAll=function(n){var s=[];return h(n,function(r){s.push(r)}),s},V.geomEach=e,V.geomReduce=function(n,s,r){var c=r;return e(n,function(f,d,g,m,y){c=d===0&&r===void 0?f:s(c,f,d,g,m,y)}),c},V.flattenEach=l,V.flattenReduce=function(n,s,r){var c=r;return l(n,function(f,d,g){c=d===0&&g===0&&r===void 0?f:s(c,f,d,g)}),c},V.segmentEach=o,V.segmentReduce=function(n,s,r){var c=r,f=!1;return o(n,function(d,g,m,y,v){c=f===!1&&r===void 0?d:s(c,d,g,m,y,v),f=!0}),c},V.lineEach=a,V.lineReduce=function(n,s,r){var c=r;return a(n,function(f,d,g,m){c=d===0&&r===void 0?f:s(c,f,d,g,m)}),c},V.findSegment=function(n,s){if(s=s||{},!t.isObject(s))throw new Error("options is invalid");var r,c=s.featureIndex||0,f=s.multiFeatureIndex||0,d=s.geometryIndex||0,g=s.segmentIndex||0,m=s.properties;switch(n.type){case"FeatureCollection":c<0&&(c=n.features.length+c),m=m||n.features[c].properties,r=n.features[c].geometry;break;case"Feature":m=m||n.properties,r=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=n;break;default:throw new Error("geojson is invalid")}if(r===null)return null;var y=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return g<0&&(g=y.length+g-1),t.lineString([y[g],y[g+1]],m,s);case"Polygon":return d<0&&(d=y.length+d),g<0&&(g=y[d].length+g-1),t.lineString([y[d][g],y[d][g+1]],m,s);case"MultiLineString":return f<0&&(f=y.length+f),g<0&&(g=y[f].length+g-1),t.lineString([y[f][g],y[f][g+1]],m,s);case"MultiPolygon":return f<0&&(f=y.length+f),d<0&&(d=y[f].length+d),g<0&&(g=y[f][d].length-g-1),t.lineString([y[f][d][g],y[f][d][g+1]],m,s)}throw new Error("geojson is invalid")},V.findPoint=function(n,s){if(s=s||{},!t.isObject(s))throw new Error("options is invalid");var r,c=s.featureIndex||0,f=s.multiFeatureIndex||0,d=s.geometryIndex||0,g=s.coordIndex||0,m=s.properties;switch(n.type){case"FeatureCollection":c<0&&(c=n.features.length+c),m=m||n.features[c].properties,r=n.features[c].geometry;break;case"Feature":m=m||n.properties,r=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=n;break;default:throw new Error("geojson is invalid")}if(r===null)return null;var y=r.coordinates;switch(r.type){case"Point":return t.point(y,m,s);case"MultiPoint":return f<0&&(f=y.length+f),t.point(y[f],m,s);case"LineString":return g<0&&(g=y.length+g),t.point(y[g],m,s);case"Polygon":return d<0&&(d=y.length+d),g<0&&(g=y[d].length+g),t.point(y[d][g],m,s);case"MultiLineString":return f<0&&(f=y.length+f),g<0&&(g=y[f].length+g),t.point(y[f][g],m,s);case"MultiPolygon":return f<0&&(f=y.length+f),d<0&&(d=y[f].length+d),g<0&&(g=y[f][d].length-g),t.point(y[f][d][g],m,s)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(i,B,V){Object.defineProperty(V,"__esModule",{value:!0});var t=i("@turf/meta");function h(p){var u=[1/0,1/0,-1/0,-1/0];return t.coordEach(p,function(e){u[0]>e[0]&&(u[0]=e[0]),u[1]>e[1]&&(u[1]=e[1]),u[2]<e[0]&&(u[2]=e[0]),u[3]<e[1]&&(u[3]=e[1])}),u}h.default=h,V.default=h},{"@turf/meta":66}],65:[function(i,B,V){arguments[4][62][0].apply(V,arguments)},{dup:62}],66:[function(i,B,V){arguments[4][63][0].apply(V,arguments)},{"@turf/helpers":65,dup:63}],67:[function(i,B,V){Object.defineProperty(V,"__esModule",{value:!0});var t=i("@turf/meta"),h=i("@turf/helpers");V.default=function(p,u){u===void 0&&(u={});var e=0,l=0,o=0;return t.coordEach(p,function(a){e+=a[0],l+=a[1],o++}),h.point([e/o,l/o],u.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(i,B,V){function t(f,d,g){g===void 0&&(g={});var m={type:"Feature"};return(g.id===0||g.id)&&(m.id=g.id),g.bbox&&(m.bbox=g.bbox),m.properties=d||{},m.geometry=f,m}function h(f,d,g){return g===void 0&&(g={}),t({type:"Point",coordinates:f},d,g)}function p(f,d,g){g===void 0&&(g={});for(var m=0,y=f;m<y.length;m++){var v=y[m];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var T=0;T<v[v.length-1].length;T++)if(v[v.length-1][T]!==v[0][T])throw new Error("First and last Position are not equivalent.")}return t({type:"Polygon",coordinates:f},d,g)}function u(f,d,g){if(g===void 0&&(g={}),f.length<2)throw new Error("coordinates must be an array of two or more positions");return t({type:"LineString",coordinates:f},d,g)}function e(f,d){d===void 0&&(d={});var g={type:"FeatureCollection"};return d.id&&(g.id=d.id),d.bbox&&(g.bbox=d.bbox),g.features=f,g}function l(f,d,g){return g===void 0&&(g={}),t({type:"MultiLineString",coordinates:f},d,g)}function o(f,d,g){return g===void 0&&(g={}),t({type:"MultiPoint",coordinates:f},d,g)}function a(f,d,g){return g===void 0&&(g={}),t({type:"MultiPolygon",coordinates:f},d,g)}function n(f,d){d===void 0&&(d="kilometers");var g=V.factors[d];if(!g)throw new Error(d+" units is invalid");return f*g}function s(f,d){d===void 0&&(d="kilometers");var g=V.factors[d];if(!g)throw new Error(d+" units is invalid");return f/g}function r(f){return 180*(f%(2*Math.PI))/Math.PI}function c(f){return!isNaN(f)&&f!==null&&!Array.isArray(f)&&!/^\s*$/.test(f)}Object.defineProperty(V,"__esModule",{value:!0}),V.earthRadius=63710088e-1,V.factors={centimeters:100*V.earthRadius,centimetres:100*V.earthRadius,degrees:V.earthRadius/111325,feet:3.28084*V.earthRadius,inches:39.37*V.earthRadius,kilometers:V.earthRadius/1e3,kilometres:V.earthRadius/1e3,meters:V.earthRadius,metres:V.earthRadius,miles:V.earthRadius/1609.344,millimeters:1e3*V.earthRadius,millimetres:1e3*V.earthRadius,nauticalmiles:V.earthRadius/1852,radians:1,yards:V.earthRadius/1.0936},V.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/V.earthRadius,yards:1/1.0936},V.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},V.feature=t,V.geometry=function(f,d,g){switch(f){case"Point":return h(d).geometry;case"LineString":return u(d).geometry;case"Polygon":return p(d).geometry;case"MultiPoint":return o(d).geometry;case"MultiLineString":return l(d).geometry;case"MultiPolygon":return a(d).geometry;default:throw new Error(f+" is invalid")}},V.point=h,V.points=function(f,d,g){return g===void 0&&(g={}),e(f.map(function(m){return h(m,d)}),g)},V.polygon=p,V.polygons=function(f,d,g){return g===void 0&&(g={}),e(f.map(function(m){return p(m,d)}),g)},V.lineString=u,V.lineStrings=function(f,d,g){return g===void 0&&(g={}),e(f.map(function(m){return u(m,d)}),g)},V.featureCollection=e,V.multiLineString=l,V.multiPoint=o,V.multiPolygon=a,V.geometryCollection=function(f,d,g){return g===void 0&&(g={}),t({type:"GeometryCollection",geometries:f},d,g)},V.round=function(f,d){if(d===void 0&&(d=0),d&&!(d>=0))throw new Error("precision must be a positive number");var g=Math.pow(10,d||0);return Math.round(f*g)/g},V.radiansToLength=n,V.lengthToRadians=s,V.lengthToDegrees=function(f,d){return r(s(f,d))},V.bearingToAzimuth=function(f){var d=f%360;return d<0&&(d+=360),d},V.radiansToDegrees=r,V.degreesToRadians=function(f){return f%360*Math.PI/180},V.convertLength=function(f,d,g){if(d===void 0&&(d="kilometers"),g===void 0&&(g="kilometers"),!(f>=0))throw new Error("length must be a positive number");return n(s(f,d),g)},V.convertArea=function(f,d,g){if(d===void 0&&(d="meters"),g===void 0&&(g="kilometers"),!(f>=0))throw new Error("area must be a positive number");var m=V.areaFactors[d];if(!m)throw new Error("invalid original units");var y=V.areaFactors[g];if(!y)throw new Error("invalid final units");return f/m*y},V.isNumber=c,V.isObject=function(f){return!!f&&f.constructor===Object},V.validateBBox=function(f){if(!f)throw new Error("bbox is required");if(!Array.isArray(f))throw new Error("bbox must be an Array");if(f.length!==4&&f.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");f.forEach(function(d){if(!c(d))throw new Error("bbox must only contain numbers")})},V.validateId=function(f){if(!f)throw new Error("id is required");if(["string","number"].indexOf(typeof f)===-1)throw new Error("id must be a number or a string")},V.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},V.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},V.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},V.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},V.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},V.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},V.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(i,B,V){Object.defineProperty(V,"__esModule",{value:!0});var t=i("@turf/helpers");function h(n,s,r){if(n!==null)for(var c,f,d,g,m,y,v,T,_=0,k=0,E=n.type,A=E==="FeatureCollection",b=E==="Feature",L=A?n.features.length:1,w=0;w<L;w++){m=(T=!!(v=A?n.features[w].geometry:b?n.geometry:n)&&v.type==="GeometryCollection")?v.geometries.length:1;for(var C=0;C<m;C++){var S=0,P=0;if((g=T?v.geometries[C]:v)!==null){y=g.coordinates;var z=g.type;switch(_=!r||z!=="Polygon"&&z!=="MultiPolygon"?0:1,z){case null:break;case"Point":if(s(y,k,w,S,P)===!1)return!1;k++,S++;break;case"LineString":case"MultiPoint":for(c=0;c<y.length;c++){if(s(y[c],k,w,S,P)===!1)return!1;k++,z==="MultiPoint"&&S++}z==="LineString"&&S++;break;case"Polygon":case"MultiLineString":for(c=0;c<y.length;c++){for(f=0;f<y[c].length-_;f++){if(s(y[c][f],k,w,S,P)===!1)return!1;k++}z==="MultiLineString"&&S++,z==="Polygon"&&P++}z==="Polygon"&&S++;break;case"MultiPolygon":for(c=0;c<y.length;c++){for(P=0,f=0;f<y[c].length;f++){for(d=0;d<y[c][f].length-_;d++){if(s(y[c][f][d],k,w,S,P)===!1)return!1;k++}P++}S++}break;case"GeometryCollection":for(c=0;c<g.geometries.length;c++)if(h(g.geometries[c],s,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function p(n,s){var r;switch(n.type){case"FeatureCollection":for(r=0;r<n.features.length&&s(n.features[r].properties,r)!==!1;r++);break;case"Feature":s(n.properties,0)}}function u(n,s){if(n.type==="Feature")s(n,0);else if(n.type==="FeatureCollection")for(var r=0;r<n.features.length&&s(n.features[r],r)!==!1;r++);}function e(n,s){var r,c,f,d,g,m,y,v,T,_,k=0,E=n.type==="FeatureCollection",A=n.type==="Feature",b=E?n.features.length:1;for(r=0;r<b;r++){for(m=E?n.features[r].geometry:A?n.geometry:n,v=E?n.features[r].properties:A?n.properties:{},T=E?n.features[r].bbox:A?n.bbox:void 0,_=E?n.features[r].id:A?n.id:void 0,g=(y=!!m&&m.type==="GeometryCollection")?m.geometries.length:1,f=0;f<g;f++)if((d=y?m.geometries[f]:m)!==null)switch(d.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(s(d,k,v,T,_)===!1)return!1;break;case"GeometryCollection":for(c=0;c<d.geometries.length;c++)if(s(d.geometries[c],k,v,T,_)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(s(null,k,v,T,_)===!1)return!1;k++}}function l(n,s){e(n,function(r,c,f,d,g){var m,y=r===null?null:r.type;switch(y){case null:case"Point":case"LineString":case"Polygon":return s(t.feature(r,f,{bbox:d,id:g}),c,0)!==!1&&void 0}switch(y){case"MultiPoint":m="Point";break;case"MultiLineString":m="LineString";break;case"MultiPolygon":m="Polygon"}for(var v=0;v<r.coordinates.length;v++){var T={type:m,coordinates:r.coordinates[v]};if(s(t.feature(T,f),c,v)===!1)return!1}})}function o(n,s){l(n,function(r,c,f){var d=0;if(r.geometry){var g=r.geometry.type;if(g!=="Point"&&g!=="MultiPoint"){var m,y=0,v=0,T=0;return h(r,function(_,k,E,A,b){if(m===void 0||c>y||A>v||b>T)return m=_,y=c,v=A,T=b,void(d=0);var L=t.lineString([m,_],r.properties);if(s(L,c,f,b,d)===!1)return!1;d++,m=_})!==!1&&void 0}}})}function a(n,s){if(!n)throw new Error("geojson is required");l(n,function(r,c,f){if(r.geometry!==null){var d=r.geometry.type,g=r.geometry.coordinates;switch(d){case"LineString":if(s(r,c,f,0,0)===!1)return!1;break;case"Polygon":for(var m=0;m<g.length;m++)if(s(t.lineString(g[m],r.properties),c,f,m)===!1)return!1}}})}V.coordEach=h,V.coordReduce=function(n,s,r,c){var f=r;return h(n,function(d,g,m,y,v){f=g===0&&r===void 0?d:s(f,d,g,m,y,v)},c),f},V.propEach=p,V.propReduce=function(n,s,r){var c=r;return p(n,function(f,d){c=d===0&&r===void 0?f:s(c,f,d)}),c},V.featureEach=u,V.featureReduce=function(n,s,r){var c=r;return u(n,function(f,d){c=d===0&&r===void 0?f:s(c,f,d)}),c},V.coordAll=function(n){var s=[];return h(n,function(r){s.push(r)}),s},V.geomEach=e,V.geomReduce=function(n,s,r){var c=r;return e(n,function(f,d,g,m,y){c=d===0&&r===void 0?f:s(c,f,d,g,m,y)}),c},V.flattenEach=l,V.flattenReduce=function(n,s,r){var c=r;return l(n,function(f,d,g){c=d===0&&g===0&&r===void 0?f:s(c,f,d,g)}),c},V.segmentEach=o,V.segmentReduce=function(n,s,r){var c=r,f=!1;return o(n,function(d,g,m,y,v){c=f===!1&&r===void 0?d:s(c,d,g,m,y,v),f=!0}),c},V.lineEach=a,V.lineReduce=function(n,s,r){var c=r;return a(n,function(f,d,g,m){c=d===0&&r===void 0?f:s(c,f,d,g,m)}),c},V.findSegment=function(n,s){if(s=s||{},!t.isObject(s))throw new Error("options is invalid");var r,c=s.featureIndex||0,f=s.multiFeatureIndex||0,d=s.geometryIndex||0,g=s.segmentIndex||0,m=s.properties;switch(n.type){case"FeatureCollection":c<0&&(c=n.features.length+c),m=m||n.features[c].properties,r=n.features[c].geometry;break;case"Feature":m=m||n.properties,r=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=n;break;default:throw new Error("geojson is invalid")}if(r===null)return null;var y=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return g<0&&(g=y.length+g-1),t.lineString([y[g],y[g+1]],m,s);case"Polygon":return d<0&&(d=y.length+d),g<0&&(g=y[d].length+g-1),t.lineString([y[d][g],y[d][g+1]],m,s);case"MultiLineString":return f<0&&(f=y.length+f),g<0&&(g=y[f].length+g-1),t.lineString([y[f][g],y[f][g+1]],m,s);case"MultiPolygon":return f<0&&(f=y.length+f),d<0&&(d=y[f].length+d),g<0&&(g=y[f][d].length-g-1),t.lineString([y[f][d][g],y[f][d][g+1]],m,s)}throw new Error("geojson is invalid")},V.findPoint=function(n,s){if(s=s||{},!t.isObject(s))throw new Error("options is invalid");var r,c=s.featureIndex||0,f=s.multiFeatureIndex||0,d=s.geometryIndex||0,g=s.coordIndex||0,m=s.properties;switch(n.type){case"FeatureCollection":c<0&&(c=n.features.length+c),m=m||n.features[c].properties,r=n.features[c].geometry;break;case"Feature":m=m||n.properties,r=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=n;break;default:throw new Error("geojson is invalid")}if(r===null)return null;var y=r.coordinates;switch(r.type){case"Point":return t.point(y,m,s);case"MultiPoint":return f<0&&(f=y.length+f),t.point(y[f],m,s);case"LineString":return g<0&&(g=y.length+g),t.point(y[g],m,s);case"Polygon":return d<0&&(d=y.length+d),g<0&&(g=y[d].length+g),t.point(y[d][g],m,s);case"MultiLineString":return f<0&&(f=y.length+f),g<0&&(g=y[f].length+g),t.point(y[f][g],m,s);case"MultiPolygon":return f<0&&(f=y.length+f),d<0&&(d=y[f].length+d),g<0&&(g=y[f][d].length-g),t.point(y[f][d][g],m,s)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(i,B,V){var t=typeof WeakMap>"u"?i("weak-map"):WeakMap,h=i("gl-buffer"),p=i("gl-vao"),u=new t;B.exports=function(e){var l=u.get(e),o=l&&(l._triangleBuffer.handle||l._triangleBuffer.buffer);if(!o||!e.isBuffer(o)){var a=h(e,new Float32Array([-1,-1,-1,4,4,-1]));(l=p(e,[{buffer:a,type:e.FLOAT,size:2}]))._triangleBuffer=a,u.set(e,l)}l.bind(),e.drawArrays(e.TRIANGLES,0,3),l.unbind()}},{"gl-buffer":267,"gl-vao":361,"weak-map":625}],71:[function(i,B,V){B.exports=function(t){var h=0,p=0,u=0,e=0;return t.map(function(l){var o=(l=l.slice())[0],a=o.toUpperCase();if(o!=a)switch(l[0]=a,o){case"a":l[6]+=u,l[7]+=e;break;case"v":l[1]+=e;break;case"h":l[1]+=u;break;default:for(var n=1;n<l.length;)l[n++]+=u,l[n++]+=e}switch(a){case"Z":u=h,e=p;break;case"H":u=l[1];break;case"V":e=l[1];break;case"M":u=h=l[1],e=p=l[2];break;default:u=l[l.length-2],e=l[l.length-1]}return l})}},{}],72:[function(i,B,V){var t=i("pad-left");B.exports=function(h,p,u){p=typeof p=="number"?p:1,u=u||": ";var e=h.split(/\r?\n/),l=String(e.length+p-1).length;return e.map(function(o,a){var n=a+p,s=String(n).length;return t(n,l-s)+u+o}).join(`
`)}},{"pad-left":490}],73:[function(i,B,V){B.exports=function(p){var u=p.length;if(u===0)return[];if(u===1)return[0];for(var e=p[0].length,l=[p[0]],o=[0],a=1;a<u;++a)if(l.push(p[a]),h(l,e)){if(o.push(a),o.length===e+1)return o}else l.pop();return o};var t=i("robust-orientation");function h(p,u){for(var e=new Array(u+1),l=0;l<p.length;++l)e[l]=p[l];for(l=0;l<=p.length;++l){for(var o=p.length;o<=u;++o){for(var a=new Array(u),n=0;n<u;++n)a[n]=Math.pow(o+1-l,n);e[o]=a}if(t.apply(void 0,e))return!0}return!1}},{"robust-orientation":548}],74:[function(i,B,V){B.exports=function(p,u){return t(u).filter(function(e){for(var l=new Array(e.length),o=0;o<e.length;++o)l[o]=u[e[o]];return h(l)*p<1})};var t=i("delaunay-triangulate"),h=i("circumradius")},{circumradius:125,"delaunay-triangulate":180}],75:[function(i,B,V){B.exports=function(p,u){return h(t(p,u))};var t=i("alpha-complex"),h=i("simplicial-complex-boundary")},{"alpha-complex":74,"simplicial-complex-boundary":556}],76:[function(i,B,V){B.exports=function(t,h){if(!t||t.length==null)throw Error("Argument should be an array");h=h==null?1:Math.floor(h);for(var p=Array(2*h),u=0;u<h;u++){for(var e=-1/0,l=1/0,o=u,a=t.length;o<a;o+=h)t[o]>e&&(e=t[o]),t[o]<l&&(l=t[o]);p[u]=l,p[h+u]=e}return p}},{}],77:[function(i,B,V){B.exports=function(t,h,p){if(typeof Array.prototype.findIndex=="function")return t.findIndex(h,p);if(typeof h!="function")throw new TypeError("predicate must be a function");var u=Object(t),e=u.length;if(e===0)return-1;for(var l=0;l<e;l++)if(h.call(p,u[l],l,u))return l;return-1}},{}],78:[function(i,B,V){var t=i("array-bounds");B.exports=function(h,p,u){if(!h||h.length==null)throw Error("Argument should be an array");p==null&&(p=1),u==null&&(u=t(h,p));for(var e=0;e<p;e++){var l=u[p+e],o=u[e],a=e,n=h.length;if(l===1/0&&o===-1/0)for(a=e;a<n;a+=p)h[a]=h[a]===l?1:h[a]===o?0:.5;else if(l===1/0)for(a=e;a<n;a+=p)h[a]=h[a]===l?1:0;else if(o===-1/0)for(a=e;a<n;a+=p)h[a]=h[a]===o?0:1;else{var s=l-o;for(a=e;a<n;a+=p)isNaN(h[a])||(h[a]=s===0?.5:(h[a]-o)/s)}}return h}},{"array-bounds":76}],79:[function(i,B,V){B.exports=function(t,h){var p=typeof t=="number",u=typeof h=="number";p&&!u?(h=t,t=0):p||u||(t=0,h=0);var e=(h|=0)-(t|=0);if(e<0)throw new Error("array length must be positive");for(var l=new Array(e),o=0,a=t;o<e;o++,a++)l[o]=a;return l}},{}],80:[function(i,B,V){(function(t){(function(){var h=i("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function p(A,b){if(A===b)return 0;for(var L=A.length,w=b.length,C=0,S=Math.min(L,w);C<S;++C)if(A[C]!==b[C]){L=A[C],w=b[C];break}return L<w?-1:w<L?1:0}function u(A){return t.Buffer&&typeof t.Buffer.isBuffer=="function"?t.Buffer.isBuffer(A):!(A==null||!A._isBuffer)}var e=i("util/"),l=Object.prototype.hasOwnProperty,o=Array.prototype.slice,a=(function(){}).name==="foo";function n(A){return Object.prototype.toString.call(A)}function s(A){return!u(A)&&typeof t.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(A):!!A&&(A instanceof DataView||!!(A.buffer&&A.buffer instanceof ArrayBuffer)))}var r=B.exports=y,c=/\s*function\s+([^\(\s]*)\s*/;function f(A){if(e.isFunction(A)){if(a)return A.name;var b=A.toString().match(c);return b&&b[1]}}function d(A,b){return typeof A=="string"?A.length<b?A:A.slice(0,b):A}function g(A){if(a||!e.isFunction(A))return e.inspect(A);var b=f(A);return"[Function"+(b?": "+b:"")+"]"}function m(A,b,L,w,C){throw new r.AssertionError({message:L,actual:A,expected:b,operator:w,stackStartFunction:C})}function y(A,b){A||m(A,!0,b,"==",r.ok)}function v(A,b,L,w){if(A===b)return!0;if(u(A)&&u(b))return p(A,b)===0;if(e.isDate(A)&&e.isDate(b))return A.getTime()===b.getTime();if(e.isRegExp(A)&&e.isRegExp(b))return A.source===b.source&&A.global===b.global&&A.multiline===b.multiline&&A.lastIndex===b.lastIndex&&A.ignoreCase===b.ignoreCase;if(A!==null&&typeof A=="object"||b!==null&&typeof b=="object"){if(s(A)&&s(b)&&n(A)===n(b)&&!(A instanceof Float32Array||A instanceof Float64Array))return p(new Uint8Array(A.buffer),new Uint8Array(b.buffer))===0;if(u(A)!==u(b))return!1;var C=(w=w||{actual:[],expected:[]}).actual.indexOf(A);return C!==-1&&C===w.expected.indexOf(b)||(w.actual.push(A),w.expected.push(b),function(S,P,z,F){if(S==null||P==null)return!1;if(e.isPrimitive(S)||e.isPrimitive(P))return S===P;if(z&&Object.getPrototypeOf(S)!==Object.getPrototypeOf(P))return!1;var q=T(S),W=T(P);if(q&&!W||!q&&W)return!1;if(q)return S=o.call(S),P=o.call(P),v(S,P,z);var X,Q,Z=E(S),Y=E(P);if(Z.length!==Y.length)return!1;for(Z.sort(),Y.sort(),Q=Z.length-1;Q>=0;Q--)if(Z[Q]!==Y[Q])return!1;for(Q=Z.length-1;Q>=0;Q--)if(X=Z[Q],!v(S[X],P[X],z,F))return!1;return!0}(A,b,L,w))}return L?A===b:A==b}function T(A){return Object.prototype.toString.call(A)=="[object Arguments]"}function _(A,b){if(!A||!b)return!1;if(Object.prototype.toString.call(b)=="[object RegExp]")return b.test(A);try{if(A instanceof b)return!0}catch{}return!Error.isPrototypeOf(b)&&b.call({},A)===!0}function k(A,b,L,w){var C;if(typeof b!="function")throw new TypeError('"block" argument must be a function');typeof L=="string"&&(w=L,L=null),C=function(z){var F;try{z()}catch(q){F=q}return F}(b),w=(L&&L.name?" ("+L.name+").":".")+(w?" "+w:"."),A&&!C&&m(C,L,"Missing expected exception"+w);var S=typeof w=="string",P=!A&&C&&!L;if((!A&&e.isError(C)&&S&&_(C,L)||P)&&m(C,L,"Got unwanted exception"+w),A&&C&&L&&!_(C,L)||!A&&C)throw C}r.AssertionError=function(A){this.name="AssertionError",this.actual=A.actual,this.expected=A.expected,this.operator=A.operator,A.message?(this.message=A.message,this.generatedMessage=!1):(this.message=function(z){return d(g(z.actual),128)+" "+z.operator+" "+d(g(z.expected),128)}(this),this.generatedMessage=!0);var b=A.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,b);else{var L=new Error;if(L.stack){var w=L.stack,C=f(b),S=w.indexOf(`
`+C);if(S>=0){var P=w.indexOf(`
`,S+1);w=w.substring(P+1)}this.stack=w}}},e.inherits(r.AssertionError,Error),r.fail=m,r.ok=y,r.equal=function(A,b,L){A!=b&&m(A,b,L,"==",r.equal)},r.notEqual=function(A,b,L){A==b&&m(A,b,L,"!=",r.notEqual)},r.deepEqual=function(A,b,L){v(A,b,!1)||m(A,b,L,"deepEqual",r.deepEqual)},r.deepStrictEqual=function(A,b,L){v(A,b,!0)||m(A,b,L,"deepStrictEqual",r.deepStrictEqual)},r.notDeepEqual=function(A,b,L){v(A,b,!1)&&m(A,b,L,"notDeepEqual",r.notDeepEqual)},r.notDeepStrictEqual=function A(b,L,w){v(b,L,!0)&&m(b,L,w,"notDeepStrictEqual",A)},r.strictEqual=function(A,b,L){A!==b&&m(A,b,L,"===",r.strictEqual)},r.notStrictEqual=function(A,b,L){A===b&&m(A,b,L,"!==",r.notStrictEqual)},r.throws=function(A,b,L){k(!0,A,b,L)},r.doesNotThrow=function(A,b,L){k(!1,A,b,L)},r.ifError=function(A){if(A)throw A},r.strict=h(function A(b,L){b||m(b,!0,L,"==",A)},r,{equal:r.strictEqual,deepEqual:r.deepStrictEqual,notEqual:r.notStrictEqual,notDeepEqual:r.notDeepStrictEqual}),r.strict.strict=r.strict;var E=Object.keys||function(A){var b=[];for(var L in A)l.call(A,L)&&b.push(L);return b}}).call(this)}).call(this,typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":487,"util/":83}],81:[function(i,B,V){typeof Object.create=="function"?B.exports=function(t,h){t.super_=h,t.prototype=Object.create(h.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:B.exports=function(t,h){t.super_=h;var p=function(){};p.prototype=h.prototype,t.prototype=new p,t.prototype.constructor=t}},{}],82:[function(i,B,V){B.exports=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}},{}],83:[function(i,B,V){(function(t,h){(function(){var p=/%[sdj%]/g;V.format=function(S){if(!m(S)){for(var P=[],z=0;z<arguments.length;z++)P.push(l(arguments[z]));return P.join(" ")}z=1;for(var F=arguments,q=F.length,W=String(S).replace(p,function(Q){if(Q==="%%")return"%";if(z>=q)return Q;switch(Q){case"%s":return String(F[z++]);case"%d":return Number(F[z++]);case"%j":try{return JSON.stringify(F[z++])}catch{return"[Circular]"}default:return Q}}),X=F[z];z<q;X=F[++z])d(X)||!T(X)?W+=" "+X:W+=" "+l(X);return W},V.deprecate=function(S,P){if(y(h.process))return function(){return V.deprecate(S,P).apply(this,arguments)};if(t.noDeprecation===!0)return S;var z=!1;return function(){if(!z){if(t.throwDeprecation)throw new Error(P);t.traceDeprecation?console.trace(P):console.error(P),z=!0}return S.apply(this,arguments)}};var u,e={};function l(S,P){var z={seen:[],stylize:a};return arguments.length>=3&&(z.depth=arguments[2]),arguments.length>=4&&(z.colors=arguments[3]),f(P)?z.showHidden=P:P&&V._extend(z,P),y(z.showHidden)&&(z.showHidden=!1),y(z.depth)&&(z.depth=2),y(z.colors)&&(z.colors=!1),y(z.customInspect)&&(z.customInspect=!0),z.colors&&(z.stylize=o),n(z,S,z.depth)}function o(S,P){var z=l.styles[P];return z?"\x1B["+l.colors[z][0]+"m"+S+"\x1B["+l.colors[z][1]+"m":S}function a(S,P){return S}function n(S,P,z){if(S.customInspect&&P&&E(P.inspect)&&P.inspect!==V.inspect&&(!P.constructor||P.constructor.prototype!==P)){var F=P.inspect(z,S);return m(F)||(F=n(S,F,z)),F}var q=function(D,U){if(y(U))return D.stylize("undefined","undefined");if(m(U)){var G="'"+JSON.stringify(U).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return D.stylize(G,"string")}if(g(U))return D.stylize(""+U,"number");if(f(U))return D.stylize(""+U,"boolean");if(d(U))return D.stylize("null","null")}(S,P);if(q)return q;var W=Object.keys(P),X=function(D){var U={};return D.forEach(function(G,$){U[G]=!0}),U}(W);if(S.showHidden&&(W=Object.getOwnPropertyNames(P)),k(P)&&(W.indexOf("message")>=0||W.indexOf("description")>=0))return s(P);if(W.length===0){if(E(P)){var Q=P.name?": "+P.name:"";return S.stylize("[Function"+Q+"]","special")}if(v(P))return S.stylize(RegExp.prototype.toString.call(P),"regexp");if(_(P))return S.stylize(Date.prototype.toString.call(P),"date");if(k(P))return s(P)}var Z,Y="",N=!1,J=["{","}"];return c(P)&&(N=!0,J=["[","]"]),E(P)&&(Y=" [Function"+(P.name?": "+P.name:"")+"]"),v(P)&&(Y=" "+RegExp.prototype.toString.call(P)),_(P)&&(Y=" "+Date.prototype.toUTCString.call(P)),k(P)&&(Y=" "+s(P)),W.length!==0||N&&P.length!=0?z<0?v(P)?S.stylize(RegExp.prototype.toString.call(P),"regexp"):S.stylize("[Object]","special"):(S.seen.push(P),Z=N?function(D,U,G,$,K){for(var re=[],ne=0,ae=U.length;ne<ae;++ne)C(U,String(ne))?re.push(r(D,U,G,$,String(ne),!0)):re.push("");return K.forEach(function(ie){ie.match(/^\d+$/)||re.push(r(D,U,G,$,ie,!0))}),re}(S,P,z,X,W):W.map(function(D){return r(S,P,z,X,D,N)}),S.seen.pop(),function(D,U,G){return D.reduce(function($,K){return K.indexOf(`
`)>=0,$+K.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?G[0]+(U===""?"":U+`
 `)+" "+D.join(`,
  `)+" "+G[1]:G[0]+U+" "+D.join(", ")+" "+G[1]}(Z,Y,J)):J[0]+Y+J[1]}function s(S){return"["+Error.prototype.toString.call(S)+"]"}function r(S,P,z,F,q,W){var X,Q,Z;if((Z=Object.getOwnPropertyDescriptor(P,q)||{value:P[q]}).get?Q=Z.set?S.stylize("[Getter/Setter]","special"):S.stylize("[Getter]","special"):Z.set&&(Q=S.stylize("[Setter]","special")),C(F,q)||(X="["+q+"]"),Q||(S.seen.indexOf(Z.value)<0?(Q=d(z)?n(S,Z.value,null):n(S,Z.value,z-1)).indexOf(`
`)>-1&&(Q=W?Q.split(`
`).map(function(Y){return"  "+Y}).join(`
`).substr(2):`
`+Q.split(`
`).map(function(Y){return"   "+Y}).join(`
`)):Q=S.stylize("[Circular]","special")),y(X)){if(W&&q.match(/^\d+$/))return Q;(X=JSON.stringify(""+q)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(X=X.substr(1,X.length-2),X=S.stylize(X,"name")):(X=X.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),X=S.stylize(X,"string"))}return X+": "+Q}function c(S){return Array.isArray(S)}function f(S){return typeof S=="boolean"}function d(S){return S===null}function g(S){return typeof S=="number"}function m(S){return typeof S=="string"}function y(S){return S===void 0}function v(S){return T(S)&&A(S)==="[object RegExp]"}function T(S){return typeof S=="object"&&S!==null}function _(S){return T(S)&&A(S)==="[object Date]"}function k(S){return T(S)&&(A(S)==="[object Error]"||S instanceof Error)}function E(S){return typeof S=="function"}function A(S){return Object.prototype.toString.call(S)}function b(S){return S<10?"0"+S.toString(10):S.toString(10)}V.debuglog=function(S){if(y(u)&&(u=t.env.NODE_DEBUG||""),S=S.toUpperCase(),!e[S])if(new RegExp("\\b"+S+"\\b","i").test(u)){var P=t.pid;e[S]=function(){var z=V.format.apply(V,arguments);console.error("%s %d: %s",S,P,z)}}else e[S]=function(){};return e[S]},V.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},V.isArray=c,V.isBoolean=f,V.isNull=d,V.isNullOrUndefined=function(S){return S==null},V.isNumber=g,V.isString=m,V.isSymbol=function(S){return typeof S=="symbol"},V.isUndefined=y,V.isRegExp=v,V.isObject=T,V.isDate=_,V.isError=k,V.isFunction=E,V.isPrimitive=function(S){return S===null||typeof S=="boolean"||typeof S=="number"||typeof S=="string"||typeof S=="symbol"||S===void 0},V.isBuffer=i("./support/isBuffer");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function w(){var S=new Date,P=[b(S.getHours()),b(S.getMinutes()),b(S.getSeconds())].join(":");return[S.getDate(),L[S.getMonth()],P].join(" ")}function C(S,P){return Object.prototype.hasOwnProperty.call(S,P)}V.log=function(){console.log("%s - %s",w(),V.format.apply(V,arguments))},V.inherits=i("inherits"),V._extend=function(S,P){if(!P||!T(P))return S;for(var z=Object.keys(P),F=z.length;F--;)S[z[F]]=P[z[F]];return S}}).call(this)}).call(this,i("_process"),typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":82,_process:528,inherits:81}],84:[function(i,B,V){B.exports=function(t){return atob(t)}},{}],85:[function(i,B,V){B.exports=function(p,u){for(var e=u.length,l=new Array(e+1),o=0;o<e;++o){for(var a=new Array(e+1),n=0;n<=e;++n)a[n]=p[n][o];l[o]=a}for(l[e]=new Array(e+1),o=0;o<=e;++o)l[e][o]=1;var s=new Array(e+1);for(o=0;o<e;++o)s[o]=u[o];s[e]=1;var r=t(l,s),c=h(r[e+1]);c===0&&(c=1);var f=new Array(e+1);for(o=0;o<=e;++o)f[o]=h(r[o])/c;return f};var t=i("robust-linear-solve");function h(p){for(var u=0,e=0;e<p.length;++e)u+=p[e];return u}},{"robust-linear-solve":547}],86:[function(i,B,V){V.byteLength=function(n){var s=o(n),r=s[0],c=s[1];return 3*(r+c)/4-c},V.toByteArray=function(n){var s,r,c=o(n),f=c[0],d=c[1],g=new p(function(v,T,_){return 3*(T+_)/4-_}(0,f,d)),m=0,y=d>0?f-4:f;for(r=0;r<y;r+=4)s=h[n.charCodeAt(r)]<<18|h[n.charCodeAt(r+1)]<<12|h[n.charCodeAt(r+2)]<<6|h[n.charCodeAt(r+3)],g[m++]=s>>16&255,g[m++]=s>>8&255,g[m++]=255&s;return d===2&&(s=h[n.charCodeAt(r)]<<2|h[n.charCodeAt(r+1)]>>4,g[m++]=255&s),d===1&&(s=h[n.charCodeAt(r)]<<10|h[n.charCodeAt(r+1)]<<4|h[n.charCodeAt(r+2)]>>2,g[m++]=s>>8&255,g[m++]=255&s),g},V.fromByteArray=function(n){for(var s,r=n.length,c=r%3,f=[],d=0,g=r-c;d<g;d+=16383)f.push(a(n,d,d+16383>g?g:d+16383));return c===1?(s=n[r-1],f.push(t[s>>2]+t[s<<4&63]+"==")):c===2&&(s=(n[r-2]<<8)+n[r-1],f.push(t[s>>10]+t[s>>4&63]+t[s<<2&63]+"=")),f.join("")};for(var t=[],h=[],p=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,l=u.length;e<l;++e)t[e]=u[e],h[u.charCodeAt(e)]=e;function o(n){var s=n.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=n.indexOf("=");return r===-1&&(r=s),[r,r===s?0:4-r%4]}function a(n,s,r){for(var c,f,d=[],g=s;g<r;g+=3)c=(n[g]<<16&16711680)+(n[g+1]<<8&65280)+(255&n[g+2]),d.push(t[(f=c)>>18&63]+t[f>>12&63]+t[f>>6&63]+t[63&f]);return d.join("")}h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63},{}],87:[function(i,B,V){var t=i("./lib/rationalize");B.exports=function(h,p){return t(h[0].mul(p[1]).add(p[0].mul(h[1])),h[1].mul(p[1]))}},{"./lib/rationalize":97}],88:[function(i,B,V){B.exports=function(t,h){return t[0].mul(h[1]).cmp(h[0].mul(t[1]))}},{}],89:[function(i,B,V){var t=i("./lib/rationalize");B.exports=function(h,p){return t(h[0].mul(p[1]),h[1].mul(p[0]))}},{"./lib/rationalize":97}],90:[function(i,B,V){var t=i("./is-rat"),h=i("./lib/is-bn"),p=i("./lib/num-to-bn"),u=i("./lib/str-to-bn"),e=i("./lib/rationalize"),l=i("./div");B.exports=function o(a,n){if(t(a))return n?l(a,o(n)):[a[0].clone(),a[1].clone()];var s,r,c=0;if(h(a))s=a.clone();else if(typeof a=="string")s=u(a);else{if(a===0)return[p(0),p(1)];if(a===Math.floor(a))s=p(a);else{for(;a!==Math.floor(a);)a*=Math.pow(2,256),c-=256;s=p(a)}}if(t(n))s.mul(n[1]),r=n[0].clone();else if(h(n))r=n.clone();else if(typeof n=="string")r=u(n);else if(n)if(n===Math.floor(n))r=p(n);else{for(;n!==Math.floor(n);)n*=Math.pow(2,256),c+=256;r=p(n)}else r=p(1);return c>0?s=s.ushln(c):c<0&&(r=r.ushln(-c)),e(s,r)}},{"./div":89,"./is-rat":91,"./lib/is-bn":95,"./lib/num-to-bn":96,"./lib/rationalize":97,"./lib/str-to-bn":98}],91:[function(i,B,V){var t=i("./lib/is-bn");B.exports=function(h){return Array.isArray(h)&&h.length===2&&t(h[0])&&t(h[1])}},{"./lib/is-bn":95}],92:[function(i,B,V){var t=i("bn.js");B.exports=function(h){return h.cmp(new t(0))}},{"bn.js":106}],93:[function(i,B,V){var t=i("./bn-sign");B.exports=function(h){var p=h.length,u=h.words,e=0;if(p===1)e=u[0];else if(p===2)e=u[0]+67108864*u[1];else for(var l=0;l<p;l++){var o=u[l];e+=o*Math.pow(67108864,l)}return t(h)*e}},{"./bn-sign":92}],94:[function(i,B,V){var t=i("double-bits"),h=i("bit-twiddle").countTrailingZeros;B.exports=function(p){var u=h(t.lo(p));if(u<32)return u;var e=h(t.hi(p));return e>20?52:e+32}},{"bit-twiddle":104,"double-bits":182}],95:[function(i,B,V){i("bn.js"),B.exports=function(t){return t&&typeof t=="object"&&!!t.words}},{"bn.js":106}],96:[function(i,B,V){var t=i("bn.js"),h=i("double-bits");B.exports=function(p){var u=h.exponent(p);return u<52?new t(p):new t(p*Math.pow(2,52-u)).ushln(u-52)}},{"bn.js":106,"double-bits":182}],97:[function(i,B,V){var t=i("./num-to-bn"),h=i("./bn-sign");B.exports=function(p,u){var e=h(p),l=h(u);if(e===0)return[t(0),t(1)];if(l===0)return[t(0),t(0)];l<0&&(p=p.neg(),u=u.neg());var o=p.gcd(u);return o.cmpn(1)?[p.div(o),u.div(o)]:[p,u]}},{"./bn-sign":92,"./num-to-bn":96}],98:[function(i,B,V){var t=i("bn.js");B.exports=function(h){return new t(h)}},{"bn.js":106}],99:[function(i,B,V){var t=i("./lib/rationalize");B.exports=function(h,p){return t(h[0].mul(p[0]),h[1].mul(p[1]))}},{"./lib/rationalize":97}],100:[function(i,B,V){var t=i("./lib/bn-sign");B.exports=function(h){return t(h[0])*t(h[1])}},{"./lib/bn-sign":92}],101:[function(i,B,V){var t=i("./lib/rationalize");B.exports=function(h,p){return t(h[0].mul(p[1]).sub(h[1].mul(p[0])),h[1].mul(p[1]))}},{"./lib/rationalize":97}],102:[function(i,B,V){var t=i("./lib/bn-to-num"),h=i("./lib/ctz");B.exports=function(p){var u=p[0],e=p[1];if(u.cmpn(0)===0)return 0;var l=u.abs().divmod(e.abs()),o=l.div,a=t(o),n=l.mod,s=u.negative!==e.negative?-1:1;if(n.cmpn(0)===0)return s*a;if(a){var r=h(a)+4,c=t(n.ushln(r).divRound(e));return s*(a+c*Math.pow(2,-r))}var f=e.bitLength()-n.bitLength()+53;return c=t(n.ushln(f).divRound(e)),f<1023?s*c*Math.pow(2,-f):(c*=Math.pow(2,-1023),s*c*Math.pow(2,1023-f))}},{"./lib/bn-to-num":93,"./lib/ctz":94}],103:[function(i,B,V){function t(o,a,n,s,r){for(var c=r+1;s<=r;){var f=s+r>>>1,d=o[f];(n!==void 0?n(d,a):d-a)>=0?(c=f,r=f-1):s=f+1}return c}function h(o,a,n,s,r){for(var c=r+1;s<=r;){var f=s+r>>>1,d=o[f];(n!==void 0?n(d,a):d-a)>0?(c=f,r=f-1):s=f+1}return c}function p(o,a,n,s,r){for(var c=s-1;s<=r;){var f=s+r>>>1,d=o[f];(n!==void 0?n(d,a):d-a)<0?(c=f,s=f+1):r=f-1}return c}function u(o,a,n,s,r){for(var c=s-1;s<=r;){var f=s+r>>>1,d=o[f];(n!==void 0?n(d,a):d-a)<=0?(c=f,s=f+1):r=f-1}return c}function e(o,a,n,s,r){for(;s<=r;){var c=s+r>>>1,f=o[c],d=n!==void 0?n(f,a):f-a;if(d===0)return c;d<=0?s=c+1:r=c-1}return-1}function l(o,a,n,s,r,c){return typeof n=="function"?c(o,a,n,s===void 0?0:0|s,r===void 0?o.length-1:0|r):c(o,a,void 0,n===void 0?0:0|n,s===void 0?o.length-1:0|s)}B.exports={ge:function(o,a,n,s,r){return l(o,a,n,s,r,t)},gt:function(o,a,n,s,r){return l(o,a,n,s,r,h)},lt:function(o,a,n,s,r){return l(o,a,n,s,r,p)},le:function(o,a,n,s,r){return l(o,a,n,s,r,u)},eq:function(o,a,n,s,r){return l(o,a,n,s,r,e)}}},{}],104:[function(i,B,V){function t(p){var u=32;return(p&=-p)&&u--,65535&p&&(u-=16),16711935&p&&(u-=8),252645135&p&&(u-=4),858993459&p&&(u-=2),1431655765&p&&(u-=1),u}V.INT_BITS=32,V.INT_MAX=2147483647,V.INT_MIN=-1<<31,V.sign=function(p){return(p>0)-(p<0)},V.abs=function(p){var u=p>>31;return(p^u)-u},V.min=function(p,u){return u^(p^u)&-(p<u)},V.max=function(p,u){return p^(p^u)&-(p<u)},V.isPow2=function(p){return!(p&p-1||!p)},V.log2=function(p){var u,e;return u=(p>65535)<<4,u|=e=((p>>>=u)>255)<<3,u|=e=((p>>>=e)>15)<<2,(u|=e=((p>>>=e)>3)<<1)|(p>>>=e)>>1},V.log10=function(p){return p>=1e9?9:p>=1e8?8:p>=1e7?7:p>=1e6?6:p>=1e5?5:p>=1e4?4:p>=1e3?3:p>=100?2:p>=10?1:0},V.popCount=function(p){return 16843009*((p=(858993459&(p-=p>>>1&1431655765))+(p>>>2&858993459))+(p>>>4)&252645135)>>>24},V.countTrailingZeros=t,V.nextPow2=function(p){return p+=p===0,--p,p|=p>>>1,p|=p>>>2,p|=p>>>4,p|=p>>>8,(p|=p>>>16)+1},V.prevPow2=function(p){return p|=p>>>1,p|=p>>>2,p|=p>>>4,p|=p>>>8,(p|=p>>>16)-(p>>>1)},V.parity=function(p){return p^=p>>>16,p^=p>>>8,p^=p>>>4,27030>>>(p&=15)&1};var h=new Array(256);(function(p){for(var u=0;u<256;++u){var e=u,l=u,o=7;for(e>>>=1;e;e>>>=1)l<<=1,l|=1&e,--o;p[u]=l<<o&255}})(h),V.reverse=function(p){return h[255&p]<<24|h[p>>>8&255]<<16|h[p>>>16&255]<<8|h[p>>>24&255]},V.interleave2=function(p,u){return(p=1431655765&((p=858993459&((p=252645135&((p=16711935&((p&=65535)|p<<8))|p<<4))|p<<2))|p<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u&=65535)|u<<8))|u<<4))|u<<2))|u<<1))<<1},V.deinterleave2=function(p,u){return(p=65535&((p=16711935&((p=252645135&((p=858993459&((p=p>>>u&1431655765)|p>>>1))|p>>>2))|p>>>4))|p>>>16))<<16>>16},V.interleave3=function(p,u,e){return p=1227133513&((p=3272356035&((p=251719695&((p=4278190335&((p&=1023)|p<<16))|p<<8))|p<<4))|p<<2),(p|=(u=1227133513&((u=3272356035&((u=251719695&((u=4278190335&((u&=1023)|u<<16))|u<<8))|u<<4))|u<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},V.deinterleave3=function(p,u){return(p=1023&((p=4278190335&((p=251719695&((p=3272356035&((p=p>>>u&1227133513)|p>>>2))|p>>>4))|p>>>8))|p>>>16))<<22>>22},V.nextCombination=function(p){var u=p|p-1;return u+1|(~u&-~u)-1>>>t(p)+1}},{}],105:[function(i,B,V){var t=i("clamp");B.exports=function(e,l){l||(l={});var o,a,n,s,r,c,f,d,g,m,y,v=l.cutoff==null?.25:l.cutoff,T=l.radius==null?8:l.radius,_=l.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!l.width||!l.height)throw Error("For raw data width and height should be provided by options");o=l.width,a=l.height,s=e,c=l.stride?l.stride:Math.floor(e.length/o/a)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(f=(d=e).getContext("2d"),o=d.width,a=d.height,g=f.getImageData(0,0,o,a),s=g.data,c=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(d=e.canvas,f=e,o=d.width,a=d.height,g=f.getImageData(0,0,o,a),s=g.data,c=4):window.ImageData&&e instanceof window.ImageData&&(g=e,o=e.width,a=e.height,s=g.data,c=4);if(n=Math.max(o,a),window.Uint8ClampedArray&&s instanceof window.Uint8ClampedArray||window.Uint8Array&&s instanceof window.Uint8Array)for(r=s,s=Array(o*a),m=0,y=r.length;m<y;m++)s[m]=r[m*c+_]/255;else if(c!==1)throw Error("Raw data can have only 1 value per pixel");var k=Array(o*a),E=Array(o*a),A=Array(n),b=Array(n),L=Array(n+1),w=Array(n);for(m=0,y=o*a;m<y;m++){var C=s[m];k[m]=C===1?0:C===0?h:Math.pow(Math.max(0,.5-C),2),E[m]=C===1?h:C===0?0:Math.pow(Math.max(0,C-.5),2)}p(k,o,a,A,b,w,L),p(E,o,a,A,b,w,L);var S=window.Float32Array?new Float32Array(o*a):new Array(o*a);for(m=0,y=o*a;m<y;m++)S[m]=t(1-((k[m]-E[m])/T+v),0,1);return S};var h=1e20;function p(e,l,o,a,n,s,r){for(var c=0;c<l;c++){for(var f=0;f<o;f++)a[f]=e[f*l+c];for(u(a,n,s,r,o),f=0;f<o;f++)e[f*l+c]=n[f]}for(f=0;f<o;f++){for(c=0;c<l;c++)a[c]=e[f*l+c];for(u(a,n,s,r,l),c=0;c<l;c++)e[f*l+c]=Math.sqrt(n[c])}}function u(e,l,o,a,n){o[0]=0,a[0]=-h,a[1]=+h;for(var s=1,r=0;s<n;s++){for(var c=(e[s]+s*s-(e[o[r]]+o[r]*o[r]))/(2*s-2*o[r]);c<=a[r];)r--,c=(e[s]+s*s-(e[o[r]]+o[r]*o[r]))/(2*s-2*o[r]);o[++r]=s,a[r]=c,a[r+1]=+h}for(s=0,r=0;s<n;s++){for(;a[r+1]<s;)r++;l[s]=(s-o[r])*(s-o[r])+e[o[r]]}}},{clamp:126}],106:[function(i,B,V){(function(t,h){function p(b,L){if(!b)throw new Error(L||"Assertion failed")}function u(b,L){b.super_=L;var w=function(){};w.prototype=L.prototype,b.prototype=new w,b.prototype.constructor=b}function e(b,L,w){if(e.isBN(b))return b;this.negative=0,this.words=null,this.length=0,this.red=null,b!==null&&(L!=="le"&&L!=="be"||(w=L,L=10),this._init(b||0,L||10,w||"be"))}var l;typeof t=="object"?t.exports=e:h.BN=e,e.BN=e,e.wordSize=26;try{l=i("buffer").Buffer}catch{}function o(b,L,w){for(var C=0,S=Math.min(b.length,w),P=L;P<S;P++){var z=b.charCodeAt(P)-48;C<<=4,C|=z>=49&&z<=54?z-49+10:z>=17&&z<=22?z-17+10:15&z}return C}function a(b,L,w,C){for(var S=0,P=Math.min(b.length,w),z=L;z<P;z++){var F=b.charCodeAt(z)-48;S*=C,S+=F>=49?F-49+10:F>=17?F-17+10:F}return S}e.isBN=function(b){return b instanceof e||b!==null&&typeof b=="object"&&b.constructor.wordSize===e.wordSize&&Array.isArray(b.words)},e.max=function(b,L){return b.cmp(L)>0?b:L},e.min=function(b,L){return b.cmp(L)<0?b:L},e.prototype._init=function(b,L,w){if(typeof b=="number")return this._initNumber(b,L,w);if(typeof b=="object")return this._initArray(b,L,w);L==="hex"&&(L=16),p(L===(0|L)&&L>=2&&L<=36);var C=0;(b=b.toString().replace(/\s+/g,""))[0]==="-"&&C++,L===16?this._parseHex(b,C):this._parseBase(b,L,C),b[0]==="-"&&(this.negative=1),this.strip(),w==="le"&&this._initArray(this.toArray(),L,w)},e.prototype._initNumber=function(b,L,w){b<0&&(this.negative=1,b=-b),b<67108864?(this.words=[67108863&b],this.length=1):b<4503599627370496?(this.words=[67108863&b,b/67108864&67108863],this.length=2):(p(b<9007199254740992),this.words=[67108863&b,b/67108864&67108863,1],this.length=3),w==="le"&&this._initArray(this.toArray(),L,w)},e.prototype._initArray=function(b,L,w){if(p(typeof b.length=="number"),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var S,P,z=0;if(w==="be")for(C=b.length-1,S=0;C>=0;C-=3)P=b[C]|b[C-1]<<8|b[C-2]<<16,this.words[S]|=P<<z&67108863,this.words[S+1]=P>>>26-z&67108863,(z+=24)>=26&&(z-=26,S++);else if(w==="le")for(C=0,S=0;C<b.length;C+=3)P=b[C]|b[C+1]<<8|b[C+2]<<16,this.words[S]|=P<<z&67108863,this.words[S+1]=P>>>26-z&67108863,(z+=24)>=26&&(z-=26,S++);return this.strip()},e.prototype._parseHex=function(b,L){this.length=Math.ceil((b.length-L)/6),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var C,S,P=0;for(w=b.length-6,C=0;w>=L;w-=6)S=o(b,w,w+6),this.words[C]|=S<<P&67108863,this.words[C+1]|=S>>>26-P&4194303,(P+=24)>=26&&(P-=26,C++);w+6!==L&&(S=o(b,L,w+6),this.words[C]|=S<<P&67108863,this.words[C+1]|=S>>>26-P&4194303),this.strip()},e.prototype._parseBase=function(b,L,w){this.words=[0],this.length=1;for(var C=0,S=1;S<=67108863;S*=L)C++;C--,S=S/L|0;for(var P=b.length-w,z=P%C,F=Math.min(P,P-z)+w,q=0,W=w;W<F;W+=C)q=a(b,W,W+C,L),this.imuln(S),this.words[0]+q<67108864?this.words[0]+=q:this._iaddn(q);if(z!==0){var X=1;for(q=a(b,W,b.length,L),W=0;W<z;W++)X*=L;this.imuln(X),this.words[0]+q<67108864?this.words[0]+=q:this._iaddn(q)}},e.prototype.copy=function(b){b.words=new Array(this.length);for(var L=0;L<this.length;L++)b.words[L]=this.words[L];b.length=this.length,b.negative=this.negative,b.red=this.red},e.prototype.clone=function(){var b=new e(null);return this.copy(b),b},e.prototype._expand=function(b){for(;this.length<b;)this.words[this.length++]=0;return this},e.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},e.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},e.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var n=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],s=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],r=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function c(b,L,w){w.negative=L.negative^b.negative;var C=b.length+L.length|0;w.length=C,C=C-1|0;var S=0|b.words[0],P=0|L.words[0],z=S*P,F=67108863&z,q=z/67108864|0;w.words[0]=F;for(var W=1;W<C;W++){for(var X=q>>>26,Q=67108863&q,Z=Math.min(W,L.length-1),Y=Math.max(0,W-b.length+1);Y<=Z;Y++){var N=W-Y|0;X+=(z=(S=0|b.words[N])*(P=0|L.words[Y])+Q)/67108864|0,Q=67108863&z}w.words[W]=0|Q,q=0|X}return q!==0?w.words[W]=0|q:w.length--,w.strip()}e.prototype.toString=function(b,L){var w;if(L=0|L||1,(b=b||10)===16||b==="hex"){w="";for(var C=0,S=0,P=0;P<this.length;P++){var z=this.words[P],F=(16777215&(z<<C|S)).toString(16);w=(S=z>>>24-C&16777215)!==0||P!==this.length-1?n[6-F.length]+F+w:F+w,(C+=2)>=26&&(C-=26,P--)}for(S!==0&&(w=S.toString(16)+w);w.length%L!=0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}if(b===(0|b)&&b>=2&&b<=36){var q=s[b],W=r[b];w="";var X=this.clone();for(X.negative=0;!X.isZero();){var Q=X.modn(W).toString(b);w=(X=X.idivn(W)).isZero()?Q+w:n[q-Q.length]+Q+w}for(this.isZero()&&(w="0"+w);w.length%L!=0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}p(!1,"Base should be between 2 and 36")},e.prototype.toNumber=function(){var b=this.words[0];return this.length===2?b+=67108864*this.words[1]:this.length===3&&this.words[2]===1?b+=4503599627370496+67108864*this.words[1]:this.length>2&&p(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-b:b},e.prototype.toJSON=function(){return this.toString(16)},e.prototype.toBuffer=function(b,L){return p(l!==void 0),this.toArrayLike(l,b,L)},e.prototype.toArray=function(b,L){return this.toArrayLike(Array,b,L)},e.prototype.toArrayLike=function(b,L,w){var C=this.byteLength(),S=w||Math.max(1,C);p(C<=S,"byte array longer than desired length"),p(S>0,"Requested array length <= 0"),this.strip();var P,z,F=L==="le",q=new b(S),W=this.clone();if(F){for(z=0;!W.isZero();z++)P=W.andln(255),W.iushrn(8),q[z]=P;for(;z<S;z++)q[z]=0}else{for(z=0;z<S-C;z++)q[z]=0;for(z=0;!W.isZero();z++)P=W.andln(255),W.iushrn(8),q[S-z-1]=P}return q},Math.clz32?e.prototype._countBits=function(b){return 32-Math.clz32(b)}:e.prototype._countBits=function(b){var L=b,w=0;return L>=4096&&(w+=13,L>>>=13),L>=64&&(w+=7,L>>>=7),L>=8&&(w+=4,L>>>=4),L>=2&&(w+=2,L>>>=2),w+L},e.prototype._zeroBits=function(b){if(b===0)return 26;var L=b,w=0;return!(8191&L)&&(w+=13,L>>>=13),!(127&L)&&(w+=7,L>>>=7),!(15&L)&&(w+=4,L>>>=4),!(3&L)&&(w+=2,L>>>=2),!(1&L)&&w++,w},e.prototype.bitLength=function(){var b=this.words[this.length-1],L=this._countBits(b);return 26*(this.length-1)+L},e.prototype.zeroBits=function(){if(this.isZero())return 0;for(var b=0,L=0;L<this.length;L++){var w=this._zeroBits(this.words[L]);if(b+=w,w!==26)break}return b},e.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},e.prototype.toTwos=function(b){return this.negative!==0?this.abs().inotn(b).iaddn(1):this.clone()},e.prototype.fromTwos=function(b){return this.testn(b-1)?this.notn(b).iaddn(1).ineg():this.clone()},e.prototype.isNeg=function(){return this.negative!==0},e.prototype.neg=function(){return this.clone().ineg()},e.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},e.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var L=0;L<b.length;L++)this.words[L]=this.words[L]|b.words[L];return this.strip()},e.prototype.ior=function(b){return p((this.negative|b.negative)==0),this.iuor(b)},e.prototype.or=function(b){return this.length>b.length?this.clone().ior(b):b.clone().ior(this)},e.prototype.uor=function(b){return this.length>b.length?this.clone().iuor(b):b.clone().iuor(this)},e.prototype.iuand=function(b){var L;L=this.length>b.length?b:this;for(var w=0;w<L.length;w++)this.words[w]=this.words[w]&b.words[w];return this.length=L.length,this.strip()},e.prototype.iand=function(b){return p((this.negative|b.negative)==0),this.iuand(b)},e.prototype.and=function(b){return this.length>b.length?this.clone().iand(b):b.clone().iand(this)},e.prototype.uand=function(b){return this.length>b.length?this.clone().iuand(b):b.clone().iuand(this)},e.prototype.iuxor=function(b){var L,w;this.length>b.length?(L=this,w=b):(L=b,w=this);for(var C=0;C<w.length;C++)this.words[C]=L.words[C]^w.words[C];if(this!==L)for(;C<L.length;C++)this.words[C]=L.words[C];return this.length=L.length,this.strip()},e.prototype.ixor=function(b){return p((this.negative|b.negative)==0),this.iuxor(b)},e.prototype.xor=function(b){return this.length>b.length?this.clone().ixor(b):b.clone().ixor(this)},e.prototype.uxor=function(b){return this.length>b.length?this.clone().iuxor(b):b.clone().iuxor(this)},e.prototype.inotn=function(b){p(typeof b=="number"&&b>=0);var L=0|Math.ceil(b/26),w=b%26;this._expand(L),w>0&&L--;for(var C=0;C<L;C++)this.words[C]=67108863&~this.words[C];return w>0&&(this.words[C]=~this.words[C]&67108863>>26-w),this.strip()},e.prototype.notn=function(b){return this.clone().inotn(b)},e.prototype.setn=function(b,L){p(typeof b=="number"&&b>=0);var w=b/26|0,C=b%26;return this._expand(w+1),this.words[w]=L?this.words[w]|1<<C:this.words[w]&~(1<<C),this.strip()},e.prototype.iadd=function(b){var L,w,C;if(this.negative!==0&&b.negative===0)return this.negative=0,L=this.isub(b),this.negative^=1,this._normSign();if(this.negative===0&&b.negative!==0)return b.negative=0,L=this.isub(b),b.negative=1,L._normSign();this.length>b.length?(w=this,C=b):(w=b,C=this);for(var S=0,P=0;P<C.length;P++)L=(0|w.words[P])+(0|C.words[P])+S,this.words[P]=67108863&L,S=L>>>26;for(;S!==0&&P<w.length;P++)L=(0|w.words[P])+S,this.words[P]=67108863&L,S=L>>>26;if(this.length=w.length,S!==0)this.words[this.length]=S,this.length++;else if(w!==this)for(;P<w.length;P++)this.words[P]=w.words[P];return this},e.prototype.add=function(b){var L;return b.negative!==0&&this.negative===0?(b.negative=0,L=this.sub(b),b.negative^=1,L):b.negative===0&&this.negative!==0?(this.negative=0,L=b.sub(this),this.negative=1,L):this.length>b.length?this.clone().iadd(b):b.clone().iadd(this)},e.prototype.isub=function(b){if(b.negative!==0){b.negative=0;var L=this.iadd(b);return b.negative=1,L._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(b),this.negative=1,this._normSign();var w,C,S=this.cmp(b);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;S>0?(w=this,C=b):(w=b,C=this);for(var P=0,z=0;z<C.length;z++)P=(L=(0|w.words[z])-(0|C.words[z])+P)>>26,this.words[z]=67108863&L;for(;P!==0&&z<w.length;z++)P=(L=(0|w.words[z])+P)>>26,this.words[z]=67108863&L;if(P===0&&z<w.length&&w!==this)for(;z<w.length;z++)this.words[z]=w.words[z];return this.length=Math.max(this.length,z),w!==this&&(this.negative=1),this.strip()},e.prototype.sub=function(b){return this.clone().isub(b)};var f=function(b,L,w){var C,S,P,z=b.words,F=L.words,q=w.words,W=0,X=0|z[0],Q=8191&X,Z=X>>>13,Y=0|z[1],N=8191&Y,J=Y>>>13,D=0|z[2],U=8191&D,G=D>>>13,$=0|z[3],K=8191&$,re=$>>>13,ne=0|z[4],ae=8191&ne,ie=ne>>>13,he=0|z[5],se=8191&he,de=he>>>13,ce=0|z[6],ve=8191&ce,Ee=ce>>>13,Le=0|z[7],Te=8191&Le,xe=Le>>>13,fe=0|z[8],ge=8191&fe,ke=fe>>>13,Me=0|z[9],Se=8191&Me,De=Me>>>13,Be=0|F[0],We=8191&Be,Qe=Be>>>13,Oe=0|F[1],Ue=8191&Oe,Xe=Oe>>>13,Ye=0|F[2],$e=8191&Ye,it=Ye>>>13,ot=0|F[3],Et=8191&ot,mt=ot>>>13,tt=0|F[4],Ke=8191&tt,Mt=tt>>>13,Jt=0|F[5],$t=8191&Jt,je=Jt>>>13,Ge=0|F[6],Ct=8191&Ge,Ie=Ge>>>13,be=0|F[7],Ae=8191&be,Pe=be>>>13,ze=0|F[8],qe=8191&ze,ht=ze>>>13,at=0|F[9],nt=8191&at,xt=at>>>13;w.negative=b.negative^L.negative,w.length=19;var Lt=(W+(C=Math.imul(Q,We))|0)+((8191&(S=(S=Math.imul(Q,Qe))+Math.imul(Z,We)|0))<<13)|0;W=((P=Math.imul(Z,Qe))+(S>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,C=Math.imul(N,We),S=(S=Math.imul(N,Qe))+Math.imul(J,We)|0,P=Math.imul(J,Qe);var bt=(W+(C=C+Math.imul(Q,Ue)|0)|0)+((8191&(S=(S=S+Math.imul(Q,Xe)|0)+Math.imul(Z,Ue)|0))<<13)|0;W=((P=P+Math.imul(Z,Xe)|0)+(S>>>13)|0)+(bt>>>26)|0,bt&=67108863,C=Math.imul(U,We),S=(S=Math.imul(U,Qe))+Math.imul(G,We)|0,P=Math.imul(G,Qe),C=C+Math.imul(N,Ue)|0,S=(S=S+Math.imul(N,Xe)|0)+Math.imul(J,Ue)|0,P=P+Math.imul(J,Xe)|0;var St=(W+(C=C+Math.imul(Q,$e)|0)|0)+((8191&(S=(S=S+Math.imul(Q,it)|0)+Math.imul(Z,$e)|0))<<13)|0;W=((P=P+Math.imul(Z,it)|0)+(S>>>13)|0)+(St>>>26)|0,St&=67108863,C=Math.imul(K,We),S=(S=Math.imul(K,Qe))+Math.imul(re,We)|0,P=Math.imul(re,Qe),C=C+Math.imul(U,Ue)|0,S=(S=S+Math.imul(U,Xe)|0)+Math.imul(G,Ue)|0,P=P+Math.imul(G,Xe)|0,C=C+Math.imul(N,$e)|0,S=(S=S+Math.imul(N,it)|0)+Math.imul(J,$e)|0,P=P+Math.imul(J,it)|0;var st=(W+(C=C+Math.imul(Q,Et)|0)|0)+((8191&(S=(S=S+Math.imul(Q,mt)|0)+Math.imul(Z,Et)|0))<<13)|0;W=((P=P+Math.imul(Z,mt)|0)+(S>>>13)|0)+(st>>>26)|0,st&=67108863,C=Math.imul(ae,We),S=(S=Math.imul(ae,Qe))+Math.imul(ie,We)|0,P=Math.imul(ie,Qe),C=C+Math.imul(K,Ue)|0,S=(S=S+Math.imul(K,Xe)|0)+Math.imul(re,Ue)|0,P=P+Math.imul(re,Xe)|0,C=C+Math.imul(U,$e)|0,S=(S=S+Math.imul(U,it)|0)+Math.imul(G,$e)|0,P=P+Math.imul(G,it)|0,C=C+Math.imul(N,Et)|0,S=(S=S+Math.imul(N,mt)|0)+Math.imul(J,Et)|0,P=P+Math.imul(J,mt)|0;var It=(W+(C=C+Math.imul(Q,Ke)|0)|0)+((8191&(S=(S=S+Math.imul(Q,Mt)|0)+Math.imul(Z,Ke)|0))<<13)|0;W=((P=P+Math.imul(Z,Mt)|0)+(S>>>13)|0)+(It>>>26)|0,It&=67108863,C=Math.imul(se,We),S=(S=Math.imul(se,Qe))+Math.imul(de,We)|0,P=Math.imul(de,Qe),C=C+Math.imul(ae,Ue)|0,S=(S=S+Math.imul(ae,Xe)|0)+Math.imul(ie,Ue)|0,P=P+Math.imul(ie,Xe)|0,C=C+Math.imul(K,$e)|0,S=(S=S+Math.imul(K,it)|0)+Math.imul(re,$e)|0,P=P+Math.imul(re,it)|0,C=C+Math.imul(U,Et)|0,S=(S=S+Math.imul(U,mt)|0)+Math.imul(G,Et)|0,P=P+Math.imul(G,mt)|0,C=C+Math.imul(N,Ke)|0,S=(S=S+Math.imul(N,Mt)|0)+Math.imul(J,Ke)|0,P=P+Math.imul(J,Mt)|0;var jt=(W+(C=C+Math.imul(Q,$t)|0)|0)+((8191&(S=(S=S+Math.imul(Q,je)|0)+Math.imul(Z,$t)|0))<<13)|0;W=((P=P+Math.imul(Z,je)|0)+(S>>>13)|0)+(jt>>>26)|0,jt&=67108863,C=Math.imul(ve,We),S=(S=Math.imul(ve,Qe))+Math.imul(Ee,We)|0,P=Math.imul(Ee,Qe),C=C+Math.imul(se,Ue)|0,S=(S=S+Math.imul(se,Xe)|0)+Math.imul(de,Ue)|0,P=P+Math.imul(de,Xe)|0,C=C+Math.imul(ae,$e)|0,S=(S=S+Math.imul(ae,it)|0)+Math.imul(ie,$e)|0,P=P+Math.imul(ie,it)|0,C=C+Math.imul(K,Et)|0,S=(S=S+Math.imul(K,mt)|0)+Math.imul(re,Et)|0,P=P+Math.imul(re,mt)|0,C=C+Math.imul(U,Ke)|0,S=(S=S+Math.imul(U,Mt)|0)+Math.imul(G,Ke)|0,P=P+Math.imul(G,Mt)|0,C=C+Math.imul(N,$t)|0,S=(S=S+Math.imul(N,je)|0)+Math.imul(J,$t)|0,P=P+Math.imul(J,je)|0;var Ut=(W+(C=C+Math.imul(Q,Ct)|0)|0)+((8191&(S=(S=S+Math.imul(Q,Ie)|0)+Math.imul(Z,Ct)|0))<<13)|0;W=((P=P+Math.imul(Z,Ie)|0)+(S>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,C=Math.imul(Te,We),S=(S=Math.imul(Te,Qe))+Math.imul(xe,We)|0,P=Math.imul(xe,Qe),C=C+Math.imul(ve,Ue)|0,S=(S=S+Math.imul(ve,Xe)|0)+Math.imul(Ee,Ue)|0,P=P+Math.imul(Ee,Xe)|0,C=C+Math.imul(se,$e)|0,S=(S=S+Math.imul(se,it)|0)+Math.imul(de,$e)|0,P=P+Math.imul(de,it)|0,C=C+Math.imul(ae,Et)|0,S=(S=S+Math.imul(ae,mt)|0)+Math.imul(ie,Et)|0,P=P+Math.imul(ie,mt)|0,C=C+Math.imul(K,Ke)|0,S=(S=S+Math.imul(K,Mt)|0)+Math.imul(re,Ke)|0,P=P+Math.imul(re,Mt)|0,C=C+Math.imul(U,$t)|0,S=(S=S+Math.imul(U,je)|0)+Math.imul(G,$t)|0,P=P+Math.imul(G,je)|0,C=C+Math.imul(N,Ct)|0,S=(S=S+Math.imul(N,Ie)|0)+Math.imul(J,Ct)|0,P=P+Math.imul(J,Ie)|0;var zt=(W+(C=C+Math.imul(Q,Ae)|0)|0)+((8191&(S=(S=S+Math.imul(Q,Pe)|0)+Math.imul(Z,Ae)|0))<<13)|0;W=((P=P+Math.imul(Z,Pe)|0)+(S>>>13)|0)+(zt>>>26)|0,zt&=67108863,C=Math.imul(ge,We),S=(S=Math.imul(ge,Qe))+Math.imul(ke,We)|0,P=Math.imul(ke,Qe),C=C+Math.imul(Te,Ue)|0,S=(S=S+Math.imul(Te,Xe)|0)+Math.imul(xe,Ue)|0,P=P+Math.imul(xe,Xe)|0,C=C+Math.imul(ve,$e)|0,S=(S=S+Math.imul(ve,it)|0)+Math.imul(Ee,$e)|0,P=P+Math.imul(Ee,it)|0,C=C+Math.imul(se,Et)|0,S=(S=S+Math.imul(se,mt)|0)+Math.imul(de,Et)|0,P=P+Math.imul(de,mt)|0,C=C+Math.imul(ae,Ke)|0,S=(S=S+Math.imul(ae,Mt)|0)+Math.imul(ie,Ke)|0,P=P+Math.imul(ie,Mt)|0,C=C+Math.imul(K,$t)|0,S=(S=S+Math.imul(K,je)|0)+Math.imul(re,$t)|0,P=P+Math.imul(re,je)|0,C=C+Math.imul(U,Ct)|0,S=(S=S+Math.imul(U,Ie)|0)+Math.imul(G,Ct)|0,P=P+Math.imul(G,Ie)|0,C=C+Math.imul(N,Ae)|0,S=(S=S+Math.imul(N,Pe)|0)+Math.imul(J,Ae)|0,P=P+Math.imul(J,Pe)|0;var Ce=(W+(C=C+Math.imul(Q,qe)|0)|0)+((8191&(S=(S=S+Math.imul(Q,ht)|0)+Math.imul(Z,qe)|0))<<13)|0;W=((P=P+Math.imul(Z,ht)|0)+(S>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,C=Math.imul(Se,We),S=(S=Math.imul(Se,Qe))+Math.imul(De,We)|0,P=Math.imul(De,Qe),C=C+Math.imul(ge,Ue)|0,S=(S=S+Math.imul(ge,Xe)|0)+Math.imul(ke,Ue)|0,P=P+Math.imul(ke,Xe)|0,C=C+Math.imul(Te,$e)|0,S=(S=S+Math.imul(Te,it)|0)+Math.imul(xe,$e)|0,P=P+Math.imul(xe,it)|0,C=C+Math.imul(ve,Et)|0,S=(S=S+Math.imul(ve,mt)|0)+Math.imul(Ee,Et)|0,P=P+Math.imul(Ee,mt)|0,C=C+Math.imul(se,Ke)|0,S=(S=S+Math.imul(se,Mt)|0)+Math.imul(de,Ke)|0,P=P+Math.imul(de,Mt)|0,C=C+Math.imul(ae,$t)|0,S=(S=S+Math.imul(ae,je)|0)+Math.imul(ie,$t)|0,P=P+Math.imul(ie,je)|0,C=C+Math.imul(K,Ct)|0,S=(S=S+Math.imul(K,Ie)|0)+Math.imul(re,Ct)|0,P=P+Math.imul(re,Ie)|0,C=C+Math.imul(U,Ae)|0,S=(S=S+Math.imul(U,Pe)|0)+Math.imul(G,Ae)|0,P=P+Math.imul(G,Pe)|0,C=C+Math.imul(N,qe)|0,S=(S=S+Math.imul(N,ht)|0)+Math.imul(J,qe)|0,P=P+Math.imul(J,ht)|0;var lt=(W+(C=C+Math.imul(Q,nt)|0)|0)+((8191&(S=(S=S+Math.imul(Q,xt)|0)+Math.imul(Z,nt)|0))<<13)|0;W=((P=P+Math.imul(Z,xt)|0)+(S>>>13)|0)+(lt>>>26)|0,lt&=67108863,C=Math.imul(Se,Ue),S=(S=Math.imul(Se,Xe))+Math.imul(De,Ue)|0,P=Math.imul(De,Xe),C=C+Math.imul(ge,$e)|0,S=(S=S+Math.imul(ge,it)|0)+Math.imul(ke,$e)|0,P=P+Math.imul(ke,it)|0,C=C+Math.imul(Te,Et)|0,S=(S=S+Math.imul(Te,mt)|0)+Math.imul(xe,Et)|0,P=P+Math.imul(xe,mt)|0,C=C+Math.imul(ve,Ke)|0,S=(S=S+Math.imul(ve,Mt)|0)+Math.imul(Ee,Ke)|0,P=P+Math.imul(Ee,Mt)|0,C=C+Math.imul(se,$t)|0,S=(S=S+Math.imul(se,je)|0)+Math.imul(de,$t)|0,P=P+Math.imul(de,je)|0,C=C+Math.imul(ae,Ct)|0,S=(S=S+Math.imul(ae,Ie)|0)+Math.imul(ie,Ct)|0,P=P+Math.imul(ie,Ie)|0,C=C+Math.imul(K,Ae)|0,S=(S=S+Math.imul(K,Pe)|0)+Math.imul(re,Ae)|0,P=P+Math.imul(re,Pe)|0,C=C+Math.imul(U,qe)|0,S=(S=S+Math.imul(U,ht)|0)+Math.imul(G,qe)|0,P=P+Math.imul(G,ht)|0;var At=(W+(C=C+Math.imul(N,nt)|0)|0)+((8191&(S=(S=S+Math.imul(N,xt)|0)+Math.imul(J,nt)|0))<<13)|0;W=((P=P+Math.imul(J,xt)|0)+(S>>>13)|0)+(At>>>26)|0,At&=67108863,C=Math.imul(Se,$e),S=(S=Math.imul(Se,it))+Math.imul(De,$e)|0,P=Math.imul(De,it),C=C+Math.imul(ge,Et)|0,S=(S=S+Math.imul(ge,mt)|0)+Math.imul(ke,Et)|0,P=P+Math.imul(ke,mt)|0,C=C+Math.imul(Te,Ke)|0,S=(S=S+Math.imul(Te,Mt)|0)+Math.imul(xe,Ke)|0,P=P+Math.imul(xe,Mt)|0,C=C+Math.imul(ve,$t)|0,S=(S=S+Math.imul(ve,je)|0)+Math.imul(Ee,$t)|0,P=P+Math.imul(Ee,je)|0,C=C+Math.imul(se,Ct)|0,S=(S=S+Math.imul(se,Ie)|0)+Math.imul(de,Ct)|0,P=P+Math.imul(de,Ie)|0,C=C+Math.imul(ae,Ae)|0,S=(S=S+Math.imul(ae,Pe)|0)+Math.imul(ie,Ae)|0,P=P+Math.imul(ie,Pe)|0,C=C+Math.imul(K,qe)|0,S=(S=S+Math.imul(K,ht)|0)+Math.imul(re,qe)|0,P=P+Math.imul(re,ht)|0;var Bt=(W+(C=C+Math.imul(U,nt)|0)|0)+((8191&(S=(S=S+Math.imul(U,xt)|0)+Math.imul(G,nt)|0))<<13)|0;W=((P=P+Math.imul(G,xt)|0)+(S>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,C=Math.imul(Se,Et),S=(S=Math.imul(Se,mt))+Math.imul(De,Et)|0,P=Math.imul(De,mt),C=C+Math.imul(ge,Ke)|0,S=(S=S+Math.imul(ge,Mt)|0)+Math.imul(ke,Ke)|0,P=P+Math.imul(ke,Mt)|0,C=C+Math.imul(Te,$t)|0,S=(S=S+Math.imul(Te,je)|0)+Math.imul(xe,$t)|0,P=P+Math.imul(xe,je)|0,C=C+Math.imul(ve,Ct)|0,S=(S=S+Math.imul(ve,Ie)|0)+Math.imul(Ee,Ct)|0,P=P+Math.imul(Ee,Ie)|0,C=C+Math.imul(se,Ae)|0,S=(S=S+Math.imul(se,Pe)|0)+Math.imul(de,Ae)|0,P=P+Math.imul(de,Pe)|0,C=C+Math.imul(ae,qe)|0,S=(S=S+Math.imul(ae,ht)|0)+Math.imul(ie,qe)|0,P=P+Math.imul(ie,ht)|0;var Ht=(W+(C=C+Math.imul(K,nt)|0)|0)+((8191&(S=(S=S+Math.imul(K,xt)|0)+Math.imul(re,nt)|0))<<13)|0;W=((P=P+Math.imul(re,xt)|0)+(S>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,C=Math.imul(Se,Ke),S=(S=Math.imul(Se,Mt))+Math.imul(De,Ke)|0,P=Math.imul(De,Mt),C=C+Math.imul(ge,$t)|0,S=(S=S+Math.imul(ge,je)|0)+Math.imul(ke,$t)|0,P=P+Math.imul(ke,je)|0,C=C+Math.imul(Te,Ct)|0,S=(S=S+Math.imul(Te,Ie)|0)+Math.imul(xe,Ct)|0,P=P+Math.imul(xe,Ie)|0,C=C+Math.imul(ve,Ae)|0,S=(S=S+Math.imul(ve,Pe)|0)+Math.imul(Ee,Ae)|0,P=P+Math.imul(Ee,Pe)|0,C=C+Math.imul(se,qe)|0,S=(S=S+Math.imul(se,ht)|0)+Math.imul(de,qe)|0,P=P+Math.imul(de,ht)|0;var or=(W+(C=C+Math.imul(ae,nt)|0)|0)+((8191&(S=(S=S+Math.imul(ae,xt)|0)+Math.imul(ie,nt)|0))<<13)|0;W=((P=P+Math.imul(ie,xt)|0)+(S>>>13)|0)+(or>>>26)|0,or&=67108863,C=Math.imul(Se,$t),S=(S=Math.imul(Se,je))+Math.imul(De,$t)|0,P=Math.imul(De,je),C=C+Math.imul(ge,Ct)|0,S=(S=S+Math.imul(ge,Ie)|0)+Math.imul(ke,Ct)|0,P=P+Math.imul(ke,Ie)|0,C=C+Math.imul(Te,Ae)|0,S=(S=S+Math.imul(Te,Pe)|0)+Math.imul(xe,Ae)|0,P=P+Math.imul(xe,Pe)|0,C=C+Math.imul(ve,qe)|0,S=(S=S+Math.imul(ve,ht)|0)+Math.imul(Ee,qe)|0,P=P+Math.imul(Ee,ht)|0;var ar=(W+(C=C+Math.imul(se,nt)|0)|0)+((8191&(S=(S=S+Math.imul(se,xt)|0)+Math.imul(de,nt)|0))<<13)|0;W=((P=P+Math.imul(de,xt)|0)+(S>>>13)|0)+(ar>>>26)|0,ar&=67108863,C=Math.imul(Se,Ct),S=(S=Math.imul(Se,Ie))+Math.imul(De,Ct)|0,P=Math.imul(De,Ie),C=C+Math.imul(ge,Ae)|0,S=(S=S+Math.imul(ge,Pe)|0)+Math.imul(ke,Ae)|0,P=P+Math.imul(ke,Pe)|0,C=C+Math.imul(Te,qe)|0,S=(S=S+Math.imul(Te,ht)|0)+Math.imul(xe,qe)|0,P=P+Math.imul(xe,ht)|0;var Nt=(W+(C=C+Math.imul(ve,nt)|0)|0)+((8191&(S=(S=S+Math.imul(ve,xt)|0)+Math.imul(Ee,nt)|0))<<13)|0;W=((P=P+Math.imul(Ee,xt)|0)+(S>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,C=Math.imul(Se,Ae),S=(S=Math.imul(Se,Pe))+Math.imul(De,Ae)|0,P=Math.imul(De,Pe),C=C+Math.imul(ge,qe)|0,S=(S=S+Math.imul(ge,ht)|0)+Math.imul(ke,qe)|0,P=P+Math.imul(ke,ht)|0;var nr=(W+(C=C+Math.imul(Te,nt)|0)|0)+((8191&(S=(S=S+Math.imul(Te,xt)|0)+Math.imul(xe,nt)|0))<<13)|0;W=((P=P+Math.imul(xe,xt)|0)+(S>>>13)|0)+(nr>>>26)|0,nr&=67108863,C=Math.imul(Se,qe),S=(S=Math.imul(Se,ht))+Math.imul(De,qe)|0,P=Math.imul(De,ht);var Lr=(W+(C=C+Math.imul(ge,nt)|0)|0)+((8191&(S=(S=S+Math.imul(ge,xt)|0)+Math.imul(ke,nt)|0))<<13)|0;W=((P=P+Math.imul(ke,xt)|0)+(S>>>13)|0)+(Lr>>>26)|0,Lr&=67108863;var dr=(W+(C=Math.imul(Se,nt))|0)+((8191&(S=(S=Math.imul(Se,xt))+Math.imul(De,nt)|0))<<13)|0;return W=((P=Math.imul(De,xt))+(S>>>13)|0)+(dr>>>26)|0,dr&=67108863,q[0]=Lt,q[1]=bt,q[2]=St,q[3]=st,q[4]=It,q[5]=jt,q[6]=Ut,q[7]=zt,q[8]=Ce,q[9]=lt,q[10]=At,q[11]=Bt,q[12]=Ht,q[13]=or,q[14]=ar,q[15]=Nt,q[16]=nr,q[17]=Lr,q[18]=dr,W!==0&&(q[19]=W,w.length++),w};function d(b,L,w){return new g().mulp(b,L,w)}function g(b,L){this.x=b,this.y=L}Math.imul||(f=c),e.prototype.mulTo=function(b,L){var w=this.length+b.length;return this.length===10&&b.length===10?f(this,b,L):w<63?c(this,b,L):w<1024?function(C,S,P){P.negative=S.negative^C.negative,P.length=C.length+S.length;for(var z=0,F=0,q=0;q<P.length-1;q++){var W=F;F=0;for(var X=67108863&z,Q=Math.min(q,S.length-1),Z=Math.max(0,q-C.length+1);Z<=Q;Z++){var Y=q-Z,N=(0|C.words[Y])*(0|S.words[Z]),J=67108863&N;X=67108863&(J=J+X|0),F+=(W=(W=W+(N/67108864|0)|0)+(J>>>26)|0)>>>26,W&=67108863}P.words[q]=X,z=W,W=F}return z!==0?P.words[q]=z:P.length--,P.strip()}(this,b,L):d(this,b,L)},g.prototype.makeRBT=function(b){for(var L=new Array(b),w=e.prototype._countBits(b)-1,C=0;C<b;C++)L[C]=this.revBin(C,w,b);return L},g.prototype.revBin=function(b,L,w){if(b===0||b===w-1)return b;for(var C=0,S=0;S<L;S++)C|=(1&b)<<L-S-1,b>>=1;return C},g.prototype.permute=function(b,L,w,C,S,P){for(var z=0;z<P;z++)C[z]=L[b[z]],S[z]=w[b[z]]},g.prototype.transform=function(b,L,w,C,S,P){this.permute(P,b,L,w,C,S);for(var z=1;z<S;z<<=1)for(var F=z<<1,q=Math.cos(2*Math.PI/F),W=Math.sin(2*Math.PI/F),X=0;X<S;X+=F)for(var Q=q,Z=W,Y=0;Y<z;Y++){var N=w[X+Y],J=C[X+Y],D=w[X+Y+z],U=C[X+Y+z],G=Q*D-Z*U;U=Q*U+Z*D,D=G,w[X+Y]=N+D,C[X+Y]=J+U,w[X+Y+z]=N-D,C[X+Y+z]=J-U,Y!==F&&(G=q*Q-W*Z,Z=q*Z+W*Q,Q=G)}},g.prototype.guessLen13b=function(b,L){var w=1|Math.max(L,b),C=1&w,S=0;for(w=w/2|0;w;w>>>=1)S++;return 1<<S+1+C},g.prototype.conjugate=function(b,L,w){if(!(w<=1))for(var C=0;C<w/2;C++){var S=b[C];b[C]=b[w-C-1],b[w-C-1]=S,S=L[C],L[C]=-L[w-C-1],L[w-C-1]=-S}},g.prototype.normalize13b=function(b,L){for(var w=0,C=0;C<L/2;C++){var S=8192*Math.round(b[2*C+1]/L)+Math.round(b[2*C]/L)+w;b[C]=67108863&S,w=S<67108864?0:S/67108864|0}return b},g.prototype.convert13b=function(b,L,w,C){for(var S=0,P=0;P<L;P++)S+=0|b[P],w[2*P]=8191&S,S>>>=13,w[2*P+1]=8191&S,S>>>=13;for(P=2*L;P<C;++P)w[P]=0;p(S===0),p((-8192&S)==0)},g.prototype.stub=function(b){for(var L=new Array(b),w=0;w<b;w++)L[w]=0;return L},g.prototype.mulp=function(b,L,w){var C=2*this.guessLen13b(b.length,L.length),S=this.makeRBT(C),P=this.stub(C),z=new Array(C),F=new Array(C),q=new Array(C),W=new Array(C),X=new Array(C),Q=new Array(C),Z=w.words;Z.length=C,this.convert13b(b.words,b.length,z,C),this.convert13b(L.words,L.length,W,C),this.transform(z,P,F,q,C,S),this.transform(W,P,X,Q,C,S);for(var Y=0;Y<C;Y++){var N=F[Y]*X[Y]-q[Y]*Q[Y];q[Y]=F[Y]*Q[Y]+q[Y]*X[Y],F[Y]=N}return this.conjugate(F,q,C),this.transform(F,q,Z,P,C,S),this.conjugate(Z,P,C),this.normalize13b(Z,C),w.negative=b.negative^L.negative,w.length=b.length+L.length,w.strip()},e.prototype.mul=function(b){var L=new e(null);return L.words=new Array(this.length+b.length),this.mulTo(b,L)},e.prototype.mulf=function(b){var L=new e(null);return L.words=new Array(this.length+b.length),d(this,b,L)},e.prototype.imul=function(b){return this.clone().mulTo(b,this)},e.prototype.imuln=function(b){p(typeof b=="number"),p(b<67108864);for(var L=0,w=0;w<this.length;w++){var C=(0|this.words[w])*b,S=(67108863&C)+(67108863&L);L>>=26,L+=C/67108864|0,L+=S>>>26,this.words[w]=67108863&S}return L!==0&&(this.words[w]=L,this.length++),this},e.prototype.muln=function(b){return this.clone().imuln(b)},e.prototype.sqr=function(){return this.mul(this)},e.prototype.isqr=function(){return this.imul(this.clone())},e.prototype.pow=function(b){var L=function(P){for(var z=new Array(P.bitLength()),F=0;F<z.length;F++){var q=F/26|0,W=F%26;z[F]=(P.words[q]&1<<W)>>>W}return z}(b);if(L.length===0)return new e(1);for(var w=this,C=0;C<L.length&&L[C]===0;C++,w=w.sqr());if(++C<L.length)for(var S=w.sqr();C<L.length;C++,S=S.sqr())L[C]!==0&&(w=w.mul(S));return w},e.prototype.iushln=function(b){p(typeof b=="number"&&b>=0);var L,w=b%26,C=(b-w)/26,S=67108863>>>26-w<<26-w;if(w!==0){var P=0;for(L=0;L<this.length;L++){var z=this.words[L]&S,F=(0|this.words[L])-z<<w;this.words[L]=F|P,P=z>>>26-w}P&&(this.words[L]=P,this.length++)}if(C!==0){for(L=this.length-1;L>=0;L--)this.words[L+C]=this.words[L];for(L=0;L<C;L++)this.words[L]=0;this.length+=C}return this.strip()},e.prototype.ishln=function(b){return p(this.negative===0),this.iushln(b)},e.prototype.iushrn=function(b,L,w){var C;p(typeof b=="number"&&b>=0),C=L?(L-L%26)/26:0;var S=b%26,P=Math.min((b-S)/26,this.length),z=67108863^67108863>>>S<<S,F=w;if(C-=P,C=Math.max(0,C),F){for(var q=0;q<P;q++)F.words[q]=this.words[q];F.length=P}if(P!==0)if(this.length>P)for(this.length-=P,q=0;q<this.length;q++)this.words[q]=this.words[q+P];else this.words[0]=0,this.length=1;var W=0;for(q=this.length-1;q>=0&&(W!==0||q>=C);q--){var X=0|this.words[q];this.words[q]=W<<26-S|X>>>S,W=X&z}return F&&W!==0&&(F.words[F.length++]=W),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},e.prototype.ishrn=function(b,L,w){return p(this.negative===0),this.iushrn(b,L,w)},e.prototype.shln=function(b){return this.clone().ishln(b)},e.prototype.ushln=function(b){return this.clone().iushln(b)},e.prototype.shrn=function(b){return this.clone().ishrn(b)},e.prototype.ushrn=function(b){return this.clone().iushrn(b)},e.prototype.testn=function(b){p(typeof b=="number"&&b>=0);var L=b%26,w=(b-L)/26,C=1<<L;return!(this.length<=w)&&!!(this.words[w]&C)},e.prototype.imaskn=function(b){p(typeof b=="number"&&b>=0);var L=b%26,w=(b-L)/26;if(p(this.negative===0,"imaskn works only with positive numbers"),this.length<=w)return this;if(L!==0&&w++,this.length=Math.min(w,this.length),L!==0){var C=67108863^67108863>>>L<<L;this.words[this.length-1]&=C}return this.strip()},e.prototype.maskn=function(b){return this.clone().imaskn(b)},e.prototype.iaddn=function(b){return p(typeof b=="number"),p(b<67108864),b<0?this.isubn(-b):this.negative!==0?this.length===1&&(0|this.words[0])<b?(this.words[0]=b-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(b),this.negative=1,this):this._iaddn(b)},e.prototype._iaddn=function(b){this.words[0]+=b;for(var L=0;L<this.length&&this.words[L]>=67108864;L++)this.words[L]-=67108864,L===this.length-1?this.words[L+1]=1:this.words[L+1]++;return this.length=Math.max(this.length,L+1),this},e.prototype.isubn=function(b){if(p(typeof b=="number"),p(b<67108864),b<0)return this.iaddn(-b);if(this.negative!==0)return this.negative=0,this.iaddn(b),this.negative=1,this;if(this.words[0]-=b,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var L=0;L<this.length&&this.words[L]<0;L++)this.words[L]+=67108864,this.words[L+1]-=1;return this.strip()},e.prototype.addn=function(b){return this.clone().iaddn(b)},e.prototype.subn=function(b){return this.clone().isubn(b)},e.prototype.iabs=function(){return this.negative=0,this},e.prototype.abs=function(){return this.clone().iabs()},e.prototype._ishlnsubmul=function(b,L,w){var C,S,P=b.length+w;this._expand(P);var z=0;for(C=0;C<b.length;C++){S=(0|this.words[C+w])+z;var F=(0|b.words[C])*L;z=((S-=67108863&F)>>26)-(F/67108864|0),this.words[C+w]=67108863&S}for(;C<this.length-w;C++)z=(S=(0|this.words[C+w])+z)>>26,this.words[C+w]=67108863&S;if(z===0)return this.strip();for(p(z===-1),z=0,C=0;C<this.length;C++)z=(S=-(0|this.words[C])+z)>>26,this.words[C]=67108863&S;return this.negative=1,this.strip()},e.prototype._wordDiv=function(b,L){var w=(this.length,b.length),C=this.clone(),S=b,P=0|S.words[S.length-1];(w=26-this._countBits(P))!==0&&(S=S.ushln(w),C.iushln(w),P=0|S.words[S.length-1]);var z,F=C.length-S.length;if(L!=="mod"){(z=new e(null)).length=F+1,z.words=new Array(z.length);for(var q=0;q<z.length;q++)z.words[q]=0}var W=C.clone()._ishlnsubmul(S,1,F);W.negative===0&&(C=W,z&&(z.words[F]=1));for(var X=F-1;X>=0;X--){var Q=67108864*(0|C.words[S.length+X])+(0|C.words[S.length+X-1]);for(Q=Math.min(Q/P|0,67108863),C._ishlnsubmul(S,Q,X);C.negative!==0;)Q--,C.negative=0,C._ishlnsubmul(S,1,X),C.isZero()||(C.negative^=1);z&&(z.words[X]=Q)}return z&&z.strip(),C.strip(),L!=="div"&&w!==0&&C.iushrn(w),{div:z||null,mod:C}},e.prototype.divmod=function(b,L,w){return p(!b.isZero()),this.isZero()?{div:new e(0),mod:new e(0)}:this.negative!==0&&b.negative===0?(P=this.neg().divmod(b,L),L!=="mod"&&(C=P.div.neg()),L!=="div"&&(S=P.mod.neg(),w&&S.negative!==0&&S.iadd(b)),{div:C,mod:S}):this.negative===0&&b.negative!==0?(P=this.divmod(b.neg(),L),L!=="mod"&&(C=P.div.neg()),{div:C,mod:P.mod}):this.negative&b.negative?(P=this.neg().divmod(b.neg(),L),L!=="div"&&(S=P.mod.neg(),w&&S.negative!==0&&S.isub(b)),{div:P.div,mod:S}):b.length>this.length||this.cmp(b)<0?{div:new e(0),mod:this}:b.length===1?L==="div"?{div:this.divn(b.words[0]),mod:null}:L==="mod"?{div:null,mod:new e(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new e(this.modn(b.words[0]))}:this._wordDiv(b,L);var C,S,P},e.prototype.div=function(b){return this.divmod(b,"div",!1).div},e.prototype.mod=function(b){return this.divmod(b,"mod",!1).mod},e.prototype.umod=function(b){return this.divmod(b,"mod",!0).mod},e.prototype.divRound=function(b){var L=this.divmod(b);if(L.mod.isZero())return L.div;var w=L.div.negative!==0?L.mod.isub(b):L.mod,C=b.ushrn(1),S=b.andln(1),P=w.cmp(C);return P<0||S===1&&P===0?L.div:L.div.negative!==0?L.div.isubn(1):L.div.iaddn(1)},e.prototype.modn=function(b){p(b<=67108863);for(var L=(1<<26)%b,w=0,C=this.length-1;C>=0;C--)w=(L*w+(0|this.words[C]))%b;return w},e.prototype.idivn=function(b){p(b<=67108863);for(var L=0,w=this.length-1;w>=0;w--){var C=(0|this.words[w])+67108864*L;this.words[w]=C/b|0,L=C%b}return this.strip()},e.prototype.divn=function(b){return this.clone().idivn(b)},e.prototype.egcd=function(b){p(b.negative===0),p(!b.isZero());var L=this,w=b.clone();L=L.negative!==0?L.umod(b):L.clone();for(var C=new e(1),S=new e(0),P=new e(0),z=new e(1),F=0;L.isEven()&&w.isEven();)L.iushrn(1),w.iushrn(1),++F;for(var q=w.clone(),W=L.clone();!L.isZero();){for(var X=0,Q=1;!(L.words[0]&Q)&&X<26;++X,Q<<=1);if(X>0)for(L.iushrn(X);X-- >0;)(C.isOdd()||S.isOdd())&&(C.iadd(q),S.isub(W)),C.iushrn(1),S.iushrn(1);for(var Z=0,Y=1;!(w.words[0]&Y)&&Z<26;++Z,Y<<=1);if(Z>0)for(w.iushrn(Z);Z-- >0;)(P.isOdd()||z.isOdd())&&(P.iadd(q),z.isub(W)),P.iushrn(1),z.iushrn(1);L.cmp(w)>=0?(L.isub(w),C.isub(P),S.isub(z)):(w.isub(L),P.isub(C),z.isub(S))}return{a:P,b:z,gcd:w.iushln(F)}},e.prototype._invmp=function(b){p(b.negative===0),p(!b.isZero());var L=this,w=b.clone();L=L.negative!==0?L.umod(b):L.clone();for(var C,S=new e(1),P=new e(0),z=w.clone();L.cmpn(1)>0&&w.cmpn(1)>0;){for(var F=0,q=1;!(L.words[0]&q)&&F<26;++F,q<<=1);if(F>0)for(L.iushrn(F);F-- >0;)S.isOdd()&&S.iadd(z),S.iushrn(1);for(var W=0,X=1;!(w.words[0]&X)&&W<26;++W,X<<=1);if(W>0)for(w.iushrn(W);W-- >0;)P.isOdd()&&P.iadd(z),P.iushrn(1);L.cmp(w)>=0?(L.isub(w),S.isub(P)):(w.isub(L),P.isub(S))}return(C=L.cmpn(1)===0?S:P).cmpn(0)<0&&C.iadd(b),C},e.prototype.gcd=function(b){if(this.isZero())return b.abs();if(b.isZero())return this.abs();var L=this.clone(),w=b.clone();L.negative=0,w.negative=0;for(var C=0;L.isEven()&&w.isEven();C++)L.iushrn(1),w.iushrn(1);for(;;){for(;L.isEven();)L.iushrn(1);for(;w.isEven();)w.iushrn(1);var S=L.cmp(w);if(S<0){var P=L;L=w,w=P}else if(S===0||w.cmpn(1)===0)break;L.isub(w)}return w.iushln(C)},e.prototype.invm=function(b){return this.egcd(b).a.umod(b)},e.prototype.isEven=function(){return(1&this.words[0])==0},e.prototype.isOdd=function(){return(1&this.words[0])==1},e.prototype.andln=function(b){return this.words[0]&b},e.prototype.bincn=function(b){p(typeof b=="number");var L=b%26,w=(b-L)/26,C=1<<L;if(this.length<=w)return this._expand(w+1),this.words[w]|=C,this;for(var S=C,P=w;S!==0&&P<this.length;P++){var z=0|this.words[P];S=(z+=S)>>>26,z&=67108863,this.words[P]=z}return S!==0&&(this.words[P]=S,this.length++),this},e.prototype.isZero=function(){return this.length===1&&this.words[0]===0},e.prototype.cmpn=function(b){var L,w=b<0;if(this.negative!==0&&!w)return-1;if(this.negative===0&&w)return 1;if(this.strip(),this.length>1)L=1;else{w&&(b=-b),p(b<=67108863,"Number is too big");var C=0|this.words[0];L=C===b?0:C<b?-1:1}return this.negative!==0?0|-L:L},e.prototype.cmp=function(b){if(this.negative!==0&&b.negative===0)return-1;if(this.negative===0&&b.negative!==0)return 1;var L=this.ucmp(b);return this.negative!==0?0|-L:L},e.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return-1;for(var L=0,w=this.length-1;w>=0;w--){var C=0|this.words[w],S=0|b.words[w];if(C!==S){C<S?L=-1:C>S&&(L=1);break}}return L},e.prototype.gtn=function(b){return this.cmpn(b)===1},e.prototype.gt=function(b){return this.cmp(b)===1},e.prototype.gten=function(b){return this.cmpn(b)>=0},e.prototype.gte=function(b){return this.cmp(b)>=0},e.prototype.ltn=function(b){return this.cmpn(b)===-1},e.prototype.lt=function(b){return this.cmp(b)===-1},e.prototype.lten=function(b){return this.cmpn(b)<=0},e.prototype.lte=function(b){return this.cmp(b)<=0},e.prototype.eqn=function(b){return this.cmpn(b)===0},e.prototype.eq=function(b){return this.cmp(b)===0},e.red=function(b){return new E(b)},e.prototype.toRed=function(b){return p(!this.red,"Already a number in reduction context"),p(this.negative===0,"red works only with positives"),b.convertTo(this)._forceRed(b)},e.prototype.fromRed=function(){return p(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},e.prototype._forceRed=function(b){return this.red=b,this},e.prototype.forceRed=function(b){return p(!this.red,"Already a number in reduction context"),this._forceRed(b)},e.prototype.redAdd=function(b){return p(this.red,"redAdd works only with red numbers"),this.red.add(this,b)},e.prototype.redIAdd=function(b){return p(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,b)},e.prototype.redSub=function(b){return p(this.red,"redSub works only with red numbers"),this.red.sub(this,b)},e.prototype.redISub=function(b){return p(this.red,"redISub works only with red numbers"),this.red.isub(this,b)},e.prototype.redShl=function(b){return p(this.red,"redShl works only with red numbers"),this.red.shl(this,b)},e.prototype.redMul=function(b){return p(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.mul(this,b)},e.prototype.redIMul=function(b){return p(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.imul(this,b)},e.prototype.redSqr=function(){return p(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},e.prototype.redISqr=function(){return p(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},e.prototype.redSqrt=function(){return p(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},e.prototype.redInvm=function(){return p(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},e.prototype.redNeg=function(){return p(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},e.prototype.redPow=function(b){return p(this.red&&!b.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,b)};var m={k256:null,p224:null,p192:null,p25519:null};function y(b,L){this.name=b,this.p=new e(L,16),this.n=this.p.bitLength(),this.k=new e(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){y.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function T(){y.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function _(){y.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function k(){y.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function E(b){if(typeof b=="string"){var L=e._prime(b);this.m=L.p,this.prime=L}else p(b.gtn(1),"modulus must be greater than 1"),this.m=b,this.prime=null}function A(b){E.call(this,b),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new e(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}y.prototype._tmp=function(){var b=new e(null);return b.words=new Array(Math.ceil(this.n/13)),b},y.prototype.ireduce=function(b){var L,w=b;do this.split(w,this.tmp),L=(w=(w=this.imulK(w)).iadd(this.tmp)).bitLength();while(L>this.n);var C=L<this.n?-1:w.ucmp(this.p);return C===0?(w.words[0]=0,w.length=1):C>0?w.isub(this.p):w.strip(),w},y.prototype.split=function(b,L){b.iushrn(this.n,0,L)},y.prototype.imulK=function(b){return b.imul(this.k)},u(v,y),v.prototype.split=function(b,L){for(var w=Math.min(b.length,9),C=0;C<w;C++)L.words[C]=b.words[C];if(L.length=w,b.length<=9)return b.words[0]=0,void(b.length=1);var S=b.words[9];for(L.words[L.length++]=4194303&S,C=10;C<b.length;C++){var P=0|b.words[C];b.words[C-10]=(4194303&P)<<4|S>>>22,S=P}S>>>=22,b.words[C-10]=S,S===0&&b.length>10?b.length-=10:b.length-=9},v.prototype.imulK=function(b){b.words[b.length]=0,b.words[b.length+1]=0,b.length+=2;for(var L=0,w=0;w<b.length;w++){var C=0|b.words[w];L+=977*C,b.words[w]=67108863&L,L=64*C+(L/67108864|0)}return b.words[b.length-1]===0&&(b.length--,b.words[b.length-1]===0&&b.length--),b},u(T,y),u(_,y),u(k,y),k.prototype.imulK=function(b){for(var L=0,w=0;w<b.length;w++){var C=19*(0|b.words[w])+L,S=67108863&C;C>>>=26,b.words[w]=S,L=C}return L!==0&&(b.words[b.length++]=L),b},e._prime=function(b){if(m[b])return m[b];var L;if(b==="k256")L=new v;else if(b==="p224")L=new T;else if(b==="p192")L=new _;else{if(b!=="p25519")throw new Error("Unknown prime "+b);L=new k}return m[b]=L,L},E.prototype._verify1=function(b){p(b.negative===0,"red works only with positives"),p(b.red,"red works only with red numbers")},E.prototype._verify2=function(b,L){p((b.negative|L.negative)==0,"red works only with positives"),p(b.red&&b.red===L.red,"red works only with red numbers")},E.prototype.imod=function(b){return this.prime?this.prime.ireduce(b)._forceRed(this):b.umod(this.m)._forceRed(this)},E.prototype.neg=function(b){return b.isZero()?b.clone():this.m.sub(b)._forceRed(this)},E.prototype.add=function(b,L){this._verify2(b,L);var w=b.add(L);return w.cmp(this.m)>=0&&w.isub(this.m),w._forceRed(this)},E.prototype.iadd=function(b,L){this._verify2(b,L);var w=b.iadd(L);return w.cmp(this.m)>=0&&w.isub(this.m),w},E.prototype.sub=function(b,L){this._verify2(b,L);var w=b.sub(L);return w.cmpn(0)<0&&w.iadd(this.m),w._forceRed(this)},E.prototype.isub=function(b,L){this._verify2(b,L);var w=b.isub(L);return w.cmpn(0)<0&&w.iadd(this.m),w},E.prototype.shl=function(b,L){return this._verify1(b),this.imod(b.ushln(L))},E.prototype.imul=function(b,L){return this._verify2(b,L),this.imod(b.imul(L))},E.prototype.mul=function(b,L){return this._verify2(b,L),this.imod(b.mul(L))},E.prototype.isqr=function(b){return this.imul(b,b.clone())},E.prototype.sqr=function(b){return this.mul(b,b)},E.prototype.sqrt=function(b){if(b.isZero())return b.clone();var L=this.m.andln(3);if(p(L%2==1),L===3){var w=this.m.add(new e(1)).iushrn(2);return this.pow(b,w)}for(var C=this.m.subn(1),S=0;!C.isZero()&&C.andln(1)===0;)S++,C.iushrn(1);p(!C.isZero());var P=new e(1).toRed(this),z=P.redNeg(),F=this.m.subn(1).iushrn(1),q=this.m.bitLength();for(q=new e(2*q*q).toRed(this);this.pow(q,F).cmp(z)!==0;)q.redIAdd(z);for(var W=this.pow(q,C),X=this.pow(b,C.addn(1).iushrn(1)),Q=this.pow(b,C),Z=S;Q.cmp(P)!==0;){for(var Y=Q,N=0;Y.cmp(P)!==0;N++)Y=Y.redSqr();p(N<Z);var J=this.pow(W,new e(1).iushln(Z-N-1));X=X.redMul(J),W=J.redSqr(),Q=Q.redMul(W),Z=N}return X},E.prototype.invm=function(b){var L=b._invmp(this.m);return L.negative!==0?(L.negative=0,this.imod(L).redNeg()):this.imod(L)},E.prototype.pow=function(b,L){if(L.isZero())return new e(1).toRed(this);if(L.cmpn(1)===0)return b.clone();var w=new Array(16);w[0]=new e(1).toRed(this),w[1]=b;for(var C=2;C<w.length;C++)w[C]=this.mul(w[C-1],b);var S=w[0],P=0,z=0,F=L.bitLength()%26;for(F===0&&(F=26),C=L.length-1;C>=0;C--){for(var q=L.words[C],W=F-1;W>=0;W--){var X=q>>W&1;S!==w[0]&&(S=this.sqr(S)),X!==0||P!==0?(P<<=1,P|=X,(++z===4||C===0&&W===0)&&(S=this.mul(S,w[P]),z=0,P=0)):z=0}F=26}return S},E.prototype.convertTo=function(b){var L=b.umod(this.m);return L===b?L.clone():L},E.prototype.convertFrom=function(b){var L=b.clone();return L.red=null,L},e.mont=function(b){return new A(b)},u(A,E),A.prototype.convertTo=function(b){return this.imod(b.ushln(this.shift))},A.prototype.convertFrom=function(b){var L=this.imod(b.mul(this.rinv));return L.red=null,L},A.prototype.imul=function(b,L){if(b.isZero()||L.isZero())return b.words[0]=0,b.length=1,b;var w=b.imul(L),C=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=w.isub(C).iushrn(this.shift),P=S;return S.cmp(this.m)>=0?P=S.isub(this.m):S.cmpn(0)<0&&(P=S.iadd(this.m)),P._forceRed(this)},A.prototype.mul=function(b,L){if(b.isZero()||L.isZero())return new e(0)._forceRed(this);var w=b.mul(L),C=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=w.isub(C).iushrn(this.shift),P=S;return S.cmp(this.m)>=0?P=S.isub(this.m):S.cmpn(0)<0&&(P=S.iadd(this.m)),P._forceRed(this)},A.prototype.invm=function(b){return this.imod(b._invmp(this.m).mul(this.r2))._forceRed(this)}})(B===void 0||B,this)},{buffer:115}],107:[function(i,B,V){B.exports=function(t){var h,p,u,e=t.length,l=0;for(h=0;h<e;++h)l+=t[h].length;var o=new Array(l),a=0;for(h=0;h<e;++h){var n=t[h],s=n.length;for(p=0;p<s;++p){var r=o[a++]=new Array(s-1),c=0;for(u=0;u<s;++u)u!==p&&(r[c++]=n[u]);if(1&p){var f=r[1];r[1]=r[0],r[0]=f}}}return o}},{}],108:[function(i,B,V){B.exports=function(r,c,f){switch(arguments.length){case 1:return n(r);case 2:return typeof c=="function"?o(r,r,c,!0):s(r,c);case 3:return o(r,c,f,!1);default:throw new Error("box-intersect: Invalid arguments")}};var t,h=i("typedarray-pool"),p=i("./lib/sweep"),u=i("./lib/intersect");function e(r,c){for(var f=0;f<r;++f)if(!(c[f]<=c[f+r]))return!0;return!1}function l(r,c,f,d){for(var g=0,m=0,y=0,v=r.length;y<v;++y){var T=r[y];if(!e(c,T)){for(var _=0;_<2*c;++_)f[g++]=T[_];d[m++]=y}}return m}function o(r,c,f,d){var g=r.length,m=c.length;if(!(g<=0||m<=0)){var y=r[0].length>>>1;if(!(y<=0)){var v,T=h.mallocDouble(2*y*g),_=h.mallocInt32(g);if((g=l(r,y,T,_))>0){if(y===1&&d)p.init(g),v=p.sweepComplete(y,f,0,g,T,_,0,g,T,_);else{var k=h.mallocDouble(2*y*m),E=h.mallocInt32(m);(m=l(c,y,k,E))>0&&(p.init(g+m),v=y===1?p.sweepBipartite(y,f,0,g,T,_,0,m,k,E):u(y,f,d,g,T,_,m,k,E),h.free(k),h.free(E))}h.free(T),h.free(_)}return v}}}function a(r,c){t.push([r,c])}function n(r){return t=[],o(r,r,a,!0),t}function s(r,c){return t=[],o(r,c,a,!1),t}},{"./lib/intersect":110,"./lib/sweep":114,"typedarray-pool":617}],109:[function(i,B,V){var t=["d","ax","vv","rs","re","rb","ri","bs","be","bb","bi"];function h(p){var u="bruteForce"+(p?"Full":"Partial"),e=[],l=t.slice();p||l.splice(3,0,"fp");var o=["function "+u+"("+l.join()+"){"];function a(s,r){var c=function(f,d,g){var m="bruteForce"+(f?"Red":"Blue")+(d?"Flip":"")+(g?"Full":""),y=["function ",m,"(",t.join(),"){","var ","es","=2*","d",";"],v="for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];",T="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(g?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";return f?y.push(v,"Q",":",T):y.push(T,"Q",":",v),g?y.push("if(y1<x0||x1<y0)continue;"):d?y.push("if(y0<=x0||x1<y0)continue;"):y.push("if(y0<x0||x1<y0)continue;"),y.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv("),d?y.push("yi,xi"):y.push("xi,yi"),y.push(");if(rv!==void 0)return rv;}}}"),{name:m,code:y.join("")}}(s,r,p);e.push(c.code),o.push("return "+c.name+"("+t.join()+");")}o.push("if(re-rs>be-bs){"),p?(a(!0,!1),o.push("}else{"),a(!1,!1)):(o.push("if(fp){"),a(!0,!0),o.push("}else{"),a(!0,!1),o.push("}}else{if(fp){"),a(!1,!0),o.push("}else{"),a(!1,!1),o.push("}")),o.push("}}return "+u);var n=e.join("")+o.join("");return new Function(n)()}V.partial=h(!1),V.full=h(!0)},{}],110:[function(i,B,V){B.exports=function(_,k,E,A,b,L,w,C,S){(function(Te,xe){var fe=8*h.log2(xe+1)*(Te+1)|0,ge=h.nextPow2(6*fe);g.length<ge&&(t.free(g),g=t.mallocInt32(ge));var ke=h.nextPow2(2*fe);m.length<ke&&(t.free(m),m=t.mallocDouble(ke))})(_,A+w);var P,z=0,F=2*_;for(y(z++,0,0,A,0,w,E?16:0,-1/0,1/0),E||y(z++,0,0,w,0,A,1,-1/0,1/0);z>0;){var q=6*(z-=1),W=g[q],X=g[q+1],Q=g[q+2],Z=g[q+3],Y=g[q+4],N=g[q+5],J=2*z,D=m[J],U=m[J+1],G=1&N,$=!!(16&N),K=b,re=L,ne=C,ae=S;if(G&&(K=C,re=S,ne=b,ae=L),!(2&N&&(Q=r(_,W,X,Q,K,re,U),X>=Q)||4&N&&(X=c(_,W,X,Q,K,re,D))>=Q)){var ie=Q-X,he=Y-Z;if($){if(_*ie*(ie+he)<1<<22){if((P=l.scanComplete(_,W,k,X,Q,K,re,Z,Y,ne,ae))!==void 0)return P;continue}}else{if(_*Math.min(ie,he)<128){if((P=u(_,W,k,G,X,Q,K,re,Z,Y,ne,ae))!==void 0)return P;continue}if(_*ie*he<1<<22){if((P=l.scanBipartite(_,W,k,G,X,Q,K,re,Z,Y,ne,ae))!==void 0)return P;continue}}var se=n(_,W,X,Q,K,re,D,U);if(X<se)if(_*(se-X)<128){if((P=e(_,W+1,k,X,se,K,re,Z,Y,ne,ae))!==void 0)return P}else if(W===_-2){if((P=G?l.sweepBipartite(_,k,Z,Y,ne,ae,X,se,K,re):l.sweepBipartite(_,k,X,se,K,re,Z,Y,ne,ae))!==void 0)return P}else y(z++,W+1,X,se,Z,Y,G,-1/0,1/0),y(z++,W+1,Z,Y,X,se,1^G,-1/0,1/0);if(se<Q){var de=o(_,W,Z,Y,ne,ae),ce=ne[F*de+W],ve=s(_,W,de,Y,ne,ae,ce);if(ve<Y&&y(z++,W,se,Q,ve,Y,(4|G)+($?16:0),ce,U),Z<de&&y(z++,W,se,Q,Z,de,(2|G)+($?16:0),D,ce),de+1===ve){if((P=$?T(_,W,k,se,Q,K,re,de,ne,ae[de]):v(_,W,k,G,se,Q,K,re,de,ne,ae[de]))!==void 0)return P}else if(de<ve){var Ee;if($){if(Ee=f(_,W,se,Q,K,re,ce),se<Ee){var Le=s(_,W,se,Ee,K,re,ce);if(W===_-2){if(se<Le&&(P=l.sweepComplete(_,k,se,Le,K,re,de,ve,ne,ae))!==void 0||Le<Ee&&(P=l.sweepBipartite(_,k,Le,Ee,K,re,de,ve,ne,ae))!==void 0)return P}else se<Le&&y(z++,W+1,se,Le,de,ve,16,-1/0,1/0),Le<Ee&&(y(z++,W+1,Le,Ee,de,ve,0,-1/0,1/0),y(z++,W+1,de,ve,Le,Ee,1,-1/0,1/0))}}else Ee=G?d(_,W,se,Q,K,re,ce):f(_,W,se,Q,K,re,ce),se<Ee&&(W===_-2?P=G?l.sweepBipartite(_,k,de,ve,ne,ae,se,Ee,K,re):l.sweepBipartite(_,k,se,Ee,K,re,de,ve,ne,ae):(y(z++,W+1,se,Ee,de,ve,G,-1/0,1/0),y(z++,W+1,de,ve,se,Ee,1^G,-1/0,1/0)))}}}}};var t=i("typedarray-pool"),h=i("bit-twiddle"),p=i("./brute"),u=p.partial,e=p.full,l=i("./sweep"),o=i("./median"),a=i("./partition"),n=a("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),s=a("lo===p0",["p0"]),r=a("lo<p0",["p0"]),c=a("hi<=p0",["p0"]),f=a("lo<=p0&&p0<=hi",["p0"]),d=a("lo<p0&&p0<=hi",["p0"]),g=t.mallocInt32(1024),m=t.mallocDouble(1024);function y(_,k,E,A,b,L,w,C,S){var P=6*_;g[P]=k,g[P+1]=E,g[P+2]=A,g[P+3]=b,g[P+4]=L,g[P+5]=w;var z=2*_;m[z]=C,m[z+1]=S}function v(_,k,E,A,b,L,w,C,S,P,z){var F=2*_,q=S*F,W=P[q+k];e:for(var X=b,Q=b*F;X<L;++X,Q+=F){var Z=w[Q+k],Y=w[Q+k+_];if(!(W<Z||Y<W)&&(!A||W!==Z)){for(var N,J=C[X],D=k+1;D<_;++D){Z=w[Q+D],Y=w[Q+D+_];var U=P[q+D],G=P[q+D+_];if(Y<U||G<Z)continue e}if((N=A?E(z,J):E(J,z))!==void 0)return N}}}function T(_,k,E,A,b,L,w,C,S,P){var z=2*_,F=C*z,q=S[F+k];e:for(var W=A,X=A*z;W<b;++W,X+=z){var Q=w[W];if(Q!==P){var Z=L[X+k],Y=L[X+k+_];if(!(q<Z||Y<q)){for(var N=k+1;N<_;++N){Z=L[X+N],Y=L[X+N+_];var J=S[F+N],D=S[F+N+_];if(Y<J||D<Z)continue e}var U=E(Q,P);if(U!==void 0)return U}}}}},{"./brute":109,"./median":111,"./partition":112,"./sweep":114,"bit-twiddle":104,"typedarray-pool":617}],111:[function(i,B,V){B.exports=function(p,u,e,l,o,a){if(l<=e+1)return e;for(var n=e,s=l,r=l+e>>>1,c=2*p,f=r,d=o[c*r+u];n<s;){if(s-n<8){h(p,u,n,s,o,a),d=o[c*r+u];break}var g=s-n,m=Math.random()*g+n|0,y=o[c*m+u],v=Math.random()*g+n|0,T=o[c*v+u],_=Math.random()*g+n|0,k=o[c*_+u];y<=T?k>=T?(f=v,d=T):y>=k?(f=m,d=y):(f=_,d=k):T>=k?(f=v,d=T):k>=y?(f=m,d=y):(f=_,d=k);for(var E=c*(s-1),A=c*f,b=0;b<c;++b,++E,++A){var L=o[E];o[E]=o[A],o[A]=L}var w=a[s-1];for(a[s-1]=a[f],a[f]=w,f=t(p,u,n,s-1,o,a,d),E=c*(s-1),A=c*f,b=0;b<c;++b,++E,++A)L=o[E],o[E]=o[A],o[A]=L;if(w=a[s-1],a[s-1]=a[f],a[f]=w,r<f){for(s=f-1;n<s&&o[c*(s-1)+u]===d;)s-=1;s+=1}else{if(!(f<r))break;for(n=f+1;n<s&&o[c*n+u]===d;)n+=1}}return t(p,u,e,r,o,a,o[c*r+u])};var t=i("./partition")("lo<p0",["p0"]);function h(p,u,e,l,o,a){for(var n=2*p,s=n*(e+1)+u,r=e+1;r<l;++r,s+=n)for(var c=o[s],f=r,d=n*(r-1);f>e&&o[d+u]>c;--f,d-=n){for(var g=d,m=d+n,y=0;y<n;++y,++g,++m){var v=o[g];o[g]=o[m],o[m]=v}var T=a[f];a[f]=a[f-1],a[f-1]=T}}},{"./partition":112}],112:[function(i,B,V){B.exports=function(t,h){var p="abcdef".split("").concat(h),u=[];return t.indexOf("lo")>=0&&u.push("lo=e[k+n]"),t.indexOf("hi")>=0&&u.push("hi=e[k+o]"),p.push("for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m".replace("_",u.join()).replace("$",t)),Function.apply(void 0,p)}},{}],113:[function(i,B,V){B.exports=function(a,n){n<=128?t(0,n-1,a):function s(r,c,f){var d=(c-r+1)/6|0,g=r+d,m=c-d,y=r+c>>1,v=y-d,T=y+d,_=g,k=v,E=y,A=T,b=m,L=r+1,w=c-1,C=0;l(_,k,f)&&(C=_,_=k,k=C),l(A,b,f)&&(C=A,A=b,b=C),l(_,E,f)&&(C=_,_=E,E=C),l(k,E,f)&&(C=k,k=E,E=C),l(_,A,f)&&(C=_,_=A,A=C),l(E,A,f)&&(C=E,E=A,A=C),l(k,b,f)&&(C=k,k=b,b=C),l(k,E,f)&&(C=k,k=E,E=C),l(A,b,f)&&(C=A,A=b,b=C);for(var S=f[2*k],P=f[2*k+1],z=f[2*A],F=f[2*A+1],q=2*_,W=2*E,X=2*b,Q=2*g,Z=2*y,Y=2*m,N=0;N<2;++N){var J=f[q+N],D=f[W+N],U=f[X+N];f[Q+N]=J,f[Z+N]=D,f[Y+N]=U}p(v,r,f),p(T,c,f);for(var G=L;G<=w;++G)if(o(G,S,P,f))G!==L&&h(G,L,f),++L;else if(!o(G,z,F,f))for(;;){if(o(w,z,F,f)){o(w,S,P,f)?(u(G,L,w,f),++L,--w):(h(G,w,f),--w);break}if(--w<G)break}e(r,L-1,S,P,f),e(c,w+1,z,F,f),L-2-r<=32?t(r,L-2,f):s(r,L-2,f),c-(w+2)<=32?t(w+2,c,f):s(w+2,c,f),w-L<=32?t(L,w,f):s(L,w,f)}(0,n-1,a)};function t(a,n,s){for(var r=2*(a+1),c=a+1;c<=n;++c){for(var f=s[r++],d=s[r++],g=c,m=r-2;g-- >a;){var y=s[m-2],v=s[m-1];if(y<f||y===f&&v<d)break;s[m]=y,s[m+1]=v,m-=2}s[m]=f,s[m+1]=d}}function h(a,n,s){n*=2;var r=s[a*=2],c=s[a+1];s[a]=s[n],s[a+1]=s[n+1],s[n]=r,s[n+1]=c}function p(a,n,s){n*=2,s[a*=2]=s[n],s[a+1]=s[n+1]}function u(a,n,s,r){n*=2,s*=2;var c=r[a*=2],f=r[a+1];r[a]=r[n],r[a+1]=r[n+1],r[n]=r[s],r[n+1]=r[s+1],r[s]=c,r[s+1]=f}function e(a,n,s,r,c){n*=2,c[a*=2]=c[n],c[n]=s,c[a+1]=c[n+1],c[n+1]=r}function l(a,n,s){n*=2;var r=s[a*=2],c=s[n];return!(r<c)&&(r!==c||s[a+1]>s[n+1])}function o(a,n,s,r){var c=r[a*=2];return c<n||c===n&&r[a+1]<s}},{}],114:[function(i,B,V){B.exports={init:function(f){var d=h.nextPow2(f);u.length<d&&(t.free(u),u=t.mallocInt32(d)),e.length<d&&(t.free(e),e=t.mallocInt32(d)),l.length<d&&(t.free(l),l=t.mallocInt32(d)),o.length<d&&(t.free(o),o=t.mallocInt32(d)),a.length<d&&(t.free(a),a=t.mallocInt32(d)),n.length<d&&(t.free(n),n=t.mallocInt32(d));var g=8*d;s.length<g&&(t.free(s),s=t.mallocDouble(g))},sweepBipartite:function(f,d,g,m,y,v,T,_,k,E){for(var A=0,b=2*f,L=f-1,w=b-1,C=g;C<m;++C){var S=v[C],P=b*C;s[A++]=y[P+L],s[A++]=-(S+1),s[A++]=y[P+w],s[A++]=S}for(C=T;C<_;++C){S=E[C]+(1<<28);var z=b*C;s[A++]=k[z+L],s[A++]=-S,s[A++]=k[z+w],s[A++]=S}var F=A>>>1;p(s,F);var q=0,W=0;for(C=0;C<F;++C){var X=0|s[2*C+1];if(X>=1<<28)r(l,o,W--,X=X-(1<<28)|0);else if(X>=0)r(u,e,q--,X);else if(X<=-(1<<28)){X=-X-(1<<28)|0;for(var Q=0;Q<q;++Q)if((Z=d(u[Q],X))!==void 0)return Z;c(l,o,W++,X)}else{for(X=-X-1|0,Q=0;Q<W;++Q){var Z;if((Z=d(X,l[Q]))!==void 0)return Z}c(u,e,q++,X)}}},sweepComplete:function(f,d,g,m,y,v,T,_,k,E){for(var A=0,b=2*f,L=f-1,w=b-1,C=g;C<m;++C){var S=v[C]+1<<1,P=b*C;s[A++]=y[P+L],s[A++]=-S,s[A++]=y[P+w],s[A++]=S}for(C=T;C<_;++C){S=E[C]+1<<1;var z=b*C;s[A++]=k[z+L],s[A++]=1|-S,s[A++]=k[z+w],s[A++]=1|S}var F=A>>>1;p(s,F);var q=0,W=0,X=0;for(C=0;C<F;++C){var Q=0|s[2*C+1],Z=1&Q;if(C<F-1&&Q>>1==s[2*C+3]>>1&&(Z=2,C+=1),Q<0){for(var Y=-(Q>>1)-1,N=0;N<X;++N)if((J=d(a[N],Y))!==void 0)return J;if(Z!==0){for(N=0;N<q;++N)if((J=d(u[N],Y))!==void 0)return J}if(Z!==1)for(N=0;N<W;++N){var J;if((J=d(l[N],Y))!==void 0)return J}Z===0?c(u,e,q++,Y):Z===1?c(l,o,W++,Y):Z===2&&c(a,n,X++,Y)}else Y=(Q>>1)-1,Z===0?r(u,e,q--,Y):Z===1?r(l,o,W--,Y):Z===2&&r(a,n,X--,Y)}},scanBipartite:function(f,d,g,m,y,v,T,_,k,E,A,b){var L=0,w=2*f,C=d,S=d+f,P=1,z=1;m?z=1<<28:P=1<<28;for(var F=y;F<v;++F){var q=F+P,W=w*F;s[L++]=T[W+C],s[L++]=-q,s[L++]=T[W+S],s[L++]=q}for(F=k;F<E;++F){q=F+z;var X=w*F;s[L++]=A[X+C],s[L++]=-q}var Q=L>>>1;p(s,Q);var Z=0;for(F=0;F<Q;++F){var Y=0|s[2*F+1];if(Y<0){var N=!1;if((q=-Y)>=1<<28?(N=!m,q-=1<<28):(N=!!m,q-=1),N)c(u,e,Z++,q);else{var J=b[q],D=w*q,U=A[D+d+1],G=A[D+d+1+f];e:for(var $=0;$<Z;++$){var K=u[$],re=w*K;if(!(G<T[re+d+1]||T[re+d+1+f]<U)){for(var ne=d+2;ne<f;++ne)if(A[D+ne+f]<T[re+ne]||T[re+ne+f]<A[D+ne])continue e;var ae,ie=_[K];if((ae=m?g(J,ie):g(ie,J))!==void 0)return ae}}}}else r(u,e,Z--,Y-P)}},scanComplete:function(f,d,g,m,y,v,T,_,k,E,A){for(var b=0,L=2*f,w=d,C=d+f,S=m;S<y;++S){var P=S+268435456,z=L*S;s[b++]=v[z+w],s[b++]=-P,s[b++]=v[z+C],s[b++]=P}for(S=_;S<k;++S){P=S+1;var F=L*S;s[b++]=E[F+w],s[b++]=-P}var q=b>>>1;p(s,q);var W=0;for(S=0;S<q;++S){var X=0|s[2*S+1];if(X<0)if((P=-X)>=1<<28)u[W++]=P-(1<<28);else{var Q=A[P-=1],Z=L*P,Y=E[Z+d+1],N=E[Z+d+1+f];e:for(var J=0;J<W;++J){var D=u[J],U=T[D];if(U===Q)break;var G=L*D;if(!(N<v[G+d+1]||v[G+d+1+f]<Y)){for(var $=d+2;$<f;++$)if(E[Z+$+f]<v[G+$]||v[G+$+f]<E[Z+$])continue e;var K=g(U,Q);if(K!==void 0)return K}}}else{for(P=X-(1<<28),J=W-1;J>=0;--J)if(u[J]===P){for($=J+1;$<W;++$)u[$-1]=u[$];break}--W}}}};var t=i("typedarray-pool"),h=i("bit-twiddle"),p=i("./sort"),u=t.mallocInt32(1024),e=t.mallocInt32(1024),l=t.mallocInt32(1024),o=t.mallocInt32(1024),a=t.mallocInt32(1024),n=t.mallocInt32(1024),s=t.mallocDouble(8192);function r(f,d,g,m){var y=d[m],v=f[g-1];f[y]=v,d[v]=y}function c(f,d,g,m){f[g]=m,d[m]=g}},{"./sort":113,"bit-twiddle":104,"typedarray-pool":617}],115:[function(i,B,V){},{}],116:[function(i,B,V){var t,h=typeof Reflect=="object"?Reflect:null,p=h&&typeof h.apply=="function"?h.apply:function(g,m,y){return Function.prototype.apply.call(g,m,y)};t=h&&typeof h.ownKeys=="function"?h.ownKeys:Object.getOwnPropertySymbols?function(g){return Object.getOwnPropertyNames(g).concat(Object.getOwnPropertySymbols(g))}:function(g){return Object.getOwnPropertyNames(g)};var u=Number.isNaN||function(g){return g!=g};function e(){e.init.call(this)}B.exports=e,B.exports.once=function(g,m){return new Promise(function(y,v){function T(){_!==void 0&&g.removeListener("error",_),y([].slice.call(arguments))}var _;m!=="error"&&(_=function(k){g.removeListener(m,T),v(k)},g.once("error",_)),g.once(m,T)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var l=10;function o(g){if(typeof g!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof g)}function a(g){return g._maxListeners===void 0?e.defaultMaxListeners:g._maxListeners}function n(g,m,y,v){var T,_,k,E;if(o(y),(_=g._events)===void 0?(_=g._events=Object.create(null),g._eventsCount=0):(_.newListener!==void 0&&(g.emit("newListener",m,y.listener?y.listener:y),_=g._events),k=_[m]),k===void 0)k=_[m]=y,++g._eventsCount;else if(typeof k=="function"?k=_[m]=v?[y,k]:[k,y]:v?k.unshift(y):k.push(y),(T=a(g))>0&&k.length>T&&!k.warned){k.warned=!0;var A=new Error("Possible EventEmitter memory leak detected. "+k.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");A.name="MaxListenersExceededWarning",A.emitter=g,A.type=m,A.count=k.length,E=A,console&&console.warn&&console.warn(E)}return g}function s(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r(g,m,y){var v={fired:!1,wrapFn:void 0,target:g,type:m,listener:y},T=s.bind(v);return T.listener=y,v.wrapFn=T,T}function c(g,m,y){var v=g._events;if(v===void 0)return[];var T=v[m];return T===void 0?[]:typeof T=="function"?y?[T.listener||T]:[T]:y?function(_){for(var k=new Array(_.length),E=0;E<k.length;++E)k[E]=_[E].listener||_[E];return k}(T):d(T,T.length)}function f(g){var m=this._events;if(m!==void 0){var y=m[g];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}function d(g,m){for(var y=new Array(m),v=0;v<m;++v)y[v]=g[v];return y}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(g){if(typeof g!="number"||g<0||u(g))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+g+".");l=g}}),e.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(g){if(typeof g!="number"||g<0||u(g))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+g+".");return this._maxListeners=g,this},e.prototype.getMaxListeners=function(){return a(this)},e.prototype.emit=function(g){for(var m=[],y=1;y<arguments.length;y++)m.push(arguments[y]);var v=g==="error",T=this._events;if(T!==void 0)v=v&&T.error===void 0;else if(!v)return!1;if(v){var _;if(m.length>0&&(_=m[0]),_ instanceof Error)throw _;var k=new Error("Unhandled error."+(_?" ("+_.message+")":""));throw k.context=_,k}var E=T[g];if(E===void 0)return!1;if(typeof E=="function")p(E,this,m);else{var A=E.length,b=d(E,A);for(y=0;y<A;++y)p(b[y],this,m)}return!0},e.prototype.addListener=function(g,m){return n(this,g,m,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(g,m){return n(this,g,m,!0)},e.prototype.once=function(g,m){return o(m),this.on(g,r(this,g,m)),this},e.prototype.prependOnceListener=function(g,m){return o(m),this.prependListener(g,r(this,g,m)),this},e.prototype.removeListener=function(g,m){var y,v,T,_,k;if(o(m),(v=this._events)===void 0)return this;if((y=v[g])===void 0)return this;if(y===m||y.listener===m)--this._eventsCount==0?this._events=Object.create(null):(delete v[g],v.removeListener&&this.emit("removeListener",g,y.listener||m));else if(typeof y!="function"){for(T=-1,_=y.length-1;_>=0;_--)if(y[_]===m||y[_].listener===m){k=y[_].listener,T=_;break}if(T<0)return this;T===0?y.shift():function(E,A){for(;A+1<E.length;A++)E[A]=E[A+1];E.pop()}(y,T),y.length===1&&(v[g]=y[0]),v.removeListener!==void 0&&this.emit("removeListener",g,k||m)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(g){var m,y,v;if((y=this._events)===void 0)return this;if(y.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):y[g]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete y[g]),this;if(arguments.length===0){var T,_=Object.keys(y);for(v=0;v<_.length;++v)(T=_[v])!=="removeListener"&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(m=y[g])=="function")this.removeListener(g,m);else if(m!==void 0)for(v=m.length-1;v>=0;v--)this.removeListener(g,m[v]);return this},e.prototype.listeners=function(g){return c(this,g,!0)},e.prototype.rawListeners=function(g){return c(this,g,!1)},e.listenerCount=function(g,m){return typeof g.listenerCount=="function"?g.listenerCount(m):f.call(g,m)},e.prototype.listenerCount=f,e.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},{}],117:[function(i,B,V){(function(t){(function(){var h=i("base64-js"),p=i("ieee754");V.Buffer=e,V.SlowBuffer=function(D){return+D!=D&&(D=0),e.alloc(+D)},V.INSPECT_MAX_BYTES=50;function u(D){if(D>2147483647)throw new RangeError('The value "'+D+'" is invalid for option "size"');var U=new Uint8Array(D);return U.__proto__=e.prototype,U}function e(D,U,G){if(typeof D=="number"){if(typeof U=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return a(D)}return l(D,U,G)}function l(D,U,G){if(typeof D=="string")return function(re,ne){if(typeof ne=="string"&&ne!==""||(ne="utf8"),!e.isEncoding(ne))throw new TypeError("Unknown encoding: "+ne);var ae=0|r(re,ne),ie=u(ae),he=ie.write(re,ne);return he!==ae&&(ie=ie.slice(0,he)),ie}(D,U);if(ArrayBuffer.isView(D))return n(D);if(D==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof D);if(N(D,ArrayBuffer)||D&&N(D.buffer,ArrayBuffer))return function(re,ne,ae){if(ne<0||re.byteLength<ne)throw new RangeError('"offset" is outside of buffer bounds');if(re.byteLength<ne+(ae||0))throw new RangeError('"length" is outside of buffer bounds');var ie;return ie=ne===void 0&&ae===void 0?new Uint8Array(re):ae===void 0?new Uint8Array(re,ne):new Uint8Array(re,ne,ae),ie.__proto__=e.prototype,ie}(D,U,G);if(typeof D=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var $=D.valueOf&&D.valueOf();if($!=null&&$!==D)return e.from($,U,G);var K=function(re){if(e.isBuffer(re)){var ne=0|s(re.length),ae=u(ne);return ae.length===0||re.copy(ae,0,0,ne),ae}if(re.length!==void 0)return typeof re.length!="number"||J(re.length)?u(0):n(re);if(re.type==="Buffer"&&Array.isArray(re.data))return n(re.data)}(D);if(K)return K;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof D[Symbol.toPrimitive]=="function")return e.from(D[Symbol.toPrimitive]("string"),U,G);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof D)}function o(D){if(typeof D!="number")throw new TypeError('"size" argument must be of type number');if(D<0)throw new RangeError('The value "'+D+'" is invalid for option "size"')}function a(D){return o(D),u(D<0?0:0|s(D))}function n(D){for(var U=D.length<0?0:0|s(D.length),G=u(U),$=0;$<U;$+=1)G[$]=255&D[$];return G}function s(D){if(D>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|D}function r(D,U){if(e.isBuffer(D))return D.length;if(ArrayBuffer.isView(D)||N(D,ArrayBuffer))return D.byteLength;if(typeof D!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof D);var G=D.length,$=arguments.length>2&&arguments[2]===!0;if(!$&&G===0)return 0;for(var K=!1;;)switch(U){case"ascii":case"latin1":case"binary":return G;case"utf8":case"utf-8":return Q(D).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*G;case"hex":return G>>>1;case"base64":return Z(D).length;default:if(K)return $?-1:Q(D).length;U=(""+U).toLowerCase(),K=!0}}function c(D,U,G){var $=!1;if((U===void 0||U<0)&&(U=0),U>this.length||((G===void 0||G>this.length)&&(G=this.length),G<=0)||(G>>>=0)<=(U>>>=0))return"";for(D||(D="utf8");;)switch(D){case"hex":return w(this,U,G);case"utf8":case"utf-8":return A(this,U,G);case"ascii":return b(this,U,G);case"latin1":case"binary":return L(this,U,G);case"base64":return E(this,U,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,U,G);default:if($)throw new TypeError("Unknown encoding: "+D);D=(D+"").toLowerCase(),$=!0}}function f(D,U,G){var $=D[U];D[U]=D[G],D[G]=$}function d(D,U,G,$,K){if(D.length===0)return-1;if(typeof G=="string"?($=G,G=0):G>2147483647?G=2147483647:G<-2147483648&&(G=-2147483648),J(G=+G)&&(G=K?0:D.length-1),G<0&&(G=D.length+G),G>=D.length){if(K)return-1;G=D.length-1}else if(G<0){if(!K)return-1;G=0}if(typeof U=="string"&&(U=e.from(U,$)),e.isBuffer(U))return U.length===0?-1:g(D,U,G,$,K);if(typeof U=="number")return U&=255,typeof Uint8Array.prototype.indexOf=="function"?K?Uint8Array.prototype.indexOf.call(D,U,G):Uint8Array.prototype.lastIndexOf.call(D,U,G):g(D,[U],G,$,K);throw new TypeError("val must be string, number or Buffer")}function g(D,U,G,$,K){var re,ne=1,ae=D.length,ie=U.length;if($!==void 0&&(($=String($).toLowerCase())==="ucs2"||$==="ucs-2"||$==="utf16le"||$==="utf-16le")){if(D.length<2||U.length<2)return-1;ne=2,ae/=2,ie/=2,G/=2}function he(ve,Ee){return ne===1?ve[Ee]:ve.readUInt16BE(Ee*ne)}if(K){var se=-1;for(re=G;re<ae;re++)if(he(D,re)===he(U,se===-1?0:re-se)){if(se===-1&&(se=re),re-se+1===ie)return se*ne}else se!==-1&&(re-=re-se),se=-1}else for(G+ie>ae&&(G=ae-ie),re=G;re>=0;re--){for(var de=!0,ce=0;ce<ie;ce++)if(he(D,re+ce)!==he(U,ce)){de=!1;break}if(de)return re}return-1}function m(D,U,G,$){G=Number(G)||0;var K=D.length-G;$?($=Number($))>K&&($=K):$=K;var re=U.length;$>re/2&&($=re/2);for(var ne=0;ne<$;++ne){var ae=parseInt(U.substr(2*ne,2),16);if(J(ae))return ne;D[G+ne]=ae}return ne}function y(D,U,G,$){return Y(Q(U,D.length-G),D,G,$)}function v(D,U,G,$){return Y(function(K){for(var re=[],ne=0;ne<K.length;++ne)re.push(255&K.charCodeAt(ne));return re}(U),D,G,$)}function T(D,U,G,$){return v(D,U,G,$)}function _(D,U,G,$){return Y(Z(U),D,G,$)}function k(D,U,G,$){return Y(function(K,re){for(var ne,ae,ie,he=[],se=0;se<K.length&&!((re-=2)<0);++se)ne=K.charCodeAt(se),ae=ne>>8,ie=ne%256,he.push(ie),he.push(ae);return he}(U,D.length-G),D,G,$)}function E(D,U,G){return U===0&&G===D.length?h.fromByteArray(D):h.fromByteArray(D.slice(U,G))}function A(D,U,G){G=Math.min(D.length,G);for(var $=[],K=U;K<G;){var re,ne,ae,ie,he=D[K],se=null,de=he>239?4:he>223?3:he>191?2:1;if(K+de<=G)switch(de){case 1:he<128&&(se=he);break;case 2:(192&(re=D[K+1]))==128&&(ie=(31&he)<<6|63&re)>127&&(se=ie);break;case 3:re=D[K+1],ne=D[K+2],(192&re)==128&&(192&ne)==128&&(ie=(15&he)<<12|(63&re)<<6|63&ne)>2047&&(ie<55296||ie>57343)&&(se=ie);break;case 4:re=D[K+1],ne=D[K+2],ae=D[K+3],(192&re)==128&&(192&ne)==128&&(192&ae)==128&&(ie=(15&he)<<18|(63&re)<<12|(63&ne)<<6|63&ae)>65535&&ie<1114112&&(se=ie)}se===null?(se=65533,de=1):se>65535&&(se-=65536,$.push(se>>>10&1023|55296),se=56320|1023&se),$.push(se),K+=de}return function(ce){var ve=ce.length;if(ve<=4096)return String.fromCharCode.apply(String,ce);for(var Ee="",Le=0;Le<ve;)Ee+=String.fromCharCode.apply(String,ce.slice(Le,Le+=4096));return Ee}($)}V.kMaxLength=2147483647,e.TYPED_ARRAY_SUPPORT=function(){try{var D=new Uint8Array(1);return D.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},D.foo()===42}catch{return!1}}(),e.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(D,U,G){return l(D,U,G)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(D,U,G){return function($,K,re){return o($),$<=0?u($):K!==void 0?typeof re=="string"?u($).fill(K,re):u($).fill(K):u($)}(D,U,G)},e.allocUnsafe=function(D){return a(D)},e.allocUnsafeSlow=function(D){return a(D)},e.isBuffer=function(D){return D!=null&&D._isBuffer===!0&&D!==e.prototype},e.compare=function(D,U){if(N(D,Uint8Array)&&(D=e.from(D,D.offset,D.byteLength)),N(U,Uint8Array)&&(U=e.from(U,U.offset,U.byteLength)),!e.isBuffer(D)||!e.isBuffer(U))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(D===U)return 0;for(var G=D.length,$=U.length,K=0,re=Math.min(G,$);K<re;++K)if(D[K]!==U[K]){G=D[K],$=U[K];break}return G<$?-1:$<G?1:0},e.isEncoding=function(D){switch(String(D).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(D,U){if(!Array.isArray(D))throw new TypeError('"list" argument must be an Array of Buffers');if(D.length===0)return e.alloc(0);var G;if(U===void 0)for(U=0,G=0;G<D.length;++G)U+=D[G].length;var $=e.allocUnsafe(U),K=0;for(G=0;G<D.length;++G){var re=D[G];if(N(re,Uint8Array)&&(re=e.from(re)),!e.isBuffer(re))throw new TypeError('"list" argument must be an Array of Buffers');re.copy($,K),K+=re.length}return $},e.byteLength=r,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var D=this.length;if(D%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var U=0;U<D;U+=2)f(this,U,U+1);return this},e.prototype.swap32=function(){var D=this.length;if(D%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var U=0;U<D;U+=4)f(this,U,U+3),f(this,U+1,U+2);return this},e.prototype.swap64=function(){var D=this.length;if(D%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var U=0;U<D;U+=8)f(this,U,U+7),f(this,U+1,U+6),f(this,U+2,U+5),f(this,U+3,U+4);return this},e.prototype.toString=function(){var D=this.length;return D===0?"":arguments.length===0?A(this,0,D):c.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(D){if(!e.isBuffer(D))throw new TypeError("Argument must be a Buffer");return this===D||e.compare(this,D)===0},e.prototype.inspect=function(){var D="",U=V.INSPECT_MAX_BYTES;return D=this.toString("hex",0,U).replace(/(.{2})/g,"$1 ").trim(),this.length>U&&(D+=" ... "),"<Buffer "+D+">"},e.prototype.compare=function(D,U,G,$,K){if(N(D,Uint8Array)&&(D=e.from(D,D.offset,D.byteLength)),!e.isBuffer(D))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof D);if(U===void 0&&(U=0),G===void 0&&(G=D?D.length:0),$===void 0&&($=0),K===void 0&&(K=this.length),U<0||G>D.length||$<0||K>this.length)throw new RangeError("out of range index");if($>=K&&U>=G)return 0;if($>=K)return-1;if(U>=G)return 1;if(this===D)return 0;for(var re=(K>>>=0)-($>>>=0),ne=(G>>>=0)-(U>>>=0),ae=Math.min(re,ne),ie=this.slice($,K),he=D.slice(U,G),se=0;se<ae;++se)if(ie[se]!==he[se]){re=ie[se],ne=he[se];break}return re<ne?-1:ne<re?1:0},e.prototype.includes=function(D,U,G){return this.indexOf(D,U,G)!==-1},e.prototype.indexOf=function(D,U,G){return d(this,D,U,G,!0)},e.prototype.lastIndexOf=function(D,U,G){return d(this,D,U,G,!1)},e.prototype.write=function(D,U,G,$){if(U===void 0)$="utf8",G=this.length,U=0;else if(G===void 0&&typeof U=="string")$=U,G=this.length,U=0;else{if(!isFinite(U))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");U>>>=0,isFinite(G)?(G>>>=0,$===void 0&&($="utf8")):($=G,G=void 0)}var K=this.length-U;if((G===void 0||G>K)&&(G=K),D.length>0&&(G<0||U<0)||U>this.length)throw new RangeError("Attempt to write outside buffer bounds");$||($="utf8");for(var re=!1;;)switch($){case"hex":return m(this,D,U,G);case"utf8":case"utf-8":return y(this,D,U,G);case"ascii":return v(this,D,U,G);case"latin1":case"binary":return T(this,D,U,G);case"base64":return _(this,D,U,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,D,U,G);default:if(re)throw new TypeError("Unknown encoding: "+$);$=(""+$).toLowerCase(),re=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function b(D,U,G){var $="";G=Math.min(D.length,G);for(var K=U;K<G;++K)$+=String.fromCharCode(127&D[K]);return $}function L(D,U,G){var $="";G=Math.min(D.length,G);for(var K=U;K<G;++K)$+=String.fromCharCode(D[K]);return $}function w(D,U,G){var $=D.length;(!U||U<0)&&(U=0),(!G||G<0||G>$)&&(G=$);for(var K="",re=U;re<G;++re)K+=X(D[re]);return K}function C(D,U,G){for(var $=D.slice(U,G),K="",re=0;re<$.length;re+=2)K+=String.fromCharCode($[re]+256*$[re+1]);return K}function S(D,U,G){if(D%1!=0||D<0)throw new RangeError("offset is not uint");if(D+U>G)throw new RangeError("Trying to access beyond buffer length")}function P(D,U,G,$,K,re){if(!e.isBuffer(D))throw new TypeError('"buffer" argument must be a Buffer instance');if(U>K||U<re)throw new RangeError('"value" argument is out of bounds');if(G+$>D.length)throw new RangeError("Index out of range")}function z(D,U,G,$,K,re){if(G+$>D.length)throw new RangeError("Index out of range");if(G<0)throw new RangeError("Index out of range")}function F(D,U,G,$,K){return U=+U,G>>>=0,K||z(D,0,G,4),p.write(D,U,G,$,23,4),G+4}function q(D,U,G,$,K){return U=+U,G>>>=0,K||z(D,0,G,8),p.write(D,U,G,$,52,8),G+8}e.prototype.slice=function(D,U){var G=this.length;(D=~~D)<0?(D+=G)<0&&(D=0):D>G&&(D=G),(U=U===void 0?G:~~U)<0?(U+=G)<0&&(U=0):U>G&&(U=G),U<D&&(U=D);var $=this.subarray(D,U);return $.__proto__=e.prototype,$},e.prototype.readUIntLE=function(D,U,G){D>>>=0,U>>>=0,G||S(D,U,this.length);for(var $=this[D],K=1,re=0;++re<U&&(K*=256);)$+=this[D+re]*K;return $},e.prototype.readUIntBE=function(D,U,G){D>>>=0,U>>>=0,G||S(D,U,this.length);for(var $=this[D+--U],K=1;U>0&&(K*=256);)$+=this[D+--U]*K;return $},e.prototype.readUInt8=function(D,U){return D>>>=0,U||S(D,1,this.length),this[D]},e.prototype.readUInt16LE=function(D,U){return D>>>=0,U||S(D,2,this.length),this[D]|this[D+1]<<8},e.prototype.readUInt16BE=function(D,U){return D>>>=0,U||S(D,2,this.length),this[D]<<8|this[D+1]},e.prototype.readUInt32LE=function(D,U){return D>>>=0,U||S(D,4,this.length),(this[D]|this[D+1]<<8|this[D+2]<<16)+16777216*this[D+3]},e.prototype.readUInt32BE=function(D,U){return D>>>=0,U||S(D,4,this.length),16777216*this[D]+(this[D+1]<<16|this[D+2]<<8|this[D+3])},e.prototype.readIntLE=function(D,U,G){D>>>=0,U>>>=0,G||S(D,U,this.length);for(var $=this[D],K=1,re=0;++re<U&&(K*=256);)$+=this[D+re]*K;return $>=(K*=128)&&($-=Math.pow(2,8*U)),$},e.prototype.readIntBE=function(D,U,G){D>>>=0,U>>>=0,G||S(D,U,this.length);for(var $=U,K=1,re=this[D+--$];$>0&&(K*=256);)re+=this[D+--$]*K;return re>=(K*=128)&&(re-=Math.pow(2,8*U)),re},e.prototype.readInt8=function(D,U){return D>>>=0,U||S(D,1,this.length),128&this[D]?-1*(255-this[D]+1):this[D]},e.prototype.readInt16LE=function(D,U){D>>>=0,U||S(D,2,this.length);var G=this[D]|this[D+1]<<8;return 32768&G?4294901760|G:G},e.prototype.readInt16BE=function(D,U){D>>>=0,U||S(D,2,this.length);var G=this[D+1]|this[D]<<8;return 32768&G?4294901760|G:G},e.prototype.readInt32LE=function(D,U){return D>>>=0,U||S(D,4,this.length),this[D]|this[D+1]<<8|this[D+2]<<16|this[D+3]<<24},e.prototype.readInt32BE=function(D,U){return D>>>=0,U||S(D,4,this.length),this[D]<<24|this[D+1]<<16|this[D+2]<<8|this[D+3]},e.prototype.readFloatLE=function(D,U){return D>>>=0,U||S(D,4,this.length),p.read(this,D,!0,23,4)},e.prototype.readFloatBE=function(D,U){return D>>>=0,U||S(D,4,this.length),p.read(this,D,!1,23,4)},e.prototype.readDoubleLE=function(D,U){return D>>>=0,U||S(D,8,this.length),p.read(this,D,!0,52,8)},e.prototype.readDoubleBE=function(D,U){return D>>>=0,U||S(D,8,this.length),p.read(this,D,!1,52,8)},e.prototype.writeUIntLE=function(D,U,G,$){D=+D,U>>>=0,G>>>=0,$||P(this,D,U,G,Math.pow(2,8*G)-1,0);var K=1,re=0;for(this[U]=255&D;++re<G&&(K*=256);)this[U+re]=D/K&255;return U+G},e.prototype.writeUIntBE=function(D,U,G,$){D=+D,U>>>=0,G>>>=0,$||P(this,D,U,G,Math.pow(2,8*G)-1,0);var K=G-1,re=1;for(this[U+K]=255&D;--K>=0&&(re*=256);)this[U+K]=D/re&255;return U+G},e.prototype.writeUInt8=function(D,U,G){return D=+D,U>>>=0,G||P(this,D,U,1,255,0),this[U]=255&D,U+1},e.prototype.writeUInt16LE=function(D,U,G){return D=+D,U>>>=0,G||P(this,D,U,2,65535,0),this[U]=255&D,this[U+1]=D>>>8,U+2},e.prototype.writeUInt16BE=function(D,U,G){return D=+D,U>>>=0,G||P(this,D,U,2,65535,0),this[U]=D>>>8,this[U+1]=255&D,U+2},e.prototype.writeUInt32LE=function(D,U,G){return D=+D,U>>>=0,G||P(this,D,U,4,4294967295,0),this[U+3]=D>>>24,this[U+2]=D>>>16,this[U+1]=D>>>8,this[U]=255&D,U+4},e.prototype.writeUInt32BE=function(D,U,G){return D=+D,U>>>=0,G||P(this,D,U,4,4294967295,0),this[U]=D>>>24,this[U+1]=D>>>16,this[U+2]=D>>>8,this[U+3]=255&D,U+4},e.prototype.writeIntLE=function(D,U,G,$){if(D=+D,U>>>=0,!$){var K=Math.pow(2,8*G-1);P(this,D,U,G,K-1,-K)}var re=0,ne=1,ae=0;for(this[U]=255&D;++re<G&&(ne*=256);)D<0&&ae===0&&this[U+re-1]!==0&&(ae=1),this[U+re]=(D/ne>>0)-ae&255;return U+G},e.prototype.writeIntBE=function(D,U,G,$){if(D=+D,U>>>=0,!$){var K=Math.pow(2,8*G-1);P(this,D,U,G,K-1,-K)}var re=G-1,ne=1,ae=0;for(this[U+re]=255&D;--re>=0&&(ne*=256);)D<0&&ae===0&&this[U+re+1]!==0&&(ae=1),this[U+re]=(D/ne>>0)-ae&255;return U+G},e.prototype.writeInt8=function(D,U,G){return D=+D,U>>>=0,G||P(this,D,U,1,127,-128),D<0&&(D=255+D+1),this[U]=255&D,U+1},e.prototype.writeInt16LE=function(D,U,G){return D=+D,U>>>=0,G||P(this,D,U,2,32767,-32768),this[U]=255&D,this[U+1]=D>>>8,U+2},e.prototype.writeInt16BE=function(D,U,G){return D=+D,U>>>=0,G||P(this,D,U,2,32767,-32768),this[U]=D>>>8,this[U+1]=255&D,U+2},e.prototype.writeInt32LE=function(D,U,G){return D=+D,U>>>=0,G||P(this,D,U,4,2147483647,-2147483648),this[U]=255&D,this[U+1]=D>>>8,this[U+2]=D>>>16,this[U+3]=D>>>24,U+4},e.prototype.writeInt32BE=function(D,U,G){return D=+D,U>>>=0,G||P(this,D,U,4,2147483647,-2147483648),D<0&&(D=4294967295+D+1),this[U]=D>>>24,this[U+1]=D>>>16,this[U+2]=D>>>8,this[U+3]=255&D,U+4},e.prototype.writeFloatLE=function(D,U,G){return F(this,D,U,!0,G)},e.prototype.writeFloatBE=function(D,U,G){return F(this,D,U,!1,G)},e.prototype.writeDoubleLE=function(D,U,G){return q(this,D,U,!0,G)},e.prototype.writeDoubleBE=function(D,U,G){return q(this,D,U,!1,G)},e.prototype.copy=function(D,U,G,$){if(!e.isBuffer(D))throw new TypeError("argument should be a Buffer");if(G||(G=0),$||$===0||($=this.length),U>=D.length&&(U=D.length),U||(U=0),$>0&&$<G&&($=G),$===G||D.length===0||this.length===0)return 0;if(U<0)throw new RangeError("targetStart out of bounds");if(G<0||G>=this.length)throw new RangeError("Index out of range");if($<0)throw new RangeError("sourceEnd out of bounds");$>this.length&&($=this.length),D.length-U<$-G&&($=D.length-U+G);var K=$-G;if(this===D&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(U,G,$);else if(this===D&&G<U&&U<$)for(var re=K-1;re>=0;--re)D[re+U]=this[re+G];else Uint8Array.prototype.set.call(D,this.subarray(G,$),U);return K},e.prototype.fill=function(D,U,G,$){if(typeof D=="string"){if(typeof U=="string"?($=U,U=0,G=this.length):typeof G=="string"&&($=G,G=this.length),$!==void 0&&typeof $!="string")throw new TypeError("encoding must be a string");if(typeof $=="string"&&!e.isEncoding($))throw new TypeError("Unknown encoding: "+$);if(D.length===1){var K=D.charCodeAt(0);($==="utf8"&&K<128||$==="latin1")&&(D=K)}}else typeof D=="number"&&(D&=255);if(U<0||this.length<U||this.length<G)throw new RangeError("Out of range index");if(G<=U)return this;var re;if(U>>>=0,G=G===void 0?this.length:G>>>0,D||(D=0),typeof D=="number")for(re=U;re<G;++re)this[re]=D;else{var ne=e.isBuffer(D)?D:e.from(D,$),ae=ne.length;if(ae===0)throw new TypeError('The value "'+D+'" is invalid for argument "value"');for(re=0;re<G-U;++re)this[re+U]=ne[re%ae]}return this};var W=/[^+/0-9A-Za-z-_]/g;function X(D){return D<16?"0"+D.toString(16):D.toString(16)}function Q(D,U){var G;U=U||1/0;for(var $=D.length,K=null,re=[],ne=0;ne<$;++ne){if((G=D.charCodeAt(ne))>55295&&G<57344){if(!K){if(G>56319){(U-=3)>-1&&re.push(239,191,189);continue}if(ne+1===$){(U-=3)>-1&&re.push(239,191,189);continue}K=G;continue}if(G<56320){(U-=3)>-1&&re.push(239,191,189),K=G;continue}G=65536+(K-55296<<10|G-56320)}else K&&(U-=3)>-1&&re.push(239,191,189);if(K=null,G<128){if((U-=1)<0)break;re.push(G)}else if(G<2048){if((U-=2)<0)break;re.push(G>>6|192,63&G|128)}else if(G<65536){if((U-=3)<0)break;re.push(G>>12|224,G>>6&63|128,63&G|128)}else{if(!(G<1114112))throw new Error("Invalid code point");if((U-=4)<0)break;re.push(G>>18|240,G>>12&63|128,G>>6&63|128,63&G|128)}}return re}function Z(D){return h.toByteArray(function(U){if((U=(U=U.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;U.length%4!=0;)U+="=";return U}(D))}function Y(D,U,G,$){for(var K=0;K<$&&!(K+G>=U.length||K>=D.length);++K)U[K+G]=D[K];return K}function N(D,U){return D instanceof U||D!=null&&D.constructor!=null&&D.constructor.name!=null&&D.constructor.name===U.name}function J(D){return D!=D}}).call(this)}).call(this,i("buffer").Buffer)},{"base64-js":86,buffer:117,ieee754:445}],118:[function(i,B,V){var t=i("./lib/monotone"),h=i("./lib/triangulation"),p=i("./lib/delaunay"),u=i("./lib/filter");function e(a){return[Math.min(a[0],a[1]),Math.max(a[0],a[1])]}function l(a,n){return a[0]-n[0]||a[1]-n[1]}function o(a,n,s){return n in a?a[n]:s}B.exports=function(a,n,s){Array.isArray(n)?(s=s||{},n=n||[]):(s=n||{},n=[]);var r=!!o(s,"delaunay",!0),c=!!o(s,"interior",!0),f=!!o(s,"exterior",!0),d=!!o(s,"infinity",!1);if(!c&&!f||a.length===0)return[];var g=t(a,n);if(r||c!==f||d){for(var m=h(a.length,function(T){return T.map(e).sort(l)}(n)),y=0;y<g.length;++y){var v=g[y];m.addTriangle(v[0],v[1],v[2])}return r&&p(a,m),f?c?d?u(m,0,d):m.cells():u(m,1,d):u(m,-1)}return g}},{"./lib/delaunay":119,"./lib/filter":120,"./lib/monotone":121,"./lib/triangulation":122}],119:[function(i,B,V){var t=i("robust-in-sphere")[4];i("binary-search-bounds");function h(p,u,e,l,o,a){var n=u.opposite(l,o);if(!(n<0)){if(o<l){var s=l;l=o,o=s,s=a,a=n,n=s}u.isConstraint(l,o)||t(p[l],p[o],p[a],p[n])<0&&e.push(l,o)}}B.exports=function(p,u){for(var e=[],l=p.length,o=u.stars,a=0;a<l;++a)for(var n=o[a],s=1;s<n.length;s+=2)if(!((d=n[s])<a)&&!u.isConstraint(a,d)){for(var r=n[s-1],c=-1,f=1;f<n.length;f+=2)if(n[f-1]===d){c=n[f];break}c<0||t(p[a],p[d],p[r],p[c])<0&&e.push(a,d)}for(;e.length>0;){for(var d=e.pop(),g=(a=e.pop(),r=-1,c=-1,n=o[a],1);g<n.length;g+=2){var m=n[g-1],y=n[g];m===d?c=y:y===d&&(r=m)}r<0||c<0||t(p[a],p[d],p[r],p[c])>=0||(u.flip(a,d),h(p,u,e,r,a,c),h(p,u,e,a,c,r),h(p,u,e,c,d,r),h(p,u,e,d,r,c))}}},{"binary-search-bounds":103,"robust-in-sphere":546}],120:[function(i,B,V){var t,h=i("binary-search-bounds");function p(e,l,o,a,n,s,r){this.cells=e,this.neighbor=l,this.flags=a,this.constraint=o,this.active=n,this.next=s,this.boundary=r}function u(e,l){return e[0]-l[0]||e[1]-l[1]||e[2]-l[2]}B.exports=function(e,l,o){var a=function(k,E){for(var A=k.cells(),b=A.length,L=0;L<b;++L){var w=(Z=A[L])[0],C=Z[1],S=Z[2];C<S?C<w&&(Z[0]=C,Z[1]=S,Z[2]=w):S<w&&(Z[0]=S,Z[1]=w,Z[2]=C)}A.sort(u);var P=new Array(b);for(L=0;L<P.length;++L)P[L]=0;var z=[],F=[],q=new Array(3*b),W=new Array(3*b),X=null;E&&(X=[]);var Q=new p(A,q,W,P,z,F,X);for(L=0;L<b;++L)for(var Z=A[L],Y=0;Y<3;++Y){w=Z[Y],C=Z[(Y+1)%3];var N=q[3*L+Y]=Q.locate(C,w,k.opposite(C,w)),J=W[3*L+Y]=k.isConstraint(w,C);N<0&&(J?F.push(L):(z.push(L),P[L]=1),E&&X.push([C,w,-1]))}return Q}(e,o);if(l===0)return o?a.cells.concat(a.boundary):a.cells;for(var n=1,s=a.active,r=a.next,c=a.flags,f=a.cells,d=a.constraint,g=a.neighbor;s.length>0||r.length>0;){for(;s.length>0;){var m=s.pop();if(c[m]!==-n){c[m]=n,f[m];for(var y=0;y<3;++y){var v=g[3*m+y];v>=0&&c[v]===0&&(d[3*m+y]?r.push(v):(s.push(v),c[v]=n))}}}var T=r;r=s,s=T,r.length=0,n=-n}var _=function(k,E,A){for(var b=0,L=0;L<k.length;++L)E[L]===A&&(k[b++]=k[L]);return k.length=b,k}(f,c,l);return o?_.concat(a.boundary):_},p.prototype.locate=(t=[0,0,0],function(e,l,o){var a=e,n=l,s=o;return l<o?l<e&&(a=l,n=o,s=e):o<e&&(a=o,n=e,s=l),a<0?-1:(t[0]=a,t[1]=n,t[2]=s,h.eq(this.cells,t,u))})},{"binary-search-bounds":103}],121:[function(i,B,V){var t=i("binary-search-bounds"),h=i("robust-orientation")[3];function p(r,c,f,d,g){this.a=r,this.b=c,this.idx=f,this.lowerIds=d,this.upperIds=g}function u(r,c,f,d){this.a=r,this.b=c,this.type=f,this.idx=d}function e(r,c){var f=r.a[0]-c.a[0]||r.a[1]-c.a[1]||r.type-c.type;return f||(r.type!==0&&(f=h(r.a,r.b,c.b))?f:r.idx-c.idx)}function l(r,c){return h(r.a,r.b,c)}function o(r,c,f,d,g){for(var m=t.lt(c,d,l),y=t.gt(c,d,l),v=m;v<y;++v){for(var T=c[v],_=T.lowerIds,k=_.length;k>1&&h(f[_[k-2]],f[_[k-1]],d)>0;)r.push([_[k-1],_[k-2],g]),k-=1;_.length=k,_.push(g);var E=T.upperIds;for(k=E.length;k>1&&h(f[E[k-2]],f[E[k-1]],d)<0;)r.push([E[k-2],E[k-1],g]),k-=1;E.length=k,E.push(g)}}function a(r,c){var f;return(f=r.a[0]<c.a[0]?h(r.a,r.b,c.a):h(c.b,c.a,r.a))?f:(f=c.b[0]<r.b[0]?h(r.a,r.b,c.b):h(c.b,c.a,r.b))||r.idx-c.idx}function n(r,c,f){var d=t.le(r,f,a),g=r[d],m=g.upperIds,y=m[m.length-1];g.upperIds=[y],r.splice(d+1,0,new p(f.a,f.b,f.idx,[y],m))}function s(r,c,f){var d=f.a;f.a=f.b,f.b=d;var g=t.eq(r,f,a),m=r[g];r[g-1].upperIds=m.upperIds,r.splice(g,1)}B.exports=function(r,c){for(var f=r.length,d=c.length,g=[],m=0;m<f;++m)g.push(new u(r[m],null,0,m));for(m=0;m<d;++m){var y=c[m],v=r[y[0]],T=r[y[1]];v[0]<T[0]?g.push(new u(v,T,2,m),new u(T,v,1,m)):v[0]>T[0]&&g.push(new u(T,v,2,m),new u(v,T,1,m))}g.sort(e);for(var _=g[0].a[0]-(1+Math.abs(g[0].a[0]))*Math.pow(2,-52),k=[new p([_,1],[_,0],-1,[],[])],E=[],A=(m=0,g.length);m<A;++m){var b=g[m],L=b.type;L===0?o(E,k,r,b.a,b.idx):L===2?n(k,r,b):s(k,r,b)}return E}},{"binary-search-bounds":103,"robust-orientation":548}],122:[function(i,B,V){var t=i("binary-search-bounds");function h(e,l){this.stars=e,this.edges=l}B.exports=function(e,l){for(var o=new Array(e),a=0;a<e;++a)o[a]=[];return new h(o,l)};var p=h.prototype;function u(e,l,o){for(var a=1,n=e.length;a<n;a+=2)if(e[a-1]===l&&e[a]===o)return e[a-1]=e[n-2],e[a]=e[n-1],void(e.length=n-2)}p.isConstraint=function(){var e=[0,0];function l(o,a){return o[0]-a[0]||o[1]-a[1]}return function(o,a){return e[0]=Math.min(o,a),e[1]=Math.max(o,a),t.eq(this.edges,e,l)>=0}}(),p.removeTriangle=function(e,l,o){var a=this.stars;u(a[e],l,o),u(a[l],o,e),u(a[o],e,l)},p.addTriangle=function(e,l,o){var a=this.stars;a[e].push(l,o),a[l].push(o,e),a[o].push(e,l)},p.opposite=function(e,l){for(var o=this.stars[l],a=1,n=o.length;a<n;a+=2)if(o[a]===e)return o[a-1];return-1},p.flip=function(e,l){var o=this.opposite(e,l),a=this.opposite(l,e);this.removeTriangle(e,l,o),this.removeTriangle(l,e,a),this.addTriangle(e,a,o),this.addTriangle(l,o,a)},p.edges=function(){for(var e=this.stars,l=[],o=0,a=e.length;o<a;++o)for(var n=e[o],s=0,r=n.length;s<r;s+=2)l.push([n[s],n[s+1]]);return l},p.cells=function(){for(var e=this.stars,l=[],o=0,a=e.length;o<a;++o)for(var n=e[o],s=0,r=n.length;s<r;s+=2){var c=n[s],f=n[s+1];o<Math.min(c,f)&&l.push([o,c,f])}return l}},{"binary-search-bounds":103}],123:[function(i,B,V){B.exports=function(t){for(var h=1,p=1;p<t.length;++p)for(var u=0;u<p;++u)if(t[p]<t[u])h=-h;else if(t[u]===t[p])return 0;return h}},{}],124:[function(i,B,V){var t=i("dup"),h=i("robust-linear-solve");function p(l,o){for(var a=0,n=l.length,s=0;s<n;++s)a+=l[s]*o[s];return a}function u(l){var o=l.length;if(o===0)return[];l[0].length;var a=t([l.length+1,l.length+1],1),n=t([l.length+1],1);a[o][o]=0;for(var s=0;s<o;++s){for(var r=0;r<=s;++r)a[r][s]=a[s][r]=2*p(l[s],l[r]);n[s]=p(l[s],l[s])}var c=h(a,n),f=0,d=c[o+1];for(s=0;s<d.length;++s)f+=d[s];var g=new Array(o);for(s=0;s<o;++s){d=c[s];var m=0;for(r=0;r<d.length;++r)m+=d[r];g[s]=m/f}return g}function e(l){if(l.length===0)return[];for(var o=l[0].length,a=t([o]),n=u(l),s=0;s<l.length;++s)for(var r=0;r<o;++r)a[r]+=l[s][r]*n[s];return a}e.barycenetric=u,B.exports=e},{dup:185,"robust-linear-solve":547}],125:[function(i,B,V){B.exports=function(h){for(var p=t(h),u=0,e=0;e<h.length;++e)for(var l=h[e],o=0;o<p.length;++o)u+=Math.pow(l[o]-p[o],2);return Math.sqrt(u/h.length)};var t=i("circumcenter")},{circumcenter:124}],126:[function(i,B,V){B.exports=function(t,h,p){return h<p?t<h?h:t>p?p:t:t<p?p:t>h?h:t}},{}],127:[function(i,B,V){B.exports=function(y,v,T){var _;if(T){_=v;for(var k=new Array(v.length),E=0;E<v.length;++E){var A=v[E];k[E]=[A[0],A[1],T[E]]}v=k}for(var b=function(L,w,C){var S=c(L,[],r(L));return g(w,S,C),!!S}(y,v,!!T);m(y,v,!!T);)b=!0;if(T&&b)for(_.length=0,T.length=0,E=0;E<v.length;++E)A=v[E],_.push([A[0],A[1]]),T.push(A[2]);return b};var t=i("union-find"),h=i("box-intersect"),p=i("robust-segment-intersect"),u=i("big-rat"),e=i("big-rat/cmp"),l=i("big-rat/to-float"),o=i("rat-vec"),a=i("nextafter"),n=i("./lib/rat-seg-intersect");function s(y){var v=l(y);return[a(v,-1/0),a(v,1/0)]}function r(y){for(var v=new Array(y.length),T=0;T<y.length;++T){var _=y[T];v[T]=[a(_[0],-1/0),a(_[1],-1/0),a(_[0],1/0),a(_[1],1/0)]}return v}function c(y,v,T){for(var _=v.length,k=new t(_),E=[],A=0;A<v.length;++A){var b=v[A],L=s(b[0]),w=s(b[1]);E.push([a(L[0],-1/0),a(w[0],-1/0),a(L[1],1/0),a(w[1],1/0)])}h(E,function(F,q){k.link(F,q)});var C=!0,S=new Array(_);for(A=0;A<_;++A)(z=k.find(A))!==A&&(C=!1,y[z]=[Math.min(y[A][0],y[z][0]),Math.min(y[A][1],y[z][1])]);if(C)return null;var P=0;for(A=0;A<_;++A){var z;(z=k.find(A))===A?(S[A]=P,y[P++]=y[A]):S[A]=-1}for(y.length=P,A=0;A<_;++A)S[A]<0&&(S[A]=S[k.find(A)]);return S}function f(y,v){return y[0]-v[0]||y[1]-v[1]}function d(y,v){var T=y[0]-v[0]||y[1]-v[1];return T||(y[2]<v[2]?-1:y[2]>v[2]?1:0)}function g(y,v,T){if(y.length!==0){if(v)for(var _=0;_<y.length;++_){var k=v[(A=y[_])[0]],E=v[A[1]];A[0]=Math.min(k,E),A[1]=Math.max(k,E)}else for(_=0;_<y.length;++_){var A;k=(A=y[_])[0],E=A[1],A[0]=Math.min(k,E),A[1]=Math.max(k,E)}T?y.sort(d):y.sort(f);var b=1;for(_=1;_<y.length;++_){var L=y[_-1],w=y[_];(w[0]!==L[0]||w[1]!==L[1]||T&&w[2]!==L[2])&&(y[b++]=w)}y.length=b}}function m(y,v,T){var _=function(L,w){for(var C=new Array(w.length),S=0;S<w.length;++S){var P=w[S],z=L[P[0]],F=L[P[1]];C[S]=[a(Math.min(z[0],F[0]),-1/0),a(Math.min(z[1],F[1]),-1/0),a(Math.max(z[0],F[0]),1/0),a(Math.max(z[1],F[1]),1/0)]}return C}(y,v),k=function(L,w,C){var S=[];return h(C,function(P,z){var F=w[P],q=w[z];if(F[0]!==q[0]&&F[0]!==q[1]&&F[1]!==q[0]&&F[1]!==q[1]){var W=L[F[0]],X=L[F[1]],Q=L[q[0]],Z=L[q[1]];p(W,X,Q,Z)&&S.push([P,z])}}),S}(y,v,_),E=r(y),A=function(L,w,C,S){var P=[];return h(C,S,function(z,F){var q=w[z];if(q[0]!==F&&q[1]!==F){var W=L[F],X=L[q[0]],Q=L[q[1]];p(X,Q,W,W)&&P.push([z,F])}}),P}(y,v,_,E),b=c(y,function(L,w,C,S,P){var z,F,q=L.map(function(he){return[u(he[0]),u(he[1])]});for(z=0;z<C.length;++z){var W=C[z];F=W[0];var X=W[1],Q=w[F],Z=w[X],Y=n(o(L[Q[0]]),o(L[Q[1]]),o(L[Z[0]]),o(L[Z[1]]));if(Y){var N=L.length;L.push([l(Y[0]),l(Y[1])]),q.push(Y),S.push([F,N],[X,N])}}for(S.sort(function(he,se){if(he[0]!==se[0])return he[0]-se[0];var de=q[he[1]],ce=q[se[1]];return e(de[0],ce[0])||e(de[1],ce[1])}),z=S.length-1;z>=0;--z){var J=w[F=(ae=S[z])[0]],D=J[0],U=J[1],G=L[D],$=L[U];if((G[0]-$[0]||G[1]-$[1])<0){var K=D;D=U,U=K}J[0]=D;var re,ne=J[1]=ae[1];for(P&&(re=J[2]);z>0&&S[z-1][0]===F;){var ae,ie=(ae=S[--z])[1];P?w.push([ne,ie,re]):w.push([ne,ie]),ne=ie}P?w.push([ne,U,re]):w.push([ne,U])}return q}(y,v,k,A,T));return g(v,b,T),!!b||k.length>0||A.length>0}},{"./lib/rat-seg-intersect":128,"big-rat":90,"big-rat/cmp":88,"big-rat/to-float":102,"box-intersect":108,nextafter:484,"rat-vec":532,"robust-segment-intersect":551,"union-find":618}],128:[function(i,B,V){B.exports=function(n,s,r,c){var f=e(s,n),d=e(c,r),g=a(f,d);if(u(g)===0)return null;var m=e(n,r),y=a(d,m),v=h(y,g),T=o(f,v);return l(n,T)};var t=i("big-rat/mul"),h=i("big-rat/div"),p=i("big-rat/sub"),u=i("big-rat/sign"),e=i("rat-vec/sub"),l=i("rat-vec/add"),o=i("rat-vec/muls");function a(n,s){return p(t(n[0],s[1]),t(n[1],s[0]))}},{"big-rat/div":89,"big-rat/mul":99,"big-rat/sign":100,"big-rat/sub":101,"rat-vec/add":531,"rat-vec/muls":533,"rat-vec/sub":534}],129:[function(i,B,V){var t=i("clamp");function h(p,u){u==null&&(u=!0);var e=p[0],l=p[1],o=p[2],a=p[3];return a==null&&(a=u?1:255),u&&(e*=255,l*=255,o*=255,a*=255),16777216*(e=255&t(e,0,255))+((l=255&t(l,0,255))<<16)+((o=255&t(o,0,255))<<8)+(a=255&t(a,0,255))}B.exports=h,B.exports.to=h,B.exports.from=function(p,u){var e=(p=+p)>>>24,l=(16711680&p)>>>16,o=(65280&p)>>>8,a=255&p;return u===!1?[e,l,o,a]:[e/255,l/255,o/255,a/255]}},{clamp:126}],130:[function(i,B,V){B.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],131:[function(i,B,V){var t=i("color-rgba"),h=i("clamp"),p=i("dtype");B.exports=function(u,e){e!=="float"&&e||(e="array"),e==="uint"&&(e="uint8"),e==="uint_clamped"&&(e="uint8_clamped");var l=new(p(e))(4),o=e!=="uint8"&&e!=="uint8_clamped";return u.length&&typeof u!="string"||((u=t(u))[0]/=255,u[1]/=255,u[2]/=255),function(a){return a instanceof Uint8Array||a instanceof Uint8ClampedArray||!!(Array.isArray(a)&&(a[0]>1||a[0]===0)&&(a[1]>1||a[1]===0)&&(a[2]>1||a[2]===0)&&(!a[3]||a[3]>1))}(u)?(l[0]=u[0],l[1]=u[1],l[2]=u[2],l[3]=u[3]!=null?u[3]:255,o&&(l[0]/=255,l[1]/=255,l[2]/=255,l[3]/=255),l):(o?(l[0]=u[0],l[1]=u[1],l[2]=u[2],l[3]=u[3]!=null?u[3]:1):(l[0]=h(Math.floor(255*u[0]),0,255),l[1]=h(Math.floor(255*u[1]),0,255),l[2]=h(Math.floor(255*u[2]),0,255),l[3]=u[3]==null?255:h(Math.floor(255*u[3]),0,255)),l)}},{clamp:126,"color-rgba":133,dtype:184}],132:[function(i,B,V){(function(t){(function(){var h=i("color-name"),p=i("is-plain-obj"),u=i("defined");B.exports=function(l){var o,a,n=[],s=1;if(typeof l=="string")if(h[l])n=h[l].slice(),a="rgb";else if(l==="transparent")s=0,a="rgb",n=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(l)){var r=(d=l.slice(1)).length;s=1,r<=4?(n=[parseInt(d[0]+d[0],16),parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16)],r===4&&(s=parseInt(d[3]+d[3],16)/255)):(n=[parseInt(d[0]+d[1],16),parseInt(d[2]+d[3],16),parseInt(d[4]+d[5],16)],r===8&&(s=parseInt(d[6]+d[7],16)/255)),n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),a="rgb"}else if(o=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(l)){var c=o[1],f=c==="rgb",d=c.replace(/a$/,"");a=d,r=d==="cmyk"?4:d==="gray"?1:3,n=o[2].trim().split(/\s*,\s*/).map(function(m,y){if(/%$/.test(m))return y===r?parseFloat(m)/100:d==="rgb"?255*parseFloat(m)/100:parseFloat(m);if(d[y]==="h"){if(/deg$/.test(m))return parseFloat(m);if(e[m]!==void 0)return e[m]}return parseFloat(m)}),c===d&&n.push(1),s=f||n[r]===void 0?1:n[r],n=n.slice(0,r)}else l.length>10&&/[0-9](?:\s|\/)/.test(l)&&(n=l.match(/([0-9]+)/g).map(function(m){return parseFloat(m)}),a=l.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(l))if(p(l)){var g=u(l.r,l.red,l.R,null);g!==null?(a="rgb",n=[g,u(l.g,l.green,l.G),u(l.b,l.blue,l.B)]):(a="hsl",n=[u(l.h,l.hue,l.H),u(l.s,l.saturation,l.S),u(l.l,l.lightness,l.L,l.b,l.brightness)]),s=u(l.a,l.alpha,l.opacity,1),l.opacity!=null&&(s/=100)}else(Array.isArray(l)||t.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(l))&&(n=[l[0],l[1],l[2]],a="rgb",s=l.length===4?l[3]:1);else a="rgb",n=[l>>>16,(65280&l)>>>8,255&l];return{space:a,values:n,alpha:s}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":130,defined:179,"is-plain-obj":457}],133:[function(i,B,V){var t=i("color-parse"),h=i("color-space/hsl"),p=i("clamp");B.exports=function(u){var e,l=t(u);return l.space?((e=Array(3))[0]=p(l.values[0],0,255),e[1]=p(l.values[1],0,255),e[2]=p(l.values[2],0,255),l.space[0]==="h"&&(e=h.rgb(e)),e.push(p(l.alpha,0,1)),e):[]}},{clamp:126,"color-parse":132,"color-space/hsl":134}],134:[function(i,B,V){var t=i("./rgb");B.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(h){var p,u,e,l,o,a=h[0]/360,n=h[1]/100,s=h[2]/100;if(n===0)return[o=255*s,o,o];p=2*s-(u=s<.5?s*(1+n):s+n-s*n),l=[0,0,0];for(var r=0;r<3;r++)(e=a+1/3*-(r-1))<0?e++:e>1&&e--,o=6*e<1?p+6*(u-p)*e:2*e<1?u:3*e<2?p+(u-p)*(2/3-e)*6:p,l[r]=255*o;return l}},t.hsl=function(h){var p,u,e=h[0]/255,l=h[1]/255,o=h[2]/255,a=Math.min(e,l,o),n=Math.max(e,l,o),s=n-a;return n===a?p=0:e===n?p=(l-o)/s:l===n?p=2+(o-e)/s:o===n&&(p=4+(e-l)/s),(p=Math.min(60*p,360))<0&&(p+=360),u=(a+n)/2,[p,100*(n===a?0:u<=.5?s/(n+a):s/(2-n-a)),100*u]}},{"./rgb":135}],135:[function(i,B,V){B.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],136:[function(i,B,V){B.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],137:[function(i,B,V){var t=i("./colorScale"),h=i("lerp");function p(l){return[l[0]/255,l[1]/255,l[2]/255,l[3]]}function u(l){for(var o,a="#",n=0;n<3;++n)a+=("00"+(o=(o=l[n]).toString(16))).substr(o.length);return a}function e(l){return"rgba("+l.join(",")+")"}B.exports=function(l){var o,a,n,s,r,c,f,d,g,m;if(l||(l={}),d=(l.nshades||72)-1,f=l.format||"hex",(c=l.colormap)||(c="jet"),typeof c=="string"){if(c=c.toLowerCase(),!t[c])throw Error(c+" not a supported colorscale");r=t[c]}else{if(!Array.isArray(c))throw Error("unsupported colormap option",c);r=c.slice()}if(r.length>d+1)throw new Error(c+" map requires nshades to be at least size "+r.length);g=Array.isArray(l.alpha)?l.alpha.length!==2?[1,1]:l.alpha.slice():typeof l.alpha=="number"?[l.alpha,l.alpha]:[1,1],o=r.map(function(k){return Math.round(k.index*d)}),g[0]=Math.min(Math.max(g[0],0),1),g[1]=Math.min(Math.max(g[1],0),1);var y=r.map(function(k,E){var A=r[E].index,b=r[E].rgb.slice();return b.length===4&&b[3]>=0&&b[3]<=1||(b[3]=g[0]+(g[1]-g[0])*A),b}),v=[];for(m=0;m<o.length-1;++m){s=o[m+1]-o[m],a=y[m],n=y[m+1];for(var T=0;T<s;T++){var _=T/s;v.push([Math.round(h(a[0],n[0],_)),Math.round(h(a[1],n[1],_)),Math.round(h(a[2],n[2],_)),h(a[3],n[3],_)])}}return v.push(r[r.length-1].rgb.concat(g[1])),f==="hex"?v=v.map(u):f==="rgbaString"?v=v.map(e):f==="float"&&(v=v.map(p)),v}},{"./colorScale":136,lerp:460}],138:[function(i,B,V){B.exports=function(o,a,n,s){var r=t(a,n,s);if(r===0){var c=h(t(o,a,n)),f=h(t(o,a,s));if(c===f){if(c===0){var d=l(o,a,n),g=l(o,a,s);return d===g?0:d?1:-1}return 0}return f===0?c>0||l(o,a,s)?-1:1:c===0?f>0||l(o,a,n)?1:-1:h(f-c)}var m=t(o,a,n);return m>0?r>0&&t(o,a,s)>0?1:-1:m<0?r>0||t(o,a,s)>0?1:-1:t(o,a,s)>0||l(o,a,n)?1:-1};var t=i("robust-orientation"),h=i("signum"),p=i("two-sum"),u=i("robust-product"),e=i("robust-sum");function l(o,a,n){var s=p(o[0],-a[0]),r=p(o[1],-a[1]),c=p(n[0],-a[0]),f=p(n[1],-a[1]),d=e(u(s,c),u(r,f));return d[d.length-1]>=0}},{"robust-orientation":548,"robust-product":549,"robust-sum":553,signum:555,"two-sum":605}],139:[function(i,B,V){B.exports=function(p,u){var e=p.length,l=p.length-u.length;if(l)return l;switch(e){case 0:return 0;case 1:return p[0]-u[0];case 2:return p[0]+p[1]-u[0]-u[1]||t(p[0],p[1])-t(u[0],u[1]);case 3:var o=p[0]+p[1],a=u[0]+u[1];if(l=o+p[2]-(a+u[2]))return l;var n=t(p[0],p[1]),s=t(u[0],u[1]);return t(n,p[2])-t(s,u[2])||t(n+p[2],o)-t(s+u[2],a);case 4:var r=p[0],c=p[1],f=p[2],d=p[3],g=u[0],m=u[1],y=u[2],v=u[3];return r+c+f+d-(g+m+y+v)||t(r,c,f,d)-t(g,m,y,v,g)||t(r+c,r+f,r+d,c+f,c+d,f+d)-t(g+m,g+y,g+v,m+y,m+v,y+v)||t(r+c+f,r+c+d,r+f+d,c+f+d)-t(g+m+y,g+m+v,g+y+v,m+y+v);default:for(var T=p.slice().sort(h),_=u.slice().sort(h),k=0;k<e;++k)if(l=T[k]-_[k])return l;return 0}};var t=Math.min;function h(p,u){return p-u}},{}],140:[function(i,B,V){var t=i("compare-cell"),h=i("cell-orientation");B.exports=function(p,u){return t(p,u)||h(p)-h(u)}},{"cell-orientation":123,"compare-cell":139}],141:[function(i,B,V){var t=i("./lib/ch1d"),h=i("./lib/ch2d"),p=i("./lib/chnd");B.exports=function(u){var e=u.length;if(e===0)return[];if(e===1)return[[0]];var l=u[0].length;return l===0?[]:l===1?t(u):l===2?h(u):p(u,l)}},{"./lib/ch1d":142,"./lib/ch2d":143,"./lib/chnd":144}],142:[function(i,B,V){B.exports=function(t){for(var h=0,p=0,u=1;u<t.length;++u)t[u][0]<t[h][0]&&(h=u),t[u][0]>t[p][0]&&(p=u);return h<p?[[h],[p]]:h>p?[[p],[h]]:[[h]]}},{}],143:[function(i,B,V){B.exports=function(h){var p=t(h),u=p.length;if(u<=2)return[];for(var e=new Array(u),l=p[u-1],o=0;o<u;++o){var a=p[o];e[o]=[l,a],l=a}return e};var t=i("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":469}],144:[function(i,B,V){B.exports=function(p,u){try{return t(p,!0)}catch{var e=h(p);if(e.length<=u)return[];var l=function(a,n){for(var s=a.length,r=new Array(s),c=0;c<n.length;++c)r[c]=a[n[c]];var f=n.length;for(c=0;c<s;++c)n.indexOf(c)<0&&(r[f++]=a[c]);return r}(p,e);return function(a,n){for(var s=a.length,r=n.length,c=0;c<s;++c)for(var f=a[c],d=0;d<f.length;++d){var g=f[d];if(g<r)f[d]=n[g];else{g-=r;for(var m=0;m<r;++m)g>=n[m]&&(g+=1);f[d]=g}}return a}(t(l,!0),e)}};var t=i("incremental-convex-hull"),h=i("affine-hull")},{"affine-hull":73,"incremental-convex-hull":446}],145:[function(i,B,V){B.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|ç)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|é)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|é)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|ã)o.?tom(e|é)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],146:[function(i,B,V){B.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],147:[function(i,B,V){B.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],148:[function(i,B,V){B.exports=["normal","italic","oblique"]},{}],149:[function(i,B,V){B.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],150:[function(i,B,V){B.exports={parse:i("./parse"),stringify:i("./stringify")}},{"./parse":152,"./stringify":153}],151:[function(i,B,V){var t=i("css-font-size-keywords");B.exports={isSize:function(h){return/^[\d\.]/.test(h)||h.indexOf("/")!==-1||t.indexOf(h)!==-1}}},{"css-font-size-keywords":146}],152:[function(i,B,V){var t=i("unquote"),h=i("css-global-keywords"),p=i("css-system-font-keywords"),u=i("css-font-weight-keywords"),e=i("css-font-style-keywords"),l=i("css-font-stretch-keywords"),o=i("string-split-by"),a=i("./lib/util").isSize;B.exports=s;var n=s.cache={};function s(c){if(typeof c!="string")throw new Error("Font argument must be a string.");if(n[c])return n[c];if(c==="")throw new Error("Cannot parse an empty string.");if(p.indexOf(c)!==-1)return n[c]={system:c};for(var f,d={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},g=o(c,/\s+/);f=g.shift();){if(h.indexOf(f)!==-1)return["style","variant","weight","stretch"].forEach(function(y){d[y]=f}),n[c]=d;if(e.indexOf(f)===-1)if(f!=="normal"&&f!=="small-caps")if(l.indexOf(f)===-1){if(u.indexOf(f)===-1){if(a(f)){var m=o(f,"/");if(d.size=m[0],m[1]!=null?d.lineHeight=r(m[1]):g[0]==="/"&&(g.shift(),d.lineHeight=r(g.shift())),!g.length)throw new Error("Missing required font-family.");return d.family=o(g.join(" "),/\s*,\s*/).map(t),n[c]=d}throw new Error("Unknown or unsupported font token: "+f)}d.weight=f}else d.stretch=f;else d.variant=f;else d.style=f}throw new Error("Missing required font-size.")}function r(c){var f=parseFloat(c);return f.toString()===c?f:c}},{"./lib/util":151,"css-font-stretch-keywords":147,"css-font-style-keywords":148,"css-font-weight-keywords":149,"css-global-keywords":154,"css-system-font-keywords":155,"string-split-by":589,unquote:620}],153:[function(i,B,V){var t=i("pick-by-alias"),h=i("./lib/util").isSize,p=f(i("css-global-keywords")),u=f(i("css-system-font-keywords")),e=f(i("css-font-weight-keywords")),l=f(i("css-font-style-keywords")),o=f(i("css-font-stretch-keywords")),a={normal:1,"small-caps":1},n={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},s="1rem",r="serif";function c(d,g){if(d&&!g[d]&&!p[d])throw Error("Unknown keyword `"+d+"`");return d}function f(d){for(var g={},m=0;m<d.length;m++)g[d[m]]=1;return g}B.exports=function(d){if((d=t(d,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return d.system&&c(d.system,u),d.system;if(c(d.style,l),c(d.variant,a),c(d.weight,e),c(d.stretch,o),d.size==null&&(d.size=s),typeof d.size=="number"&&(d.size+="px"),!h)throw Error("Bad size value `"+d.size+"`");d.family||(d.family=r),Array.isArray(d.family)&&(d.family.length||(d.family=[r]),d.family=d.family.map(function(m){return n[m]?m:'"'+m+'"'}).join(", "));var g=[];return g.push(d.style),d.variant!==d.style&&g.push(d.variant),d.weight!==d.variant&&d.weight!==d.style&&g.push(d.weight),d.stretch!==d.weight&&d.stretch!==d.variant&&d.stretch!==d.style&&g.push(d.stretch),g.push(d.size+(d.lineHeight==null||d.lineHeight==="normal"||d.lineHeight+""=="1"?"":"/"+d.lineHeight)),g.push(d.family),g.filter(Boolean).join(" ")}},{"./lib/util":151,"css-font-stretch-keywords":147,"css-font-style-keywords":148,"css-font-weight-keywords":149,"css-global-keywords":154,"css-system-font-keywords":155,"pick-by-alias":498}],154:[function(i,B,V){B.exports=["inherit","initial","unset"]},{}],155:[function(i,B,V){B.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],156:[function(i,B,V){B.exports=function(t,h,p,u,e,l){var o=e-1,a=e*e,n=o*o,s=(1+2*e)*n,r=e*n,c=a*(3-2*e),f=a*o;if(t.length){l||(l=new Array(t.length));for(var d=t.length-1;d>=0;--d)l[d]=s*t[d]+r*h[d]+c*p[d]+f*u[d];return l}return s*t+r*h+c*p+f*u},B.exports.derivative=function(t,h,p,u,e,l){var o=6*e*e-6*e,a=3*e*e-4*e+1,n=-6*e*e+6*e,s=3*e*e-2*e;if(t.length){l||(l=new Array(t.length));for(var r=t.length-1;r>=0;--r)l[r]=o*t[r]+a*h[r]+n*p[r]+s*u[r];return l}return o*t+a*h+n*p[r]+s*u}},{}],157:[function(i,B,V){var t=i("./lib/thunk.js");function h(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}B.exports=function(p){var u=new h;u.pre=p.pre,u.body=p.body,u.post=p.post;var e=p.args.slice(0);u.argTypes=e;for(var l=0;l<e.length;++l){var o=e[l];if(o==="array"||typeof o=="object"&&o.blockIndices){if(u.argTypes[l]="array",u.arrayArgs.push(l),u.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0),u.shimArgs.push("array"+l),l<u.pre.args.length&&u.pre.args[l].count>0)throw new Error("cwise: pre() block may not reference array args");if(l<u.post.args.length&&u.post.args[l].count>0)throw new Error("cwise: post() block may not reference array args")}else if(o==="scalar")u.scalarArgs.push(l),u.shimArgs.push("scalar"+l);else if(o==="index"){if(u.indexArgs.push(l),l<u.pre.args.length&&u.pre.args[l].count>0)throw new Error("cwise: pre() block may not reference array index");if(l<u.body.args.length&&u.body.args[l].lvalue)throw new Error("cwise: body() block may not write to array index");if(l<u.post.args.length&&u.post.args[l].count>0)throw new Error("cwise: post() block may not reference array index")}else if(o==="shape"){if(u.shapeArgs.push(l),l<u.pre.args.length&&u.pre.args[l].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(l<u.body.args.length&&u.body.args[l].lvalue)throw new Error("cwise: body() block may not write to array shape");if(l<u.post.args.length&&u.post.args[l].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if(typeof o!="object"||!o.offset)throw new Error("cwise: Unknown argument type "+e[l]);u.argTypes[l]="offset",u.offsetArgs.push({array:o.array,offset:o.offset}),u.offsetArgIndex.push(l)}}if(u.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(u.pre.args.length>e.length)throw new Error("cwise: Too many arguments in pre() block");if(u.body.args.length>e.length)throw new Error("cwise: Too many arguments in body() block");if(u.post.args.length>e.length)throw new Error("cwise: Too many arguments in post() block");return u.debug=!!p.printCode||!!p.debug,u.funcName=p.funcName||"cwise",u.blockSize=p.blockSize||64,t(u)}},{"./lib/thunk.js":159}],158:[function(i,B,V){var t=i("uniq");function h(e,l,o){var a,n,s=e.length,r=l.arrayArgs.length,c=l.indexArgs.length>0,f=[],d=[],g=0,m=0;for(a=0;a<s;++a)d.push(["i",a,"=0"].join(""));for(n=0;n<r;++n)for(a=0;a<s;++a)m=g,g=e[a],a===0?d.push(["d",n,"s",a,"=t",n,"p",g].join("")):d.push(["d",n,"s",a,"=(t",n,"p",g,"-s",m,"*t",n,"p",m,")"].join(""));for(d.length>0&&f.push("var "+d.join(",")),a=s-1;a>=0;--a)g=e[a],f.push(["for(i",a,"=0;i",a,"<s",g,";++i",a,"){"].join(""));for(f.push(o),a=0;a<s;++a){for(m=g,g=e[a],n=0;n<r;++n)f.push(["p",n,"+=d",n,"s",a].join(""));c&&(a>0&&f.push(["index[",m,"]-=s",m].join("")),f.push(["++index[",g,"]"].join(""))),f.push("}")}return f.join(`
`)}function p(e,l,o){for(var a=e.body,n=[],s=[],r=0;r<e.args.length;++r){var c=e.args[r];if(!(c.count<=0)){var f=new RegExp(c.name,"g"),d="",g=l.arrayArgs.indexOf(r);switch(l.argTypes[r]){case"offset":var m=l.offsetArgIndex.indexOf(r);g=l.offsetArgs[m].array,d="+q"+m;case"array":d="p"+g+d;var y="l"+r,v="a"+g;if(l.arrayBlockIndices[g]===0)c.count===1?o[g]==="generic"?c.lvalue?(n.push(["var ",y,"=",v,".get(",d,")"].join("")),a=a.replace(f,y),s.push([v,".set(",d,",",y,")"].join(""))):a=a.replace(f,[v,".get(",d,")"].join("")):a=a.replace(f,[v,"[",d,"]"].join("")):o[g]==="generic"?(n.push(["var ",y,"=",v,".get(",d,")"].join("")),a=a.replace(f,y),c.lvalue&&s.push([v,".set(",d,",",y,")"].join(""))):(n.push(["var ",y,"=",v,"[",d,"]"].join("")),a=a.replace(f,y),c.lvalue&&s.push([v,"[",d,"]=",y].join("")));else{for(var T=[c.name],_=[d],k=0;k<Math.abs(l.arrayBlockIndices[g]);k++)T.push("\\s*\\[([^\\]]+)\\]"),_.push("$"+(k+1)+"*t"+g+"b"+k);if(f=new RegExp(T.join(""),"g"),d=_.join("+"),o[g]==="generic")throw new Error("cwise: Generic arrays not supported in combination with blocks!");a=a.replace(f,[v,"[",d,"]"].join(""))}break;case"scalar":a=a.replace(f,"Y"+l.scalarArgs.indexOf(r));break;case"index":a=a.replace(f,"index");break;case"shape":a=a.replace(f,"shape")}}}return[n.join(`
`),a,s.join(`
`)].join(`
`).trim()}function u(e){for(var l=new Array(e.length),o=!0,a=0;a<e.length;++a){var n=e[a],s=n.match(/\d+/);s=s?s[0]:"",n.charAt(0)===0?l[a]="u"+n.charAt(1)+s:l[a]=n.charAt(0)+s,a>0&&(o=o&&l[a]===l[a-1])}return o?l[0]:l.join("")}B.exports=function(e,l){for(var o=l[1].length-Math.abs(e.arrayBlockIndices[0])|0,a=new Array(e.arrayArgs.length),n=new Array(e.arrayArgs.length),s=0;s<e.arrayArgs.length;++s)n[s]=l[2*s],a[s]=l[2*s+1];var r=[],c=[],f=[],d=[],g=[];for(s=0;s<e.arrayArgs.length;++s){e.arrayBlockIndices[s]<0?(f.push(0),d.push(o),r.push(o),c.push(o+e.arrayBlockIndices[s])):(f.push(e.arrayBlockIndices[s]),d.push(e.arrayBlockIndices[s]+o),r.push(0),c.push(e.arrayBlockIndices[s]));for(var m=[],y=0;y<a[s].length;y++)f[s]<=a[s][y]&&a[s][y]<d[s]&&m.push(a[s][y]-f[s]);g.push(m)}var v=["SS"],T=["'use strict'"],_=[];for(y=0;y<o;++y)_.push(["s",y,"=SS[",y,"]"].join(""));for(s=0;s<e.arrayArgs.length;++s){for(v.push("a"+s),v.push("t"+s),v.push("p"+s),y=0;y<o;++y)_.push(["t",s,"p",y,"=t",s,"[",f[s]+y,"]"].join(""));for(y=0;y<Math.abs(e.arrayBlockIndices[s]);++y)_.push(["t",s,"b",y,"=t",s,"[",r[s]+y,"]"].join(""))}for(s=0;s<e.scalarArgs.length;++s)v.push("Y"+s);if(e.shapeArgs.length>0&&_.push("shape=SS.slice(0)"),e.indexArgs.length>0){var k=new Array(o);for(s=0;s<o;++s)k[s]="0";_.push(["index=[",k.join(","),"]"].join(""))}for(s=0;s<e.offsetArgs.length;++s){var E=e.offsetArgs[s],A=[];for(y=0;y<E.offset.length;++y)E.offset[y]!==0&&(E.offset[y]===1?A.push(["t",E.array,"p",y].join("")):A.push([E.offset[y],"*t",E.array,"p",y].join("")));A.length===0?_.push("q"+s+"=0"):_.push(["q",s,"=",A.join("+")].join(""))}var b=t([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for((_=_.concat(b)).length>0&&T.push("var "+_.join(",")),s=0;s<e.arrayArgs.length;++s)T.push("p"+s+"|=0");e.pre.body.length>3&&T.push(p(e.pre,e,n));var L=p(e.body,e,n),w=function(S){for(var P=0,z=S[0].length;P<z;){for(var F=1;F<S.length;++F)if(S[F][P]!==S[0][P])return P;++P}return P}(g);w<o?T.push(function(S,P,z,F){for(var q=P.length,W=z.arrayArgs.length,X=z.blockSize,Q=z.indexArgs.length>0,Z=[],Y=0;Y<W;++Y)Z.push(["var offset",Y,"=p",Y].join(""));for(Y=S;Y<q;++Y)Z.push(["for(var j"+Y+"=SS[",P[Y],"]|0;j",Y,">0;){"].join("")),Z.push(["if(j",Y,"<",X,"){"].join("")),Z.push(["s",P[Y],"=j",Y].join("")),Z.push(["j",Y,"=0"].join("")),Z.push(["}else{s",P[Y],"=",X].join("")),Z.push(["j",Y,"-=",X,"}"].join("")),Q&&Z.push(["index[",P[Y],"]=j",Y].join(""));for(Y=0;Y<W;++Y){for(var N=["offset"+Y],J=S;J<q;++J)N.push(["j",J,"*t",Y,"p",P[J]].join(""));Z.push(["p",Y,"=(",N.join("+"),")"].join(""))}for(Z.push(h(P,z,F)),Y=S;Y<q;++Y)Z.push("}");return Z.join(`
`)}(w,g[0],e,L)):T.push(h(g[0],e,L)),e.post.body.length>3&&T.push(p(e.post,e,n)),e.debug&&console.log("-----Generated cwise routine for ",l,`:
`+T.join(`
`)+`
----------`);var C=[e.funcName||"unnamed","_cwise_loop_",a[0].join("s"),"m",w,u(n)].join("");return new Function(["function ",C,"(",v.join(","),"){",T.join(`
`),"} return ",C].join(""))()}},{uniq:619}],159:[function(i,B,V){var t=i("./compile.js");B.exports=function(h){var p=["'use strict'","var CACHED={}"],u=[],e=h.funcName+"_cwise_thunk";p.push(["return function ",e,"(",h.shimArgs.join(","),"){"].join(""));for(var l=[],o=[],a=[["array",h.arrayArgs[0],".shape.slice(",Math.max(0,h.arrayBlockIndices[0]),h.arrayBlockIndices[0]<0?","+h.arrayBlockIndices[0]+")":")"].join("")],n=[],s=[],r=0;r<h.arrayArgs.length;++r){var c=h.arrayArgs[r];u.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),l.push("t"+c),l.push("r"+c),o.push("t"+c),o.push("r"+c+".join()"),a.push("array"+c+".data"),a.push("array"+c+".stride"),a.push("array"+c+".offset|0"),r>0&&(n.push("array"+h.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(h.arrayBlockIndices[0])-Math.abs(h.arrayBlockIndices[r]))),s.push("array"+h.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,h.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,h.arrayBlockIndices[r])+"]"))}for(h.arrayArgs.length>1&&(p.push("if (!("+n.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),p.push("for(var shapeIndex=array"+h.arrayArgs[0]+".shape.length-"+Math.abs(h.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),p.push("if (!("+s.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),p.push("}")),r=0;r<h.scalarArgs.length;++r)a.push("scalar"+h.scalarArgs[r]);return u.push(["type=[",o.join(","),"].join()"].join("")),u.push("proc=CACHED[type]"),p.push("var "+u.join(",")),p.push(["if(!proc){","CACHED[type]=proc=compile([",l.join(","),"])}","return proc(",a.join(","),")}"].join("")),h.debug&&console.log(`-----Generated thunk:
`+p.join(`
`)+`
----------`),new Function("compile",p.join(`
`))(t.bind(void 0,h))}},{"./compile.js":158}],160:[function(i,B,V){var t,h=i("type/value/is"),p=i("type/value/ensure"),u=i("type/plain-function/ensure"),e=i("es5-ext/object/copy"),l=i("es5-ext/object/normalize-options"),o=i("es5-ext/object/map"),a=Function.prototype.bind,n=Object.defineProperty,s=Object.prototype.hasOwnProperty;t=function(r,c,f){var d,g=p(c)&&u(c.value);return delete(d=e(c)).writable,delete d.value,d.get=function(){return!f.overwriteDefinition&&s.call(this,r)?g:(c.value=a.call(g,f.resolveContext?f.resolveContext(this):this),n(this,r,c),this[r])},d},B.exports=function(r){var c=l(arguments[1]);return h(c.resolveContext)&&u(c.resolveContext),o(r,function(f,d){return t(d,f,c)})}},{"es5-ext/object/copy":205,"es5-ext/object/map":213,"es5-ext/object/normalize-options":214,"type/plain-function/ensure":611,"type/value/ensure":615,"type/value/is":616}],161:[function(i,B,V){var t=i("type/value/is"),h=i("type/plain-function/is"),p=i("es5-ext/object/assign"),u=i("es5-ext/object/normalize-options"),e=i("es5-ext/string/#/contains");(B.exports=function(l,o){var a,n,s,r,c;return arguments.length<2||typeof l!="string"?(r=o,o=l,l=null):r=arguments[2],t(l)?(a=e.call(l,"c"),n=e.call(l,"e"),s=e.call(l,"w")):(a=s=!0,n=!1),c={value:o,configurable:a,enumerable:n,writable:s},r?p(u(r),c):c}).gs=function(l,o,a){var n,s,r,c;return typeof l!="string"?(r=a,a=o,o=l,l=null):r=arguments[3],t(o)?h(o)?t(a)?h(a)||(r=a,a=void 0):a=void 0:(r=o,o=a=void 0):o=void 0,t(l)?(n=e.call(l,"c"),s=e.call(l,"e")):(n=!0,s=!1),c={get:o,set:a,configurable:n,enumerable:s},r?p(u(r),c):c}},{"es5-ext/object/assign":202,"es5-ext/object/normalize-options":214,"es5-ext/string/#/contains":221,"type/plain-function/is":612,"type/value/is":616}],162:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:t.d3=t.d3||{})})(this,function(t){function h(S,P){return S<P?-1:S>P?1:S>=P?0:NaN}function p(S){var P;return S.length===1&&(P=S,S=function(z,F){return h(P(z),F)}),{left:function(z,F,q,W){for(q==null&&(q=0),W==null&&(W=z.length);q<W;){var X=q+W>>>1;S(z[X],F)<0?q=X+1:W=X}return q},right:function(z,F,q,W){for(q==null&&(q=0),W==null&&(W=z.length);q<W;){var X=q+W>>>1;S(z[X],F)>0?W=X:q=X+1}return q}}}var u=p(h),e=u.right,l=u.left;function o(S,P){return[S,P]}function a(S){return S===null?NaN:+S}function n(S,P){var z,F,q=S.length,W=0,X=-1,Q=0,Z=0;if(P==null)for(;++X<q;)isNaN(z=a(S[X]))||(Z+=(F=z-Q)*(z-(Q+=F/++W)));else for(;++X<q;)isNaN(z=a(P(S[X],X,S)))||(Z+=(F=z-Q)*(z-(Q+=F/++W)));if(W>1)return Z/(W-1)}function s(S,P){var z=n(S,P);return z&&Math.sqrt(z)}function r(S,P){var z,F,q,W=S.length,X=-1;if(P==null){for(;++X<W;)if((z=S[X])!=null&&z>=z)for(F=q=z;++X<W;)(z=S[X])!=null&&(F>z&&(F=z),q<z&&(q=z))}else for(;++X<W;)if((z=P(S[X],X,S))!=null&&z>=z)for(F=q=z;++X<W;)(z=P(S[X],X,S))!=null&&(F>z&&(F=z),q<z&&(q=z));return[F,q]}var c=Array.prototype,f=c.slice,d=c.map;function g(S){return function(){return S}}function m(S){return S}function y(S,P,z){S=+S,P=+P,z=(q=arguments.length)<2?(P=S,S=0,1):q<3?1:+z;for(var F=-1,q=0|Math.max(0,Math.ceil((P-S)/z)),W=new Array(q);++F<q;)W[F]=S+F*z;return W}var v=Math.sqrt(50),T=Math.sqrt(10),_=Math.sqrt(2);function k(S,P,z){var F=(P-S)/Math.max(0,z),q=Math.floor(Math.log(F)/Math.LN10),W=F/Math.pow(10,q);return q>=0?(W>=v?10:W>=T?5:W>=_?2:1)*Math.pow(10,q):-Math.pow(10,-q)/(W>=v?10:W>=T?5:W>=_?2:1)}function E(S,P,z){var F=Math.abs(P-S)/Math.max(0,z),q=Math.pow(10,Math.floor(Math.log(F)/Math.LN10)),W=F/q;return W>=v?q*=10:W>=T?q*=5:W>=_&&(q*=2),P<S?-q:q}function A(S){return Math.ceil(Math.log(S.length)/Math.LN2)+1}function b(S,P,z){if(z==null&&(z=a),F=S.length){if((P=+P)<=0||F<2)return+z(S[0],0,S);if(P>=1)return+z(S[F-1],F-1,S);var F,q=(F-1)*P,W=Math.floor(q),X=+z(S[W],W,S);return X+(+z(S[W+1],W+1,S)-X)*(q-W)}}function L(S,P){var z,F,q=S.length,W=-1;if(P==null){for(;++W<q;)if((z=S[W])!=null&&z>=z)for(F=z;++W<q;)(z=S[W])!=null&&F>z&&(F=z)}else for(;++W<q;)if((z=P(S[W],W,S))!=null&&z>=z)for(F=z;++W<q;)(z=P(S[W],W,S))!=null&&F>z&&(F=z);return F}function w(S){if(!(q=S.length))return[];for(var P=-1,z=L(S,C),F=new Array(z);++P<z;)for(var q,W=-1,X=F[P]=new Array(q);++W<q;)X[W]=S[W][P];return F}function C(S){return S.length}t.bisect=e,t.bisectRight=e,t.bisectLeft=l,t.ascending=h,t.bisector=p,t.cross=function(S,P,z){var F,q,W,X,Q=S.length,Z=P.length,Y=new Array(Q*Z);for(z==null&&(z=o),F=W=0;F<Q;++F)for(X=S[F],q=0;q<Z;++q,++W)Y[W]=z(X,P[q]);return Y},t.descending=function(S,P){return P<S?-1:P>S?1:P>=S?0:NaN},t.deviation=s,t.extent=r,t.histogram=function(){var S=m,P=r,z=A;function F(q){var W,X,Q=q.length,Z=new Array(Q);for(W=0;W<Q;++W)Z[W]=S(q[W],W,q);var Y=P(Z),N=Y[0],J=Y[1],D=z(Z,N,J);Array.isArray(D)||(D=E(N,J,D),D=y(Math.ceil(N/D)*D,J,D));for(var U=D.length;D[0]<=N;)D.shift(),--U;for(;D[U-1]>J;)D.pop(),--U;var G,$=new Array(U+1);for(W=0;W<=U;++W)(G=$[W]=[]).x0=W>0?D[W-1]:N,G.x1=W<U?D[W]:J;for(W=0;W<Q;++W)N<=(X=Z[W])&&X<=J&&$[e(D,X,0,U)].push(q[W]);return $}return F.value=function(q){return arguments.length?(S=typeof q=="function"?q:g(q),F):S},F.domain=function(q){return arguments.length?(P=typeof q=="function"?q:g([q[0],q[1]]),F):P},F.thresholds=function(q){return arguments.length?(z=typeof q=="function"?q:Array.isArray(q)?g(f.call(q)):g(q),F):z},F},t.thresholdFreedmanDiaconis=function(S,P,z){return S=d.call(S,a).sort(h),Math.ceil((z-P)/(2*(b(S,.75)-b(S,.25))*Math.pow(S.length,-1/3)))},t.thresholdScott=function(S,P,z){return Math.ceil((z-P)/(3.5*s(S)*Math.pow(S.length,-1/3)))},t.thresholdSturges=A,t.max=function(S,P){var z,F,q=S.length,W=-1;if(P==null){for(;++W<q;)if((z=S[W])!=null&&z>=z)for(F=z;++W<q;)(z=S[W])!=null&&z>F&&(F=z)}else for(;++W<q;)if((z=P(S[W],W,S))!=null&&z>=z)for(F=z;++W<q;)(z=P(S[W],W,S))!=null&&z>F&&(F=z);return F},t.mean=function(S,P){var z,F=S.length,q=F,W=-1,X=0;if(P==null)for(;++W<F;)isNaN(z=a(S[W]))?--q:X+=z;else for(;++W<F;)isNaN(z=a(P(S[W],W,S)))?--q:X+=z;if(q)return X/q},t.median=function(S,P){var z,F=S.length,q=-1,W=[];if(P==null)for(;++q<F;)isNaN(z=a(S[q]))||W.push(z);else for(;++q<F;)isNaN(z=a(P(S[q],q,S)))||W.push(z);return b(W.sort(h),.5)},t.merge=function(S){for(var P,z,F,q=S.length,W=-1,X=0;++W<q;)X+=S[W].length;for(z=new Array(X);--q>=0;)for(P=(F=S[q]).length;--P>=0;)z[--X]=F[P];return z},t.min=L,t.pairs=function(S,P){P==null&&(P=o);for(var z=0,F=S.length-1,q=S[0],W=new Array(F<0?0:F);z<F;)W[z]=P(q,q=S[++z]);return W},t.permute=function(S,P){for(var z=P.length,F=new Array(z);z--;)F[z]=S[P[z]];return F},t.quantile=b,t.range=y,t.scan=function(S,P){if(z=S.length){var z,F,q=0,W=0,X=S[W];for(P==null&&(P=h);++q<z;)(P(F=S[q],X)<0||P(X,X)!==0)&&(X=F,W=q);return P(X,X)===0?W:void 0}},t.shuffle=function(S,P,z){for(var F,q,W=(z??S.length)-(P=P==null?0:+P);W;)q=Math.random()*W--|0,F=S[W+P],S[W+P]=S[q+P],S[q+P]=F;return S},t.sum=function(S,P){var z,F=S.length,q=-1,W=0;if(P==null)for(;++q<F;)(z=+S[q])&&(W+=z);else for(;++q<F;)(z=+P(S[q],q,S))&&(W+=z);return W},t.ticks=function(S,P,z){var F,q,W,X,Q=-1;if(z=+z,(S=+S)==(P=+P)&&z>0)return[S];if((F=P<S)&&(q=S,S=P,P=q),(X=k(S,P,z))===0||!isFinite(X))return[];if(X>0)for(S=Math.ceil(S/X),P=Math.floor(P/X),W=new Array(q=Math.ceil(P-S+1));++Q<q;)W[Q]=(S+Q)*X;else for(S=Math.floor(S*X),P=Math.ceil(P*X),W=new Array(q=Math.ceil(S-P+1));++Q<q;)W[Q]=(S-Q)/X;return F&&W.reverse(),W},t.tickIncrement=k,t.tickStep=E,t.transpose=w,t.variance=n,t.zip=function(){return w(arguments)},Object.defineProperty(t,"__esModule",{value:!0})})},{}],163:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:t.d3=t.d3||{})})(this,function(t){function h(){}function p(r,c){var f=new h;if(r instanceof h)r.each(function(v,T){f.set(T,v)});else if(Array.isArray(r)){var d,g=-1,m=r.length;if(c==null)for(;++g<m;)f.set(g,r[g]);else for(;++g<m;)f.set(c(d=r[g],g,r),d)}else if(r)for(var y in r)f.set(y,r[y]);return f}function u(){return{}}function e(r,c,f){r[c]=f}function l(){return p()}function o(r,c,f){r.set(c,f)}function a(){}h.prototype=p.prototype={constructor:h,has:function(r){return"$"+r in this},get:function(r){return this["$"+r]},set:function(r,c){return this["$"+r]=c,this},remove:function(r){var c="$"+r;return c in this&&delete this[c]},clear:function(){for(var r in this)r[0]==="$"&&delete this[r]},keys:function(){var r=[];for(var c in this)c[0]==="$"&&r.push(c.slice(1));return r},values:function(){var r=[];for(var c in this)c[0]==="$"&&r.push(this[c]);return r},entries:function(){var r=[];for(var c in this)c[0]==="$"&&r.push({key:c.slice(1),value:this[c]});return r},size:function(){var r=0;for(var c in this)c[0]==="$"&&++r;return r},empty:function(){for(var r in this)if(r[0]==="$")return!1;return!0},each:function(r){for(var c in this)c[0]==="$"&&r(this[c],c.slice(1),this)}};var n=p.prototype;function s(r,c){var f=new a;if(r instanceof a)r.each(function(m){f.add(m)});else if(r){var d=-1,g=r.length;if(c==null)for(;++d<g;)f.add(r[d]);else for(;++d<g;)f.add(c(r[d],d,r))}return f}a.prototype=s.prototype={constructor:a,has:n.has,add:function(r){return this["$"+(r+="")]=r,this},remove:n.remove,clear:n.clear,values:n.keys,size:n.size,empty:n.empty,each:n.each},t.nest=function(){var r,c,f,d=[],g=[];function m(y,v,T,_){if(v>=d.length)return r!=null&&y.sort(r),c!=null?c(y):y;for(var k,E,A,b=-1,L=y.length,w=d[v++],C=p(),S=T();++b<L;)(A=C.get(k=w(E=y[b])+""))?A.push(E):C.set(k,[E]);return C.each(function(P,z){_(S,z,m(P,v,T,_))}),S}return f={object:function(y){return m(y,0,u,e)},map:function(y){return m(y,0,l,o)},entries:function(y){return function v(T,_){if(++_>d.length)return T;var k,E=g[_-1];return c!=null&&_>=d.length?k=T.entries():(k=[],T.each(function(A,b){k.push({key:b,values:v(A,_)})})),E!=null?k.sort(function(A,b){return E(A.key,b.key)}):k}(m(y,0,l,o),0)},key:function(y){return d.push(y),f},sortKeys:function(y){return g[d.length-1]=y,f},sortValues:function(y){return r=y,f},rollup:function(y){return c=y,f}}},t.set=s,t.map=p,t.keys=function(r){var c=[];for(var f in r)c.push(f);return c},t.values=function(r){var c=[];for(var f in r)c.push(r[f]);return c},t.entries=function(r){var c=[];for(var f in r)c.push({key:f,value:r[f]});return c},Object.defineProperty(t,"__esModule",{value:!0})})},{}],164:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:(t=t||self).d3=t.d3||{})})(this,function(t){function h(fe,ge,ke){fe.prototype=ge.prototype=ke,ke.constructor=fe}function p(fe,ge){var ke=Object.create(fe.prototype);for(var Me in ge)ke[Me]=ge[Me];return ke}function u(){}var e="\\s*([+-]?\\d+)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",o="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",a=/^#([0-9a-f]{3,8})$/,n=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),s=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),r=new RegExp("^rgba\\("+[e,e,e,l]+"\\)$"),c=new RegExp("^rgba\\("+[o,o,o,l]+"\\)$"),f=new RegExp("^hsl\\("+[l,o,o]+"\\)$"),d=new RegExp("^hsla\\("+[l,o,o,l]+"\\)$"),g={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function m(){return this.rgb().formatHex()}function y(){return this.rgb().formatRgb()}function v(fe){var ge,ke;return fe=(fe+"").trim().toLowerCase(),(ge=a.exec(fe))?(ke=ge[1].length,ge=parseInt(ge[1],16),ke===6?T(ge):ke===3?new A(ge>>8&15|ge>>4&240,ge>>4&15|240&ge,(15&ge)<<4|15&ge,1):ke===8?_(ge>>24&255,ge>>16&255,ge>>8&255,(255&ge)/255):ke===4?_(ge>>12&15|ge>>8&240,ge>>8&15|ge>>4&240,ge>>4&15|240&ge,((15&ge)<<4|15&ge)/255):null):(ge=n.exec(fe))?new A(ge[1],ge[2],ge[3],1):(ge=s.exec(fe))?new A(255*ge[1]/100,255*ge[2]/100,255*ge[3]/100,1):(ge=r.exec(fe))?_(ge[1],ge[2],ge[3],ge[4]):(ge=c.exec(fe))?_(255*ge[1]/100,255*ge[2]/100,255*ge[3]/100,ge[4]):(ge=f.exec(fe))?C(ge[1],ge[2]/100,ge[3]/100,1):(ge=d.exec(fe))?C(ge[1],ge[2]/100,ge[3]/100,ge[4]):g.hasOwnProperty(fe)?T(g[fe]):fe==="transparent"?new A(NaN,NaN,NaN,0):null}function T(fe){return new A(fe>>16&255,fe>>8&255,255&fe,1)}function _(fe,ge,ke,Me){return Me<=0&&(fe=ge=ke=NaN),new A(fe,ge,ke,Me)}function k(fe){return fe instanceof u||(fe=v(fe)),fe?new A((fe=fe.rgb()).r,fe.g,fe.b,fe.opacity):new A}function E(fe,ge,ke,Me){return arguments.length===1?k(fe):new A(fe,ge,ke,Me??1)}function A(fe,ge,ke,Me){this.r=+fe,this.g=+ge,this.b=+ke,this.opacity=+Me}function b(){return"#"+w(this.r)+w(this.g)+w(this.b)}function L(){var fe=this.opacity;return((fe=isNaN(fe)?1:Math.max(0,Math.min(1,fe)))===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(fe===1?")":", "+fe+")")}function w(fe){return((fe=Math.max(0,Math.min(255,Math.round(fe)||0)))<16?"0":"")+fe.toString(16)}function C(fe,ge,ke,Me){return Me<=0?fe=ge=ke=NaN:ke<=0||ke>=1?fe=ge=NaN:ge<=0&&(fe=NaN),new z(fe,ge,ke,Me)}function S(fe){if(fe instanceof z)return new z(fe.h,fe.s,fe.l,fe.opacity);if(fe instanceof u||(fe=v(fe)),!fe)return new z;if(fe instanceof z)return fe;var ge=(fe=fe.rgb()).r/255,ke=fe.g/255,Me=fe.b/255,Se=Math.min(ge,ke,Me),De=Math.max(ge,ke,Me),Be=NaN,We=De-Se,Qe=(De+Se)/2;return We?(Be=ge===De?(ke-Me)/We+6*(ke<Me):ke===De?(Me-ge)/We+2:(ge-ke)/We+4,We/=Qe<.5?De+Se:2-De-Se,Be*=60):We=Qe>0&&Qe<1?0:Be,new z(Be,We,Qe,fe.opacity)}function P(fe,ge,ke,Me){return arguments.length===1?S(fe):new z(fe,ge,ke,Me??1)}function z(fe,ge,ke,Me){this.h=+fe,this.s=+ge,this.l=+ke,this.opacity=+Me}function F(fe,ge,ke){return 255*(fe<60?ge+(ke-ge)*fe/60:fe<180?ke:fe<240?ge+(ke-ge)*(240-fe)/60:ge)}h(u,v,{copy:function(fe){return Object.assign(new this.constructor,this,fe)},displayable:function(){return this.rgb().displayable()},hex:m,formatHex:m,formatHsl:function(){return S(this).formatHsl()},formatRgb:y,toString:y}),h(A,E,p(u,{brighter:function(fe){return fe=fe==null?1/.7:Math.pow(1/.7,fe),new A(this.r*fe,this.g*fe,this.b*fe,this.opacity)},darker:function(fe){return fe=fe==null?.7:Math.pow(.7,fe),new A(this.r*fe,this.g*fe,this.b*fe,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:b,formatHex:b,formatRgb:L,toString:L})),h(z,P,p(u,{brighter:function(fe){return fe=fe==null?1/.7:Math.pow(1/.7,fe),new z(this.h,this.s,this.l*fe,this.opacity)},darker:function(fe){return fe=fe==null?.7:Math.pow(.7,fe),new z(this.h,this.s,this.l*fe,this.opacity)},rgb:function(){var fe=this.h%360+360*(this.h<0),ge=isNaN(fe)||isNaN(this.s)?0:this.s,ke=this.l,Me=ke+(ke<.5?ke:1-ke)*ge,Se=2*ke-Me;return new A(F(fe>=240?fe-240:fe+120,Se,Me),F(fe,Se,Me),F(fe<120?fe+240:fe-120,Se,Me),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var fe=this.opacity;return((fe=isNaN(fe)?1:Math.max(0,Math.min(1,fe)))===1?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(fe===1?")":", "+fe+")")}}));var q=Math.PI/180,W=180/Math.PI,X=6/29,Q=3*X*X;function Z(fe){if(fe instanceof N)return new N(fe.l,fe.a,fe.b,fe.opacity);if(fe instanceof re)return ne(fe);fe instanceof A||(fe=k(fe));var ge,ke,Me=G(fe.r),Se=G(fe.g),De=G(fe.b),Be=J((.2225045*Me+.7168786*Se+.0606169*De)/1);return Me===Se&&Se===De?ge=ke=Be:(ge=J((.4360747*Me+.3850649*Se+.1430804*De)/.96422),ke=J((.0139322*Me+.0971045*Se+.7141733*De)/.82521)),new N(116*Be-16,500*(ge-Be),200*(Be-ke),fe.opacity)}function Y(fe,ge,ke,Me){return arguments.length===1?Z(fe):new N(fe,ge,ke,Me??1)}function N(fe,ge,ke,Me){this.l=+fe,this.a=+ge,this.b=+ke,this.opacity=+Me}function J(fe){return fe>.008856451679035631?Math.pow(fe,1/3):fe/Q+4/29}function D(fe){return fe>X?fe*fe*fe:Q*(fe-4/29)}function U(fe){return 255*(fe<=.0031308?12.92*fe:1.055*Math.pow(fe,1/2.4)-.055)}function G(fe){return(fe/=255)<=.04045?fe/12.92:Math.pow((fe+.055)/1.055,2.4)}function $(fe){if(fe instanceof re)return new re(fe.h,fe.c,fe.l,fe.opacity);if(fe instanceof N||(fe=Z(fe)),fe.a===0&&fe.b===0)return new re(NaN,0<fe.l&&fe.l<100?0:NaN,fe.l,fe.opacity);var ge=Math.atan2(fe.b,fe.a)*W;return new re(ge<0?ge+360:ge,Math.sqrt(fe.a*fe.a+fe.b*fe.b),fe.l,fe.opacity)}function K(fe,ge,ke,Me){return arguments.length===1?$(fe):new re(fe,ge,ke,Me??1)}function re(fe,ge,ke,Me){this.h=+fe,this.c=+ge,this.l=+ke,this.opacity=+Me}function ne(fe){if(isNaN(fe.h))return new N(fe.l,0,0,fe.opacity);var ge=fe.h*q;return new N(fe.l,Math.cos(ge)*fe.c,Math.sin(ge)*fe.c,fe.opacity)}h(N,Y,p(u,{brighter:function(fe){return new N(this.l+18*(fe??1),this.a,this.b,this.opacity)},darker:function(fe){return new N(this.l-18*(fe??1),this.a,this.b,this.opacity)},rgb:function(){var fe=(this.l+16)/116,ge=isNaN(this.a)?fe:fe+this.a/500,ke=isNaN(this.b)?fe:fe-this.b/200;return new A(U(3.1338561*(ge=.96422*D(ge))-1.6168667*(fe=1*D(fe))-.4906146*(ke=.82521*D(ke))),U(-.9787684*ge+1.9161415*fe+.033454*ke),U(.0719453*ge-.2289914*fe+1.4052427*ke),this.opacity)}})),h(re,K,p(u,{brighter:function(fe){return new re(this.h,this.c,this.l+18*(fe??1),this.opacity)},darker:function(fe){return new re(this.h,this.c,this.l-18*(fe??1),this.opacity)},rgb:function(){return ne(this).rgb()}}));var ae=-.14861,ie=1.78277,he=-.29227,se=-.90649,de=1.97294,ce=de*se,ve=de*ie,Ee=ie*he-se*ae;function Le(fe){if(fe instanceof xe)return new xe(fe.h,fe.s,fe.l,fe.opacity);fe instanceof A||(fe=k(fe));var ge=fe.r/255,ke=fe.g/255,Me=fe.b/255,Se=(Ee*Me+ce*ge-ve*ke)/(Ee+ce-ve),De=Me-Se,Be=(de*(ke-Se)-he*De)/se,We=Math.sqrt(Be*Be+De*De)/(de*Se*(1-Se)),Qe=We?Math.atan2(Be,De)*W-120:NaN;return new xe(Qe<0?Qe+360:Qe,We,Se,fe.opacity)}function Te(fe,ge,ke,Me){return arguments.length===1?Le(fe):new xe(fe,ge,ke,Me??1)}function xe(fe,ge,ke,Me){this.h=+fe,this.s=+ge,this.l=+ke,this.opacity=+Me}h(xe,Te,p(u,{brighter:function(fe){return fe=fe==null?1/.7:Math.pow(1/.7,fe),new xe(this.h,this.s,this.l*fe,this.opacity)},darker:function(fe){return fe=fe==null?.7:Math.pow(.7,fe),new xe(this.h,this.s,this.l*fe,this.opacity)},rgb:function(){var fe=isNaN(this.h)?0:(this.h+120)*q,ge=+this.l,ke=isNaN(this.s)?0:this.s*ge*(1-ge),Me=Math.cos(fe),Se=Math.sin(fe);return new A(255*(ge+ke*(ae*Me+ie*Se)),255*(ge+ke*(he*Me+se*Se)),255*(ge+ke*(de*Me)),this.opacity)}})),t.color=v,t.cubehelix=Te,t.gray=function(fe,ge){return new N(fe,0,0,ge??1)},t.hcl=K,t.hsl=P,t.lab=Y,t.lch=function(fe,ge,ke,Me){return arguments.length===1?$(fe):new re(ke,ge,fe,Me??1)},t.rgb=E,Object.defineProperty(t,"__esModule",{value:!0})})},{}],165:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:(t=t||self).d3=t.d3||{})})(this,function(t){var h={value:function(){}};function p(){for(var a,n=0,s=arguments.length,r={};n<s;++n){if(!(a=arguments[n]+"")||a in r||/[\s.]/.test(a))throw new Error("illegal type: "+a);r[a]=[]}return new u(r)}function u(a){this._=a}function e(a,n){return a.trim().split(/^|\s+/).map(function(s){var r="",c=s.indexOf(".");if(c>=0&&(r=s.slice(c+1),s=s.slice(0,c)),s&&!n.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:r}})}function l(a,n){for(var s,r=0,c=a.length;r<c;++r)if((s=a[r]).name===n)return s.value}function o(a,n,s){for(var r=0,c=a.length;r<c;++r)if(a[r].name===n){a[r]=h,a=a.slice(0,r).concat(a.slice(r+1));break}return s!=null&&a.push({name:n,value:s}),a}u.prototype=p.prototype={constructor:u,on:function(a,n){var s,r=this._,c=e(a+"",r),f=-1,d=c.length;if(!(arguments.length<2)){if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++f<d;)if(s=(a=c[f]).type)r[s]=o(r[s],a.name,n);else if(n==null)for(s in r)r[s]=o(r[s],a.name,null);return this}for(;++f<d;)if((s=(a=c[f]).type)&&(s=l(r[s],a.name)))return s},copy:function(){var a={},n=this._;for(var s in n)a[s]=n[s].slice();return new u(a)},call:function(a,n){if((s=arguments.length-2)>0)for(var s,r,c=new Array(s),f=0;f<s;++f)c[f]=arguments[f+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(f=0,s=(r=this._[a]).length;f<s;++f)r[f].value.apply(n,c)},apply:function(a,n,s){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var r=this._[a],c=0,f=r.length;c<f;++c)r[c].value.apply(n,s)}},t.dispatch=p,Object.defineProperty(t,"__esModule",{value:!0})})},{}],166:[function(i,B,V){(function(t,h){typeof V=="object"&&B!==void 0?h(V,i("d3-quadtree"),i("d3-collection"),i("d3-dispatch"),i("d3-timer")):h(t.d3=t.d3||{},t.d3,t.d3,t.d3,t.d3)})(this,function(t,h,p,u,e){function l(g){return function(){return g}}function o(){return 1e-6*(Math.random()-.5)}function a(g){return g.x+g.vx}function n(g){return g.y+g.vy}function s(g){return g.index}function r(g,m){var y=g.get(m);if(!y)throw new Error("missing: "+m);return y}function c(g){return g.x}function f(g){return g.y}var d=Math.PI*(3-Math.sqrt(5));t.forceCenter=function(g,m){var y;function v(){var T,_,k=y.length,E=0,A=0;for(T=0;T<k;++T)E+=(_=y[T]).x,A+=_.y;for(E=E/k-g,A=A/k-m,T=0;T<k;++T)(_=y[T]).x-=E,_.y-=A}return g==null&&(g=0),m==null&&(m=0),v.initialize=function(T){y=T},v.x=function(T){return arguments.length?(g=+T,v):g},v.y=function(T){return arguments.length?(m=+T,v):m},v},t.forceCollide=function(g){var m,y,v=1,T=1;function _(){for(var A,b,L,w,C,S,P,z=m.length,F=0;F<T;++F)for(b=h.quadtree(m,a,n).visitAfter(k),A=0;A<z;++A)L=m[A],S=y[L.index],P=S*S,w=L.x+L.vx,C=L.y+L.vy,b.visit(q);function q(W,X,Q,Z,Y){var N=W.data,J=W.r,D=S+J;if(!N)return X>w+D||Z<w-D||Q>C+D||Y<C-D;if(N.index>L.index){var U=w-N.x-N.vx,G=C-N.y-N.vy,$=U*U+G*G;$<D*D&&(U===0&&($+=(U=o())*U),G===0&&($+=(G=o())*G),$=(D-($=Math.sqrt($)))/$*v,L.vx+=(U*=$)*(D=(J*=J)/(P+J)),L.vy+=(G*=$)*D,N.vx-=U*(D=1-D),N.vy-=G*D)}}}function k(A){if(A.data)return A.r=y[A.data.index];for(var b=A.r=0;b<4;++b)A[b]&&A[b].r>A.r&&(A.r=A[b].r)}function E(){if(m){var A,b,L=m.length;for(y=new Array(L),A=0;A<L;++A)b=m[A],y[b.index]=+g(b,A,m)}}return typeof g!="function"&&(g=l(g==null?1:+g)),_.initialize=function(A){m=A,E()},_.iterations=function(A){return arguments.length?(T=+A,_):T},_.strength=function(A){return arguments.length?(v=+A,_):v},_.radius=function(A){return arguments.length?(g=typeof A=="function"?A:l(+A),E(),_):g},_},t.forceLink=function(g){var m,y,v,T,_,k=s,E=function(P){return 1/Math.min(T[P.source.index],T[P.target.index])},A=l(30),b=1;function L(P){for(var z=0,F=g.length;z<b;++z)for(var q,W,X,Q,Z,Y,N,J=0;J<F;++J)W=(q=g[J]).source,Q=(X=q.target).x+X.vx-W.x-W.vx||o(),Z=X.y+X.vy-W.y-W.vy||o(),Q*=Y=((Y=Math.sqrt(Q*Q+Z*Z))-y[J])/Y*P*m[J],Z*=Y,X.vx-=Q*(N=_[J]),X.vy-=Z*N,W.vx+=Q*(N=1-N),W.vy+=Z*N}function w(){if(v){var P,z,F=v.length,q=g.length,W=p.map(v,k);for(P=0,T=new Array(F);P<q;++P)(z=g[P]).index=P,typeof z.source!="object"&&(z.source=r(W,z.source)),typeof z.target!="object"&&(z.target=r(W,z.target)),T[z.source.index]=(T[z.source.index]||0)+1,T[z.target.index]=(T[z.target.index]||0)+1;for(P=0,_=new Array(q);P<q;++P)z=g[P],_[P]=T[z.source.index]/(T[z.source.index]+T[z.target.index]);m=new Array(q),C(),y=new Array(q),S()}}function C(){if(v)for(var P=0,z=g.length;P<z;++P)m[P]=+E(g[P],P,g)}function S(){if(v)for(var P=0,z=g.length;P<z;++P)y[P]=+A(g[P],P,g)}return g==null&&(g=[]),L.initialize=function(P){v=P,w()},L.links=function(P){return arguments.length?(g=P,w(),L):g},L.id=function(P){return arguments.length?(k=P,L):k},L.iterations=function(P){return arguments.length?(b=+P,L):b},L.strength=function(P){return arguments.length?(E=typeof P=="function"?P:l(+P),C(),L):E},L.distance=function(P){return arguments.length?(A=typeof P=="function"?P:l(+P),S(),L):A},L},t.forceManyBody=function(){var g,m,y,v,T=l(-30),_=1,k=1/0,E=.81;function A(C){var S,P=g.length,z=h.quadtree(g,c,f).visitAfter(L);for(y=C,S=0;S<P;++S)m=g[S],z.visit(w)}function b(){if(g){var C,S,P=g.length;for(v=new Array(P),C=0;C<P;++C)S=g[C],v[S.index]=+T(S,C,g)}}function L(C){var S,P,z,F,q,W=0,X=0;if(C.length){for(z=F=q=0;q<4;++q)(S=C[q])&&(P=Math.abs(S.value))&&(W+=S.value,X+=P,z+=P*S.x,F+=P*S.y);C.x=z/X,C.y=F/X}else{(S=C).x=S.data.x,S.y=S.data.y;do W+=v[S.data.index];while(S=S.next)}C.value=W}function w(C,S,P,z){if(!C.value)return!0;var F=C.x-m.x,q=C.y-m.y,W=z-S,X=F*F+q*q;if(W*W/E<X)return X<k&&(F===0&&(X+=(F=o())*F),q===0&&(X+=(q=o())*q),X<_&&(X=Math.sqrt(_*X)),m.vx+=F*C.value*y/X,m.vy+=q*C.value*y/X),!0;if(!(C.length||X>=k)){(C.data!==m||C.next)&&(F===0&&(X+=(F=o())*F),q===0&&(X+=(q=o())*q),X<_&&(X=Math.sqrt(_*X)));do C.data!==m&&(W=v[C.data.index]*y/X,m.vx+=F*W,m.vy+=q*W);while(C=C.next)}}return A.initialize=function(C){g=C,b()},A.strength=function(C){return arguments.length?(T=typeof C=="function"?C:l(+C),b(),A):T},A.distanceMin=function(C){return arguments.length?(_=C*C,A):Math.sqrt(_)},A.distanceMax=function(C){return arguments.length?(k=C*C,A):Math.sqrt(k)},A.theta=function(C){return arguments.length?(E=C*C,A):Math.sqrt(E)},A},t.forceRadial=function(g,m,y){var v,T,_,k=l(.1);function E(b){for(var L=0,w=v.length;L<w;++L){var C=v[L],S=C.x-m||1e-6,P=C.y-y||1e-6,z=Math.sqrt(S*S+P*P),F=(_[L]-z)*T[L]*b/z;C.vx+=S*F,C.vy+=P*F}}function A(){if(v){var b,L=v.length;for(T=new Array(L),_=new Array(L),b=0;b<L;++b)_[b]=+g(v[b],b,v),T[b]=isNaN(_[b])?0:+k(v[b],b,v)}}return typeof g!="function"&&(g=l(+g)),m==null&&(m=0),y==null&&(y=0),E.initialize=function(b){v=b,A()},E.strength=function(b){return arguments.length?(k=typeof b=="function"?b:l(+b),A(),E):k},E.radius=function(b){return arguments.length?(g=typeof b=="function"?b:l(+b),A(),E):g},E.x=function(b){return arguments.length?(m=+b,E):m},E.y=function(b){return arguments.length?(y=+b,E):y},E},t.forceSimulation=function(g){var m,y=1,v=.001,T=1-Math.pow(v,1/300),_=0,k=.6,E=p.map(),A=e.timer(L),b=u.dispatch("tick","end");function L(){w(),b.call("tick",m),y<v&&(A.stop(),b.call("end",m))}function w(P){var z,F,q=g.length;P===void 0&&(P=1);for(var W=0;W<P;++W)for(y+=(_-y)*T,E.each(function(X){X(y)}),z=0;z<q;++z)(F=g[z]).fx==null?F.x+=F.vx*=k:(F.x=F.fx,F.vx=0),F.fy==null?F.y+=F.vy*=k:(F.y=F.fy,F.vy=0);return m}function C(){for(var P,z=0,F=g.length;z<F;++z){if((P=g[z]).index=z,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var q=10*Math.sqrt(z),W=z*d;P.x=q*Math.cos(W),P.y=q*Math.sin(W)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function S(P){return P.initialize&&P.initialize(g),P}return g==null&&(g=[]),C(),m={tick:w,restart:function(){return A.restart(L),m},stop:function(){return A.stop(),m},nodes:function(P){return arguments.length?(g=P,C(),E.each(S),m):g},alpha:function(P){return arguments.length?(y=+P,m):y},alphaMin:function(P){return arguments.length?(v=+P,m):v},alphaDecay:function(P){return arguments.length?(T=+P,m):+T},alphaTarget:function(P){return arguments.length?(_=+P,m):_},velocityDecay:function(P){return arguments.length?(k=1-P,m):1-k},force:function(P,z){return arguments.length>1?(z==null?E.remove(P):E.set(P,S(z)),m):E.get(P)},find:function(P,z,F){var q,W,X,Q,Z,Y=0,N=g.length;for(F==null?F=1/0:F*=F,Y=0;Y<N;++Y)(X=(q=P-(Q=g[Y]).x)*q+(W=z-Q.y)*W)<F&&(Z=Q,F=X);return Z},on:function(P,z){return arguments.length>1?(b.on(P,z),m):b.on(P)}}},t.forceX=function(g){var m,y,v,T=l(.1);function _(E){for(var A,b=0,L=m.length;b<L;++b)(A=m[b]).vx+=(v[b]-A.x)*y[b]*E}function k(){if(m){var E,A=m.length;for(y=new Array(A),v=new Array(A),E=0;E<A;++E)y[E]=isNaN(v[E]=+g(m[E],E,m))?0:+T(m[E],E,m)}}return typeof g!="function"&&(g=l(g==null?0:+g)),_.initialize=function(E){m=E,k()},_.strength=function(E){return arguments.length?(T=typeof E=="function"?E:l(+E),k(),_):T},_.x=function(E){return arguments.length?(g=typeof E=="function"?E:l(+E),k(),_):g},_},t.forceY=function(g){var m,y,v,T=l(.1);function _(E){for(var A,b=0,L=m.length;b<L;++b)(A=m[b]).vy+=(v[b]-A.y)*y[b]*E}function k(){if(m){var E,A=m.length;for(y=new Array(A),v=new Array(A),E=0;E<A;++E)y[E]=isNaN(v[E]=+g(m[E],E,m))?0:+T(m[E],E,m)}}return typeof g!="function"&&(g=l(g==null?0:+g)),_.initialize=function(E){m=E,k()},_.strength=function(E){return arguments.length?(T=typeof E=="function"?E:l(+E),k(),_):T},_.y=function(E){return arguments.length?(g=typeof E=="function"?E:l(+E),k(),_):g},_},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-collection":163,"d3-dispatch":165,"d3-quadtree":173,"d3-timer":178}],167:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:(t=typeof globalThis<"u"?globalThis:t||self).d3=t.d3||{})})(this,function(t){function h(m,y){if((v=(m=y?m.toExponential(y-1):m.toExponential()).indexOf("e"))<0)return null;var v,T=m.slice(0,v);return[T.length>1?T[0]+T.slice(2):T,+m.slice(v+1)]}function p(m){return(m=h(Math.abs(m)))?m[1]:NaN}var u,e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function l(m){if(!(y=e.exec(m)))throw new Error("invalid format: "+m);var y;return new o({fill:y[1],align:y[2],sign:y[3],symbol:y[4],zero:y[5],width:y[6],comma:y[7],precision:y[8]&&y[8].slice(1),trim:y[9],type:y[10]})}function o(m){this.fill=m.fill===void 0?" ":m.fill+"",this.align=m.align===void 0?">":m.align+"",this.sign=m.sign===void 0?"-":m.sign+"",this.symbol=m.symbol===void 0?"":m.symbol+"",this.zero=!!m.zero,this.width=m.width===void 0?void 0:+m.width,this.comma=!!m.comma,this.precision=m.precision===void 0?void 0:+m.precision,this.trim=!!m.trim,this.type=m.type===void 0?"":m.type+""}function a(m,y){var v=h(m,y);if(!v)return m+"";var T=v[0],_=v[1];return _<0?"0."+new Array(-_).join("0")+T:T.length>_+1?T.slice(0,_+1)+"."+T.slice(_+1):T+new Array(_-T.length+2).join("0")}l.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var n={"%":function(m,y){return(100*m).toFixed(y)},b:function(m){return Math.round(m).toString(2)},c:function(m){return m+""},d:function(m){return Math.abs(m=Math.round(m))>=1e21?m.toLocaleString("en").replace(/,/g,""):m.toString(10)},e:function(m,y){return m.toExponential(y)},f:function(m,y){return m.toFixed(y)},g:function(m,y){return m.toPrecision(y)},o:function(m){return Math.round(m).toString(8)},p:function(m,y){return a(100*m,y)},r:a,s:function(m,y){var v=h(m,y);if(!v)return m+"";var T=v[0],_=v[1],k=_-(u=3*Math.max(-8,Math.min(8,Math.floor(_/3))))+1,E=T.length;return k===E?T:k>E?T+new Array(k-E+1).join("0"):k>0?T.slice(0,k)+"."+T.slice(k):"0."+new Array(1-k).join("0")+h(m,Math.max(0,y+k-1))[0]},X:function(m){return Math.round(m).toString(16).toUpperCase()},x:function(m){return Math.round(m).toString(16)}};function s(m){return m}var r,c=Array.prototype.map,f=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function d(m){var y,v,T=m.grouping===void 0||m.thousands===void 0?s:(y=c.call(m.grouping,Number),v=m.thousands+"",function(S,P){for(var z=S.length,F=[],q=0,W=y[0],X=0;z>0&&W>0&&(X+W+1>P&&(W=Math.max(1,P-X)),F.push(S.substring(z-=W,z+W)),!((X+=W+1)>P));)W=y[q=(q+1)%y.length];return F.reverse().join(v)}),_=m.currency===void 0?"":m.currency[0]+"",k=m.currency===void 0?"":m.currency[1]+"",E=m.decimal===void 0?".":m.decimal+"",A=m.numerals===void 0?s:function(S){return function(P){return P.replace(/[0-9]/g,function(z){return S[+z]})}}(c.call(m.numerals,String)),b=m.percent===void 0?"%":m.percent+"",L=m.minus===void 0?"-":m.minus+"",w=m.nan===void 0?"NaN":m.nan+"";function C(S){var P=(S=l(S)).fill,z=S.align,F=S.sign,q=S.symbol,W=S.zero,X=S.width,Q=S.comma,Z=S.precision,Y=S.trim,N=S.type;N==="n"?(Q=!0,N="g"):n[N]||(Z===void 0&&(Z=12),Y=!0,N="g"),(W||P==="0"&&z==="=")&&(W=!0,P="0",z="=");var J=q==="$"?_:q==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",D=q==="$"?k:/[%p]/.test(N)?b:"",U=n[N],G=/[defgprs%]/.test(N);function $(K){var re,ne,ae,ie=J,he=D;if(N==="c")he=U(K)+he,K="";else{var se=(K=+K)<0||1/K<0;if(K=isNaN(K)?w:U(Math.abs(K),Z),Y&&(K=function(ve){e:for(var Ee,Le=ve.length,Te=1,xe=-1;Te<Le;++Te)switch(ve[Te]){case".":xe=Ee=Te;break;case"0":xe===0&&(xe=Te),Ee=Te;break;default:if(!+ve[Te])break e;xe>0&&(xe=0)}return xe>0?ve.slice(0,xe)+ve.slice(Ee+1):ve}(K)),se&&+K==0&&F!=="+"&&(se=!1),ie=(se?F==="("?F:L:F==="-"||F==="("?"":F)+ie,he=(N==="s"?f[8+u/3]:"")+he+(se&&F==="("?")":""),G){for(re=-1,ne=K.length;++re<ne;)if(48>(ae=K.charCodeAt(re))||ae>57){he=(ae===46?E+K.slice(re+1):K.slice(re))+he,K=K.slice(0,re);break}}}Q&&!W&&(K=T(K,1/0));var de=ie.length+K.length+he.length,ce=de<X?new Array(X-de+1).join(P):"";switch(Q&&W&&(K=T(ce+K,ce.length?X-he.length:1/0),ce=""),z){case"<":K=ie+K+he+ce;break;case"=":K=ie+ce+K+he;break;case"^":K=ce.slice(0,de=ce.length>>1)+ie+K+he+ce.slice(de);break;default:K=ce+ie+K+he}return A(K)}return Z=Z===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,Z)):Math.max(0,Math.min(20,Z)),$.toString=function(){return S+""},$}return{format:C,formatPrefix:function(S,P){var z=C(((S=l(S)).type="f",S)),F=3*Math.max(-8,Math.min(8,Math.floor(p(P)/3))),q=Math.pow(10,-F),W=f[8+F/3];return function(X){return z(q*X)+W}}}}function g(m){return r=d(m),t.format=r.format,t.formatPrefix=r.formatPrefix,r}g({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),t.FormatSpecifier=o,t.formatDefaultLocale=g,t.formatLocale=d,t.formatSpecifier=l,t.precisionFixed=function(m){return Math.max(0,-p(Math.abs(m)))},t.precisionPrefix=function(m,y){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(p(y)/3)))-p(Math.abs(m)))},t.precisionRound=function(m,y){return m=Math.abs(m),y=Math.abs(y)-m,Math.max(0,p(y)-p(m))+1},Object.defineProperty(t,"__esModule",{value:!0})})},{}],168:[function(i,B,V){(function(t,h){typeof V=="object"&&B!==void 0?h(V,i("d3-geo"),i("d3-array")):h(t.d3=t.d3||{},t.d3,t.d3)})(this,function(t,h,p){var u=Math.abs,e=Math.atan,l=Math.atan2,o=Math.cos,a=Math.exp,n=Math.floor,s=Math.log,r=Math.max,c=Math.min,f=Math.pow,d=Math.round,g=Math.sign||function(Fe){return Fe>0?1:Fe<0?-1:0},m=Math.sin,y=Math.tan,v=1e-6,T=Math.PI,_=T/2,k=T/4,E=Math.SQRT1_2,A=z(2),b=z(T),L=2*T,w=180/T,C=T/180;function S(Fe){return Fe>1?_:Fe<-1?-_:Math.asin(Fe)}function P(Fe){return Fe>1?0:Fe<-1?T:Math.acos(Fe)}function z(Fe){return Fe>0?Math.sqrt(Fe):0}function F(Fe){return(a(Fe)-a(-Fe))/2}function q(Fe){return(a(Fe)+a(-Fe))/2}function W(Fe){var Ve=y(Fe/2),Je=2*s(o(Fe/2))/(Ve*Ve);function rt(dt,ft){var Tt=o(dt),Wt=o(ft),Xt=m(ft),Gt=Wt*Tt,tr=-((1-Gt?s((1+Gt)/2)/(1-Gt):-.5)+Je/(1+Gt));return[tr*Wt*m(dt),tr*Xt]}return rt.invert=function(dt,ft){var Tt,Wt=z(dt*dt+ft*ft),Xt=-Fe/2,Gt=50;if(!Wt)return[0,0];do{var tr=Xt/2,lr=o(tr),hr=m(tr),vr=hr/lr,Pr=-s(u(lr));Xt-=Tt=(2/vr*Pr-Je*vr-Wt)/(-Pr/(hr*hr)+1-Je/(2*lr*lr))*(lr<0?.7:1)}while(u(Tt)>v&&--Gt>0);var Jr=m(Xt);return[l(dt*Jr,Wt*o(Xt)),S(ft*Jr/Wt)]},rt}function X(Fe,Ve){var Je=o(Ve),rt=function(dt){return dt?dt/Math.sin(dt):1}(P(Je*o(Fe/=2)));return[2*Je*m(Fe)*rt,m(Ve)*rt]}function Q(Fe){var Ve=m(Fe),Je=o(Fe),rt=Fe>=0?1:-1,dt=y(rt*Fe),ft=(1+Ve-Je)/2;function Tt(Wt,Xt){var Gt=o(Xt),tr=o(Wt/=2);return[(1+Gt)*m(Wt),(rt*Xt>-l(tr,dt)-.001?0:10*-rt)+ft+m(Xt)*Je-(1+Gt)*Ve*tr]}return Tt.invert=function(Wt,Xt){var Gt=0,tr=0,lr=50;do{var hr=o(Gt),vr=m(Gt),Pr=o(tr),Jr=m(tr),on=1+Pr,_n=on*vr-Wt,Mn=ft+Jr*Je-on*Ve*hr-Xt,Rn=on*hr/2,An=-vr*Jr,ha=Ve*on*vr/2,wa=Je*Pr+Ve*hr*Jr,Da=An*ha-wa*Rn,za=(Mn*An-_n*wa)/Da/2,Ra=(_n*ha-Mn*Rn)/Da;u(Ra)>2&&(Ra/=2),Gt-=za,tr-=Ra}while((u(za)>v||u(Ra)>v)&&--lr>0);return rt*tr>-l(o(Gt),dt)-.001?[2*Gt,tr]:null},Tt}function Z(Fe,Ve){var Je=y(Ve/2),rt=z(1-Je*Je),dt=1+rt*o(Fe/=2),ft=m(Fe)*rt/dt,Tt=Je/dt,Wt=ft*ft,Xt=Tt*Tt;return[4/3*ft*(3+Wt-3*Xt),4/3*Tt*(3+3*Wt-Xt)]}X.invert=function(Fe,Ve){if(!(Fe*Fe+4*Ve*Ve>T*T+v)){var Je=Fe,rt=Ve,dt=25;do{var ft,Tt=m(Je),Wt=m(Je/2),Xt=o(Je/2),Gt=m(rt),tr=o(rt),lr=m(2*rt),hr=Gt*Gt,vr=tr*tr,Pr=Wt*Wt,Jr=1-vr*Xt*Xt,on=Jr?P(tr*Xt)*z(ft=1/Jr):ft=0,_n=2*on*tr*Wt-Fe,Mn=on*Gt-Ve,Rn=ft*(vr*Pr+on*tr*Xt*hr),An=ft*(.5*Tt*lr-2*on*Gt*Wt),ha=.25*ft*(lr*Wt-on*Gt*vr*Tt),wa=ft*(hr*Xt+on*Pr*tr),Da=An*ha-wa*Rn;if(!Da)break;var za=(Mn*An-_n*wa)/Da,Ra=(_n*ha-Mn*Rn)/Da;Je-=za,rt-=Ra}while((u(za)>v||u(Ra)>v)&&--dt>0);return[Je,rt]}},Z.invert=function(Fe,Ve){if(Ve*=3/8,!(Fe*=3/8)&&u(Ve)>1)return null;var Je=1+Fe*Fe+Ve*Ve,rt=z((Je-z(Je*Je-4*Ve*Ve))/2),dt=S(rt)/3,ft=rt?function(Gt){return s(Gt+z(Gt*Gt-1))}(u(Ve/rt))/3:function(Gt){return s(Gt+z(Gt*Gt+1))}(u(Fe))/3,Tt=o(dt),Wt=q(ft),Xt=Wt*Wt-Tt*Tt;return[2*g(Fe)*l(F(ft)*Tt,.25-Xt),2*g(Ve)*l(Wt*m(dt),.25+Xt)]};var Y=z(8),N=s(1+A);function J(Fe,Ve){var Je=u(Ve);return Je<k?[Fe,s(y(k+Ve/2))]:[Fe*o(Je)*(2*A-1/m(Je)),g(Ve)*(2*A*(Je-k)-s(y(Je/2)))]}function D(Fe){var Ve=2*T/Fe;function Je(rt,dt){var ft=h.geoAzimuthalEquidistantRaw(rt,dt);if(u(rt)>_){var Tt=l(ft[1],ft[0]),Wt=z(ft[0]*ft[0]+ft[1]*ft[1]),Xt=Ve*d((Tt-_)/Ve)+_,Gt=l(m(Tt-=Xt),2-o(Tt));Tt=Xt+S(T/Wt*m(Gt))-Gt,ft[0]=Wt*o(Tt),ft[1]=Wt*m(Tt)}return ft}return Je.invert=function(rt,dt){var ft=z(rt*rt+dt*dt);if(ft>_){var Tt=l(dt,rt),Wt=Ve*d((Tt-_)/Ve)+_,Xt=Tt>Wt?-1:1,Gt=ft*o(Wt-Tt),tr=1/y(Xt*P((Gt-T)/z(T*(T-2*Gt)+ft*ft)));Tt=Wt+2*e((tr+Xt*z(tr*tr-3))/3),rt=ft*o(Tt),dt=ft*m(Tt)}return h.geoAzimuthalEquidistantRaw.invert(rt,dt)},Je}function U(Fe,Ve){if(arguments.length<2&&(Ve=Fe),Ve===1)return h.geoAzimuthalEqualAreaRaw;if(Ve===1/0)return G;function Je(rt,dt){var ft=h.geoAzimuthalEqualAreaRaw(rt/Ve,dt);return ft[0]*=Fe,ft}return Je.invert=function(rt,dt){var ft=h.geoAzimuthalEqualAreaRaw.invert(rt/Fe,dt);return ft[0]*=Ve,ft},Je}function G(Fe,Ve){return[Fe*o(Ve)/o(Ve/=2),2*m(Ve)]}function $(Fe,Ve,Je){var rt,dt,ft,Tt=100;Je=Je===void 0?0:+Je,Ve=+Ve;do(dt=Fe(Je))===(ft=Fe(Je+v))&&(ft=dt+v),Je-=rt=-1*v*(dt-Ve)/(dt-ft);while(Tt-- >0&&u(rt)>v);return Tt<0?NaN:Je}function K(Fe,Ve,Je){return Ve===void 0&&(Ve=40),Je===void 0&&(Je=1e-12),function(rt,dt,ft,Tt){var Wt,Xt,Gt;ft=ft===void 0?0:+ft,Tt=Tt===void 0?0:+Tt;for(var tr=0;tr<Ve;tr++){var lr=Fe(ft,Tt),hr=lr[0]-rt,vr=lr[1]-dt;if(u(hr)<Je&&u(vr)<Je)break;var Pr=hr*hr+vr*vr;if(Pr>Wt)ft-=Xt/=2,Tt-=Gt/=2;else{Wt=Pr;var Jr=(ft>0?-1:1)*Je,on=(Tt>0?-1:1)*Je,_n=Fe(ft+Jr,Tt),Mn=Fe(ft,Tt+on),Rn=(_n[0]-lr[0])/Jr,An=(_n[1]-lr[1])/Jr,ha=(Mn[0]-lr[0])/on,wa=(Mn[1]-lr[1])/on,Da=wa*Rn-An*ha,za=(u(Da)<.5?.5:1)/Da;if(ft+=Xt=(vr*ha-hr*wa)*za,Tt+=Gt=(hr*An-vr*Rn)*za,u(Xt)<Je&&u(Gt)<Je)break}}return[ft,Tt]}}function re(){var Fe=U(1.68,2);function Ve(Je,rt){if(Je+rt<-1.4){var dt=(Je-rt+1.6)*(Je+rt+1.4)/8;Je+=dt,rt-=.8*dt*m(rt+T/2)}var ft=Fe(Je,rt),Tt=(1-o(Je*rt))/12;return ft[1]<0&&(ft[0]*=1+Tt),ft[1]>0&&(ft[1]*=1+Tt/1.5*ft[0]*ft[0]),ft}return Ve.invert=K(Ve),Ve}function ne(Fe,Ve){var Je,rt=Fe*m(Ve),dt=30;do Ve-=Je=(Ve+m(Ve)-rt)/(1+o(Ve));while(u(Je)>v&&--dt>0);return Ve/2}function ae(Fe,Ve,Je){function rt(dt,ft){return[Fe*dt*o(ft=ne(Je,ft)),Ve*m(ft)]}return rt.invert=function(dt,ft){return ft=S(ft/Ve),[dt/(Fe*o(ft)),S((2*ft+m(2*ft))/Je)]},rt}J.invert=function(Fe,Ve){if((rt=u(Ve))<N)return[Fe,2*e(a(Ve))-_];var Je,rt,dt=k,ft=25;do{var Tt=o(dt/2),Wt=y(dt/2);dt-=Je=(Y*(dt-k)-s(Wt)-rt)/(Y-Tt*Tt/(2*Wt))}while(u(Je)>1e-12&&--ft>0);return[Fe/(o(dt)*(Y-1/m(dt))),g(Ve)*dt]},G.invert=function(Fe,Ve){var Je=2*S(Ve/2);return[Fe*o(Je/2)/o(Je),Je]};var ie=ae(A/_,A,T),he=2.00276,se=1.11072;function de(Fe,Ve){var Je=ne(T,Ve);return[he*Fe/(1/o(Ve)+se/o(Je)),(Ve+A*m(Je))/he]}function ce(Fe){var Ve=0,Je=h.geoProjectionMutator(Fe),rt=Je(Ve);return rt.parallel=function(dt){return arguments.length?Je(Ve=dt*C):Ve*w},rt}function ve(Fe,Ve){return[Fe*o(Ve),Ve]}function Ee(Fe){if(!Fe)return ve;var Ve=1/y(Fe);function Je(rt,dt){var ft=Ve+Fe-dt,Tt=ft&&rt*o(dt)/ft;return[ft*m(Tt),Ve-ft*o(Tt)]}return Je.invert=function(rt,dt){var ft=z(rt*rt+(dt=Ve-dt)*dt),Tt=Ve+Fe-ft;return[ft/o(Tt)*l(rt,dt),Tt]},Je}function Le(Fe){function Ve(Je,rt){var dt=_-rt,ft=dt&&Je*Fe*m(dt)/dt;return[dt*m(ft)/Fe,_-dt*o(ft)]}return Ve.invert=function(Je,rt){var dt=Je*Fe,ft=_-rt,Tt=z(dt*dt+ft*ft),Wt=l(dt,ft);return[(Tt?Tt/m(Tt):1)*Wt/Fe,_-Tt]},Ve}de.invert=function(Fe,Ve){var Je,rt,dt=he*Ve,ft=Ve<0?-k:k,Tt=25;do rt=dt-A*m(ft),ft-=Je=(m(2*ft)+2*ft-T*m(rt))/(2*o(2*ft)+2+T*o(rt)*A*o(ft));while(u(Je)>v&&--Tt>0);return rt=dt-A*m(ft),[Fe*(1/o(rt)+se/o(ft))/he,rt]},ve.invert=function(Fe,Ve){return[Fe/o(Ve),Ve]};var Te=ae(1,4/T,T);function xe(Fe,Ve,Je,rt,dt,ft){var Tt,Wt=o(ft);if(u(Fe)>1||u(ft)>1)Tt=P(Je*dt+Ve*rt*Wt);else{var Xt=m(Fe/2),Gt=m(ft/2);Tt=2*S(z(Xt*Xt+Ve*rt*Gt*Gt))}return u(Tt)>v?[Tt,l(rt*m(ft),Ve*dt-Je*rt*Wt)]:[0,0]}function fe(Fe,Ve,Je){return P((Fe*Fe+Ve*Ve-Je*Je)/(2*Fe*Ve))}function ge(Fe){return Fe-2*T*n((Fe+T)/(2*T))}function ke(Fe,Ve,Je){for(var rt,dt=[[Fe[0],Fe[1],m(Fe[1]),o(Fe[1])],[Ve[0],Ve[1],m(Ve[1]),o(Ve[1])],[Je[0],Je[1],m(Je[1]),o(Je[1])]],ft=dt[2],Tt=0;Tt<3;++Tt,ft=rt)rt=dt[Tt],ft.v=xe(rt[1]-ft[1],ft[3],ft[2],rt[3],rt[2],rt[0]-ft[0]),ft.point=[0,0];var Wt=fe(dt[0].v[0],dt[2].v[0],dt[1].v[0]),Xt=fe(dt[0].v[0],dt[1].v[0],dt[2].v[0]),Gt=T-Wt;dt[2].point[1]=0,dt[0].point[0]=-(dt[1].point[0]=dt[0].v[0]/2);var tr=[dt[2].point[0]=dt[0].point[0]+dt[2].v[0]*o(Wt),2*(dt[0].point[1]=dt[1].point[1]=dt[2].v[0]*m(Wt))];return function(lr,hr){var vr,Pr=m(hr),Jr=o(hr),on=new Array(3);for(vr=0;vr<3;++vr){var _n=dt[vr];if(on[vr]=xe(hr-_n[1],_n[3],_n[2],Jr,Pr,lr-_n[0]),!on[vr][0])return _n.point;on[vr][1]=ge(on[vr][1]-_n.v[1])}var Mn=tr.slice();for(vr=0;vr<3;++vr){var Rn=vr==2?0:vr+1,An=fe(dt[vr].v[0],on[vr][0],on[Rn][0]);on[vr][1]<0&&(An=-An),vr?vr==1?(An=Xt-An,Mn[0]-=on[vr][0]*o(An),Mn[1]-=on[vr][0]*m(An)):(An=Gt-An,Mn[0]+=on[vr][0]*o(An),Mn[1]+=on[vr][0]*m(An)):(Mn[0]+=on[vr][0]*o(An),Mn[1]-=on[vr][0]*m(An))}return Mn[0]/=3,Mn[1]/=3,Mn}}function Me(Fe){return Fe[0]*=C,Fe[1]*=C,Fe}function Se(Fe,Ve,Je){var rt=h.geoCentroid({type:"MultiPoint",coordinates:[Fe,Ve,Je]}),dt=[-rt[0],-rt[1]],ft=h.geoRotation(dt),Tt=ke(Me(ft(Fe)),Me(ft(Ve)),Me(ft(Je)));Tt.invert=K(Tt);var Wt=h.geoProjection(Tt).rotate(dt),Xt=Wt.center;return delete Wt.rotate,Wt.center=function(Gt){return arguments.length?Xt(ft(Gt)):ft.invert(Xt())},Wt.clipAngle(90)}function De(Fe,Ve){var Je=z(1-m(Ve));return[2/b*Fe*Je,b*(1-Je)]}function Be(Fe){var Ve=y(Fe);function Je(rt,dt){return[rt,(rt?rt/m(rt):1)*(m(dt)*o(rt)-Ve*o(dt))]}return Je.invert=Ve?function(rt,dt){rt&&(dt*=m(rt)/rt);var ft=o(rt);return[rt,2*l(z(ft*ft+Ve*Ve-dt*dt)-ft,Ve-dt)]}:function(rt,dt){return[rt,S(rt?dt*y(rt)/rt:dt)]},Je}De.invert=function(Fe,Ve){var Je=(Je=Ve/b-1)*Je;return[Je>0?Fe*z(T/Je)/2:0,S(1-Je)]};var We=z(3);function Qe(Fe,Ve){return[We*Fe*(2*o(2*Ve/3)-1)/b,We*b*m(Ve/3)]}function Oe(Fe){var Ve=o(Fe);function Je(rt,dt){return[rt*Ve,m(dt)/Ve]}return Je.invert=function(rt,dt){return[rt/Ve,S(dt*Ve)]},Je}function Ue(Fe){var Ve=o(Fe);function Je(rt,dt){return[rt*Ve,(1+Ve)*y(dt/2)]}return Je.invert=function(rt,dt){return[rt/Ve,2*e(dt/(1+Ve))]},Je}function Xe(Fe,Ve){var Je=z(8/(3*T));return[Je*Fe*(1-u(Ve)/T),Je*Ve]}function Ye(Fe,Ve){var Je=z(4-3*m(u(Ve)));return[2/z(6*T)*Fe*Je,g(Ve)*z(2*T/3)*(2-Je)]}function $e(Fe,Ve){var Je=z(T*(4+T));return[2/Je*Fe*(1+z(1-4*Ve*Ve/(T*T))),4/Je*Ve]}function it(Fe,Ve){var Je=(2+_)*m(Ve);Ve/=2;for(var rt=0,dt=1/0;rt<10&&u(dt)>v;rt++){var ft=o(Ve);Ve-=dt=(Ve+m(Ve)*(ft+2)-Je)/(2*ft*(1+ft))}return[2/z(T*(4+T))*Fe*(1+o(Ve)),2*z(T/(4+T))*m(Ve)]}function ot(Fe,Ve){return[Fe*(1+o(Ve))/z(2+T),2*Ve/z(2+T)]}function Et(Fe,Ve){for(var Je=(1+_)*m(Ve),rt=0,dt=1/0;rt<10&&u(dt)>v;rt++)Ve-=dt=(Ve+m(Ve)-Je)/(1+o(Ve));return Je=z(2+T),[Fe*(1+o(Ve))/Je,2*Ve/Je]}Qe.invert=function(Fe,Ve){var Je=3*S(Ve/(We*b));return[b*Fe/(We*(2*o(2*Je/3)-1)),Je]},Xe.invert=function(Fe,Ve){var Je=z(8/(3*T)),rt=Ve/Je;return[Fe/(Je*(1-u(rt)/T)),rt]},Ye.invert=function(Fe,Ve){var Je=2-u(Ve)/z(2*T/3);return[Fe*z(6*T)/(2*Je),g(Ve)*S((4-Je*Je)/3)]},$e.invert=function(Fe,Ve){var Je=z(T*(4+T))/2;return[Fe*Je/(1+z(1-Ve*Ve*(4+T)/(4*T))),Ve*Je/2]},it.invert=function(Fe,Ve){var Je=Ve*z((4+T)/T)/2,rt=S(Je),dt=o(rt);return[Fe/(2/z(T*(4+T))*(1+dt)),S((rt+Je*(dt+2))/(2+_))]},ot.invert=function(Fe,Ve){var Je=z(2+T),rt=Ve*Je/2;return[Je*Fe/(1+o(rt)),rt]},Et.invert=function(Fe,Ve){var Je=1+_,rt=z(Je/2);return[2*Fe*rt/(1+o(Ve*=rt)),S((Ve+m(Ve))/Je)]};var mt=3+2*A;function tt(Fe,Ve){var Je=m(Fe/=2),rt=o(Fe),dt=z(o(Ve)),ft=o(Ve/=2),Tt=m(Ve)/(ft+A*rt*dt),Wt=z(2/(1+Tt*Tt)),Xt=z((A*ft+(rt+Je)*dt)/(A*ft+(rt-Je)*dt));return[mt*(Wt*(Xt-1/Xt)-2*s(Xt)),mt*(Wt*Tt*(Xt+1/Xt)-2*e(Tt))]}tt.invert=function(Fe,Ve){if(!(Je=Z.invert(Fe/1.2,1.065*Ve)))return null;var Je,rt=Je[0],dt=Je[1],ft=20;Fe/=mt,Ve/=mt;do{var Tt=rt/2,Wt=dt/2,Xt=m(Tt),Gt=o(Tt),tr=m(Wt),lr=o(Wt),hr=o(dt),vr=z(hr),Pr=tr/(lr+A*Gt*vr),Jr=Pr*Pr,on=z(2/(1+Jr)),_n=(A*lr+(Gt+Xt)*vr)/(A*lr+(Gt-Xt)*vr),Mn=z(_n),Rn=Mn-1/Mn,An=Mn+1/Mn,ha=on*Rn-2*s(Mn)-Fe,wa=on*Pr*An-2*e(Pr)-Ve,Da=tr&&E*vr*Xt*Jr/tr,za=(A*Gt*lr+vr)/(2*(lr+A*Gt*vr)*(lr+A*Gt*vr)*vr),Ra=-.5*Pr*on*on*on,xi=Ra*Da,gi=Ra*za,ni=(ni=2*lr+A*vr*(Gt-Xt))*ni*Mn,ai=(A*Gt*lr*vr+hr)/ni,mi=-A*Xt*tr/(vr*ni),Ri=Rn*xi-2*ai/Mn+on*(ai+ai/_n),Zi=Rn*gi-2*mi/Mn+on*(mi+mi/_n),Ji=Pr*An*xi-2*Da/(1+Jr)+on*An*Da+on*Pr*(ai-ai/_n),Ki=Pr*An*gi-2*za/(1+Jr)+on*An*za+on*Pr*(mi-mi/_n),Qi=Zi*Ji-Ki*Ri;if(!Qi)break;var Ca=(wa*Zi-ha*Ki)/Qi,ut=(ha*Ji-wa*Ri)/Qi;rt-=Ca,dt=r(-_,c(_,dt-ut))}while((u(Ca)>v||u(ut)>v)&&--ft>0);return u(u(dt)-_)<v?[0,dt]:ft&&[rt,dt]};var Ke=o(35*C);function Mt(Fe,Ve){var Je=y(Ve/2);return[Fe*Ke*z(1-Je*Je),(1+Ke)*Je]}function Jt(Fe,Ve){var Je=Ve/2,rt=o(Je);return[2*Fe/b*o(Ve)*rt*rt,b*y(Je)]}function $t(Fe){var Ve=1-Fe,Je=dt(T,0)[0]-dt(-T,0)[0],rt=z(2*(dt(0,_)[1]-dt(0,-_)[1])/Je);function dt(Wt,Xt){var Gt=o(Xt),tr=m(Xt);return[Gt/(Ve+Fe*Gt)*Wt,Ve*Xt+Fe*tr]}function ft(Wt,Xt){var Gt=dt(Wt,Xt);return[Gt[0]*rt,Gt[1]/rt]}function Tt(Wt){return ft(0,Wt)[1]}return ft.invert=function(Wt,Xt){var Gt=$(Tt,Xt);return[Wt/rt*(Fe+Ve/o(Gt)),Gt]},ft}function je(Fe){return[Fe[0]/2,S(y(Fe[1]/2*C))*w]}function Ge(Fe){return[2*Fe[0],2*e(m(Fe[1]*C))*w]}function Ct(Fe,Ve){var Je=2*T/Ve,rt=Fe*Fe;function dt(ft,Tt){var Wt=h.geoAzimuthalEquidistantRaw(ft,Tt),Xt=Wt[0],Gt=Wt[1],tr=Xt*Xt+Gt*Gt;if(tr>rt){var lr=z(tr),hr=l(Gt,Xt),vr=Je*d(hr/Je),Pr=hr-vr,Jr=Fe*o(Pr),on=(Fe*m(Pr)-Pr*m(Jr))/(_-Jr),_n=Ie(Pr,on),Mn=(T-Fe)/be(_n,Jr,T);Xt=lr;var Rn,An=50;do Xt-=Rn=(Fe+be(_n,Jr,Xt)*Mn-lr)/(_n(Xt)*Mn);while(u(Rn)>v&&--An>0);Gt=Pr*m(Xt),Xt<_&&(Gt-=on*(Xt-_));var ha=m(vr),wa=o(vr);Wt[0]=Xt*wa-Gt*ha,Wt[1]=Xt*ha+Gt*wa}return Wt}return dt.invert=function(ft,Tt){var Wt=ft*ft+Tt*Tt;if(Wt>rt){var Xt=z(Wt),Gt=l(Tt,ft),tr=Je*d(Gt/Je),lr=Gt-tr;ft=Xt*o(lr),Tt=Xt*m(lr);for(var hr=ft-_,vr=m(ft),Pr=Tt/vr,Jr=ft<_?1/0:0,on=10;;){var _n=Fe*m(Pr),Mn=Fe*o(Pr),Rn=m(Mn),An=_-Mn,ha=(_n-Pr*Rn)/An,wa=Ie(Pr,ha);if(u(Jr)<1e-12||!--on)break;Pr-=Jr=(Pr*vr-ha*hr-Tt)/(vr-2*hr*(An*(Mn+Pr*_n*o(Mn)-Rn)-_n*(_n-Pr*Rn))/(An*An))}ft=(Xt=Fe+be(wa,Mn,ft)*(T-Fe)/be(wa,Mn,T))*o(Gt=tr+Pr),Tt=Xt*m(Gt)}return h.geoAzimuthalEquidistantRaw.invert(ft,Tt)},dt}function Ie(Fe,Ve){return function(Je){var rt=Fe*o(Je);return Je<_&&(rt-=Ve),z(1+rt*rt)}}function be(Fe,Ve,Je){for(var rt=(Je-Ve)/50,dt=Fe(Ve)+Fe(Je),ft=1,Tt=Ve;ft<50;++ft)dt+=2*Fe(Tt+=rt);return .5*dt*rt}function Ae(Fe,Ve,Je,rt,dt,ft,Tt,Wt){function Xt(Gt,tr){if(!tr)return[Fe*Gt/T,0];var lr=tr*tr,hr=Fe+lr*(Ve+lr*(Je+lr*rt)),vr=tr*(dt-1+lr*(ft-Wt+lr*Tt)),Pr=(hr*hr+vr*vr)/(2*vr),Jr=Gt*S(hr/Pr)/T;return[Pr*m(Jr),tr*(1+lr*Wt)+Pr*(1-o(Jr))]}return arguments.length<8&&(Wt=0),Xt.invert=function(Gt,tr){var lr,hr,vr=T*Gt/Fe,Pr=tr,Jr=50;do{var on=Pr*Pr,_n=Fe+on*(Ve+on*(Je+on*rt)),Mn=Pr*(dt-1+on*(ft-Wt+on*Tt)),Rn=_n*_n+Mn*Mn,An=2*Mn,ha=Rn/An,wa=ha*ha,Da=S(_n/ha)/T,za=vr*Da,Ra=_n*_n,xi=(2*Ve+on*(4*Je+6*on*rt))*Pr,gi=dt+on*(3*ft+5*on*Tt),ni=(2*(_n*xi+Mn*(gi-1))*An-Rn*(2*(gi-1)))/(An*An),ai=o(za),mi=m(za),Ri=ha*ai,Zi=ha*mi,Ji=vr/T*(1/z(1-Ra/wa))*(xi*ha-_n*ni)/wa,Ki=Zi-Gt,Qi=Pr*(1+on*Wt)+ha-Ri-tr,Ca=ni*mi+Ri*Ji,ut=Ri*Da,Ot=1+ni-(ni*ai-Zi*Ji),ir=Zi*Da,Vt=Ca*ir-Ot*ut;if(!Vt)break;vr-=lr=(Qi*Ca-Ki*Ot)/Vt,Pr-=hr=(Ki*ir-Qi*ut)/Vt}while((u(lr)>v||u(hr)>v)&&--Jr>0);return[vr,Pr]},Xt}Mt.invert=function(Fe,Ve){var Je=Ve/(1+Ke);return[Fe&&Fe/(Ke*z(1-Je*Je)),2*e(Je)]},Jt.invert=function(Fe,Ve){var Je=e(Ve/b),rt=o(Je),dt=2*Je;return[Fe*b/2/(o(dt)*rt*rt),dt]};var Pe=Ae(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),ze=Ae(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),qe=Ae(5/6*T,-.62636,-.0344,0,1.3493,-.05524,0,.045);function ht(Fe,Ve){var Je=Fe*Fe,rt=Ve*Ve;return[Fe*(1-.162388*rt)*(.87-952426e-9*Je*Je),Ve*(1+rt/12)]}ht.invert=function(Fe,Ve){var Je,rt=Fe,dt=Ve,ft=50;do{var Tt=dt*dt;dt-=Je=(dt*(1+Tt/12)-Ve)/(1+Tt/4)}while(u(Je)>v&&--ft>0);ft=50,Fe/=1-.162388*Tt;do{var Wt=(Wt=rt*rt)*Wt;rt-=Je=(rt*(.87-952426e-9*Wt)-Fe)/(.87-.00476213*Wt)}while(u(Je)>v&&--ft>0);return[rt,dt]};var at=Ae(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function nt(Fe){var Ve=Fe(_,0)[0]-Fe(-_,0)[0];function Je(rt,dt){var ft=rt>0?-.5:.5,Tt=Fe(rt+ft*T,dt);return Tt[0]-=ft*Ve,Tt}return Fe.invert&&(Je.invert=function(rt,dt){var ft=rt>0?-.5:.5,Tt=Fe.invert(rt+ft*Ve,dt),Wt=Tt[0]-ft*T;return Wt<-T?Wt+=2*T:Wt>T&&(Wt-=2*T),Tt[0]=Wt,Tt}),Je}function xt(Fe,Ve){var Je=g(Fe),rt=g(Ve),dt=o(Ve),ft=o(Fe)*dt,Tt=m(Fe)*dt,Wt=m(rt*Ve);Fe=u(l(Tt,Wt)),Ve=S(ft),u(Fe-_)>v&&(Fe%=_);var Xt=function(Gt,tr){if(tr===_)return[0,0];var lr,hr,vr=m(tr),Pr=vr*vr,Jr=Pr*Pr,on=1+Jr,_n=1+3*Jr,Mn=1-Jr,Rn=S(1/z(on)),An=Mn+Pr*on*Rn,ha=(1-vr)/An,wa=z(ha),Da=ha*on,za=z(Da),Ra=wa*Mn;if(Gt===0)return[0,-(Ra+Pr*za)];var xi,gi=o(tr),ni=1/gi,ai=2*vr*gi,mi=(-An*gi-(-3*Pr+Rn*_n)*ai*(1-vr))/(An*An),Ri=-ni*ai,Zi=-ni*(Pr*on*mi+ha*_n*ai),Ji=-2*ni*(Mn*(.5*mi/wa)-2*Pr*wa*ai),Ki=4*Gt/T;if(Gt>.222*T||tr<T/4&&Gt>.175*T){if(lr=(Ra+Pr*z(Da*(1+Jr)-Ra*Ra))/(1+Jr),Gt>T/4)return[lr,lr];var Qi=lr,Ca=.5*lr;lr=.5*(Ca+Qi),hr=50;do{var ut=z(Da-lr*lr),Ot=lr*(Ji+Ri*ut)+Zi*S(lr/za)-Ki;if(!Ot)break;Ot<0?Ca=lr:Qi=lr,lr=.5*(Ca+Qi)}while(u(Qi-Ca)>v&&--hr>0)}else{lr=v,hr=25;do{var ir=lr*lr,Vt=z(Da-ir),sr=Ji+Ri*Vt,Cr=lr*sr+Zi*S(lr/za)-Ki,Or=sr+(Zi-Ri*ir)/Vt;lr-=xi=Vt?Cr/Or:0}while(u(xi)>v&&--hr>0)}return[lr,-Ra-Pr*z(Da-lr*lr)]}(Fe>T/4?_-Fe:Fe,Ve);return Fe>T/4&&(Wt=Xt[0],Xt[0]=-Xt[1],Xt[1]=-Wt),Xt[0]*=Je,Xt[1]*=-rt,Xt}function Lt(Fe,Ve){var Je,rt,dt,ft,Tt,Wt;if(Ve<v)return[(ft=m(Fe))-(Je=Ve*(Fe-ft*(rt=o(Fe)))/4)*rt,rt+Je*ft,1-Ve*ft*ft/2,Fe-Je];if(Ve>=1-v)return Je=(1-Ve)/4,dt=1/(rt=q(Fe)),[(ft=((Wt=a(2*(Wt=Fe)))-1)/(Wt+1))+Je*((Tt=rt*F(Fe))-Fe)/(rt*rt),dt-Je*ft*dt*(Tt-Fe),dt+Je*ft*dt*(Tt+Fe),2*e(a(Fe))-_+Je*(Tt-Fe)/rt];var Xt=[1,0,0,0,0,0,0,0,0],Gt=[z(Ve),0,0,0,0,0,0,0,0],tr=0;for(rt=z(1-Ve),Tt=1;u(Gt[tr]/Xt[tr])>v&&tr<8;)Je=Xt[tr++],Gt[tr]=(Je-rt)/2,Xt[tr]=(Je+rt)/2,rt=z(Je*rt),Tt*=2;dt=Tt*Xt[tr]*Fe;do dt=(S(ft=Gt[tr]*m(rt=dt)/Xt[tr])+dt)/2;while(--tr);return[m(dt),ft=o(dt),ft/o(dt-rt),dt]}function bt(Fe,Ve){if(!Ve)return Fe;if(Ve===1)return s(y(Fe/2+k));for(var Je=1,rt=z(1-Ve),dt=z(Ve),ft=0;u(dt)>v;ft++){if(Fe%T){var Tt=e(rt*y(Fe)/Je);Tt<0&&(Tt+=T),Fe+=Tt+~~(Fe/T)*T}else Fe+=Fe;dt=(Je+rt)/2,rt=z(Je*rt),dt=((Je=dt)-rt)/2}return Fe/(f(2,ft)*Je)}function St(Fe,Ve){var Je=(A-1)/(A+1),rt=z(1-Je*Je),dt=bt(_,rt*rt),ft=s(y(T/4+u(Ve)/2)),Tt=a(-1*ft)/z(Je),Wt=function(Gt,tr){var lr=Gt*Gt,hr=tr+1,vr=1-lr-tr*tr;return[.5*((Gt>=0?_:-_)-l(vr,2*Gt)),-.25*s(vr*vr+4*lr)+.5*s(hr*hr+lr)]}(Tt*o(-1*Fe),Tt*m(-1*Fe)),Xt=function(Gt,tr,lr){var hr=u(Gt),vr=F(u(tr));if(hr){var Pr=1/m(hr),Jr=1/(y(hr)*y(hr)),on=-(Jr+lr*(vr*vr*Pr*Pr)-1+lr),_n=(-on+z(on*on-4*((lr-1)*Jr)))/2;return[bt(e(1/z(_n)),lr)*g(Gt),bt(e(z((_n/Jr-1)/lr)),1-lr)*g(tr)]}return[0,bt(e(vr),1-lr)*g(tr)]}(Wt[0],Wt[1],rt*rt);return[-Xt[1],(Ve>=0?1:-1)*(.5*dt-Xt[0])]}function st(Fe){var Ve=m(Fe),Je=o(Fe),rt=It(Fe);function dt(ft,Tt){var Wt=rt(ft,Tt);ft=Wt[0],Tt=Wt[1];var Xt=m(Tt),Gt=o(Tt),tr=o(ft),lr=P(Ve*Xt+Je*Gt*tr),hr=m(lr),vr=u(hr)>v?lr/hr:1;return[vr*Je*m(ft),(u(ft)>_?vr:-vr)*(Ve*Gt-Je*Xt*tr)]}return rt.invert=It(-Fe),dt.invert=function(ft,Tt){var Wt=z(ft*ft+Tt*Tt),Xt=-m(Wt),Gt=o(Wt),tr=Wt*Gt,lr=-Tt*Xt,hr=Wt*Ve,vr=z(tr*tr+lr*lr-hr*hr),Pr=l(tr*hr+lr*vr,lr*hr-tr*vr),Jr=(Wt>_?-1:1)*l(ft*Xt,Wt*o(Pr)*Gt+Tt*m(Pr)*Xt);return rt.invert(Jr,Pr)},dt}function It(Fe){var Ve=m(Fe),Je=o(Fe);return function(rt,dt){var ft=o(dt),Tt=o(rt)*ft,Wt=m(rt)*ft,Xt=m(dt);return[l(Wt,Tt*Je-Xt*Ve),S(Xt*Je+Tt*Ve)]}}xt.invert=function(Fe,Ve){u(Fe)>1&&(Fe=2*g(Fe)-Fe),u(Ve)>1&&(Ve=2*g(Ve)-Ve);var Je=g(Fe),rt=g(Ve),dt=-Je*Fe,ft=-rt*Ve,Tt=ft/dt<1,Wt=function(lr,hr){for(var vr=0,Pr=1,Jr=.5,on=50;;){var _n=Jr*Jr,Mn=z(Jr),Rn=S(1/z(1+_n)),An=1-_n+Jr*(1+_n)*Rn,ha=(1-Mn)/An,wa=z(ha),Da=ha*(1+_n),za=wa*(1-_n),Ra=z(Da-lr*lr),xi=hr+za+Jr*Ra;if(u(Pr-vr)<1e-12||--on==0||xi===0)break;xi>0?vr=Jr:Pr=Jr,Jr=.5*(vr+Pr)}if(!on)return null;var gi=S(Mn),ni=o(gi),ai=1/ni,mi=2*Mn*ni,Ri=(-An*ni-(-3*Jr+Rn*(1+3*_n))*mi*(1-Mn))/(An*An);return[T/4*(lr*(-2*ai*(.5*Ri/wa*(1-_n)-2*Jr*wa*mi)+-ai*mi*Ra)+-ai*(Jr*(1+_n)*Ri+ha*(1+3*_n)*mi)*S(lr/z(Da))),gi]}(Tt?ft:dt,Tt?dt:ft),Xt=Wt[0],Gt=Wt[1],tr=o(Gt);return Tt&&(Xt=-_-Xt),[Je*(l(m(Xt)*tr,-m(Gt))+T),rt*S(o(Xt)*tr)]},St.invert=function(Fe,Ve){var Je,rt,dt,ft,Tt,Wt,Xt=(A-1)/(A+1),Gt=z(1-Xt*Xt),tr=bt(_,Gt*Gt),lr=(rt=-Fe,dt=Gt*Gt,(Je=.5*tr-Ve)?(ft=Lt(Je,dt),rt?(Wt=(Tt=Lt(rt,1-dt))[1]*Tt[1]+dt*ft[0]*ft[0]*Tt[0]*Tt[0],[[ft[0]*Tt[2]/Wt,ft[1]*ft[2]*Tt[0]*Tt[1]/Wt],[ft[1]*Tt[1]/Wt,-ft[0]*ft[2]*Tt[0]*Tt[2]/Wt],[ft[2]*Tt[1]*Tt[2]/Wt,-dt*ft[0]*ft[1]*Tt[0]/Wt]]):[[ft[0],0],[ft[1],0],[ft[2],0]]):[[0,(Tt=Lt(rt,1-dt))[0]/Tt[1]],[1/Tt[1],0],[Tt[2]/Tt[1],0]]),hr=function(vr,Pr){var Jr=Pr[0]*Pr[0]+Pr[1]*Pr[1];return[(vr[0]*Pr[0]+vr[1]*Pr[1])/Jr,(vr[1]*Pr[0]-vr[0]*Pr[1])/Jr]}(lr[0],lr[1]);return[l(hr[1],hr[0])/-1,2*e(a(-.5*s(Xt*hr[0]*hr[0]+Xt*hr[1]*hr[1])))-_]};var jt=S(1-1/3)*w,Ut=Oe(0);function zt(Fe){var Ve=jt*C,Je=De(T,Ve)[0]-De(-T,Ve)[0],rt=Ut(0,Ve)[1],dt=De(0,Ve)[1],ft=b-dt,Tt=L/Fe,Wt=4/L,Xt=rt+ft*ft*4/L;function Gt(tr,lr){var hr,vr=u(lr);if(vr>Ve){var Pr=c(Fe-1,r(0,n((tr+T)/Tt)));(hr=De(tr+=T*(Fe-1)/Fe-Pr*Tt,vr))[0]=hr[0]*L/Je-L*(Fe-1)/(2*Fe)+Pr*L/Fe,hr[1]=rt+4*(hr[1]-dt)*ft/L,lr<0&&(hr[1]=-hr[1])}else hr=Ut(tr,lr);return hr[0]*=Wt,hr[1]/=Xt,hr}return Gt.invert=function(tr,lr){tr/=Wt;var hr=u(lr*=Xt);if(hr>rt){var vr=c(Fe-1,r(0,n((tr+T)/Tt)));tr=(tr+T*(Fe-1)/Fe-vr*Tt)*Je/L;var Pr=De.invert(tr,.25*(hr-rt)*L/ft+dt);return Pr[0]-=T*(Fe-1)/Fe-vr*Tt,lr<0&&(Pr[1]=-Pr[1]),Pr}return Ut.invert(tr,lr)},Gt}function Ce(Fe,Ve){return[Fe,1&Ve?90-v:jt]}function lt(Fe,Ve){return[Fe,1&Ve?-90+v:-jt]}function At(Fe){return[Fe[0]*(1-v),Fe[1]]}function Bt(Fe){var Ve,Je=1+Fe,rt=S(m(1/Je)),dt=2*z(T/(Ve=T+4*rt*Je)),ft=.5*dt*(Je+z(Fe*(2+Fe))),Tt=Fe*Fe,Wt=Je*Je;function Xt(Gt,tr){var lr,hr,vr=1-m(tr);if(vr&&vr<2){var Pr,Jr=_-tr,on=25;do{var _n=m(Jr),Mn=o(Jr),Rn=rt+l(_n,Je-Mn),An=1+Wt-2*Je*Mn;Jr-=Pr=(Jr-Tt*rt-Je*_n+An*Rn-.5*vr*Ve)/(2*Je*_n*Rn)}while(u(Pr)>1e-12&&--on>0);lr=dt*z(An),hr=Gt*Rn/T}else lr=dt*(Fe+vr),hr=Gt*rt/T;return[lr*m(hr),ft-lr*o(hr)]}return Xt.invert=function(Gt,tr){var lr=Gt*Gt+(tr-=ft)*tr,hr=(1+Wt-lr/(dt*dt))/(2*Je),vr=P(hr),Pr=m(vr),Jr=rt+l(Pr,Je-hr);return[S(Gt/z(lr))*T/Jr,S(1-2*(vr-Tt*rt-Je*Pr+(1+Wt-2*Je*hr)*Jr)/Ve)]},Xt}function Ht(Fe,Ve){return Ve>-.7109889596207567?((Fe=ie(Fe,Ve))[1]+=.0528035274542,Fe):ve(Fe,Ve)}function or(Fe,Ve){return u(Ve)>.7109889596207567?((Fe=ie(Fe,Ve))[1]-=Ve>0?.0528035274542:-.0528035274542,Fe):ve(Fe,Ve)}function ar(Fe,Ve,Je,rt){var dt=z(4*T/(2*Je+(1+Fe-Ve/2)*m(2*Je)+(Fe+Ve)/2*m(4*Je)+Ve/2*m(6*Je))),ft=z(rt*m(Je)*z((1+Fe*o(2*Je)+Ve*o(4*Je))/(1+Fe+Ve))),Tt=Je*Xt(1);function Wt(lr){return z(1+Fe*o(2*lr)+Ve*o(4*lr))}function Xt(lr){var hr=lr*Je;return(2*hr+(1+Fe-Ve/2)*m(2*hr)+(Fe+Ve)/2*m(4*hr)+Ve/2*m(6*hr))/Je}function Gt(lr){return Wt(lr)*m(lr)}var tr=function(lr,hr){var vr=Je*$(Xt,Tt*m(hr)/Je,hr/T);isNaN(vr)&&(vr=Je*g(hr));var Pr=dt*Wt(vr);return[Pr*ft*lr/T*o(vr),Pr/ft*m(vr)]};return tr.invert=function(lr,hr){var vr=$(Gt,hr*ft/dt);return[lr*T/(o(vr)*dt*ft*Wt(vr)),S(Je*Xt(vr/Je)/Tt)]},Je===0&&(dt=z(rt/T),(tr=function(lr,hr){return[lr*dt,m(hr)/dt]}).invert=function(lr,hr){return[lr/dt,S(hr*dt)]}),tr}function Nt(Fe,Ve,Je,rt,dt){rt===void 0&&(rt=1e-8),dt===void 0&&(dt=20);var ft=Fe(Ve),Tt=Fe(.5*(Ve+Je)),Wt=Fe(Je);return function Xt(Gt,tr,lr,hr,vr,Pr,Jr,on,_n,Mn,Rn){if(Rn.nanEncountered)return NaN;var An,ha,wa,Da,za,Ra,xi,gi,ni,ai;if(ha=Gt(tr+.25*(An=lr-tr)),wa=Gt(lr-.25*An),isNaN(ha))Rn.nanEncountered=!0;else{if(!isNaN(wa))return ai=((Ra=(Da=An*(hr+4*ha+vr)/12)+(za=An*(vr+4*wa+Pr)/12))-Jr)/15,Mn>_n?(Rn.maxDepthCount++,Ra+ai):Math.abs(ai)<on?Ra+ai:(gi=Xt(Gt,tr,xi=tr+.5*An,hr,ha,vr,Da,.5*on,_n,Mn+1,Rn),isNaN(gi)?(Rn.nanEncountered=!0,NaN):(ni=Xt(Gt,xi,lr,vr,wa,Pr,za,.5*on,_n,Mn+1,Rn),isNaN(ni)?(Rn.nanEncountered=!0,NaN):gi+ni));Rn.nanEncountered=!0}}(Fe,Ve,Je,ft,Tt,Wt,(ft+4*Tt+Wt)*(Je-Ve)/6,rt,dt,1,{maxDepthCount:0,nanEncountered:!1})}function nr(Fe,Ve,Je){function rt(vr){return Fe+(1-Fe)*f(1-f(vr,Ve),1/Ve)}function dt(vr){return Nt(rt,0,vr,1e-4)}for(var ft=1/dt(1),Tt=1e3,Wt=(1+1e-8)*ft,Xt=[],Gt=0;Gt<=Tt;Gt++)Xt.push(dt(Gt/Tt)*Wt);function tr(vr){var Pr=0,Jr=Tt,on=500;do Xt[on]>vr?Jr=on:Pr=on,on=Pr+Jr>>1;while(on>Pr);var _n=Xt[on+1]-Xt[on];return _n&&(_n=(vr-Xt[on+1])/_n),(on+1+_n)/Tt}var lr=2*tr(1)/T*ft/Je,hr=function(vr,Pr){var Jr=tr(u(m(Pr))),on=rt(Jr)*vr;return Jr/=lr,[on,Pr>=0?Jr:-Jr]};return hr.invert=function(vr,Pr){var Jr;return u(Pr*=lr)<1&&(Jr=g(Pr)*S(dt(u(Pr))*ft)),[vr/rt(u(Pr)),Jr]},hr}function Lr(Fe,Ve){return u(Fe[0]-Ve[0])<v&&u(Fe[1]-Ve[1])<v}function dr(Fe,Ve){for(var Je,rt,dt,ft=-1,Tt=Fe.length,Wt=Fe[0],Xt=[];++ft<Tt;){rt=((Je=Fe[ft])[0]-Wt[0])/Ve,dt=(Je[1]-Wt[1])/Ve;for(var Gt=0;Gt<Ve;++Gt)Xt.push([Wt[0]+Gt*rt,Wt[1]+Gt*dt]);Wt=Je}return Xt.push(Je),Xt}function Kt(Fe){var Ve,Je,rt,dt,ft,Tt,Wt,Xt=[],Gt=Fe[0].length;for(Wt=0;Wt<Gt;++Wt)Je=(Ve=Fe[0][Wt])[0][0],rt=Ve[0][1],dt=Ve[1][1],ft=Ve[2][0],Tt=Ve[2][1],Xt.push(dr([[Je+v,rt+v],[Je+v,dt-v],[ft-v,dt-v],[ft-v,Tt+v]],30));for(Wt=Fe[1].length-1;Wt>=0;--Wt)Je=(Ve=Fe[1][Wt])[0][0],rt=Ve[0][1],dt=Ve[1][1],ft=Ve[2][0],Tt=Ve[2][1],Xt.push(dr([[ft-v,Tt-v],[ft-v,dt+v],[Je+v,dt+v],[Je+v,rt-v]],30));return{type:"Polygon",coordinates:[p.merge(Xt)]}}function yr(Fe,Ve,Je){var rt,dt;function ft(Xt,Gt){for(var tr=Gt<0?-1:1,lr=Ve[+(Gt<0)],hr=0,vr=lr.length-1;hr<vr&&Xt>lr[hr][2][0];++hr);var Pr=Fe(Xt-lr[hr][1][0],Gt);return Pr[0]+=Fe(lr[hr][1][0],tr*Gt>tr*lr[hr][0][1]?lr[hr][0][1]:Gt)[0],Pr}Je?ft.invert=Je(ft):Fe.invert&&(ft.invert=function(Xt,Gt){for(var tr=dt[+(Gt<0)],lr=Ve[+(Gt<0)],hr=0,vr=tr.length;hr<vr;++hr){var Pr=tr[hr];if(Pr[0][0]<=Xt&&Xt<Pr[1][0]&&Pr[0][1]<=Gt&&Gt<Pr[1][1]){var Jr=Fe.invert(Xt-Fe(lr[hr][1][0],0)[0],Gt);return Jr[0]+=lr[hr][1][0],Lr(ft(Jr[0],Jr[1]),[Xt,Gt])?Jr:null}}});var Tt=h.geoProjection(ft),Wt=Tt.stream;return Tt.stream=function(Xt){var Gt=Tt.rotate(),tr=Wt(Xt),lr=(Tt.rotate([0,0]),Wt(Xt));return Tt.rotate(Gt),tr.sphere=function(){h.geoStream(rt,lr)},tr},Tt.lobes=function(Xt){return arguments.length?(rt=Kt(Xt),Ve=Xt.map(function(Gt){return Gt.map(function(tr){return[[tr[0][0]*C,tr[0][1]*C],[tr[1][0]*C,tr[1][1]*C],[tr[2][0]*C,tr[2][1]*C]]})}),dt=Ve.map(function(Gt){return Gt.map(function(tr){var lr,hr=Fe(tr[0][0],tr[0][1])[0],vr=Fe(tr[2][0],tr[2][1])[0],Pr=Fe(tr[1][0],tr[0][1])[1],Jr=Fe(tr[1][0],tr[1][1])[1];return Pr>Jr&&(lr=Pr,Pr=Jr,Jr=lr),[[hr,Pr],[vr,Jr]]})}),Tt):Ve.map(function(Gt){return Gt.map(function(tr){return[[tr[0][0]*w,tr[0][1]*w],[tr[1][0]*w,tr[1][1]*w],[tr[2][0]*w,tr[2][1]*w]]})})},Ve!=null&&Tt.lobes(Ve),Tt}Ht.invert=function(Fe,Ve){return Ve>-.7109889596207567?ie.invert(Fe,Ve-.0528035274542):ve.invert(Fe,Ve)},or.invert=function(Fe,Ve){return u(Ve)>.7109889596207567?ie.invert(Fe,Ve+(Ve>0?.0528035274542:-.0528035274542)):ve.invert(Fe,Ve)};var xr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],gr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],wr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],zr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],Rr=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],Wr=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function gn(Fe,Ve){return[3/L*Fe*z(T*T/3-Ve*Ve),Ve]}function rn(Fe){function Ve(Je,rt){if(u(u(rt)-_)<v)return[0,rt<0?-2:2];var dt=m(rt),ft=f((1+dt)/(1-dt),Fe/2),Tt=.5*(ft+1/ft)+o(Je*=Fe);return[2*m(Je)/Tt,(ft-1/ft)/Tt]}return Ve.invert=function(Je,rt){var dt=u(rt);if(u(dt-2)<v)return Je?null:[0,g(rt)*_];if(dt>2)return null;var ft=(Je/=2)*Je,Tt=(rt/=2)*rt,Wt=2*rt/(1+ft+Tt);return Wt=f((1+Wt)/(1-Wt),1/Fe),[l(2*Je,1-ft-Tt)/Fe,S((Wt-1)/(Wt+1))]},Ve}gn.invert=function(Fe,Ve){return[L/3*Fe/z(T*T/3-Ve*Ve),Ve]};var Zr=T/A;function bn(Fe,Ve){return[Fe*(1+z(o(Ve)))/2,Ve/(o(Ve/2)*o(Fe/6))]}function Dr(Fe,Ve){var Je=Fe*Fe,rt=Ve*Ve;return[Fe*(.975534+rt*(-.0143059*Je-.119161+-.0547009*rt)),Ve*(1.00384+Je*(.0802894+-.02855*rt+199025e-9*Je)+rt*(.0998909+-.0491032*rt))]}function br(Fe,Ve){return[m(Fe)/o(Ve),y(Ve)*o(Fe)]}function Xr(Fe){var Ve=o(Fe),Je=y(k+Fe/2);function rt(dt,ft){var Tt=ft-Fe,Wt=u(Tt)<v?dt*Ve:u(Wt=k+ft/2)<v||u(u(Wt)-_)<v?0:dt*Tt/s(y(Wt)/Je);return[Wt,Tt]}return rt.invert=function(dt,ft){var Tt,Wt=ft+Fe;return[u(ft)<v?dt/Ve:u(Tt=k+Wt/2)<v||u(u(Tt)-_)<v?0:dt*s(y(Tt)/Je)/ft,Wt]},rt}function fn(Fe,Ve){return[Fe,1.25*s(y(k+.4*Ve))]}function Qr(Fe){var Ve=Fe.length-1;function Je(rt,dt){for(var ft,Tt=o(dt),Wt=2/(1+Tt*o(rt)),Xt=Wt*Tt*m(rt),Gt=Wt*m(dt),tr=Ve,lr=Fe[tr],hr=lr[0],vr=lr[1];--tr>=0;)hr=(lr=Fe[tr])[0]+Xt*(ft=hr)-Gt*vr,vr=lr[1]+Xt*vr+Gt*ft;return[hr=Xt*(ft=hr)-Gt*vr,vr=Xt*vr+Gt*ft]}return Je.invert=function(rt,dt){var ft=20,Tt=rt,Wt=dt;do{for(var Xt,Gt=Ve,tr=Fe[Gt],lr=tr[0],hr=tr[1],vr=0,Pr=0;--Gt>=0;)vr=lr+Tt*(Xt=vr)-Wt*Pr,Pr=hr+Tt*Pr+Wt*Xt,lr=(tr=Fe[Gt])[0]+Tt*(Xt=lr)-Wt*hr,hr=tr[1]+Tt*hr+Wt*Xt;var Jr,on,_n=(vr=lr+Tt*(Xt=vr)-Wt*Pr)*vr+(Pr=hr+Tt*Pr+Wt*Xt)*Pr;Tt-=Jr=((lr=Tt*(Xt=lr)-Wt*hr-rt)*vr+(hr=Tt*hr+Wt*Xt-dt)*Pr)/_n,Wt-=on=(hr*vr-lr*Pr)/_n}while(u(Jr)+u(on)>1e-12&&--ft>0);if(ft){var Mn=z(Tt*Tt+Wt*Wt),Rn=2*e(.5*Mn),An=m(Rn);return[l(Tt*An,Mn*o(Rn)),Mn?S(Wt*An/Mn):0]}},Je}bn.invert=function(Fe,Ve){var Je=u(Fe),rt=u(Ve),dt=v,ft=_;rt<Zr?ft*=rt/Zr:dt+=6*P(Zr/rt);for(var Tt=0;Tt<25;Tt++){var Wt=m(ft),Xt=z(o(ft)),Gt=m(ft/2),tr=o(ft/2),lr=m(dt/6),hr=o(dt/6),vr=.5*dt*(1+Xt)-Je,Pr=ft/(tr*hr)-rt,Jr=Xt?-.25*dt*Wt/Xt:0,on=.5*(1+Xt),_n=(1+.5*ft*Gt/tr)/(tr*hr),Mn=ft/tr*(lr/6)/(hr*hr),Rn=Jr*Mn-_n*on,An=(vr*Mn-Pr*on)/Rn,ha=(Pr*Jr-vr*_n)/Rn;if(ft-=An,dt-=ha,u(An)<v&&u(ha)<v)break}return[Fe<0?-dt:dt,Ve<0?-ft:ft]},Dr.invert=function(Fe,Ve){var Je=g(Fe)*T,rt=Ve/2,dt=50;do{var ft=Je*Je,Tt=rt*rt,Wt=Je*rt,Xt=Je*(.975534+Tt*(-.0143059*ft-.119161+-.0547009*Tt))-Fe,Gt=rt*(1.00384+ft*(.0802894+-.02855*Tt+199025e-9*ft)+Tt*(.0998909+-.0491032*Tt))-Ve,tr=.975534-Tt*(.119161+3*ft*.0143059+.0547009*Tt),lr=-Wt*(.238322+.2188036*Tt+.0286118*ft),hr=Wt*(.1605788+7961e-7*ft+-.0571*Tt),vr=1.00384+ft*(.0802894+199025e-9*ft)+Tt*(3*(.0998909-.02855*ft)-.245516*Tt),Pr=lr*hr-vr*tr,Jr=(Gt*lr-Xt*vr)/Pr,on=(Xt*hr-Gt*tr)/Pr;Je-=Jr,rt-=on}while((u(Jr)>v||u(on)>v)&&--dt>0);return dt&&[Je,rt]},br.invert=function(Fe,Ve){var Je=Fe*Fe,rt=Ve*Ve+1,dt=Je+rt,ft=Fe?E*z((dt-z(dt*dt-4*Je))/Je):1/z(rt);return[S(Fe*ft),g(Ve)*P(ft)]},fn.invert=function(Fe,Ve){return[Fe,2.5*e(a(.8*Ve))-.625*T]};var un=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],Pn=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],kn=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Hn=[[.9245,0],[0,0],[.01943,0]],aa=[[.721316,0],[0,0],[-.00881625,-.00617325]];function gt(Fe,Ve){var Je=h.geoProjection(Qr(Fe)).rotate(Ve).clipAngle(90),rt=h.geoRotation(Ve),dt=Je.center;return delete Je.rotate,Je.center=function(ft){return arguments.length?dt(rt(ft)):rt.invert(dt())},Je}var Qt=z(6),Zt=z(7);function pr(Fe,Ve){var Je=S(7*m(Ve)/(3*Qt));return[Qt*Fe*(2*o(2*Je/3)-1)/Zt,9*m(Je/3)/Zt]}function Mr(Fe,Ve){for(var Je,rt=(1+E)*m(Ve),dt=Ve,ft=0;ft<25&&(dt-=Je=(m(dt/2)+m(dt)-rt)/(.5*o(dt/2)+o(dt)),!(u(Je)<v));ft++);return[Fe*(1+2*o(dt)/o(dt/2))/(3*A),2*z(3)*m(dt/2)/z(2+A)]}function Vr(Fe,Ve){for(var Je,rt=z(6/(4+T)),dt=(1+T/4)*m(Ve),ft=Ve/2,Tt=0;Tt<25&&(ft-=Je=(ft/2+m(ft)-dt)/(.5+o(ft)),!(u(Je)<v));Tt++);return[rt*(.5+o(ft))*Fe/1.5,rt*ft]}function kr(Fe,Ve){var Je=Ve*Ve,rt=Je*Je,dt=Je*rt;return[Fe*(.84719-.13063*Je+dt*dt*(.05494*Je-.04515-.02326*rt+.00331*dt)),Ve*(1.01183+rt*rt*(.01926*Je-.02625-.00396*rt))]}function ur(Fe,Ve){return[Fe*(1+o(Ve))/2,2*(Ve-y(Ve/2))]}pr.invert=function(Fe,Ve){var Je=3*S(Ve*Zt/9);return[Fe*Zt/(Qt*(2*o(2*Je/3)-1)),S(3*m(Je)*Qt/7)]},Mr.invert=function(Fe,Ve){var Je=Ve*z(2+A)/(2*z(3)),rt=2*S(Je);return[3*A*Fe/(1+2*o(rt)/o(rt/2)),S((Je+m(rt))/(1+E))]},Vr.invert=function(Fe,Ve){var Je=z(6/(4+T)),rt=Ve/Je;return u(u(rt)-_)<v&&(rt=rt<0?-_:_),[1.5*Fe/(Je*(.5+o(rt))),S((rt/2+m(rt))/(1+T/4))]},kr.invert=function(Fe,Ve){var Je,rt,dt,ft,Tt=Ve,Wt=25;do Tt-=Je=(Tt*(1.01183+(dt=(rt=Tt*Tt)*rt)*dt*(.01926*rt-.02625-.00396*dt))-Ve)/(1.01183+dt*dt*(.21186*rt-.23625+-.05148*dt));while(u(Je)>1e-12&&--Wt>0);return[Fe/(.84719-.13063*(rt=Tt*Tt)+(ft=rt*(dt=rt*rt))*ft*(.05494*rt-.04515-.02326*dt+.00331*ft)),Tt]},ur.invert=function(Fe,Ve){for(var Je=Ve/2,rt=0,dt=1/0;rt<10&&u(dt)>v;++rt){var ft=o(Ve/2);Ve-=dt=(Ve-y(Ve/2)-Je)/(1-.5/(ft*ft))}return[2*Fe/(1+o(Ve)),Ve]};var Ir=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function mr(Fe,Ve){var Je=m(Ve),rt=o(Ve),dt=g(Fe);if(Fe===0||u(Ve)===_)return[0,Ve];if(Ve===0)return[Fe,0];if(u(Fe)===_)return[Fe*rt,_*Je];var ft=T/(2*Fe)-2*Fe/T,Tt=2*Ve/T,Wt=(1-Tt*Tt)/(Je-Tt),Xt=ft*ft,Gt=Wt*Wt,tr=1+Xt/Gt,lr=1+Gt/Xt,hr=(ft*Je/Wt-ft/2)/tr,vr=(Gt*Je/Xt+Wt/2)/lr,Pr=vr*vr-(Gt*Je*Je/Xt+Wt*Je-1)/lr;return[_*(hr+z(hr*hr+rt*rt/tr)*dt),_*(vr+z(Pr<0?0:Pr)*g(-Ve*ft)*dt)]}mr.invert=function(Fe,Ve){var Je=(Fe/=_)*Fe,rt=Je+(Ve/=_)*Ve,dt=T*T;return[Fe?(rt-1+z((1-rt)*(1-rt)+4*Je))/(2*Fe)*_:0,$(function(ft){return rt*(T*m(ft)-2*ft)*T+4*ft*ft*(Ve-m(ft))+2*T*ft-dt*Ve},0)]};function _r(Fe,Ve){var Je=Ve*Ve;return[Fe,Ve*(1.0148+Je*Je*(.23185+Je*(.02406*Je-.14499)))]}function Nr(Fe,Ve){if(u(Ve)<v)return[Fe,0];var Je=y(Ve),rt=Fe*m(Ve);return[m(rt)/Je,Ve+(1-o(rt))/Je]}function vn(Fe,Ve){var Je=wn(Fe[1],Fe[0]),rt=wn(Ve[1],Ve[0]),dt=function(Tt,Wt){return l(Tt[0]*Wt[1]-Tt[1]*Wt[0],Tt[0]*Wt[0]+Tt[1]*Wt[1])}(Je,rt),ft=ln(Je)/ln(rt);return xn([1,0,Fe[0][0],0,1,Fe[0][1]],xn([ft,0,0,0,ft,0],xn([o(dt),m(dt),0,-m(dt),o(dt),0],[1,0,-Ve[0][0],0,1,-Ve[0][1]])))}function xn(Fe,Ve){return[Fe[0]*Ve[0]+Fe[1]*Ve[3],Fe[0]*Ve[1]+Fe[1]*Ve[4],Fe[0]*Ve[2]+Fe[1]*Ve[5]+Fe[2],Fe[3]*Ve[0]+Fe[4]*Ve[3],Fe[3]*Ve[1]+Fe[4]*Ve[4],Fe[3]*Ve[2]+Fe[4]*Ve[5]+Fe[5]]}function wn(Fe,Ve){return[Fe[0]-Ve[0],Fe[1]-Ve[1]]}function ln(Fe){return z(Fe[0]*Fe[0]+Fe[1]*Fe[1])}function zn(Fe,Ve,Je){function rt(Tt,Wt){var Xt,Gt=Ve(Tt,Wt),tr=Gt.project([Tt*w,Wt*w]);return(Xt=Gt.transform)?[Xt[0]*tr[0]+Xt[1]*tr[1]+Xt[2],-(Xt[3]*tr[0]+Xt[4]*tr[1]+Xt[5])]:(tr[1]=-tr[1],tr)}(function Tt(Wt,Xt){if(Wt.edges=function(Pr){for(var Jr=Pr.length,on=[],_n=Pr[Jr-1],Mn=0;Mn<Jr;++Mn)on.push([_n,_n=Pr[Mn]]);return on}(Wt.face),Xt.face){var Gt=Wt.shared=function(Pr,Jr){for(var on,_n,Mn=Pr.length,Rn=null,An=0;An<Mn;++An){on=Pr[An];for(var ha=Jr.length;--ha>=0;)if(_n=Jr[ha],on[0]===_n[0]&&on[1]===_n[1]){if(Rn)return[Rn,on];Rn=on}}}(Wt.face,Xt.face),tr=vn(Gt.map(Xt.project),Gt.map(Wt.project));Wt.transform=Xt.transform?xn(Xt.transform,tr):tr;for(var lr=Xt.edges,hr=0,vr=lr.length;hr<vr;++hr)ca(Gt[0],lr[hr][1])&&ca(Gt[1],lr[hr][0])&&(lr[hr]=Wt),ca(Gt[0],lr[hr][0])&&ca(Gt[1],lr[hr][1])&&(lr[hr]=Wt);for(lr=Wt.edges,hr=0,vr=lr.length;hr<vr;++hr)ca(Gt[0],lr[hr][0])&&ca(Gt[1],lr[hr][1])&&(lr[hr]=Xt),ca(Gt[0],lr[hr][1])&&ca(Gt[1],lr[hr][0])&&(lr[hr]=Xt)}else Wt.transform=Xt.transform;return Wt.children&&Wt.children.forEach(function(Pr){Tt(Pr,Wt)}),Wt})(Fe,{transform:null}),Kn(Fe)&&(rt.invert=function(Tt,Wt){var Xt=function Gt(tr,lr){var hr=tr.project.invert,vr=tr.transform,Pr=lr;if(vr&&(vr=function(Rn){var An=1/(Rn[0]*Rn[4]-Rn[1]*Rn[3]);return[An*Rn[4],-An*Rn[1],An*(Rn[1]*Rn[5]-Rn[2]*Rn[4]),-An*Rn[3],An*Rn[0],An*(Rn[2]*Rn[3]-Rn[0]*Rn[5])]}(vr),Pr=[vr[0]*Pr[0]+vr[1]*Pr[1]+vr[2],vr[3]*Pr[0]+vr[4]*Pr[1]+vr[5]]),hr&&tr===function(Rn){return Ve(Rn[0]*C,Rn[1]*C)}(Jr=hr(Pr)))return Jr;for(var Jr,on=tr.children,_n=0,Mn=on&&on.length;_n<Mn;++_n)if(Jr=Gt(on[_n],lr))return Jr}(Fe,[Tt,-Wt]);return Xt&&(Xt[0]*=C,Xt[1]*=C,Xt)});var dt=h.geoProjection(rt),ft=dt.stream;return dt.stream=function(Tt){var Wt=dt.rotate(),Xt=ft(Tt),Gt=(dt.rotate([0,0]),ft(Tt));return dt.rotate(Wt),Xt.sphere=function(){Gt.polygonStart(),Gt.lineStart(),function tr(lr,hr,vr){var Pr,Jr,on=hr.edges,_n=on.length,Mn={type:"MultiPoint",coordinates:hr.face},Rn=hr.face.filter(function(xi){return u(xi[1])!==90}),An=h.geoBounds({type:"MultiPoint",coordinates:Rn}),ha=!1,wa=-1,Da=An[1][0]-An[0][0],za=Da===180||Da===360?[(An[0][0]+An[1][0])/2,(An[0][1]+An[1][1])/2]:h.geoCentroid(Mn);if(vr)for(;++wa<_n&&on[wa]!==vr;);++wa;for(var Ra=0;Ra<_n;++Ra)Jr=on[(Ra+wa)%_n],Array.isArray(Jr)?(ha||(lr.point((Pr=h.geoInterpolate(Jr[0],za)(v))[0],Pr[1]),ha=!0),lr.point((Pr=h.geoInterpolate(Jr[1],za)(v))[0],Pr[1])):(ha=!1,Jr!==vr&&tr(lr,Jr,hr))}(Gt,Fe),Gt.lineEnd(),Gt.polygonEnd()},Xt},dt.angle(Je==null?-30:Je*w)}function ca(Fe,Ve){return Fe&&Ve&&Fe[0]===Ve[0]&&Fe[1]===Ve[1]}function Kn(Fe){return Fe.project.invert||Fe.children&&Fe.children.some(Kn)}_r.invert=function(Fe,Ve){Ve>1.790857183?Ve=1.790857183:Ve<-1.790857183&&(Ve=-1.790857183);var Je,rt=Ve;do{var dt=rt*rt;rt-=Je=(rt*(1.0148+dt*dt*(.23185+dt*(.02406*dt-.14499)))-Ve)/(1.0148+dt*dt*(5*.23185+dt*(.21654*dt-1.01493)))}while(u(Je)>v);return[Fe,rt]},Nr.invert=function(Fe,Ve){if(u(Ve)<v)return[Fe,0];var Je,rt=Fe*Fe+Ve*Ve,dt=.5*Ve,ft=10;do{var Tt=y(dt),Wt=1/o(dt),Xt=rt-2*Ve*dt+dt*dt;dt-=Je=(Tt*Xt+2*(dt-Ve))/(2+Xt*Wt*Wt+2*(dt-Ve)*Tt)}while(u(Je)>v&&--ft>0);return Tt=y(dt),[(u(Ve)<u(dt+1/Tt)?S(Fe*Tt):g(Ve)*g(Fe)*(P(u(Fe*Tt))+_))/m(dt),dt]};var On=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Nn=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(Fe){return Fe.map(function(Ve){return On[Ve]})}),ba=2/z(3);function Wn(Fe,Ve){var Je=De(Fe,Ve);return[Je[0]*ba,Je[1]]}function cn(Fe,Ve){for(var Je=0,rt=Fe.length,dt=0;Je<rt;++Je)dt+=Fe[Je]*Ve[Je];return dt}function $n(Fe){return[l(Fe[1],Fe[0])*w,S(r(-1,c(1,Fe[2])))*w]}function ua(Fe){var Ve=Fe[0]*C,Je=Fe[1]*C,rt=o(Je);return[rt*o(Ve),rt*m(Ve),m(Je)]}function Xa(){}function Ci(Fe,Ve){return{type:"FeatureCollection",features:Fe.features.map(function(Je){return ri(Je,Ve)})}}function ri(Fe,Ve){return{type:"Feature",id:Fe.id,properties:Fe.properties,geometry:vi(Fe.geometry,Ve)}}function vi(Fe,Ve){if(!Fe)return null;if(Fe.type==="GeometryCollection")return function(rt,dt){return{type:"GeometryCollection",geometries:rt.geometries.map(function(ft){return vi(ft,dt)})}}(Fe,Ve);var Je;switch(Fe.type){case"Point":case"MultiPoint":Je=co;break;case"LineString":case"MultiLineString":Je=Fo;break;case"Polygon":case"MultiPolygon":case"Sphere":Je=Yo;break;default:return null}return h.geoStream(Fe,Ve(Je)),Je.result()}Wn.invert=function(Fe,Ve){return De.invert(Fe/ba,Ve)};var Aa=[],Na=[],co={point:function(Fe,Ve){Aa.push([Fe,Ve])},result:function(){var Fe=Aa.length?Aa.length<2?{type:"Point",coordinates:Aa[0]}:{type:"MultiPoint",coordinates:Aa}:null;return Aa=[],Fe}},Fo={lineStart:Xa,point:function(Fe,Ve){Aa.push([Fe,Ve])},lineEnd:function(){Aa.length&&(Na.push(Aa),Aa=[])},result:function(){var Fe=Na.length?Na.length<2?{type:"LineString",coordinates:Na[0]}:{type:"MultiLineString",coordinates:Na}:null;return Na=[],Fe}},Yo={polygonStart:Xa,lineStart:Xa,point:function(Fe,Ve){Aa.push([Fe,Ve])},lineEnd:function(){var Fe=Aa.length;if(Fe){do Aa.push(Aa[0].slice());while(++Fe<4);Na.push(Aa),Aa=[]}},polygonEnd:Xa,result:function(){if(!Na.length)return null;var Fe=[],Ve=[];return Na.forEach(function(Je){(function(rt){if((dt=rt.length)<4)return!1;for(var dt,ft=0,Tt=rt[dt-1][1]*rt[0][0]-rt[dt-1][0]*rt[0][1];++ft<dt;)Tt+=rt[ft-1][1]*rt[ft][0]-rt[ft-1][0]*rt[ft][1];return Tt<=0})(Je)?Fe.push([Je]):Ve.push(Je)}),Ve.forEach(function(Je){var rt=Je[0];Fe.some(function(dt){if(function(ft,Tt){for(var Wt=Tt[0],Xt=Tt[1],Gt=!1,tr=0,lr=ft.length,hr=lr-1;tr<lr;hr=tr++){var vr=ft[tr],Pr=vr[0],Jr=vr[1],on=ft[hr],_n=on[0],Mn=on[1];Jr>Xt^Mn>Xt&&Wt<(_n-Pr)*(Xt-Jr)/(Mn-Jr)+Pr&&(Gt=!Gt)}return Gt}(dt[0],rt))return dt.push(Je),!0})||Fe.push([Je])}),Na=[],Fe.length?Fe.length>1?{type:"MultiPolygon",coordinates:Fe}:{type:"Polygon",coordinates:Fe[0]}:null}};function Hi(Fe){var Ve=Fe(_,0)[0]-Fe(-_,0)[0];function Je(rt,dt){var ft=u(rt)<_,Tt=Fe(ft?rt:rt>0?rt-T:rt+T,dt),Wt=(Tt[0]-Tt[1])*E,Xt=(Tt[0]+Tt[1])*E;if(ft)return[Wt,Xt];var Gt=Ve*E,tr=Wt>0^Xt>0?-1:1;return[tr*Wt-g(Xt)*Gt,tr*Xt-g(Wt)*Gt]}return Fe.invert&&(Je.invert=function(rt,dt){var ft=(rt+dt)*E,Tt=(dt-rt)*E,Wt=u(ft)<.5*Ve&&u(Tt)<.5*Ve;if(!Wt){var Xt=Ve*E,Gt=ft>0^Tt>0?-1:1,tr=-Gt*rt+(Tt>0?1:-1)*Xt,lr=-Gt*dt+(ft>0?1:-1)*Xt;ft=(-tr-lr)*E,Tt=(tr-lr)*E}var hr=Fe.invert(ft,Tt);return Wt||(hr[0]+=ft>0?T:-T),hr}),h.geoProjection(Je).rotate([-90,-90,45]).clipAngle(179.999)}function Wi(){return Hi(St).scale(111.48)}function Bo(Fe){var Ve=m(Fe);function Je(rt,dt){var ft=Ve?y(rt*Ve/2)/Ve:rt/2;if(!dt)return[2*ft,-Fe];var Tt=2*e(ft*m(dt)),Wt=1/y(dt);return[m(Tt)*Wt,dt+(1-o(Tt))*Wt-Fe]}return Je.invert=function(rt,dt){if(u(dt+=Fe)<v)return[Ve?2*e(Ve*rt/2)/Ve:rt,0];var ft,Tt=rt*rt+dt*dt,Wt=0,Xt=10;do{var Gt=y(Wt),tr=1/o(Wt),lr=Tt-2*dt*Wt+Wt*Wt;Wt-=ft=(Gt*lr+2*(Wt-dt))/(2+lr*tr*tr+2*(Wt-dt)*Gt)}while(u(ft)>v&&--Xt>0);var hr=rt*(Gt=y(Wt)),vr=y(u(dt)<u(Wt+1/Gt)?.5*S(hr):.5*P(hr)+T/4)/m(Wt);return[Ve?2*e(Ve*vr)/Ve:2*vr,Wt]},Je}var Va=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function ko(Fe,Ve){var Je,rt=c(18,36*u(Ve)/T),dt=n(rt),ft=rt-dt,Tt=(Je=Va[dt])[0],Wt=Je[1],Xt=(Je=Va[++dt])[0],Gt=Je[1],tr=(Je=Va[c(19,++dt)])[0],lr=Je[1];return[Fe*(Xt+ft*(tr-Tt)/2+ft*ft*(tr-2*Xt+Tt)/2),(Ve>0?_:-_)*(Gt+ft*(lr-Wt)/2+ft*ft*(lr-2*Gt+Wt)/2)]}function uo(Fe,Ve){var Je=function(Tt){function Wt(Xt,Gt){var tr=o(Gt),lr=(Tt-1)/(Tt-tr*o(Xt));return[lr*tr*m(Xt),lr*m(Gt)]}return Wt.invert=function(Xt,Gt){var tr=Xt*Xt+Gt*Gt,lr=z(tr),hr=(Tt-z(1-tr*(Tt+1)/(Tt-1)))/((Tt-1)/lr+lr/(Tt-1));return[l(Xt*hr,lr*z(1-hr*hr)),lr?S(Gt*hr/lr):0]},Wt}(Fe);if(!Ve)return Je;var rt=o(Ve),dt=m(Ve);function ft(Tt,Wt){var Xt=Je(Tt,Wt),Gt=Xt[1],tr=Gt*dt/(Fe-1)+rt;return[Xt[0]*rt/tr,Gt/tr]}return ft.invert=function(Tt,Wt){var Xt=(Fe-1)/(Fe-1-Wt*dt);return Je.invert(Xt*Tt,Xt*Wt*rt)},ft}Va.forEach(function(Fe){Fe[1]*=1.0144}),ko.invert=function(Fe,Ve){var Je=Ve/_,rt=90*Je,dt=c(18,u(rt/5)),ft=r(0,n(dt));do{var Tt=Va[ft][1],Wt=Va[ft+1][1],Xt=Va[c(19,ft+2)][1],Gt=Xt-Tt,tr=Xt-2*Wt+Tt,lr=2*(u(Je)-Wt)/Gt,hr=tr/Gt,vr=lr*(1-hr*lr*(1-2*hr*lr));if(vr>=0||ft===1){rt=(Ve>=0?5:-5)*(vr+dt);var Pr,Jr=50;do vr=(dt=c(18,u(rt)/5))-(ft=n(dt)),Tt=Va[ft][1],Wt=Va[ft+1][1],Xt=Va[c(19,ft+2)][1],rt-=(Pr=(Ve>=0?_:-_)*(Wt+vr*(Xt-Tt)/2+vr*vr*(Xt-2*Wt+Tt)/2)-Ve)*w;while(u(Pr)>1e-12&&--Jr>0);break}}while(--ft>=0);var on=Va[ft][0],_n=Va[ft+1][0],Mn=Va[c(19,ft+2)][0];return[Fe/(_n+vr*(Mn-on)/2+vr*vr*(Mn-2*_n+on)/2),rt*C]};var yi=-179.9999,Xi=179.9999,fo=-89.9999;function _o(Fe){return Fe.length>0}function Di(Fe){return Fe===-90||Fe===90?[0,Fe]:[-180,(Ve=Fe,Math.floor(1e4*Ve)/1e4)];var Ve}function ui(Fe){var Ve=Fe[0],Je=Fe[1],rt=!1;return Ve<=yi?(Ve=-180,rt=!0):Ve>=Xi&&(Ve=180,rt=!0),Je<=fo?(Je=-90,rt=!0):Je>=89.9999&&(Je=90,rt=!0),rt?[Ve,Je]:Fe}function Gi(Fe){return Fe.map(ui)}function ms(Fe,Ve,Je){for(var rt=0,dt=Fe.length;rt<dt;++rt){var ft=Fe[rt].slice();Je.push({index:-1,polygon:Ve,ring:ft});for(var Tt=0,Wt=ft.length;Tt<Wt;++Tt){var Xt=ft[Tt],Gt=Xt[0],tr=Xt[1];if(Gt<=yi||Gt>=Xi||tr<=fo||tr>=89.9999){ft[Tt]=ui(Xt);for(var lr=Tt+1;lr<Wt;++lr){var hr=ft[lr],vr=hr[0],Pr=hr[1];if(vr>yi&&vr<Xi&&Pr>fo&&Pr<89.9999)break}if(lr===Tt+1)continue;if(Tt){var Jr={index:-1,polygon:Ve,ring:ft.slice(0,Tt+1)};Jr.ring[Jr.ring.length-1]=Di(tr),Je[Je.length-1]=Jr}else Je.pop();if(lr>=Wt)break;Je.push({index:-1,polygon:Ve,ring:ft=ft.slice(lr-1)}),ft[0]=Di(ft[0][1]),Tt=-1,Wt=ft.length}}}}function bs(Fe){var Ve,Je,rt,dt,ft,Tt,Wt=Fe.length,Xt={},Gt={};for(Ve=0;Ve<Wt;++Ve)rt=(Je=Fe[Ve]).ring[0],ft=Je.ring[Je.ring.length-1],rt[0]!==ft[0]||rt[1]!==ft[1]?(Je.index=Ve,Xt[rt]=Gt[ft]=Je):(Je.polygon.push(Je.ring),Fe[Ve]=null);for(Ve=0;Ve<Wt;++Ve)if(Je=Fe[Ve]){if(rt=Je.ring[0],ft=Je.ring[Je.ring.length-1],dt=Gt[rt],Tt=Xt[ft],delete Xt[rt],delete Gt[ft],rt[0]===ft[0]&&rt[1]===ft[1]){Je.polygon.push(Je.ring);continue}dt?(delete Gt[rt],delete Xt[dt.ring[0]],dt.ring.pop(),Fe[dt.index]=null,Je={index:-1,polygon:dt.polygon,ring:dt.ring.concat(Je.ring)},dt===Tt?Je.polygon.push(Je.ring):(Je.index=Wt++,Fe.push(Xt[Je.ring[0]]=Gt[Je.ring[Je.ring.length-1]]=Je))):Tt?(delete Xt[ft],delete Gt[Tt.ring[Tt.ring.length-1]],Je.ring.pop(),Je={index:Wt++,polygon:Tt.polygon,ring:Je.ring.concat(Tt.ring)},Fe[Tt.index]=null,Fe.push(Xt[Je.ring[0]]=Gt[Je.ring[Je.ring.length-1]]=Je)):(Je.ring.push(Je.ring[0]),Je.polygon.push(Je.ring))}}function qa(Fe){var Ve={type:"Feature",geometry:us(Fe.geometry)};return Fe.id!=null&&(Ve.id=Fe.id),Fe.bbox!=null&&(Ve.bbox=Fe.bbox),Fe.properties!=null&&(Ve.properties=Fe.properties),Ve}function us(Fe){if(Fe==null)return Fe;var Ve,Je,rt,dt;switch(Fe.type){case"GeometryCollection":Ve={type:"GeometryCollection",geometries:Fe.geometries.map(us)};break;case"Point":Ve={type:"Point",coordinates:ui(Fe.coordinates)};break;case"MultiPoint":case"LineString":Ve={type:Fe.type,coordinates:Gi(Fe.coordinates)};break;case"MultiLineString":Ve={type:"MultiLineString",coordinates:Fe.coordinates.map(Gi)};break;case"Polygon":var ft=[];ms(Fe.coordinates,ft,Je=[]),bs(Je),Ve={type:"Polygon",coordinates:ft};break;case"MultiPolygon":Je=[],rt=-1,dt=Fe.coordinates.length;for(var Tt=new Array(dt);++rt<dt;)ms(Fe.coordinates[rt],Tt[rt]=[],Je);bs(Je),Ve={type:"MultiPolygon",coordinates:Tt.filter(_o)};break;default:return Fe}return Fe.bbox!=null&&(Ve.bbox=Fe.bbox),Ve}function Ko(Fe,Ve){var Je=y(Ve/2),rt=m(k*Je);return[Fe*(.74482-.34588*rt*rt),1.70711*Je]}function _s(Fe,Ve,Je){var rt=h.geoInterpolate(Ve,Je),dt=rt(.5),ft=h.geoRotation([-dt[0],-dt[1]])(Ve),Tt=rt.distance/2,Wt=-S(m(ft[1]*C)/m(Tt)),Xt=[-dt[0],-dt[1],-(ft[0]>0?T-Wt:Wt)*w],Gt=h.geoProjection(Fe(Tt)).rotate(Xt),tr=h.geoRotation(Xt),lr=Gt.center;return delete Gt.rotate,Gt.center=function(hr){return arguments.length?lr(tr(hr)):tr.invert(lr())},Gt.clipAngle(90)}function ws(Fe){var Ve=o(Fe);function Je(rt,dt){var ft=h.geoGnomonicRaw(rt,dt);return ft[0]*=Ve,ft}return Je.invert=function(rt,dt){return h.geoGnomonicRaw.invert(rt/Ve,dt)},Je}function vs(Fe,Ve){return _s(ws,Fe,Ve)}function Ts(Fe){if(!(Fe*=2))return h.geoAzimuthalEquidistantRaw;var Ve=-Fe/2,Je=-Ve,rt=Fe*Fe,dt=y(Je),ft=.5/m(Je);function Tt(Wt,Xt){var Gt=P(o(Xt)*o(Wt-Ve)),tr=P(o(Xt)*o(Wt-Je));return[((Gt*=Gt)-(tr*=tr))/(2*Fe),(Xt<0?-1:1)*z(4*rt*tr-(rt-Gt+tr)*(rt-Gt+tr))/(2*Fe)]}return Tt.invert=function(Wt,Xt){var Gt,tr,lr=Xt*Xt,hr=o(z(lr+(Gt=Wt+Ve)*Gt)),vr=o(z(lr+(Gt=Wt+Je)*Gt));return[l(tr=hr-vr,Gt=(hr+vr)*dt),(Xt<0?-1:1)*P(z(Gt*Gt+tr*tr)*ft)]},Tt}function Mo(Fe,Ve){return _s(Ts,Fe,Ve)}function Ao(Fe,Ve){if(u(Ve)<v)return[Fe,0];var Je=u(Ve/_),rt=S(Je);if(u(Fe)<v||u(u(Ve)-_)<v)return[0,g(Ve)*T*y(rt/2)];var dt=o(rt),ft=u(T/Fe-Fe/T)/2,Tt=ft*ft,Wt=dt/(Je+dt-1),Xt=Wt*(2/Je-1),Gt=Xt*Xt,tr=Gt+Tt,lr=Wt-Gt,hr=Tt+Wt;return[g(Fe)*T*(ft*lr+z(Tt*lr*lr-tr*(Wt*Wt-Gt)))/tr,g(Ve)*T*(Xt*hr-ft*z((Tt+1)*tr-hr*hr))/tr]}function No(Fe,Ve){if(u(Ve)<v)return[Fe,0];var Je=u(Ve/_),rt=S(Je);if(u(Fe)<v||u(u(Ve)-_)<v)return[0,g(Ve)*T*y(rt/2)];var dt=o(rt),ft=u(T/Fe-Fe/T)/2,Tt=ft*ft,Wt=dt*(z(1+Tt)-ft*dt)/(1+Tt*Je*Je);return[g(Fe)*T*Wt,g(Ve)*T*z(1-Wt*(2*ft+Wt))]}function jo(Fe,Ve){if(u(Ve)<v)return[Fe,0];var Je=Ve/_,rt=S(Je);if(u(Fe)<v||u(u(Ve)-_)<v)return[0,T*y(rt/2)];var dt=(T/Fe-Fe/T)/2,ft=Je/(1+o(rt));return[T*(g(Fe)*z(dt*dt+1-ft*ft)-dt),T*ft]}function Uo(Fe,Ve){if(!Ve)return[Fe,0];var Je=u(Ve);if(!Fe||Je===_)return[0,Ve];var rt=Je/_,dt=rt*rt,ft=(8*rt-dt*(dt+2)-5)/(2*dt*(rt-1)),Tt=ft*ft,Wt=rt*ft,Xt=dt+Tt+2*Wt,Gt=rt+3*ft,tr=Fe/_,lr=tr+1/tr,hr=g(u(Fe)-_)*z(lr*lr-4),vr=hr*hr,Pr=(hr*(Xt+Tt-1)+2*z(Xt*(dt+Tt*vr-1)+(1-dt)*(dt*(Gt*Gt+4*Tt)+12*Wt*Tt+4*Tt*Tt)))/(4*Xt+vr);return[g(Fe)*_*Pr,g(Ve)*_*z(1+hr*u(Pr)-Pr*Pr)]}function Qo(Fe,Ve,Je,rt){var dt=T/3;Fe=r(Fe,v),Ve=r(Ve,v),Fe=c(Fe,_),Ve=c(Ve,T-v),Je=r(Je,0),Je=c(Je,100-v);var ft=(rt=r(rt,v))/100,Tt=P((Je/100+1)*o(dt))/dt,Wt=m(Fe)/m(Tt*_),Xt=Ve/T,Gt=z(ft*m(Fe/2)/m(Ve/2));return function(tr,lr,hr,vr,Pr){function Jr(on,_n){var Mn=hr*m(vr*_n),Rn=z(1-Mn*Mn),An=z(2/(1+Rn*o(on*=Pr)));return[tr*Rn*An*m(on),lr*Mn*An]}return Jr.invert=function(on,_n){var Mn=on/tr,Rn=_n/lr,An=z(Mn*Mn+Rn*Rn),ha=2*S(An/2);return[l(on*y(ha),tr*An)/Pr,An&&S(_n*m(ha)/(lr*hr*An))/vr]},Jr}(Gt/z(Xt*Wt*Tt),1/(Gt*z(Xt*Wt*Tt)),Wt,Tt,Xt)}function ho(){var Fe=65*C,Ve=60*C,Je=20,rt=200,dt=h.geoProjectionMutator(Qo),ft=dt(Fe,Ve,Je,rt);return ft.poleline=function(Tt){return arguments.length?dt(Fe=+Tt*C,Ve,Je,rt):Fe*w},ft.parallels=function(Tt){return arguments.length?dt(Fe,Ve=+Tt*C,Je,rt):Ve*w},ft.inflation=function(Tt){return arguments.length?dt(Fe,Ve,Je=+Tt,rt):Je},ft.ratio=function(Tt){return arguments.length?dt(Fe,Ve,Je,rt=+Tt):rt},ft.scale(163.775)}Ko.invert=function(Fe,Ve){var Je=Ve/1.70711,rt=m(k*Je);return[Fe/(.74482-.34588*rt*rt),2*e(Je)]},Ao.invert=function(Fe,Ve){if(u(Ve)<v)return[Fe,0];if(u(Fe)<v)return[0,_*m(2*e(Ve/T))];var Je=(Fe/=T)*Fe,rt=(Ve/=T)*Ve,dt=Je+rt,ft=dt*dt,Tt=-u(Ve)*(1+dt),Wt=Tt-2*rt+Je,Xt=-2*Tt+1+2*rt+ft,Gt=rt/Xt+(2*Wt*Wt*Wt/(Xt*Xt*Xt)-9*Tt*Wt/(Xt*Xt))/27,tr=(Tt-Wt*Wt/(3*Xt))/Xt,lr=2*z(-tr/3),hr=P(3*Gt/(tr*lr))/3;return[T*(dt-1+z(1+2*(Je-rt)+ft))/(2*Fe),g(Ve)*T*(-lr*o(hr+T/3)-Wt/(3*Xt))]},No.invert=function(Fe,Ve){if(!Fe)return[0,_*m(2*e(Ve/T))];var Je=u(Fe/T),rt=(1-Je*Je-(Ve/=T)*Ve)/(2*Je),dt=z(rt*rt+1);return[g(Fe)*T*(dt-rt),g(Ve)*_*m(2*l(z((1-2*rt*Je)*(rt+dt)-Je),z(dt+rt+Je)))]},jo.invert=function(Fe,Ve){if(!Ve)return[Fe,0];var Je=Ve/T,rt=(T*T*(1-Je*Je)-Fe*Fe)/(2*T*Fe);return[Fe?T*(g(Fe)*z(rt*rt+1)-rt):0,_*m(2*e(Je))]},Uo.invert=function(Fe,Ve){var Je;if(!Fe||!Ve)return[Fe,Ve];Ve/=T;var rt=g(Fe)*Fe/_,dt=(rt*rt-1+4*Ve*Ve)/u(rt),ft=dt*dt,Tt=2*Ve,Wt=50;do{var Xt=Tt*Tt,Gt=(8*Tt-Xt*(Xt+2)-5)/(2*Xt*(Tt-1)),tr=(3*Tt-Xt*Tt-10)/(2*Xt*Tt),lr=Gt*Gt,hr=Tt*Gt,vr=Tt+Gt,Pr=vr*vr,Jr=Tt+3*Gt,on=-2*vr*(4*hr*lr+(1-4*Xt+3*Xt*Xt)*(1+tr)+lr*(14*Xt-6-ft+(8*Xt-8-2*ft)*tr)+hr*(12*Xt-8+(10*Xt-10-ft)*tr)),_n=z(Pr*(Xt+lr*ft-1)+(1-Xt)*(Xt*(Jr*Jr+4*lr)+lr*(12*hr+4*lr)));Tt-=Je=(dt*(Pr+lr-1)+2*_n-rt*(4*Pr+ft))/(dt*(2*Gt*tr+2*vr*(1+tr))+on/_n-8*vr*(dt*(-1+lr+Pr)+2*_n)*(1+tr)/(ft+4*Pr))}while(Je>v&&--Wt>0);return[g(Fe)*(z(dt*dt+4)+dt)*T/4,_*Tt]};var fs=4*T+3*z(3),oo=2*z(2*T*z(3)/fs),Vo=ae(oo*z(3)/T,oo,fs/6);function hs(Fe,Ve){return[Fe*z(1-3*Ve*Ve/(T*T)),Ve]}function So(Fe,Ve){var Je=o(Ve),rt=o(Fe)*Je,dt=1-rt,ft=o(Fe=l(m(Fe)*Je,-m(Ve))),Tt=m(Fe);return[Tt*(Je=z(1-rt*rt))-ft*dt,-ft*Je-Tt*dt]}function ja(Fe,Ve){var Je=X(Fe,Ve);return[(Je[0]+Fe/_)/2,(Je[1]+Ve)/2]}hs.invert=function(Fe,Ve){return[Fe/z(1-3*Ve*Ve/(T*T)),Ve]},So.invert=function(Fe,Ve){var Je=(Fe*Fe+Ve*Ve)/-2,rt=z(-Je*(2+Je)),dt=Ve*Je+Fe*rt,ft=Fe*Je-Ve*rt,Tt=z(ft*ft+dt*dt);return[l(rt*dt,Tt*(1+Je)),Tt?-S(rt*ft/Tt):0]},ja.invert=function(Fe,Ve){var Je=Fe,rt=Ve,dt=25;do{var ft,Tt=o(rt),Wt=m(rt),Xt=m(2*rt),Gt=Wt*Wt,tr=Tt*Tt,lr=m(Je),hr=o(Je/2),vr=m(Je/2),Pr=vr*vr,Jr=1-tr*hr*hr,on=Jr?P(Tt*hr)*z(ft=1/Jr):ft=0,_n=.5*(2*on*Tt*vr+Je/_)-Fe,Mn=.5*(on*Wt+rt)-Ve,Rn=.5*ft*(tr*Pr+on*Tt*hr*Gt)+.5/_,An=ft*(lr*Xt/4-on*Wt*vr),ha=.125*ft*(Xt*vr-on*Wt*tr*lr),wa=.5*ft*(Gt*hr+on*Pr*Tt)+.5,Da=An*ha-wa*Rn,za=(Mn*An-_n*wa)/Da,Ra=(_n*ha-Mn*Rn)/Da;Je-=za,rt-=Ra}while((u(za)>v||u(Ra)>v)&&--dt>0);return[Je,rt]},t.geoNaturalEarth=h.geoNaturalEarth1,t.geoNaturalEarthRaw=h.geoNaturalEarth1Raw,t.geoAiry=function(){var Fe=_,Ve=h.geoProjectionMutator(W),Je=Ve(Fe);return Je.radius=function(rt){return arguments.length?Ve(Fe=rt*C):Fe*w},Je.scale(179.976).clipAngle(147)},t.geoAiryRaw=W,t.geoAitoff=function(){return h.geoProjection(X).scale(152.63)},t.geoAitoffRaw=X,t.geoArmadillo=function(){var Fe=20*C,Ve=Fe>=0?1:-1,Je=y(Ve*Fe),rt=h.geoProjectionMutator(Q),dt=rt(Fe),ft=dt.stream;return dt.parallel=function(Tt){return arguments.length?(Je=y((Ve=(Fe=Tt*C)>=0?1:-1)*Fe),rt(Fe)):Fe*w},dt.stream=function(Tt){var Wt=dt.rotate(),Xt=ft(Tt),Gt=(dt.rotate([0,0]),ft(Tt)),tr=dt.precision();return dt.rotate(Wt),Xt.sphere=function(){Gt.polygonStart(),Gt.lineStart();for(var lr=-180*Ve;Ve*lr<180;lr+=90*Ve)Gt.point(lr,90*Ve);if(Fe)for(;Ve*(lr-=3*Ve*tr)>=-180;)Gt.point(lr,Ve*-l(o(lr*C/2),Je)*w);Gt.lineEnd(),Gt.polygonEnd()},Xt},dt.scale(218.695).center([0,28.0974])},t.geoArmadilloRaw=Q,t.geoAugust=function(){return h.geoProjection(Z).scale(66.1603)},t.geoAugustRaw=Z,t.geoBaker=function(){return h.geoProjection(J).scale(112.314)},t.geoBakerRaw=J,t.geoBerghaus=function(){var Fe=5,Ve=h.geoProjectionMutator(D),Je=Ve(Fe),rt=Je.stream,dt=-o(.01*C),ft=m(.01*C);return Je.lobes=function(Tt){return arguments.length?Ve(Fe=+Tt):Fe},Je.stream=function(Tt){var Wt=Je.rotate(),Xt=rt(Tt),Gt=(Je.rotate([0,0]),rt(Tt));return Je.rotate(Wt),Xt.sphere=function(){Gt.polygonStart(),Gt.lineStart();for(var tr=0,lr=360/Fe,hr=2*T/Fe,vr=90-180/Fe,Pr=_;tr<Fe;++tr,vr-=lr,Pr-=hr)Gt.point(l(ft*o(Pr),dt)*w,S(ft*m(Pr))*w),vr<-90?(Gt.point(-90,-180-vr-.01),Gt.point(-90,-180-vr+.01)):(Gt.point(90,vr+.01),Gt.point(90,vr-.01));Gt.lineEnd(),Gt.polygonEnd()},Xt},Je.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},t.geoBerghausRaw=D,t.geoBertin1953=function(){return h.geoProjection(re()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},t.geoBertin1953Raw=re,t.geoBoggs=function(){return h.geoProjection(de).scale(160.857)},t.geoBoggsRaw=de,t.geoBonne=function(){return ce(Ee).scale(123.082).center([0,26.1441]).parallel(45)},t.geoBonneRaw=Ee,t.geoBottomley=function(){var Fe=.5,Ve=h.geoProjectionMutator(Le),Je=Ve(Fe);return Je.fraction=function(rt){return arguments.length?Ve(Fe=+rt):Fe},Je.scale(158.837)},t.geoBottomleyRaw=Le,t.geoBromley=function(){return h.geoProjection(Te).scale(152.63)},t.geoBromleyRaw=Te,t.geoChamberlin=Se,t.geoChamberlinRaw=ke,t.geoChamberlinAfrica=function(){return Se([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},t.geoCollignon=function(){return h.geoProjection(De).scale(95.6464).center([0,30])},t.geoCollignonRaw=De,t.geoCraig=function(){return ce(Be).scale(249.828).clipAngle(90)},t.geoCraigRaw=Be,t.geoCraster=function(){return h.geoProjection(Qe).scale(156.19)},t.geoCrasterRaw=Qe,t.geoCylindricalEqualArea=function(){return ce(Oe).parallel(38.58).scale(195.044)},t.geoCylindricalEqualAreaRaw=Oe,t.geoCylindricalStereographic=function(){return ce(Ue).scale(124.75)},t.geoCylindricalStereographicRaw=Ue,t.geoEckert1=function(){return h.geoProjection(Xe).scale(165.664)},t.geoEckert1Raw=Xe,t.geoEckert2=function(){return h.geoProjection(Ye).scale(165.664)},t.geoEckert2Raw=Ye,t.geoEckert3=function(){return h.geoProjection($e).scale(180.739)},t.geoEckert3Raw=$e,t.geoEckert4=function(){return h.geoProjection(it).scale(180.739)},t.geoEckert4Raw=it,t.geoEckert5=function(){return h.geoProjection(ot).scale(173.044)},t.geoEckert5Raw=ot,t.geoEckert6=function(){return h.geoProjection(Et).scale(173.044)},t.geoEckert6Raw=Et,t.geoEisenlohr=function(){return h.geoProjection(tt).scale(62.5271)},t.geoEisenlohrRaw=tt,t.geoFahey=function(){return h.geoProjection(Mt).scale(137.152)},t.geoFaheyRaw=Mt,t.geoFoucaut=function(){return h.geoProjection(Jt).scale(135.264)},t.geoFoucautRaw=Jt,t.geoFoucautSinusoidal=function(){var Fe=.5,Ve=h.geoProjectionMutator($t),Je=Ve(Fe);return Je.alpha=function(rt){return arguments.length?Ve(Fe=+rt):Fe},Je.scale(168.725)},t.geoFoucautSinusoidalRaw=$t,t.geoGilbert=function(Fe){Fe==null&&(Fe=h.geoOrthographic);var Ve=Fe(),Je=h.geoEquirectangular().scale(w).precision(0).clipAngle(null).translate([0,0]);function rt(ft){return Ve(je(ft))}function dt(ft){rt[ft]=function(){return arguments.length?(Ve[ft].apply(Ve,arguments),rt):Ve[ft]()}}return Ve.invert&&(rt.invert=function(ft){return Ge(Ve.invert(ft))}),rt.stream=function(ft){var Tt=Ve.stream(ft),Wt=Je.stream({point:function(Xt,Gt){Tt.point(Xt/2,S(y(-Gt/2*C))*w)},lineStart:function(){Tt.lineStart()},lineEnd:function(){Tt.lineEnd()},polygonStart:function(){Tt.polygonStart()},polygonEnd:function(){Tt.polygonEnd()}});return Wt.sphere=Tt.sphere,Wt},rt.rotate=function(ft){return arguments.length?(Je.rotate(ft),rt):Je.rotate()},rt.center=function(ft){return arguments.length?(Ve.center(je(ft)),rt):Ge(Ve.center())},dt("angle"),dt("clipAngle"),dt("clipExtent"),dt("fitExtent"),dt("fitHeight"),dt("fitSize"),dt("fitWidth"),dt("scale"),dt("translate"),dt("precision"),rt.scale(249.5)},t.geoGingery=function(){var Fe=6,Ve=30*C,Je=o(Ve),rt=m(Ve),dt=h.geoProjectionMutator(Ct),ft=dt(Ve,Fe),Tt=ft.stream,Wt=-o(.01*C),Xt=m(.01*C);return ft.radius=function(Gt){return arguments.length?(Je=o(Ve=Gt*C),rt=m(Ve),dt(Ve,Fe)):Ve*w},ft.lobes=function(Gt){return arguments.length?dt(Ve,Fe=+Gt):Fe},ft.stream=function(Gt){var tr=ft.rotate(),lr=Tt(Gt),hr=(ft.rotate([0,0]),Tt(Gt));return ft.rotate(tr),lr.sphere=function(){hr.polygonStart(),hr.lineStart();for(var vr=0,Pr=2*T/Fe,Jr=0;vr<Fe;++vr,Jr-=Pr)hr.point(l(Xt*o(Jr),Wt)*w,S(Xt*m(Jr))*w),hr.point(l(rt*o(Jr-Pr/2),Je)*w,S(rt*m(Jr-Pr/2))*w);hr.lineEnd(),hr.polygonEnd()},lr},ft.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},t.geoGingeryRaw=Ct,t.geoGinzburg4=function(){return h.geoProjection(Pe).scale(149.995)},t.geoGinzburg4Raw=Pe,t.geoGinzburg5=function(){return h.geoProjection(ze).scale(153.93)},t.geoGinzburg5Raw=ze,t.geoGinzburg6=function(){return h.geoProjection(qe).scale(130.945)},t.geoGinzburg6Raw=qe,t.geoGinzburg8=function(){return h.geoProjection(ht).scale(131.747)},t.geoGinzburg8Raw=ht,t.geoGinzburg9=function(){return h.geoProjection(at).scale(131.087)},t.geoGinzburg9Raw=at,t.geoGringorten=function(){return h.geoProjection(nt(xt)).scale(239.75)},t.geoGringortenRaw=xt,t.geoGuyou=function(){return h.geoProjection(nt(St)).scale(151.496)},t.geoGuyouRaw=St,t.geoHammer=function(){var Fe=2,Ve=h.geoProjectionMutator(U),Je=Ve(Fe);return Je.coefficient=function(rt){return arguments.length?Ve(Fe=+rt):Fe},Je.scale(169.529)},t.geoHammerRaw=U,t.geoHammerRetroazimuthal=function(){var Fe=0,Ve=h.geoProjectionMutator(st),Je=Ve(Fe),rt=Je.rotate,dt=Je.stream,ft=h.geoCircle();return Je.parallel=function(Tt){if(!arguments.length)return Fe*w;var Wt=Je.rotate();return Ve(Fe=Tt*C).rotate(Wt)},Je.rotate=function(Tt){return arguments.length?(rt.call(Je,[Tt[0],Tt[1]-Fe*w]),ft.center([-Tt[0],-Tt[1]]),Je):((Tt=rt.call(Je))[1]+=Fe*w,Tt)},Je.stream=function(Tt){return(Tt=dt(Tt)).sphere=function(){Tt.polygonStart();var Wt,Xt=ft.radius(89.99)().coordinates[0],Gt=Xt.length-1,tr=-1;for(Tt.lineStart();++tr<Gt;)Tt.point((Wt=Xt[tr])[0],Wt[1]);for(Tt.lineEnd(),Gt=(Xt=ft.radius(90.01)().coordinates[0]).length-1,Tt.lineStart();--tr>=0;)Tt.point((Wt=Xt[tr])[0],Wt[1]);Tt.lineEnd(),Tt.polygonEnd()},Tt},Je.scale(79.4187).parallel(45).clipAngle(179.999)},t.geoHammerRetroazimuthalRaw=st,t.geoHealpix=function(){var Fe=4,Ve=h.geoProjectionMutator(zt),Je=Ve(Fe),rt=Je.stream;return Je.lobes=function(dt){return arguments.length?Ve(Fe=+dt):Fe},Je.stream=function(dt){var ft=Je.rotate(),Tt=rt(dt),Wt=(Je.rotate([0,0]),rt(dt));return Je.rotate(ft),Tt.sphere=function(){var Xt,Gt;h.geoStream((Xt=180/Fe,Gt=[].concat(p.range(-180,180+Xt/2,Xt).map(Ce),p.range(180,-180-Xt/2,-Xt).map(lt)),{type:"Polygon",coordinates:[Xt===180?Gt.map(At):Gt]}),Wt)},Tt},Je.scale(239.75)},t.geoHealpixRaw=zt,t.geoHill=function(){var Fe=1,Ve=h.geoProjectionMutator(Bt),Je=Ve(Fe);return Je.ratio=function(rt){return arguments.length?Ve(Fe=+rt):Fe},Je.scale(167.774).center([0,18.67])},t.geoHillRaw=Bt,t.geoHomolosine=function(){return h.geoProjection(or).scale(152.63)},t.geoHomolosineRaw=or,t.geoHufnagel=function(){var Fe=1,Ve=0,Je=45*C,rt=2,dt=h.geoProjectionMutator(ar),ft=dt(Fe,Ve,Je,rt);return ft.a=function(Tt){return arguments.length?dt(Fe=+Tt,Ve,Je,rt):Fe},ft.b=function(Tt){return arguments.length?dt(Fe,Ve=+Tt,Je,rt):Ve},ft.psiMax=function(Tt){return arguments.length?dt(Fe,Ve,Je=+Tt*C,rt):Je*w},ft.ratio=function(Tt){return arguments.length?dt(Fe,Ve,Je,rt=+Tt):rt},ft.scale(180.739)},t.geoHufnagelRaw=ar,t.geoHyperelliptical=function(){var Fe=0,Ve=2.5,Je=1.183136,rt=h.geoProjectionMutator(nr),dt=rt(Fe,Ve,Je);return dt.alpha=function(ft){return arguments.length?rt(Fe=+ft,Ve,Je):Fe},dt.k=function(ft){return arguments.length?rt(Fe,Ve=+ft,Je):Ve},dt.gamma=function(ft){return arguments.length?rt(Fe,Ve,Je=+ft):Je},dt.scale(152.63)},t.geoHyperellipticalRaw=nr,t.geoInterrupt=yr,t.geoInterruptedBoggs=function(){return yr(de,xr).scale(160.857)},t.geoInterruptedHomolosine=function(){return yr(or,gr).scale(152.63)},t.geoInterruptedMollweide=function(){return yr(ie,wr).scale(169.529)},t.geoInterruptedMollweideHemispheres=function(){return yr(ie,zr).scale(169.529).rotate([20,0])},t.geoInterruptedSinuMollweide=function(){return yr(Ht,Rr,K).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},t.geoInterruptedSinusoidal=function(){return yr(ve,Wr).scale(152.63).rotate([-20,0])},t.geoKavrayskiy7=function(){return h.geoProjection(gn).scale(158.837)},t.geoKavrayskiy7Raw=gn,t.geoLagrange=function(){var Fe=.5,Ve=h.geoProjectionMutator(rn),Je=Ve(Fe);return Je.spacing=function(rt){return arguments.length?Ve(Fe=+rt):Fe},Je.scale(124.75)},t.geoLagrangeRaw=rn,t.geoLarrivee=function(){return h.geoProjection(bn).scale(97.2672)},t.geoLarriveeRaw=bn,t.geoLaskowski=function(){return h.geoProjection(Dr).scale(139.98)},t.geoLaskowskiRaw=Dr,t.geoLittrow=function(){return h.geoProjection(br).scale(144.049).clipAngle(89.999)},t.geoLittrowRaw=br,t.geoLoximuthal=function(){return ce(Xr).parallel(40).scale(158.837)},t.geoLoximuthalRaw=Xr,t.geoMiller=function(){return h.geoProjection(fn).scale(108.318)},t.geoMillerRaw=fn,t.geoModifiedStereographic=gt,t.geoModifiedStereographicRaw=Qr,t.geoModifiedStereographicAlaska=function(){return gt(un,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},t.geoModifiedStereographicGs48=function(){return gt(Pn,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},t.geoModifiedStereographicGs50=function(){return gt(kn,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},t.geoModifiedStereographicMiller=function(){return gt(Hn,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},t.geoModifiedStereographicLee=function(){return gt(aa,[165,10]).scale(250).clipAngle(130).center([-165,-10])},t.geoMollweide=function(){return h.geoProjection(ie).scale(169.529)},t.geoMollweideRaw=ie,t.geoMtFlatPolarParabolic=function(){return h.geoProjection(pr).scale(164.859)},t.geoMtFlatPolarParabolicRaw=pr,t.geoMtFlatPolarQuartic=function(){return h.geoProjection(Mr).scale(188.209)},t.geoMtFlatPolarQuarticRaw=Mr,t.geoMtFlatPolarSinusoidal=function(){return h.geoProjection(Vr).scale(166.518)},t.geoMtFlatPolarSinusoidalRaw=Vr,t.geoNaturalEarth2=function(){return h.geoProjection(kr).scale(175.295)},t.geoNaturalEarth2Raw=kr,t.geoNellHammer=function(){return h.geoProjection(ur).scale(152.63)},t.geoNellHammerRaw=ur,t.geoInterruptedQuarticAuthalic=function(){return yr(U(1/0),Ir).rotate([20,0]).scale(152.63)},t.geoNicolosi=function(){return h.geoProjection(mr).scale(127.267)},t.geoNicolosiRaw=mr,t.geoPatterson=function(){return h.geoProjection(_r).scale(139.319)},t.geoPattersonRaw=_r,t.geoPolyconic=function(){return h.geoProjection(Nr).scale(103.74)},t.geoPolyconicRaw=Nr,t.geoPolyhedral=zn,t.geoPolyhedralButterfly=function(Fe){Fe=Fe||function(Je){var rt=h.geoCentroid({type:"MultiPoint",coordinates:Je});return h.geoGnomonic().scale(1).translate([0,0]).rotate([-rt[0],-rt[1]])};var Ve=Nn.map(function(Je){return{face:Je,project:Fe(Je)}});return[-1,0,0,1,0,1,4,5].forEach(function(Je,rt){var dt=Ve[Je];dt&&(dt.children||(dt.children=[])).push(Ve[rt])}),zn(Ve[0],function(Je,rt){return Ve[Je<-T/2?rt<0?6:4:Je<0?rt<0?2:0:Je<T/2?rt<0?3:1:rt<0?7:5]}).angle(-30).scale(101.858).center([0,45])},t.geoPolyhedralCollignon=function(Fe){Fe=Fe||function(Je){var rt=h.geoCentroid({type:"MultiPoint",coordinates:Je});return h.geoProjection(Wn).translate([0,0]).scale(1).rotate(rt[1]>0?[-rt[0],0]:[180-rt[0],180])};var Ve=Nn.map(function(Je){return{face:Je,project:Fe(Je)}});return[-1,0,0,1,0,1,4,5].forEach(function(Je,rt){var dt=Ve[Je];dt&&(dt.children||(dt.children=[])).push(Ve[rt])}),zn(Ve[0],function(Je,rt){return Ve[Je<-T/2?rt<0?6:4:Je<0?rt<0?2:0:Je<T/2?rt<0?3:1:rt<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},t.geoPolyhedralWaterman=function(Fe){Fe=Fe||function(ft){var Tt=ft.length===6?h.geoCentroid({type:"MultiPoint",coordinates:ft}):ft[0];return h.geoGnomonic().scale(1).translate([0,0]).rotate([-Tt[0],-Tt[1]])};var Ve=Nn.map(function(ft){for(var Tt,Wt=ft.map(ua),Xt=Wt.length,Gt=Wt[Xt-1],tr=[],lr=0;lr<Xt;++lr)Tt=Wt[lr],tr.push($n([.9486832980505138*Gt[0]+.31622776601683794*Tt[0],.9486832980505138*Gt[1]+.31622776601683794*Tt[1],.9486832980505138*Gt[2]+.31622776601683794*Tt[2]]),$n([.9486832980505138*Tt[0]+.31622776601683794*Gt[0],.9486832980505138*Tt[1]+.31622776601683794*Gt[1],.9486832980505138*Tt[2]+.31622776601683794*Gt[2]])),Gt=Tt;return tr}),Je=[],rt=[-1,0,0,1,0,1,4,5];Ve.forEach(function(ft,Tt){for(var Wt,Xt,Gt=Nn[Tt],tr=Gt.length,lr=Je[Tt]=[],hr=0;hr<tr;++hr)Ve.push([Gt[hr],ft[(2*hr+2)%(2*tr)],ft[(2*hr+1)%(2*tr)]]),rt.push(Tt),lr.push((Wt=ua(ft[(2*hr+2)%(2*tr)]),Xt=ua(ft[(2*hr+1)%(2*tr)]),[Wt[1]*Xt[2]-Wt[2]*Xt[1],Wt[2]*Xt[0]-Wt[0]*Xt[2],Wt[0]*Xt[1]-Wt[1]*Xt[0]]))});var dt=Ve.map(function(ft){return{project:Fe(ft),face:ft}});return rt.forEach(function(ft,Tt){var Wt=dt[ft];Wt&&(Wt.children||(Wt.children=[])).push(dt[Tt])}),zn(dt[0],function(ft,Tt){var Wt=o(Tt),Xt=[Wt*o(ft),Wt*m(ft),m(Tt)],Gt=ft<-T/2?Tt<0?6:4:ft<0?Tt<0?2:0:ft<T/2?Tt<0?3:1:Tt<0?7:5,tr=Je[Gt];return dt[cn(tr[0],Xt)<0?8+3*Gt:cn(tr[1],Xt)<0?8+3*Gt+1:cn(tr[2],Xt)<0?8+3*Gt+2:Gt]}).angle(-30).scale(110.625).center([0,45])},t.geoProject=function(Fe,Ve){var Je,rt=Ve.stream;if(!rt)throw new Error("invalid projection");switch(Fe&&Fe.type){case"Feature":Je=ri;break;case"FeatureCollection":Je=Ci;break;default:Je=vi}return Je(Fe,rt)},t.geoGringortenQuincuncial=function(){return Hi(xt).scale(176.423)},t.geoPeirceQuincuncial=Wi,t.geoPierceQuincuncial=Wi,t.geoQuantize=function(Fe,Ve){if(!(0<=(Ve=+Ve)&&Ve<=20))throw new Error("invalid digits");function Je(Gt){var tr=Gt.length,lr=2,hr=new Array(tr);for(hr[0]=+Gt[0].toFixed(Ve),hr[1]=+Gt[1].toFixed(Ve);lr<tr;)hr[lr]=Gt[lr],++lr;return hr}function rt(Gt){return Gt.map(Je)}function dt(Gt){for(var tr=Je(Gt[0]),lr=[tr],hr=1;hr<Gt.length;hr++){var vr=Je(Gt[hr]);(vr.length>2||vr[0]!=tr[0]||vr[1]!=tr[1])&&(lr.push(vr),tr=vr)}return lr.length===1&&Gt.length>1&&lr.push(Je(Gt[Gt.length-1])),lr}function ft(Gt){return Gt.map(dt)}function Tt(Gt){if(Gt==null)return Gt;var tr;switch(Gt.type){case"GeometryCollection":tr={type:"GeometryCollection",geometries:Gt.geometries.map(Tt)};break;case"Point":tr={type:"Point",coordinates:Je(Gt.coordinates)};break;case"MultiPoint":tr={type:Gt.type,coordinates:rt(Gt.coordinates)};break;case"LineString":tr={type:Gt.type,coordinates:dt(Gt.coordinates)};break;case"MultiLineString":case"Polygon":tr={type:Gt.type,coordinates:ft(Gt.coordinates)};break;case"MultiPolygon":tr={type:"MultiPolygon",coordinates:Gt.coordinates.map(ft)};break;default:return Gt}return Gt.bbox!=null&&(tr.bbox=Gt.bbox),tr}function Wt(Gt){var tr={type:"Feature",properties:Gt.properties,geometry:Tt(Gt.geometry)};return Gt.id!=null&&(tr.id=Gt.id),Gt.bbox!=null&&(tr.bbox=Gt.bbox),tr}if(Fe!=null)switch(Fe.type){case"Feature":return Wt(Fe);case"FeatureCollection":var Xt={type:"FeatureCollection",features:Fe.features.map(Wt)};return Fe.bbox!=null&&(Xt.bbox=Fe.bbox),Xt;default:return Tt(Fe)}return Fe},t.geoQuincuncial=Hi,t.geoRectangularPolyconic=function(){return ce(Bo).scale(131.215)},t.geoRectangularPolyconicRaw=Bo,t.geoRobinson=function(){return h.geoProjection(ko).scale(152.63)},t.geoRobinsonRaw=ko,t.geoSatellite=function(){var Fe=2,Ve=0,Je=h.geoProjectionMutator(uo),rt=Je(Fe,Ve);return rt.distance=function(dt){return arguments.length?Je(Fe=+dt,Ve):Fe},rt.tilt=function(dt){return arguments.length?Je(Fe,Ve=dt*C):Ve*w},rt.scale(432.147).clipAngle(P(1/Fe)*w-1e-6)},t.geoSatelliteRaw=uo,t.geoSinuMollweide=function(){return h.geoProjection(Ht).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},t.geoSinuMollweideRaw=Ht,t.geoSinusoidal=function(){return h.geoProjection(ve).scale(152.63)},t.geoSinusoidalRaw=ve,t.geoStitch=function(Fe){if(Fe==null)return Fe;switch(Fe.type){case"Feature":return qa(Fe);case"FeatureCollection":var Ve={type:"FeatureCollection",features:Fe.features.map(qa)};return Fe.bbox!=null&&(Ve.bbox=Fe.bbox),Ve;default:return us(Fe)}},t.geoTimes=function(){return h.geoProjection(Ko).scale(146.153)},t.geoTimesRaw=Ko,t.geoTwoPointAzimuthal=vs,t.geoTwoPointAzimuthalRaw=ws,t.geoTwoPointAzimuthalUsa=function(){return vs([-158,21.5],[-77,39]).clipAngle(60).scale(400)},t.geoTwoPointEquidistant=Mo,t.geoTwoPointEquidistantRaw=Ts,t.geoTwoPointEquidistantUsa=function(){return Mo([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},t.geoVanDerGrinten=function(){return h.geoProjection(Ao).scale(79.4183)},t.geoVanDerGrintenRaw=Ao,t.geoVanDerGrinten2=function(){return h.geoProjection(No).scale(79.4183)},t.geoVanDerGrinten2Raw=No,t.geoVanDerGrinten3=function(){return h.geoProjection(jo).scale(79.4183)},t.geoVanDerGrinten3Raw=jo,t.geoVanDerGrinten4=function(){return h.geoProjection(Uo).scale(127.16)},t.geoVanDerGrinten4Raw=Uo,t.geoWagner=ho,t.geoWagner7=function(){return ho().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},t.geoWagnerRaw=Qo,t.geoWagner4=function(){return h.geoProjection(Vo).scale(176.84)},t.geoWagner4Raw=Vo,t.geoWagner6=function(){return h.geoProjection(hs).scale(152.63)},t.geoWagner6Raw=hs,t.geoWiechel=function(){return h.geoProjection(So).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},t.geoWiechelRaw=So,t.geoWinkel3=function(){return h.geoProjection(ja).scale(158.837)},t.geoWinkel3Raw=ja,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":162,"d3-geo":169}],169:[function(i,B,V){(function(t,h){typeof V=="object"&&B!==void 0?h(V,i("d3-array")):h((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,h){function p(){return new u}function u(){this.reset()}u.prototype={constructor:u,reset:function(){this.s=this.t=0},add:function(ut){l(e,ut,this.t),l(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new u;function l(ut,Ot,ir){var Vt=ut.s=Ot+ir,sr=Vt-Ot,Cr=Vt-sr;ut.t=Ot-Cr+(ir-sr)}var o=1e-6,a=Math.PI,n=a/2,s=a/4,r=2*a,c=180/a,f=a/180,d=Math.abs,g=Math.atan,m=Math.atan2,y=Math.cos,v=Math.ceil,T=Math.exp,_=Math.log,k=Math.pow,E=Math.sin,A=Math.sign||function(ut){return ut>0?1:ut<0?-1:0},b=Math.sqrt,L=Math.tan;function w(ut){return ut>1?0:ut<-1?a:Math.acos(ut)}function C(ut){return ut>1?n:ut<-1?-n:Math.asin(ut)}function S(ut){return(ut=E(ut/2))*ut}function P(){}function z(ut,Ot){ut&&q.hasOwnProperty(ut.type)&&q[ut.type](ut,Ot)}var F={Feature:function(ut,Ot){z(ut.geometry,Ot)},FeatureCollection:function(ut,Ot){for(var ir=ut.features,Vt=-1,sr=ir.length;++Vt<sr;)z(ir[Vt].geometry,Ot)}},q={Sphere:function(ut,Ot){Ot.sphere()},Point:function(ut,Ot){ut=ut.coordinates,Ot.point(ut[0],ut[1],ut[2])},MultiPoint:function(ut,Ot){for(var ir=ut.coordinates,Vt=-1,sr=ir.length;++Vt<sr;)ut=ir[Vt],Ot.point(ut[0],ut[1],ut[2])},LineString:function(ut,Ot){W(ut.coordinates,Ot,0)},MultiLineString:function(ut,Ot){for(var ir=ut.coordinates,Vt=-1,sr=ir.length;++Vt<sr;)W(ir[Vt],Ot,0)},Polygon:function(ut,Ot){X(ut.coordinates,Ot)},MultiPolygon:function(ut,Ot){for(var ir=ut.coordinates,Vt=-1,sr=ir.length;++Vt<sr;)X(ir[Vt],Ot)},GeometryCollection:function(ut,Ot){for(var ir=ut.geometries,Vt=-1,sr=ir.length;++Vt<sr;)z(ir[Vt],Ot)}};function W(ut,Ot,ir){var Vt,sr=-1,Cr=ut.length-ir;for(Ot.lineStart();++sr<Cr;)Vt=ut[sr],Ot.point(Vt[0],Vt[1],Vt[2]);Ot.lineEnd()}function X(ut,Ot){var ir=-1,Vt=ut.length;for(Ot.polygonStart();++ir<Vt;)W(ut[ir],Ot,1);Ot.polygonEnd()}function Q(ut,Ot){ut&&F.hasOwnProperty(ut.type)?F[ut.type](ut,Ot):z(ut,Ot)}var Z,Y,N,J,D,U=p(),G=p(),$={point:P,lineStart:P,lineEnd:P,polygonStart:function(){U.reset(),$.lineStart=K,$.lineEnd=re},polygonEnd:function(){var ut=+U;G.add(ut<0?r+ut:ut),this.lineStart=this.lineEnd=this.point=P},sphere:function(){G.add(r)}};function K(){$.point=ne}function re(){ae(Z,Y)}function ne(ut,Ot){$.point=ae,Z=ut,Y=Ot,N=ut*=f,J=y(Ot=(Ot*=f)/2+s),D=E(Ot)}function ae(ut,Ot){var ir=(ut*=f)-N,Vt=ir>=0?1:-1,sr=Vt*ir,Cr=y(Ot=(Ot*=f)/2+s),Or=E(Ot),qr=D*Or,en=J*Cr+qr*y(sr),Kr=qr*Vt*E(sr);U.add(m(Kr,en)),N=ut,J=Cr,D=Or}function ie(ut){return[m(ut[1],ut[0]),C(ut[2])]}function he(ut){var Ot=ut[0],ir=ut[1],Vt=y(ir);return[Vt*y(Ot),Vt*E(Ot),E(ir)]}function se(ut,Ot){return ut[0]*Ot[0]+ut[1]*Ot[1]+ut[2]*Ot[2]}function de(ut,Ot){return[ut[1]*Ot[2]-ut[2]*Ot[1],ut[2]*Ot[0]-ut[0]*Ot[2],ut[0]*Ot[1]-ut[1]*Ot[0]]}function ce(ut,Ot){ut[0]+=Ot[0],ut[1]+=Ot[1],ut[2]+=Ot[2]}function ve(ut,Ot){return[ut[0]*Ot,ut[1]*Ot,ut[2]*Ot]}function Ee(ut){var Ot=b(ut[0]*ut[0]+ut[1]*ut[1]+ut[2]*ut[2]);ut[0]/=Ot,ut[1]/=Ot,ut[2]/=Ot}var Le,Te,xe,fe,ge,ke,Me,Se,De,Be,We,Qe,Oe,Ue,Xe,Ye,$e,it,ot,Et,mt,tt,Ke,Mt,Jt,$t,je=p(),Ge={point:Ct,lineStart:be,lineEnd:Ae,polygonStart:function(){Ge.point=Pe,Ge.lineStart=ze,Ge.lineEnd=qe,je.reset(),$.polygonStart()},polygonEnd:function(){$.polygonEnd(),Ge.point=Ct,Ge.lineStart=be,Ge.lineEnd=Ae,U<0?(Le=-(xe=180),Te=-(fe=90)):je>o?fe=90:je<-o&&(Te=-90),Be[0]=Le,Be[1]=xe},sphere:function(){Le=-(xe=180),Te=-(fe=90)}};function Ct(ut,Ot){De.push(Be=[Le=ut,xe=ut]),Ot<Te&&(Te=Ot),Ot>fe&&(fe=Ot)}function Ie(ut,Ot){var ir=he([ut*f,Ot*f]);if(Se){var Vt=de(Se,ir),sr=de([Vt[1],-Vt[0],0],Vt);Ee(sr),sr=ie(sr);var Cr,Or=ut-ge,qr=Or>0?1:-1,en=sr[0]*c*qr,Kr=d(Or)>180;Kr^(qr*ge<en&&en<qr*ut)?(Cr=sr[1]*c)>fe&&(fe=Cr):Kr^(qr*ge<(en=(en+360)%360-180)&&en<qr*ut)?(Cr=-sr[1]*c)<Te&&(Te=Cr):(Ot<Te&&(Te=Ot),Ot>fe&&(fe=Ot)),Kr?ut<ge?ht(Le,ut)>ht(Le,xe)&&(xe=ut):ht(ut,xe)>ht(Le,xe)&&(Le=ut):xe>=Le?(ut<Le&&(Le=ut),ut>xe&&(xe=ut)):ut>ge?ht(Le,ut)>ht(Le,xe)&&(xe=ut):ht(ut,xe)>ht(Le,xe)&&(Le=ut)}else De.push(Be=[Le=ut,xe=ut]);Ot<Te&&(Te=Ot),Ot>fe&&(fe=Ot),Se=ir,ge=ut}function be(){Ge.point=Ie}function Ae(){Be[0]=Le,Be[1]=xe,Ge.point=Ct,Se=null}function Pe(ut,Ot){if(Se){var ir=ut-ge;je.add(d(ir)>180?ir+(ir>0?360:-360):ir)}else ke=ut,Me=Ot;$.point(ut,Ot),Ie(ut,Ot)}function ze(){$.lineStart()}function qe(){Pe(ke,Me),$.lineEnd(),d(je)>o&&(Le=-(xe=180)),Be[0]=Le,Be[1]=xe,Se=null}function ht(ut,Ot){return(Ot-=ut)<0?Ot+360:Ot}function at(ut,Ot){return ut[0]-Ot[0]}function nt(ut,Ot){return ut[0]<=ut[1]?ut[0]<=Ot&&Ot<=ut[1]:Ot<ut[0]||ut[1]<Ot}var xt={sphere:P,point:Lt,lineStart:St,lineEnd:jt,polygonStart:function(){xt.lineStart=Ut,xt.lineEnd=zt},polygonEnd:function(){xt.lineStart=St,xt.lineEnd=jt}};function Lt(ut,Ot){ut*=f;var ir=y(Ot*=f);bt(ir*y(ut),ir*E(ut),E(Ot))}function bt(ut,Ot,ir){++We,Oe+=(ut-Oe)/We,Ue+=(Ot-Ue)/We,Xe+=(ir-Xe)/We}function St(){xt.point=st}function st(ut,Ot){ut*=f;var ir=y(Ot*=f);Mt=ir*y(ut),Jt=ir*E(ut),$t=E(Ot),xt.point=It,bt(Mt,Jt,$t)}function It(ut,Ot){ut*=f;var ir=y(Ot*=f),Vt=ir*y(ut),sr=ir*E(ut),Cr=E(Ot),Or=m(b((Or=Jt*Cr-$t*sr)*Or+(Or=$t*Vt-Mt*Cr)*Or+(Or=Mt*sr-Jt*Vt)*Or),Mt*Vt+Jt*sr+$t*Cr);Qe+=Or,Ye+=Or*(Mt+(Mt=Vt)),$e+=Or*(Jt+(Jt=sr)),it+=Or*($t+($t=Cr)),bt(Mt,Jt,$t)}function jt(){xt.point=Lt}function Ut(){xt.point=Ce}function zt(){lt(tt,Ke),xt.point=Lt}function Ce(ut,Ot){tt=ut,Ke=Ot,ut*=f,Ot*=f,xt.point=lt;var ir=y(Ot);Mt=ir*y(ut),Jt=ir*E(ut),$t=E(Ot),bt(Mt,Jt,$t)}function lt(ut,Ot){ut*=f;var ir=y(Ot*=f),Vt=ir*y(ut),sr=ir*E(ut),Cr=E(Ot),Or=Jt*Cr-$t*sr,qr=$t*Vt-Mt*Cr,en=Mt*sr-Jt*Vt,Kr=b(Or*Or+qr*qr+en*en),sn=C(Kr),pn=Kr&&-sn/Kr;ot+=pn*Or,Et+=pn*qr,mt+=pn*en,Qe+=sn,Ye+=sn*(Mt+(Mt=Vt)),$e+=sn*(Jt+(Jt=sr)),it+=sn*($t+($t=Cr)),bt(Mt,Jt,$t)}function At(ut){return function(){return ut}}function Bt(ut,Ot){function ir(Vt,sr){return Vt=ut(Vt,sr),Ot(Vt[0],Vt[1])}return ut.invert&&Ot.invert&&(ir.invert=function(Vt,sr){return(Vt=Ot.invert(Vt,sr))&&ut.invert(Vt[0],Vt[1])}),ir}function Ht(ut,Ot){return[d(ut)>a?ut+Math.round(-ut/r)*r:ut,Ot]}function or(ut,Ot,ir){return(ut%=r)?Ot||ir?Bt(Nt(ut),nr(Ot,ir)):Nt(ut):Ot||ir?nr(Ot,ir):Ht}function ar(ut){return function(Ot,ir){return[(Ot+=ut)>a?Ot-r:Ot<-a?Ot+r:Ot,ir]}}function Nt(ut){var Ot=ar(ut);return Ot.invert=ar(-ut),Ot}function nr(ut,Ot){var ir=y(ut),Vt=E(ut),sr=y(Ot),Cr=E(Ot);function Or(qr,en){var Kr=y(en),sn=y(qr)*Kr,pn=E(qr)*Kr,tn=E(en),dn=tn*ir+sn*Vt;return[m(pn*sr-dn*Cr,sn*ir-tn*Vt),C(dn*sr+pn*Cr)]}return Or.invert=function(qr,en){var Kr=y(en),sn=y(qr)*Kr,pn=E(qr)*Kr,tn=E(en),dn=tn*sr-pn*Cr;return[m(pn*sr+tn*Cr,sn*ir+dn*Vt),C(dn*ir-sn*Vt)]},Or}function Lr(ut){function Ot(ir){return(ir=ut(ir[0]*f,ir[1]*f))[0]*=c,ir[1]*=c,ir}return ut=or(ut[0]*f,ut[1]*f,ut.length>2?ut[2]*f:0),Ot.invert=function(ir){return(ir=ut.invert(ir[0]*f,ir[1]*f))[0]*=c,ir[1]*=c,ir},Ot}function dr(ut,Ot,ir,Vt,sr,Cr){if(ir){var Or=y(Ot),qr=E(Ot),en=Vt*ir;sr==null?(sr=Ot+Vt*r,Cr=Ot-en/2):(sr=Kt(Or,sr),Cr=Kt(Or,Cr),(Vt>0?sr<Cr:sr>Cr)&&(sr+=Vt*r));for(var Kr,sn=sr;Vt>0?sn>Cr:sn<Cr;sn-=en)Kr=ie([Or,-qr*y(sn),-qr*E(sn)]),ut.point(Kr[0],Kr[1])}}function Kt(ut,Ot){(Ot=he(Ot))[0]-=ut,Ee(Ot);var ir=w(-Ot[1]);return((-Ot[2]<0?-ir:ir)+r-o)%r}function yr(){var ut,Ot=[];return{point:function(ir,Vt,sr){ut.push([ir,Vt,sr])},lineStart:function(){Ot.push(ut=[])},lineEnd:P,rejoin:function(){Ot.length>1&&Ot.push(Ot.pop().concat(Ot.shift()))},result:function(){var ir=Ot;return Ot=[],ut=null,ir}}}function xr(ut,Ot){return d(ut[0]-Ot[0])<o&&d(ut[1]-Ot[1])<o}function gr(ut,Ot,ir,Vt){this.x=ut,this.z=Ot,this.o=ir,this.e=Vt,this.v=!1,this.n=this.p=null}function wr(ut,Ot,ir,Vt,sr){var Cr,Or,qr=[],en=[];if(ut.forEach(function(Sn){if(!((Dn=Sn.length-1)<=0)){var Dn,Qn,Hr=Sn[0],Xn=Sn[Dn];if(xr(Hr,Xn)){if(!Hr[2]&&!Xn[2]){for(sr.lineStart(),Cr=0;Cr<Dn;++Cr)sr.point((Hr=Sn[Cr])[0],Hr[1]);return void sr.lineEnd()}Xn[0]+=2*o}qr.push(Qn=new gr(Hr,Sn,null,!0)),en.push(Qn.o=new gr(Hr,null,Qn,!1)),qr.push(Qn=new gr(Xn,Sn,null,!1)),en.push(Qn.o=new gr(Xn,null,Qn,!0))}}),qr.length){for(en.sort(Ot),zr(qr),zr(en),Cr=0,Or=en.length;Cr<Or;++Cr)en[Cr].e=ir=!ir;for(var Kr,sn,pn=qr[0];;){for(var tn=pn,dn=!0;tn.v;)if((tn=tn.n)===pn)return;Kr=tn.z,sr.lineStart();do{if(tn.v=tn.o.v=!0,tn.e){if(dn)for(Cr=0,Or=Kr.length;Cr<Or;++Cr)sr.point((sn=Kr[Cr])[0],sn[1]);else Vt(tn.x,tn.n.x,1,sr);tn=tn.n}else{if(dn)for(Kr=tn.p.z,Cr=Kr.length-1;Cr>=0;--Cr)sr.point((sn=Kr[Cr])[0],sn[1]);else Vt(tn.x,tn.p.x,-1,sr);tn=tn.p}Kr=(tn=tn.o).z,dn=!dn}while(!tn.v);sr.lineEnd()}}}function zr(ut){if(Ot=ut.length){for(var Ot,ir,Vt=0,sr=ut[0];++Vt<Ot;)sr.n=ir=ut[Vt],ir.p=sr,sr=ir;sr.n=ir=ut[0],ir.p=sr}}Ht.invert=Ht;var Rr=p();function Wr(ut){return d(ut[0])<=a?ut[0]:A(ut[0])*((d(ut[0])+a)%r-a)}function gn(ut,Ot){var ir=Wr(Ot),Vt=Ot[1],sr=E(Vt),Cr=[E(ir),-y(ir),0],Or=0,qr=0;Rr.reset(),sr===1?Vt=n+o:sr===-1&&(Vt=-n-o);for(var en=0,Kr=ut.length;en<Kr;++en)if(pn=(sn=ut[en]).length)for(var sn,pn,tn=sn[pn-1],dn=Wr(tn),Sn=tn[1]/2+s,Dn=E(Sn),Qn=y(Sn),Hr=0;Hr<pn;++Hr,dn=Tn,Dn=Yn,Qn=_a,tn=Xn){var Xn=sn[Hr],Tn=Wr(Xn),Cn=Xn[1]/2+s,Yn=E(Cn),_a=y(Cn),Sa=Tn-dn,yn=Sa>=0?1:-1,Pa=yn*Sa,Ma=Pa>a,fa=Dn*Yn;if(Rr.add(m(fa*yn*E(Pa),Qn*_a+fa*y(Pa))),Or+=Ma?Sa+yn*r:Sa,Ma^dn>=ir^Tn>=ir){var Ia=de(he(tn),he(Xn));Ee(Ia);var Ta=de(Cr,Ia);Ee(Ta);var Ja=(Ma^Sa>=0?-1:1)*C(Ta[2]);(Vt>Ja||Vt===Ja&&(Ia[0]||Ia[1]))&&(qr+=Ma^Sa>=0?1:-1)}}return(Or<-o||Or<o&&Rr<-o)^1&qr}function rn(ut,Ot,ir,Vt){return function(sr){var Cr,Or,qr,en=Ot(sr),Kr=yr(),sn=Ot(Kr),pn=!1,tn={point:dn,lineStart:Dn,lineEnd:Qn,polygonStart:function(){tn.point=Hr,tn.lineStart=Xn,tn.lineEnd=Tn,Or=[],Cr=[]},polygonEnd:function(){tn.point=dn,tn.lineStart=Dn,tn.lineEnd=Qn,Or=h.merge(Or);var Cn=gn(Cr,Vt);Or.length?(pn||(sr.polygonStart(),pn=!0),wr(Or,bn,Cn,ir,sr)):Cn&&(pn||(sr.polygonStart(),pn=!0),sr.lineStart(),ir(null,null,1,sr),sr.lineEnd()),pn&&(sr.polygonEnd(),pn=!1),Or=Cr=null},sphere:function(){sr.polygonStart(),sr.lineStart(),ir(null,null,1,sr),sr.lineEnd(),sr.polygonEnd()}};function dn(Cn,Yn){ut(Cn,Yn)&&sr.point(Cn,Yn)}function Sn(Cn,Yn){en.point(Cn,Yn)}function Dn(){tn.point=Sn,en.lineStart()}function Qn(){tn.point=dn,en.lineEnd()}function Hr(Cn,Yn){qr.push([Cn,Yn]),sn.point(Cn,Yn)}function Xn(){sn.lineStart(),qr=[]}function Tn(){Hr(qr[0][0],qr[0][1]),sn.lineEnd();var Cn,Yn,_a,Sa,yn=sn.clean(),Pa=Kr.result(),Ma=Pa.length;if(qr.pop(),Cr.push(qr),qr=null,Ma)if(1&yn){if((Yn=(_a=Pa[0]).length-1)>0){for(pn||(sr.polygonStart(),pn=!0),sr.lineStart(),Cn=0;Cn<Yn;++Cn)sr.point((Sa=_a[Cn])[0],Sa[1]);sr.lineEnd()}}else Ma>1&&2&yn&&Pa.push(Pa.pop().concat(Pa.shift())),Or.push(Pa.filter(Zr))}return tn}}function Zr(ut){return ut.length>1}function bn(ut,Ot){return((ut=ut.x)[0]<0?ut[1]-n-o:n-ut[1])-((Ot=Ot.x)[0]<0?Ot[1]-n-o:n-Ot[1])}var Dr=rn(function(){return!0},function(ut){var Ot,ir=NaN,Vt=NaN,sr=NaN;return{lineStart:function(){ut.lineStart(),Ot=1},point:function(Cr,Or){var qr=Cr>0?a:-a,en=d(Cr-ir);d(en-a)<o?(ut.point(ir,Vt=(Vt+Or)/2>0?n:-n),ut.point(sr,Vt),ut.lineEnd(),ut.lineStart(),ut.point(qr,Vt),ut.point(Cr,Vt),Ot=0):sr!==qr&&en>=a&&(d(ir-sr)<o&&(ir-=sr*o),d(Cr-qr)<o&&(Cr-=qr*o),Vt=function(Kr,sn,pn,tn){var dn,Sn,Dn=E(Kr-pn);return d(Dn)>o?g((E(sn)*(Sn=y(tn))*E(pn)-E(tn)*(dn=y(sn))*E(Kr))/(dn*Sn*Dn)):(sn+tn)/2}(ir,Vt,Cr,Or),ut.point(sr,Vt),ut.lineEnd(),ut.lineStart(),ut.point(qr,Vt),Ot=0),ut.point(ir=Cr,Vt=Or),sr=qr},lineEnd:function(){ut.lineEnd(),ir=Vt=NaN},clean:function(){return 2-Ot}}},function(ut,Ot,ir,Vt){var sr;if(ut==null)sr=ir*n,Vt.point(-a,sr),Vt.point(0,sr),Vt.point(a,sr),Vt.point(a,0),Vt.point(a,-sr),Vt.point(0,-sr),Vt.point(-a,-sr),Vt.point(-a,0),Vt.point(-a,sr);else if(d(ut[0]-Ot[0])>o){var Cr=ut[0]<Ot[0]?a:-a;sr=ir*Cr/2,Vt.point(-Cr,sr),Vt.point(0,sr),Vt.point(Cr,sr)}else Vt.point(Ot[0],Ot[1])},[-a,-n]);function br(ut){var Ot=y(ut),ir=6*f,Vt=Ot>0,sr=d(Ot)>o;function Cr(en,Kr){return y(en)*y(Kr)>Ot}function Or(en,Kr,sn){var pn=[1,0,0],tn=de(he(en),he(Kr)),dn=se(tn,tn),Sn=tn[0],Dn=dn-Sn*Sn;if(!Dn)return!sn&&en;var Qn=Ot*dn/Dn,Hr=-Ot*Sn/Dn,Xn=de(pn,tn),Tn=ve(pn,Qn);ce(Tn,ve(tn,Hr));var Cn=Xn,Yn=se(Tn,Cn),_a=se(Cn,Cn),Sa=Yn*Yn-_a*(se(Tn,Tn)-1);if(!(Sa<0)){var yn=b(Sa),Pa=ve(Cn,(-Yn-yn)/_a);if(ce(Pa,Tn),Pa=ie(Pa),!sn)return Pa;var Ma,fa=en[0],Ia=Kr[0],Ta=en[1],Ja=Kr[1];Ia<fa&&(Ma=fa,fa=Ia,Ia=Ma);var Zn=Ia-fa,Ha=d(Zn-a)<o;if(!Ha&&Ja<Ta&&(Ma=Ta,Ta=Ja,Ja=Ma),Ha||Zn<o?Ha?Ta+Ja>0^Pa[1]<(d(Pa[0]-fa)<o?Ta:Ja):Ta<=Pa[1]&&Pa[1]<=Ja:Zn>a^(fa<=Pa[0]&&Pa[0]<=Ia)){var Fi=ve(Cn,(-Yn+yn)/_a);return ce(Fi,Tn),[Pa,ie(Fi)]}}}function qr(en,Kr){var sn=Vt?ut:a-ut,pn=0;return en<-sn?pn|=1:en>sn&&(pn|=2),Kr<-sn?pn|=4:Kr>sn&&(pn|=8),pn}return rn(Cr,function(en){var Kr,sn,pn,tn,dn;return{lineStart:function(){tn=pn=!1,dn=1},point:function(Sn,Dn){var Qn,Hr=[Sn,Dn],Xn=Cr(Sn,Dn),Tn=Vt?Xn?0:qr(Sn,Dn):Xn?qr(Sn+(Sn<0?a:-a),Dn):0;if(!Kr&&(tn=pn=Xn)&&en.lineStart(),Xn!==pn&&(!(Qn=Or(Kr,Hr))||xr(Kr,Qn)||xr(Hr,Qn))&&(Hr[2]=1),Xn!==pn)dn=0,Xn?(en.lineStart(),Qn=Or(Hr,Kr),en.point(Qn[0],Qn[1])):(Qn=Or(Kr,Hr),en.point(Qn[0],Qn[1],2),en.lineEnd()),Kr=Qn;else if(sr&&Kr&&Vt^Xn){var Cn;Tn&sn||!(Cn=Or(Hr,Kr,!0))||(dn=0,Vt?(en.lineStart(),en.point(Cn[0][0],Cn[0][1]),en.point(Cn[1][0],Cn[1][1]),en.lineEnd()):(en.point(Cn[1][0],Cn[1][1]),en.lineEnd(),en.lineStart(),en.point(Cn[0][0],Cn[0][1],3)))}!Xn||Kr&&xr(Kr,Hr)||en.point(Hr[0],Hr[1]),Kr=Hr,pn=Xn,sn=Tn},lineEnd:function(){pn&&en.lineEnd(),Kr=null},clean:function(){return dn|(tn&&pn)<<1}}},function(en,Kr,sn,pn){dr(pn,ut,ir,sn,en,Kr)},Vt?[0,-ut]:[-a,ut-a])}function Xr(ut,Ot,ir,Vt){function sr(Kr,sn){return ut<=Kr&&Kr<=ir&&Ot<=sn&&sn<=Vt}function Cr(Kr,sn,pn,tn){var dn=0,Sn=0;if(Kr==null||(dn=Or(Kr,pn))!==(Sn=Or(sn,pn))||en(Kr,sn)<0^pn>0)do tn.point(dn===0||dn===3?ut:ir,dn>1?Vt:Ot);while((dn=(dn+pn+4)%4)!==Sn);else tn.point(sn[0],sn[1])}function Or(Kr,sn){return d(Kr[0]-ut)<o?sn>0?0:3:d(Kr[0]-ir)<o?sn>0?2:1:d(Kr[1]-Ot)<o?sn>0?1:0:sn>0?3:2}function qr(Kr,sn){return en(Kr.x,sn.x)}function en(Kr,sn){var pn=Or(Kr,1),tn=Or(sn,1);return pn!==tn?pn-tn:pn===0?sn[1]-Kr[1]:pn===1?Kr[0]-sn[0]:pn===2?Kr[1]-sn[1]:sn[0]-Kr[0]}return function(Kr){var sn,pn,tn,dn,Sn,Dn,Qn,Hr,Xn,Tn,Cn,Yn=Kr,_a=yr(),Sa={point:yn,lineStart:function(){Sa.point=Pa,pn&&pn.push(tn=[]),Tn=!0,Xn=!1,Qn=Hr=NaN},lineEnd:function(){sn&&(Pa(dn,Sn),Dn&&Xn&&_a.rejoin(),sn.push(_a.result())),Sa.point=yn,Xn&&Yn.lineEnd()},polygonStart:function(){Yn=_a,sn=[],pn=[],Cn=!0},polygonEnd:function(){var Ma=function(){for(var Ta=0,Ja=0,Zn=pn.length;Ja<Zn;++Ja)for(var Ha,Fi,Wo=pn[Ja],Io=1,po=Wo.length,ga=Wo[0],fi=ga[0],go=ga[1];Io<po;++Io)Ha=fi,Fi=go,ga=Wo[Io],fi=ga[0],go=ga[1],Fi<=Vt?go>Vt&&(fi-Ha)*(Vt-Fi)>(go-Fi)*(ut-Ha)&&++Ta:go<=Vt&&(fi-Ha)*(Vt-Fi)<(go-Fi)*(ut-Ha)&&--Ta;return Ta}(),fa=Cn&&Ma,Ia=(sn=h.merge(sn)).length;(fa||Ia)&&(Kr.polygonStart(),fa&&(Kr.lineStart(),Cr(null,null,1,Kr),Kr.lineEnd()),Ia&&wr(sn,qr,Ma,Cr,Kr),Kr.polygonEnd()),Yn=Kr,sn=pn=tn=null}};function yn(Ma,fa){sr(Ma,fa)&&Yn.point(Ma,fa)}function Pa(Ma,fa){var Ia=sr(Ma,fa);if(pn&&tn.push([Ma,fa]),Tn)dn=Ma,Sn=fa,Dn=Ia,Tn=!1,Ia&&(Yn.lineStart(),Yn.point(Ma,fa));else if(Ia&&Xn)Yn.point(Ma,fa);else{var Ta=[Qn=Math.max(-1e9,Math.min(1e9,Qn)),Hr=Math.max(-1e9,Math.min(1e9,Hr))],Ja=[Ma=Math.max(-1e9,Math.min(1e9,Ma)),fa=Math.max(-1e9,Math.min(1e9,fa))];(function(Zn,Ha,Fi,Wo,Io,po){var ga,fi=Zn[0],go=Zn[1],Ga=0,bi=1,Ui=Ha[0]-fi,Qa=Ha[1]-go;if(ga=Fi-fi,Ui||!(ga>0)){if(ga/=Ui,Ui<0){if(ga<Ga)return;ga<bi&&(bi=ga)}else if(Ui>0){if(ga>bi)return;ga>Ga&&(Ga=ga)}if(ga=Io-fi,Ui||!(ga<0)){if(ga/=Ui,Ui<0){if(ga>bi)return;ga>Ga&&(Ga=ga)}else if(Ui>0){if(ga<Ga)return;ga<bi&&(bi=ga)}if(ga=Wo-go,Qa||!(ga>0)){if(ga/=Qa,Qa<0){if(ga<Ga)return;ga<bi&&(bi=ga)}else if(Qa>0){if(ga>bi)return;ga>Ga&&(Ga=ga)}if(ga=po-go,Qa||!(ga<0)){if(ga/=Qa,Qa<0){if(ga>bi)return;ga>Ga&&(Ga=ga)}else if(Qa>0){if(ga<Ga)return;ga<bi&&(bi=ga)}return Ga>0&&(Zn[0]=fi+Ga*Ui,Zn[1]=go+Ga*Qa),bi<1&&(Ha[0]=fi+bi*Ui,Ha[1]=go+bi*Qa),!0}}}}})(Ta,Ja,ut,Ot,ir,Vt)?(Xn||(Yn.lineStart(),Yn.point(Ta[0],Ta[1])),Yn.point(Ja[0],Ja[1]),Ia||Yn.lineEnd(),Cn=!1):Ia&&(Yn.lineStart(),Yn.point(Ma,fa),Cn=!1)}Qn=Ma,Hr=fa,Xn=Ia}return Sa}}var fn,Qr,un,Pn=p(),kn={sphere:P,point:P,lineStart:function(){kn.point=aa,kn.lineEnd=Hn},lineEnd:P,polygonStart:P,polygonEnd:P};function Hn(){kn.point=kn.lineEnd=P}function aa(ut,Ot){fn=ut*=f,Qr=E(Ot*=f),un=y(Ot),kn.point=gt}function gt(ut,Ot){ut*=f;var ir=E(Ot*=f),Vt=y(Ot),sr=d(ut-fn),Cr=y(sr),Or=Vt*E(sr),qr=un*ir-Qr*Vt*Cr,en=Qr*ir+un*Vt*Cr;Pn.add(m(b(Or*Or+qr*qr),en)),fn=ut,Qr=ir,un=Vt}function Qt(ut){return Pn.reset(),Q(ut,kn),+Pn}var Zt=[null,null],pr={type:"LineString",coordinates:Zt};function Mr(ut,Ot){return Zt[0]=ut,Zt[1]=Ot,Qt(pr)}var Vr={Feature:function(ut,Ot){return ur(ut.geometry,Ot)},FeatureCollection:function(ut,Ot){for(var ir=ut.features,Vt=-1,sr=ir.length;++Vt<sr;)if(ur(ir[Vt].geometry,Ot))return!0;return!1}},kr={Sphere:function(){return!0},Point:function(ut,Ot){return Ir(ut.coordinates,Ot)},MultiPoint:function(ut,Ot){for(var ir=ut.coordinates,Vt=-1,sr=ir.length;++Vt<sr;)if(Ir(ir[Vt],Ot))return!0;return!1},LineString:function(ut,Ot){return mr(ut.coordinates,Ot)},MultiLineString:function(ut,Ot){for(var ir=ut.coordinates,Vt=-1,sr=ir.length;++Vt<sr;)if(mr(ir[Vt],Ot))return!0;return!1},Polygon:function(ut,Ot){return _r(ut.coordinates,Ot)},MultiPolygon:function(ut,Ot){for(var ir=ut.coordinates,Vt=-1,sr=ir.length;++Vt<sr;)if(_r(ir[Vt],Ot))return!0;return!1},GeometryCollection:function(ut,Ot){for(var ir=ut.geometries,Vt=-1,sr=ir.length;++Vt<sr;)if(ur(ir[Vt],Ot))return!0;return!1}};function ur(ut,Ot){return!(!ut||!kr.hasOwnProperty(ut.type))&&kr[ut.type](ut,Ot)}function Ir(ut,Ot){return Mr(ut,Ot)===0}function mr(ut,Ot){for(var ir,Vt,sr,Cr=0,Or=ut.length;Cr<Or;Cr++){if((Vt=Mr(ut[Cr],Ot))===0||Cr>0&&(sr=Mr(ut[Cr],ut[Cr-1]))>0&&ir<=sr&&Vt<=sr&&(ir+Vt-sr)*(1-Math.pow((ir-Vt)/sr,2))<1e-12*sr)return!0;ir=Vt}return!1}function _r(ut,Ot){return!!gn(ut.map(Nr),vn(Ot))}function Nr(ut){return(ut=ut.map(vn)).pop(),ut}function vn(ut){return[ut[0]*f,ut[1]*f]}function xn(ut,Ot,ir){var Vt=h.range(ut,Ot-o,ir).concat(Ot);return function(sr){return Vt.map(function(Cr){return[sr,Cr]})}}function wn(ut,Ot,ir){var Vt=h.range(ut,Ot-o,ir).concat(Ot);return function(sr){return Vt.map(function(Cr){return[Cr,sr]})}}function ln(){var ut,Ot,ir,Vt,sr,Cr,Or,qr,en,Kr,sn,pn,tn=10,dn=tn,Sn=90,Dn=360,Qn=2.5;function Hr(){return{type:"MultiLineString",coordinates:Xn()}}function Xn(){return h.range(v(Vt/Sn)*Sn,ir,Sn).map(sn).concat(h.range(v(qr/Dn)*Dn,Or,Dn).map(pn)).concat(h.range(v(Ot/tn)*tn,ut,tn).filter(function(Tn){return d(Tn%Sn)>o}).map(en)).concat(h.range(v(Cr/dn)*dn,sr,dn).filter(function(Tn){return d(Tn%Dn)>o}).map(Kr))}return Hr.lines=function(){return Xn().map(function(Tn){return{type:"LineString",coordinates:Tn}})},Hr.outline=function(){return{type:"Polygon",coordinates:[sn(Vt).concat(pn(Or).slice(1),sn(ir).reverse().slice(1),pn(qr).reverse().slice(1))]}},Hr.extent=function(Tn){return arguments.length?Hr.extentMajor(Tn).extentMinor(Tn):Hr.extentMinor()},Hr.extentMajor=function(Tn){return arguments.length?(Vt=+Tn[0][0],ir=+Tn[1][0],qr=+Tn[0][1],Or=+Tn[1][1],Vt>ir&&(Tn=Vt,Vt=ir,ir=Tn),qr>Or&&(Tn=qr,qr=Or,Or=Tn),Hr.precision(Qn)):[[Vt,qr],[ir,Or]]},Hr.extentMinor=function(Tn){return arguments.length?(Ot=+Tn[0][0],ut=+Tn[1][0],Cr=+Tn[0][1],sr=+Tn[1][1],Ot>ut&&(Tn=Ot,Ot=ut,ut=Tn),Cr>sr&&(Tn=Cr,Cr=sr,sr=Tn),Hr.precision(Qn)):[[Ot,Cr],[ut,sr]]},Hr.step=function(Tn){return arguments.length?Hr.stepMajor(Tn).stepMinor(Tn):Hr.stepMinor()},Hr.stepMajor=function(Tn){return arguments.length?(Sn=+Tn[0],Dn=+Tn[1],Hr):[Sn,Dn]},Hr.stepMinor=function(Tn){return arguments.length?(tn=+Tn[0],dn=+Tn[1],Hr):[tn,dn]},Hr.precision=function(Tn){return arguments.length?(Qn=+Tn,en=xn(Cr,sr,90),Kr=wn(Ot,ut,Qn),sn=xn(qr,Or,90),pn=wn(Vt,ir,Qn),Hr):Qn},Hr.extentMajor([[-180,-90+o],[180,90-o]]).extentMinor([[-180,-80-o],[180,80+o]])}function zn(ut){return ut}var ca,Kn,On,Nn,ba=p(),Wn=p(),cn={point:P,lineStart:P,lineEnd:P,polygonStart:function(){cn.lineStart=$n,cn.lineEnd=Ci},polygonEnd:function(){cn.lineStart=cn.lineEnd=cn.point=P,ba.add(d(Wn)),Wn.reset()},result:function(){var ut=ba/2;return ba.reset(),ut}};function $n(){cn.point=ua}function ua(ut,Ot){cn.point=Xa,ca=On=ut,Kn=Nn=Ot}function Xa(ut,Ot){Wn.add(Nn*ut-On*Ot),On=ut,Nn=Ot}function Ci(){Xa(ca,Kn)}var ri=1/0,vi=ri,Aa=-ri,Na=Aa,co={point:function(ut,Ot){ut<ri&&(ri=ut),ut>Aa&&(Aa=ut),Ot<vi&&(vi=Ot),Ot>Na&&(Na=Ot)},lineStart:P,lineEnd:P,polygonStart:P,polygonEnd:P,result:function(){var ut=[[ri,vi],[Aa,Na]];return Aa=Na=-(vi=ri=1/0),ut}},Fo,Yo,Hi,Wi,Bo=0,Va=0,ko=0,uo=0,yi=0,Xi=0,fo=0,_o=0,Di=0,ui={point:Gi,lineStart:ms,lineEnd:us,polygonStart:function(){ui.lineStart=Ko,ui.lineEnd=_s},polygonEnd:function(){ui.point=Gi,ui.lineStart=ms,ui.lineEnd=us},result:function(){var ut=Di?[fo/Di,_o/Di]:Xi?[uo/Xi,yi/Xi]:ko?[Bo/ko,Va/ko]:[NaN,NaN];return Bo=Va=ko=uo=yi=Xi=fo=_o=Di=0,ut}};function Gi(ut,Ot){Bo+=ut,Va+=Ot,++ko}function ms(){ui.point=bs}function bs(ut,Ot){ui.point=qa,Gi(Hi=ut,Wi=Ot)}function qa(ut,Ot){var ir=ut-Hi,Vt=Ot-Wi,sr=b(ir*ir+Vt*Vt);uo+=sr*(Hi+ut)/2,yi+=sr*(Wi+Ot)/2,Xi+=sr,Gi(Hi=ut,Wi=Ot)}function us(){ui.point=Gi}function Ko(){ui.point=ws}function _s(){vs(Fo,Yo)}function ws(ut,Ot){ui.point=vs,Gi(Fo=Hi=ut,Yo=Wi=Ot)}function vs(ut,Ot){var ir=ut-Hi,Vt=Ot-Wi,sr=b(ir*ir+Vt*Vt);uo+=sr*(Hi+ut)/2,yi+=sr*(Wi+Ot)/2,Xi+=sr,fo+=(sr=Wi*ut-Hi*Ot)*(Hi+ut),_o+=sr*(Wi+Ot),Di+=3*sr,Gi(Hi=ut,Wi=Ot)}function Ts(ut){this._context=ut}Ts.prototype={_radius:4.5,pointRadius:function(ut){return this._radius=ut,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(ut,Ot){switch(this._point){case 0:this._context.moveTo(ut,Ot),this._point=1;break;case 1:this._context.lineTo(ut,Ot);break;default:this._context.moveTo(ut+this._radius,Ot),this._context.arc(ut,Ot,this._radius,0,r)}},result:P};var Mo,Ao,No,jo,Uo,Qo=p(),ho={point:P,lineStart:function(){ho.point=fs},lineEnd:function(){Mo&&oo(Ao,No),ho.point=P},polygonStart:function(){Mo=!0},polygonEnd:function(){Mo=null},result:function(){var ut=+Qo;return Qo.reset(),ut}};function fs(ut,Ot){ho.point=oo,Ao=jo=ut,No=Uo=Ot}function oo(ut,Ot){jo-=ut,Uo-=Ot,Qo.add(b(jo*jo+Uo*Uo)),jo=ut,Uo=Ot}function Vo(){this._string=[]}function hs(ut){return"m0,"+ut+"a"+ut+","+ut+" 0 1,1 0,"+-2*ut+"a"+ut+","+ut+" 0 1,1 0,"+2*ut+"z"}function So(ut){return function(Ot){var ir=new ja;for(var Vt in ut)ir[Vt]=ut[Vt];return ir.stream=Ot,ir}}function ja(){}function Fe(ut,Ot,ir){var Vt=ut.clipExtent&&ut.clipExtent();return ut.scale(150).translate([0,0]),Vt!=null&&ut.clipExtent(null),Q(ir,ut.stream(co)),Ot(co.result()),Vt!=null&&ut.clipExtent(Vt),ut}function Ve(ut,Ot,ir){return Fe(ut,function(Vt){var sr=Ot[1][0]-Ot[0][0],Cr=Ot[1][1]-Ot[0][1],Or=Math.min(sr/(Vt[1][0]-Vt[0][0]),Cr/(Vt[1][1]-Vt[0][1])),qr=+Ot[0][0]+(sr-Or*(Vt[1][0]+Vt[0][0]))/2,en=+Ot[0][1]+(Cr-Or*(Vt[1][1]+Vt[0][1]))/2;ut.scale(150*Or).translate([qr,en])},ir)}function Je(ut,Ot,ir){return Ve(ut,[[0,0],Ot],ir)}function rt(ut,Ot,ir){return Fe(ut,function(Vt){var sr=+Ot,Cr=sr/(Vt[1][0]-Vt[0][0]),Or=(sr-Cr*(Vt[1][0]+Vt[0][0]))/2,qr=-Cr*Vt[0][1];ut.scale(150*Cr).translate([Or,qr])},ir)}function dt(ut,Ot,ir){return Fe(ut,function(Vt){var sr=+Ot,Cr=sr/(Vt[1][1]-Vt[0][1]),Or=-Cr*Vt[0][0],qr=(sr-Cr*(Vt[1][1]+Vt[0][1]))/2;ut.scale(150*Cr).translate([Or,qr])},ir)}Vo.prototype={_radius:4.5,_circle:hs(4.5),pointRadius:function(ut){return(ut=+ut)!==this._radius&&(this._radius=ut,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(ut,Ot){switch(this._point){case 0:this._string.push("M",ut,",",Ot),this._point=1;break;case 1:this._string.push("L",ut,",",Ot);break;default:this._circle==null&&(this._circle=hs(this._radius)),this._string.push("M",ut,",",Ot,this._circle)}},result:function(){if(this._string.length){var ut=this._string.join("");return this._string=[],ut}return null}},ja.prototype={constructor:ja,point:function(ut,Ot){this.stream.point(ut,Ot)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ft=y(30*f);function Tt(ut,Ot){return+Ot?function(ir,Vt){function sr(Cr,Or,qr,en,Kr,sn,pn,tn,dn,Sn,Dn,Qn,Hr,Xn){var Tn=pn-Cr,Cn=tn-Or,Yn=Tn*Tn+Cn*Cn;if(Yn>4*Vt&&Hr--){var _a=en+Sn,Sa=Kr+Dn,yn=sn+Qn,Pa=b(_a*_a+Sa*Sa+yn*yn),Ma=C(yn/=Pa),fa=d(d(yn)-1)<o||d(qr-dn)<o?(qr+dn)/2:m(Sa,_a),Ia=ir(fa,Ma),Ta=Ia[0],Ja=Ia[1],Zn=Ta-Cr,Ha=Ja-Or,Fi=Cn*Zn-Tn*Ha;(Fi*Fi/Yn>Vt||d((Tn*Zn+Cn*Ha)/Yn-.5)>.3||en*Sn+Kr*Dn+sn*Qn<ft)&&(sr(Cr,Or,qr,en,Kr,sn,Ta,Ja,fa,_a/=Pa,Sa/=Pa,yn,Hr,Xn),Xn.point(Ta,Ja),sr(Ta,Ja,fa,_a,Sa,yn,pn,tn,dn,Sn,Dn,Qn,Hr,Xn))}}return function(Cr){var Or,qr,en,Kr,sn,pn,tn,dn,Sn,Dn,Qn,Hr,Xn={point:Tn,lineStart:Cn,lineEnd:_a,polygonStart:function(){Cr.polygonStart(),Xn.lineStart=Sa},polygonEnd:function(){Cr.polygonEnd(),Xn.lineStart=Cn}};function Tn(Ma,fa){Ma=ir(Ma,fa),Cr.point(Ma[0],Ma[1])}function Cn(){dn=NaN,Xn.point=Yn,Cr.lineStart()}function Yn(Ma,fa){var Ia=he([Ma,fa]),Ta=ir(Ma,fa);sr(dn,Sn,tn,Dn,Qn,Hr,dn=Ta[0],Sn=Ta[1],tn=Ma,Dn=Ia[0],Qn=Ia[1],Hr=Ia[2],16,Cr),Cr.point(dn,Sn)}function _a(){Xn.point=Tn,Cr.lineEnd()}function Sa(){Cn(),Xn.point=yn,Xn.lineEnd=Pa}function yn(Ma,fa){Yn(Or=Ma,fa),qr=dn,en=Sn,Kr=Dn,sn=Qn,pn=Hr,Xn.point=Yn}function Pa(){sr(dn,Sn,tn,Dn,Qn,Hr,qr,en,Or,Kr,sn,pn,16,Cr),Xn.lineEnd=_a,_a()}return Xn}}(ut,Ot):function(ir){return So({point:function(Vt,sr){Vt=ir(Vt,sr),this.stream.point(Vt[0],Vt[1])}})}(ut)}var Wt=So({point:function(ut,Ot){this.stream.point(ut*f,Ot*f)}});function Xt(ut,Ot,ir,Vt,sr){function Cr(Or,qr){return[Ot+ut*(Or*=Vt),ir-ut*(qr*=sr)]}return Cr.invert=function(Or,qr){return[(Or-Ot)/ut*Vt,(ir-qr)/ut*sr]},Cr}function Gt(ut,Ot,ir,Vt,sr,Cr){var Or=y(Cr),qr=E(Cr),en=Or*ut,Kr=qr*ut,sn=Or/ut,pn=qr/ut,tn=(qr*ir-Or*Ot)/ut,dn=(qr*Ot+Or*ir)/ut;function Sn(Dn,Qn){return[en*(Dn*=Vt)-Kr*(Qn*=sr)+Ot,ir-Kr*Dn-en*Qn]}return Sn.invert=function(Dn,Qn){return[Vt*(sn*Dn-pn*Qn+tn),sr*(dn-pn*Dn-sn*Qn)]},Sn}function tr(ut){return lr(function(){return ut})()}function lr(ut){var Ot,ir,Vt,sr,Cr,Or,qr,en,Kr,sn,pn=150,tn=480,dn=250,Sn=0,Dn=0,Qn=0,Hr=0,Xn=0,Tn=0,Cn=1,Yn=1,_a=null,Sa=Dr,yn=null,Pa=zn,Ma=.5;function fa(Zn){return en(Zn[0]*f,Zn[1]*f)}function Ia(Zn){return(Zn=en.invert(Zn[0],Zn[1]))&&[Zn[0]*c,Zn[1]*c]}function Ta(){var Zn=Gt(pn,0,0,Cn,Yn,Tn).apply(null,Ot(Sn,Dn)),Ha=(Tn?Gt:Xt)(pn,tn-Zn[0],dn-Zn[1],Cn,Yn,Tn);return ir=or(Qn,Hr,Xn),qr=Bt(Ot,Ha),en=Bt(ir,qr),Or=Tt(qr,Ma),Ja()}function Ja(){return Kr=sn=null,fa}return fa.stream=function(Zn){return Kr&&sn===Zn?Kr:Kr=Wt(function(Ha){return So({point:function(Fi,Wo){var Io=Ha(Fi,Wo);return this.stream.point(Io[0],Io[1])}})}(ir)(Sa(Or(Pa(sn=Zn)))))},fa.preclip=function(Zn){return arguments.length?(Sa=Zn,_a=void 0,Ja()):Sa},fa.postclip=function(Zn){return arguments.length?(Pa=Zn,yn=Vt=sr=Cr=null,Ja()):Pa},fa.clipAngle=function(Zn){return arguments.length?(Sa=+Zn?br(_a=Zn*f):(_a=null,Dr),Ja()):_a*c},fa.clipExtent=function(Zn){return arguments.length?(Pa=Zn==null?(yn=Vt=sr=Cr=null,zn):Xr(yn=+Zn[0][0],Vt=+Zn[0][1],sr=+Zn[1][0],Cr=+Zn[1][1]),Ja()):yn==null?null:[[yn,Vt],[sr,Cr]]},fa.scale=function(Zn){return arguments.length?(pn=+Zn,Ta()):pn},fa.translate=function(Zn){return arguments.length?(tn=+Zn[0],dn=+Zn[1],Ta()):[tn,dn]},fa.center=function(Zn){return arguments.length?(Sn=Zn[0]%360*f,Dn=Zn[1]%360*f,Ta()):[Sn*c,Dn*c]},fa.rotate=function(Zn){return arguments.length?(Qn=Zn[0]%360*f,Hr=Zn[1]%360*f,Xn=Zn.length>2?Zn[2]%360*f:0,Ta()):[Qn*c,Hr*c,Xn*c]},fa.angle=function(Zn){return arguments.length?(Tn=Zn%360*f,Ta()):Tn*c},fa.reflectX=function(Zn){return arguments.length?(Cn=Zn?-1:1,Ta()):Cn<0},fa.reflectY=function(Zn){return arguments.length?(Yn=Zn?-1:1,Ta()):Yn<0},fa.precision=function(Zn){return arguments.length?(Or=Tt(qr,Ma=Zn*Zn),Ja()):b(Ma)},fa.fitExtent=function(Zn,Ha){return Ve(fa,Zn,Ha)},fa.fitSize=function(Zn,Ha){return Je(fa,Zn,Ha)},fa.fitWidth=function(Zn,Ha){return rt(fa,Zn,Ha)},fa.fitHeight=function(Zn,Ha){return dt(fa,Zn,Ha)},function(){return Ot=ut.apply(this,arguments),fa.invert=Ot.invert&&Ia,Ta()}}function hr(ut){var Ot=0,ir=a/3,Vt=lr(ut),sr=Vt(Ot,ir);return sr.parallels=function(Cr){return arguments.length?Vt(Ot=Cr[0]*f,ir=Cr[1]*f):[Ot*c,ir*c]},sr}function vr(ut,Ot){var ir=E(ut),Vt=(ir+E(Ot))/2;if(d(Vt)<o)return function(qr){var en=y(qr);function Kr(sn,pn){return[sn*en,E(pn)/en]}return Kr.invert=function(sn,pn){return[sn/en,C(pn*en)]},Kr}(ut);var sr=1+ir*(2*Vt-ir),Cr=b(sr)/Vt;function Or(qr,en){var Kr=b(sr-2*Vt*E(en))/Vt;return[Kr*E(qr*=Vt),Cr-Kr*y(qr)]}return Or.invert=function(qr,en){var Kr=Cr-en,sn=m(qr,d(Kr))*A(Kr);return Kr*Vt<0&&(sn-=a*A(qr)*A(Kr)),[sn/Vt,C((sr-(qr*qr+Kr*Kr)*Vt*Vt)/(2*Vt))]},Or}function Pr(){return hr(vr).scale(155.424).center([0,33.6442])}function Jr(){return Pr().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function on(ut){return function(Ot,ir){var Vt=y(Ot),sr=y(ir),Cr=ut(Vt*sr);return[Cr*sr*E(Ot),Cr*E(ir)]}}function _n(ut){return function(Ot,ir){var Vt=b(Ot*Ot+ir*ir),sr=ut(Vt),Cr=E(sr),Or=y(sr);return[m(Ot*Cr,Vt*Or),C(Vt&&ir*Cr/Vt)]}}var Mn=on(function(ut){return b(2/(1+ut))});Mn.invert=_n(function(ut){return 2*C(ut/2)});var Rn=on(function(ut){return(ut=w(ut))&&ut/E(ut)});function An(ut,Ot){return[ut,_(L((n+Ot)/2))]}function ha(ut){var Ot,ir,Vt,sr=tr(ut),Cr=sr.center,Or=sr.scale,qr=sr.translate,en=sr.clipExtent,Kr=null;function sn(){var pn=a*Or(),tn=sr(Lr(sr.rotate()).invert([0,0]));return en(Kr==null?[[tn[0]-pn,tn[1]-pn],[tn[0]+pn,tn[1]+pn]]:ut===An?[[Math.max(tn[0]-pn,Kr),Ot],[Math.min(tn[0]+pn,ir),Vt]]:[[Kr,Math.max(tn[1]-pn,Ot)],[ir,Math.min(tn[1]+pn,Vt)]])}return sr.scale=function(pn){return arguments.length?(Or(pn),sn()):Or()},sr.translate=function(pn){return arguments.length?(qr(pn),sn()):qr()},sr.center=function(pn){return arguments.length?(Cr(pn),sn()):Cr()},sr.clipExtent=function(pn){return arguments.length?(pn==null?Kr=Ot=ir=Vt=null:(Kr=+pn[0][0],Ot=+pn[0][1],ir=+pn[1][0],Vt=+pn[1][1]),sn()):Kr==null?null:[[Kr,Ot],[ir,Vt]]},sn()}function wa(ut){return L((n+ut)/2)}function Da(ut,Ot){var ir=y(ut),Vt=ut===Ot?E(ut):_(ir/y(Ot))/_(wa(Ot)/wa(ut)),sr=ir*k(wa(ut),Vt)/Vt;if(!Vt)return An;function Cr(Or,qr){sr>0?qr<-n+o&&(qr=-n+o):qr>n-o&&(qr=n-o);var en=sr/k(wa(qr),Vt);return[en*E(Vt*Or),sr-en*y(Vt*Or)]}return Cr.invert=function(Or,qr){var en=sr-qr,Kr=A(Vt)*b(Or*Or+en*en),sn=m(Or,d(en))*A(en);return en*Vt<0&&(sn-=a*A(Or)*A(en)),[sn/Vt,2*g(k(sr/Kr,1/Vt))-n]},Cr}function za(ut,Ot){return[ut,Ot]}function Ra(ut,Ot){var ir=y(ut),Vt=ut===Ot?E(ut):(ir-y(Ot))/(Ot-ut),sr=ir/Vt+ut;if(d(Vt)<o)return za;function Cr(Or,qr){var en=sr-qr,Kr=Vt*Or;return[en*E(Kr),sr-en*y(Kr)]}return Cr.invert=function(Or,qr){var en=sr-qr,Kr=m(Or,d(en))*A(en);return en*Vt<0&&(Kr-=a*A(Or)*A(en)),[Kr/Vt,sr-A(Vt)*b(Or*Or+en*en)]},Cr}Rn.invert=_n(function(ut){return ut}),An.invert=function(ut,Ot){return[ut,2*g(T(Ot))-n]},za.invert=za;var xi=1.340264,gi=-.081106,ni=893e-6,ai=.003796,mi=b(3)/2;function Ri(ut,Ot){var ir=C(mi*E(Ot)),Vt=ir*ir,sr=Vt*Vt*Vt;return[ut*y(ir)/(mi*(xi+3*gi*Vt+sr*(7*ni+9*ai*Vt))),ir*(xi+gi*Vt+sr*(ni+ai*Vt))]}function Zi(ut,Ot){var ir=y(Ot),Vt=y(ut)*ir;return[ir*E(ut)/Vt,E(Ot)/Vt]}function Ji(ut,Ot){var ir=Ot*Ot,Vt=ir*ir;return[ut*(.8707-.131979*ir+Vt*(Vt*(.003971*ir-.001529*Vt)-.013791)),Ot*(1.007226+ir*(.015085+Vt*(.028874*ir-.044475-.005916*Vt)))]}function Ki(ut,Ot){return[y(Ot)*E(ut),E(Ot)]}function Qi(ut,Ot){var ir=y(Ot),Vt=1+y(ut)*ir;return[ir*E(ut)/Vt,E(Ot)/Vt]}function Ca(ut,Ot){return[_(L((n+Ot)/2)),-ut]}Ri.invert=function(ut,Ot){for(var ir,Vt=Ot,sr=Vt*Vt,Cr=sr*sr*sr,Or=0;Or<12&&(Cr=(sr=(Vt-=ir=(Vt*(xi+gi*sr+Cr*(ni+ai*sr))-Ot)/(xi+3*gi*sr+Cr*(7*ni+9*ai*sr)))*Vt)*sr*sr,!(d(ir)<1e-12));++Or);return[mi*ut*(xi+3*gi*sr+Cr*(7*ni+9*ai*sr))/y(Vt),C(E(Vt)/mi)]},Zi.invert=_n(g),Ji.invert=function(ut,Ot){var ir,Vt=Ot,sr=25;do{var Cr=Vt*Vt,Or=Cr*Cr;Vt-=ir=(Vt*(1.007226+Cr*(.015085+Or*(.028874*Cr-.044475-.005916*Or)))-Ot)/(1.007226+Cr*(.045255+Or*(.259866*Cr-.311325-.005916*11*Or)))}while(d(ir)>o&&--sr>0);return[ut/(.8707+(Cr=Vt*Vt)*(Cr*(Cr*Cr*Cr*(.003971-.001529*Cr)-.013791)-.131979)),Vt]},Ki.invert=_n(C),Qi.invert=_n(function(ut){return 2*g(ut)}),Ca.invert=function(ut,Ot){return[-Ot,2*g(T(ut))-n]},t.geoAlbers=Jr,t.geoAlbersUsa=function(){var ut,Ot,ir,Vt,sr,Cr,Or=Jr(),qr=Pr().rotate([154,0]).center([-2,58.5]).parallels([55,65]),en=Pr().rotate([157,0]).center([-3,19.9]).parallels([8,18]),Kr={point:function(tn,dn){Cr=[tn,dn]}};function sn(tn){var dn=tn[0],Sn=tn[1];return Cr=null,ir.point(dn,Sn),Cr||(Vt.point(dn,Sn),Cr)||(sr.point(dn,Sn),Cr)}function pn(){return ut=Ot=null,sn}return sn.invert=function(tn){var dn=Or.scale(),Sn=Or.translate(),Dn=(tn[0]-Sn[0])/dn,Qn=(tn[1]-Sn[1])/dn;return(Qn>=.12&&Qn<.234&&Dn>=-.425&&Dn<-.214?qr:Qn>=.166&&Qn<.234&&Dn>=-.214&&Dn<-.115?en:Or).invert(tn)},sn.stream=function(tn){return ut&&Ot===tn?ut:(dn=[Or.stream(Ot=tn),qr.stream(tn),en.stream(tn)],Sn=dn.length,ut={point:function(Dn,Qn){for(var Hr=-1;++Hr<Sn;)dn[Hr].point(Dn,Qn)},sphere:function(){for(var Dn=-1;++Dn<Sn;)dn[Dn].sphere()},lineStart:function(){for(var Dn=-1;++Dn<Sn;)dn[Dn].lineStart()},lineEnd:function(){for(var Dn=-1;++Dn<Sn;)dn[Dn].lineEnd()},polygonStart:function(){for(var Dn=-1;++Dn<Sn;)dn[Dn].polygonStart()},polygonEnd:function(){for(var Dn=-1;++Dn<Sn;)dn[Dn].polygonEnd()}});var dn,Sn},sn.precision=function(tn){return arguments.length?(Or.precision(tn),qr.precision(tn),en.precision(tn),pn()):Or.precision()},sn.scale=function(tn){return arguments.length?(Or.scale(tn),qr.scale(.35*tn),en.scale(tn),sn.translate(Or.translate())):Or.scale()},sn.translate=function(tn){if(!arguments.length)return Or.translate();var dn=Or.scale(),Sn=+tn[0],Dn=+tn[1];return ir=Or.translate(tn).clipExtent([[Sn-.455*dn,Dn-.238*dn],[Sn+.455*dn,Dn+.238*dn]]).stream(Kr),Vt=qr.translate([Sn-.307*dn,Dn+.201*dn]).clipExtent([[Sn-.425*dn+o,Dn+.12*dn+o],[Sn-.214*dn-o,Dn+.234*dn-o]]).stream(Kr),sr=en.translate([Sn-.205*dn,Dn+.212*dn]).clipExtent([[Sn-.214*dn+o,Dn+.166*dn+o],[Sn-.115*dn-o,Dn+.234*dn-o]]).stream(Kr),pn()},sn.fitExtent=function(tn,dn){return Ve(sn,tn,dn)},sn.fitSize=function(tn,dn){return Je(sn,tn,dn)},sn.fitWidth=function(tn,dn){return rt(sn,tn,dn)},sn.fitHeight=function(tn,dn){return dt(sn,tn,dn)},sn.scale(1070)},t.geoArea=function(ut){return G.reset(),Q(ut,$),2*G},t.geoAzimuthalEqualArea=function(){return tr(Mn).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=Mn,t.geoAzimuthalEquidistant=function(){return tr(Rn).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=Rn,t.geoBounds=function(ut){var Ot,ir,Vt,sr,Cr,Or,qr;if(fe=xe=-(Le=Te=1/0),De=[],Q(ut,Ge),ir=De.length){for(De.sort(at),Ot=1,Cr=[Vt=De[0]];Ot<ir;++Ot)nt(Vt,(sr=De[Ot])[0])||nt(Vt,sr[1])?(ht(Vt[0],sr[1])>ht(Vt[0],Vt[1])&&(Vt[1]=sr[1]),ht(sr[0],Vt[1])>ht(Vt[0],Vt[1])&&(Vt[0]=sr[0])):Cr.push(Vt=sr);for(Or=-1/0,Ot=0,Vt=Cr[ir=Cr.length-1];Ot<=ir;Vt=sr,++Ot)sr=Cr[Ot],(qr=ht(Vt[1],sr[0]))>Or&&(Or=qr,Le=sr[0],xe=Vt[1])}return De=Be=null,Le===1/0||Te===1/0?[[NaN,NaN],[NaN,NaN]]:[[Le,Te],[xe,fe]]},t.geoCentroid=function(ut){We=Qe=Oe=Ue=Xe=Ye=$e=it=ot=Et=mt=0,Q(ut,xt);var Ot=ot,ir=Et,Vt=mt,sr=Ot*Ot+ir*ir+Vt*Vt;return sr<1e-12&&(Ot=Ye,ir=$e,Vt=it,Qe<o&&(Ot=Oe,ir=Ue,Vt=Xe),(sr=Ot*Ot+ir*ir+Vt*Vt)<1e-12)?[NaN,NaN]:[m(ir,Ot)*c,C(Vt/b(sr))*c]},t.geoCircle=function(){var ut,Ot,ir=At([0,0]),Vt=At(90),sr=At(6),Cr={point:function(qr,en){ut.push(qr=Ot(qr,en)),qr[0]*=c,qr[1]*=c}};function Or(){var qr=ir.apply(this,arguments),en=Vt.apply(this,arguments)*f,Kr=sr.apply(this,arguments)*f;return ut=[],Ot=or(-qr[0]*f,-qr[1]*f,0).invert,dr(Cr,en,Kr,1),qr={type:"Polygon",coordinates:[ut]},ut=Ot=null,qr}return Or.center=function(qr){return arguments.length?(ir=typeof qr=="function"?qr:At([+qr[0],+qr[1]]),Or):ir},Or.radius=function(qr){return arguments.length?(Vt=typeof qr=="function"?qr:At(+qr),Or):Vt},Or.precision=function(qr){return arguments.length?(sr=typeof qr=="function"?qr:At(+qr),Or):sr},Or},t.geoClipAntimeridian=Dr,t.geoClipCircle=br,t.geoClipExtent=function(){var ut,Ot,ir,Vt=0,sr=0,Cr=960,Or=500;return ir={stream:function(qr){return ut&&Ot===qr?ut:ut=Xr(Vt,sr,Cr,Or)(Ot=qr)},extent:function(qr){return arguments.length?(Vt=+qr[0][0],sr=+qr[0][1],Cr=+qr[1][0],Or=+qr[1][1],ut=Ot=null,ir):[[Vt,sr],[Cr,Or]]}}},t.geoClipRectangle=Xr,t.geoConicConformal=function(){return hr(Da).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=Da,t.geoConicEqualArea=Pr,t.geoConicEqualAreaRaw=vr,t.geoConicEquidistant=function(){return hr(Ra).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=Ra,t.geoContains=function(ut,Ot){return(ut&&Vr.hasOwnProperty(ut.type)?Vr[ut.type]:ur)(ut,Ot)},t.geoDistance=Mr,t.geoEqualEarth=function(){return tr(Ri).scale(177.158)},t.geoEqualEarthRaw=Ri,t.geoEquirectangular=function(){return tr(za).scale(152.63)},t.geoEquirectangularRaw=za,t.geoGnomonic=function(){return tr(Zi).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=Zi,t.geoGraticule=ln,t.geoGraticule10=function(){return ln()()},t.geoIdentity=function(){var ut,Ot,ir,Vt,sr,Cr,Or,qr=1,en=0,Kr=0,sn=1,pn=1,tn=0,dn=null,Sn=1,Dn=1,Qn=So({point:function(Cn,Yn){var _a=Tn([Cn,Yn]);this.stream.point(_a[0],_a[1])}}),Hr=zn;function Xn(){return Sn=qr*sn,Dn=qr*pn,Cr=Or=null,Tn}function Tn(Cn){var Yn=Cn[0]*Sn,_a=Cn[1]*Dn;if(tn){var Sa=_a*ut-Yn*Ot;Yn=Yn*ut+_a*Ot,_a=Sa}return[Yn+en,_a+Kr]}return Tn.invert=function(Cn){var Yn=Cn[0]-en,_a=Cn[1]-Kr;if(tn){var Sa=_a*ut+Yn*Ot;Yn=Yn*ut-_a*Ot,_a=Sa}return[Yn/Sn,_a/Dn]},Tn.stream=function(Cn){return Cr&&Or===Cn?Cr:Cr=Qn(Hr(Or=Cn))},Tn.postclip=function(Cn){return arguments.length?(Hr=Cn,dn=ir=Vt=sr=null,Xn()):Hr},Tn.clipExtent=function(Cn){return arguments.length?(Hr=Cn==null?(dn=ir=Vt=sr=null,zn):Xr(dn=+Cn[0][0],ir=+Cn[0][1],Vt=+Cn[1][0],sr=+Cn[1][1]),Xn()):dn==null?null:[[dn,ir],[Vt,sr]]},Tn.scale=function(Cn){return arguments.length?(qr=+Cn,Xn()):qr},Tn.translate=function(Cn){return arguments.length?(en=+Cn[0],Kr=+Cn[1],Xn()):[en,Kr]},Tn.angle=function(Cn){return arguments.length?(Ot=E(tn=Cn%360*f),ut=y(tn),Xn()):tn*c},Tn.reflectX=function(Cn){return arguments.length?(sn=Cn?-1:1,Xn()):sn<0},Tn.reflectY=function(Cn){return arguments.length?(pn=Cn?-1:1,Xn()):pn<0},Tn.fitExtent=function(Cn,Yn){return Ve(Tn,Cn,Yn)},Tn.fitSize=function(Cn,Yn){return Je(Tn,Cn,Yn)},Tn.fitWidth=function(Cn,Yn){return rt(Tn,Cn,Yn)},Tn.fitHeight=function(Cn,Yn){return dt(Tn,Cn,Yn)},Tn},t.geoInterpolate=function(ut,Ot){var ir=ut[0]*f,Vt=ut[1]*f,sr=Ot[0]*f,Cr=Ot[1]*f,Or=y(Vt),qr=E(Vt),en=y(Cr),Kr=E(Cr),sn=Or*y(ir),pn=Or*E(ir),tn=en*y(sr),dn=en*E(sr),Sn=2*C(b(S(Cr-Vt)+Or*en*S(sr-ir))),Dn=E(Sn),Qn=Sn?function(Hr){var Xn=E(Hr*=Sn)/Dn,Tn=E(Sn-Hr)/Dn,Cn=Tn*sn+Xn*tn,Yn=Tn*pn+Xn*dn,_a=Tn*qr+Xn*Kr;return[m(Yn,Cn)*c,m(_a,b(Cn*Cn+Yn*Yn))*c]}:function(){return[ir*c,Vt*c]};return Qn.distance=Sn,Qn},t.geoLength=Qt,t.geoMercator=function(){return ha(An).scale(961/r)},t.geoMercatorRaw=An,t.geoNaturalEarth1=function(){return tr(Ji).scale(175.295)},t.geoNaturalEarth1Raw=Ji,t.geoOrthographic=function(){return tr(Ki).scale(249.5).clipAngle(90+o)},t.geoOrthographicRaw=Ki,t.geoPath=function(ut,Ot){var ir,Vt,sr=4.5;function Cr(Or){return Or&&(typeof sr=="function"&&Vt.pointRadius(+sr.apply(this,arguments)),Q(Or,ir(Vt))),Vt.result()}return Cr.area=function(Or){return Q(Or,ir(cn)),cn.result()},Cr.measure=function(Or){return Q(Or,ir(ho)),ho.result()},Cr.bounds=function(Or){return Q(Or,ir(co)),co.result()},Cr.centroid=function(Or){return Q(Or,ir(ui)),ui.result()},Cr.projection=function(Or){return arguments.length?(ir=Or==null?(ut=null,zn):(ut=Or).stream,Cr):ut},Cr.context=function(Or){return arguments.length?(Vt=Or==null?(Ot=null,new Vo):new Ts(Ot=Or),typeof sr!="function"&&Vt.pointRadius(sr),Cr):Ot},Cr.pointRadius=function(Or){return arguments.length?(sr=typeof Or=="function"?Or:(Vt.pointRadius(+Or),+Or),Cr):sr},Cr.projection(ut).context(Ot)},t.geoProjection=tr,t.geoProjectionMutator=lr,t.geoRotation=Lr,t.geoStereographic=function(){return tr(Qi).scale(250).clipAngle(142)},t.geoStereographicRaw=Qi,t.geoStream=Q,t.geoTransform=function(ut){return{stream:So(ut)}},t.geoTransverseMercator=function(){var ut=ha(Ca),Ot=ut.center,ir=ut.rotate;return ut.center=function(Vt){return arguments.length?Ot([-Vt[1],Vt[0]]):[(Vt=Ot())[1],-Vt[0]]},ut.rotate=function(Vt){return arguments.length?ir([Vt[0],Vt[1],Vt.length>2?Vt[2]+90:90]):[(Vt=ir())[0],Vt[1],Vt[2]-90]},ir([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=Ca,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":162}],170:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:(t=t||self).d3=t.d3||{})})(this,function(t){function h(se,de){return se.parent===de.parent?1:2}function p(se,de){return se+de.x}function u(se,de){return Math.max(se,de.y)}function e(se){var de=0,ce=se.children,ve=ce&&ce.length;if(ve)for(;--ve>=0;)de+=ce[ve].value;else de=1;se.value=de}function l(se,de){var ce,ve,Ee,Le,Te,xe=new s(se),fe=+se.value&&(xe.value=se.value),ge=[xe];for(de==null&&(de=o);ce=ge.pop();)if(fe&&(ce.value=+ce.data.value),(Ee=de(ce.data))&&(Te=Ee.length))for(ce.children=new Array(Te),Le=Te-1;Le>=0;--Le)ge.push(ve=ce.children[Le]=new s(Ee[Le])),ve.parent=ce,ve.depth=ce.depth+1;return xe.eachBefore(n)}function o(se){return se.children}function a(se){se.data=se.data.data}function n(se){var de=0;do se.height=de;while((se=se.parent)&&se.height<++de)}function s(se){this.data=se,this.depth=this.height=0,this.parent=null}s.prototype=l.prototype={constructor:s,count:function(){return this.eachAfter(e)},each:function(se){var de,ce,ve,Ee,Le=this,Te=[Le];do for(de=Te.reverse(),Te=[];Le=de.pop();)if(se(Le),ce=Le.children)for(ve=0,Ee=ce.length;ve<Ee;++ve)Te.push(ce[ve]);while(Te.length);return this},eachAfter:function(se){for(var de,ce,ve,Ee=this,Le=[Ee],Te=[];Ee=Le.pop();)if(Te.push(Ee),de=Ee.children)for(ce=0,ve=de.length;ce<ve;++ce)Le.push(de[ce]);for(;Ee=Te.pop();)se(Ee);return this},eachBefore:function(se){for(var de,ce,ve=this,Ee=[ve];ve=Ee.pop();)if(se(ve),de=ve.children)for(ce=de.length-1;ce>=0;--ce)Ee.push(de[ce]);return this},sum:function(se){return this.eachAfter(function(de){for(var ce=+se(de.data)||0,ve=de.children,Ee=ve&&ve.length;--Ee>=0;)ce+=ve[Ee].value;de.value=ce})},sort:function(se){return this.eachBefore(function(de){de.children&&de.children.sort(se)})},path:function(se){for(var de=this,ce=function(Le,Te){if(Le===Te)return Le;var xe=Le.ancestors(),fe=Te.ancestors(),ge=null;for(Le=xe.pop(),Te=fe.pop();Le===Te;)ge=Le,Le=xe.pop(),Te=fe.pop();return ge}(de,se),ve=[de];de!==ce;)de=de.parent,ve.push(de);for(var Ee=ve.length;se!==ce;)ve.splice(Ee,0,se),se=se.parent;return ve},ancestors:function(){for(var se=this,de=[se];se=se.parent;)de.push(se);return de},descendants:function(){var se=[];return this.each(function(de){se.push(de)}),se},leaves:function(){var se=[];return this.eachBefore(function(de){de.children||se.push(de)}),se},links:function(){var se=this,de=[];return se.each(function(ce){ce!==se&&de.push({source:ce.parent,target:ce})}),de},copy:function(){return l(this).eachBefore(a)}};var r=Array.prototype.slice;function c(se){for(var de,ce,ve=0,Ee=(se=function(Te){for(var xe,fe,ge=Te.length;ge;)fe=Math.random()*ge--|0,xe=Te[ge],Te[ge]=Te[fe],Te[fe]=xe;return Te}(r.call(se))).length,Le=[];ve<Ee;)de=se[ve],ce&&g(ce,de)?++ve:(ce=y(Le=f(Le,de)),ve=0);return ce}function f(se,de){var ce,ve;if(m(de,se))return[de];for(ce=0;ce<se.length;++ce)if(d(de,se[ce])&&m(v(se[ce],de),se))return[se[ce],de];for(ce=0;ce<se.length-1;++ce)for(ve=ce+1;ve<se.length;++ve)if(d(v(se[ce],se[ve]),de)&&d(v(se[ce],de),se[ve])&&d(v(se[ve],de),se[ce])&&m(T(se[ce],se[ve],de),se))return[se[ce],se[ve],de];throw new Error}function d(se,de){var ce=se.r-de.r,ve=de.x-se.x,Ee=de.y-se.y;return ce<0||ce*ce<ve*ve+Ee*Ee}function g(se,de){var ce=se.r-de.r+1e-6,ve=de.x-se.x,Ee=de.y-se.y;return ce>0&&ce*ce>ve*ve+Ee*Ee}function m(se,de){for(var ce=0;ce<de.length;++ce)if(!g(se,de[ce]))return!1;return!0}function y(se){switch(se.length){case 1:return{x:(de=se[0]).x,y:de.y,r:de.r};case 2:return v(se[0],se[1]);case 3:return T(se[0],se[1],se[2])}var de}function v(se,de){var ce=se.x,ve=se.y,Ee=se.r,Le=de.x,Te=de.y,xe=de.r,fe=Le-ce,ge=Te-ve,ke=xe-Ee,Me=Math.sqrt(fe*fe+ge*ge);return{x:(ce+Le+fe/Me*ke)/2,y:(ve+Te+ge/Me*ke)/2,r:(Me+Ee+xe)/2}}function T(se,de,ce){var ve=se.x,Ee=se.y,Le=se.r,Te=de.x,xe=de.y,fe=de.r,ge=ce.x,ke=ce.y,Me=ce.r,Se=ve-Te,De=ve-ge,Be=Ee-xe,We=Ee-ke,Qe=fe-Le,Oe=Me-Le,Ue=ve*ve+Ee*Ee-Le*Le,Xe=Ue-Te*Te-xe*xe+fe*fe,Ye=Ue-ge*ge-ke*ke+Me*Me,$e=De*Be-Se*We,it=(Be*Ye-We*Xe)/(2*$e)-ve,ot=(We*Qe-Be*Oe)/$e,Et=(De*Xe-Se*Ye)/(2*$e)-Ee,mt=(Se*Oe-De*Qe)/$e,tt=ot*ot+mt*mt-1,Ke=2*(Le+it*ot+Et*mt),Mt=it*it+Et*Et-Le*Le,Jt=-(tt?(Ke+Math.sqrt(Ke*Ke-4*tt*Mt))/(2*tt):Mt/Ke);return{x:ve+it+ot*Jt,y:Ee+Et+mt*Jt,r:Jt}}function _(se,de,ce){var ve,Ee,Le,Te,xe=se.x-de.x,fe=se.y-de.y,ge=xe*xe+fe*fe;ge?(Ee=de.r+ce.r,Ee*=Ee,Te=se.r+ce.r,Ee>(Te*=Te)?(ve=(ge+Te-Ee)/(2*ge),Le=Math.sqrt(Math.max(0,Te/ge-ve*ve)),ce.x=se.x-ve*xe-Le*fe,ce.y=se.y-ve*fe+Le*xe):(ve=(ge+Ee-Te)/(2*ge),Le=Math.sqrt(Math.max(0,Ee/ge-ve*ve)),ce.x=de.x+ve*xe-Le*fe,ce.y=de.y+ve*fe+Le*xe)):(ce.x=de.x+ce.r,ce.y=de.y)}function k(se,de){var ce=se.r+de.r-1e-6,ve=de.x-se.x,Ee=de.y-se.y;return ce>0&&ce*ce>ve*ve+Ee*Ee}function E(se){var de=se._,ce=se.next._,ve=de.r+ce.r,Ee=(de.x*ce.r+ce.x*de.r)/ve,Le=(de.y*ce.r+ce.y*de.r)/ve;return Ee*Ee+Le*Le}function A(se){this._=se,this.next=null,this.previous=null}function b(se){if(!(Ee=se.length))return 0;var de,ce,ve,Ee,Le,Te,xe,fe,ge,ke,Me;if((de=se[0]).x=0,de.y=0,!(Ee>1))return de.r;if(ce=se[1],de.x=-ce.r,ce.x=de.r,ce.y=0,!(Ee>2))return de.r+ce.r;_(ce,de,ve=se[2]),de=new A(de),ce=new A(ce),ve=new A(ve),de.next=ve.previous=ce,ce.next=de.previous=ve,ve.next=ce.previous=de;e:for(xe=3;xe<Ee;++xe){_(de._,ce._,ve=se[xe]),ve=new A(ve),fe=ce.next,ge=de.previous,ke=ce._.r,Me=de._.r;do if(ke<=Me){if(k(fe._,ve._)){ce=fe,de.next=ce,ce.previous=de,--xe;continue e}ke+=fe._.r,fe=fe.next}else{if(k(ge._,ve._)){(de=ge).next=ce,ce.previous=de,--xe;continue e}Me+=ge._.r,ge=ge.previous}while(fe!==ge.next);for(ve.previous=de,ve.next=ce,de.next=ce.previous=ce=ve,Le=E(de);(ve=ve.next)!==ce;)(Te=E(ve))<Le&&(de=ve,Le=Te);ce=de.next}for(de=[ce._],ve=ce;(ve=ve.next)!==ce;)de.push(ve._);for(ve=c(de),xe=0;xe<Ee;++xe)(de=se[xe]).x-=ve.x,de.y-=ve.y;return ve.r}function L(se){return se==null?null:w(se)}function w(se){if(typeof se!="function")throw new Error;return se}function C(){return 0}function S(se){return function(){return se}}function P(se){return Math.sqrt(se.value)}function z(se){return function(de){de.children||(de.r=Math.max(0,+se(de)||0))}}function F(se,de){return function(ce){if(ve=ce.children){var ve,Ee,Le,Te=ve.length,xe=se(ce)*de||0;if(xe)for(Ee=0;Ee<Te;++Ee)ve[Ee].r+=xe;if(Le=b(ve),xe)for(Ee=0;Ee<Te;++Ee)ve[Ee].r-=xe;ce.r=Le+xe}}}function q(se){return function(de){var ce=de.parent;de.r*=se,ce&&(de.x=ce.x+se*de.x,de.y=ce.y+se*de.y)}}function W(se){se.x0=Math.round(se.x0),se.y0=Math.round(se.y0),se.x1=Math.round(se.x1),se.y1=Math.round(se.y1)}function X(se,de,ce,ve,Ee){for(var Le,Te=se.children,xe=-1,fe=Te.length,ge=se.value&&(ve-de)/se.value;++xe<fe;)(Le=Te[xe]).y0=ce,Le.y1=Ee,Le.x0=de,Le.x1=de+=Le.value*ge}var Q={depth:-1},Z={};function Y(se){return se.id}function N(se){return se.parentId}function J(se,de){return se.parent===de.parent?1:2}function D(se){var de=se.children;return de?de[0]:se.t}function U(se){var de=se.children;return de?de[de.length-1]:se.t}function G(se,de,ce){var ve=ce/(de.i-se.i);de.c-=ve,de.s+=ce,se.c+=ve,de.z+=ce,de.m+=ce}function $(se,de,ce){return se.a.parent===de.parent?se.a:ce}function K(se,de){this._=se,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=de}function re(se,de,ce,ve,Ee){for(var Le,Te=se.children,xe=-1,fe=Te.length,ge=se.value&&(Ee-ce)/se.value;++xe<fe;)(Le=Te[xe]).x0=de,Le.x1=ve,Le.y0=ce,Le.y1=ce+=Le.value*ge}K.prototype=Object.create(s.prototype);var ne=(1+Math.sqrt(5))/2;function ae(se,de,ce,ve,Ee,Le){for(var Te,xe,fe,ge,ke,Me,Se,De,Be,We,Qe,Oe=[],Ue=de.children,Xe=0,Ye=0,$e=Ue.length,it=de.value;Xe<$e;){fe=Ee-ce,ge=Le-ve;do ke=Ue[Ye++].value;while(!ke&&Ye<$e);for(Me=Se=ke,Qe=ke*ke*(We=Math.max(ge/fe,fe/ge)/(it*se)),Be=Math.max(Se/Qe,Qe/Me);Ye<$e;++Ye){if(ke+=xe=Ue[Ye].value,xe<Me&&(Me=xe),xe>Se&&(Se=xe),Qe=ke*ke*We,(De=Math.max(Se/Qe,Qe/Me))>Be){ke-=xe;break}Be=De}Oe.push(Te={value:ke,dice:fe<ge,children:Ue.slice(Xe,Ye)}),Te.dice?X(Te,ce,ve,Ee,it?ve+=ge*ke/it:Le):re(Te,ce,ve,it?ce+=fe*ke/it:Ee,Le),it-=ke,Xe=Ye}return Oe}var ie=function se(de){function ce(ve,Ee,Le,Te,xe){ae(de,ve,Ee,Le,Te,xe)}return ce.ratio=function(ve){return se((ve=+ve)>1?ve:1)},ce}(ne),he=function se(de){function ce(ve,Ee,Le,Te,xe){if((fe=ve._squarify)&&fe.ratio===de)for(var fe,ge,ke,Me,Se,De=-1,Be=fe.length,We=ve.value;++De<Be;){for(ke=(ge=fe[De]).children,Me=ge.value=0,Se=ke.length;Me<Se;++Me)ge.value+=ke[Me].value;ge.dice?X(ge,Ee,Le,Te,Le+=(xe-Le)*ge.value/We):re(ge,Ee,Le,Ee+=(Te-Ee)*ge.value/We,xe),We-=ge.value}else ve._squarify=fe=ae(de,ve,Ee,Le,Te,xe),fe.ratio=de}return ce.ratio=function(ve){return se((ve=+ve)>1?ve:1)},ce}(ne);t.cluster=function(){var se=h,de=1,ce=1,ve=!1;function Ee(Le){var Te,xe=0;Le.eachAfter(function(Se){var De=Se.children;De?(Se.x=function(Be){return Be.reduce(p,0)/Be.length}(De),Se.y=function(Be){return 1+Be.reduce(u,0)}(De)):(Se.x=Te?xe+=se(Se,Te):0,Se.y=0,Te=Se)});var fe=function(Se){for(var De;De=Se.children;)Se=De[0];return Se}(Le),ge=function(Se){for(var De;De=Se.children;)Se=De[De.length-1];return Se}(Le),ke=fe.x-se(fe,ge)/2,Me=ge.x+se(ge,fe)/2;return Le.eachAfter(ve?function(Se){Se.x=(Se.x-Le.x)*de,Se.y=(Le.y-Se.y)*ce}:function(Se){Se.x=(Se.x-ke)/(Me-ke)*de,Se.y=(1-(Le.y?Se.y/Le.y:1))*ce})}return Ee.separation=function(Le){return arguments.length?(se=Le,Ee):se},Ee.size=function(Le){return arguments.length?(ve=!1,de=+Le[0],ce=+Le[1],Ee):ve?null:[de,ce]},Ee.nodeSize=function(Le){return arguments.length?(ve=!0,de=+Le[0],ce=+Le[1],Ee):ve?[de,ce]:null},Ee},t.hierarchy=l,t.pack=function(){var se=null,de=1,ce=1,ve=C;function Ee(Le){return Le.x=de/2,Le.y=ce/2,se?Le.eachBefore(z(se)).eachAfter(F(ve,.5)).eachBefore(q(1)):Le.eachBefore(z(P)).eachAfter(F(C,1)).eachAfter(F(ve,Le.r/Math.min(de,ce))).eachBefore(q(Math.min(de,ce)/(2*Le.r))),Le}return Ee.radius=function(Le){return arguments.length?(se=L(Le),Ee):se},Ee.size=function(Le){return arguments.length?(de=+Le[0],ce=+Le[1],Ee):[de,ce]},Ee.padding=function(Le){return arguments.length?(ve=typeof Le=="function"?Le:S(+Le),Ee):ve},Ee},t.packEnclose=c,t.packSiblings=function(se){return b(se),se},t.partition=function(){var se=1,de=1,ce=0,ve=!1;function Ee(Le){var Te=Le.height+1;return Le.x0=Le.y0=ce,Le.x1=se,Le.y1=de/Te,Le.eachBefore(function(xe,fe){return function(ge){ge.children&&X(ge,ge.x0,xe*(ge.depth+1)/fe,ge.x1,xe*(ge.depth+2)/fe);var ke=ge.x0,Me=ge.y0,Se=ge.x1-ce,De=ge.y1-ce;Se<ke&&(ke=Se=(ke+Se)/2),De<Me&&(Me=De=(Me+De)/2),ge.x0=ke,ge.y0=Me,ge.x1=Se,ge.y1=De}}(de,Te)),ve&&Le.eachBefore(W),Le}return Ee.round=function(Le){return arguments.length?(ve=!!Le,Ee):ve},Ee.size=function(Le){return arguments.length?(se=+Le[0],de=+Le[1],Ee):[se,de]},Ee.padding=function(Le){return arguments.length?(ce=+Le,Ee):ce},Ee},t.stratify=function(){var se=Y,de=N;function ce(ve){var Ee,Le,Te,xe,fe,ge,ke,Me=ve.length,Se=new Array(Me),De={};for(Le=0;Le<Me;++Le)Ee=ve[Le],fe=Se[Le]=new s(Ee),(ge=se(Ee,Le,ve))!=null&&(ge+="")&&(De[ke="$"+(fe.id=ge)]=ke in De?Z:fe);for(Le=0;Le<Me;++Le)if(fe=Se[Le],(ge=de(ve[Le],Le,ve))!=null&&(ge+="")){if(!(xe=De["$"+ge]))throw new Error("missing: "+ge);if(xe===Z)throw new Error("ambiguous: "+ge);xe.children?xe.children.push(fe):xe.children=[fe],fe.parent=xe}else{if(Te)throw new Error("multiple roots");Te=fe}if(!Te)throw new Error("no root");if(Te.parent=Q,Te.eachBefore(function(Be){Be.depth=Be.parent.depth+1,--Me}).eachBefore(n),Te.parent=null,Me>0)throw new Error("cycle");return Te}return ce.id=function(ve){return arguments.length?(se=w(ve),ce):se},ce.parentId=function(ve){return arguments.length?(de=w(ve),ce):de},ce},t.tree=function(){var se=J,de=1,ce=1,ve=null;function Ee(fe){var ge=function(Oe){for(var Ue,Xe,Ye,$e,it,ot=new K(Oe,0),Et=[ot];Ue=Et.pop();)if(Ye=Ue._.children)for(Ue.children=new Array(it=Ye.length),$e=it-1;$e>=0;--$e)Et.push(Xe=Ue.children[$e]=new K(Ye[$e],$e)),Xe.parent=Ue;return(ot.parent=new K(null,0)).children=[ot],ot}(fe);if(ge.eachAfter(Le),ge.parent.m=-ge.z,ge.eachBefore(Te),ve)fe.eachBefore(xe);else{var ke=fe,Me=fe,Se=fe;fe.eachBefore(function(Oe){Oe.x<ke.x&&(ke=Oe),Oe.x>Me.x&&(Me=Oe),Oe.depth>Se.depth&&(Se=Oe)});var De=ke===Me?1:se(ke,Me)/2,Be=De-ke.x,We=de/(Me.x+De+Be),Qe=ce/(Se.depth||1);fe.eachBefore(function(Oe){Oe.x=(Oe.x+Be)*We,Oe.y=Oe.depth*Qe})}return fe}function Le(fe){var ge=fe.children,ke=fe.parent.children,Me=fe.i?ke[fe.i-1]:null;if(ge){(function(De){for(var Be,We=0,Qe=0,Oe=De.children,Ue=Oe.length;--Ue>=0;)(Be=Oe[Ue]).z+=We,Be.m+=We,We+=Be.s+(Qe+=Be.c)})(fe);var Se=(ge[0].z+ge[ge.length-1].z)/2;Me?(fe.z=Me.z+se(fe._,Me._),fe.m=fe.z-Se):fe.z=Se}else Me&&(fe.z=Me.z+se(fe._,Me._));fe.parent.A=function(De,Be,We){if(Be){for(var Qe,Oe=De,Ue=De,Xe=Be,Ye=Oe.parent.children[0],$e=Oe.m,it=Ue.m,ot=Xe.m,Et=Ye.m;Xe=U(Xe),Oe=D(Oe),Xe&&Oe;)Ye=D(Ye),(Ue=U(Ue)).a=De,(Qe=Xe.z+ot-Oe.z-$e+se(Xe._,Oe._))>0&&(G($(Xe,De,We),De,Qe),$e+=Qe,it+=Qe),ot+=Xe.m,$e+=Oe.m,Et+=Ye.m,it+=Ue.m;Xe&&!U(Ue)&&(Ue.t=Xe,Ue.m+=ot-it),Oe&&!D(Ye)&&(Ye.t=Oe,Ye.m+=$e-Et,We=De)}return We}(fe,Me,fe.parent.A||ke[0])}function Te(fe){fe._.x=fe.z+fe.parent.m,fe.m+=fe.parent.m}function xe(fe){fe.x*=de,fe.y=fe.depth*ce}return Ee.separation=function(fe){return arguments.length?(se=fe,Ee):se},Ee.size=function(fe){return arguments.length?(ve=!1,de=+fe[0],ce=+fe[1],Ee):ve?null:[de,ce]},Ee.nodeSize=function(fe){return arguments.length?(ve=!0,de=+fe[0],ce=+fe[1],Ee):ve?[de,ce]:null},Ee},t.treemap=function(){var se=ie,de=!1,ce=1,ve=1,Ee=[0],Le=C,Te=C,xe=C,fe=C,ge=C;function ke(Se){return Se.x0=Se.y0=0,Se.x1=ce,Se.y1=ve,Se.eachBefore(Me),Ee=[0],de&&Se.eachBefore(W),Se}function Me(Se){var De=Ee[Se.depth],Be=Se.x0+De,We=Se.y0+De,Qe=Se.x1-De,Oe=Se.y1-De;Qe<Be&&(Be=Qe=(Be+Qe)/2),Oe<We&&(We=Oe=(We+Oe)/2),Se.x0=Be,Se.y0=We,Se.x1=Qe,Se.y1=Oe,Se.children&&(De=Ee[Se.depth+1]=Le(Se)/2,Be+=ge(Se)-De,We+=Te(Se)-De,(Qe-=xe(Se)-De)<Be&&(Be=Qe=(Be+Qe)/2),(Oe-=fe(Se)-De)<We&&(We=Oe=(We+Oe)/2),se(Se,Be,We,Qe,Oe))}return ke.round=function(Se){return arguments.length?(de=!!Se,ke):de},ke.size=function(Se){return arguments.length?(ce=+Se[0],ve=+Se[1],ke):[ce,ve]},ke.tile=function(Se){return arguments.length?(se=w(Se),ke):se},ke.padding=function(Se){return arguments.length?ke.paddingInner(Se).paddingOuter(Se):ke.paddingInner()},ke.paddingInner=function(Se){return arguments.length?(Le=typeof Se=="function"?Se:S(+Se),ke):Le},ke.paddingOuter=function(Se){return arguments.length?ke.paddingTop(Se).paddingRight(Se).paddingBottom(Se).paddingLeft(Se):ke.paddingTop()},ke.paddingTop=function(Se){return arguments.length?(Te=typeof Se=="function"?Se:S(+Se),ke):Te},ke.paddingRight=function(Se){return arguments.length?(xe=typeof Se=="function"?Se:S(+Se),ke):xe},ke.paddingBottom=function(Se){return arguments.length?(fe=typeof Se=="function"?Se:S(+Se),ke):fe},ke.paddingLeft=function(Se){return arguments.length?(ge=typeof Se=="function"?Se:S(+Se),ke):ge},ke},t.treemapBinary=function(se,de,ce,ve,Ee){var Le,Te,xe=se.children,fe=xe.length,ge=new Array(fe+1);for(ge[0]=Te=Le=0;Le<fe;++Le)ge[Le+1]=Te+=xe[Le].value;(function ke(Me,Se,De,Be,We,Qe,Oe){if(Me>=Se-1){var Ue=xe[Me];return Ue.x0=Be,Ue.y0=We,Ue.x1=Qe,void(Ue.y1=Oe)}for(var Xe=ge[Me],Ye=De/2+Xe,$e=Me+1,it=Se-1;$e<it;){var ot=$e+it>>>1;ge[ot]<Ye?$e=ot+1:it=ot}Ye-ge[$e-1]<ge[$e]-Ye&&Me+1<$e&&--$e;var Et=ge[$e]-Xe,mt=De-Et;if(Qe-Be>Oe-We){var tt=(Be*mt+Qe*Et)/De;ke(Me,$e,Et,Be,We,tt,Oe),ke($e,Se,mt,tt,We,Qe,Oe)}else{var Ke=(We*mt+Oe*Et)/De;ke(Me,$e,Et,Be,We,Qe,Ke),ke($e,Se,mt,Be,Ke,Qe,Oe)}})(0,fe,se.value,de,ce,ve,Ee)},t.treemapDice=X,t.treemapResquarify=he,t.treemapSlice=re,t.treemapSliceDice=function(se,de,ce,ve,Ee){(1&se.depth?re:X)(se,de,ce,ve,Ee)},t.treemapSquarify=ie,Object.defineProperty(t,"__esModule",{value:!0})})},{}],171:[function(i,B,V){(function(t,h){typeof V=="object"&&B!==void 0?h(V,i("d3-color")):h((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,h){function p(ne,ae,ie,he,se){var de=ne*ne,ce=de*ne;return((1-3*ne+3*de-ce)*ae+(4-6*de+3*ce)*ie+(1+3*ne+3*de-3*ce)*he+ce*se)/6}function u(ne){var ae=ne.length-1;return function(ie){var he=ie<=0?ie=0:ie>=1?(ie=1,ae-1):Math.floor(ie*ae),se=ne[he],de=ne[he+1],ce=he>0?ne[he-1]:2*se-de,ve=he<ae-1?ne[he+2]:2*de-se;return p((ie-he/ae)*ae,ce,se,de,ve)}}function e(ne){var ae=ne.length;return function(ie){var he=Math.floor(((ie%=1)<0?++ie:ie)*ae),se=ne[(he+ae-1)%ae],de=ne[he%ae],ce=ne[(he+1)%ae],ve=ne[(he+2)%ae];return p((ie-he/ae)*ae,se,de,ce,ve)}}function l(ne){return function(){return ne}}function o(ne,ae){return function(ie){return ne+ie*ae}}function a(ne,ae){var ie=ae-ne;return ie?o(ne,ie>180||ie<-180?ie-360*Math.round(ie/360):ie):l(isNaN(ne)?ae:ne)}function n(ne){return(ne=+ne)==1?s:function(ae,ie){return ie-ae?function(he,se,de){return he=Math.pow(he,de),se=Math.pow(se,de)-he,de=1/de,function(ce){return Math.pow(he+ce*se,de)}}(ae,ie,ne):l(isNaN(ae)?ie:ae)}}function s(ne,ae){var ie=ae-ne;return ie?o(ne,ie):l(isNaN(ne)?ae:ne)}var r=function ne(ae){var ie=n(ae);function he(se,de){var ce=ie((se=h.rgb(se)).r,(de=h.rgb(de)).r),ve=ie(se.g,de.g),Ee=ie(se.b,de.b),Le=s(se.opacity,de.opacity);return function(Te){return se.r=ce(Te),se.g=ve(Te),se.b=Ee(Te),se.opacity=Le(Te),se+""}}return he.gamma=ne,he}(1);function c(ne){return function(ae){var ie,he,se=ae.length,de=new Array(se),ce=new Array(se),ve=new Array(se);for(ie=0;ie<se;++ie)he=h.rgb(ae[ie]),de[ie]=he.r||0,ce[ie]=he.g||0,ve[ie]=he.b||0;return de=ne(de),ce=ne(ce),ve=ne(ve),he.opacity=1,function(Ee){return he.r=de(Ee),he.g=ce(Ee),he.b=ve(Ee),he+""}}}var f=c(u),d=c(e);function g(ne,ae){ae||(ae=[]);var ie,he=ne?Math.min(ae.length,ne.length):0,se=ae.slice();return function(de){for(ie=0;ie<he;++ie)se[ie]=ne[ie]*(1-de)+ae[ie]*de;return se}}function m(ne){return ArrayBuffer.isView(ne)&&!(ne instanceof DataView)}function y(ne,ae){var ie,he=ae?ae.length:0,se=ne?Math.min(he,ne.length):0,de=new Array(se),ce=new Array(he);for(ie=0;ie<se;++ie)de[ie]=b(ne[ie],ae[ie]);for(;ie<he;++ie)ce[ie]=ae[ie];return function(ve){for(ie=0;ie<se;++ie)ce[ie]=de[ie](ve);return ce}}function v(ne,ae){var ie=new Date;return ne=+ne,ae=+ae,function(he){return ie.setTime(ne*(1-he)+ae*he),ie}}function T(ne,ae){return ne=+ne,ae=+ae,function(ie){return ne*(1-ie)+ae*ie}}function _(ne,ae){var ie,he={},se={};for(ie in ne!==null&&typeof ne=="object"||(ne={}),ae!==null&&typeof ae=="object"||(ae={}),ae)ie in ne?he[ie]=b(ne[ie],ae[ie]):se[ie]=ae[ie];return function(de){for(ie in he)se[ie]=he[ie](de);return se}}var k=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,E=new RegExp(k.source,"g");function A(ne,ae){var ie,he,se,de=k.lastIndex=E.lastIndex=0,ce=-1,ve=[],Ee=[];for(ne+="",ae+="";(ie=k.exec(ne))&&(he=E.exec(ae));)(se=he.index)>de&&(se=ae.slice(de,se),ve[ce]?ve[ce]+=se:ve[++ce]=se),(ie=ie[0])===(he=he[0])?ve[ce]?ve[ce]+=he:ve[++ce]=he:(ve[++ce]=null,Ee.push({i:ce,x:T(ie,he)})),de=E.lastIndex;return de<ae.length&&(se=ae.slice(de),ve[ce]?ve[ce]+=se:ve[++ce]=se),ve.length<2?Ee[0]?function(Le){return function(Te){return Le(Te)+""}}(Ee[0].x):function(Le){return function(){return Le}}(ae):(ae=Ee.length,function(Le){for(var Te,xe=0;xe<ae;++xe)ve[(Te=Ee[xe]).i]=Te.x(Le);return ve.join("")})}function b(ne,ae){var ie,he=typeof ae;return ae==null||he==="boolean"?l(ae):(he==="number"?T:he==="string"?(ie=h.color(ae))?(ae=ie,r):A:ae instanceof h.color?r:ae instanceof Date?v:m(ae)?g:Array.isArray(ae)?y:typeof ae.valueOf!="function"&&typeof ae.toString!="function"||isNaN(ae)?_:T)(ne,ae)}var L,w,C,S,P=180/Math.PI,z={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function F(ne,ae,ie,he,se,de){var ce,ve,Ee;return(ce=Math.sqrt(ne*ne+ae*ae))&&(ne/=ce,ae/=ce),(Ee=ne*ie+ae*he)&&(ie-=ne*Ee,he-=ae*Ee),(ve=Math.sqrt(ie*ie+he*he))&&(ie/=ve,he/=ve,Ee/=ve),ne*he<ae*ie&&(ne=-ne,ae=-ae,Ee=-Ee,ce=-ce),{translateX:se,translateY:de,rotate:Math.atan2(ae,ne)*P,skewX:Math.atan(Ee)*P,scaleX:ce,scaleY:ve}}function q(ne,ae,ie,he){function se(de){return de.length?de.pop()+" ":""}return function(de,ce){var ve=[],Ee=[];return de=ne(de),ce=ne(ce),function(Le,Te,xe,fe,ge,ke){if(Le!==xe||Te!==fe){var Me=ge.push("translate(",null,ae,null,ie);ke.push({i:Me-4,x:T(Le,xe)},{i:Me-2,x:T(Te,fe)})}else(xe||fe)&&ge.push("translate("+xe+ae+fe+ie)}(de.translateX,de.translateY,ce.translateX,ce.translateY,ve,Ee),function(Le,Te,xe,fe){Le!==Te?(Le-Te>180?Te+=360:Te-Le>180&&(Le+=360),fe.push({i:xe.push(se(xe)+"rotate(",null,he)-2,x:T(Le,Te)})):Te&&xe.push(se(xe)+"rotate("+Te+he)}(de.rotate,ce.rotate,ve,Ee),function(Le,Te,xe,fe){Le!==Te?fe.push({i:xe.push(se(xe)+"skewX(",null,he)-2,x:T(Le,Te)}):Te&&xe.push(se(xe)+"skewX("+Te+he)}(de.skewX,ce.skewX,ve,Ee),function(Le,Te,xe,fe,ge,ke){if(Le!==xe||Te!==fe){var Me=ge.push(se(ge)+"scale(",null,",",null,")");ke.push({i:Me-4,x:T(Le,xe)},{i:Me-2,x:T(Te,fe)})}else xe===1&&fe===1||ge.push(se(ge)+"scale("+xe+","+fe+")")}(de.scaleX,de.scaleY,ce.scaleX,ce.scaleY,ve,Ee),de=ce=null,function(Le){for(var Te,xe=-1,fe=Ee.length;++xe<fe;)ve[(Te=Ee[xe]).i]=Te.x(Le);return ve.join("")}}}var W=q(function(ne){return ne==="none"?z:(L||(L=document.createElement("DIV"),w=document.documentElement,C=document.defaultView),L.style.transform=ne,ne=C.getComputedStyle(w.appendChild(L),null).getPropertyValue("transform"),w.removeChild(L),F(+(ne=ne.slice(7,-1).split(","))[0],+ne[1],+ne[2],+ne[3],+ne[4],+ne[5]))},"px, ","px)","deg)"),X=q(function(ne){return ne==null?z:(S||(S=document.createElementNS("http://www.w3.org/2000/svg","g")),S.setAttribute("transform",ne),(ne=S.transform.baseVal.consolidate())?F((ne=ne.matrix).a,ne.b,ne.c,ne.d,ne.e,ne.f):z)},", ",")",")"),Q=Math.SQRT2;function Z(ne){return((ne=Math.exp(ne))+1/ne)/2}function Y(ne){return function(ae,ie){var he=ne((ae=h.hsl(ae)).h,(ie=h.hsl(ie)).h),se=s(ae.s,ie.s),de=s(ae.l,ie.l),ce=s(ae.opacity,ie.opacity);return function(ve){return ae.h=he(ve),ae.s=se(ve),ae.l=de(ve),ae.opacity=ce(ve),ae+""}}}var N=Y(a),J=Y(s);function D(ne){return function(ae,ie){var he=ne((ae=h.hcl(ae)).h,(ie=h.hcl(ie)).h),se=s(ae.c,ie.c),de=s(ae.l,ie.l),ce=s(ae.opacity,ie.opacity);return function(ve){return ae.h=he(ve),ae.c=se(ve),ae.l=de(ve),ae.opacity=ce(ve),ae+""}}}var U=D(a),G=D(s);function $(ne){return function ae(ie){function he(se,de){var ce=ne((se=h.cubehelix(se)).h,(de=h.cubehelix(de)).h),ve=s(se.s,de.s),Ee=s(se.l,de.l),Le=s(se.opacity,de.opacity);return function(Te){return se.h=ce(Te),se.s=ve(Te),se.l=Ee(Math.pow(Te,ie)),se.opacity=Le(Te),se+""}}return ie=+ie,he.gamma=ae,he}(1)}var K=$(a),re=$(s);t.interpolate=b,t.interpolateArray=function(ne,ae){return(m(ae)?g:y)(ne,ae)},t.interpolateBasis=u,t.interpolateBasisClosed=e,t.interpolateCubehelix=K,t.interpolateCubehelixLong=re,t.interpolateDate=v,t.interpolateDiscrete=function(ne){var ae=ne.length;return function(ie){return ne[Math.max(0,Math.min(ae-1,Math.floor(ie*ae)))]}},t.interpolateHcl=U,t.interpolateHclLong=G,t.interpolateHsl=N,t.interpolateHslLong=J,t.interpolateHue=function(ne,ae){var ie=a(+ne,+ae);return function(he){var se=ie(he);return se-360*Math.floor(se/360)}},t.interpolateLab=function(ne,ae){var ie=s((ne=h.lab(ne)).l,(ae=h.lab(ae)).l),he=s(ne.a,ae.a),se=s(ne.b,ae.b),de=s(ne.opacity,ae.opacity);return function(ce){return ne.l=ie(ce),ne.a=he(ce),ne.b=se(ce),ne.opacity=de(ce),ne+""}},t.interpolateNumber=T,t.interpolateNumberArray=g,t.interpolateObject=_,t.interpolateRgb=r,t.interpolateRgbBasis=f,t.interpolateRgbBasisClosed=d,t.interpolateRound=function(ne,ae){return ne=+ne,ae=+ae,function(ie){return Math.round(ne*(1-ie)+ae*ie)}},t.interpolateString=A,t.interpolateTransformCss=W,t.interpolateTransformSvg=X,t.interpolateZoom=function(ne,ae){var ie,he,se=ne[0],de=ne[1],ce=ne[2],ve=ae[0],Ee=ae[1],Le=ae[2],Te=ve-se,xe=Ee-de,fe=Te*Te+xe*xe;if(fe<1e-12)he=Math.log(Le/ce)/Q,ie=function(Be){return[se+Be*Te,de+Be*xe,ce*Math.exp(Q*Be*he)]};else{var ge=Math.sqrt(fe),ke=(Le*Le-ce*ce+4*fe)/(2*ce*2*ge),Me=(Le*Le-ce*ce-4*fe)/(2*Le*2*ge),Se=Math.log(Math.sqrt(ke*ke+1)-ke),De=Math.log(Math.sqrt(Me*Me+1)-Me);he=(De-Se)/Q,ie=function(Be){var We,Qe=Be*he,Oe=Z(Se),Ue=ce/(2*ge)*(Oe*(We=Q*Qe+Se,((We=Math.exp(2*We))-1)/(We+1))-function(Xe){return((Xe=Math.exp(Xe))-1/Xe)/2}(Se));return[se+Ue*Te,de+Ue*xe,ce*Oe/Z(Q*Qe+Se)]}}return ie.duration=1e3*he,ie},t.piecewise=function(ne,ae){for(var ie=0,he=ae.length-1,se=ae[0],de=new Array(he<0?0:he);ie<he;)de[ie]=ne(se,se=ae[++ie]);return function(ce){var ve=Math.max(0,Math.min(he-1,Math.floor(ce*=he)));return de[ve](ce-ve)}},t.quantize=function(ne,ae){for(var ie=new Array(ae),he=0;he<ae;++he)ie[he]=ne(he/(ae-1));return ie},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-color":164}],172:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:(t=t||self).d3=t.d3||{})})(this,function(t){var h=Math.PI,p=2*h,u=p-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function l(){return new e}e.prototype=l.prototype={constructor:e,moveTo:function(o,a){this._+="M"+(this._x0=this._x1=+o)+","+(this._y0=this._y1=+a)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(o,a){this._+="L"+(this._x1=+o)+","+(this._y1=+a)},quadraticCurveTo:function(o,a,n,s){this._+="Q"+ +o+","+ +a+","+(this._x1=+n)+","+(this._y1=+s)},bezierCurveTo:function(o,a,n,s,r,c){this._+="C"+ +o+","+ +a+","+ +n+","+ +s+","+(this._x1=+r)+","+(this._y1=+c)},arcTo:function(o,a,n,s,r){o=+o,a=+a,n=+n,s=+s,r=+r;var c=this._x1,f=this._y1,d=n-o,g=s-a,m=c-o,y=f-a,v=m*m+y*y;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=o)+","+(this._y1=a);else if(v>1e-6)if(Math.abs(y*d-g*m)>1e-6&&r){var T=n-c,_=s-f,k=d*d+g*g,E=T*T+_*_,A=Math.sqrt(k),b=Math.sqrt(v),L=r*Math.tan((h-Math.acos((k+v-E)/(2*A*b)))/2),w=L/b,C=L/A;Math.abs(w-1)>1e-6&&(this._+="L"+(o+w*m)+","+(a+w*y)),this._+="A"+r+","+r+",0,0,"+ +(y*T>m*_)+","+(this._x1=o+C*d)+","+(this._y1=a+C*g)}else this._+="L"+(this._x1=o)+","+(this._y1=a)},arc:function(o,a,n,s,r,c){o=+o,a=+a,c=!!c;var f=(n=+n)*Math.cos(s),d=n*Math.sin(s),g=o+f,m=a+d,y=1^c,v=c?s-r:r-s;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+g+","+m:(Math.abs(this._x1-g)>1e-6||Math.abs(this._y1-m)>1e-6)&&(this._+="L"+g+","+m),n&&(v<0&&(v=v%p+p),v>u?this._+="A"+n+","+n+",0,1,"+y+","+(o-f)+","+(a-d)+"A"+n+","+n+",0,1,"+y+","+(this._x1=g)+","+(this._y1=m):v>1e-6&&(this._+="A"+n+","+n+",0,"+ +(v>=h)+","+y+","+(this._x1=o+n*Math.cos(r))+","+(this._y1=a+n*Math.sin(r))))},rect:function(o,a,n,s){this._+="M"+(this._x0=this._x1=+o)+","+(this._y0=this._y1=+a)+"h"+ +n+"v"+ +s+"h"+-n+"Z"},toString:function(){return this._}},t.path=l,Object.defineProperty(t,"__esModule",{value:!0})})},{}],173:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:(t=t||self).d3=t.d3||{})})(this,function(t){function h(s,r,c,f){if(isNaN(r)||isNaN(c))return s;var d,g,m,y,v,T,_,k,E,A=s._root,b={data:f},L=s._x0,w=s._y0,C=s._x1,S=s._y1;if(!A)return s._root=b,s;for(;A.length;)if((T=r>=(g=(L+C)/2))?L=g:C=g,(_=c>=(m=(w+S)/2))?w=m:S=m,d=A,!(A=A[k=_<<1|T]))return d[k]=b,s;if(y=+s._x.call(null,A.data),v=+s._y.call(null,A.data),r===y&&c===v)return b.next=A,d?d[k]=b:s._root=b,s;do d=d?d[k]=new Array(4):s._root=new Array(4),(T=r>=(g=(L+C)/2))?L=g:C=g,(_=c>=(m=(w+S)/2))?w=m:S=m;while((k=_<<1|T)==(E=(v>=m)<<1|y>=g));return d[E]=A,d[k]=b,s}function p(s,r,c,f,d){this.node=s,this.x0=r,this.y0=c,this.x1=f,this.y1=d}function u(s){return s[0]}function e(s){return s[1]}function l(s,r,c){var f=new o(r??u,c??e,NaN,NaN,NaN,NaN);return s==null?f:f.addAll(s)}function o(s,r,c,f,d,g){this._x=s,this._y=r,this._x0=c,this._y0=f,this._x1=d,this._y1=g,this._root=void 0}function a(s){for(var r={data:s.data},c=r;s=s.next;)c=c.next={data:s.data};return r}var n=l.prototype=o.prototype;n.copy=function(){var s,r,c=new o(this._x,this._y,this._x0,this._y0,this._x1,this._y1),f=this._root;if(!f)return c;if(!f.length)return c._root=a(f),c;for(s=[{source:f,target:c._root=new Array(4)}];f=s.pop();)for(var d=0;d<4;++d)(r=f.source[d])&&(r.length?s.push({source:r,target:f.target[d]=new Array(4)}):f.target[d]=a(r));return c},n.add=function(s){var r=+this._x.call(null,s),c=+this._y.call(null,s);return h(this.cover(r,c),r,c,s)},n.addAll=function(s){var r,c,f,d,g=s.length,m=new Array(g),y=new Array(g),v=1/0,T=1/0,_=-1/0,k=-1/0;for(c=0;c<g;++c)isNaN(f=+this._x.call(null,r=s[c]))||isNaN(d=+this._y.call(null,r))||(m[c]=f,y[c]=d,f<v&&(v=f),f>_&&(_=f),d<T&&(T=d),d>k&&(k=d));if(v>_||T>k)return this;for(this.cover(v,T).cover(_,k),c=0;c<g;++c)h(this,m[c],y[c],s[c]);return this},n.cover=function(s,r){if(isNaN(s=+s)||isNaN(r=+r))return this;var c=this._x0,f=this._y0,d=this._x1,g=this._y1;if(isNaN(c))d=(c=Math.floor(s))+1,g=(f=Math.floor(r))+1;else{for(var m,y,v=d-c,T=this._root;c>s||s>=d||f>r||r>=g;)switch(y=(r<f)<<1|s<c,(m=new Array(4))[y]=T,T=m,v*=2,y){case 0:d=c+v,g=f+v;break;case 1:c=d-v,g=f+v;break;case 2:d=c+v,f=g-v;break;case 3:c=d-v,f=g-v}this._root&&this._root.length&&(this._root=T)}return this._x0=c,this._y0=f,this._x1=d,this._y1=g,this},n.data=function(){var s=[];return this.visit(function(r){if(!r.length)do s.push(r.data);while(r=r.next)}),s},n.extent=function(s){return arguments.length?this.cover(+s[0][0],+s[0][1]).cover(+s[1][0],+s[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},n.find=function(s,r,c){var f,d,g,m,y,v,T,_=this._x0,k=this._y0,E=this._x1,A=this._y1,b=[],L=this._root;for(L&&b.push(new p(L,_,k,E,A)),c==null?c=1/0:(_=s-c,k=r-c,E=s+c,A=r+c,c*=c);v=b.pop();)if(!(!(L=v.node)||(d=v.x0)>E||(g=v.y0)>A||(m=v.x1)<_||(y=v.y1)<k))if(L.length){var w=(d+m)/2,C=(g+y)/2;b.push(new p(L[3],w,C,m,y),new p(L[2],d,C,w,y),new p(L[1],w,g,m,C),new p(L[0],d,g,w,C)),(T=(r>=C)<<1|s>=w)&&(v=b[b.length-1],b[b.length-1]=b[b.length-1-T],b[b.length-1-T]=v)}else{var S=s-+this._x.call(null,L.data),P=r-+this._y.call(null,L.data),z=S*S+P*P;if(z<c){var F=Math.sqrt(c=z);_=s-F,k=r-F,E=s+F,A=r+F,f=L.data}}return f},n.remove=function(s){if(isNaN(g=+this._x.call(null,s))||isNaN(m=+this._y.call(null,s)))return this;var r,c,f,d,g,m,y,v,T,_,k,E,A=this._root,b=this._x0,L=this._y0,w=this._x1,C=this._y1;if(!A)return this;if(A.length)for(;;){if((T=g>=(y=(b+w)/2))?b=y:w=y,(_=m>=(v=(L+C)/2))?L=v:C=v,r=A,!(A=A[k=_<<1|T]))return this;if(!A.length)break;(r[k+1&3]||r[k+2&3]||r[k+3&3])&&(c=r,E=k)}for(;A.data!==s;)if(f=A,!(A=A.next))return this;return(d=A.next)&&delete A.next,f?(d?f.next=d:delete f.next,this):r?(d?r[k]=d:delete r[k],(A=r[0]||r[1]||r[2]||r[3])&&A===(r[3]||r[2]||r[1]||r[0])&&!A.length&&(c?c[E]=A:this._root=A),this):(this._root=d,this)},n.removeAll=function(s){for(var r=0,c=s.length;r<c;++r)this.remove(s[r]);return this},n.root=function(){return this._root},n.size=function(){var s=0;return this.visit(function(r){if(!r.length)do++s;while(r=r.next)}),s},n.visit=function(s){var r,c,f,d,g,m,y=[],v=this._root;for(v&&y.push(new p(v,this._x0,this._y0,this._x1,this._y1));r=y.pop();)if(!s(v=r.node,f=r.x0,d=r.y0,g=r.x1,m=r.y1)&&v.length){var T=(f+g)/2,_=(d+m)/2;(c=v[3])&&y.push(new p(c,T,_,g,m)),(c=v[2])&&y.push(new p(c,f,_,T,m)),(c=v[1])&&y.push(new p(c,T,d,g,_)),(c=v[0])&&y.push(new p(c,f,d,T,_))}return this},n.visitAfter=function(s){var r,c=[],f=[];for(this._root&&c.push(new p(this._root,this._x0,this._y0,this._x1,this._y1));r=c.pop();){var d=r.node;if(d.length){var g,m=r.x0,y=r.y0,v=r.x1,T=r.y1,_=(m+v)/2,k=(y+T)/2;(g=d[0])&&c.push(new p(g,m,y,_,k)),(g=d[1])&&c.push(new p(g,_,y,v,k)),(g=d[2])&&c.push(new p(g,m,k,_,T)),(g=d[3])&&c.push(new p(g,_,k,v,T))}f.push(r)}for(;r=f.pop();)s(r.node,r.x0,r.y0,r.x1,r.y1);return this},n.x=function(s){return arguments.length?(this._x=s,this):this._x},n.y=function(s){return arguments.length?(this._y=s,this):this._y},t.quadtree=l,Object.defineProperty(t,"__esModule",{value:!0})})},{}],174:[function(i,B,V){(function(t,h){typeof V=="object"&&B!==void 0?h(V,i("d3-path")):h((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,h){function p(Ce){return function(){return Ce}}var u=Math.abs,e=Math.atan2,l=Math.cos,o=Math.max,a=Math.min,n=Math.sin,s=Math.sqrt,r=Math.PI,c=r/2,f=2*r;function d(Ce){return Ce>1?0:Ce<-1?r:Math.acos(Ce)}function g(Ce){return Ce>=1?c:Ce<=-1?-c:Math.asin(Ce)}function m(Ce){return Ce.innerRadius}function y(Ce){return Ce.outerRadius}function v(Ce){return Ce.startAngle}function T(Ce){return Ce.endAngle}function _(Ce){return Ce&&Ce.padAngle}function k(Ce,lt,At,Bt,Ht,or,ar,Nt){var nr=At-Ce,Lr=Bt-lt,dr=ar-Ht,Kt=Nt-or,yr=Kt*nr-dr*Lr;if(!(yr*yr<1e-12))return[Ce+(yr=(dr*(lt-or)-Kt*(Ce-Ht))/yr)*nr,lt+yr*Lr]}function E(Ce,lt,At,Bt,Ht,or,ar){var Nt=Ce-At,nr=lt-Bt,Lr=(ar?or:-or)/s(Nt*Nt+nr*nr),dr=Lr*nr,Kt=-Lr*Nt,yr=Ce+dr,xr=lt+Kt,gr=At+dr,wr=Bt+Kt,zr=(yr+gr)/2,Rr=(xr+wr)/2,Wr=gr-yr,gn=wr-xr,rn=Wr*Wr+gn*gn,Zr=Ht-or,bn=yr*wr-gr*xr,Dr=(gn<0?-1:1)*s(o(0,Zr*Zr*rn-bn*bn)),br=(bn*gn-Wr*Dr)/rn,Xr=(-bn*Wr-gn*Dr)/rn,fn=(bn*gn+Wr*Dr)/rn,Qr=(-bn*Wr+gn*Dr)/rn,un=br-zr,Pn=Xr-Rr,kn=fn-zr,Hn=Qr-Rr;return un*un+Pn*Pn>kn*kn+Hn*Hn&&(br=fn,Xr=Qr),{cx:br,cy:Xr,x01:-dr,y01:-Kt,x11:br*(Ht/Zr-1),y11:Xr*(Ht/Zr-1)}}function A(Ce){this._context=Ce}function b(Ce){return new A(Ce)}function L(Ce){return Ce[0]}function w(Ce){return Ce[1]}function C(){var Ce=L,lt=w,At=p(!0),Bt=null,Ht=b,or=null;function ar(Nt){var nr,Lr,dr,Kt=Nt.length,yr=!1;for(Bt==null&&(or=Ht(dr=h.path())),nr=0;nr<=Kt;++nr)!(nr<Kt&&At(Lr=Nt[nr],nr,Nt))===yr&&((yr=!yr)?or.lineStart():or.lineEnd()),yr&&or.point(+Ce(Lr,nr,Nt),+lt(Lr,nr,Nt));if(dr)return or=null,dr+""||null}return ar.x=function(Nt){return arguments.length?(Ce=typeof Nt=="function"?Nt:p(+Nt),ar):Ce},ar.y=function(Nt){return arguments.length?(lt=typeof Nt=="function"?Nt:p(+Nt),ar):lt},ar.defined=function(Nt){return arguments.length?(At=typeof Nt=="function"?Nt:p(!!Nt),ar):At},ar.curve=function(Nt){return arguments.length?(Ht=Nt,Bt!=null&&(or=Ht(Bt)),ar):Ht},ar.context=function(Nt){return arguments.length?(Nt==null?Bt=or=null:or=Ht(Bt=Nt),ar):Bt},ar}function S(){var Ce=L,lt=null,At=p(0),Bt=w,Ht=p(!0),or=null,ar=b,Nt=null;function nr(dr){var Kt,yr,xr,gr,wr,zr=dr.length,Rr=!1,Wr=new Array(zr),gn=new Array(zr);for(or==null&&(Nt=ar(wr=h.path())),Kt=0;Kt<=zr;++Kt){if(!(Kt<zr&&Ht(gr=dr[Kt],Kt,dr))===Rr)if(Rr=!Rr)yr=Kt,Nt.areaStart(),Nt.lineStart();else{for(Nt.lineEnd(),Nt.lineStart(),xr=Kt-1;xr>=yr;--xr)Nt.point(Wr[xr],gn[xr]);Nt.lineEnd(),Nt.areaEnd()}Rr&&(Wr[Kt]=+Ce(gr,Kt,dr),gn[Kt]=+At(gr,Kt,dr),Nt.point(lt?+lt(gr,Kt,dr):Wr[Kt],Bt?+Bt(gr,Kt,dr):gn[Kt]))}if(wr)return Nt=null,wr+""||null}function Lr(){return C().defined(Ht).curve(ar).context(or)}return nr.x=function(dr){return arguments.length?(Ce=typeof dr=="function"?dr:p(+dr),lt=null,nr):Ce},nr.x0=function(dr){return arguments.length?(Ce=typeof dr=="function"?dr:p(+dr),nr):Ce},nr.x1=function(dr){return arguments.length?(lt=dr==null?null:typeof dr=="function"?dr:p(+dr),nr):lt},nr.y=function(dr){return arguments.length?(At=typeof dr=="function"?dr:p(+dr),Bt=null,nr):At},nr.y0=function(dr){return arguments.length?(At=typeof dr=="function"?dr:p(+dr),nr):At},nr.y1=function(dr){return arguments.length?(Bt=dr==null?null:typeof dr=="function"?dr:p(+dr),nr):Bt},nr.lineX0=nr.lineY0=function(){return Lr().x(Ce).y(At)},nr.lineY1=function(){return Lr().x(Ce).y(Bt)},nr.lineX1=function(){return Lr().x(lt).y(At)},nr.defined=function(dr){return arguments.length?(Ht=typeof dr=="function"?dr:p(!!dr),nr):Ht},nr.curve=function(dr){return arguments.length?(ar=dr,or!=null&&(Nt=ar(or)),nr):ar},nr.context=function(dr){return arguments.length?(dr==null?or=Nt=null:Nt=ar(or=dr),nr):or},nr}function P(Ce,lt){return lt<Ce?-1:lt>Ce?1:lt>=Ce?0:NaN}function z(Ce){return Ce}A.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,lt){switch(Ce=+Ce,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,lt):this._context.moveTo(Ce,lt);break;case 1:this._point=2;default:this._context.lineTo(Ce,lt)}}};var F=W(b);function q(Ce){this._curve=Ce}function W(Ce){function lt(At){return new q(Ce(At))}return lt._curve=Ce,lt}function X(Ce){var lt=Ce.curve;return Ce.angle=Ce.x,delete Ce.x,Ce.radius=Ce.y,delete Ce.y,Ce.curve=function(At){return arguments.length?lt(W(At)):lt()._curve},Ce}function Q(){return X(C().curve(F))}function Z(){var Ce=S().curve(F),lt=Ce.curve,At=Ce.lineX0,Bt=Ce.lineX1,Ht=Ce.lineY0,or=Ce.lineY1;return Ce.angle=Ce.x,delete Ce.x,Ce.startAngle=Ce.x0,delete Ce.x0,Ce.endAngle=Ce.x1,delete Ce.x1,Ce.radius=Ce.y,delete Ce.y,Ce.innerRadius=Ce.y0,delete Ce.y0,Ce.outerRadius=Ce.y1,delete Ce.y1,Ce.lineStartAngle=function(){return X(At())},delete Ce.lineX0,Ce.lineEndAngle=function(){return X(Bt())},delete Ce.lineX1,Ce.lineInnerRadius=function(){return X(Ht())},delete Ce.lineY0,Ce.lineOuterRadius=function(){return X(or())},delete Ce.lineY1,Ce.curve=function(ar){return arguments.length?lt(W(ar)):lt()._curve},Ce}function Y(Ce,lt){return[(lt=+lt)*Math.cos(Ce-=Math.PI/2),lt*Math.sin(Ce)]}q.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Ce,lt){this._curve.point(lt*Math.sin(Ce),lt*-Math.cos(Ce))}};var N=Array.prototype.slice;function J(Ce){return Ce.source}function D(Ce){return Ce.target}function U(Ce){var lt=J,At=D,Bt=L,Ht=w,or=null;function ar(){var Nt,nr=N.call(arguments),Lr=lt.apply(this,nr),dr=At.apply(this,nr);if(or||(or=Nt=h.path()),Ce(or,+Bt.apply(this,(nr[0]=Lr,nr)),+Ht.apply(this,nr),+Bt.apply(this,(nr[0]=dr,nr)),+Ht.apply(this,nr)),Nt)return or=null,Nt+""||null}return ar.source=function(Nt){return arguments.length?(lt=Nt,ar):lt},ar.target=function(Nt){return arguments.length?(At=Nt,ar):At},ar.x=function(Nt){return arguments.length?(Bt=typeof Nt=="function"?Nt:p(+Nt),ar):Bt},ar.y=function(Nt){return arguments.length?(Ht=typeof Nt=="function"?Nt:p(+Nt),ar):Ht},ar.context=function(Nt){return arguments.length?(or=Nt??null,ar):or},ar}function G(Ce,lt,At,Bt,Ht){Ce.moveTo(lt,At),Ce.bezierCurveTo(lt=(lt+Bt)/2,At,lt,Ht,Bt,Ht)}function $(Ce,lt,At,Bt,Ht){Ce.moveTo(lt,At),Ce.bezierCurveTo(lt,At=(At+Ht)/2,Bt,At,Bt,Ht)}function K(Ce,lt,At,Bt,Ht){var or=Y(lt,At),ar=Y(lt,At=(At+Ht)/2),Nt=Y(Bt,At),nr=Y(Bt,Ht);Ce.moveTo(or[0],or[1]),Ce.bezierCurveTo(ar[0],ar[1],Nt[0],Nt[1],nr[0],nr[1])}var re={draw:function(Ce,lt){var At=Math.sqrt(lt/r);Ce.moveTo(At,0),Ce.arc(0,0,At,0,f)}},ne={draw:function(Ce,lt){var At=Math.sqrt(lt/5)/2;Ce.moveTo(-3*At,-At),Ce.lineTo(-At,-At),Ce.lineTo(-At,-3*At),Ce.lineTo(At,-3*At),Ce.lineTo(At,-At),Ce.lineTo(3*At,-At),Ce.lineTo(3*At,At),Ce.lineTo(At,At),Ce.lineTo(At,3*At),Ce.lineTo(-At,3*At),Ce.lineTo(-At,At),Ce.lineTo(-3*At,At),Ce.closePath()}},ae=Math.sqrt(1/3),ie=2*ae,he={draw:function(Ce,lt){var At=Math.sqrt(lt/ie),Bt=At*ae;Ce.moveTo(0,-At),Ce.lineTo(Bt,0),Ce.lineTo(0,At),Ce.lineTo(-Bt,0),Ce.closePath()}},se=Math.sin(r/10)/Math.sin(7*r/10),de=Math.sin(f/10)*se,ce=-Math.cos(f/10)*se,ve={draw:function(Ce,lt){var At=Math.sqrt(.8908130915292852*lt),Bt=de*At,Ht=ce*At;Ce.moveTo(0,-At),Ce.lineTo(Bt,Ht);for(var or=1;or<5;++or){var ar=f*or/5,Nt=Math.cos(ar),nr=Math.sin(ar);Ce.lineTo(nr*At,-Nt*At),Ce.lineTo(Nt*Bt-nr*Ht,nr*Bt+Nt*Ht)}Ce.closePath()}},Ee={draw:function(Ce,lt){var At=Math.sqrt(lt),Bt=-At/2;Ce.rect(Bt,Bt,At,At)}},Le=Math.sqrt(3),Te={draw:function(Ce,lt){var At=-Math.sqrt(lt/(3*Le));Ce.moveTo(0,2*At),Ce.lineTo(-Le*At,-At),Ce.lineTo(Le*At,-At),Ce.closePath()}},xe=-.5,fe=Math.sqrt(3)/2,ge=1/Math.sqrt(12),ke=3*(ge/2+1),Me={draw:function(Ce,lt){var At=Math.sqrt(lt/ke),Bt=At/2,Ht=At*ge,or=Bt,ar=At*ge+At,Nt=-or,nr=ar;Ce.moveTo(Bt,Ht),Ce.lineTo(or,ar),Ce.lineTo(Nt,nr),Ce.lineTo(xe*Bt-fe*Ht,fe*Bt+xe*Ht),Ce.lineTo(xe*or-fe*ar,fe*or+xe*ar),Ce.lineTo(xe*Nt-fe*nr,fe*Nt+xe*nr),Ce.lineTo(xe*Bt+fe*Ht,xe*Ht-fe*Bt),Ce.lineTo(xe*or+fe*ar,xe*ar-fe*or),Ce.lineTo(xe*Nt+fe*nr,xe*nr-fe*Nt),Ce.closePath()}},Se=[re,ne,he,Ee,ve,Te,Me];function De(){}function Be(Ce,lt,At){Ce._context.bezierCurveTo((2*Ce._x0+Ce._x1)/3,(2*Ce._y0+Ce._y1)/3,(Ce._x0+2*Ce._x1)/3,(Ce._y0+2*Ce._y1)/3,(Ce._x0+4*Ce._x1+lt)/6,(Ce._y0+4*Ce._y1+At)/6)}function We(Ce){this._context=Ce}function Qe(Ce){this._context=Ce}function Oe(Ce){this._context=Ce}function Ue(Ce,lt){this._basis=new We(Ce),this._beta=lt}We.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Be(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,lt){switch(Ce=+Ce,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,lt):this._context.moveTo(Ce,lt);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Be(this,Ce,lt)}this._x0=this._x1,this._x1=Ce,this._y0=this._y1,this._y1=lt}},Qe.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Ce,lt){switch(Ce=+Ce,lt=+lt,this._point){case 0:this._point=1,this._x2=Ce,this._y2=lt;break;case 1:this._point=2,this._x3=Ce,this._y3=lt;break;case 2:this._point=3,this._x4=Ce,this._y4=lt,this._context.moveTo((this._x0+4*this._x1+Ce)/6,(this._y0+4*this._y1+lt)/6);break;default:Be(this,Ce,lt)}this._x0=this._x1,this._x1=Ce,this._y0=this._y1,this._y1=lt}},Oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,lt){switch(Ce=+Ce,lt=+lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var At=(this._x0+4*this._x1+Ce)/6,Bt=(this._y0+4*this._y1+lt)/6;this._line?this._context.lineTo(At,Bt):this._context.moveTo(At,Bt);break;case 3:this._point=4;default:Be(this,Ce,lt)}this._x0=this._x1,this._x1=Ce,this._y0=this._y1,this._y1=lt}},Ue.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Ce=this._x,lt=this._y,At=Ce.length-1;if(At>0)for(var Bt,Ht=Ce[0],or=lt[0],ar=Ce[At]-Ht,Nt=lt[At]-or,nr=-1;++nr<=At;)Bt=nr/At,this._basis.point(this._beta*Ce[nr]+(1-this._beta)*(Ht+Bt*ar),this._beta*lt[nr]+(1-this._beta)*(or+Bt*Nt));this._x=this._y=null,this._basis.lineEnd()},point:function(Ce,lt){this._x.push(+Ce),this._y.push(+lt)}};var Xe=function Ce(lt){function At(Bt){return lt===1?new We(Bt):new Ue(Bt,lt)}return At.beta=function(Bt){return Ce(+Bt)},At}(.85);function Ye(Ce,lt,At){Ce._context.bezierCurveTo(Ce._x1+Ce._k*(Ce._x2-Ce._x0),Ce._y1+Ce._k*(Ce._y2-Ce._y0),Ce._x2+Ce._k*(Ce._x1-lt),Ce._y2+Ce._k*(Ce._y1-At),Ce._x2,Ce._y2)}function $e(Ce,lt){this._context=Ce,this._k=(1-lt)/6}$e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ye(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,lt){switch(Ce=+Ce,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,lt):this._context.moveTo(Ce,lt);break;case 1:this._point=2,this._x1=Ce,this._y1=lt;break;case 2:this._point=3;default:Ye(this,Ce,lt)}this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var it=function Ce(lt){function At(Bt){return new $e(Bt,lt)}return At.tension=function(Bt){return Ce(+Bt)},At}(0);function ot(Ce,lt){this._context=Ce,this._k=(1-lt)/6}ot.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ce,lt){switch(Ce=+Ce,lt=+lt,this._point){case 0:this._point=1,this._x3=Ce,this._y3=lt;break;case 1:this._point=2,this._context.moveTo(this._x4=Ce,this._y4=lt);break;case 2:this._point=3,this._x5=Ce,this._y5=lt;break;default:Ye(this,Ce,lt)}this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var Et=function Ce(lt){function At(Bt){return new ot(Bt,lt)}return At.tension=function(Bt){return Ce(+Bt)},At}(0);function mt(Ce,lt){this._context=Ce,this._k=(1-lt)/6}mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,lt){switch(Ce=+Ce,lt=+lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ye(this,Ce,lt)}this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var tt=function Ce(lt){function At(Bt){return new mt(Bt,lt)}return At.tension=function(Bt){return Ce(+Bt)},At}(0);function Ke(Ce,lt,At){var Bt=Ce._x1,Ht=Ce._y1,or=Ce._x2,ar=Ce._y2;if(Ce._l01_a>1e-12){var Nt=2*Ce._l01_2a+3*Ce._l01_a*Ce._l12_a+Ce._l12_2a,nr=3*Ce._l01_a*(Ce._l01_a+Ce._l12_a);Bt=(Bt*Nt-Ce._x0*Ce._l12_2a+Ce._x2*Ce._l01_2a)/nr,Ht=(Ht*Nt-Ce._y0*Ce._l12_2a+Ce._y2*Ce._l01_2a)/nr}if(Ce._l23_a>1e-12){var Lr=2*Ce._l23_2a+3*Ce._l23_a*Ce._l12_a+Ce._l12_2a,dr=3*Ce._l23_a*(Ce._l23_a+Ce._l12_a);or=(or*Lr+Ce._x1*Ce._l23_2a-lt*Ce._l12_2a)/dr,ar=(ar*Lr+Ce._y1*Ce._l23_2a-At*Ce._l12_2a)/dr}Ce._context.bezierCurveTo(Bt,Ht,or,ar,Ce._x2,Ce._y2)}function Mt(Ce,lt){this._context=Ce,this._alpha=lt}Mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,lt){if(Ce=+Ce,lt=+lt,this._point){var At=this._x2-Ce,Bt=this._y2-lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(At*At+Bt*Bt,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,lt):this._context.moveTo(Ce,lt);break;case 1:this._point=2;break;case 2:this._point=3;default:Ke(this,Ce,lt)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var Jt=function Ce(lt){function At(Bt){return lt?new Mt(Bt,lt):new $e(Bt,0)}return At.alpha=function(Bt){return Ce(+Bt)},At}(.5);function $t(Ce,lt){this._context=Ce,this._alpha=lt}$t.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ce,lt){if(Ce=+Ce,lt=+lt,this._point){var At=this._x2-Ce,Bt=this._y2-lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(At*At+Bt*Bt,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Ce,this._y3=lt;break;case 1:this._point=2,this._context.moveTo(this._x4=Ce,this._y4=lt);break;case 2:this._point=3,this._x5=Ce,this._y5=lt;break;default:Ke(this,Ce,lt)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var je=function Ce(lt){function At(Bt){return lt?new $t(Bt,lt):new ot(Bt,0)}return At.alpha=function(Bt){return Ce(+Bt)},At}(.5);function Ge(Ce,lt){this._context=Ce,this._alpha=lt}Ge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,lt){if(Ce=+Ce,lt=+lt,this._point){var At=this._x2-Ce,Bt=this._y2-lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(At*At+Bt*Bt,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ke(this,Ce,lt)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ce,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var Ct=function Ce(lt){function At(Bt){return lt?new Ge(Bt,lt):new mt(Bt,0)}return At.alpha=function(Bt){return Ce(+Bt)},At}(.5);function Ie(Ce){this._context=Ce}function be(Ce){return Ce<0?-1:1}function Ae(Ce,lt,At){var Bt=Ce._x1-Ce._x0,Ht=lt-Ce._x1,or=(Ce._y1-Ce._y0)/(Bt||Ht<0&&-0),ar=(At-Ce._y1)/(Ht||Bt<0&&-0),Nt=(or*Ht+ar*Bt)/(Bt+Ht);return(be(or)+be(ar))*Math.min(Math.abs(or),Math.abs(ar),.5*Math.abs(Nt))||0}function Pe(Ce,lt){var At=Ce._x1-Ce._x0;return At?(3*(Ce._y1-Ce._y0)/At-lt)/2:lt}function ze(Ce,lt,At){var Bt=Ce._x0,Ht=Ce._y0,or=Ce._x1,ar=Ce._y1,Nt=(or-Bt)/3;Ce._context.bezierCurveTo(Bt+Nt,Ht+Nt*lt,or-Nt,ar-Nt*At,or,ar)}function qe(Ce){this._context=Ce}function ht(Ce){this._context=new at(Ce)}function at(Ce){this._context=Ce}function nt(Ce){this._context=Ce}function xt(Ce){var lt,At,Bt=Ce.length-1,Ht=new Array(Bt),or=new Array(Bt),ar=new Array(Bt);for(Ht[0]=0,or[0]=2,ar[0]=Ce[0]+2*Ce[1],lt=1;lt<Bt-1;++lt)Ht[lt]=1,or[lt]=4,ar[lt]=4*Ce[lt]+2*Ce[lt+1];for(Ht[Bt-1]=2,or[Bt-1]=7,ar[Bt-1]=8*Ce[Bt-1]+Ce[Bt],lt=1;lt<Bt;++lt)At=Ht[lt]/or[lt-1],or[lt]-=At,ar[lt]-=At*ar[lt-1];for(Ht[Bt-1]=ar[Bt-1]/or[Bt-1],lt=Bt-2;lt>=0;--lt)Ht[lt]=(ar[lt]-Ht[lt+1])/or[lt];for(or[Bt-1]=(Ce[Bt]+Ht[Bt-1])/2,lt=0;lt<Bt-1;++lt)or[lt]=2*Ce[lt+1]-Ht[lt+1];return[Ht,or]}function Lt(Ce,lt){this._context=Ce,this._t=lt}function bt(Ce,lt){if((Ht=Ce.length)>1)for(var At,Bt,Ht,or=1,ar=Ce[lt[0]],Nt=ar.length;or<Ht;++or)for(Bt=ar,ar=Ce[lt[or]],At=0;At<Nt;++At)ar[At][1]+=ar[At][0]=isNaN(Bt[At][1])?Bt[At][0]:Bt[At][1]}function St(Ce){for(var lt=Ce.length,At=new Array(lt);--lt>=0;)At[lt]=lt;return At}function st(Ce,lt){return Ce[lt]}function It(Ce){var lt=Ce.map(jt);return St(Ce).sort(function(At,Bt){return lt[At]-lt[Bt]})}function jt(Ce){for(var lt,At=-1,Bt=0,Ht=Ce.length,or=-1/0;++At<Ht;)(lt=+Ce[At][1])>or&&(or=lt,Bt=At);return Bt}function Ut(Ce){var lt=Ce.map(zt);return St(Ce).sort(function(At,Bt){return lt[At]-lt[Bt]})}function zt(Ce){for(var lt,At=0,Bt=-1,Ht=Ce.length;++Bt<Ht;)(lt=+Ce[Bt][1])&&(At+=lt);return At}Ie.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Ce,lt){Ce=+Ce,lt=+lt,this._point?this._context.lineTo(Ce,lt):(this._point=1,this._context.moveTo(Ce,lt))}},qe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ze(this,this._t0,Pe(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ce,lt){var At=NaN;if(lt=+lt,(Ce=+Ce)!==this._x1||lt!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,lt):this._context.moveTo(Ce,lt);break;case 1:this._point=2;break;case 2:this._point=3,ze(this,Pe(this,At=Ae(this,Ce,lt)),At);break;default:ze(this,this._t0,At=Ae(this,Ce,lt))}this._x0=this._x1,this._x1=Ce,this._y0=this._y1,this._y1=lt,this._t0=At}}},(ht.prototype=Object.create(qe.prototype)).point=function(Ce,lt){qe.prototype.point.call(this,lt,Ce)},at.prototype={moveTo:function(Ce,lt){this._context.moveTo(lt,Ce)},closePath:function(){this._context.closePath()},lineTo:function(Ce,lt){this._context.lineTo(lt,Ce)},bezierCurveTo:function(Ce,lt,At,Bt,Ht,or){this._context.bezierCurveTo(lt,Ce,Bt,At,or,Ht)}},nt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Ce=this._x,lt=this._y,At=Ce.length;if(At)if(this._line?this._context.lineTo(Ce[0],lt[0]):this._context.moveTo(Ce[0],lt[0]),At===2)this._context.lineTo(Ce[1],lt[1]);else for(var Bt=xt(Ce),Ht=xt(lt),or=0,ar=1;ar<At;++or,++ar)this._context.bezierCurveTo(Bt[0][or],Ht[0][or],Bt[1][or],Ht[1][or],Ce[ar],lt[ar]);(this._line||this._line!==0&&At===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Ce,lt){this._x.push(+Ce),this._y.push(+lt)}},Lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Ce,lt){switch(Ce=+Ce,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ce,lt):this._context.moveTo(Ce,lt);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,lt),this._context.lineTo(Ce,lt);else{var At=this._x*(1-this._t)+Ce*this._t;this._context.lineTo(At,this._y),this._context.lineTo(At,lt)}}this._x=Ce,this._y=lt}},t.arc=function(){var Ce=m,lt=y,At=p(0),Bt=null,Ht=v,or=T,ar=_,Nt=null;function nr(){var Lr,dr,Kt=+Ce.apply(this,arguments),yr=+lt.apply(this,arguments),xr=Ht.apply(this,arguments)-c,gr=or.apply(this,arguments)-c,wr=u(gr-xr),zr=gr>xr;if(Nt||(Nt=Lr=h.path()),yr<Kt&&(dr=yr,yr=Kt,Kt=dr),yr>1e-12)if(wr>f-1e-12)Nt.moveTo(yr*l(xr),yr*n(xr)),Nt.arc(0,0,yr,xr,gr,!zr),Kt>1e-12&&(Nt.moveTo(Kt*l(gr),Kt*n(gr)),Nt.arc(0,0,Kt,gr,xr,zr));else{var Rr,Wr,gn=xr,rn=gr,Zr=xr,bn=gr,Dr=wr,br=wr,Xr=ar.apply(this,arguments)/2,fn=Xr>1e-12&&(Bt?+Bt.apply(this,arguments):s(Kt*Kt+yr*yr)),Qr=a(u(yr-Kt)/2,+At.apply(this,arguments)),un=Qr,Pn=Qr;if(fn>1e-12){var kn=g(fn/Kt*n(Xr)),Hn=g(fn/yr*n(Xr));(Dr-=2*kn)>1e-12?(Zr+=kn*=zr?1:-1,bn-=kn):(Dr=0,Zr=bn=(xr+gr)/2),(br-=2*Hn)>1e-12?(gn+=Hn*=zr?1:-1,rn-=Hn):(br=0,gn=rn=(xr+gr)/2)}var aa=yr*l(gn),gt=yr*n(gn),Qt=Kt*l(bn),Zt=Kt*n(bn);if(Qr>1e-12){var pr,Mr=yr*l(rn),Vr=yr*n(rn),kr=Kt*l(Zr),ur=Kt*n(Zr);if(wr<r&&(pr=k(aa,gt,kr,ur,Mr,Vr,Qt,Zt))){var Ir=aa-pr[0],mr=gt-pr[1],_r=Mr-pr[0],Nr=Vr-pr[1],vn=1/n(d((Ir*_r+mr*Nr)/(s(Ir*Ir+mr*mr)*s(_r*_r+Nr*Nr)))/2),xn=s(pr[0]*pr[0]+pr[1]*pr[1]);un=a(Qr,(Kt-xn)/(vn-1)),Pn=a(Qr,(yr-xn)/(vn+1))}}br>1e-12?Pn>1e-12?(Rr=E(kr,ur,aa,gt,yr,Pn,zr),Wr=E(Mr,Vr,Qt,Zt,yr,Pn,zr),Nt.moveTo(Rr.cx+Rr.x01,Rr.cy+Rr.y01),Pn<Qr?Nt.arc(Rr.cx,Rr.cy,Pn,e(Rr.y01,Rr.x01),e(Wr.y01,Wr.x01),!zr):(Nt.arc(Rr.cx,Rr.cy,Pn,e(Rr.y01,Rr.x01),e(Rr.y11,Rr.x11),!zr),Nt.arc(0,0,yr,e(Rr.cy+Rr.y11,Rr.cx+Rr.x11),e(Wr.cy+Wr.y11,Wr.cx+Wr.x11),!zr),Nt.arc(Wr.cx,Wr.cy,Pn,e(Wr.y11,Wr.x11),e(Wr.y01,Wr.x01),!zr))):(Nt.moveTo(aa,gt),Nt.arc(0,0,yr,gn,rn,!zr)):Nt.moveTo(aa,gt),Kt>1e-12&&Dr>1e-12?un>1e-12?(Rr=E(Qt,Zt,Mr,Vr,Kt,-un,zr),Wr=E(aa,gt,kr,ur,Kt,-un,zr),Nt.lineTo(Rr.cx+Rr.x01,Rr.cy+Rr.y01),un<Qr?Nt.arc(Rr.cx,Rr.cy,un,e(Rr.y01,Rr.x01),e(Wr.y01,Wr.x01),!zr):(Nt.arc(Rr.cx,Rr.cy,un,e(Rr.y01,Rr.x01),e(Rr.y11,Rr.x11),!zr),Nt.arc(0,0,Kt,e(Rr.cy+Rr.y11,Rr.cx+Rr.x11),e(Wr.cy+Wr.y11,Wr.cx+Wr.x11),zr),Nt.arc(Wr.cx,Wr.cy,un,e(Wr.y11,Wr.x11),e(Wr.y01,Wr.x01),!zr))):Nt.arc(0,0,Kt,bn,Zr,zr):Nt.lineTo(Qt,Zt)}else Nt.moveTo(0,0);if(Nt.closePath(),Lr)return Nt=null,Lr+""||null}return nr.centroid=function(){var Lr=(+Ce.apply(this,arguments)+ +lt.apply(this,arguments))/2,dr=(+Ht.apply(this,arguments)+ +or.apply(this,arguments))/2-r/2;return[l(dr)*Lr,n(dr)*Lr]},nr.innerRadius=function(Lr){return arguments.length?(Ce=typeof Lr=="function"?Lr:p(+Lr),nr):Ce},nr.outerRadius=function(Lr){return arguments.length?(lt=typeof Lr=="function"?Lr:p(+Lr),nr):lt},nr.cornerRadius=function(Lr){return arguments.length?(At=typeof Lr=="function"?Lr:p(+Lr),nr):At},nr.padRadius=function(Lr){return arguments.length?(Bt=Lr==null?null:typeof Lr=="function"?Lr:p(+Lr),nr):Bt},nr.startAngle=function(Lr){return arguments.length?(Ht=typeof Lr=="function"?Lr:p(+Lr),nr):Ht},nr.endAngle=function(Lr){return arguments.length?(or=typeof Lr=="function"?Lr:p(+Lr),nr):or},nr.padAngle=function(Lr){return arguments.length?(ar=typeof Lr=="function"?Lr:p(+Lr),nr):ar},nr.context=function(Lr){return arguments.length?(Nt=Lr??null,nr):Nt},nr},t.area=S,t.areaRadial=Z,t.curveBasis=function(Ce){return new We(Ce)},t.curveBasisClosed=function(Ce){return new Qe(Ce)},t.curveBasisOpen=function(Ce){return new Oe(Ce)},t.curveBundle=Xe,t.curveCardinal=it,t.curveCardinalClosed=Et,t.curveCardinalOpen=tt,t.curveCatmullRom=Jt,t.curveCatmullRomClosed=je,t.curveCatmullRomOpen=Ct,t.curveLinear=b,t.curveLinearClosed=function(Ce){return new Ie(Ce)},t.curveMonotoneX=function(Ce){return new qe(Ce)},t.curveMonotoneY=function(Ce){return new ht(Ce)},t.curveNatural=function(Ce){return new nt(Ce)},t.curveStep=function(Ce){return new Lt(Ce,.5)},t.curveStepAfter=function(Ce){return new Lt(Ce,1)},t.curveStepBefore=function(Ce){return new Lt(Ce,0)},t.line=C,t.lineRadial=Q,t.linkHorizontal=function(){return U(G)},t.linkRadial=function(){var Ce=U(K);return Ce.angle=Ce.x,delete Ce.x,Ce.radius=Ce.y,delete Ce.y,Ce},t.linkVertical=function(){return U($)},t.pie=function(){var Ce=z,lt=P,At=null,Bt=p(0),Ht=p(f),or=p(0);function ar(Nt){var nr,Lr,dr,Kt,yr,xr=Nt.length,gr=0,wr=new Array(xr),zr=new Array(xr),Rr=+Bt.apply(this,arguments),Wr=Math.min(f,Math.max(-f,Ht.apply(this,arguments)-Rr)),gn=Math.min(Math.abs(Wr)/xr,or.apply(this,arguments)),rn=gn*(Wr<0?-1:1);for(nr=0;nr<xr;++nr)(yr=zr[wr[nr]=nr]=+Ce(Nt[nr],nr,Nt))>0&&(gr+=yr);for(lt!=null?wr.sort(function(Zr,bn){return lt(zr[Zr],zr[bn])}):At!=null&&wr.sort(function(Zr,bn){return At(Nt[Zr],Nt[bn])}),nr=0,dr=gr?(Wr-xr*rn)/gr:0;nr<xr;++nr,Rr=Kt)Lr=wr[nr],Kt=Rr+((yr=zr[Lr])>0?yr*dr:0)+rn,zr[Lr]={data:Nt[Lr],index:nr,value:yr,startAngle:Rr,endAngle:Kt,padAngle:gn};return zr}return ar.value=function(Nt){return arguments.length?(Ce=typeof Nt=="function"?Nt:p(+Nt),ar):Ce},ar.sortValues=function(Nt){return arguments.length?(lt=Nt,At=null,ar):lt},ar.sort=function(Nt){return arguments.length?(At=Nt,lt=null,ar):At},ar.startAngle=function(Nt){return arguments.length?(Bt=typeof Nt=="function"?Nt:p(+Nt),ar):Bt},ar.endAngle=function(Nt){return arguments.length?(Ht=typeof Nt=="function"?Nt:p(+Nt),ar):Ht},ar.padAngle=function(Nt){return arguments.length?(or=typeof Nt=="function"?Nt:p(+Nt),ar):or},ar},t.pointRadial=Y,t.radialArea=Z,t.radialLine=Q,t.stack=function(){var Ce=p([]),lt=St,At=bt,Bt=st;function Ht(or){var ar,Nt,nr=Ce.apply(this,arguments),Lr=or.length,dr=nr.length,Kt=new Array(dr);for(ar=0;ar<dr;++ar){for(var yr,xr=nr[ar],gr=Kt[ar]=new Array(Lr),wr=0;wr<Lr;++wr)gr[wr]=yr=[0,+Bt(or[wr],xr,wr,or)],yr.data=or[wr];gr.key=xr}for(ar=0,Nt=lt(Kt);ar<dr;++ar)Kt[Nt[ar]].index=ar;return At(Kt,Nt),Kt}return Ht.keys=function(or){return arguments.length?(Ce=typeof or=="function"?or:p(N.call(or)),Ht):Ce},Ht.value=function(or){return arguments.length?(Bt=typeof or=="function"?or:p(+or),Ht):Bt},Ht.order=function(or){return arguments.length?(lt=or==null?St:typeof or=="function"?or:p(N.call(or)),Ht):lt},Ht.offset=function(or){return arguments.length?(At=or??bt,Ht):At},Ht},t.stackOffsetDiverging=function(Ce,lt){if((Nt=Ce.length)>0)for(var At,Bt,Ht,or,ar,Nt,nr=0,Lr=Ce[lt[0]].length;nr<Lr;++nr)for(or=ar=0,At=0;At<Nt;++At)(Ht=(Bt=Ce[lt[At]][nr])[1]-Bt[0])>0?(Bt[0]=or,Bt[1]=or+=Ht):Ht<0?(Bt[1]=ar,Bt[0]=ar+=Ht):(Bt[0]=0,Bt[1]=Ht)},t.stackOffsetExpand=function(Ce,lt){if((Bt=Ce.length)>0){for(var At,Bt,Ht,or=0,ar=Ce[0].length;or<ar;++or){for(Ht=At=0;At<Bt;++At)Ht+=Ce[At][or][1]||0;if(Ht)for(At=0;At<Bt;++At)Ce[At][or][1]/=Ht}bt(Ce,lt)}},t.stackOffsetNone=bt,t.stackOffsetSilhouette=function(Ce,lt){if((At=Ce.length)>0){for(var At,Bt=0,Ht=Ce[lt[0]],or=Ht.length;Bt<or;++Bt){for(var ar=0,Nt=0;ar<At;++ar)Nt+=Ce[ar][Bt][1]||0;Ht[Bt][1]+=Ht[Bt][0]=-Nt/2}bt(Ce,lt)}},t.stackOffsetWiggle=function(Ce,lt){if((Ht=Ce.length)>0&&(Bt=(At=Ce[lt[0]]).length)>0){for(var At,Bt,Ht,or=0,ar=1;ar<Bt;++ar){for(var Nt=0,nr=0,Lr=0;Nt<Ht;++Nt){for(var dr=Ce[lt[Nt]],Kt=dr[ar][1]||0,yr=(Kt-(dr[ar-1][1]||0))/2,xr=0;xr<Nt;++xr){var gr=Ce[lt[xr]];yr+=(gr[ar][1]||0)-(gr[ar-1][1]||0)}nr+=Kt,Lr+=yr*Kt}At[ar-1][1]+=At[ar-1][0]=or,nr&&(or-=Lr/nr)}At[ar-1][1]+=At[ar-1][0]=or,bt(Ce,lt)}},t.stackOrderAppearance=It,t.stackOrderAscending=Ut,t.stackOrderDescending=function(Ce){return Ut(Ce).reverse()},t.stackOrderInsideOut=function(Ce){var lt,At,Bt=Ce.length,Ht=Ce.map(zt),or=It(Ce),ar=0,Nt=0,nr=[],Lr=[];for(lt=0;lt<Bt;++lt)At=or[lt],ar<Nt?(ar+=Ht[At],nr.push(At)):(Nt+=Ht[At],Lr.push(At));return Lr.reverse().concat(nr)},t.stackOrderNone=St,t.stackOrderReverse=function(Ce){return St(Ce).reverse()},t.symbol=function(){var Ce=p(re),lt=p(64),At=null;function Bt(){var Ht;if(At||(At=Ht=h.path()),Ce.apply(this,arguments).draw(At,+lt.apply(this,arguments)),Ht)return At=null,Ht+""||null}return Bt.type=function(Ht){return arguments.length?(Ce=typeof Ht=="function"?Ht:p(Ht),Bt):Ce},Bt.size=function(Ht){return arguments.length?(lt=typeof Ht=="function"?Ht:p(+Ht),Bt):lt},Bt.context=function(Ht){return arguments.length?(At=Ht??null,Bt):At},Bt},t.symbolCircle=re,t.symbolCross=ne,t.symbolDiamond=he,t.symbolSquare=Ee,t.symbolStar=ve,t.symbolTriangle=Te,t.symbolWye=Me,t.symbols=Se,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-path":172}],175:[function(i,B,V){(function(t,h){typeof V=="object"&&B!==void 0?h(V,i("d3-time")):h((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,h){function p(tt){if(0<=tt.y&&tt.y<100){var Ke=new Date(-1,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L);return Ke.setFullYear(tt.y),Ke}return new Date(tt.y,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L)}function u(tt){if(0<=tt.y&&tt.y<100){var Ke=new Date(Date.UTC(-1,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L));return Ke.setUTCFullYear(tt.y),Ke}return new Date(Date.UTC(tt.y,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L))}function e(tt,Ke,Mt){return{y:tt,m:Ke,d:Mt,H:0,M:0,S:0,L:0}}function l(tt){var Ke=tt.dateTime,Mt=tt.date,Jt=tt.time,$t=tt.periods,je=tt.days,Ge=tt.shortDays,Ct=tt.months,Ie=tt.shortMonths,be=d($t),Ae=g($t),Pe=d(je),ze=g(je),qe=d(Ge),ht=g(Ge),at=d(Ct),nt=g(Ct),xt=d(Ie),Lt=g(Ie),bt={a:function(zt){return Ge[zt.getDay()]},A:function(zt){return je[zt.getDay()]},b:function(zt){return Ie[zt.getMonth()]},B:function(zt){return Ct[zt.getMonth()]},c:null,d:Z,e:Z,f:U,H:Y,I:N,j:J,L:D,m:G,M:$,p:function(zt){return $t[+(zt.getHours()>=12)]},q:function(zt){return 1+~~(zt.getMonth()/3)},Q:$e,s:it,S:K,u:re,U:ne,V:ae,w:ie,W:he,x:null,X:null,y:se,Y:de,Z:ce,"%":Ye},St={a:function(zt){return Ge[zt.getUTCDay()]},A:function(zt){return je[zt.getUTCDay()]},b:function(zt){return Ie[zt.getUTCMonth()]},B:function(zt){return Ct[zt.getUTCMonth()]},c:null,d:ve,e:ve,f:fe,H:Ee,I:Le,j:Te,L:xe,m:ge,M:ke,p:function(zt){return $t[+(zt.getUTCHours()>=12)]},q:function(zt){return 1+~~(zt.getUTCMonth()/3)},Q:$e,s:it,S:Me,u:Se,U:De,V:Be,w:We,W:Qe,x:null,X:null,y:Oe,Y:Ue,Z:Xe,"%":Ye},st={a:function(zt,Ce,lt){var At=qe.exec(Ce.slice(lt));return At?(zt.w=ht[At[0].toLowerCase()],lt+At[0].length):-1},A:function(zt,Ce,lt){var At=Pe.exec(Ce.slice(lt));return At?(zt.w=ze[At[0].toLowerCase()],lt+At[0].length):-1},b:function(zt,Ce,lt){var At=xt.exec(Ce.slice(lt));return At?(zt.m=Lt[At[0].toLowerCase()],lt+At[0].length):-1},B:function(zt,Ce,lt){var At=at.exec(Ce.slice(lt));return At?(zt.m=nt[At[0].toLowerCase()],lt+At[0].length):-1},c:function(zt,Ce,lt){return Ut(zt,Ke,Ce,lt)},d:w,e:w,f:q,H:S,I:S,j:C,L:F,m:L,M:P,p:function(zt,Ce,lt){var At=be.exec(Ce.slice(lt));return At?(zt.p=Ae[At[0].toLowerCase()],lt+At[0].length):-1},q:b,Q:X,s:Q,S:z,u:y,U:v,V:T,w:m,W:_,x:function(zt,Ce,lt){return Ut(zt,Mt,Ce,lt)},X:function(zt,Ce,lt){return Ut(zt,Jt,Ce,lt)},y:E,Y:k,Z:A,"%":W};function It(zt,Ce){return function(lt){var At,Bt,Ht,or=[],ar=-1,Nt=0,nr=zt.length;for(lt instanceof Date||(lt=new Date(+lt));++ar<nr;)zt.charCodeAt(ar)===37&&(or.push(zt.slice(Nt,ar)),(Bt=a[At=zt.charAt(++ar)])!=null?At=zt.charAt(++ar):Bt=At==="e"?" ":"0",(Ht=Ce[At])&&(At=Ht(lt,Bt)),or.push(At),Nt=ar+1);return or.push(zt.slice(Nt,ar)),or.join("")}}function jt(zt,Ce){return function(lt){var At,Bt,Ht=e(1900,void 0,1);if(Ut(Ht,zt,lt+="",0)!=lt.length)return null;if("Q"in Ht)return new Date(Ht.Q);if("s"in Ht)return new Date(1e3*Ht.s+("L"in Ht?Ht.L:0));if(Ce&&!("Z"in Ht)&&(Ht.Z=0),"p"in Ht&&(Ht.H=Ht.H%12+12*Ht.p),Ht.m===void 0&&(Ht.m="q"in Ht?Ht.q:0),"V"in Ht){if(Ht.V<1||Ht.V>53)return null;"w"in Ht||(Ht.w=1),"Z"in Ht?(Bt=(At=u(e(Ht.y,0,1))).getUTCDay(),At=Bt>4||Bt===0?h.utcMonday.ceil(At):h.utcMonday(At),At=h.utcDay.offset(At,7*(Ht.V-1)),Ht.y=At.getUTCFullYear(),Ht.m=At.getUTCMonth(),Ht.d=At.getUTCDate()+(Ht.w+6)%7):(Bt=(At=p(e(Ht.y,0,1))).getDay(),At=Bt>4||Bt===0?h.timeMonday.ceil(At):h.timeMonday(At),At=h.timeDay.offset(At,7*(Ht.V-1)),Ht.y=At.getFullYear(),Ht.m=At.getMonth(),Ht.d=At.getDate()+(Ht.w+6)%7)}else("W"in Ht||"U"in Ht)&&("w"in Ht||(Ht.w="u"in Ht?Ht.u%7:"W"in Ht?1:0),Bt="Z"in Ht?u(e(Ht.y,0,1)).getUTCDay():p(e(Ht.y,0,1)).getDay(),Ht.m=0,Ht.d="W"in Ht?(Ht.w+6)%7+7*Ht.W-(Bt+5)%7:Ht.w+7*Ht.U-(Bt+6)%7);return"Z"in Ht?(Ht.H+=Ht.Z/100|0,Ht.M+=Ht.Z%100,u(Ht)):p(Ht)}}function Ut(zt,Ce,lt,At){for(var Bt,Ht,or=0,ar=Ce.length,Nt=lt.length;or<ar;){if(At>=Nt)return-1;if((Bt=Ce.charCodeAt(or++))===37){if(Bt=Ce.charAt(or++),!(Ht=st[Bt in a?Ce.charAt(or++):Bt])||(At=Ht(zt,lt,At))<0)return-1}else if(Bt!=lt.charCodeAt(At++))return-1}return At}return bt.x=It(Mt,bt),bt.X=It(Jt,bt),bt.c=It(Ke,bt),St.x=It(Mt,St),St.X=It(Jt,St),St.c=It(Ke,St),{format:function(zt){var Ce=It(zt+="",bt);return Ce.toString=function(){return zt},Ce},parse:function(zt){var Ce=jt(zt+="",!1);return Ce.toString=function(){return zt},Ce},utcFormat:function(zt){var Ce=It(zt+="",St);return Ce.toString=function(){return zt},Ce},utcParse:function(zt){var Ce=jt(zt+="",!0);return Ce.toString=function(){return zt},Ce}}}var o,a={"-":"",_:" ",0:"0"},n=/^\s*\d+/,s=/^%/,r=/[\\^$*+?|[\]().{}]/g;function c(tt,Ke,Mt){var Jt=tt<0?"-":"",$t=(Jt?-tt:tt)+"",je=$t.length;return Jt+(je<Mt?new Array(Mt-je+1).join(Ke)+$t:$t)}function f(tt){return tt.replace(r,"\\$&")}function d(tt){return new RegExp("^(?:"+tt.map(f).join("|")+")","i")}function g(tt){for(var Ke={},Mt=-1,Jt=tt.length;++Mt<Jt;)Ke[tt[Mt].toLowerCase()]=Mt;return Ke}function m(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+1));return Jt?(tt.w=+Jt[0],Mt+Jt[0].length):-1}function y(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+1));return Jt?(tt.u=+Jt[0],Mt+Jt[0].length):-1}function v(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+2));return Jt?(tt.U=+Jt[0],Mt+Jt[0].length):-1}function T(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+2));return Jt?(tt.V=+Jt[0],Mt+Jt[0].length):-1}function _(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+2));return Jt?(tt.W=+Jt[0],Mt+Jt[0].length):-1}function k(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+4));return Jt?(tt.y=+Jt[0],Mt+Jt[0].length):-1}function E(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+2));return Jt?(tt.y=+Jt[0]+(+Jt[0]>68?1900:2e3),Mt+Jt[0].length):-1}function A(tt,Ke,Mt){var Jt=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(Ke.slice(Mt,Mt+6));return Jt?(tt.Z=Jt[1]?0:-(Jt[2]+(Jt[3]||"00")),Mt+Jt[0].length):-1}function b(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+1));return Jt?(tt.q=3*Jt[0]-3,Mt+Jt[0].length):-1}function L(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+2));return Jt?(tt.m=Jt[0]-1,Mt+Jt[0].length):-1}function w(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+2));return Jt?(tt.d=+Jt[0],Mt+Jt[0].length):-1}function C(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+3));return Jt?(tt.m=0,tt.d=+Jt[0],Mt+Jt[0].length):-1}function S(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+2));return Jt?(tt.H=+Jt[0],Mt+Jt[0].length):-1}function P(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+2));return Jt?(tt.M=+Jt[0],Mt+Jt[0].length):-1}function z(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+2));return Jt?(tt.S=+Jt[0],Mt+Jt[0].length):-1}function F(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+3));return Jt?(tt.L=+Jt[0],Mt+Jt[0].length):-1}function q(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt,Mt+6));return Jt?(tt.L=Math.floor(Jt[0]/1e3),Mt+Jt[0].length):-1}function W(tt,Ke,Mt){var Jt=s.exec(Ke.slice(Mt,Mt+1));return Jt?Mt+Jt[0].length:-1}function X(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt));return Jt?(tt.Q=+Jt[0],Mt+Jt[0].length):-1}function Q(tt,Ke,Mt){var Jt=n.exec(Ke.slice(Mt));return Jt?(tt.s=+Jt[0],Mt+Jt[0].length):-1}function Z(tt,Ke){return c(tt.getDate(),Ke,2)}function Y(tt,Ke){return c(tt.getHours(),Ke,2)}function N(tt,Ke){return c(tt.getHours()%12||12,Ke,2)}function J(tt,Ke){return c(1+h.timeDay.count(h.timeYear(tt),tt),Ke,3)}function D(tt,Ke){return c(tt.getMilliseconds(),Ke,3)}function U(tt,Ke){return D(tt,Ke)+"000"}function G(tt,Ke){return c(tt.getMonth()+1,Ke,2)}function $(tt,Ke){return c(tt.getMinutes(),Ke,2)}function K(tt,Ke){return c(tt.getSeconds(),Ke,2)}function re(tt){var Ke=tt.getDay();return Ke===0?7:Ke}function ne(tt,Ke){return c(h.timeSunday.count(h.timeYear(tt)-1,tt),Ke,2)}function ae(tt,Ke){var Mt=tt.getDay();return tt=Mt>=4||Mt===0?h.timeThursday(tt):h.timeThursday.ceil(tt),c(h.timeThursday.count(h.timeYear(tt),tt)+(h.timeYear(tt).getDay()===4),Ke,2)}function ie(tt){return tt.getDay()}function he(tt,Ke){return c(h.timeMonday.count(h.timeYear(tt)-1,tt),Ke,2)}function se(tt,Ke){return c(tt.getFullYear()%100,Ke,2)}function de(tt,Ke){return c(tt.getFullYear()%1e4,Ke,4)}function ce(tt){var Ke=tt.getTimezoneOffset();return(Ke>0?"-":(Ke*=-1,"+"))+c(Ke/60|0,"0",2)+c(Ke%60,"0",2)}function ve(tt,Ke){return c(tt.getUTCDate(),Ke,2)}function Ee(tt,Ke){return c(tt.getUTCHours(),Ke,2)}function Le(tt,Ke){return c(tt.getUTCHours()%12||12,Ke,2)}function Te(tt,Ke){return c(1+h.utcDay.count(h.utcYear(tt),tt),Ke,3)}function xe(tt,Ke){return c(tt.getUTCMilliseconds(),Ke,3)}function fe(tt,Ke){return xe(tt,Ke)+"000"}function ge(tt,Ke){return c(tt.getUTCMonth()+1,Ke,2)}function ke(tt,Ke){return c(tt.getUTCMinutes(),Ke,2)}function Me(tt,Ke){return c(tt.getUTCSeconds(),Ke,2)}function Se(tt){var Ke=tt.getUTCDay();return Ke===0?7:Ke}function De(tt,Ke){return c(h.utcSunday.count(h.utcYear(tt)-1,tt),Ke,2)}function Be(tt,Ke){var Mt=tt.getUTCDay();return tt=Mt>=4||Mt===0?h.utcThursday(tt):h.utcThursday.ceil(tt),c(h.utcThursday.count(h.utcYear(tt),tt)+(h.utcYear(tt).getUTCDay()===4),Ke,2)}function We(tt){return tt.getUTCDay()}function Qe(tt,Ke){return c(h.utcMonday.count(h.utcYear(tt)-1,tt),Ke,2)}function Oe(tt,Ke){return c(tt.getUTCFullYear()%100,Ke,2)}function Ue(tt,Ke){return c(tt.getUTCFullYear()%1e4,Ke,4)}function Xe(){return"+0000"}function Ye(){return"%"}function $e(tt){return+tt}function it(tt){return Math.floor(+tt/1e3)}function ot(tt){return o=l(tt),t.timeFormat=o.format,t.timeParse=o.parse,t.utcFormat=o.utcFormat,t.utcParse=o.utcParse,o}ot({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Et=Date.prototype.toISOString?function(tt){return tt.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),mt=+new Date("2000-01-01T00:00:00.000Z")?function(tt){var Ke=new Date(tt);return isNaN(Ke)?null:Ke}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");t.isoFormat=Et,t.isoParse=mt,t.timeFormatDefaultLocale=ot,t.timeFormatLocale=l,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-time":176}],176:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:(t=t||self).d3=t.d3||{})})(this,function(t){var h=new Date,p=new Date;function u(ge,ke,Me,Se){function De(Be){return ge(Be=arguments.length===0?new Date:new Date(+Be)),Be}return De.floor=function(Be){return ge(Be=new Date(+Be)),Be},De.ceil=function(Be){return ge(Be=new Date(Be-1)),ke(Be,1),ge(Be),Be},De.round=function(Be){var We=De(Be),Qe=De.ceil(Be);return Be-We<Qe-Be?We:Qe},De.offset=function(Be,We){return ke(Be=new Date(+Be),We==null?1:Math.floor(We)),Be},De.range=function(Be,We,Qe){var Oe,Ue=[];if(Be=De.ceil(Be),Qe=Qe==null?1:Math.floor(Qe),!(Be<We&&Qe>0))return Ue;do Ue.push(Oe=new Date(+Be)),ke(Be,Qe),ge(Be);while(Oe<Be&&Be<We);return Ue},De.filter=function(Be){return u(function(We){if(We>=We)for(;ge(We),!Be(We);)We.setTime(We-1)},function(We,Qe){if(We>=We)if(Qe<0)for(;++Qe<=0;)for(;ke(We,-1),!Be(We););else for(;--Qe>=0;)for(;ke(We,1),!Be(We););})},Me&&(De.count=function(Be,We){return h.setTime(+Be),p.setTime(+We),ge(h),ge(p),Math.floor(Me(h,p))},De.every=function(Be){return Be=Math.floor(Be),isFinite(Be)&&Be>0?Be>1?De.filter(Se?function(We){return Se(We)%Be==0}:function(We){return De.count(0,We)%Be==0}):De:null}),De}var e=u(function(){},function(ge,ke){ge.setTime(+ge+ke)},function(ge,ke){return ke-ge});e.every=function(ge){return ge=Math.floor(ge),isFinite(ge)&&ge>0?ge>1?u(function(ke){ke.setTime(Math.floor(ke/ge)*ge)},function(ke,Me){ke.setTime(+ke+Me*ge)},function(ke,Me){return(Me-ke)/ge}):e:null};var l=e.range,o=u(function(ge){ge.setTime(ge-ge.getMilliseconds())},function(ge,ke){ge.setTime(+ge+1e3*ke)},function(ge,ke){return(ke-ge)/1e3},function(ge){return ge.getUTCSeconds()}),a=o.range,n=u(function(ge){ge.setTime(ge-ge.getMilliseconds()-1e3*ge.getSeconds())},function(ge,ke){ge.setTime(+ge+6e4*ke)},function(ge,ke){return(ke-ge)/6e4},function(ge){return ge.getMinutes()}),s=n.range,r=u(function(ge){ge.setTime(ge-ge.getMilliseconds()-1e3*ge.getSeconds()-6e4*ge.getMinutes())},function(ge,ke){ge.setTime(+ge+36e5*ke)},function(ge,ke){return(ke-ge)/36e5},function(ge){return ge.getHours()}),c=r.range,f=u(function(ge){ge.setHours(0,0,0,0)},function(ge,ke){ge.setDate(ge.getDate()+ke)},function(ge,ke){return(ke-ge-6e4*(ke.getTimezoneOffset()-ge.getTimezoneOffset()))/864e5},function(ge){return ge.getDate()-1}),d=f.range;function g(ge){return u(function(ke){ke.setDate(ke.getDate()-(ke.getDay()+7-ge)%7),ke.setHours(0,0,0,0)},function(ke,Me){ke.setDate(ke.getDate()+7*Me)},function(ke,Me){return(Me-ke-6e4*(Me.getTimezoneOffset()-ke.getTimezoneOffset()))/6048e5})}var m=g(0),y=g(1),v=g(2),T=g(3),_=g(4),k=g(5),E=g(6),A=m.range,b=y.range,L=v.range,w=T.range,C=_.range,S=k.range,P=E.range,z=u(function(ge){ge.setDate(1),ge.setHours(0,0,0,0)},function(ge,ke){ge.setMonth(ge.getMonth()+ke)},function(ge,ke){return ke.getMonth()-ge.getMonth()+12*(ke.getFullYear()-ge.getFullYear())},function(ge){return ge.getMonth()}),F=z.range,q=u(function(ge){ge.setMonth(0,1),ge.setHours(0,0,0,0)},function(ge,ke){ge.setFullYear(ge.getFullYear()+ke)},function(ge,ke){return ke.getFullYear()-ge.getFullYear()},function(ge){return ge.getFullYear()});q.every=function(ge){return isFinite(ge=Math.floor(ge))&&ge>0?u(function(ke){ke.setFullYear(Math.floor(ke.getFullYear()/ge)*ge),ke.setMonth(0,1),ke.setHours(0,0,0,0)},function(ke,Me){ke.setFullYear(ke.getFullYear()+Me*ge)}):null};var W=q.range,X=u(function(ge){ge.setUTCSeconds(0,0)},function(ge,ke){ge.setTime(+ge+6e4*ke)},function(ge,ke){return(ke-ge)/6e4},function(ge){return ge.getUTCMinutes()}),Q=X.range,Z=u(function(ge){ge.setUTCMinutes(0,0,0)},function(ge,ke){ge.setTime(+ge+36e5*ke)},function(ge,ke){return(ke-ge)/36e5},function(ge){return ge.getUTCHours()}),Y=Z.range,N=u(function(ge){ge.setUTCHours(0,0,0,0)},function(ge,ke){ge.setUTCDate(ge.getUTCDate()+ke)},function(ge,ke){return(ke-ge)/864e5},function(ge){return ge.getUTCDate()-1}),J=N.range;function D(ge){return u(function(ke){ke.setUTCDate(ke.getUTCDate()-(ke.getUTCDay()+7-ge)%7),ke.setUTCHours(0,0,0,0)},function(ke,Me){ke.setUTCDate(ke.getUTCDate()+7*Me)},function(ke,Me){return(Me-ke)/6048e5})}var U=D(0),G=D(1),$=D(2),K=D(3),re=D(4),ne=D(5),ae=D(6),ie=U.range,he=G.range,se=$.range,de=K.range,ce=re.range,ve=ne.range,Ee=ae.range,Le=u(function(ge){ge.setUTCDate(1),ge.setUTCHours(0,0,0,0)},function(ge,ke){ge.setUTCMonth(ge.getUTCMonth()+ke)},function(ge,ke){return ke.getUTCMonth()-ge.getUTCMonth()+12*(ke.getUTCFullYear()-ge.getUTCFullYear())},function(ge){return ge.getUTCMonth()}),Te=Le.range,xe=u(function(ge){ge.setUTCMonth(0,1),ge.setUTCHours(0,0,0,0)},function(ge,ke){ge.setUTCFullYear(ge.getUTCFullYear()+ke)},function(ge,ke){return ke.getUTCFullYear()-ge.getUTCFullYear()},function(ge){return ge.getUTCFullYear()});xe.every=function(ge){return isFinite(ge=Math.floor(ge))&&ge>0?u(function(ke){ke.setUTCFullYear(Math.floor(ke.getUTCFullYear()/ge)*ge),ke.setUTCMonth(0,1),ke.setUTCHours(0,0,0,0)},function(ke,Me){ke.setUTCFullYear(ke.getUTCFullYear()+Me*ge)}):null};var fe=xe.range;t.timeDay=f,t.timeDays=d,t.timeFriday=k,t.timeFridays=S,t.timeHour=r,t.timeHours=c,t.timeInterval=u,t.timeMillisecond=e,t.timeMilliseconds=l,t.timeMinute=n,t.timeMinutes=s,t.timeMonday=y,t.timeMondays=b,t.timeMonth=z,t.timeMonths=F,t.timeSaturday=E,t.timeSaturdays=P,t.timeSecond=o,t.timeSeconds=a,t.timeSunday=m,t.timeSundays=A,t.timeThursday=_,t.timeThursdays=C,t.timeTuesday=v,t.timeTuesdays=L,t.timeWednesday=T,t.timeWednesdays=w,t.timeWeek=m,t.timeWeeks=A,t.timeYear=q,t.timeYears=W,t.utcDay=N,t.utcDays=J,t.utcFriday=ne,t.utcFridays=ve,t.utcHour=Z,t.utcHours=Y,t.utcMillisecond=e,t.utcMilliseconds=l,t.utcMinute=X,t.utcMinutes=Q,t.utcMonday=G,t.utcMondays=he,t.utcMonth=Le,t.utcMonths=Te,t.utcSaturday=ae,t.utcSaturdays=Ee,t.utcSecond=o,t.utcSeconds=a,t.utcSunday=U,t.utcSundays=ie,t.utcThursday=re,t.utcThursdays=ce,t.utcTuesday=$,t.utcTuesdays=se,t.utcWednesday=K,t.utcWednesdays=de,t.utcWeek=U,t.utcWeeks=ie,t.utcYear=xe,t.utcYears=fe,Object.defineProperty(t,"__esModule",{value:!0})})},{}],177:[function(i,B,V){arguments[4][176][0].apply(V,arguments)},{dup:176}],178:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:(t=t||self).d3=t.d3||{})})(this,function(t){var h,p,u=0,e=0,l=0,o=0,a=0,n=0,s=typeof performance=="object"&&performance.now?performance:Date,r=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(_){setTimeout(_,17)};function c(){return a||(r(f),a=s.now()+n)}function f(){a=0}function d(){this._call=this._time=this._next=null}function g(_,k,E){var A=new d;return A.restart(_,k,E),A}function m(){c(),++u;for(var _,k=h;k;)(_=a-k._time)>=0&&k._call.call(null,_),k=k._next;--u}function y(){a=(o=s.now())+n,u=e=0;try{m()}finally{u=0,function(){for(var _,k,E=h,A=1/0;E;)E._call?(A>E._time&&(A=E._time),_=E,E=E._next):(k=E._next,E._next=null,E=_?_._next=k:h=k);p=_,T(A)}(),a=0}}function v(){var _=s.now(),k=_-o;k>1e3&&(n-=k,o=_)}function T(_){u||(e&&(e=clearTimeout(e)),_-a>24?(_<1/0&&(e=setTimeout(y,_-s.now()-n)),l&&(l=clearInterval(l))):(l||(o=s.now(),l=setInterval(v,1e3)),u=1,r(y)))}d.prototype=g.prototype={constructor:d,restart:function(_,k,E){if(typeof _!="function")throw new TypeError("callback is not a function");E=(E==null?c():+E)+(k==null?0:+k),this._next||p===this||(p?p._next=this:h=this,p=this),this._call=_,this._time=E,T()},stop:function(){this._call&&(this._call=null,this._time=1/0,T())}},t.interval=function(_,k,E){var A=new d,b=k;return k==null?(A.restart(_,k,E),A):(k=+k,E=E==null?c():+E,A.restart(function L(w){w+=b,A.restart(L,b+=k,E),_(w)},k,E),A)},t.now=c,t.timeout=function(_,k,E){var A=new d;return k=k==null?0:+k,A.restart(function(b){A.stop(),_(b+k)},k,E),A},t.timer=g,t.timerFlush=m,Object.defineProperty(t,"__esModule",{value:!0})})},{}],179:[function(i,B,V){B.exports=function(){for(var t=0;t<arguments.length;t++)if(arguments[t]!==void 0)return arguments[t]}},{}],180:[function(i,B,V){var t=i("incremental-convex-hull"),h=i("uniq");function p(e,l){this.point=e,this.index=l}function u(e,l){for(var o=e.point,a=l.point,n=o.length,s=0;s<n;++s){var r=a[s]-o[s];if(r)return r}return 0}B.exports=function(e,l){var o=e.length;if(o===0)return[];var a=e[0].length;if(a<1)return[];if(a===1)return function(A,b,L){if(A===1)return L?[[-1,0]]:[];var w=b.map(function(F,q){return[F[0],q]});w.sort(function(F,q){return F[0]-q[0]});for(var C=new Array(A-1),S=1;S<A;++S){var P=w[S-1],z=w[S];C[S-1]=[P[1],z[1]]}return L&&C.push([-1,C[0][1]],[C[A-1][1],-1]),C}(o,e,l);for(var n=new Array(o),s=1,r=0;r<o;++r){for(var c=e[r],f=new Array(a+1),d=0,g=0;g<a;++g){var m=c[g];f[g]=m,d+=m*m}f[a]=d,n[r]=new p(f,r),s=Math.max(d,s)}h(n,u),o=n.length;var y=new Array(o+a+1),v=new Array(o+a+1),T=(a+1)*(a+1)*s,_=new Array(a+1);for(r=0;r<=a;++r)_[r]=0;for(_[a]=T,y[0]=_.slice(),v[0]=-1,r=0;r<=a;++r)(f=_.slice())[r]=1,y[r+1]=f,v[r+1]=-1;for(r=0;r<o;++r){var k=n[r];y[r+a+1]=k.point,v[r+a+1]=k.index}var E=t(y,!1);if(E=l?E.filter(function(A){for(var b=0,L=0;L<=a;++L){var w=v[A[L]];if(w<0&&++b>=2)return!1;A[L]=w}return!0}):E.filter(function(A){for(var b=0;b<=a;++b){var L=v[A[b]];if(L<0)return!1;A[b]=L}return!0}),1&a)for(r=0;r<E.length;++r)f=(k=E[r])[0],k[0]=k[1],k[1]=f;return E}},{"incremental-convex-hull":446,uniq:619}],181:[function(i,B,V){B.exports=p;var t=(p.canvas=document.createElement("canvas")).getContext("2d"),h=u([32,126]);function p(e,l){Array.isArray(e)&&(e=e.join(", "));var o,a={},n=16,s=.05;l&&(l.length===2&&typeof l[0]=="number"?o=u(l):Array.isArray(l)?o=l:(l.o?o=u(l.o):l.pairs&&(o=l.pairs),l.fontSize&&(n=l.fontSize),l.threshold!=null&&(s=l.threshold))),o||(o=h),t.font=n+"px "+e;for(var r=0;r<o.length;r++){var c=o[r],f=t.measureText(c[0]).width+t.measureText(c[1]).width,d=t.measureText(c).width;if(Math.abs(f-d)>n*s){var g=(d-f)/n;a[c]=1e3*g}}return a}function u(e){for(var l=[],o=e[0];o<=e[1];o++)for(var a=String.fromCharCode(o),n=e[0];n<e[1];n++){var s=a+String.fromCharCode(n);l.push(s)}return l}p.createPairs=u,p.ascii=h},{}],182:[function(i,B,V){(function(t){(function(){var h=!1;if(typeof Float64Array<"u"){var p=new Float64Array(1),u=new Uint32Array(p.buffer);p[0]=1,h=!0,u[1]===1072693248?(B.exports=function(l){return p[0]=l,[u[0],u[1]]},B.exports.pack=function(l,o){return u[0]=l,u[1]=o,p[0]},B.exports.lo=function(l){return p[0]=l,u[0]},B.exports.hi=function(l){return p[0]=l,u[1]}):u[0]===1072693248?(B.exports=function(l){return p[0]=l,[u[1],u[0]]},B.exports.pack=function(l,o){return u[1]=l,u[0]=o,p[0]},B.exports.lo=function(l){return p[0]=l,u[1]},B.exports.hi=function(l){return p[0]=l,u[0]}):h=!1}if(!h){var e=new t(8);B.exports=function(l){return e.writeDoubleLE(l,0,!0),[e.readUInt32LE(0,!0),e.readUInt32LE(4,!0)]},B.exports.pack=function(l,o){return e.writeUInt32LE(l,0,!0),e.writeUInt32LE(o,4,!0),e.readDoubleLE(0,!0)},B.exports.lo=function(l){return e.writeDoubleLE(l,0,!0),e.readUInt32LE(0,!0)},B.exports.hi=function(l){return e.writeDoubleLE(l,0,!0),e.readUInt32LE(4,!0)}}B.exports.sign=function(l){return B.exports.hi(l)>>>31},B.exports.exponent=function(l){return(B.exports.hi(l)<<1>>>21)-1023},B.exports.fraction=function(l){var o=B.exports.lo(l),a=B.exports.hi(l),n=1048575&a;return 2146435072&a&&(n+=1<<20),[o,n]},B.exports.denormalized=function(l){return!(2146435072&B.exports.hi(l))}}).call(this)}).call(this,i("buffer").Buffer)},{buffer:117}],183:[function(i,B,V){var t=i("abs-svg-path"),h=i("normalize-svg-path"),p={M:"moveTo",C:"bezierCurveTo"};B.exports=function(u,e){u.beginPath(),h(t(e)).forEach(function(l){var o=l[0],a=l.slice(1);u[p[o]].apply(u,a)}),u.closePath()}},{"abs-svg-path":71,"normalize-svg-path":485}],184:[function(i,B,V){B.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],185:[function(i,B,V){B.exports=function(t,h){switch(h===void 0&&(h=0),typeof t){case"number":if(t>0)return function(p,u){var e,l;for(e=new Array(p),l=0;l<p;++l)e[l]=u;return e}(0|t,h);break;case"object":if(typeof t.length=="number")return function p(u,e,l){var o=0|u[l];if(o<=0)return[];var a,n=new Array(o);if(l===u.length-1)for(a=0;a<o;++a)n[a]=e;else for(a=0;a<o;++a)n[a]=p(u,e,l+1);return n}(t,h,0)}return[]}},{}],186:[function(i,B,V){function t(C,S,P){P=P||2;var z,F,q,W,X,Q,Z,Y=S&&S.length,N=Y?S[0]*P:C.length,J=h(C,0,N,P,!0),D=[];if(!J||J.next===J.prev)return D;if(Y&&(J=function(G,$,K,re){var ne,ae,ie,he,se,de=[];for(ne=0,ae=$.length;ne<ae;ne++)ie=$[ne]*re,he=ne<ae-1?$[ne+1]*re:G.length,(se=h(G,ie,he,re,!1))===se.next&&(se.steiner=!0),de.push(f(se));for(de.sort(n),ne=0;ne<de.length;ne++)s(de[ne],K),K=p(K,K.next);return K}(C,S,J,P)),C.length>80*P){z=q=C[0],F=W=C[1];for(var U=P;U<N;U+=P)(X=C[U])<z&&(z=X),(Q=C[U+1])<F&&(F=Q),X>q&&(q=X),Q>W&&(W=Q);Z=(Z=Math.max(q-z,W-F))!==0?1/Z:0}return u(J,D,P,z,F,Z),D}function h(C,S,P,z,F){var q,W;if(F===w(C,S,P,z)>0)for(q=S;q<P;q+=z)W=A(q,C[q],C[q+1],W);else for(q=P-z;q>=S;q-=z)W=A(q,C[q],C[q+1],W);return W&&y(W,W.next)&&(b(W),W=W.next),W}function p(C,S){if(!C)return C;S||(S=C);var P,z=C;do if(P=!1,z.steiner||!y(z,z.next)&&m(z.prev,z,z.next)!==0)z=z.next;else{if(b(z),(z=S=z.prev)===z.next)break;P=!0}while(P||z!==S);return S}function u(C,S,P,z,F,q,W){if(C){!W&&q&&function(Y,N,J,D){var U=Y;do U.z===null&&(U.z=c(U.x,U.y,N,J,D)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==Y);U.prevZ.nextZ=null,U.prevZ=null,function(G){var $,K,re,ne,ae,ie,he,se,de=1;do{for(K=G,G=null,ae=null,ie=0;K;){for(ie++,re=K,he=0,$=0;$<de&&(he++,re=re.nextZ);$++);for(se=de;he>0||se>0&&re;)he!==0&&(se===0||!re||K.z<=re.z)?(ne=K,K=K.nextZ,he--):(ne=re,re=re.nextZ,se--),ae?ae.nextZ=ne:G=ne,ne.prevZ=ae,ae=ne;K=re}ae.nextZ=null,de*=2}while(ie>1)}(U)}(C,z,F,q);for(var X,Q,Z=C;C.prev!==C.next;)if(X=C.prev,Q=C.next,q?l(C,z,F,q):e(C))S.push(X.i/P),S.push(C.i/P),S.push(Q.i/P),b(C),C=Q.next,Z=Q.next;else if((C=Q)===Z){W?W===1?u(C=o(p(C),S,P),S,P,z,F,q,2):W===2&&a(C,S,P,z,F,q):u(p(C),S,P,z,F,q,1);break}}}function e(C){var S=C.prev,P=C,z=C.next;if(m(S,P,z)>=0)return!1;for(var F=C.next.next;F!==C.prev;){if(d(S.x,S.y,P.x,P.y,z.x,z.y,F.x,F.y)&&m(F.prev,F,F.next)>=0)return!1;F=F.next}return!0}function l(C,S,P,z){var F=C.prev,q=C,W=C.next;if(m(F,q,W)>=0)return!1;for(var X=F.x<q.x?F.x<W.x?F.x:W.x:q.x<W.x?q.x:W.x,Q=F.y<q.y?F.y<W.y?F.y:W.y:q.y<W.y?q.y:W.y,Z=F.x>q.x?F.x>W.x?F.x:W.x:q.x>W.x?q.x:W.x,Y=F.y>q.y?F.y>W.y?F.y:W.y:q.y>W.y?q.y:W.y,N=c(X,Q,S,P,z),J=c(Z,Y,S,P,z),D=C.prevZ,U=C.nextZ;D&&D.z>=N&&U&&U.z<=J;){if(D!==C.prev&&D!==C.next&&d(F.x,F.y,q.x,q.y,W.x,W.y,D.x,D.y)&&m(D.prev,D,D.next)>=0||(D=D.prevZ,U!==C.prev&&U!==C.next&&d(F.x,F.y,q.x,q.y,W.x,W.y,U.x,U.y)&&m(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;D&&D.z>=N;){if(D!==C.prev&&D!==C.next&&d(F.x,F.y,q.x,q.y,W.x,W.y,D.x,D.y)&&m(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;U&&U.z<=J;){if(U!==C.prev&&U!==C.next&&d(F.x,F.y,q.x,q.y,W.x,W.y,U.x,U.y)&&m(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function o(C,S,P){var z=C;do{var F=z.prev,q=z.next.next;!y(F,q)&&v(F,z,z.next,q)&&k(F,q)&&k(q,F)&&(S.push(F.i/P),S.push(z.i/P),S.push(q.i/P),b(z),b(z.next),z=C=q),z=z.next}while(z!==C);return p(z)}function a(C,S,P,z,F,q){var W=C;do{for(var X=W.next.next;X!==W.prev;){if(W.i!==X.i&&g(W,X)){var Q=E(W,X);return W=p(W,W.next),Q=p(Q,Q.next),u(W,S,P,z,F,q),void u(Q,S,P,z,F,q)}X=X.next}W=W.next}while(W!==C)}function n(C,S){return C.x-S.x}function s(C,S){if(S=function(z,F){var q,W=F,X=z.x,Q=z.y,Z=-1/0;do{if(Q<=W.y&&Q>=W.next.y&&W.next.y!==W.y){var Y=W.x+(Q-W.y)*(W.next.x-W.x)/(W.next.y-W.y);if(Y<=X&&Y>Z){if(Z=Y,Y===X){if(Q===W.y)return W;if(Q===W.next.y)return W.next}q=W.x<W.next.x?W:W.next}}W=W.next}while(W!==F);if(!q)return null;if(X===Z)return q;var N,J=q,D=q.x,U=q.y,G=1/0;W=q;do X>=W.x&&W.x>=D&&X!==W.x&&d(Q<U?X:Z,Q,D,U,Q<U?Z:X,Q,W.x,W.y)&&(N=Math.abs(Q-W.y)/(X-W.x),k(W,z)&&(N<G||N===G&&(W.x>q.x||W.x===q.x&&r(q,W)))&&(q=W,G=N)),W=W.next;while(W!==J);return q}(C,S)){var P=E(S,C);p(S,S.next),p(P,P.next)}}function r(C,S){return m(C.prev,C,S.prev)<0&&m(S.next,C,C.next)<0}function c(C,S,P,z,F){return(C=1431655765&((C=858993459&((C=252645135&((C=16711935&((C=32767*(C-P)*F)|C<<8))|C<<4))|C<<2))|C<<1))|(S=1431655765&((S=858993459&((S=252645135&((S=16711935&((S=32767*(S-z)*F)|S<<8))|S<<4))|S<<2))|S<<1))<<1}function f(C){var S=C,P=C;do(S.x<P.x||S.x===P.x&&S.y<P.y)&&(P=S),S=S.next;while(S!==C);return P}function d(C,S,P,z,F,q,W,X){return(F-W)*(S-X)-(C-W)*(q-X)>=0&&(C-W)*(z-X)-(P-W)*(S-X)>=0&&(P-W)*(q-X)-(F-W)*(z-X)>=0}function g(C,S){return C.next.i!==S.i&&C.prev.i!==S.i&&!function(P,z){var F=P;do{if(F.i!==P.i&&F.next.i!==P.i&&F.i!==z.i&&F.next.i!==z.i&&v(F,F.next,P,z))return!0;F=F.next}while(F!==P);return!1}(C,S)&&(k(C,S)&&k(S,C)&&function(P,z){var F=P,q=!1,W=(P.x+z.x)/2,X=(P.y+z.y)/2;do F.y>X!=F.next.y>X&&F.next.y!==F.y&&W<(F.next.x-F.x)*(X-F.y)/(F.next.y-F.y)+F.x&&(q=!q),F=F.next;while(F!==P);return q}(C,S)&&(m(C.prev,C,S.prev)||m(C,S.prev,S))||y(C,S)&&m(C.prev,C,C.next)>0&&m(S.prev,S,S.next)>0)}function m(C,S,P){return(S.y-C.y)*(P.x-S.x)-(S.x-C.x)*(P.y-S.y)}function y(C,S){return C.x===S.x&&C.y===S.y}function v(C,S,P,z){var F=_(m(C,S,P)),q=_(m(C,S,z)),W=_(m(P,z,C)),X=_(m(P,z,S));return F!==q&&W!==X||!(F!==0||!T(C,P,S))||!(q!==0||!T(C,z,S))||!(W!==0||!T(P,C,z))||!(X!==0||!T(P,S,z))}function T(C,S,P){return S.x<=Math.max(C.x,P.x)&&S.x>=Math.min(C.x,P.x)&&S.y<=Math.max(C.y,P.y)&&S.y>=Math.min(C.y,P.y)}function _(C){return C>0?1:C<0?-1:0}function k(C,S){return m(C.prev,C,C.next)<0?m(C,S,C.next)>=0&&m(C,C.prev,S)>=0:m(C,S,C.prev)<0||m(C,C.next,S)<0}function E(C,S){var P=new L(C.i,C.x,C.y),z=new L(S.i,S.x,S.y),F=C.next,q=S.prev;return C.next=S,S.prev=C,P.next=F,F.prev=P,z.next=P,P.prev=z,q.next=z,z.prev=q,z}function A(C,S,P,z){var F=new L(C,S,P);return z?(F.next=z.next,F.prev=z,z.next.prev=F,z.next=F):(F.prev=F,F.next=F),F}function b(C){C.next.prev=C.prev,C.prev.next=C.next,C.prevZ&&(C.prevZ.nextZ=C.nextZ),C.nextZ&&(C.nextZ.prevZ=C.prevZ)}function L(C,S,P){this.i=C,this.x=S,this.y=P,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function w(C,S,P,z){for(var F=0,q=S,W=P-z;q<P;q+=z)F+=(C[W]-C[q])*(C[q+1]+C[W+1]),W=q;return F}B.exports=t,B.exports.default=t,t.deviation=function(C,S,P,z){var F=S&&S.length,q=F?S[0]*P:C.length,W=Math.abs(w(C,0,q,P));if(F)for(var X=0,Q=S.length;X<Q;X++){var Z=S[X]*P,Y=X<Q-1?S[X+1]*P:C.length;W-=Math.abs(w(C,Z,Y,P))}var N=0;for(X=0;X<z.length;X+=3){var J=z[X]*P,D=z[X+1]*P,U=z[X+2]*P;N+=Math.abs((C[J]-C[U])*(C[D+1]-C[J+1])-(C[J]-C[D])*(C[U+1]-C[J+1]))}return W===0&&N===0?0:Math.abs((N-W)/W)},t.flatten=function(C){for(var S=C[0][0].length,P={vertices:[],holes:[],dimensions:S},z=0,F=0;F<C.length;F++){for(var q=0;q<C[F].length;q++)for(var W=0;W<S;W++)P.vertices.push(C[F][q][W]);F>0&&(z+=C[F-1].length,P.holes.push(z))}return P}},{}],187:[function(i,B,V){B.exports=function(h,p){var u=h.length;if(typeof p!="number"){p=0;for(var e=0;e<u;++e){var l=h[e];p=Math.max(p,l[0],l[1])}p=1+(0|p)}p|=0;var o=new Array(p);for(e=0;e<p;++e)o[e]=[];for(e=0;e<u;++e)l=h[e],o[l[0]].push(l[1]),o[l[1]].push(l[0]);for(var a=0;a<p;++a)t(o[a],function(n,s){return n-s});return o};var t=i("uniq")},{uniq:619}],188:[function(i,B,V){var t=i("strongly-connected-components");B.exports=function(h,p){var u,e=[],l=[],o=[],a={},n=[];function s(v){var T,_,k=!1;for(l.push(v),o[v]=!0,T=0;T<n[v].length;T++)(_=n[v][T])===u?(r(u,l),k=!0):o[_]||(k=s(_));if(k)(function A(b){o[b]=!1,a.hasOwnProperty(b)&&Object.keys(a[b]).forEach(function(L){delete a[b][L],o[L]&&A(L)})})(v);else for(T=0;T<n[v].length;T++){_=n[v][T];var E=a[_];E||(E={},a[_]=E),E[_]=!0}return l.pop(),k}function r(v,T){var _=[].concat(T).concat(v);p?p(s):e.push(_)}function c(v){(function(L){for(var w=0;w<h.length;w++)w<L&&(h[w]=[]),h[w]=h[w].filter(function(C){return C>=L})})(v);for(var T,_=t(h).components.filter(function(L){return L.length>1}),k=1/0,E=0;E<_.length;E++)for(var A=0;A<_[E].length;A++)_[E][A]<k&&(k=_[E][A],T=E);var b=_[T];return!!b&&{leastVertex:k,adjList:h.map(function(L,w){return b.indexOf(w)===-1?[]:L.filter(function(C){return b.indexOf(C)!==-1})})}}u=0;for(var f=h.length;u<f;){var d=c(u);if(u=d.leastVertex,n=d.adjList){for(var g=0;g<n.length;g++)for(var m=0;m<n[g].length;m++){var y=n[g][m];o[+y]=!1,a[y]={}}s(u),u+=1}else u=f}return p?void 0:e}},{"strongly-connected-components":590}],189:[function(i,B,V){var t=i("../../object/valid-value");B.exports=function(){return t(this).length=0,this}},{"../../object/valid-value":220}],190:[function(i,B,V){B.exports=i("./is-implemented")()?Array.from:i("./shim")},{"./is-implemented":191,"./shim":192}],191:[function(i,B,V){B.exports=function(){var t,h,p=Array.from;return typeof p=="function"&&(h=p(t=["raz","dwa"]),!!(h&&h!==t&&h[1]==="dwa"))}},{}],192:[function(i,B,V){var t=i("es6-symbol").iterator,h=i("../../function/is-arguments"),p=i("../../function/is-function"),u=i("../../number/to-pos-integer"),e=i("../../object/valid-callable"),l=i("../../object/valid-value"),o=i("../../object/is-value"),a=i("../../string/is-string"),n=Array.isArray,s=Function.prototype.call,r={configurable:!0,enumerable:!0,writable:!0,value:null},c=Object.defineProperty;B.exports=function(f){var d,g,m,y,v,T,_,k,E,A,b=arguments[1],L=arguments[2];if(f=Object(l(f)),o(b)&&e(b),this&&this!==Array&&p(this))d=this;else{if(!b){if(h(f))return(v=f.length)!==1?Array.apply(null,f):((y=new Array(1))[0]=f[0],y);if(n(f)){for(y=new Array(v=f.length),g=0;g<v;++g)y[g]=f[g];return y}}y=[]}if(!n(f)){if((E=f[t])!==void 0){for(_=e(E).call(f),d&&(y=new d),k=_.next(),g=0;!k.done;)A=b?s.call(b,L,k.value,g):k.value,d?(r.value=A,c(y,g,r)):y[g]=A,k=_.next(),++g;v=g}else if(a(f)){for(v=f.length,d&&(y=new d),g=0,m=0;g<v;++g)A=f[g],g+1<v&&(T=A.charCodeAt(0))>=55296&&T<=56319&&(A+=f[++g]),A=b?s.call(b,L,A,m):A,d?(r.value=A,c(y,m,r)):y[m]=A,++m;v=m}}if(v===void 0)for(v=u(f.length),d&&(y=new d(v)),g=0;g<v;++g)A=b?s.call(b,L,f[g],g):f[g],d?(r.value=A,c(y,g,r)):y[g]=A;return d&&(r.value=null,y.length=v),y}},{"../../function/is-arguments":193,"../../function/is-function":194,"../../number/to-pos-integer":200,"../../object/is-value":209,"../../object/valid-callable":218,"../../object/valid-value":220,"../../string/is-string":224,"es6-symbol":233}],193:[function(i,B,V){var t=Object.prototype.toString,h=t.call(function(){return arguments}());B.exports=function(p){return t.call(p)===h}},{}],194:[function(i,B,V){var t=Object.prototype.toString,h=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);B.exports=function(p){return typeof p=="function"&&h(t.call(p))}},{}],195:[function(i,B,V){B.exports=function(){}},{}],196:[function(i,B,V){B.exports=i("./is-implemented")()?Math.sign:i("./shim")},{"./is-implemented":197,"./shim":198}],197:[function(i,B,V){B.exports=function(){var t=Math.sign;return typeof t=="function"&&t(10)===1&&t(-20)===-1}},{}],198:[function(i,B,V){B.exports=function(t){return t=Number(t),isNaN(t)||t===0?t:t>0?1:-1}},{}],199:[function(i,B,V){var t=i("../math/sign"),h=Math.abs,p=Math.floor;B.exports=function(u){return isNaN(u)?0:(u=Number(u))!==0&&isFinite(u)?t(u)*p(h(u)):u}},{"../math/sign":196}],200:[function(i,B,V){var t=i("./to-integer"),h=Math.max;B.exports=function(p){return h(0,t(p))}},{"./to-integer":199}],201:[function(i,B,V){var t=i("./valid-callable"),h=i("./valid-value"),p=Function.prototype.bind,u=Function.prototype.call,e=Object.keys,l=Object.prototype.propertyIsEnumerable;B.exports=function(o,a){return function(n,s){var r,c=arguments[2],f=arguments[3];return n=Object(h(n)),t(s),r=e(n),f&&r.sort(typeof f=="function"?p.call(f,n):void 0),typeof o!="function"&&(o=r[o]),u.call(o,r,function(d,g){return l.call(n,d)?u.call(s,c,n[d],d,n,g):a})}}},{"./valid-callable":218,"./valid-value":220}],202:[function(i,B,V){B.exports=i("./is-implemented")()?Object.assign:i("./shim")},{"./is-implemented":203,"./shim":204}],203:[function(i,B,V){B.exports=function(){var t,h=Object.assign;return typeof h=="function"&&(h(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},{}],204:[function(i,B,V){var t=i("../keys"),h=i("../valid-value"),p=Math.max;B.exports=function(u,e){var l,o,a,n=p(arguments.length,2);for(u=Object(h(u)),a=function(s){try{u[s]=e[s]}catch(r){l||(l=r)}},o=1;o<n;++o)t(e=arguments[o]).forEach(a);if(l!==void 0)throw l;return u}},{"../keys":210,"../valid-value":220}],205:[function(i,B,V){var t=i("../array/from"),h=i("./assign"),p=i("./valid-value");B.exports=function(u){var e=Object(p(u)),l=arguments[1],o=Object(arguments[2]);if(e!==u&&!l)return e;var a={};return l?t(l,function(n){(o.ensure||n in u)&&(a[n]=u[n])}):h(a,u),a}},{"../array/from":190,"./assign":202,"./valid-value":220}],206:[function(i,B,V){var t,h,p,u,e=Object.create;i("./set-prototype-of/is-implemented")()||(t=i("./set-prototype-of/shim")),B.exports=t?t.level!==1?e:(h={},p={},u={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(l){p[l]=l!=="__proto__"?u:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(h,p),Object.defineProperty(t,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:h}),function(l,o){return e(l===null?h:l,o)}):e},{"./set-prototype-of/is-implemented":216,"./set-prototype-of/shim":217}],207:[function(i,B,V){B.exports=i("./_iterate")("forEach")},{"./_iterate":201}],208:[function(i,B,V){var t=i("./is-value"),h={function:!0,object:!0};B.exports=function(p){return t(p)&&h[typeof p]||!1}},{"./is-value":209}],209:[function(i,B,V){var t=i("../function/noop")();B.exports=function(h){return h!==t&&h!==null}},{"../function/noop":195}],210:[function(i,B,V){B.exports=i("./is-implemented")()?Object.keys:i("./shim")},{"./is-implemented":211,"./shim":212}],211:[function(i,B,V){B.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],212:[function(i,B,V){var t=i("../is-value"),h=Object.keys;B.exports=function(p){return h(t(p)?Object(p):p)}},{"../is-value":209}],213:[function(i,B,V){var t=i("./valid-callable"),h=i("./for-each"),p=Function.prototype.call;B.exports=function(u,e){var l={},o=arguments[2];return t(e),h(u,function(a,n,s,r){l[n]=p.call(e,o,a,n,s,r)}),l}},{"./for-each":207,"./valid-callable":218}],214:[function(i,B,V){var t=i("./is-value"),h=Array.prototype.forEach,p=Object.create,u=function(e,l){var o;for(o in e)l[o]=e[o]};B.exports=function(e){var l=p(null);return h.call(arguments,function(o){t(o)&&u(Object(o),l)}),l}},{"./is-value":209}],215:[function(i,B,V){B.exports=i("./is-implemented")()?Object.setPrototypeOf:i("./shim")},{"./is-implemented":216,"./shim":217}],216:[function(i,B,V){var t=Object.create,h=Object.getPrototypeOf,p={};B.exports=function(){var u=Object.setPrototypeOf,e=arguments[0]||t;return typeof u=="function"&&h(u(e(null),p))===p}},{}],217:[function(i,B,V){var t,h=i("../is-object"),p=i("../valid-value"),u=Object.prototype.isPrototypeOf,e=Object.defineProperty,l={configurable:!0,enumerable:!1,writable:!0,value:void 0};t=function(o,a){if(p(o),a===null||h(a))return o;throw new TypeError("Prototype must be null or an object")},B.exports=function(o){var a,n;return o?(o.level===2?o.set?(n=o.set,a=function(s,r){return n.call(t(s,r),r),s}):a=function(s,r){return t(s,r).__proto__=r,s}:a=function s(r,c){var f;return t(r,c),(f=u.call(s.nullPolyfill,r))&&delete s.nullPolyfill.__proto__,c===null&&(c=s.nullPolyfill),r.__proto__=c,f&&e(s.nullPolyfill,"__proto__",l),r},Object.defineProperty(a,"level",{configurable:!1,enumerable:!1,writable:!1,value:o.level})):null}(function(){var o,a=Object.create(null),n={},s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(s){try{(o=s.set).call(a,n)}catch{}if(Object.getPrototypeOf(a)===n)return{set:o,level:2}}return a.__proto__=n,Object.getPrototypeOf(a)===n?{level:2}:((a={}).__proto__=n,Object.getPrototypeOf(a)===n&&{level:1})}()),i("../create")},{"../create":206,"../is-object":208,"../valid-value":220}],218:[function(i,B,V){B.exports=function(t){if(typeof t!="function")throw new TypeError(t+" is not a function");return t}},{}],219:[function(i,B,V){var t=i("./is-object");B.exports=function(h){if(!t(h))throw new TypeError(h+" is not an Object");return h}},{"./is-object":208}],220:[function(i,B,V){var t=i("./is-value");B.exports=function(h){if(!t(h))throw new TypeError("Cannot use null or undefined");return h}},{"./is-value":209}],221:[function(i,B,V){B.exports=i("./is-implemented")()?String.prototype.contains:i("./shim")},{"./is-implemented":222,"./shim":223}],222:[function(i,B,V){var t="razdwatrzy";B.exports=function(){return typeof t.contains=="function"&&t.contains("dwa")===!0&&t.contains("foo")===!1}},{}],223:[function(i,B,V){var t=String.prototype.indexOf;B.exports=function(h){return t.call(this,h,arguments[1])>-1}},{}],224:[function(i,B,V){var t=Object.prototype.toString,h=t.call("");B.exports=function(p){return typeof p=="string"||p&&typeof p=="object"&&(p instanceof String||t.call(p)===h)||!1}},{}],225:[function(i,B,V){var t=Object.create(null),h=Math.random;B.exports=function(){var p;do p=h().toString(36).slice(2);while(t[p]);return p}},{}],226:[function(i,B,V){var t,h=i("es5-ext/object/set-prototype-of"),p=i("es5-ext/string/#/contains"),u=i("d"),e=i("es6-symbol"),l=i("./"),o=Object.defineProperty;t=B.exports=function(a,n){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");l.call(this,a),n=n?p.call(n,"key+value")?"key+value":p.call(n,"key")?"key":"value":"value",o(this,"__kind__",u("",n))},h&&h(t,l),delete t.prototype.constructor,t.prototype=Object.create(l.prototype,{_resolve:u(function(a){return this.__kind__==="value"?this.__list__[a]:this.__kind__==="key+value"?[a,this.__list__[a]]:a})}),o(t.prototype,e.toStringTag,u("c","Array Iterator"))},{"./":229,d:161,"es5-ext/object/set-prototype-of":215,"es5-ext/string/#/contains":221,"es6-symbol":233}],227:[function(i,B,V){var t=i("es5-ext/function/is-arguments"),h=i("es5-ext/object/valid-callable"),p=i("es5-ext/string/is-string"),u=i("./get"),e=Array.isArray,l=Function.prototype.call,o=Array.prototype.some;B.exports=function(a,n){var s,r,c,f,d,g,m,y,v=arguments[2];if(e(a)||t(a)?s="array":p(a)?s="string":a=u(a),h(n),c=function(){f=!0},s!=="array")if(s!=="string")for(r=a.next();!r.done;){if(l.call(n,v,r.value,c),f)return;r=a.next()}else for(g=a.length,d=0;d<g&&(m=a[d],d+1<g&&(y=m.charCodeAt(0))>=55296&&y<=56319&&(m+=a[++d]),l.call(n,v,m,c),!f);++d);else o.call(a,function(T){return l.call(n,v,T,c),f})}},{"./get":228,"es5-ext/function/is-arguments":193,"es5-ext/object/valid-callable":218,"es5-ext/string/is-string":224}],228:[function(i,B,V){var t=i("es5-ext/function/is-arguments"),h=i("es5-ext/string/is-string"),p=i("./array"),u=i("./string"),e=i("./valid-iterable"),l=i("es6-symbol").iterator;B.exports=function(o){return typeof e(o)[l]=="function"?o[l]():t(o)?new p(o):h(o)?new u(o):new p(o)}},{"./array":226,"./string":231,"./valid-iterable":232,"es5-ext/function/is-arguments":193,"es5-ext/string/is-string":224,"es6-symbol":233}],229:[function(i,B,V){var t,h=i("es5-ext/array/#/clear"),p=i("es5-ext/object/assign"),u=i("es5-ext/object/valid-callable"),e=i("es5-ext/object/valid-value"),l=i("d"),o=i("d/auto-bind"),a=i("es6-symbol"),n=Object.defineProperty,s=Object.defineProperties;B.exports=t=function(r,c){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");s(this,{__list__:l("w",e(r)),__context__:l("w",c),__nextIndex__:l("w",0)}),c&&(u(c.on),c.on("_add",this._onAdd),c.on("_delete",this._onDelete),c.on("_clear",this._onClear))},delete t.prototype.constructor,s(t.prototype,p({_next:l(function(){var r;if(this.__list__)return this.__redo__&&(r=this.__redo__.shift())!==void 0?r:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:l(function(){return this._createResult(this._next())}),_createResult:l(function(r){return r===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(r)}}),_resolve:l(function(r){return this.__list__[r]}),_unBind:l(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:l(function(){return"[object "+(this[a.toStringTag]||"Object")+"]"})},o({_onAdd:l(function(r){r>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(c,f){c>=r&&(this.__redo__[f]=++c)},this),this.__redo__.push(r)):n(this,"__redo__",l("c",[r])))}),_onDelete:l(function(r){var c;r>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&((c=this.__redo__.indexOf(r))!==-1&&this.__redo__.splice(c,1),this.__redo__.forEach(function(f,d){f>r&&(this.__redo__[d]=--f)},this)))}),_onClear:l(function(){this.__redo__&&h.call(this.__redo__),this.__nextIndex__=0})}))),n(t.prototype,a.iterator,l(function(){return this}))},{d:161,"d/auto-bind":160,"es5-ext/array/#/clear":189,"es5-ext/object/assign":202,"es5-ext/object/valid-callable":218,"es5-ext/object/valid-value":220,"es6-symbol":233}],230:[function(i,B,V){var t=i("es5-ext/function/is-arguments"),h=i("es5-ext/object/is-value"),p=i("es5-ext/string/is-string"),u=i("es6-symbol").iterator,e=Array.isArray;B.exports=function(l){return!!h(l)&&(!!e(l)||!!p(l)||!!t(l)||typeof l[u]=="function")}},{"es5-ext/function/is-arguments":193,"es5-ext/object/is-value":209,"es5-ext/string/is-string":224,"es6-symbol":233}],231:[function(i,B,V){var t,h=i("es5-ext/object/set-prototype-of"),p=i("d"),u=i("es6-symbol"),e=i("./"),l=Object.defineProperty;t=B.exports=function(o){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");o=String(o),e.call(this,o),l(this,"__length__",p("",o.length))},h&&h(t,e),delete t.prototype.constructor,t.prototype=Object.create(e.prototype,{_next:p(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:p(function(o){var a,n=this.__list__[o];return this.__nextIndex__===this.__length__?n:(a=n.charCodeAt(0))>=55296&&a<=56319?n+this.__list__[this.__nextIndex__++]:n})}),l(t.prototype,u.toStringTag,p("c","String Iterator"))},{"./":229,d:161,"es5-ext/object/set-prototype-of":215,"es6-symbol":233}],232:[function(i,B,V){var t=i("./is-iterable");B.exports=function(h){if(!t(h))throw new TypeError(h+" is not iterable");return h}},{"./is-iterable":230}],233:[function(i,B,V){B.exports=i("./is-implemented")()?i("ext/global-this").Symbol:i("./polyfill")},{"./is-implemented":234,"./polyfill":239,"ext/global-this":246}],234:[function(i,B,V){var t=i("ext/global-this"),h={object:!0,symbol:!0};B.exports=function(){var p,u=t.Symbol;if(typeof u!="function")return!1;p=u("test symbol");try{String(p)}catch{return!1}return!!h[typeof u.iterator]&&!!h[typeof u.toPrimitive]&&!!h[typeof u.toStringTag]}},{"ext/global-this":246}],235:[function(i,B,V){B.exports=function(t){return!!t&&(typeof t=="symbol"||!!t.constructor&&t.constructor.name==="Symbol"&&t[t.constructor.toStringTag]==="Symbol")}},{}],236:[function(i,B,V){var t=i("d"),h=Object.create,p=Object.defineProperty,u=Object.prototype,e=h(null);B.exports=function(l){for(var o,a,n=0;e[l+(n||"")];)++n;return e[l+=n||""]=!0,p(u,o="@@"+l,t.gs(null,function(s){a||(a=!0,p(this,o,t(s)),a=!1)})),o}},{d:161}],237:[function(i,B,V){var t=i("d"),h=i("ext/global-this").Symbol;B.exports=function(p){return Object.defineProperties(p,{hasInstance:t("",h&&h.hasInstance||p("hasInstance")),isConcatSpreadable:t("",h&&h.isConcatSpreadable||p("isConcatSpreadable")),iterator:t("",h&&h.iterator||p("iterator")),match:t("",h&&h.match||p("match")),replace:t("",h&&h.replace||p("replace")),search:t("",h&&h.search||p("search")),species:t("",h&&h.species||p("species")),split:t("",h&&h.split||p("split")),toPrimitive:t("",h&&h.toPrimitive||p("toPrimitive")),toStringTag:t("",h&&h.toStringTag||p("toStringTag")),unscopables:t("",h&&h.unscopables||p("unscopables"))})}},{d:161,"ext/global-this":246}],238:[function(i,B,V){var t=i("d"),h=i("../../../validate-symbol"),p=Object.create(null);B.exports=function(u){return Object.defineProperties(u,{for:t(function(e){return p[e]?p[e]:p[e]=u(String(e))}),keyFor:t(function(e){var l;for(l in h(e),p)if(p[l]===e)return l})})}},{"../../../validate-symbol":240,d:161}],239:[function(i,B,V){var t,h,p,u=i("d"),e=i("./validate-symbol"),l=i("ext/global-this").Symbol,o=i("./lib/private/generate-name"),a=i("./lib/private/setup/standard-symbols"),n=i("./lib/private/setup/symbol-registry"),s=Object.create,r=Object.defineProperties,c=Object.defineProperty;if(typeof l=="function")try{String(l()),p=!0}catch{}else l=null;h=function(f){if(this instanceof h)throw new TypeError("Symbol is not a constructor");return t(f)},B.exports=t=function f(d){var g;if(this instanceof f)throw new TypeError("Symbol is not a constructor");return p?l(d):(g=s(h.prototype),d=d===void 0?"":String(d),r(g,{__description__:u("",d),__name__:u("",o(d))}))},a(t),n(t),r(h.prototype,{constructor:u(t),toString:u("",function(){return this.__name__})}),r(t.prototype,{toString:u(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:u(function(){return e(this)})}),c(t.prototype,t.toPrimitive,u("",function(){var f=e(this);return typeof f=="symbol"?f:f.toString()})),c(t.prototype,t.toStringTag,u("c","Symbol")),c(h.prototype,t.toStringTag,u("c",t.prototype[t.toStringTag])),c(h.prototype,t.toPrimitive,u("c",t.prototype[t.toPrimitive]))},{"./lib/private/generate-name":236,"./lib/private/setup/standard-symbols":237,"./lib/private/setup/symbol-registry":238,"./validate-symbol":240,d:161,"ext/global-this":246}],240:[function(i,B,V){var t=i("./is-symbol");B.exports=function(h){if(!t(h))throw new TypeError(h+" is not a symbol");return h}},{"./is-symbol":235}],241:[function(i,B,V){B.exports=i("./is-implemented")()?WeakMap:i("./polyfill")},{"./is-implemented":242,"./polyfill":244}],242:[function(i,B,V){B.exports=function(){var t,h;if(typeof WeakMap!="function")return!1;try{t=new WeakMap([[h={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return String(t)==="[object WeakMap]"&&typeof t.set=="function"&&t.set({},1)===t&&typeof t.delete=="function"&&typeof t.has=="function"&&t.get(h)==="one"}},{}],243:[function(i,B,V){B.exports=typeof WeakMap=="function"&&Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"},{}],244:[function(i,B,V){var t,h=i("es5-ext/object/is-value"),p=i("es5-ext/object/set-prototype-of"),u=i("es5-ext/object/valid-object"),e=i("es5-ext/object/valid-value"),l=i("es5-ext/string/random-uniq"),o=i("d"),a=i("es6-iterator/get"),n=i("es6-iterator/for-of"),s=i("es6-symbol").toStringTag,r=i("./is-native-implemented"),c=Array.isArray,f=Object.defineProperty,d=Object.prototype.hasOwnProperty,g=Object.getPrototypeOf;B.exports=t=function(){var m,y=arguments[0];if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");return m=r&&p&&WeakMap!==t?p(new WeakMap,g(this)):this,h(y)&&(c(y)||(y=a(y))),f(m,"__weakMapData__",o("c","$weakMap$"+l())),y&&n(y,function(v){e(v),m.set(v[0],v[1])}),m},r&&(p&&p(t,WeakMap),t.prototype=Object.create(WeakMap.prototype,{constructor:o(t)})),Object.defineProperties(t.prototype,{delete:o(function(m){return!!d.call(u(m),this.__weakMapData__)&&(delete m[this.__weakMapData__],!0)}),get:o(function(m){if(d.call(u(m),this.__weakMapData__))return m[this.__weakMapData__]}),has:o(function(m){return d.call(u(m),this.__weakMapData__)}),set:o(function(m,y){return f(u(m),this.__weakMapData__,o("c",y)),this}),toString:o(function(){return"[object WeakMap]"})}),f(t.prototype,s,o("c","WeakMap"))},{"./is-native-implemented":243,d:161,"es5-ext/object/is-value":209,"es5-ext/object/set-prototype-of":215,"es5-ext/object/valid-object":219,"es5-ext/object/valid-value":220,"es5-ext/string/random-uniq":225,"es6-iterator/for-of":227,"es6-iterator/get":228,"es6-symbol":233}],245:[function(i,B,V){var t=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};B.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},{}],246:[function(i,B,V){B.exports=i("./is-implemented")()?globalThis:i("./implementation")},{"./implementation":245,"./is-implemented":247}],247:[function(i,B,V){B.exports=function(){return typeof globalThis=="object"&&!!globalThis&&globalThis.Array===Array}},{}],248:[function(i,B,V){B.exports=function(t,h,p){var u=h||0,e=p||1;return[[t[12]+t[0],t[13]+t[1],t[14]+t[2],t[15]+t[3]],[t[12]-t[0],t[13]-t[1],t[14]-t[2],t[15]-t[3]],[t[12]+t[4],t[13]+t[5],t[14]+t[6],t[15]+t[7]],[t[12]-t[4],t[13]-t[5],t[14]-t[6],t[15]-t[7]],[u*t[12]+t[8],u*t[13]+t[9],u*t[14]+t[10],u*t[15]+t[11]],[e*t[12]-t[8],e*t[13]-t[9],e*t[14]-t[10],e*t[15]-t[11]]]}},{}],249:[function(i,B,V){var t=i("is-string-blank");B.exports=function(h){var p=typeof h;if(p==="string"){var u=h;if((h=+h)==0&&t(u))return!1}else if(p!=="number")return!1;return h-h<1}},{"is-string-blank":458}],250:[function(i,B,V){B.exports=function(o,a,n){switch(arguments.length){case 0:return new u([0],[0],0);case 1:return typeof o=="number"?new u(s=l(o),s,0):new u(o,l(o.length),0);case 2:if(typeof a=="number"){var s=l(o.length);return new u(o,s,+a)}n=0;case 3:if(o.length!==a.length)throw new Error("state and velocity lengths must match");return new u(o,a,n)}};var t=i("cubic-hermite"),h=i("binary-search-bounds");function p(o,a,n){return Math.min(a,Math.max(o,n))}function u(o,a,n){this.dimension=o.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var s=0;s<this.dimension;++s)this.bounds[0][s]=-1/0,this.bounds[1][s]=1/0;this._state=o.slice().reverse(),this._velocity=a.slice().reverse(),this._time=[n],this._scratch=[o.slice(),o.slice(),o.slice(),o.slice(),o.slice()]}var e=u.prototype;function l(o){for(var a=new Array(o),n=0;n<o;++n)a[n]=0;return a}e.flush=function(o){var a=h.gt(this._time,o)-1;a<=0||(this._time.splice(0,a),this._state.splice(0,a*this.dimension),this._velocity.splice(0,a*this.dimension))},e.curve=function(o){var a=this._time,n=a.length,s=h.le(a,o),r=this._scratch[0],c=this._state,f=this._velocity,d=this.dimension,g=this.bounds;if(s<0)for(var m=d-1,y=0;y<d;++y,--m)r[y]=c[m];else if(s>=n-1){m=c.length-1;var v=o-a[n-1];for(y=0;y<d;++y,--m)r[y]=c[m]+v*f[m]}else{m=d*(s+1)-1;var T=a[s],_=a[s+1]-T||1,k=this._scratch[1],E=this._scratch[2],A=this._scratch[3],b=this._scratch[4],L=!0;for(y=0;y<d;++y,--m)k[y]=c[m],A[y]=f[m]*_,E[y]=c[m+d],b[y]=f[m+d]*_,L=L&&k[y]===E[y]&&A[y]===b[y]&&A[y]===0;if(L)for(y=0;y<d;++y)r[y]=k[y];else t(k,A,E,b,(o-T)/_,r)}var w=g[0],C=g[1];for(y=0;y<d;++y)r[y]=p(w[y],C[y],r[y]);return r},e.dcurve=function(o){var a=this._time,n=a.length,s=h.le(a,o),r=this._scratch[0],c=this._state,f=this._velocity,d=this.dimension;if(s>=n-1)for(var g=c.length-1,m=(a[n-1],0);m<d;++m,--g)r[m]=f[g];else{g=d*(s+1)-1;var y=a[s],v=a[s+1]-y||1,T=this._scratch[1],_=this._scratch[2],k=this._scratch[3],E=this._scratch[4],A=!0;for(m=0;m<d;++m,--g)T[m]=c[g],k[m]=f[g]*v,_[m]=c[g+d],E[m]=f[g+d]*v,A=A&&T[m]===_[m]&&k[m]===E[m]&&k[m]===0;if(A)for(m=0;m<d;++m)r[m]=0;else for(t.derivative(T,k,_,E,(o-y)/v,r),m=0;m<d;++m)r[m]/=v}return r},e.lastT=function(){var o=this._time;return o[o.length-1]},e.stable=function(){for(var o=this._velocity,a=o.length,n=this.dimension-1;n>=0;--n)if(o[--a])return!1;return!0},e.jump=function(o){var a=this.lastT(),n=this.dimension;if(!(o<a||arguments.length!==n+1)){var s=this._state,r=this._velocity,c=s.length-this.dimension,f=this.bounds,d=f[0],g=f[1];this._time.push(a,o);for(var m=0;m<2;++m)for(var y=0;y<n;++y)s.push(s[c++]),r.push(0);for(this._time.push(o),y=n;y>0;--y)s.push(p(d[y-1],g[y-1],arguments[y])),r.push(0)}},e.push=function(o){var a=this.lastT(),n=this.dimension;if(!(o<a||arguments.length!==n+1)){var s=this._state,r=this._velocity,c=s.length-this.dimension,f=o-a,d=this.bounds,g=d[0],m=d[1],y=f>1e-6?1/f:0;this._time.push(o);for(var v=n;v>0;--v){var T=p(g[v-1],m[v-1],arguments[v]);s.push(T),r.push((T-s[c++])*y)}}},e.set=function(o){var a=this.dimension;if(!(o<this.lastT()||arguments.length!==a+1)){var n=this._state,s=this._velocity,r=this.bounds,c=r[0],f=r[1];this._time.push(o);for(var d=a;d>0;--d)n.push(p(c[d-1],f[d-1],arguments[d])),s.push(0)}},e.move=function(o){var a=this.lastT(),n=this.dimension;if(!(o<=a||arguments.length!==n+1)){var s=this._state,r=this._velocity,c=s.length-this.dimension,f=this.bounds,d=f[0],g=f[1],m=o-a,y=m>1e-6?1/m:0;this._time.push(o);for(var v=n;v>0;--v){var T=arguments[v];s.push(p(d[v-1],g[v-1],s[c++]+T)),r.push(T*y)}}},e.idle=function(o){var a=this.lastT();if(!(o<a)){var n=this.dimension,s=this._state,r=this._velocity,c=s.length-n,f=this.bounds,d=f[0],g=f[1],m=o-a;this._time.push(o);for(var y=n-1;y>=0;--y)s.push(p(d[y],g[y],s[c]+m*r[c])),r.push(0),c+=1}}},{"binary-search-bounds":251,"cubic-hermite":156}],251:[function(i,B,V){function t(p,u,e,l,o,a){var n=["function ",p,"(a,l,h,",l.join(","),"){",a?"":"var i=",e?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",o?".get(m)":"[m]"];return a?u.indexOf("c")<0?n.push(";if(x===y){return m}else if(x<=y){"):n.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):n.push(";if(",u,"){i=m;"),e?n.push("l=m+1}else{h=m-1}"):n.push("h=m-1}else{l=m+1}"),n.push("}"),a?n.push("return -1};"):n.push("return i};"),n.join("")}function h(p,u,e,l){return new Function([t("A","x"+p+"y",u,["y"],!1,l),t("B","x"+p+"y",u,["y"],!0,l),t("P","c(x,y)"+p+"0",u,["y","c"],!1,l),t("Q","c(x,y)"+p+"0",u,["y","c"],!0,l),"function dispatchBsearch",e,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",e].join(""))()}B.exports={ge:h(">=",!1,"GE"),gt:h(">",!1,"GT"),lt:h("<",!0,"LT"),le:h("<=",!0,"LE"),eq:h("-",!0,"EQ",!0)}},{}],252:[function(i,B,V){var t=i("dtype");B.exports=function(h,p,u){if(!h)throw new TypeError("must specify data as first parameter");if(u=0|+(u||0),Array.isArray(h)&&h[0]&&typeof h[0][0]=="number"){var e,l,o,a,n=h[0].length,s=h.length*n;p&&typeof p!="string"||(p=new(t(p||"float32"))(s+u));var r=p.length-u;if(s!==r)throw new Error("source length "+s+" ("+n+"x"+h.length+") does not match destination length "+r);for(e=0,o=u;e<h.length;e++)for(l=0;l<n;l++)p[o++]=h[e][l]===null?NaN:h[e][l]}else if(p&&typeof p!="string")p.set(h,u);else{var c=t(p||"float32");if(Array.isArray(h)||p==="array")for(p=new c(h.length+u),e=0,o=u,a=p.length;o<a;o++,e++)p[o]=h[e]===null?NaN:h[e];else u===0?p=new c(h):(p=new c(h.length+u)).set(h,u)}return p}},{dtype:184}],253:[function(i,B,V){var t=i("css-font/stringify"),h=[32,126];B.exports=function(p){var u=(p=p||{}).shape?p.shape:p.canvas?[p.canvas.width,p.canvas.height]:[512,512],e=p.canvas||document.createElement("canvas"),l=p.font,o=typeof p.step=="number"?[p.step,p.step]:p.step||[32,32],a=p.chars||h;if(l&&typeof l!="string"&&(l=t(l)),Array.isArray(a)){if(a.length===2&&typeof a[0]=="number"&&typeof a[1]=="number"){for(var n=[],s=a[0],r=0;s<=a[1];s++)n[r++]=String.fromCharCode(s);a=n}}else a=String(a).split("");u=u.slice(),e.width=u[0],e.height=u[1];var c=e.getContext("2d");c.fillStyle="#000",c.fillRect(0,0,e.width,e.height),c.font=l,c.textAlign="center",c.textBaseline="middle",c.fillStyle="#fff";var f=o[0]/2,d=o[1]/2;for(s=0;s<a.length;s++)c.fillText(a[s],f,d),(f+=o[0])>u[0]-o[0]/2&&(f=o[0]/2,d+=o[1]);return e}},{"css-font/stringify":153}],254:[function(i,B,V){function t(e,l){l||(l={}),(typeof e=="string"||Array.isArray(e))&&(l.family=e);var o=Array.isArray(l.family)?l.family.join(", "):l.family;if(!o)throw Error("`family` must be defined");var a=l.size||l.fontSize||l.em||48,n=l.weight||l.fontWeight||"",s=(e=[l.style||l.fontStyle||"",n,a].join(" ")+"px "+o,l.origin||"top");if(t.cache[o]&&a<=t.cache[o].em)return h(t.cache[o],s);var r=l.canvas||t.canvas,c=r.getContext("2d"),f={upper:l.upper!==void 0?l.upper:"H",lower:l.lower!==void 0?l.lower:"x",descent:l.descent!==void 0?l.descent:"p",ascent:l.ascent!==void 0?l.ascent:"h",tittle:l.tittle!==void 0?l.tittle:"i",overshoot:l.overshoot!==void 0?l.overshoot:"O"},d=Math.ceil(1.5*a);r.height=d,r.width=.5*d,c.font=e;var g={top:0};c.clearRect(0,0,d,d),c.textBaseline="top",c.fillStyle="black",c.fillText("H",0,0);var m=p(c.getImageData(0,0,d,d));c.clearRect(0,0,d,d),c.textBaseline="bottom",c.fillText("H",0,d);var y=p(c.getImageData(0,0,d,d));g.lineHeight=g.bottom=d-y+m,c.clearRect(0,0,d,d),c.textBaseline="alphabetic",c.fillText("H",0,d);var v=d-p(c.getImageData(0,0,d,d))-1+m;g.baseline=g.alphabetic=v,c.clearRect(0,0,d,d),c.textBaseline="middle",c.fillText("H",0,.5*d);var T=p(c.getImageData(0,0,d,d));g.median=g.middle=d-T-1+m-.5*d,c.clearRect(0,0,d,d),c.textBaseline="hanging",c.fillText("H",0,.5*d);var _=p(c.getImageData(0,0,d,d));g.hanging=d-_-1+m-.5*d,c.clearRect(0,0,d,d),c.textBaseline="ideographic",c.fillText("H",0,d);var k=p(c.getImageData(0,0,d,d));if(g.ideographic=d-k-1+m,f.upper&&(c.clearRect(0,0,d,d),c.textBaseline="top",c.fillText(f.upper,0,0),g.upper=p(c.getImageData(0,0,d,d)),g.capHeight=g.baseline-g.upper),f.lower&&(c.clearRect(0,0,d,d),c.textBaseline="top",c.fillText(f.lower,0,0),g.lower=p(c.getImageData(0,0,d,d)),g.xHeight=g.baseline-g.lower),f.tittle&&(c.clearRect(0,0,d,d),c.textBaseline="top",c.fillText(f.tittle,0,0),g.tittle=p(c.getImageData(0,0,d,d))),f.ascent&&(c.clearRect(0,0,d,d),c.textBaseline="top",c.fillText(f.ascent,0,0),g.ascent=p(c.getImageData(0,0,d,d))),f.descent&&(c.clearRect(0,0,d,d),c.textBaseline="top",c.fillText(f.descent,0,0),g.descent=u(c.getImageData(0,0,d,d))),f.overshoot){c.clearRect(0,0,d,d),c.textBaseline="top",c.fillText(f.overshoot,0,0);var E=u(c.getImageData(0,0,d,d));g.overshoot=E-v}for(var A in g)g[A]/=a;return g.em=a,t.cache[o]=g,h(g,s)}function h(e,l){var o={};for(var a in typeof l=="string"&&(l=e[l]),e)a!=="em"&&(o[a]=e[a]-l);return o}function p(e){for(var l=e.height,o=e.data,a=3;a<o.length;a+=4)if(o[a]!==0)return Math.floor(.25*(a-3)/l)}function u(e){for(var l=e.height,o=e.data,a=o.length-1;a>0;a-=4)if(o[a]!==0)return Math.floor(.25*(a-3)/l)}B.exports=t,t.canvas=document.createElement("canvas"),t.cache={}},{}],255:[function(i,B,V){B.exports=function(d){return new e(d||f,null)};function t(d,g,m,y,v,T){this._color=d,this.key=g,this.value=m,this.left=y,this.right=v,this._count=T}function h(d){return new t(d._color,d.key,d.value,d.left,d.right,d._count)}function p(d,g){return new t(d,g.key,g.value,g.left,g.right,g._count)}function u(d){d._count=1+(d.left?d.left._count:0)+(d.right?d.right._count:0)}function e(d,g){this._compare=d,this.root=g}var l=e.prototype;function o(d,g){var m;return g.left&&(m=o(d,g.left))?m:(m=d(g.key,g.value))||(g.right?o(d,g.right):void 0)}function a(d,g,m,y){if(g(d,y.key)<=0){var v;if(y.left&&(v=a(d,g,m,y.left))||(v=m(y.key,y.value)))return v}if(y.right)return a(d,g,m,y.right)}function n(d,g,m,y,v){var T,_=m(d,v.key),k=m(g,v.key);if(_<=0&&(v.left&&(T=n(d,g,m,y,v.left))||k>0&&(T=y(v.key,v.value))))return T;if(k>0&&v.right)return n(d,g,m,y,v.right)}function s(d,g){this.tree=d,this._stack=g}Object.defineProperty(l,"keys",{get:function(){var d=[];return this.forEach(function(g,m){d.push(g)}),d}}),Object.defineProperty(l,"values",{get:function(){var d=[];return this.forEach(function(g,m){d.push(m)}),d}}),Object.defineProperty(l,"length",{get:function(){return this.root?this.root._count:0}}),l.insert=function(d,g){for(var m=this._compare,y=this.root,v=[],T=[];y;){var _=m(d,y.key);v.push(y),T.push(_),y=_<=0?y.left:y.right}v.push(new t(0,d,g,null,null,1));for(var k=v.length-2;k>=0;--k)y=v[k],T[k]<=0?v[k]=new t(y._color,y.key,y.value,v[k+1],y.right,y._count+1):v[k]=new t(y._color,y.key,y.value,y.left,v[k+1],y._count+1);for(k=v.length-1;k>1;--k){var E=v[k-1];if(y=v[k],E._color===1||y._color===1)break;var A=v[k-2];if(A.left===E)if(E.left===y){if(!(b=A.right)||b._color!==0){A._color=0,A.left=E.right,E._color=1,E.right=A,v[k-2]=E,v[k-1]=y,u(A),u(E),k>=3&&((L=v[k-3]).left===A?L.left=E:L.right=E);break}E._color=1,A.right=p(1,b),A._color=0,k-=1}else{if(!(b=A.right)||b._color!==0){E.right=y.left,A._color=0,A.left=y.right,y._color=1,y.left=E,y.right=A,v[k-2]=y,v[k-1]=E,u(A),u(E),u(y),k>=3&&((L=v[k-3]).left===A?L.left=y:L.right=y);break}E._color=1,A.right=p(1,b),A._color=0,k-=1}else if(E.right===y){if(!(b=A.left)||b._color!==0){A._color=0,A.right=E.left,E._color=1,E.left=A,v[k-2]=E,v[k-1]=y,u(A),u(E),k>=3&&((L=v[k-3]).right===A?L.right=E:L.left=E);break}E._color=1,A.left=p(1,b),A._color=0,k-=1}else{var b;if(!(b=A.left)||b._color!==0){var L;E.left=y.right,A._color=0,A.right=y.left,y._color=1,y.right=E,y.left=A,v[k-2]=y,v[k-1]=E,u(A),u(E),u(y),k>=3&&((L=v[k-3]).right===A?L.right=y:L.left=y);break}E._color=1,A.left=p(1,b),A._color=0,k-=1}}return v[0]._color=1,new e(m,v[0])},l.forEach=function(d,g,m){if(this.root)switch(arguments.length){case 1:return o(d,this.root);case 2:return a(g,this._compare,d,this.root);case 3:return this._compare(g,m)>=0?void 0:n(g,m,this._compare,d,this.root)}},Object.defineProperty(l,"begin",{get:function(){for(var d=[],g=this.root;g;)d.push(g),g=g.left;return new s(this,d)}}),Object.defineProperty(l,"end",{get:function(){for(var d=[],g=this.root;g;)d.push(g),g=g.right;return new s(this,d)}}),l.at=function(d){if(d<0)return new s(this,[]);for(var g=this.root,m=[];;){if(m.push(g),g.left){if(d<g.left._count){g=g.left;continue}d-=g.left._count}if(!d)return new s(this,m);if(d-=1,!g.right||d>=g.right._count)break;g=g.right}return new s(this,[])},l.ge=function(d){for(var g=this._compare,m=this.root,y=[],v=0;m;){var T=g(d,m.key);y.push(m),T<=0&&(v=y.length),m=T<=0?m.left:m.right}return y.length=v,new s(this,y)},l.gt=function(d){for(var g=this._compare,m=this.root,y=[],v=0;m;){var T=g(d,m.key);y.push(m),T<0&&(v=y.length),m=T<0?m.left:m.right}return y.length=v,new s(this,y)},l.lt=function(d){for(var g=this._compare,m=this.root,y=[],v=0;m;){var T=g(d,m.key);y.push(m),T>0&&(v=y.length),m=T<=0?m.left:m.right}return y.length=v,new s(this,y)},l.le=function(d){for(var g=this._compare,m=this.root,y=[],v=0;m;){var T=g(d,m.key);y.push(m),T>=0&&(v=y.length),m=T<0?m.left:m.right}return y.length=v,new s(this,y)},l.find=function(d){for(var g=this._compare,m=this.root,y=[];m;){var v=g(d,m.key);if(y.push(m),v===0)return new s(this,y);m=v<=0?m.left:m.right}return new s(this,[])},l.remove=function(d){var g=this.find(d);return g?g.remove():this},l.get=function(d){for(var g=this._compare,m=this.root;m;){var y=g(d,m.key);if(y===0)return m.value;m=y<=0?m.left:m.right}};var r=s.prototype;function c(d,g){d.key=g.key,d.value=g.value,d.left=g.left,d.right=g.right,d._color=g._color,d._count=g._count}function f(d,g){return d<g?-1:d>g?1:0}Object.defineProperty(r,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(r,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),r.clone=function(){return new s(this.tree,this._stack.slice())},r.remove=function(){var d=this._stack;if(d.length===0)return this.tree;var g=new Array(d.length),m=d[d.length-1];g[g.length-1]=new t(m._color,m.key,m.value,m.left,m.right,m._count);for(var y=d.length-2;y>=0;--y)(m=d[y]).left===d[y+1]?g[y]=new t(m._color,m.key,m.value,g[y+1],m.right,m._count):g[y]=new t(m._color,m.key,m.value,m.left,g[y+1],m._count);if((m=g[g.length-1]).left&&m.right){var v=g.length;for(m=m.left;m.right;)g.push(m),m=m.right;var T=g[v-1];for(g.push(new t(m._color,T.key,T.value,m.left,m.right,m._count)),g[v-1].key=m.key,g[v-1].value=m.value,y=g.length-2;y>=v;--y)m=g[y],g[y]=new t(m._color,m.key,m.value,m.left,g[y+1],m._count);g[v-1].left=g[v]}if((m=g[g.length-1])._color===0){var _=g[g.length-2];for(_.left===m?_.left=null:_.right===m&&(_.right=null),g.pop(),y=0;y<g.length;++y)g[y]._count--;return new e(this.tree._compare,g[0])}if(m.left||m.right){for(m.left?c(m,m.left):m.right&&c(m,m.right),m._color=1,y=0;y<g.length-1;++y)g[y]._count--;return new e(this.tree._compare,g[0])}if(g.length===1)return new e(this.tree._compare,null);for(y=0;y<g.length;++y)g[y]._count--;var k=g[g.length-2];return function(E){for(var A,b,L,w,C=E.length-1;C>=0;--C){if(A=E[C],C===0)return void(A._color=1);if((b=E[C-1]).left===A){if((L=b.right).right&&L.right._color===0)return w=(L=b.right=h(L)).right=h(L.right),b.right=L.left,L.left=b,L.right=w,L._color=b._color,A._color=1,b._color=1,w._color=1,u(b),u(L),C>1&&((S=E[C-2]).left===b?S.left=L:S.right=L),void(E[C-1]=L);if(L.left&&L.left._color===0)return w=(L=b.right=h(L)).left=h(L.left),b.right=w.left,L.left=w.right,w.left=b,w.right=L,w._color=b._color,b._color=1,L._color=1,A._color=1,u(b),u(L),u(w),C>1&&((S=E[C-2]).left===b?S.left=w:S.right=w),void(E[C-1]=w);if(L._color===1){if(b._color===0)return b._color=1,void(b.right=p(0,L));b.right=p(0,L);continue}L=h(L),b.right=L.left,L.left=b,L._color=b._color,b._color=0,u(b),u(L),C>1&&((S=E[C-2]).left===b?S.left=L:S.right=L),E[C-1]=L,E[C]=b,C+1<E.length?E[C+1]=A:E.push(A),C+=2}else{if((L=b.left).left&&L.left._color===0)return w=(L=b.left=h(L)).left=h(L.left),b.left=L.right,L.right=b,L.left=w,L._color=b._color,A._color=1,b._color=1,w._color=1,u(b),u(L),C>1&&((S=E[C-2]).right===b?S.right=L:S.left=L),void(E[C-1]=L);if(L.right&&L.right._color===0)return w=(L=b.left=h(L)).right=h(L.right),b.left=w.right,L.right=w.left,w.right=b,w.left=L,w._color=b._color,b._color=1,L._color=1,A._color=1,u(b),u(L),u(w),C>1&&((S=E[C-2]).right===b?S.right=w:S.left=w),void(E[C-1]=w);if(L._color===1){if(b._color===0)return b._color=1,void(b.left=p(0,L));b.left=p(0,L);continue}var S;L=h(L),b.left=L.right,L.right=b,L._color=b._color,b._color=0,u(b),u(L),C>1&&((S=E[C-2]).right===b?S.right=L:S.left=L),E[C-1]=L,E[C]=b,C+1<E.length?E[C+1]=A:E.push(A),C+=2}}}(g),k.left===m?k.left=null:k.right=null,new e(this.tree._compare,g[0])},Object.defineProperty(r,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(r,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(r,"index",{get:function(){var d=0,g=this._stack;if(g.length===0){var m=this.tree.root;return m?m._count:0}g[g.length-1].left&&(d=g[g.length-1].left._count);for(var y=g.length-2;y>=0;--y)g[y+1]===g[y].right&&(++d,g[y].left&&(d+=g[y].left._count));return d},enumerable:!0}),r.next=function(){var d=this._stack;if(d.length!==0){var g=d[d.length-1];if(g.right)for(g=g.right;g;)d.push(g),g=g.left;else for(d.pop();d.length>0&&d[d.length-1].right===g;)g=d[d.length-1],d.pop()}},Object.defineProperty(r,"hasNext",{get:function(){var d=this._stack;if(d.length===0)return!1;if(d[d.length-1].right)return!0;for(var g=d.length-1;g>0;--g)if(d[g-1].left===d[g])return!0;return!1}}),r.update=function(d){var g=this._stack;if(g.length===0)throw new Error("Can't update empty node!");var m=new Array(g.length),y=g[g.length-1];m[m.length-1]=new t(y._color,y.key,d,y.left,y.right,y._count);for(var v=g.length-2;v>=0;--v)(y=g[v]).left===g[v+1]?m[v]=new t(y._color,y.key,y.value,m[v+1],y.right,y._count):m[v]=new t(y._color,y.key,y.value,y.left,m[v+1],y._count);return new e(this.tree._compare,m[0])},r.prev=function(){var d=this._stack;if(d.length!==0){var g=d[d.length-1];if(g.left)for(g=g.left;g;)d.push(g),g=g.right;else for(d.pop();d.length>0&&d[d.length-1].left===g;)g=d[d.length-1],d.pop()}},Object.defineProperty(r,"hasPrev",{get:function(){var d=this._stack;if(d.length===0)return!1;if(d[d.length-1].left)return!0;for(var g=d.length-1;g>0;--g)if(d[g-1].right===d[g])return!0;return!1}})},{}],256:[function(i,B,V){var t=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23],h=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function p(u){if(u<0)return+"0/0";for(var e=h[0],l=h.length-1;l>0;--l)e+=h[l]/(u+l);var o=u+607/128+.5;return .5*Math.log(2*Math.PI)+(u+.5)*Math.log(o)-o+Math.log(e)-Math.log(u)}B.exports=function u(e){if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*u(1-e));if(e>100)return Math.exp(p(e));e-=1;for(var l=t[0],o=1;o<9;o++)l+=t[o]/(e+o);var a=e+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(a,e+.5)*Math.exp(-a)*l},B.exports.log=p},{}],257:[function(i,B,V){B.exports=function(t,h){if(typeof t!="string")throw new TypeError("must specify type string");if(h=h||{},typeof document>"u"&&!h.canvas)return null;var p=h.canvas||document.createElement("canvas");typeof h.width=="number"&&(p.width=h.width),typeof h.height=="number"&&(p.height=h.height);var u,e=h;try{var l=[t];t.indexOf("webgl")===0&&l.push("experimental-"+t);for(var o=0;o<l.length;o++)if(u=p.getContext(l[o],e))return u}catch{u=null}return u||null}},{}],258:[function(i,B,V){B.exports=function(v,T){var _=new a(v);return _.update(T),_};var t=i("./lib/text.js"),h=i("./lib/lines.js"),p=i("./lib/background.js"),u=i("./lib/cube.js"),e=i("./lib/ticks.js"),l=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function o(v,T){return v[0]=T[0],v[1]=T[1],v[2]=T[2],v}function a(v){this.gl=v,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=p(v)}var n=a.prototype;function s(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}n.update=function(v){function T(F,q,W){if(W in v){var X,Q=v[W],Z=this[W];(F?Array.isArray(Q)&&Array.isArray(Q[0]):Array.isArray(Q))?this[W]=X=[q(Q[0]),q(Q[1]),q(Q[2])]:this[W]=X=[q(Q),q(Q),q(Q)];for(var Y=0;Y<3;++Y)if(X[Y]!==Z[Y])return!0}return!1}v=v||{};var _,k=T.bind(this,!1,Number),E=T.bind(this,!1,Boolean),A=T.bind(this,!1,String),b=T.bind(this,!0,function(F){if(Array.isArray(F)){if(F.length===3)return[+F[0],+F[1],+F[2],1];if(F.length===4)return[+F[0],+F[1],+F[2],+F[3]]}return[0,0,0,1]}),L=!1,w=!1;if("bounds"in v)for(var C=v.bounds,S=0;S<2;++S)for(var P=0;P<3;++P)C[S][P]!==this.bounds[S][P]&&(w=!0),this.bounds[S][P]=C[S][P];if("ticks"in v)for(_=v.ticks,L=!0,this.autoTicks=!1,S=0;S<3;++S)this.tickSpacing[S]=0;else k("tickSpacing")&&(this.autoTicks=!0,w=!0);if(this._firstInit&&("ticks"in v||"tickSpacing"in v||(this.autoTicks=!0),w=!0,L=!0,this._firstInit=!1),w&&this.autoTicks&&(_=e.create(this.bounds,this.tickSpacing),L=!0),L){for(S=0;S<3;++S)_[S].sort(function(F,q){return F.x-q.x});e.equal(_,this.ticks)?L=!1:this.ticks=_}E("tickEnable"),A("tickFont")&&(L=!0),k("tickSize"),k("tickAngle"),k("tickPad"),b("tickColor");var z=A("labels");A("labelFont")&&(z=!0),E("labelEnable"),k("labelSize"),k("labelPad"),b("labelColor"),E("lineEnable"),E("lineMirror"),k("lineWidth"),b("lineColor"),E("lineTickEnable"),E("lineTickMirror"),k("lineTickLength"),k("lineTickWidth"),b("lineTickColor"),E("gridEnable"),k("gridWidth"),b("gridColor"),E("zeroEnable"),b("zeroLineColor"),k("zeroLineWidth"),E("backgroundEnable"),b("backgroundColor"),this._text?this._text&&(z||L)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=t(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&L&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=h(this.gl,this.bounds,this.ticks))};var r=[new s,new s,new s];function c(v,T,_,k,E){for(var A=v.primalOffset,b=v.primalMinor,L=v.mirrorOffset,w=v.mirrorMinor,C=k[T],S=0;S<3;++S)if(T!==S){var P=A,z=L,F=b,q=w;C&1<<S&&(P=L,z=A,F=w,q=b),P[S]=_[0][S],z[S]=_[1][S],E[S]>0?(F[S]=-1,q[S]=0):(F[S]=0,q[S]=1)}}var f=[0,0,0],d={model:l,view:l,projection:l,_ortho:!1};n.isOpaque=function(){return!0},n.isTransparent=function(){return!1},n.drawTransparent=function(v){};var g=[0,0,0],m=[0,0,0],y=[0,0,0];n.draw=function(v){v=v||d;for(var T=this.gl,_=v.model||l,k=v.view||l,E=v.projection||l,A=this.bounds,b=v._ortho||!1,L=u(_,k,E,A,b),w=L.cubeEdges,C=L.axis,S=k[12],P=k[13],z=k[14],F=k[15],q=(b?2:1)*this.pixelRatio*(E[3]*S+E[7]*P+E[11]*z+E[15]*F)/T.drawingBufferHeight,W=0;W<3;++W)this.lastCubeProps.cubeEdges[W]=w[W],this.lastCubeProps.axis[W]=C[W];var X=r;for(W=0;W<3;++W)c(r[W],W,this.bounds,w,C);T=this.gl;var Q,Z=f;for(W=0;W<3;++W)this.backgroundEnable[W]?Z[W]=C[W]:Z[W]=0;for(this._background.draw(_,k,E,A,Z,this.backgroundColor),this._lines.bind(_,k,E,this),W=0;W<3;++W){var Y=[0,0,0];C[W]>0?Y[W]=A[1][W]:Y[W]=A[0][W];for(var N=0;N<2;++N){var J=(W+1+N)%3,D=(W+1+(1^N))%3;this.gridEnable[J]&&this._lines.drawGrid(J,D,this.bounds,Y,this.gridColor[J],this.gridWidth[J]*this.pixelRatio)}for(N=0;N<2;++N)J=(W+1+N)%3,D=(W+1+(1^N))%3,this.zeroEnable[D]&&Math.min(A[0][D],A[1][D])<=0&&Math.max(A[0][D],A[1][D])>=0&&this._lines.drawZero(J,D,this.bounds,Y,this.zeroLineColor[D],this.zeroLineWidth[D]*this.pixelRatio)}for(W=0;W<3;++W){this.lineEnable[W]&&this._lines.drawAxisLine(W,this.bounds,X[W].primalOffset,this.lineColor[W],this.lineWidth[W]*this.pixelRatio),this.lineMirror[W]&&this._lines.drawAxisLine(W,this.bounds,X[W].mirrorOffset,this.lineColor[W],this.lineWidth[W]*this.pixelRatio);var U=o(g,X[W].primalMinor),G=o(m,X[W].mirrorMinor),$=this.lineTickLength;for(N=0;N<3;++N){var K=q/_[5*N];U[N]*=$[N]*K,G[N]*=$[N]*K}this.lineTickEnable[W]&&this._lines.drawAxisTicks(W,X[W].primalOffset,U,this.lineTickColor[W],this.lineTickWidth[W]*this.pixelRatio),this.lineTickMirror[W]&&this._lines.drawAxisTicks(W,X[W].mirrorOffset,G,this.lineTickColor[W],this.lineTickWidth[W]*this.pixelRatio)}this._lines.unbind(),this._text.bind(_,k,E,this.pixelRatio);var re,ne;function ae(ve){(ne=[0,0,0])[ve]=1}function ie(ve,Ee,Le){var Te=(ve+1)%3,xe=(ve+2)%3,fe=Ee[Te],ge=Ee[xe],ke=Le[Te],Me=Le[xe];fe>0&&Me>0||fe>0&&Me<0||fe<0&&Me>0||fe<0&&Me<0?ae(Te):(ge>0&&ke>0||ge>0&&ke<0||ge<0&&ke>0||ge<0&&ke<0)&&ae(xe)}for(W=0;W<3;++W){var he=X[W].primalMinor,se=X[W].mirrorMinor,de=o(y,X[W].primalOffset);for(N=0;N<3;++N)this.lineTickEnable[W]&&(de[N]+=q*he[N]*Math.max(this.lineTickLength[N],0)/_[5*N]);var ce=[0,0,0];if(ce[W]=1,this.tickEnable[W]){for(this.tickAngle[W]===-3600?(this.tickAngle[W]=0,this.tickAlign[W]="auto"):this.tickAlign[W]=-1,re=1,(Q=[this.tickAlign[W],.5,re])[0]==="auto"?Q[0]=0:Q[0]=parseInt(""+Q[0]),ne=[0,0,0],ie(W,he,se),N=0;N<3;++N)de[N]+=q*he[N]*this.tickPad[N]/_[5*N];this._text.drawTicks(W,this.tickSize[W],this.tickAngle[W],de,this.tickColor[W],ce,ne,Q)}if(this.labelEnable[W]){for(re=0,ne=[0,0,0],this.labels[W].length>4&&(ae(W),re=1),(Q=[this.labelAlign[W],.5,re])[0]==="auto"?Q[0]=0:Q[0]=parseInt(""+Q[0]),N=0;N<3;++N)de[N]+=q*he[N]*this.labelPad[N]/_[5*N];de[W]+=.5*(A[0][W]+A[1][W]),this._text.drawLabel(W,this.labelSize[W],this.labelAngle[W],de,this.labelColor[W],[0,0,0],ne,Q)}}this._text.unbind()},n.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":259,"./lib/cube.js":260,"./lib/lines.js":261,"./lib/text.js":263,"./lib/ticks.js":264}],259:[function(i,B,V){B.exports=function(l){for(var o=[],a=[],n=0,s=0;s<3;++s)for(var r=(s+1)%3,c=(s+2)%3,f=[0,0,0],d=[0,0,0],g=-1;g<=1;g+=2){a.push(n,n+2,n+1,n+1,n+2,n+3),f[s]=g,d[s]=g;for(var m=-1;m<=1;m+=2){f[r]=m;for(var y=-1;y<=1;y+=2)f[c]=y,o.push(f[0],f[1],f[2],d[0],d[1],d[2]),n+=1}var v=r;r=c,c=v}var T=t(l,new Float32Array(o)),_=t(l,new Uint16Array(a),l.ELEMENT_ARRAY_BUFFER),k=h(l,[{buffer:T,type:l.FLOAT,size:3,offset:0,stride:24},{buffer:T,type:l.FLOAT,size:3,offset:12,stride:24}],_),E=p(l);return E.attributes.position.location=0,E.attributes.normal.location=1,new u(l,T,k,E)};var t=i("gl-buffer"),h=i("gl-vao"),p=i("./shaders").bg;function u(l,o,a,n){this.gl=l,this.buffer=o,this.vao=a,this.shader=n}var e=u.prototype;e.draw=function(l,o,a,n,s,r){for(var c=!1,f=0;f<3;++f)c=c||s[f];if(c){var d=this.gl;d.enable(d.POLYGON_OFFSET_FILL),d.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:l,view:o,projection:a,bounds:n,enable:s,colors:r},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),d.disable(d.POLYGON_OFFSET_FILL)}},e.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":262,"gl-buffer":267,"gl-vao":361}],260:[function(i,B,V){B.exports=function(m,y,v,T,_){h(e,y,m),h(e,v,e);for(var k=0,E=0;E<2;++E){a[2]=T[E][2];for(var A=0;A<2;++A){a[1]=T[A][1];for(var b=0;b<2;++b)a[0]=T[b][0],s(l[k],a,e),k+=1}}var L=-1;for(E=0;E<8;++E){for(var w=l[E][3],C=0;C<3;++C)o[E][C]=l[E][C]/w;_&&(o[E][2]*=-1),w<0&&(L<0||o[E][2]<o[L][2])&&(L=E)}if(L<0){L=0;for(var S=0;S<3;++S){for(var P=(S+2)%3,z=(S+1)%3,F=-1,q=-1,W=0;W<2;++W){var X=(Z=W<<S)+(W<<P)+(1-W<<z),Q=Z+(1-W<<P)+(W<<z);u(o[Z],o[X],o[Q],n)<0||(W?F=1:q=1)}if(F<0||q<0)q>F&&(L|=1<<S);else{for(W=0;W<2;++W){X=(Z=W<<S)+(W<<P)+(1-W<<z),Q=Z+(1-W<<P)+(W<<z);var Z,Y=c([l[Z],l[X],l[Q],l[Z+(1<<P)+(1<<z)]]);W?F=Y:q=Y}q>F&&(L|=1<<S)}}}var N=7^L,J=-1;for(E=0;E<8;++E)E!==L&&E!==N&&(J<0||o[J][1]>o[E][1])&&(J=E);var D=-1;for(E=0;E<3;++E)(G=J^1<<E)!==L&&G!==N&&(D<0&&(D=G),(z=o[G])[0]<o[D][0]&&(D=G));var U=-1;for(E=0;E<3;++E){var G;(G=J^1<<E)!==L&&G!==N&&G!==D&&(U<0&&(U=G),(z=o[G])[0]>o[U][0]&&(U=G))}var $=f;$[0]=$[1]=$[2]=0,$[t.log2(D^J)]=J&D,$[t.log2(J^U)]=J&U;var K=7^U;K===L||K===N?(K=7^D,$[t.log2(U^K)]=K&U):$[t.log2(D^K)]=K&D;var re=d,ne=L;for(S=0;S<3;++S)re[S]=ne&1<<S?-1:1;return g};var t=i("bit-twiddle"),h=i("gl-mat4/multiply"),p=i("split-polygon"),u=i("robust-orientation"),e=new Array(16),l=new Array(8),o=new Array(8),a=new Array(3),n=[0,0,0];function s(m,y,v){for(var T=0;T<4;++T){m[T]=v[12+T];for(var _=0;_<3;++_)m[T]+=y[_]*v[4*_+T]}}(function(){for(var m=0;m<8;++m)l[m]=[1,1,1,1],o[m]=[1,1,1]})();var r=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function c(m){for(var y=0;y<r.length;++y)if((m=p.positive(m,r[y])).length<3)return 0;var v=m[0],T=v[0]/v[3],_=v[1]/v[3],k=0;for(y=1;y+1<m.length;++y){var E=m[y],A=m[y+1],b=E[0]/E[3]-T,L=E[1]/E[3]-_,w=A[0]/A[3]-T,C=A[1]/A[3]-_;k+=Math.abs(b*C-L*w)}return k}var f=[1,1,1],d=[0,0,0],g={cubeEdges:f,axis:d}},{"bit-twiddle":104,"gl-mat4/multiply":301,"robust-orientation":548,"split-polygon":567}],261:[function(i,B,V){B.exports=function(f,d,g){var m=[],y=[0,0,0],v=[0,0,0],T=[0,0,0],_=[0,0,0];m.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var k=0;k<3;++k){for(var E=m.length/3|0,A=0;A<g[k].length;++A){var b=+g[k][A].x;m.push(b,0,1,b,1,1,b,0,-1,b,0,-1,b,1,1,b,1,-1)}var L=m.length/3|0;y[k]=E,v[k]=L-E,E=m.length/3|0;for(var w=0;w<g[k].length;++w)b=+g[k][w].x,m.push(b,0,1,b,1,1,b,0,-1,b,0,-1,b,1,1,b,1,-1);L=m.length/3|0,T[k]=E,_[k]=L-E}var C=t(f,new Float32Array(m)),S=h(f,[{buffer:C,type:f.FLOAT,size:3,stride:0,offset:0}]),P=p(f);return P.attributes.position.location=0,new r(f,C,S,P,v,y,_,T)};var t=i("gl-buffer"),h=i("gl-vao"),p=i("./shaders").line,u=[0,0,0],e=[0,0,0],l=[0,0,0],o=[0,0,0],a=[1,1];function n(f){return f[0]=f[1]=f[2]=0,f}function s(f,d){return f[0]=d[0],f[1]=d[1],f[2]=d[2],f}function r(f,d,g,m,y,v,T,_){this.gl=f,this.vertBuffer=d,this.vao=g,this.shader=m,this.tickCount=y,this.tickOffset=v,this.gridCount=T,this.gridOffset=_}var c=r.prototype;c.bind=function(f,d,g){this.shader.bind(),this.shader.uniforms.model=f,this.shader.uniforms.view=d,this.shader.uniforms.projection=g,a[0]=this.gl.drawingBufferWidth,a[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=a,this.vao.bind()},c.unbind=function(){this.vao.unbind()},c.drawAxisLine=function(f,d,g,m,y){var v=n(e);this.shader.uniforms.majorAxis=e,v[f]=d[1][f]-d[0][f],this.shader.uniforms.minorAxis=v;var T,_=s(o,g);_[f]+=d[0][f],this.shader.uniforms.offset=_,this.shader.uniforms.lineWidth=y,this.shader.uniforms.color=m,(T=n(l))[(f+2)%3]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,6),(T=n(l))[(f+1)%3]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,6)},c.drawAxisTicks=function(f,d,g,m,y){if(this.tickCount[f]){var v=n(u);v[f]=1,this.shader.uniforms.majorAxis=v,this.shader.uniforms.offset=d,this.shader.uniforms.minorAxis=g,this.shader.uniforms.color=m,this.shader.uniforms.lineWidth=y;var T=n(l);T[f]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,this.tickCount[f],this.tickOffset[f])}},c.drawGrid=function(f,d,g,m,y,v){if(this.gridCount[f]){var T=n(e);T[d]=g[1][d]-g[0][d],this.shader.uniforms.minorAxis=T;var _=s(o,m);_[d]+=g[0][d],this.shader.uniforms.offset=_;var k=n(u);k[f]=1,this.shader.uniforms.majorAxis=k;var E=n(l);E[f]=1,this.shader.uniforms.screenAxis=E,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=y,this.vao.draw(this.gl.TRIANGLES,this.gridCount[f],this.gridOffset[f])}},c.drawZero=function(f,d,g,m,y,v){var T=n(e);this.shader.uniforms.majorAxis=T,T[f]=g[1][f]-g[0][f],this.shader.uniforms.minorAxis=T;var _=s(o,m);_[f]+=g[0][f],this.shader.uniforms.offset=_;var k=n(l);k[d]=1,this.shader.uniforms.screenAxis=k,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=y,this.vao.draw(this.gl.TRIANGLES,6)},c.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":262,"gl-buffer":267,"gl-vao":361}],262:[function(i,B,V){var t=i("glslify"),h=i("gl-shader"),p=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),u=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);V.line=function(n){return h(n,p,u,null,[{name:"position",type:"vec3"}])};var e=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),l=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);V.text=function(n){return h(n,e,l,null,[{name:"position",type:"vec3"}])};var o=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),a=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);V.bg=function(n){return h(n,o,a,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":339,glslify:265}],263:[function(i,B,V){(function(t){(function(){B.exports=function(r,c,f,d,g,m){var y=h(r),v=p(r,[{buffer:y,size:3}]),T=e(r);T.attributes.position.location=0;var _=new a(r,T,y,v);return _.update(c,f,d,g,m),_};var h=i("gl-buffer"),p=i("gl-vao"),u=i("vectorize-text"),e=i("./shaders").text,l=window||t.global||{},o=l.__TEXT_CACHE||{};l.__TEXT_CACHE={};function a(r,c,f,d){this.gl=r,this.shader=c,this.buffer=f,this.vao=d,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var n=a.prototype,s=[0,0];n.bind=function(r,c,f,d){this.vao.bind(),this.shader.bind();var g=this.shader.uniforms;g.model=r,g.view=c,g.projection=f,g.pixelScale=d,s[0]=this.gl.drawingBufferWidth,s[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=s},n.unbind=function(){this.vao.unbind()},n.update=function(r,c,f,d,g){var m=[];function y(L,w,C,S,P,z){var F=o[C];F||(F=o[C]={});var q=F[w];q||(q=F[w]=function(U,G){try{return u(U,G)}catch($){return console.warn('error vectorizing text:"'+U+'" error:',$),{cells:[],positions:[]}}}(w,{triangles:!0,font:C,textAlign:"center",textBaseline:"middle",lineSpacing:P,styletags:z}));for(var W=(S||12)/12,X=q.positions,Q=q.cells,Z=0,Y=Q.length;Z<Y;++Z)for(var N=Q[Z],J=2;J>=0;--J){var D=X[N[J]];m.push(W*D[0],-W*D[1],L)}}for(var v=[0,0,0],T=[0,0,0],_=[0,0,0],k=[0,0,0],E={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},A=0;A<3;++A){_[A]=m.length/3|0,y(.5*(r[0][A]+r[1][A]),c[A],f[A],12,1.25,E),k[A]=(m.length/3|0)-_[A],v[A]=m.length/3|0;for(var b=0;b<d[A].length;++b)d[A][b].text&&y(d[A][b].x,d[A][b].text,d[A][b].font||g,d[A][b].fontSize||12,1.25,E);T[A]=(m.length/3|0)-v[A]}this.buffer.update(m),this.tickOffset=v,this.tickCount=T,this.labelOffset=_,this.labelCount=k},n.drawTicks=function(r,c,f,d,g,m,y,v){this.tickCount[r]&&(this.shader.uniforms.axis=m,this.shader.uniforms.color=g,this.shader.uniforms.angle=f,this.shader.uniforms.scale=c,this.shader.uniforms.offset=d,this.shader.uniforms.alignDir=y,this.shader.uniforms.alignOpt=v,this.vao.draw(this.gl.TRIANGLES,this.tickCount[r],this.tickOffset[r]))},n.drawLabel=function(r,c,f,d,g,m,y,v){this.labelCount[r]&&(this.shader.uniforms.axis=m,this.shader.uniforms.color=g,this.shader.uniforms.angle=f,this.shader.uniforms.scale=c,this.shader.uniforms.offset=d,this.shader.uniforms.alignDir=y,this.shader.uniforms.alignOpt=v,this.vao.draw(this.gl.TRIANGLES,this.labelCount[r],this.labelOffset[r]))},n.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,i("_process"))},{"./shaders":262,_process:528,"gl-buffer":267,"gl-vao":361,"vectorize-text":623}],264:[function(i,B,V){function t(h,p){var u=h+"",e=u.indexOf("."),l=0;e>=0&&(l=u.length-e-1);var o=Math.pow(10,l),a=Math.round(h*p*o),n=a+"";if(n.indexOf("e")>=0)return n;var s=a/o,r=a%o;a<0?(s=0|-Math.ceil(s),r=0|-r):(s=0|Math.floor(s),r|=0);var c=""+s;if(a<0&&(c="-"+c),l){for(var f=""+r;f.length<l;)f="0"+f;return c+"."+f}return c}V.create=function(h,p){for(var u=[],e=0;e<3;++e){for(var l=[],o=(h[0][e],h[1][e],0);o*p[e]<=h[1][e];++o)l.push({x:o*p[e],text:t(p[e],o)});for(o=-1;o*p[e]>=h[0][e];--o)l.push({x:o*p[e],text:t(p[e],o)});u.push(l)}return u},V.equal=function(h,p){for(var u=0;u<3;++u){if(h[u].length!==p[u].length)return!1;for(var e=0;e<h[u].length;++e){var l=h[u][e],o=p[u][e];if(l.x!==o.x||l.text!==o.text||l.font!==o.font||l.fontColor!==o.fontColor||l.fontSize!==o.fontSize||l.dx!==o.dx||l.dy!==o.dy)return!1}}return!0}},{}],265:[function(i,B,V){B.exports=function(t){typeof t=="string"&&(t=[t]);for(var h=[].slice.call(arguments,1),p=[],u=0;u<t.length-1;u++)p.push(t[u],h[u]||"");return p.push(t[u]),p.join("")}},{}],266:[function(i,B,V){B.exports=function(g,m,y,v,T){var _=m.model||o,k=m.view||o,E=m.projection||o,A=m._ortho||!1,b=g.bounds,L=(T=T||p(_,k,E,b,A)).axis;u(a,k,_),u(a,E,a);for(var w=f,C=0;C<3;++C)w[C].lo=1/0,w[C].hi=-1/0,w[C].pixelsPerDataUnit=1/0;var S=t(e(a,a));e(a,a);for(var P=0;P<3;++P){var z=(P+1)%3,F=(P+2)%3,q=d;e:for(C=0;C<2;++C){var W=[];if(L[P]<0!=!!C){q[P]=b[C][P];for(var X=0;X<2;++X){q[z]=b[X^C][z];for(var Q=0;Q<2;++Q)q[F]=b[Q^X^C][F],W.push(q.slice())}var Z=A?5:4;for(X=Z;X===Z;++X){if(W.length===0)continue e;W=h.positive(W,S[X])}for(X=0;X<W.length;++X){F=W[X];var Y=c(d,a,F,y,v);for(Q=0;Q<3;++Q)w[Q].lo=Math.min(w[Q].lo,F[Q]),w[Q].hi=Math.max(w[Q].hi,F[Q]),Q!==P&&(w[Q].pixelsPerDataUnit=Math.min(w[Q].pixelsPerDataUnit,Math.abs(Y[Q])))}}}}return w};var t=i("extract-frustum-planes"),h=i("split-polygon"),p=i("./lib/cube.js"),u=i("gl-mat4/multiply"),e=i("gl-mat4/transpose"),l=i("gl-vec4/transformMat4"),o=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),a=new Float32Array(16);function n(g,m,y){this.lo=g,this.hi=m,this.pixelsPerDataUnit=y}var s=[0,0,0,1],r=[0,0,0,1];function c(g,m,y,v,T){for(var _=0;_<3;++_){for(var k=s,E=r,A=0;A<3;++A)E[A]=k[A]=y[A];E[3]=k[3]=1,E[_]+=1,l(E,E,m),E[3]<0&&(g[_]=1/0),k[_]-=1,l(k,k,m),k[3]<0&&(g[_]=1/0);var b=(k[0]/k[3]-E[0]/E[3])*v,L=(k[1]/k[3]-E[1]/E[3])*T;g[_]=.25*Math.sqrt(b*b+L*L)}return g}var f=[new n(1/0,-1/0,1/0),new n(1/0,-1/0,1/0),new n(1/0,-1/0,1/0)],d=[0,0,0]},{"./lib/cube.js":260,"extract-frustum-planes":248,"gl-mat4/multiply":301,"gl-mat4/transpose":312,"gl-vec4/transformMat4":432,"split-polygon":567}],267:[function(i,B,V){var t=i("typedarray-pool"),h=i("ndarray-ops"),p=i("ndarray"),u=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function e(n,s,r,c,f){this.gl=n,this.type=s,this.handle=r,this.length=c,this.usage=f}var l=e.prototype;function o(n,s,r,c,f,d){var g=f.length*f.BYTES_PER_ELEMENT;if(d<0)return n.bufferData(s,f,c),g;if(g+d>r)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return n.bufferSubData(s,d,f),r}function a(n,s){for(var r=t.malloc(n.length,s),c=n.length,f=0;f<c;++f)r[f]=n[f];return r}l.bind=function(){this.gl.bindBuffer(this.type,this.handle)},l.unbind=function(){this.gl.bindBuffer(this.type,null)},l.dispose=function(){this.gl.deleteBuffer(this.handle)},l.update=function(n,s){if(typeof s!="number"&&(s=-1),this.bind(),typeof n=="object"&&n.shape!==void 0){var r=n.dtype;if(u.indexOf(r)<0&&(r="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(r=gl.getExtension("OES_element_index_uint")&&r!=="uint16"?"uint32":"uint16"),r===n.dtype&&function(g,m){for(var y=1,v=m.length-1;v>=0;--v){if(m[v]!==y)return!1;y*=g[v]}return!0}(n.shape,n.stride))n.offset===0&&n.data.length===n.shape[0]?this.length=o(this.gl,this.type,this.length,this.usage,n.data,s):this.length=o(this.gl,this.type,this.length,this.usage,n.data.subarray(n.offset,n.shape[0]),s);else{var c=t.malloc(n.size,r),f=p(c,n.shape);h.assign(f,n),this.length=o(this.gl,this.type,this.length,this.usage,s<0?c:c.subarray(0,n.size),s),t.free(c)}}else if(Array.isArray(n)){var d;d=this.type===this.gl.ELEMENT_ARRAY_BUFFER?a(n,"uint16"):a(n,"float32"),this.length=o(this.gl,this.type,this.length,this.usage,s<0?d:d.subarray(0,n.length),s),t.free(d)}else if(typeof n=="object"&&typeof n.length=="number")this.length=o(this.gl,this.type,this.length,this.usage,n,s);else{if(typeof n!="number"&&n!==void 0)throw new Error("gl-buffer: Invalid data type");if(s>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(n|=0)<=0&&(n=1),this.gl.bufferData(this.type,0|n,this.usage),this.length=n}},B.exports=function(n,s,r,c){if(r=r||n.ARRAY_BUFFER,c=c||n.DYNAMIC_DRAW,r!==n.ARRAY_BUFFER&&r!==n.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(c!==n.DYNAMIC_DRAW&&c!==n.STATIC_DRAW&&c!==n.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var f=n.createBuffer(),d=new e(n,r,f,0,c);return d.update(s),d}},{ndarray:483,"ndarray-ops":478,"typedarray-pool":617}],268:[function(i,B,V){var t=i("gl-vec3");B.exports=function(p,u){var e=p.positions,l=p.vectors,o={positions:[],vertexIntensity:[],vertexIntensityBounds:p.vertexIntensityBounds,vectors:[],cells:[],coneOffset:p.coneOffset,colormap:p.colormap};if(p.positions.length===0)return u&&(u[0]=[0,0,0],u[1]=[0,0,0]),o;for(var a=0,n=1/0,s=-1/0,r=1/0,c=-1/0,f=1/0,d=-1/0,g=null,m=null,y=[],v=1/0,T=!1,_=0;_<e.length;_++){var k=e[_];n=Math.min(k[0],n),s=Math.max(k[0],s),r=Math.min(k[1],r),c=Math.max(k[1],c),f=Math.min(k[2],f),d=Math.max(k[2],d);var E=l[_];if(t.length(E)>a&&(a=t.length(E)),_){var A=2*t.distance(g,k)/(t.length(m)+t.length(E));A?(v=Math.min(v,A),T=!1):T=!0}T||(g=k,m=E),y.push(E)}var b=[n,r,f],L=[s,c,d];u&&(u[0]=b,u[1]=L),a===0&&(a=1);var w=1/a;isFinite(v)||(v=1),o.vectorScale=v;var C=p.coneSize||.5;p.absoluteConeSize&&(C=p.absoluteConeSize*w),o.coneScale=C,_=0;for(var S=0;_<e.length;_++)for(var P=(k=e[_])[0],z=k[1],F=k[2],q=y[_],W=t.length(q)*w,X=0;X<8;X++){o.positions.push([P,z,F,S++]),o.positions.push([P,z,F,S++]),o.positions.push([P,z,F,S++]),o.positions.push([P,z,F,S++]),o.positions.push([P,z,F,S++]),o.positions.push([P,z,F,S++]),o.vectors.push(q),o.vectors.push(q),o.vectors.push(q),o.vectors.push(q),o.vectors.push(q),o.vectors.push(q),o.vertexIntensity.push(W,W,W),o.vertexIntensity.push(W,W,W);var Q=o.positions.length;o.cells.push([Q-6,Q-5,Q-4],[Q-3,Q-2,Q-1])}return o};var h=i("./lib/shaders");B.exports.createMesh=i("./create_mesh"),B.exports.createConeMesh=function(p,u){return B.exports.createMesh(p,u,{shaders:h,traceType:"cone"})}},{"./create_mesh":269,"./lib/shaders":270,"gl-vec3":380}],269:[function(i,B,V){var t=i("gl-shader"),h=i("gl-buffer"),p=i("gl-vao"),u=i("gl-texture2d"),e=i("gl-mat4/multiply"),l=i("gl-mat4/invert"),o=i("ndarray"),a=i("colormap"),n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(d,g,m,y,v,T,_,k,E,A,b){this.gl=d,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=g,this.dirty=!0,this.triShader=m,this.pickShader=y,this.trianglePositions=v,this.triangleVectors=T,this.triangleColors=k,this.triangleUVs=E,this.triangleIds=_,this.triangleVAO=A,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=b,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=n,this._view=n,this._projection=n,this._resolution=[1,1]}var r=s.prototype;function c(d,g){var m=t(d,g.meshShader.vertex,g.meshShader.fragment,null,g.meshShader.attributes);return m.attributes.position.location=0,m.attributes.color.location=2,m.attributes.uv.location=3,m.attributes.vector.location=4,m}function f(d,g){var m=t(d,g.pickShader.vertex,g.pickShader.fragment,null,g.pickShader.attributes);return m.attributes.position.location=0,m.attributes.id.location=1,m.attributes.vector.location=4,m}r.isOpaque=function(){return this.opacity>=1},r.isTransparent=function(){return this.opacity<1},r.pickSlots=1,r.setPickBase=function(d){this.pickId=d},r.update=function(d){d=d||{};var g=this.gl;this.dirty=!0,"lightPosition"in d&&(this.lightPosition=d.lightPosition),"opacity"in d&&(this.opacity=d.opacity),"ambient"in d&&(this.ambientLight=d.ambient),"diffuse"in d&&(this.diffuseLight=d.diffuse),"specular"in d&&(this.specularLight=d.specular),"roughness"in d&&(this.roughness=d.roughness),"fresnel"in d&&(this.fresnel=d.fresnel),d.tubeScale!==void 0&&(this.tubeScale=d.tubeScale),d.vectorScale!==void 0&&(this.vectorScale=d.vectorScale),d.coneScale!==void 0&&(this.coneScale=d.coneScale),d.coneOffset!==void 0&&(this.coneOffset=d.coneOffset),d.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=g.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=g.LINEAR,this.texture.setPixels(function(J){for(var D=a({colormap:J,nshades:256,format:"rgba"}),U=new Uint8Array(1024),G=0;G<256;++G){for(var $=D[G],K=0;K<3;++K)U[4*G+K]=$[K];U[4*G+3]=255*$[3]}return o(U,[256,256,4],[4,0,1])}(d.colormap)),this.texture.generateMipmap());var m=d.cells,y=d.positions,v=d.vectors;if(y&&m&&v){var T=[],_=[],k=[],E=[],A=[];this.cells=m,this.positions=y,this.vectors=v;var b=d.meshColor||[1,1,1,1],L=d.vertexIntensity,w=1/0,C=-1/0;if(L)if(d.vertexIntensityBounds)w=+d.vertexIntensityBounds[0],C=+d.vertexIntensityBounds[1];else for(var S=0;S<L.length;++S){var P=L[S];w=Math.min(w,P),C=Math.max(C,P)}else for(S=0;S<y.length;++S)P=y[S][2],w=Math.min(w,P),C=Math.max(C,P);for(this.intensity=L||function(J){for(var D=J.length,U=new Array(D),G=0;G<D;++G)U[G]=J[G][2];return U}(y),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],S=0;S<y.length;++S)for(var z=y[S],F=0;F<3;++F)!isNaN(z[F])&&isFinite(z[F])&&(this.bounds[0][F]=Math.min(this.bounds[0][F],z[F]),this.bounds[1][F]=Math.max(this.bounds[1][F],z[F]));var q=0;e:for(S=0;S<m.length;++S){var W=m[S];switch(W.length){case 3:for(F=0;F<3;++F){z=y[Q=W[F]];for(var X=0;X<3;++X)if(isNaN(z[X])||!isFinite(z[X]))continue e}for(F=0;F<3;++F){var Q;z=y[Q=W[2-F]],T.push(z[0],z[1],z[2],z[3]);var Z=v[Q];_.push(Z[0],Z[1],Z[2],Z[3]||0);var Y,N=b;N.length===3?k.push(N[0],N[1],N[2],1):k.push(N[0],N[1],N[2],N[3]),Y=L?[(L[Q]-w)/(C-w),0]:[(z[2]-w)/(C-w),0],E.push(Y[0],Y[1]),A.push(S)}q+=1}}this.triangleCount=q,this.trianglePositions.update(T),this.triangleVectors.update(_),this.triangleColors.update(k),this.triangleUVs.update(E),this.triangleIds.update(new Uint32Array(A))}},r.drawTransparent=r.draw=function(d){d=d||{};for(var g=this.gl,m=d.model||n,y=d.view||n,v=d.projection||n,T=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],_=0;_<3;++_)T[0][_]=Math.max(T[0][_],this.clipBounds[0][_]),T[1][_]=Math.min(T[1][_],this.clipBounds[1][_]);var k={model:m,view:y,projection:v,inverseModel:n.slice(),clipBounds:T,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};k.inverseModel=l(k.inverseModel,k.model),g.disable(g.CULL_FACE),this.texture.bind(0);var E=new Array(16);for(e(E,k.view,k.model),e(E,k.projection,E),l(E,E),_=0;_<3;++_)k.eyePosition[_]=E[12+_]/E[15];var A=E[15];for(_=0;_<3;++_)A+=this.lightPosition[_]*E[4*_+3];for(_=0;_<3;++_){for(var b=E[12+_],L=0;L<3;++L)b+=E[4*L+_]*this.lightPosition[L];k.lightPosition[_]=b/A}if(this.triangleCount>0){var w=this.triShader;w.bind(),w.uniforms=k,this.triangleVAO.bind(),g.drawArrays(g.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},r.drawPick=function(d){d=d||{};for(var g=this.gl,m=d.model||n,y=d.view||n,v=d.projection||n,T=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],_=0;_<3;++_)T[0][_]=Math.max(T[0][_],this.clipBounds[0][_]),T[1][_]=Math.min(T[1][_],this.clipBounds[1][_]);this._model=[].slice.call(m),this._view=[].slice.call(y),this._projection=[].slice.call(v),this._resolution=[g.drawingBufferWidth,g.drawingBufferHeight];var k={model:m,view:y,projection:v,clipBounds:T,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},E=this.pickShader;E.bind(),E.uniforms=k,this.triangleCount>0&&(this.triangleVAO.bind(),g.drawArrays(g.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},r.pick=function(d){if(!d||d.id!==this.pickId)return null;var g=d.value[0]+256*d.value[1]+65536*d.value[2],m=this.cells[g],y=this.positions[m[1]].slice(0,3),v={position:y,dataCoordinate:y,index:Math.floor(m[1]/48)};return this.traceType==="cone"?v.index=Math.floor(m[1]/48):this.traceType==="streamtube"&&(v.intensity=this.intensity[m[1]],v.velocity=this.vectors[m[1]].slice(0,3),v.divergence=this.vectors[m[1]][3],v.index=g),v},r.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},B.exports=function(d,g,m){var y=m.shaders;arguments.length===1&&(d=(g=d).gl);var v=c(d,y),T=f(d,y),_=u(d,o(new Uint8Array([255,255,255,255]),[1,1,4]));_.generateMipmap(),_.minFilter=d.LINEAR_MIPMAP_LINEAR,_.magFilter=d.LINEAR;var k=h(d),E=h(d),A=h(d),b=h(d),L=h(d),w=p(d,[{buffer:k,type:d.FLOAT,size:4},{buffer:L,type:d.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:A,type:d.FLOAT,size:4},{buffer:b,type:d.FLOAT,size:2},{buffer:E,type:d.FLOAT,size:4}]),C=new s(d,_,v,T,k,E,L,A,b,w,m.traceType||"cone");return C.update(g),C}},{colormap:137,"gl-buffer":267,"gl-mat4/invert":299,"gl-mat4/multiply":301,"gl-shader":339,"gl-texture2d":356,"gl-vao":361,ndarray:483}],270:[function(i,B,V){var t=i("glslify"),h=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),p=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),u=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);V.meshShader={vertex:h,fragment:p,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},V.pickShader={vertex:u,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:442}],271:[function(i,B,V){B.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],272:[function(i,B,V){var t=i("./1.0/numbers");B.exports=function(h){return t[h]}},{"./1.0/numbers":271}],273:[function(i,B,V){B.exports=function(s){var r=s.gl,c=t(r),f=h(r,[{buffer:c,type:r.FLOAT,size:3,offset:0,stride:40},{buffer:c,type:r.FLOAT,size:4,offset:12,stride:40},{buffer:c,type:r.FLOAT,size:3,offset:28,stride:40}]),d=p(r);d.attributes.position.location=0,d.attributes.color.location=1,d.attributes.offset.location=2;var g=new e(r,c,f,d);return g.update(s),g};var t=i("gl-buffer"),h=i("gl-vao"),p=i("./shaders/index"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(s,r,c,f){this.gl=s,this.shader=f,this.buffer=r,this.vao=c,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var l=e.prototype;function o(s,r){for(var c=0;c<3;++c)s[0][c]=Math.min(s[0][c],r[c]),s[1][c]=Math.max(s[1][c],r[c])}l.isOpaque=function(){return!this.hasAlpha},l.isTransparent=function(){return this.hasAlpha},l.drawTransparent=l.draw=function(s){var r=this.gl,c=this.shader.uniforms;this.shader.bind();var f=c.view=s.view||u,d=c.projection=s.projection||u;c.model=s.model||u,c.clipBounds=this.clipBounds,c.opacity=this.opacity;var g=f[12],m=f[13],y=f[14],v=f[15],T=(s._ortho?2:1)*this.pixelRatio*(d[3]*g+d[7]*m+d[11]*y+d[15]*v)/r.drawingBufferHeight;this.vao.bind();for(var _=0;_<3;++_)r.lineWidth(this.lineWidth[_]*this.pixelRatio),c.capSize=this.capSize[_]*T,this.lineCount[_]&&r.drawArrays(r.LINES,this.lineOffset[_],this.lineCount[_]);this.vao.unbind()};var a=function(){for(var s=new Array(3),r=0;r<3;++r){for(var c=[],f=1;f<=2;++f)for(var d=-1;d<=1;d+=2){var g=[0,0,0];g[(f+r)%3]=d,c.push(g)}s[r]=c}return s}();function n(s,r,c,f){for(var d=a[f],g=0;g<d.length;++g){var m=d[g];s.push(r[0],r[1],r[2],c[0],c[1],c[2],c[3],m[0],m[1],m[2])}return d.length}l.update=function(s){"lineWidth"in(s=s||{})&&(this.lineWidth=s.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in s&&(this.capSize=s.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in s&&(this.opacity=+s.opacity,this.opacity<1&&(this.hasAlpha=!0));var r=s.color||[[0,0,0],[0,0,0],[0,0,0]],c=s.position,f=s.error;if(Array.isArray(r[0])||(r=[r,r,r]),c&&f){var d=[],g=c.length,m=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var y=0;y<3;++y){this.lineOffset[y]=m;e:for(var v=0;v<g;++v){for(var T=c[v],_=0;_<3;++_)if(isNaN(T[_])||!isFinite(T[_]))continue e;var k=f[v],E=r[y];if(Array.isArray(E[0])&&(E=r[v]),E.length===3?E=[E[0],E[1],E[2],1]:E.length===4&&(E=[E[0],E[1],E[2],E[3]],!this.hasAlpha&&E[3]<1&&(this.hasAlpha=!0)),!isNaN(k[0][y])&&!isNaN(k[1][y])){var A;k[0][y]<0&&((A=T.slice())[y]+=k[0][y],d.push(T[0],T[1],T[2],E[0],E[1],E[2],E[3],0,0,0,A[0],A[1],A[2],E[0],E[1],E[2],E[3],0,0,0),o(this.bounds,A),m+=2+n(d,A,E,y)),k[1][y]>0&&((A=T.slice())[y]+=k[1][y],d.push(T[0],T[1],T[2],E[0],E[1],E[2],E[3],0,0,0,A[0],A[1],A[2],E[0],E[1],E[2],E[3],0,0,0),o(this.bounds,A),m+=2+n(d,A,E,y))}}this.lineCount[y]=m-this.lineOffset[y]}this.buffer.update(d)}},l.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":275,"gl-buffer":267,"gl-vao":361}],274:[function(i,B,V){arguments[4][265][0].apply(V,arguments)},{dup:265}],275:[function(i,B,V){var t=i("glslify"),h=i("gl-shader"),p=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),u=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);B.exports=function(e){return h(e,p,u,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":339,glslify:274}],276:[function(i,B,V){var t=i("gl-texture2d");B.exports=function(g,m,y,v){h||(h=g.FRAMEBUFFER_UNSUPPORTED,p=g.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,u=g.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,e=g.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var T=g.getExtension("WEBGL_draw_buffers");if(!l&&T&&function(w,C){var S=w.getParameter(C.MAX_COLOR_ATTACHMENTS_WEBGL);l=new Array(S+1);for(var P=0;P<=S;++P){for(var z=new Array(S),F=0;F<P;++F)z[F]=w.COLOR_ATTACHMENT0+F;for(F=P;F<S;++F)z[F]=w.NONE;l[P]=z}}(g,T),Array.isArray(m)&&(v=y,y=0|m[1],m=0|m[0]),typeof m!="number")throw new Error("gl-fbo: Missing shape parameter");var _=g.getParameter(g.MAX_RENDERBUFFER_SIZE);if(m<0||m>_||y<0||y>_)throw new Error("gl-fbo: Parameters are too large for FBO");var k=1;if("color"in(v=v||{})){if((k=Math.max(0|v.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(k>1){if(!T)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(k>g.getParameter(T.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+k+" draw buffers")}}var E=g.UNSIGNED_BYTE,A=g.getExtension("OES_texture_float");if(v.float&&k>0){if(!A)throw new Error("gl-fbo: Context does not support floating point textures");E=g.FLOAT}else v.preferFloat&&k>0&&A&&(E=g.FLOAT);var b=!0;"depth"in v&&(b=!!v.depth);var L=!1;return"stencil"in v&&(L=!!v.stencil),new c(g,m,y,E,k,b,L,T)};var h,p,u,e,l=null;function o(g){return[g.getParameter(g.FRAMEBUFFER_BINDING),g.getParameter(g.RENDERBUFFER_BINDING),g.getParameter(g.TEXTURE_BINDING_2D)]}function a(g,m){g.bindFramebuffer(g.FRAMEBUFFER,m[0]),g.bindRenderbuffer(g.RENDERBUFFER,m[1]),g.bindTexture(g.TEXTURE_2D,m[2])}function n(g){switch(g){case h:throw new Error("gl-fbo: Framebuffer unsupported");case p:throw new Error("gl-fbo: Framebuffer incomplete attachment");case u:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case e:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function s(g,m,y,v,T,_){if(!v)return null;var k=t(g,m,y,T,v);return k.magFilter=g.NEAREST,k.minFilter=g.NEAREST,k.mipSamples=1,k.bind(),g.framebufferTexture2D(g.FRAMEBUFFER,_,g.TEXTURE_2D,k.handle,0),k}function r(g,m,y,v,T){var _=g.createRenderbuffer();return g.bindRenderbuffer(g.RENDERBUFFER,_),g.renderbufferStorage(g.RENDERBUFFER,v,m,y),g.framebufferRenderbuffer(g.FRAMEBUFFER,T,g.RENDERBUFFER,_),_}function c(g,m,y,v,T,_,k,E){this.gl=g,this._shape=[0|m,0|y],this._destroyed=!1,this._ext=E,this.color=new Array(T);for(var A=0;A<T;++A)this.color[A]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=v,this._useDepth=_,this._useStencil=k;var b=this,L=[0|m,0|y];Object.defineProperties(L,{0:{get:function(){return b._shape[0]},set:function(w){return b.width=w}},1:{get:function(){return b._shape[1]},set:function(w){return b.height=w}}}),this._shapeVector=L,function(w){var C=o(w.gl),S=w.gl,P=w.handle=S.createFramebuffer(),z=w._shape[0],F=w._shape[1],q=w.color.length,W=w._ext,X=w._useStencil,Q=w._useDepth,Z=w._colorType;S.bindFramebuffer(S.FRAMEBUFFER,P);for(var Y=0;Y<q;++Y)w.color[Y]=s(S,z,F,Z,S.RGBA,S.COLOR_ATTACHMENT0+Y);q===0?(w._color_rb=r(S,z,F,S.RGBA4,S.COLOR_ATTACHMENT0),W&&W.drawBuffersWEBGL(l[0])):q>1&&W.drawBuffersWEBGL(l[q]);var N=S.getExtension("WEBGL_depth_texture");N?X?w.depth=s(S,z,F,N.UNSIGNED_INT_24_8_WEBGL,S.DEPTH_STENCIL,S.DEPTH_STENCIL_ATTACHMENT):Q&&(w.depth=s(S,z,F,S.UNSIGNED_SHORT,S.DEPTH_COMPONENT,S.DEPTH_ATTACHMENT)):Q&&X?w._depth_rb=r(S,z,F,S.DEPTH_STENCIL,S.DEPTH_STENCIL_ATTACHMENT):Q?w._depth_rb=r(S,z,F,S.DEPTH_COMPONENT16,S.DEPTH_ATTACHMENT):X&&(w._depth_rb=r(S,z,F,S.STENCIL_INDEX,S.STENCIL_ATTACHMENT));var J=S.checkFramebufferStatus(S.FRAMEBUFFER);if(J!==S.FRAMEBUFFER_COMPLETE){for(w._destroyed=!0,S.bindFramebuffer(S.FRAMEBUFFER,null),S.deleteFramebuffer(w.handle),w.handle=null,w.depth&&(w.depth.dispose(),w.depth=null),w._depth_rb&&(S.deleteRenderbuffer(w._depth_rb),w._depth_rb=null),Y=0;Y<w.color.length;++Y)w.color[Y].dispose(),w.color[Y]=null;w._color_rb&&(S.deleteRenderbuffer(w._color_rb),w._color_rb=null),a(S,C),n(J)}a(S,C)}(this)}var f=c.prototype;function d(g,m,y){if(g._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(g._shape[0]!==m||g._shape[1]!==y){var v=g.gl,T=v.getParameter(v.MAX_RENDERBUFFER_SIZE);if(m<0||m>T||y<0||y>T)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");g._shape[0]=m,g._shape[1]=y;for(var _=o(v),k=0;k<g.color.length;++k)g.color[k].shape=g._shape;g._color_rb&&(v.bindRenderbuffer(v.RENDERBUFFER,g._color_rb),v.renderbufferStorage(v.RENDERBUFFER,v.RGBA4,g._shape[0],g._shape[1])),g.depth&&(g.depth.shape=g._shape),g._depth_rb&&(v.bindRenderbuffer(v.RENDERBUFFER,g._depth_rb),g._useDepth&&g._useStencil?v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_STENCIL,g._shape[0],g._shape[1]):g._useDepth?v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_COMPONENT16,g._shape[0],g._shape[1]):g._useStencil&&v.renderbufferStorage(v.RENDERBUFFER,v.STENCIL_INDEX,g._shape[0],g._shape[1])),v.bindFramebuffer(v.FRAMEBUFFER,g.handle);var E=v.checkFramebufferStatus(v.FRAMEBUFFER);E!==v.FRAMEBUFFER_COMPLETE&&(g.dispose(),a(v,_),n(E)),a(v,_)}}Object.defineProperties(f,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(g){if(Array.isArray(g)||(g=[0|g,0|g]),g.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var m=0|g[0],y=0|g[1];return d(this,m,y),[m,y]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(g){return d(this,g|=0,this._shape[1]),g},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(g){return g|=0,d(this,this._shape[0],g),g},enumerable:!1}}),f.bind=function(){if(!this._destroyed){var g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,this.handle),g.viewport(0,0,this._shape[0],this._shape[1])}},f.dispose=function(){if(!this._destroyed){this._destroyed=!0;var g=this.gl;g.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(g.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var m=0;m<this.color.length;++m)this.color[m].dispose(),this.color[m]=null;this._color_rb&&(g.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":356}],277:[function(i,B,V){var t=i("sprintf-js").sprintf,h=i("gl-constants/lookup"),p=i("glsl-shader-name"),u=i("add-line-numbers");B.exports=function(e,l,o){var a=p(l)||"of unknown name (see npm glsl-shader-name)",n="unknown type";o!==void 0&&(n=o===h.FRAGMENT_SHADER?"fragment":"vertex");for(var s=t(`Error compiling %s shader %s:
`,n,a),r=t("%s%s",s,e),c=e.split(`
`),f={},d=0;d<c.length;d++){var g=c[d];if(g!==""&&g!=="\0"){var m=parseInt(g.split(":")[2]);if(isNaN(m))throw new Error(t("Could not parse error: %s",g));f[m]=g}}var y=u(l).split(`
`);for(d=0;d<y.length;d++)if(f[d+3]||f[d+2]||f[d+1]){var v=y[d];if(s+=v+`
`,f[d+1]){var T=f[d+1];T=T.substr(T.split(":",3).join(":").length+1).trim(),s+=t(`^^^ %s

`,T)}}return{long:s.trim(),short:r.trim()}}},{"add-line-numbers":72,"gl-constants/lookup":272,"glsl-shader-name":434,"sprintf-js":568}],278:[function(i,B,V){B.exports=function(r,c){var f=r.gl,d=u(f,l.vertex,l.fragment),g=u(f,l.pickVertex,l.pickFragment),m=e(f),y=e(f),v=e(f),T=e(f),_=new o(r,d,g,m,y,v,T);return _.update(c),r.addObject(_),_};var t=i("binary-search-bounds"),h=i("iota-array"),p=i("typedarray-pool"),u=i("gl-shader"),e=i("gl-buffer"),l=i("./lib/shaders");function o(r,c,f,d,g,m,y){this.plot=r,this.shader=c,this.pickShader=f,this.positionBuffer=d,this.weightBuffer=g,this.colorBuffer=m,this.idBuffer=y,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var a,n=o.prototype,s=[0,0,1,0,0,1,1,0,1,1,0,1];n.draw=(a=[1,0,0,0,1,0,0,0,1],function(){var r=this.plot,c=this.shader,f=this.bounds,d=this.numVertices;if(!(d<=0)){var g=r.gl,m=r.dataBox,y=f[2]-f[0],v=f[3]-f[1],T=m[2]-m[0],_=m[3]-m[1];a[0]=2*y/T,a[4]=2*v/_,a[6]=2*(f[0]-m[0])/T-1,a[7]=2*(f[1]-m[1])/_-1,c.bind();var k=c.uniforms;k.viewTransform=a,k.shape=this.shape;var E=c.attributes;this.positionBuffer.bind(),E.position.pointer(),this.weightBuffer.bind(),E.weight.pointer(g.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),E.color.pointer(g.UNSIGNED_BYTE,!0),g.drawArrays(g.TRIANGLES,0,d)}}),n.drawPick=function(){var r=[1,0,0,0,1,0,0,0,1],c=[0,0,0,0];return function(f){var d=this.plot,g=this.pickShader,m=this.bounds,y=this.numVertices;if(!(y<=0)){var v=d.gl,T=d.dataBox,_=m[2]-m[0],k=m[3]-m[1],E=T[2]-T[0],A=T[3]-T[1];r[0]=2*_/E,r[4]=2*k/A,r[6]=2*(m[0]-T[0])/E-1,r[7]=2*(m[1]-T[1])/A-1;for(var b=0;b<4;++b)c[b]=f>>8*b&255;this.pickOffset=f,g.bind();var L=g.uniforms;L.viewTransform=r,L.pickOffset=c,L.shape=this.shape;var w=g.attributes;return this.positionBuffer.bind(),w.position.pointer(),this.weightBuffer.bind(),w.weight.pointer(v.UNSIGNED_BYTE,!1),this.idBuffer.bind(),w.pickId.pointer(v.UNSIGNED_BYTE,!1),v.drawArrays(v.TRIANGLES,0,y),f+this.shape[0]*this.shape[1]}}}(),n.pick=function(r,c,f){var d=this.pickOffset,g=this.shape[0]*this.shape[1];if(f<d||f>=d+g)return null;var m=f-d,y=this.xData,v=this.yData;return{object:this,pointId:m,dataCoord:[y[m%this.shape[0]],v[m/this.shape[0]|0]]}},n.update=function(r){var c=(r=r||{}).shape||[0,0],f=r.x||h(c[0]),d=r.y||h(c[1]),g=r.z||new Float32Array(c[0]*c[1]),m=r.zsmooth!==!1;this.xData=f,this.yData=d;var y,v,T,_,k=r.colorLevels||[0],E=r.colorValues||[0,0,0,1],A=k.length,b=this.bounds;m?(y=b[0]=f[0],v=b[1]=d[0],T=b[2]=f[f.length-1],_=b[3]=d[d.length-1]):(y=b[0]=f[0]+(f[1]-f[0])/2,v=b[1]=d[0]+(d[1]-d[0])/2,T=b[2]=f[f.length-1]+(f[f.length-1]-f[f.length-2])/2,_=b[3]=d[d.length-1]+(d[d.length-1]-d[d.length-2])/2);var L=1/(T-y),w=1/(_-v),C=c[0],S=c[1];this.shape=[C,S];var P=(m?(C-1)*(S-1):C*S)*(s.length>>>1);this.numVertices=P;for(var z=p.mallocUint8(4*P),F=p.mallocFloat32(2*P),q=p.mallocUint8(2*P),W=p.mallocUint32(P),X=0,Q=m?C-1:C,Z=m?S-1:S,Y=0;Y<Z;++Y){var N,J;m?(N=w*(d[Y]-v),J=w*(d[Y+1]-v)):(N=Y<S-1?w*(d[Y]-(d[Y+1]-d[Y])/2-v):w*(d[Y]-(d[Y]-d[Y-1])/2-v),J=Y<S-1?w*(d[Y]+(d[Y+1]-d[Y])/2-v):w*(d[Y]+(d[Y]-d[Y-1])/2-v));for(var D=0;D<Q;++D){var U,G;m?(U=L*(f[D]-y),G=L*(f[D+1]-y)):(U=D<C-1?L*(f[D]-(f[D+1]-f[D])/2-y):L*(f[D]-(f[D]-f[D-1])/2-y),G=D<C-1?L*(f[D]+(f[D+1]-f[D])/2-y):L*(f[D]+(f[D]-f[D-1])/2-y));for(var $=0;$<s.length;$+=2){var K,re,ne,ae,ie=s[$],he=s[$+1],se=g[m?(Y+he)*C+(D+ie):Y*C+D],de=t.le(k,se);if(de<0)K=E[0],re=E[1],ne=E[2],ae=E[3];else if(de===A-1)K=E[4*A-4],re=E[4*A-3],ne=E[4*A-2],ae=E[4*A-1];else{var ce=(se-k[de])/(k[de+1]-k[de]),ve=1-ce,Ee=4*de,Le=4*(de+1);K=ve*E[Ee]+ce*E[Le],re=ve*E[Ee+1]+ce*E[Le+1],ne=ve*E[Ee+2]+ce*E[Le+2],ae=ve*E[Ee+3]+ce*E[Le+3]}z[4*X]=255*K,z[4*X+1]=255*re,z[4*X+2]=255*ne,z[4*X+3]=255*ae,F[2*X]=.5*U+.5*G,F[2*X+1]=.5*N+.5*J,q[2*X]=ie,q[2*X+1]=he,W[X]=Y*C+D,X+=1}}}this.positionBuffer.update(F),this.weightBuffer.update(q),this.colorBuffer.update(z),this.idBuffer.update(W),p.free(F),p.free(z),p.free(q),p.free(W)},n.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":279,"binary-search-bounds":103,"gl-buffer":267,"gl-shader":339,"iota-array":451,"typedarray-pool":617}],279:[function(i,B,V){var t=i("glslify");B.exports={fragment:t([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:442}],280:[function(i,B,V){var t=i("glslify"),h=i("gl-shader"),p=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),u=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),l=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];V.createShader=function(o){return h(o,p,u,null,l)},V.createPickShader=function(o){return h(o,p,e,null,l)}},{"gl-shader":339,glslify:282}],281:[function(i,B,V){B.exports=function(y){var v=y.gl||y.scene&&y.scene.gl,T=n(v);T.attributes.position.location=0,T.attributes.nextPosition.location=1,T.attributes.arcLength.location=2,T.attributes.lineWidth.location=3,T.attributes.color.location=4;var _=s(v);_.attributes.position.location=0,_.attributes.nextPosition.location=1,_.attributes.arcLength.location=2,_.attributes.lineWidth.location=3,_.attributes.color.location=4;for(var k=t(v),E=h(v,[{buffer:k,size:3,offset:0,stride:48},{buffer:k,size:3,offset:12,stride:48},{buffer:k,size:1,offset:24,stride:48},{buffer:k,size:1,offset:28,stride:48},{buffer:k,size:4,offset:32,stride:48}]),A=o(new Array(1024),[256,1,4]),b=0;b<1024;++b)A.data[b]=255;var L=p(v,A);L.wrap=v.REPEAT;var w=new g(v,T,_,k,E,L);return w.update(y),w};var t=i("gl-buffer"),h=i("gl-vao"),p=i("gl-texture2d"),u=new Uint8Array(4),e=new Float32Array(u.buffer),l=i("binary-search-bounds"),o=i("ndarray"),a=i("./lib/shaders"),n=a.createShader,s=a.createPickShader,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function c(y,v){for(var T=0,_=0;_<3;++_){var k=y[_]-v[_];T+=k*k}return Math.sqrt(T)}function f(y){for(var v=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)v[0][T]=Math.max(y[0][T],v[0][T]),v[1][T]=Math.min(y[1][T],v[1][T]);return v}function d(y,v,T,_){this.arcLength=y,this.position=v,this.index=T,this.dataCoordinate=_}function g(y,v,T,_,k,E){this.gl=y,this.shader=v,this.pickShader=T,this.buffer=_,this.vao=k,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=E,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var m=g.prototype;m.isTransparent=function(){return this.hasAlpha},m.isOpaque=function(){return!this.hasAlpha},m.pickSlots=1,m.setPickBase=function(y){this.pickId=y},m.drawTransparent=m.draw=function(y){if(this.vertexCount){var v=this.gl,T=this.shader,_=this.vao;T.bind(),T.uniforms={model:y.model||r,view:y.view||r,projection:y.projection||r,clipBounds:f(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[v.drawingBufferWidth,v.drawingBufferHeight],pixelRatio:this.pixelRatio},_.bind(),_.draw(v.TRIANGLE_STRIP,this.vertexCount),_.unbind()}},m.drawPick=function(y){if(this.vertexCount){var v=this.gl,T=this.pickShader,_=this.vao;T.bind(),T.uniforms={model:y.model||r,view:y.view||r,projection:y.projection||r,pickId:this.pickId,clipBounds:f(this.clipBounds),screenShape:[v.drawingBufferWidth,v.drawingBufferHeight],pixelRatio:this.pixelRatio},_.bind(),_.draw(v.TRIANGLE_STRIP,this.vertexCount),_.unbind()}},m.update=function(y){var v,T;this.dirty=!0;var _=!!y.connectGaps;"dashScale"in y&&(this.dashScale=y.dashScale),this.hasAlpha=!1,"opacity"in y&&(this.opacity=+y.opacity,this.opacity<1&&(this.hasAlpha=!0));var k=[],E=[],A=[],b=0,L=0,w=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],C=y.position||y.positions;if(C){var S=y.color||y.colors||[0,0,0,1],P=y.lineWidth||1,z=!1;e:for(v=1;v<C.length;++v){var F,q,W,X=C[v-1],Q=C[v];for(E.push(b),A.push(X.slice()),T=0;T<3;++T){if(isNaN(X[T])||isNaN(Q[T])||!isFinite(X[T])||!isFinite(Q[T])){if(!_&&k.length>0){for(var Z=0;Z<24;++Z)k.push(k[k.length-12]);L+=2,z=!0}continue e}w[0][T]=Math.min(w[0][T],X[T],Q[T]),w[1][T]=Math.max(w[1][T],X[T],Q[T])}Array.isArray(S[0])?(F=S.length>v-1?S[v-1]:S.length>0?S[S.length-1]:[0,0,0,1],q=S.length>v?S[v]:S.length>0?S[S.length-1]:[0,0,0,1]):F=q=S,F.length===3&&(F=[F[0],F[1],F[2],1]),q.length===3&&(q=[q[0],q[1],q[2],1]),!this.hasAlpha&&F[3]<1&&(this.hasAlpha=!0),W=Array.isArray(P)?P.length>v-1?P[v-1]:P.length>0?P[P.length-1]:[0,0,0,1]:P;var Y=b;if(b+=c(X,Q),z){for(T=0;T<2;++T)k.push(X[0],X[1],X[2],Q[0],Q[1],Q[2],Y,W,F[0],F[1],F[2],F[3]);L+=2,z=!1}k.push(X[0],X[1],X[2],Q[0],Q[1],Q[2],Y,W,F[0],F[1],F[2],F[3],X[0],X[1],X[2],Q[0],Q[1],Q[2],Y,-W,F[0],F[1],F[2],F[3],Q[0],Q[1],Q[2],X[0],X[1],X[2],b,-W,q[0],q[1],q[2],q[3],Q[0],Q[1],Q[2],X[0],X[1],X[2],b,W,q[0],q[1],q[2],q[3]),L+=4}}if(this.buffer.update(k),E.push(b),A.push(C[C.length-1].slice()),this.bounds=w,this.vertexCount=L,this.points=A,this.arcLength=E,"dashes"in y){var N=y.dashes.slice();for(N.unshift(0),v=1;v<N.length;++v)N[v]=N[v-1]+N[v];var J=o(new Array(1024),[256,1,4]);for(v=0;v<256;++v){for(T=0;T<4;++T)J.set(v,0,T,0);1&l.le(N,N[N.length-1]*v/255)?J.set(v,0,0,0):J.set(v,0,0,255)}this.texture.setPixels(J)}},m.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},m.pick=function(y){if(!y||y.id!==this.pickId)return null;var v=function(C,S,P,z){return u[0]=z,u[1]=P,u[2]=S,u[3]=C,e[0]}(y.value[0],y.value[1],y.value[2],0),T=l.le(this.arcLength,v);if(T<0)return null;if(T===this.arcLength.length-1)return new d(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),T);for(var _=this.points[T],k=this.points[Math.min(T+1,this.points.length-1)],E=(v-this.arcLength[T])/(this.arcLength[T+1]-this.arcLength[T]),A=1-E,b=[0,0,0],L=0;L<3;++L)b[L]=A*_[L]+E*k[L];var w=Math.min(E<.5?T:T+1,this.points.length-1);return new d(v,b,w,this.points[w])}},{"./lib/shaders":280,"binary-search-bounds":103,"gl-buffer":267,"gl-texture2d":356,"gl-vao":361,ndarray:483}],282:[function(i,B,V){arguments[4][265][0].apply(V,arguments)},{dup:265}],283:[function(i,B,V){B.exports=function(t,h){var p=h[0],u=h[1],e=h[2],l=h[3],o=h[4],a=h[5],n=h[6],s=h[7],r=h[8],c=h[9],f=h[10],d=h[11],g=h[12],m=h[13],y=h[14],v=h[15];return t[0]=a*(f*v-d*y)-c*(n*v-s*y)+m*(n*d-s*f),t[1]=-(u*(f*v-d*y)-c*(e*v-l*y)+m*(e*d-l*f)),t[2]=u*(n*v-s*y)-a*(e*v-l*y)+m*(e*s-l*n),t[3]=-(u*(n*d-s*f)-a*(e*d-l*f)+c*(e*s-l*n)),t[4]=-(o*(f*v-d*y)-r*(n*v-s*y)+g*(n*d-s*f)),t[5]=p*(f*v-d*y)-r*(e*v-l*y)+g*(e*d-l*f),t[6]=-(p*(n*v-s*y)-o*(e*v-l*y)+g*(e*s-l*n)),t[7]=p*(n*d-s*f)-o*(e*d-l*f)+r*(e*s-l*n),t[8]=o*(c*v-d*m)-r*(a*v-s*m)+g*(a*d-s*c),t[9]=-(p*(c*v-d*m)-r*(u*v-l*m)+g*(u*d-l*c)),t[10]=p*(a*v-s*m)-o*(u*v-l*m)+g*(u*s-l*a),t[11]=-(p*(a*d-s*c)-o*(u*d-l*c)+r*(u*s-l*a)),t[12]=-(o*(c*y-f*m)-r*(a*y-n*m)+g*(a*f-n*c)),t[13]=p*(c*y-f*m)-r*(u*y-e*m)+g*(u*f-e*c),t[14]=-(p*(a*y-n*m)-o*(u*y-e*m)+g*(u*n-e*a)),t[15]=p*(a*f-n*c)-o*(u*f-e*c)+r*(u*n-e*a),t}},{}],284:[function(i,B,V){B.exports=function(t){var h=new Float32Array(16);return h[0]=t[0],h[1]=t[1],h[2]=t[2],h[3]=t[3],h[4]=t[4],h[5]=t[5],h[6]=t[6],h[7]=t[7],h[8]=t[8],h[9]=t[9],h[10]=t[10],h[11]=t[11],h[12]=t[12],h[13]=t[13],h[14]=t[14],h[15]=t[15],h}},{}],285:[function(i,B,V){B.exports=function(t,h){return t[0]=h[0],t[1]=h[1],t[2]=h[2],t[3]=h[3],t[4]=h[4],t[5]=h[5],t[6]=h[6],t[7]=h[7],t[8]=h[8],t[9]=h[9],t[10]=h[10],t[11]=h[11],t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15],t}},{}],286:[function(i,B,V){B.exports=function(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],287:[function(i,B,V){B.exports=function(t){var h=t[0],p=t[1],u=t[2],e=t[3],l=t[4],o=t[5],a=t[6],n=t[7],s=t[8],r=t[9],c=t[10],f=t[11],d=t[12],g=t[13],m=t[14],y=t[15];return(h*o-p*l)*(c*y-f*m)-(h*a-u*l)*(r*y-f*g)+(h*n-e*l)*(r*m-c*g)+(p*a-u*o)*(s*y-f*d)-(p*n-e*o)*(s*m-c*d)+(u*n-e*a)*(s*g-r*d)}},{}],288:[function(i,B,V){B.exports=function(t,h){var p=h[0],u=h[1],e=h[2],l=h[3],o=p+p,a=u+u,n=e+e,s=p*o,r=u*o,c=u*a,f=e*o,d=e*a,g=e*n,m=l*o,y=l*a,v=l*n;return t[0]=1-c-g,t[1]=r+v,t[2]=f-y,t[3]=0,t[4]=r-v,t[5]=1-s-g,t[6]=d+m,t[7]=0,t[8]=f+y,t[9]=d-m,t[10]=1-s-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],289:[function(i,B,V){B.exports=function(t,h,p){var u,e,l,o=p[0],a=p[1],n=p[2],s=Math.sqrt(o*o+a*a+n*n);return Math.abs(s)<1e-6?null:(o*=s=1/s,a*=s,n*=s,u=Math.sin(h),e=Math.cos(h),l=1-e,t[0]=o*o*l+e,t[1]=a*o*l+n*u,t[2]=n*o*l-a*u,t[3]=0,t[4]=o*a*l-n*u,t[5]=a*a*l+e,t[6]=n*a*l+o*u,t[7]=0,t[8]=o*n*l+a*u,t[9]=a*n*l-o*u,t[10]=n*n*l+e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}},{}],290:[function(i,B,V){B.exports=function(t,h,p){var u=h[0],e=h[1],l=h[2],o=h[3],a=u+u,n=e+e,s=l+l,r=u*a,c=u*n,f=u*s,d=e*n,g=e*s,m=l*s,y=o*a,v=o*n,T=o*s;return t[0]=1-(d+m),t[1]=c+T,t[2]=f-v,t[3]=0,t[4]=c-T,t[5]=1-(r+m),t[6]=g+y,t[7]=0,t[8]=f+v,t[9]=g-y,t[10]=1-(r+d),t[11]=0,t[12]=p[0],t[13]=p[1],t[14]=p[2],t[15]=1,t}},{}],291:[function(i,B,V){B.exports=function(t,h){return t[0]=h[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=h[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],292:[function(i,B,V){B.exports=function(t,h){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=h[0],t[13]=h[1],t[14]=h[2],t[15]=1,t}},{}],293:[function(i,B,V){B.exports=function(t,h){var p=Math.sin(h),u=Math.cos(h);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=p,t[7]=0,t[8]=0,t[9]=-p,t[10]=u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],294:[function(i,B,V){B.exports=function(t,h){var p=Math.sin(h),u=Math.cos(h);return t[0]=u,t[1]=0,t[2]=-p,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=p,t[9]=0,t[10]=u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],295:[function(i,B,V){B.exports=function(t,h){var p=Math.sin(h),u=Math.cos(h);return t[0]=u,t[1]=p,t[2]=0,t[3]=0,t[4]=-p,t[5]=u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],296:[function(i,B,V){B.exports=function(t,h,p,u,e,l,o){var a=1/(p-h),n=1/(e-u),s=1/(l-o);return t[0]=2*l*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*l*n,t[6]=0,t[7]=0,t[8]=(p+h)*a,t[9]=(e+u)*n,t[10]=(o+l)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*l*2*s,t[15]=0,t}},{}],297:[function(i,B,V){B.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],298:[function(i,B,V){B.exports={create:i("./create"),clone:i("./clone"),copy:i("./copy"),identity:i("./identity"),transpose:i("./transpose"),invert:i("./invert"),adjoint:i("./adjoint"),determinant:i("./determinant"),multiply:i("./multiply"),translate:i("./translate"),scale:i("./scale"),rotate:i("./rotate"),rotateX:i("./rotateX"),rotateY:i("./rotateY"),rotateZ:i("./rotateZ"),fromRotation:i("./fromRotation"),fromRotationTranslation:i("./fromRotationTranslation"),fromScaling:i("./fromScaling"),fromTranslation:i("./fromTranslation"),fromXRotation:i("./fromXRotation"),fromYRotation:i("./fromYRotation"),fromZRotation:i("./fromZRotation"),fromQuat:i("./fromQuat"),frustum:i("./frustum"),perspective:i("./perspective"),perspectiveFromFieldOfView:i("./perspectiveFromFieldOfView"),ortho:i("./ortho"),lookAt:i("./lookAt"),str:i("./str")}},{"./adjoint":283,"./clone":284,"./copy":285,"./create":286,"./determinant":287,"./fromQuat":288,"./fromRotation":289,"./fromRotationTranslation":290,"./fromScaling":291,"./fromTranslation":292,"./fromXRotation":293,"./fromYRotation":294,"./fromZRotation":295,"./frustum":296,"./identity":297,"./invert":299,"./lookAt":300,"./multiply":301,"./ortho":302,"./perspective":303,"./perspectiveFromFieldOfView":304,"./rotate":305,"./rotateX":306,"./rotateY":307,"./rotateZ":308,"./scale":309,"./str":310,"./translate":311,"./transpose":312}],299:[function(i,B,V){B.exports=function(t,h){var p=h[0],u=h[1],e=h[2],l=h[3],o=h[4],a=h[5],n=h[6],s=h[7],r=h[8],c=h[9],f=h[10],d=h[11],g=h[12],m=h[13],y=h[14],v=h[15],T=p*a-u*o,_=p*n-e*o,k=p*s-l*o,E=u*n-e*a,A=u*s-l*a,b=e*s-l*n,L=r*m-c*g,w=r*y-f*g,C=r*v-d*g,S=c*y-f*m,P=c*v-d*m,z=f*v-d*y,F=T*z-_*P+k*S+E*C-A*w+b*L;return F?(F=1/F,t[0]=(a*z-n*P+s*S)*F,t[1]=(e*P-u*z-l*S)*F,t[2]=(m*b-y*A+v*E)*F,t[3]=(f*A-c*b-d*E)*F,t[4]=(n*C-o*z-s*w)*F,t[5]=(p*z-e*C+l*w)*F,t[6]=(y*k-g*b-v*_)*F,t[7]=(r*b-f*k+d*_)*F,t[8]=(o*P-a*C+s*L)*F,t[9]=(u*C-p*P-l*L)*F,t[10]=(g*A-m*k+v*T)*F,t[11]=(c*k-r*A-d*T)*F,t[12]=(a*w-o*S-n*L)*F,t[13]=(p*S-u*w+e*L)*F,t[14]=(m*_-g*E-y*T)*F,t[15]=(r*E-c*_+f*T)*F,t):null}},{}],300:[function(i,B,V){var t=i("./identity");B.exports=function(h,p,u,e){var l,o,a,n,s,r,c,f,d,g,m=p[0],y=p[1],v=p[2],T=e[0],_=e[1],k=e[2],E=u[0],A=u[1],b=u[2];return Math.abs(m-E)<1e-6&&Math.abs(y-A)<1e-6&&Math.abs(v-b)<1e-6?t(h):(c=m-E,f=y-A,d=v-b,g=1/Math.sqrt(c*c+f*f+d*d),l=_*(d*=g)-k*(f*=g),o=k*(c*=g)-T*d,a=T*f-_*c,(g=Math.sqrt(l*l+o*o+a*a))?(l*=g=1/g,o*=g,a*=g):(l=0,o=0,a=0),n=f*a-d*o,s=d*l-c*a,r=c*o-f*l,(g=Math.sqrt(n*n+s*s+r*r))?(n*=g=1/g,s*=g,r*=g):(n=0,s=0,r=0),h[0]=l,h[1]=n,h[2]=c,h[3]=0,h[4]=o,h[5]=s,h[6]=f,h[7]=0,h[8]=a,h[9]=r,h[10]=d,h[11]=0,h[12]=-(l*m+o*y+a*v),h[13]=-(n*m+s*y+r*v),h[14]=-(c*m+f*y+d*v),h[15]=1,h)}},{"./identity":297}],301:[function(i,B,V){B.exports=function(t,h,p){var u=h[0],e=h[1],l=h[2],o=h[3],a=h[4],n=h[5],s=h[6],r=h[7],c=h[8],f=h[9],d=h[10],g=h[11],m=h[12],y=h[13],v=h[14],T=h[15],_=p[0],k=p[1],E=p[2],A=p[3];return t[0]=_*u+k*a+E*c+A*m,t[1]=_*e+k*n+E*f+A*y,t[2]=_*l+k*s+E*d+A*v,t[3]=_*o+k*r+E*g+A*T,_=p[4],k=p[5],E=p[6],A=p[7],t[4]=_*u+k*a+E*c+A*m,t[5]=_*e+k*n+E*f+A*y,t[6]=_*l+k*s+E*d+A*v,t[7]=_*o+k*r+E*g+A*T,_=p[8],k=p[9],E=p[10],A=p[11],t[8]=_*u+k*a+E*c+A*m,t[9]=_*e+k*n+E*f+A*y,t[10]=_*l+k*s+E*d+A*v,t[11]=_*o+k*r+E*g+A*T,_=p[12],k=p[13],E=p[14],A=p[15],t[12]=_*u+k*a+E*c+A*m,t[13]=_*e+k*n+E*f+A*y,t[14]=_*l+k*s+E*d+A*v,t[15]=_*o+k*r+E*g+A*T,t}},{}],302:[function(i,B,V){B.exports=function(t,h,p,u,e,l,o){var a=1/(h-p),n=1/(u-e),s=1/(l-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(h+p)*a,t[13]=(e+u)*n,t[14]=(o+l)*s,t[15]=1,t}},{}],303:[function(i,B,V){B.exports=function(t,h,p,u,e){var l=1/Math.tan(h/2),o=1/(u-e);return t[0]=l/p,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+u)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*u*o,t[15]=0,t}},{}],304:[function(i,B,V){B.exports=function(t,h,p,u){var e=Math.tan(h.upDegrees*Math.PI/180),l=Math.tan(h.downDegrees*Math.PI/180),o=Math.tan(h.leftDegrees*Math.PI/180),a=Math.tan(h.rightDegrees*Math.PI/180),n=2/(o+a),s=2/(e+l);return t[0]=n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-(o-a)*n*.5,t[9]=(e-l)*s*.5,t[10]=u/(p-u),t[11]=-1,t[12]=0,t[13]=0,t[14]=u*p/(p-u),t[15]=0,t}},{}],305:[function(i,B,V){B.exports=function(t,h,p,u){var e,l,o,a,n,s,r,c,f,d,g,m,y,v,T,_,k,E,A,b,L,w,C,S,P=u[0],z=u[1],F=u[2],q=Math.sqrt(P*P+z*z+F*F);return Math.abs(q)<1e-6?null:(P*=q=1/q,z*=q,F*=q,e=Math.sin(p),l=Math.cos(p),o=1-l,a=h[0],n=h[1],s=h[2],r=h[3],c=h[4],f=h[5],d=h[6],g=h[7],m=h[8],y=h[9],v=h[10],T=h[11],_=P*P*o+l,k=z*P*o+F*e,E=F*P*o-z*e,A=P*z*o-F*e,b=z*z*o+l,L=F*z*o+P*e,w=P*F*o+z*e,C=z*F*o-P*e,S=F*F*o+l,t[0]=a*_+c*k+m*E,t[1]=n*_+f*k+y*E,t[2]=s*_+d*k+v*E,t[3]=r*_+g*k+T*E,t[4]=a*A+c*b+m*L,t[5]=n*A+f*b+y*L,t[6]=s*A+d*b+v*L,t[7]=r*A+g*b+T*L,t[8]=a*w+c*C+m*S,t[9]=n*w+f*C+y*S,t[10]=s*w+d*C+v*S,t[11]=r*w+g*C+T*S,h!==t&&(t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15]),t)}},{}],306:[function(i,B,V){B.exports=function(t,h,p){var u=Math.sin(p),e=Math.cos(p),l=h[4],o=h[5],a=h[6],n=h[7],s=h[8],r=h[9],c=h[10],f=h[11];return h!==t&&(t[0]=h[0],t[1]=h[1],t[2]=h[2],t[3]=h[3],t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15]),t[4]=l*e+s*u,t[5]=o*e+r*u,t[6]=a*e+c*u,t[7]=n*e+f*u,t[8]=s*e-l*u,t[9]=r*e-o*u,t[10]=c*e-a*u,t[11]=f*e-n*u,t}},{}],307:[function(i,B,V){B.exports=function(t,h,p){var u=Math.sin(p),e=Math.cos(p),l=h[0],o=h[1],a=h[2],n=h[3],s=h[8],r=h[9],c=h[10],f=h[11];return h!==t&&(t[4]=h[4],t[5]=h[5],t[6]=h[6],t[7]=h[7],t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15]),t[0]=l*e-s*u,t[1]=o*e-r*u,t[2]=a*e-c*u,t[3]=n*e-f*u,t[8]=l*u+s*e,t[9]=o*u+r*e,t[10]=a*u+c*e,t[11]=n*u+f*e,t}},{}],308:[function(i,B,V){B.exports=function(t,h,p){var u=Math.sin(p),e=Math.cos(p),l=h[0],o=h[1],a=h[2],n=h[3],s=h[4],r=h[5],c=h[6],f=h[7];return h!==t&&(t[8]=h[8],t[9]=h[9],t[10]=h[10],t[11]=h[11],t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15]),t[0]=l*e+s*u,t[1]=o*e+r*u,t[2]=a*e+c*u,t[3]=n*e+f*u,t[4]=s*e-l*u,t[5]=r*e-o*u,t[6]=c*e-a*u,t[7]=f*e-n*u,t}},{}],309:[function(i,B,V){B.exports=function(t,h,p){var u=p[0],e=p[1],l=p[2];return t[0]=h[0]*u,t[1]=h[1]*u,t[2]=h[2]*u,t[3]=h[3]*u,t[4]=h[4]*e,t[5]=h[5]*e,t[6]=h[6]*e,t[7]=h[7]*e,t[8]=h[8]*l,t[9]=h[9]*l,t[10]=h[10]*l,t[11]=h[11]*l,t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15],t}},{}],310:[function(i,B,V){B.exports=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}},{}],311:[function(i,B,V){B.exports=function(t,h,p){var u,e,l,o,a,n,s,r,c,f,d,g,m=p[0],y=p[1],v=p[2];return h===t?(t[12]=h[0]*m+h[4]*y+h[8]*v+h[12],t[13]=h[1]*m+h[5]*y+h[9]*v+h[13],t[14]=h[2]*m+h[6]*y+h[10]*v+h[14],t[15]=h[3]*m+h[7]*y+h[11]*v+h[15]):(u=h[0],e=h[1],l=h[2],o=h[3],a=h[4],n=h[5],s=h[6],r=h[7],c=h[8],f=h[9],d=h[10],g=h[11],t[0]=u,t[1]=e,t[2]=l,t[3]=o,t[4]=a,t[5]=n,t[6]=s,t[7]=r,t[8]=c,t[9]=f,t[10]=d,t[11]=g,t[12]=u*m+a*y+c*v+h[12],t[13]=e*m+n*y+f*v+h[13],t[14]=l*m+s*y+d*v+h[14],t[15]=o*m+r*y+g*v+h[15]),t}},{}],312:[function(i,B,V){B.exports=function(t,h){if(t===h){var p=h[1],u=h[2],e=h[3],l=h[6],o=h[7],a=h[11];t[1]=h[4],t[2]=h[8],t[3]=h[12],t[4]=p,t[6]=h[9],t[7]=h[13],t[8]=u,t[9]=l,t[11]=h[14],t[12]=e,t[13]=o,t[14]=a}else t[0]=h[0],t[1]=h[4],t[2]=h[8],t[3]=h[12],t[4]=h[1],t[5]=h[5],t[6]=h[9],t[7]=h[13],t[8]=h[2],t[9]=h[6],t[10]=h[10],t[11]=h[14],t[12]=h[3],t[13]=h[7],t[14]=h[11],t[15]=h[15];return t}},{}],313:[function(i,B,V){var t=i("barycentric"),h=i("polytope-closest-point/lib/closest_point_2d.js");function p(l,o){for(var a=[0,0,0,0],n=0;n<4;++n)for(var s=0;s<4;++s)a[s]+=l[4*n+s]*o[n];return a}function u(l,o,a,n,s){for(var r=p(n,p(a,p(o,[l[0],l[1],l[2],1]))),c=0;c<3;++c)r[c]/=r[3];return[.5*s[0]*(1+r[0]),.5*s[1]*(1-r[1])]}function e(l,o){for(var a=[0,0,0],n=0;n<l.length;++n)for(var s=l[n],r=o[n],c=0;c<3;++c)a[c]+=r*s[c];return a}B.exports=function(l,o,a,n,s,r){if(l.length===1)return[0,l[0].slice()];for(var c=new Array(l.length),f=0;f<l.length;++f)c[f]=u(l[f],a,n,s,r);var d=0,g=1/0;for(f=0;f<c.length;++f){for(var m=0,y=0;y<2;++y)m+=Math.pow(c[f][y]-o[y],2);m<g&&(g=m,d=f)}var v=function(_,k){if(_.length===2){for(var E=0,A=0,b=0;b<2;++b)E+=Math.pow(k[b]-_[0][b],2),A+=Math.pow(k[b]-_[1][b],2);return E=Math.sqrt(E),A=Math.sqrt(A),E+A<1e-6?[1,0]:[A/(E+A),E/(A+E)]}if(_.length===3){var L=[0,0];return h(_[0],_[1],_[2],k,L),t(_,L)}return[]}(c,o),T=0;for(f=0;f<3;++f){if(v[f]<-.001||v[f]>1.0001)return null;T+=v[f]}return Math.abs(T-1)>.001?null:[d,e(l,v),v]}},{barycentric:85,"polytope-closest-point/lib/closest_point_2d.js":512}],314:[function(i,B,V){var t=i("glslify"),h=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),p=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),u=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),l=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),o=t([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),a=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),n=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),s=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),r=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),c=t([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);V.meshShader={vertex:h,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},V.wireShader={vertex:u,fragment:e,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},V.pointShader={vertex:l,fragment:o,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},V.pickShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},V.pointPickShader={vertex:s,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},V.contourShader={vertex:r,fragment:c,attributes:[{name:"position",type:"vec3"}]}},{glslify:442}],315:[function(i,B,V){var t=i("gl-shader"),h=i("gl-buffer"),p=i("gl-vao"),u=i("gl-texture2d"),e=i("normals"),l=i("gl-mat4/multiply"),o=i("gl-mat4/invert"),a=i("ndarray"),n=i("colormap"),s=i("simplicial-complex-contour"),r=i("typedarray-pool"),c=i("./lib/shaders"),f=i("./lib/closest-point"),d=c.meshShader,g=c.wireShader,m=c.pointShader,y=c.pickShader,v=c.pointPickShader,T=c.contourShader,_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function k(z,F,q,W,X,Q,Z,Y,N,J,D,U,G,$,K,re,ne,ae,ie,he,se,de,ce,ve,Ee,Le,Te){this.gl=z,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=F,this.dirty=!0,this.triShader=q,this.lineShader=W,this.pointShader=X,this.pickShader=Q,this.pointPickShader=Z,this.contourShader=Y,this.trianglePositions=N,this.triangleColors=D,this.triangleNormals=G,this.triangleUVs=U,this.triangleIds=J,this.triangleVAO=$,this.triangleCount=0,this.lineWidth=1,this.edgePositions=K,this.edgeColors=ne,this.edgeUVs=ae,this.edgeIds=re,this.edgeVAO=ie,this.edgeCount=0,this.pointPositions=he,this.pointColors=de,this.pointUVs=ce,this.pointSizes=ve,this.pointIds=se,this.pointVAO=Ee,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=Le,this.contourVAO=Te,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=_,this._view=_,this._projection=_,this._resolution=[1,1]}var E=k.prototype;function A(z,F){if(!F||!F.length)return 1;for(var q=0;q<F.length;++q){if(F.length<2)return 1;if(F[q][0]===z)return F[q][1];if(F[q][0]>z&&q>0){var W=(F[q][0]-z)/(F[q][0]-F[q-1][0]);return F[q][1]*(1-W)+W*F[q-1][1]}}return 1}function b(z){var F=t(z,d.vertex,d.fragment);return F.attributes.position.location=0,F.attributes.color.location=2,F.attributes.uv.location=3,F.attributes.normal.location=4,F}function L(z){var F=t(z,g.vertex,g.fragment);return F.attributes.position.location=0,F.attributes.color.location=2,F.attributes.uv.location=3,F}function w(z){var F=t(z,m.vertex,m.fragment);return F.attributes.position.location=0,F.attributes.color.location=2,F.attributes.uv.location=3,F.attributes.pointSize.location=4,F}function C(z){var F=t(z,y.vertex,y.fragment);return F.attributes.position.location=0,F.attributes.id.location=1,F}function S(z){var F=t(z,v.vertex,v.fragment);return F.attributes.position.location=0,F.attributes.id.location=1,F.attributes.pointSize.location=4,F}function P(z){var F=t(z,T.vertex,T.fragment);return F.attributes.position.location=0,F}E.isOpaque=function(){return!this.hasAlpha},E.isTransparent=function(){return this.hasAlpha},E.pickSlots=1,E.setPickBase=function(z){this.pickId=z},E.highlight=function(z){if(z&&this.contourEnable){for(var F=s(this.cells,this.intensity,z.intensity),q=F.cells,W=F.vertexIds,X=F.vertexWeights,Q=q.length,Z=r.mallocFloat32(6*Q),Y=0,N=0;N<Q;++N)for(var J=q[N],D=0;D<2;++D){var U=J[0];J.length===2&&(U=J[D]);for(var G=W[U][0],$=W[U][1],K=X[U],re=1-K,ne=this.positions[G],ae=this.positions[$],ie=0;ie<3;++ie)Z[Y++]=K*ne[ie]+re*ae[ie]}this.contourCount=Y/3|0,this.contourPositions.update(Z.subarray(0,Y)),r.free(Z)}else this.contourCount=0},E.update=function(z){z=z||{};var F=this.gl;this.dirty=!0,"contourEnable"in z&&(this.contourEnable=z.contourEnable),"contourColor"in z&&(this.contourColor=z.contourColor),"lineWidth"in z&&(this.lineWidth=z.lineWidth),"lightPosition"in z&&(this.lightPosition=z.lightPosition),this.hasAlpha=!1,"opacity"in z&&(this.opacity=z.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in z&&(this.opacityscale=z.opacityscale,this.hasAlpha=!0),"ambient"in z&&(this.ambientLight=z.ambient),"diffuse"in z&&(this.diffuseLight=z.diffuse),"specular"in z&&(this.specularLight=z.specular),"roughness"in z&&(this.roughness=z.roughness),"fresnel"in z&&(this.fresnel=z.fresnel),z.texture?(this.texture.dispose(),this.texture=u(F,z.texture)):z.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=F.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=F.LINEAR,this.texture.setPixels(function(tt,Ke){for(var Mt=n({colormap:tt,nshades:256,format:"rgba"}),Jt=new Uint8Array(1024),$t=0;$t<256;++$t){for(var je=Mt[$t],Ge=0;Ge<3;++Ge)Jt[4*$t+Ge]=je[Ge];Jt[4*$t+3]=Ke?255*A($t/255,Ke):255*je[3]}return a(Jt,[256,256,4],[4,0,1])}(z.colormap,this.opacityscale)),this.texture.generateMipmap());var q=z.cells,W=z.positions;if(W&&q){var X=[],Q=[],Z=[],Y=[],N=[],J=[],D=[],U=[],G=[],$=[],K=[],re=[],ne=[],ae=[];this.cells=q,this.positions=W;var ie=z.vertexNormals,he=z.cellNormals,se=z.vertexNormalsEpsilon===void 0?1e-6:z.vertexNormalsEpsilon,de=z.faceNormalsEpsilon===void 0?1e-6:z.faceNormalsEpsilon;z.useFacetNormals&&!he&&(he=e.faceNormals(q,W,de)),he||ie||(ie=e.vertexNormals(q,W,se));var ce=z.vertexColors,ve=z.cellColors,Ee=z.meshColor||[1,1,1,1],Le=z.vertexUVs,Te=z.vertexIntensity,xe=z.cellUVs,fe=z.cellIntensity,ge=1/0,ke=-1/0;if(!Le&&!xe)if(Te)if(z.vertexIntensityBounds)ge=+z.vertexIntensityBounds[0],ke=+z.vertexIntensityBounds[1];else for(var Me=0;Me<Te.length;++Me){var Se=Te[Me];ge=Math.min(ge,Se),ke=Math.max(ke,Se)}else if(fe)if(z.cellIntensityBounds)ge=+z.cellIntensityBounds[0],ke=+z.cellIntensityBounds[1];else for(Me=0;Me<fe.length;++Me)Se=fe[Me],ge=Math.min(ge,Se),ke=Math.max(ke,Se);else for(Me=0;Me<W.length;++Me)Se=W[Me][2],ge=Math.min(ge,Se),ke=Math.max(ke,Se);this.intensity=Te||fe||function(tt){for(var Ke=tt.length,Mt=new Array(Ke),Jt=0;Jt<Ke;++Jt)Mt[Jt]=tt[Jt][2];return Mt}(W),this.pickVertex=!(fe||ve);var De=z.pointSizes,Be=z.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Me=0;Me<W.length;++Me)for(var We=W[Me],Qe=0;Qe<3;++Qe)!isNaN(We[Qe])&&isFinite(We[Qe])&&(this.bounds[0][Qe]=Math.min(this.bounds[0][Qe],We[Qe]),this.bounds[1][Qe]=Math.max(this.bounds[1][Qe],We[Qe]));var Oe=0,Ue=0,Xe=0;e:for(Me=0;Me<q.length;++Me){var Ye=q[Me];switch(Ye.length){case 1:for(We=W[it=Ye[0]],Qe=0;Qe<3;++Qe)if(isNaN(We[Qe])||!isFinite(We[Qe]))continue e;$.push(We[0],We[1],We[2]),ot=ce?ce[it]:ve?ve[Me]:Ee,this.opacityscale&&Te?Q.push(ot[0],ot[1],ot[2],this.opacity*A((Te[it]-ge)/(ke-ge),this.opacityscale)):ot.length===3?K.push(ot[0],ot[1],ot[2],this.opacity):(K.push(ot[0],ot[1],ot[2],ot[3]*this.opacity),ot[3]<1&&(this.hasAlpha=!0)),Et=Le?Le[it]:Te?[(Te[it]-ge)/(ke-ge),0]:xe?xe[Me]:fe?[(fe[Me]-ge)/(ke-ge),0]:[(We[2]-ge)/(ke-ge),0],re.push(Et[0],Et[1]),De?ne.push(De[it]):ne.push(Be),ae.push(Me),Xe+=1;break;case 2:for(Qe=0;Qe<2;++Qe){We=W[it=Ye[Qe]];for(var $e=0;$e<3;++$e)if(isNaN(We[$e])||!isFinite(We[$e]))continue e}for(Qe=0;Qe<2;++Qe)We=W[it=Ye[Qe]],J.push(We[0],We[1],We[2]),ot=ce?ce[it]:ve?ve[Me]:Ee,this.opacityscale&&Te?Q.push(ot[0],ot[1],ot[2],this.opacity*A((Te[it]-ge)/(ke-ge),this.opacityscale)):ot.length===3?D.push(ot[0],ot[1],ot[2],this.opacity):(D.push(ot[0],ot[1],ot[2],ot[3]*this.opacity),ot[3]<1&&(this.hasAlpha=!0)),Et=Le?Le[it]:Te?[(Te[it]-ge)/(ke-ge),0]:xe?xe[Me]:fe?[(fe[Me]-ge)/(ke-ge),0]:[(We[2]-ge)/(ke-ge),0],U.push(Et[0],Et[1]),G.push(Me);Ue+=1;break;case 3:for(Qe=0;Qe<3;++Qe)for(We=W[it=Ye[Qe]],$e=0;$e<3;++$e)if(isNaN(We[$e])||!isFinite(We[$e]))continue e;for(Qe=0;Qe<3;++Qe){var it,ot,Et,mt;We=W[it=Ye[2-Qe]],X.push(We[0],We[1],We[2]),(ot=ce?ce[it]:ve?ve[Me]:Ee)?this.opacityscale&&Te?Q.push(ot[0],ot[1],ot[2],this.opacity*A((Te[it]-ge)/(ke-ge),this.opacityscale)):ot.length===3?Q.push(ot[0],ot[1],ot[2],this.opacity):(Q.push(ot[0],ot[1],ot[2],ot[3]*this.opacity),ot[3]<1&&(this.hasAlpha=!0)):Q.push(.5,.5,.5,1),Et=Le?Le[it]:Te?[(Te[it]-ge)/(ke-ge),0]:xe?xe[Me]:fe?[(fe[Me]-ge)/(ke-ge),0]:[(We[2]-ge)/(ke-ge),0],Y.push(Et[0],Et[1]),mt=ie?ie[it]:he[Me],Z.push(mt[0],mt[1],mt[2]),N.push(Me)}Oe+=1}}this.pointCount=Xe,this.edgeCount=Ue,this.triangleCount=Oe,this.pointPositions.update($),this.pointColors.update(K),this.pointUVs.update(re),this.pointSizes.update(ne),this.pointIds.update(new Uint32Array(ae)),this.edgePositions.update(J),this.edgeColors.update(D),this.edgeUVs.update(U),this.edgeIds.update(new Uint32Array(G)),this.trianglePositions.update(X),this.triangleColors.update(Q),this.triangleUVs.update(Y),this.triangleNormals.update(Z),this.triangleIds.update(new Uint32Array(N))}},E.drawTransparent=E.draw=function(z){z=z||{};for(var F=this.gl,q=z.model||_,W=z.view||_,X=z.projection||_,Q=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],Z=0;Z<3;++Z)Q[0][Z]=Math.max(Q[0][Z],this.clipBounds[0][Z]),Q[1][Z]=Math.min(Q[1][Z],this.clipBounds[1][Z]);var Y={model:q,view:W,projection:X,inverseModel:_.slice(),clipBounds:Q,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};Y.inverseModel=o(Y.inverseModel,Y.model),F.disable(F.CULL_FACE),this.texture.bind(0);var N=new Array(16);for(l(N,Y.view,Y.model),l(N,Y.projection,N),o(N,N),Z=0;Z<3;++Z)Y.eyePosition[Z]=N[12+Z]/N[15];var J,D=N[15];for(Z=0;Z<3;++Z)D+=this.lightPosition[Z]*N[4*Z+3];for(Z=0;Z<3;++Z){for(var U=N[12+Z],G=0;G<3;++G)U+=N[4*G+Z]*this.lightPosition[G];Y.lightPosition[Z]=U/D}this.triangleCount>0&&((J=this.triShader).bind(),J.uniforms=Y,this.triangleVAO.bind(),F.drawArrays(F.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((J=this.lineShader).bind(),J.uniforms=Y,this.edgeVAO.bind(),F.lineWidth(this.lineWidth*this.pixelRatio),F.drawArrays(F.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((J=this.pointShader).bind(),J.uniforms=Y,this.pointVAO.bind(),F.drawArrays(F.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((J=this.contourShader).bind(),J.uniforms=Y,this.contourVAO.bind(),F.drawArrays(F.LINES,0,this.contourCount),this.contourVAO.unbind())},E.drawPick=function(z){z=z||{};for(var F=this.gl,q=z.model||_,W=z.view||_,X=z.projection||_,Q=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],Z=0;Z<3;++Z)Q[0][Z]=Math.max(Q[0][Z],this.clipBounds[0][Z]),Q[1][Z]=Math.min(Q[1][Z],this.clipBounds[1][Z]);this._model=[].slice.call(q),this._view=[].slice.call(W),this._projection=[].slice.call(X),this._resolution=[F.drawingBufferWidth,F.drawingBufferHeight];var Y,N={model:q,view:W,projection:X,clipBounds:Q,pickId:this.pickId/255};(Y=this.pickShader).bind(),Y.uniforms=N,this.triangleCount>0&&(this.triangleVAO.bind(),F.drawArrays(F.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),F.lineWidth(this.lineWidth*this.pixelRatio),F.drawArrays(F.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((Y=this.pointPickShader).bind(),Y.uniforms=N,this.pointVAO.bind(),F.drawArrays(F.POINTS,0,this.pointCount),this.pointVAO.unbind())},E.pick=function(z){if(!z||z.id!==this.pickId)return null;for(var F=z.value[0]+256*z.value[1]+65536*z.value[2],q=this.cells[F],W=this.positions,X=new Array(q.length),Q=0;Q<q.length;++Q)X[Q]=W[q[Q]];var Z=z.coord[0],Y=z.coord[1];if(!this.pickVertex){var N=this.positions[q[0]],J=this.positions[q[1]],D=this.positions[q[2]],U=[(N[0]+J[0]+D[0])/3,(N[1]+J[1]+D[1])/3,(N[2]+J[2]+D[2])/3];return{_cellCenter:!0,position:[Z,Y],index:F,cell:q,cellId:F,intensity:this.intensity[F],dataCoordinate:U}}var G=f(X,[Z*this.pixelRatio,this._resolution[1]-Y*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!G)return null;var $=G[2],K=0;for(Q=0;Q<q.length;++Q)K+=$[Q]*this.intensity[q[Q]];return{position:G[1],index:q[G[0]],cell:q,cellId:F,intensity:K,dataCoordinate:this.positions[q[G[0]]]}},E.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},B.exports=function(z,F){arguments.length===1&&(z=(F=z).gl);var q=z.getExtension("OES_standard_derivatives")||z.getExtension("MOZ_OES_standard_derivatives")||z.getExtension("WEBKIT_OES_standard_derivatives");if(!q)throw new Error("derivatives not supported");var W=b(z),X=L(z),Q=w(z),Z=C(z),Y=S(z),N=P(z),J=u(z,a(new Uint8Array([255,255,255,255]),[1,1,4]));J.generateMipmap(),J.minFilter=z.LINEAR_MIPMAP_LINEAR,J.magFilter=z.LINEAR;var D=h(z),U=h(z),G=h(z),$=h(z),K=h(z),re=p(z,[{buffer:D,type:z.FLOAT,size:3},{buffer:K,type:z.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:U,type:z.FLOAT,size:4},{buffer:G,type:z.FLOAT,size:2},{buffer:$,type:z.FLOAT,size:3}]),ne=h(z),ae=h(z),ie=h(z),he=h(z),se=p(z,[{buffer:ne,type:z.FLOAT,size:3},{buffer:he,type:z.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ae,type:z.FLOAT,size:4},{buffer:ie,type:z.FLOAT,size:2}]),de=h(z),ce=h(z),ve=h(z),Ee=h(z),Le=h(z),Te=p(z,[{buffer:de,type:z.FLOAT,size:3},{buffer:Le,type:z.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ce,type:z.FLOAT,size:4},{buffer:ve,type:z.FLOAT,size:2},{buffer:Ee,type:z.FLOAT,size:1}]),xe=h(z),fe=p(z,[{buffer:xe,type:z.FLOAT,size:3}]),ge=new k(z,J,W,X,Q,Z,Y,N,D,K,U,G,$,re,ne,he,ae,ie,se,de,Le,ce,ve,Ee,Te,xe,fe);return ge.update(F),ge}},{"./lib/closest-point":313,"./lib/shaders":314,colormap:137,"gl-buffer":267,"gl-mat4/invert":299,"gl-mat4/multiply":301,"gl-shader":339,"gl-texture2d":356,"gl-vao":361,ndarray:483,normals:486,"simplicial-complex-contour":557,"typedarray-pool":617}],316:[function(i,B,V){B.exports=function(a){var n=a.gl,s=t(n,[0,0,0,1,1,0,1,1]),r=h(n,p.boxVert,p.lineFrag);return new u(a,s,r)};var t=i("gl-buffer"),h=i("gl-shader"),p=i("./shaders");function u(a,n,s){this.plot=a,this.vbo=n,this.shader=s}var e,l,o=u.prototype;o.bind=function(){var a=this.shader;this.vbo.bind(),this.shader.bind(),a.attributes.coord.pointer(),a.uniforms.screenBox=this.plot.screenBox},o.drawBox=(e=[0,0],l=[0,0],function(a,n,s,r,c){var f=this.plot,d=this.shader,g=f.gl;e[0]=a,e[1]=n,l[0]=s,l[1]=r,d.uniforms.lo=e,d.uniforms.hi=l,d.uniforms.color=c,g.drawArrays(g.TRIANGLE_STRIP,0,4)}),o.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":319,"gl-buffer":267,"gl-shader":339}],317:[function(i,B,V){B.exports=function(f){var d=f.gl,g=t(d),m=h(d,u.gridVert,u.gridFrag),y=h(d,u.tickVert,u.gridFrag);return new e(f,g,m,y)};var t=i("gl-buffer"),h=i("gl-shader"),p=i("binary-search-bounds"),u=i("./shaders");function e(f,d,g,m){this.plot=f,this.vbo=d,this.shader=g,this.tickShader=m,this.ticks=[[],[]]}function l(f,d){return f-d}var o,a,n,s,r,c=e.prototype;c.draw=(o=[0,0],a=[0,0],n=[0,0],function(){for(var f=this.plot,d=this.vbo,g=this.shader,m=this.ticks,y=f.gl,v=f._tickBounds,T=f.dataBox,_=f.viewBox,k=f.gridLineWidth,E=f.gridLineColor,A=f.gridLineEnable,b=f.pixelRatio,L=0;L<2;++L){var w=v[L],C=v[L+2]-w,S=.5*(T[L+2]+T[L]),P=T[L+2]-T[L];a[L]=2*C/P,o[L]=2*(w-S)/P}g.bind(),d.bind(),g.attributes.dataCoord.pointer(),g.uniforms.dataShift=o,g.uniforms.dataScale=a;var z=0;for(L=0;L<2;++L){n[0]=n[1]=0,n[L]=1,g.uniforms.dataAxis=n,g.uniforms.lineWidth=k[L]/(_[L+2]-_[L])*b,g.uniforms.color=E[L];var F=6*m[L].length;A[L]&&F&&y.drawArrays(y.TRIANGLES,z,F),z+=F}}),c.drawTickMarks=function(){var f=[0,0],d=[0,0],g=[1,0],m=[0,1],y=[0,0],v=[0,0];return function(){for(var T=this.plot,_=this.vbo,k=this.tickShader,E=this.ticks,A=T.gl,b=T._tickBounds,L=T.dataBox,w=T.viewBox,C=T.pixelRatio,S=T.screenBox,P=S[2]-S[0],z=S[3]-S[1],F=w[2]-w[0],q=w[3]-w[1],W=0;W<2;++W){var X=b[W],Q=b[W+2]-X,Z=.5*(L[W+2]+L[W]),Y=L[W+2]-L[W];d[W]=2*Q/Y,f[W]=2*(X-Z)/Y}d[0]*=F/P,f[0]*=F/P,d[1]*=q/z,f[1]*=q/z,k.bind(),_.bind(),k.attributes.dataCoord.pointer();var N=k.uniforms;N.dataShift=f,N.dataScale=d;var J=T.tickMarkLength,D=T.tickMarkWidth,U=T.tickMarkColor,G=6*E[0].length,$=Math.min(p.ge(E[0],(L[0]-b[0])/(b[2]-b[0]),l),E[0].length),K=Math.min(p.gt(E[0],(L[2]-b[0])/(b[2]-b[0]),l),E[0].length),re=0+6*$,ne=6*Math.max(0,K-$),ae=Math.min(p.ge(E[1],(L[1]-b[1])/(b[3]-b[1]),l),E[1].length),ie=Math.min(p.gt(E[1],(L[3]-b[1])/(b[3]-b[1]),l),E[1].length),he=G+6*ae,se=6*Math.max(0,ie-ae);y[0]=2*(w[0]-J[1])/P-1,y[1]=(w[3]+w[1])/z-1,v[0]=J[1]*C/P,v[1]=D[1]*C/z,se&&(N.color=U[1],N.tickScale=v,N.dataAxis=m,N.screenOffset=y,A.drawArrays(A.TRIANGLES,he,se)),y[0]=(w[2]+w[0])/P-1,y[1]=2*(w[1]-J[0])/z-1,v[0]=D[0]*C/P,v[1]=J[0]*C/z,ne&&(N.color=U[0],N.tickScale=v,N.dataAxis=g,N.screenOffset=y,A.drawArrays(A.TRIANGLES,re,ne)),y[0]=2*(w[2]+J[3])/P-1,y[1]=(w[3]+w[1])/z-1,v[0]=J[3]*C/P,v[1]=D[3]*C/z,se&&(N.color=U[3],N.tickScale=v,N.dataAxis=m,N.screenOffset=y,A.drawArrays(A.TRIANGLES,he,se)),y[0]=(w[2]+w[0])/P-1,y[1]=2*(w[3]+J[2])/z-1,v[0]=D[2]*C/P,v[1]=J[2]*C/z,ne&&(N.color=U[2],N.tickScale=v,N.dataAxis=g,N.screenOffset=y,A.drawArrays(A.TRIANGLES,re,ne))}}(),c.update=(s=[1,1,-1,-1,1,-1],r=[1,-1,1,1,-1,-1],function(f){for(var d=f.ticks,g=f.bounds,m=new Float32Array(18*(d[0].length+d[1].length)),y=(this.plot.zeroLineEnable,0),v=[[],[]],T=0;T<2;++T)for(var _=v[T],k=d[T],E=g[T],A=g[T+2],b=0;b<k.length;++b){var L=(k[b].x-E)/(A-E);_.push(L);for(var w=0;w<6;++w)m[y++]=L,m[y++]=s[w],m[y++]=r[w]}this.ticks=v,this.vbo.update(m)}),c.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":319,"binary-search-bounds":103,"gl-buffer":267,"gl-shader":339}],318:[function(i,B,V){B.exports=function(a){var n=a.gl,s=t(n,[-1,-1,-1,1,1,-1,1,1]),r=h(n,p.lineVert,p.lineFrag);return new u(a,s,r)};var t=i("gl-buffer"),h=i("gl-shader"),p=i("./shaders");function u(a,n,s){this.plot=a,this.vbo=n,this.shader=s}var e,l,o=u.prototype;o.bind=function(){var a=this.shader;this.vbo.bind(),this.shader.bind(),a.attributes.coord.pointer(),a.uniforms.screenBox=this.plot.screenBox},o.drawLine=(e=[0,0],l=[0,0],function(a,n,s,r,c,f){var d=this.plot,g=this.shader,m=d.gl;e[0]=a,e[1]=n,l[0]=s,l[1]=r,g.uniforms.start=e,g.uniforms.end=l,g.uniforms.width=c*d.pixelRatio,g.uniforms.color=f,m.drawArrays(m.TRIANGLE_STRIP,0,4)}),o.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":319,"gl-buffer":267,"gl-shader":339}],319:[function(i,B,V){var t=i("glslify"),h=t([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);B.exports={lineVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:h,textVert:t([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:h,gridVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:h,boxVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:321}],320:[function(i,B,V){B.exports=function(d){var g=d.gl,m=t(g),y=h(g,e.textVert,e.textFrag);return new l(d,m,y)};var t=i("gl-buffer"),h=i("gl-shader"),p=i("text-cache"),u=i("binary-search-bounds"),e=i("./shaders");function l(d,g,m){this.plot=d,this.vbo=g,this.shader=m,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var o,a,n,s,r,c,f=l.prototype;f.drawTicks=(o=[0,0],a=[0,0],n=[0,0],function(d){var g=this.plot,m=this.shader,y=this.tickX[d],v=this.tickOffset[d],T=g.gl,_=g.viewBox,k=g.dataBox,E=g.screenBox,A=g.pixelRatio,b=g.tickEnable,L=g.tickPad,w=g.tickColor,C=g.tickAngle,S=g.labelEnable,P=g.labelPad,z=g.labelColor,F=g.labelAngle,q=this.labelOffset[d],W=this.labelCount[d],X=u.lt(y,k[d]),Q=u.le(y,k[d+2]);o[0]=o[1]=0,o[d]=1,a[d]=(_[2+d]+_[d])/(E[2+d]-E[d])-1;var Z=2/E[2+(1^d)]-E[1^d];a[1^d]=Z*_[1^d]-1,b[d]&&(a[1^d]-=Z*A*L[d],X<Q&&v[Q]>v[X]&&(m.uniforms.dataAxis=o,m.uniforms.screenOffset=a,m.uniforms.color=w[d],m.uniforms.angle=C[d],T.drawArrays(T.TRIANGLES,v[X],v[Q]-v[X]))),S[d]&&W&&(a[1^d]-=Z*A*P[d],m.uniforms.dataAxis=n,m.uniforms.screenOffset=a,m.uniforms.color=z[d],m.uniforms.angle=F[d],T.drawArrays(T.TRIANGLES,q,W)),a[1^d]=Z*_[2+(1^d)]-1,b[d+2]&&(a[1^d]+=Z*A*L[d+2],X<Q&&v[Q]>v[X]&&(m.uniforms.dataAxis=o,m.uniforms.screenOffset=a,m.uniforms.color=w[d+2],m.uniforms.angle=C[d+2],T.drawArrays(T.TRIANGLES,v[X],v[Q]-v[X]))),S[d+2]&&W&&(a[1^d]+=Z*A*P[d+2],m.uniforms.dataAxis=n,m.uniforms.screenOffset=a,m.uniforms.color=z[d+2],m.uniforms.angle=F[d+2],T.drawArrays(T.TRIANGLES,q,W))}),f.drawTitle=function(){var d=[0,0],g=[0,0];return function(){var m=this.plot,y=this.shader,v=m.gl,T=m.screenBox,_=m.titleCenter,k=m.titleAngle,E=m.titleColor,A=m.pixelRatio;if(this.titleCount){for(var b=0;b<2;++b)g[b]=2*(_[b]*A-T[b])/(T[2+b]-T[b])-1;y.bind(),y.uniforms.dataAxis=d,y.uniforms.screenOffset=g,y.uniforms.angle=k,y.uniforms.color=E,v.drawArrays(v.TRIANGLES,this.titleOffset,this.titleCount)}}}(),f.bind=(s=[0,0],r=[0,0],c=[0,0],function(){var d=this.plot,g=this.shader,m=d._tickBounds,y=d.dataBox,v=d.screenBox,T=d.viewBox;g.bind();for(var _=0;_<2;++_){var k=m[_],E=m[_+2]-k,A=.5*(y[_+2]+y[_]),b=y[_+2]-y[_],L=T[_],w=T[_+2]-L,C=v[_],S=v[_+2]-C;r[_]=2*E/b*w/S,s[_]=2*(k-A)/b*w/S}c[1]=2*d.pixelRatio/(v[3]-v[1]),c[0]=c[1]*(v[3]-v[1])/(v[2]-v[0]),g.uniforms.dataScale=r,g.uniforms.dataShift=s,g.uniforms.textScale=c,this.vbo.bind(),g.attributes.textCoordinate.pointer()}),f.update=function(d){var g,m,y,v,T,_=[],k=d.ticks,E=d.bounds;for(T=0;T<2;++T){var A=[Math.floor(_.length/3)],b=[-1/0],L=k[T];for(g=0;g<L.length;++g){var w=L[g],C=w.x,S=w.text,P=w.font||"sans-serif";v=w.fontSize||12;for(var z=1/(E[T+2]-E[T]),F=E[T],q=S.split(`
`),W=0;W<q.length;W++)for(y=p(P,q[W]).data,m=0;m<y.length;m+=2)_.push(y[m]*v,-y[m+1]*v-W*v*1.2,(C-F)*z);A.push(Math.floor(_.length/3)),b.push(C)}this.tickOffset[T]=A,this.tickX[T]=b}for(T=0;T<2;++T){for(this.labelOffset[T]=Math.floor(_.length/3),y=p(d.labelFont[T],d.labels[T],{textAlign:"center"}).data,v=d.labelSize[T],g=0;g<y.length;g+=2)_.push(y[g]*v,-y[g+1]*v,0);this.labelCount[T]=Math.floor(_.length/3)-this.labelOffset[T]}for(this.titleOffset=Math.floor(_.length/3),y=p(d.titleFont,d.title).data,v=d.titleSize,g=0;g<y.length;g+=2)_.push(y[g]*v,-y[g+1]*v,0);this.titleCount=Math.floor(_.length/3)-this.titleOffset,this.vbo.update(_)},f.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":319,"binary-search-bounds":103,"gl-buffer":267,"gl-shader":339,"text-cache":596}],321:[function(i,B,V){arguments[4][265][0].apply(V,arguments)},{dup:265}],322:[function(i,B,V){B.exports=function(s){var r=s.gl,c=t(r,[r.drawingBufferWidth,r.drawingBufferHeight]),f=new l(r,c);return f.grid=h(f),f.text=p(f),f.line=u(f),f.box=e(f),f.update(s),f};var t=i("gl-select-static"),h=i("./lib/grid"),p=i("./lib/text"),u=i("./lib/line"),e=i("./lib/box");function l(s,r){this.gl=s,this.pickBuffer=r,this.screenBox=[0,0,s.drawingBufferWidth,s.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var o=l.prototype;function a(s){for(var r=s.slice(),c=0;c<r.length;++c)r[c]=r[c].slice();return r}function n(s,r){return s.x-r.x}o.setDirty=function(){this.dirty=this.pickDirty=!0},o.setOverlayDirty=function(){this.dirty=!0},o.nextDepthValue=function(){return this._depthCounter++/65536},o.draw=function(){var s=this.gl,r=this.screenBox,c=this.viewBox,f=this.dataBox,d=this.pixelRatio,g=this.grid,m=this.line,y=this.text,v=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,s.bindFramebuffer(s.FRAMEBUFFER,null),s.enable(s.SCISSOR_TEST),s.disable(s.DEPTH_TEST),s.depthFunc(s.LESS),s.depthMask(!1),s.enable(s.BLEND),s.blendEquation(s.FUNC_ADD,s.FUNC_ADD),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),this.borderColor){s.scissor(r[0],r[1],r[2]-r[0],r[3]-r[1]);var T=this.borderColor;s.clearColor(T[0]*T[3],T[1]*T[3],T[2]*T[3],T[3]),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)}s.scissor(c[0],c[1],c[2]-c[0],c[3]-c[1]),s.viewport(c[0],c[1],c[2]-c[0],c[3]-c[1]);var _=this.backgroundColor;s.clearColor(_[0]*_[3],_[1]*_[3],_[2]*_[3],_[3]),s.clear(s.COLOR_BUFFER_BIT),g.draw();var k=this.zeroLineEnable,E=this.zeroLineColor,A=this.zeroLineWidth;if(k[0]||k[1]){m.bind();for(var b=0;b<2;++b)if(k[b]&&f[b]<=0&&f[b+2]>=0){var L=r[b]-f[b]*(r[b+2]-r[b])/(f[b+2]-f[b]);b===0?m.drawLine(L,r[1],L,r[3],A[b],E[b]):m.drawLine(r[0],L,r[2],L,A[b],E[b])}}for(b=0;b<v.length;++b)v[b].draw();s.viewport(r[0],r[1],r[2]-r[0],r[3]-r[1]),s.scissor(r[0],r[1],r[2]-r[0],r[3]-r[1]),this.grid.drawTickMarks(),m.bind();var w=this.borderLineEnable,C=this.borderLineWidth,S=this.borderLineColor;for(w[1]&&m.drawLine(c[0],c[1]-.5*C[1]*d,c[0],c[3]+.5*C[3]*d,C[1],S[1]),w[0]&&m.drawLine(c[0]-.5*C[0]*d,c[1],c[2]+.5*C[2]*d,c[1],C[0],S[0]),w[3]&&m.drawLine(c[2],c[1]-.5*C[1]*d,c[2],c[3]+.5*C[3]*d,C[3],S[3]),w[2]&&m.drawLine(c[0]-.5*C[0]*d,c[3],c[2]+.5*C[2]*d,c[3],C[2],S[2]),y.bind(),b=0;b<2;++b)y.drawTicks(b);this.titleEnable&&y.drawTitle();var P=this.overlays;for(b=0;b<P.length;++b)P[b].draw();s.disable(s.SCISSOR_TEST),s.disable(s.BLEND),s.depthMask(!0)}},o.drawPick=function(){if(!this.static){var s=this.pickBuffer;this.gl,this._pickTimeout=null,s.begin();for(var r=1,c=this.objects,f=0;f<c.length;++f)r=c[f].drawPick(r);s.end()}},o.pick=function(s,r){if(!this.static){var c=this.pixelRatio,f=this.pickPixelRatio,d=this.viewBox,g=0|Math.round((s-d[0]/c)*f),m=0|Math.round((r-d[1]/c)*f),y=this.pickBuffer.query(g,m,this.pickRadius);if(!y)return null;for(var v=y.id+(y.value[0]<<8)+(y.value[1]<<16)+(y.value[2]<<24),T=this.objects,_=0;_<T.length;++_){var k=T[_].pick(g,m,v);if(k)return k}return null}},o.setScreenBox=function(s){var r=this.screenBox,c=this.pixelRatio;r[0]=0|Math.round(s[0]*c),r[1]=0|Math.round(s[1]*c),r[2]=0|Math.round(s[2]*c),r[3]=0|Math.round(s[3]*c),this.setDirty()},o.setDataBox=function(s){var r=this.dataBox;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3])&&(r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],this.setDirty())},o.setViewBox=function(s){var r=this.pixelRatio,c=this.viewBox;c[0]=0|Math.round(s[0]*r),c[1]=0|Math.round(s[1]*r),c[2]=0|Math.round(s[2]*r),c[3]=0|Math.round(s[3]*r);var f=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((s[2]-s[0])*f),0|Math.round((s[3]-s[1])*f)],this.setDirty()},o.update=function(s){s=s||{};var r=this.gl;this.pixelRatio=s.pixelRatio||1;var c=this.pixelRatio;this.pickPixelRatio=Math.max(c,1),this.setScreenBox(s.screenBox||[0,0,r.drawingBufferWidth/c,r.drawingBufferHeight/c]),this.screenBox,this.setViewBox(s.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/c,.125*(this.screenBox[3]-this.screenBox[1])/c,.875*(this.screenBox[2]-this.screenBox[0])/c,.875*(this.screenBox[3]-this.screenBox[1])/c]);var f=this.viewBox,d=(f[2]-f[0])/(f[3]-f[1]);this.setDataBox(s.dataBox||[-10,-10/d,10,10/d]),this.borderColor=s.borderColor!==!1&&(s.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(s.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(s.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(s.gridLineWidth||[1,1]).slice(),this.gridLineColor=a(s.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(s.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(s.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=a(s.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(s.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(s.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=a(s.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(s.titleCenter||[.5*(f[0]+f[2])/c,(f[3]+120)/c]).slice(),this.titleEnable=!("titleEnable"in s)||!!s.titleEnable,this.titleAngle=s.titleAngle||0,this.titleColor=(s.titleColor||[0,0,0,1]).slice(),this.labelPad=(s.labelPad||[15,15,15,15]).slice(),this.labelAngle=(s.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(s.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=a(s.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(s.tickPad||[15,15,15,15]).slice(),this.tickAngle=(s.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(s.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=a(s.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(s.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(s.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=a(s.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var g=s.ticks||[[],[]],m=this._tickBounds;m[0]=m[1]=1/0,m[2]=m[3]=-1/0;for(var y=0;y<2;++y){var v=g[y].slice(0);v.length!==0&&(v.sort(n),m[y]=Math.min(m[y],v[0].x),m[y+2]=Math.max(m[y+2],v[v.length-1].x))}this.grid.update({bounds:m,ticks:g}),this.text.update({bounds:m,ticks:g,labels:s.labels||["x","y"],labelSize:s.labelSize||[12,12],labelFont:s.labelFont||["sans-serif","sans-serif"],title:s.title||"",titleSize:s.titleSize||18,titleFont:s.titleFont||"sans-serif"}),this.static=!!s.static,this.setDirty()},o.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var s=this.objects.length-1;s>=0;--s)this.objects[s].dispose();for(this.objects.length=0,s=this.overlays.length-1;s>=0;--s)this.overlays[s].dispose();this.overlays.length=0,this.gl=null},o.addObject=function(s){this.objects.indexOf(s)<0&&(this.objects.push(s),this.setDirty())},o.removeObject=function(s){for(var r=this.objects,c=0;c<r.length;++c)if(r[c]===s){r.splice(c,1),this.setDirty();break}},o.addOverlay=function(s){this.overlays.indexOf(s)<0&&(this.overlays.push(s),this.setOverlayDirty())},o.removeOverlay=function(s){for(var r=this.overlays,c=0;c<r.length;++c)if(r[c]===s){r.splice(c,1),this.setOverlayDirty();break}}},{"./lib/box":316,"./lib/grid":317,"./lib/line":318,"./lib/text":320,"gl-select-static":338}],323:[function(i,B,V){B.exports=function(o,a){o=o||document.body,a=a||{};var n=[.01,1/0];"distanceLimits"in a&&(n[0]=a.distanceLimits[0],n[1]=a.distanceLimits[1]),"zoomMin"in a&&(n[0]=a.zoomMin),"zoomMax"in a&&(n[1]=a.zoomMax);var s=h({center:a.center||[0,0,0],up:a.up||[0,1,0],eye:a.eye||[0,0,10],mode:a.mode||"orbit",distanceLimits:n}),r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=0,f=o.clientWidth,d=o.clientHeight,g={keyBindingMode:"rotate",enableWheel:!0,view:s,element:o,delay:a.delay||16,rotateSpeed:a.rotateSpeed||1,zoomSpeed:a.zoomSpeed||1,translateSpeed:a.translateSpeed||1,flipX:!!a.flipX,flipY:!!a.flipY,modes:s.modes,_ortho:a._ortho||a.projection&&a.projection.type==="orthographic"||!1,tick:function(){var m=t(),y=this.delay,v=m-2*y;s.idle(m-y),s.recalcMatrix(v),s.flush(m-(100+2*y));for(var T=!0,_=s.computedMatrix,k=0;k<16;++k)T=T&&r[k]===_[k],r[k]=_[k];var E=o.clientWidth===f&&o.clientHeight===d;return f=o.clientWidth,d=o.clientHeight,T?!E:(c=Math.exp(s.computedRadius[0]),!0)},lookAt:function(m,y,v){s.lookAt(s.lastT(),m,y,v)},rotate:function(m,y,v){s.rotate(s.lastT(),m,y,v)},pan:function(m,y,v){s.pan(s.lastT(),m,y,v)},translate:function(m,y,v){s.translate(s.lastT(),m,y,v)}};return Object.defineProperties(g,{matrix:{get:function(){return s.computedMatrix},set:function(m){return s.setMatrix(s.lastT(),m),s.computedMatrix},enumerable:!0},mode:{get:function(){return s.getMode()},set:function(m){var y=s.computedUp.slice(),v=s.computedEye.slice(),T=s.computedCenter.slice();if(s.setMode(m),m==="turntable"){var _=t();s._active.lookAt(_,v,T,y),s._active.lookAt(_+500,v,T,[0,0,1]),s._active.flush(_)}return s.getMode()},enumerable:!0},center:{get:function(){return s.computedCenter},set:function(m){return s.lookAt(s.lastT(),null,m),s.computedCenter},enumerable:!0},eye:{get:function(){return s.computedEye},set:function(m){return s.lookAt(s.lastT(),m),s.computedEye},enumerable:!0},up:{get:function(){return s.computedUp},set:function(m){return s.lookAt(s.lastT(),null,null,m),s.computedUp},enumerable:!0},distance:{get:function(){return c},set:function(m){return s.setDistance(s.lastT(),m),m},enumerable:!0},distanceLimits:{get:function(){return s.getDistanceLimits(n)},set:function(m){return s.setDistanceLimits(m),m},enumerable:!0}}),o.addEventListener("contextmenu",function(m){return m.preventDefault(),!1}),g._lastX=-1,g._lastY=-1,g._lastMods={shift:!1,control:!1,alt:!1,meta:!1},g.enableMouseListeners=function(){function m(y,v,T,_){var k=g.keyBindingMode;if(k!==!1){var E=k==="rotate",A=k==="pan",b=k==="zoom",L=!!_.control,w=!!_.alt,C=!!_.shift,S=!!(1&y),P=!!(2&y),z=!!(4&y),F=1/o.clientHeight,q=F*(v-g._lastX),W=F*(T-g._lastY),X=g.flipX?1:-1,Q=g.flipY?1:-1,Z=Math.PI*g.rotateSpeed,Y=t();if(g._lastX!==-1&&g._lastY!==-1&&((E&&S&&!L&&!w&&!C||S&&!L&&!w&&C)&&s.rotate(Y,X*Z*q,-Q*Z*W,0),(A&&S&&!L&&!w&&!C||P||S&&L&&!w&&!C)&&s.pan(Y,-g.translateSpeed*q*c,g.translateSpeed*W*c,0),b&&S&&!L&&!w&&!C||z||S&&!L&&w&&!C)){var N=-g.zoomSpeed*W/window.innerHeight*(Y-s.lastT())*100;s.pan(Y,0,0,c*(Math.exp(N)-1))}return g._lastX=v,g._lastY=T,g._lastMods=_,!0}}g.mouseListener=p(o,m),o.addEventListener("touchstart",function(y){var v=e(y.changedTouches[0],o);m(0,v[0],v[1],g._lastMods),m(1,v[0],v[1],g._lastMods)},!!l&&{passive:!0}),o.addEventListener("touchmove",function(y){var v=e(y.changedTouches[0],o);m(1,v[0],v[1],g._lastMods),y.preventDefault()},!!l&&{passive:!1}),o.addEventListener("touchend",function(y){m(0,g._lastX,g._lastY,g._lastMods)},!!l&&{passive:!0}),g.wheelListener=u(o,function(y,v){if(g.keyBindingMode!==!1&&g.enableWheel){var T=g.flipX?1:-1,_=g.flipY?1:-1,k=t();if(Math.abs(y)>Math.abs(v))s.rotate(k,0,0,-y*T*Math.PI*g.rotateSpeed/window.innerWidth);else if(!g._ortho){var E=-g.zoomSpeed*_*v/window.innerHeight*(k-s.lastT())/20;s.pan(k,0,0,c*(Math.exp(E)-1))}}},!0)},g.enableMouseListeners(),g};var t=i("right-now"),h=i("3d-view"),p=i("mouse-change"),u=i("mouse-wheel"),e=i("mouse-event-offset"),l=i("has-passive-events")},{"3d-view":55,"has-passive-events":444,"mouse-change":470,"mouse-event-offset":471,"mouse-wheel":473,"right-now":542}],324:[function(i,B,V){var t=i("glslify"),h=i("gl-shader"),p=t([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),u=t([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);B.exports=function(e){return h(e,p,u,null,[{name:"position",type:"vec2"}])}},{"gl-shader":339,glslify:325}],325:[function(i,B,V){arguments[4][265][0].apply(V,arguments)},{dup:265}],326:[function(i,B,V){var t=i("./camera.js"),h=i("gl-axes3d"),p=i("gl-axes3d/properties"),u=i("gl-spikes3d"),e=i("gl-select-static"),l=i("gl-fbo"),o=i("a-big-triangle"),a=i("mouse-change"),n=i("gl-mat4/perspective"),s=i("gl-mat4/ortho"),r=i("./lib/shader"),c=i("is-mobile")({tablet:!0,featureDetect:!0});function f(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function d(m){var y=Math.round(Math.log(Math.abs(m))/Math.log(10));if(y<0){var v=Math.round(Math.pow(10,-y));return Math.ceil(m*v)/v}return y>0?(v=Math.round(Math.pow(10,y)),Math.ceil(m/v)*v):Math.ceil(m)}function g(m){return typeof m!="boolean"||m}B.exports={createScene:function(m){(m=m||{}).camera=m.camera||{};var y=m.canvas;y||(y=document.createElement("canvas"),m.container?m.container.appendChild(y):document.body.appendChild(y));var v=m.gl;if(v||(m.glOptions&&(c=!!m.glOptions.preserveDrawingBuffer),v=function(ie,he){var se=null;try{(se=ie.getContext("webgl",he))||(se=ie.getContext("experimental-webgl",he))}catch{return null}return se}(y,m.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:c})),!v)throw new Error("webgl not supported");var T=m.bounds||[[-10,-10,-10],[10,10,10]],_=new f,k=l(v,v.drawingBufferWidth,v.drawingBufferHeight,{preferFloat:!c}),E=r(v),A=m.cameraObject&&m.cameraObject._ortho===!0||m.camera.projection&&m.camera.projection.type==="orthographic"||!1,b={eye:m.camera.eye||[2,0,0],center:m.camera.center||[0,0,0],up:m.camera.up||[0,1,0],zoomMin:m.camera.zoomMax||.1,zoomMax:m.camera.zoomMin||100,mode:m.camera.mode||"turntable",_ortho:A},L=m.axes||{},w=h(v,L);w.enable=!L.disable;var C=m.spikes||{},S=u(v,C),P=[],z=[],F=[],q=[],W=!0,X=!0,Q=new Array(16),Z=new Array(16),Y={view:null,projection:Q,model:Z,_ortho:!1},N=(X=!0,[v.drawingBufferWidth,v.drawingBufferHeight]),J=m.cameraObject||t(y,b),D={gl:v,contextLost:!1,pixelRatio:m.pixelRatio||1,canvas:y,selection:_,camera:J,axes:w,axesPixels:null,spikes:S,bounds:T,objects:P,shape:N,aspect:m.aspectRatio||[1,1,1],pickRadius:m.pickRadius||10,zNear:m.zNear||.01,zFar:m.zFar||1e3,fovy:m.fovy||Math.PI/4,clearColor:m.clearColor||[0,0,0,0],autoResize:g(m.autoResize),autoBounds:g(m.autoBounds),autoScale:!!m.autoScale,autoCenter:g(m.autoCenter),clipToBounds:g(m.clipToBounds),snapToData:!!m.snapToData,onselect:m.onselect||null,onrender:m.onrender||null,onclick:m.onclick||null,cameraParams:Y,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ie){this.aspect[0]=ie.x,this.aspect[1]=ie.y,this.aspect[2]=ie.z,X=!0},setBounds:function(ie,he){this.bounds[0][ie]=he.min,this.bounds[1][ie]=he.max},setClearColor:function(ie){this.clearColor=ie},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},U=[v.drawingBufferWidth/D.pixelRatio|0,v.drawingBufferHeight/D.pixelRatio|0];function G(){if(!D._stopped&&D.autoResize){var ie=y.parentNode,he=1,se=1;ie&&ie!==document.body?(he=ie.clientWidth,se=ie.clientHeight):(he=window.innerWidth,se=window.innerHeight);var de=0|Math.ceil(he*D.pixelRatio),ce=0|Math.ceil(se*D.pixelRatio);if(de!==y.width||ce!==y.height){y.width=de,y.height=ce;var ve=y.style;ve.position=ve.position||"absolute",ve.left="0px",ve.top="0px",ve.width=he+"px",ve.height=se+"px",W=!0}}}D.autoResize&&G();function $(){for(var ie=P.length,he=q.length,se=0;se<he;++se)F[se]=0;e:for(se=0;se<ie;++se){var de=P[se],ce=de.pickSlots;if(ce){for(var ve=0;ve<he;++ve)if(F[ve]+ce<255){z[se]=ve,de.setPickBase(F[ve]+1),F[ve]+=ce;continue e}var Ee=e(v,N);z[se]=he,q.push(Ee),F.push(ce),de.setPickBase(1),he+=1}else z[se]=-1}for(;he>0&&F[he-1]===0;)F.pop(),q.pop().dispose()}function K(){if(D.contextLost)return!0;v.isContextLost()&&(D.contextLost=!0,D.mouseListener.enabled=!1,D.selection.object=null,D.oncontextloss&&D.oncontextloss())}window.addEventListener("resize",G),D.update=function(ie){D._stopped||(W=!0,X=!0)},D.add=function(ie){D._stopped||(ie.axes=w,P.push(ie),z.push(-1),W=!0,X=!0,$())},D.remove=function(ie){if(!D._stopped){var he=P.indexOf(ie);he<0||(P.splice(he,1),z.pop(),W=!0,X=!0,$())}},D.dispose=function(){if(!D._stopped&&(D._stopped=!0,window.removeEventListener("resize",G),y.removeEventListener("webglcontextlost",K),D.mouseListener.enabled=!1,!D.contextLost)){w.dispose(),S.dispose();for(var ie=0;ie<P.length;++ie)P[ie].dispose();for(k.dispose(),ie=0;ie<q.length;++ie)q[ie].dispose();E.dispose(),v=null,w=null,S=null,P=[]}},D._mouseRotating=!1,D._prevButtons=0,D.enableMouseListeners=function(){D.mouseListener=a(y,function(ie,he,se){if(!D._stopped){var de=q.length,ce=P.length,ve=_.object;_.distance=1/0,_.mouse[0]=he,_.mouse[1]=se,_.object=null,_.screen=null,_.dataCoordinate=_.dataPosition=null;var Ee=!1;if(ie&&D._prevButtons)D._mouseRotating=!0;else{D._mouseRotating&&(X=!0),D._mouseRotating=!1;for(var Le=0;Le<de;++Le){var Te=q[Le].query(he,U[1]-se-1,D.pickRadius);if(Te){if(Te.distance>_.distance)continue;for(var xe=0;xe<ce;++xe){var fe=P[xe];if(z[xe]===Le){var ge=fe.pick(Te);ge&&(_.buttons=ie,_.screen=Te.coord,_.distance=Te.distance,_.object=fe,_.index=ge.distance,_.dataPosition=ge.position,_.dataCoordinate=ge.dataCoordinate,_.data=ge,Ee=!0)}}}}}ve&&ve!==_.object&&(ve.highlight&&ve.highlight(null),W=!0),_.object&&(_.object.highlight&&_.object.highlight(_.data),W=!0),(Ee=Ee||_.object!==ve)&&D.onselect&&D.onselect(_),1&ie&&!(1&D._prevButtons)&&D.onclick&&D.onclick(_),D._prevButtons=ie}})},y.addEventListener("webglcontextlost",K);var re=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],ne=[re[0].slice(),re[1].slice()];function ae(){if(!K()){G();var ie=D.camera.tick();Y.view=D.camera.matrix,W=W||ie,X=X||ie,w.pixelRatio=D.pixelRatio,S.pixelRatio=D.pixelRatio;var he=P.length,se=re[0],de=re[1];se[0]=se[1]=se[2]=1/0,de[0]=de[1]=de[2]=-1/0;for(var ce=0;ce<he;++ce){(Be=P[ce]).pixelRatio=D.pixelRatio,Be.axes=D.axes,W=W||!!Be.dirty,X=X||!!Be.dirty;var ve=Be.bounds;if(ve)for(var Ee=ve[0],Le=ve[1],Te=0;Te<3;++Te)se[Te]=Math.min(se[Te],Ee[Te]),de[Te]=Math.max(de[Te],Le[Te])}var xe=D.bounds;if(D.autoBounds)for(Te=0;Te<3;++Te){if(de[Te]<se[Te])se[Te]=-1,de[Te]=1;else{se[Te]===de[Te]&&(se[Te]-=1,de[Te]+=1);var fe=.05*(de[Te]-se[Te]);se[Te]=se[Te]-fe,de[Te]=de[Te]+fe}xe[0][Te]=se[Te],xe[1][Te]=de[Te]}var ge=!1;for(Te=0;Te<3;++Te)ge=ge||ne[0][Te]!==xe[0][Te]||ne[1][Te]!==xe[1][Te],ne[0][Te]=xe[0][Te],ne[1][Te]=xe[1][Te];if(X=X||ge,W=W||ge){if(ge){var ke=[0,0,0];for(ce=0;ce<3;++ce)ke[ce]=d((xe[1][ce]-xe[0][ce])/10);w.autoTicks?w.update({bounds:xe,tickSpacing:ke}):w.update({bounds:xe})}var Me=v.drawingBufferWidth,Se=v.drawingBufferHeight;for(N[0]=Me,N[1]=Se,U[0]=0|Math.max(Me/D.pixelRatio,1),U[1]=0|Math.max(Se/D.pixelRatio,1),function(We,Qe){var Oe=We.bounds,Ue=We.cameraParams,Xe=Ue.projection,Ye=Ue.model,$e=We.gl.drawingBufferWidth,it=We.gl.drawingBufferHeight,ot=We.zNear,Et=We.zFar,mt=We.fovy,tt=$e/it;Qe?(s(Xe,-tt,tt,-1,1,ot,Et),Ue._ortho=!0):(n(Xe,mt,tt,ot,Et),Ue._ortho=!1);for(var Ke=0;Ke<16;++Ke)Ye[Ke]=0;Ye[15]=1;var Mt=0;for(Ke=0;Ke<3;++Ke)Mt=Math.max(Mt,Oe[1][Ke]-Oe[0][Ke]);for(Ke=0;Ke<3;++Ke)We.autoScale?Ye[5*Ke]=We.aspect[Ke]/(Oe[1][Ke]-Oe[0][Ke]):Ye[5*Ke]=1/Mt,We.autoCenter&&(Ye[12+Ke]=.5*-Ye[5*Ke]*(Oe[0][Ke]+Oe[1][Ke]))}(D,A),ce=0;ce<he;++ce)(Be=P[ce]).axesBounds=xe,D.clipToBounds&&(Be.clipBounds=xe);_.object&&(D.snapToData?S.position=_.dataCoordinate:S.position=_.dataPosition,S.bounds=xe),X&&(X=!1,function(){if(!K()){v.colorMask(!0,!0,!0,!0),v.depthMask(!0),v.disable(v.BLEND),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL);for(var We=P.length,Qe=q.length,Oe=0;Oe<Qe;++Oe){var Ue=q[Oe];Ue.shape=U,Ue.begin();for(var Xe=0;Xe<We;++Xe)if(z[Xe]===Oe){var Ye=P[Xe];Ye.drawPick&&(Ye.pixelRatio=1,Ye.drawPick(Y))}Ue.end()}}}()),D.axesPixels=p(D.axes,Y,Me,Se),D.onrender&&D.onrender(),v.bindFramebuffer(v.FRAMEBUFFER,null),v.viewport(0,0,Me,Se),D.clearRGBA(),v.depthMask(!0),v.colorMask(!0,!0,!0,!0),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL),v.disable(v.BLEND),v.disable(v.CULL_FACE);var De=!1;for(w.enable&&(De=De||w.isTransparent(),w.draw(Y)),S.axes=w,_.object&&S.draw(Y),v.disable(v.CULL_FACE),ce=0;ce<he;++ce)(Be=P[ce]).axes=w,Be.pixelRatio=D.pixelRatio,Be.isOpaque&&Be.isOpaque()&&Be.draw(Y),Be.isTransparent&&Be.isTransparent()&&(De=!0);if(De){for(k.shape=N,k.bind(),v.clear(v.DEPTH_BUFFER_BIT),v.colorMask(!1,!1,!1,!1),v.depthMask(!0),v.depthFunc(v.LESS),w.enable&&w.isTransparent()&&w.drawTransparent(Y),ce=0;ce<he;++ce)(Be=P[ce]).isOpaque&&Be.isOpaque()&&Be.draw(Y);for(v.enable(v.BLEND),v.blendEquation(v.FUNC_ADD),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.colorMask(!0,!0,!0,!0),v.depthMask(!1),v.clearColor(0,0,0,0),v.clear(v.COLOR_BUFFER_BIT),w.isTransparent()&&w.drawTransparent(Y),ce=0;ce<he;++ce){var Be;(Be=P[ce]).isTransparent&&Be.isTransparent()&&Be.drawTransparent(Y)}v.bindFramebuffer(v.FRAMEBUFFER,null),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.disable(v.DEPTH_TEST),E.bind(),k.color[0].bind(0),E.uniforms.accumBuffer=0,o(v),v.disable(v.BLEND)}for(W=!1,ce=0;ce<he;++ce)P[ce].dirty=!1}}}return D.enableMouseListeners(),function ie(){D._stopped||D.contextLost||(ae(),requestAnimationFrame(ie))}(),D.redraw=function(){D._stopped||(W=!0,ae())},D},createCamera:t}},{"./camera.js":323,"./lib/shader":324,"a-big-triangle":70,"gl-axes3d":258,"gl-axes3d/properties":266,"gl-fbo":276,"gl-mat4/ortho":302,"gl-mat4/perspective":303,"gl-select-static":338,"gl-spikes3d":349,"is-mobile":455,"mouse-change":470}],327:[function(i,B,V){var t=i("glslify");V.pointVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),V.pointFragment=t([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),V.pickVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),V.pickFragment=t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:442}],328:[function(i,B,V){var t=i("gl-shader"),h=i("gl-buffer"),p=i("typedarray-pool"),u=i("./lib/shader");function e(n,s,r,c,f){this.plot=n,this.offsetBuffer=s,this.pickBuffer=r,this.shader=c,this.pickShader=f,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}B.exports=function(n,s){var r=n.gl,c=h(r),f=h(r),d=t(r,u.pointVertex,u.pointFragment),g=t(r,u.pickVertex,u.pickFragment),m=new e(n,c,f,d,g);return m.update(s),n.addObject(m),m};var l,o,a=e.prototype;a.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},a.update=function(n){var s;function r(v,T){return v in n?n[v]:T}n=n||{},this.sizeMin=r("sizeMin",.5),this.sizeMax=r("sizeMax",20),this.color=r("color",[1,0,0,1]).slice(),this.areaRatio=r("areaRatio",1),this.borderColor=r("borderColor",[0,0,0,1]).slice(),this.blend=r("blend",!1);var c=n.positions.length>>>1,f=n.positions instanceof Float32Array,d=n.idToIndex instanceof Int32Array&&n.idToIndex.length>=c,g=n.positions,m=f?g:p.mallocFloat32(g.length),y=d?n.idToIndex:p.mallocInt32(c);if(f||m.set(g),!d)for(m.set(g),s=0;s<c;s++)y[s]=s;this.points=g,this.offsetBuffer.update(m),this.pickBuffer.update(y),f||p.free(m),d||p.free(y),this.pointCount=c,this.pickOffset=0},a.unifiedDraw=(l=[1,0,0,0,1,0,0,0,1],o=[0,0,0,0],function(n){var s=n!==void 0,r=s?this.pickShader:this.shader,c=this.plot.gl,f=this.plot.dataBox;if(this.pointCount===0)return n;var d=f[2]-f[0],g=f[3]-f[1],m=function(_,k){var E,A=0,b=_.length>>>1;for(E=0;E<b;E++){var L=_[2*E],w=_[2*E+1];L>=k[0]&&L<=k[2]&&w>=k[1]&&w<=k[3]&&A++}return A}(this.points,f),y=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(m,.33333)));l[0]=2/d,l[4]=2/g,l[6]=-2*f[0]/d-1,l[7]=-2*f[1]/g-1,this.offsetBuffer.bind(),r.bind(),r.attributes.position.pointer(),r.uniforms.matrix=l,r.uniforms.color=this.color,r.uniforms.borderColor=this.borderColor,r.uniforms.pointCloud=y<5,r.uniforms.pointSize=y,r.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),s&&(o[0]=255&n,o[1]=n>>8&255,o[2]=n>>16&255,o[3]=n>>24&255,this.pickBuffer.bind(),r.attributes.pickId.pointer(c.UNSIGNED_BYTE),r.uniforms.pickOffset=o,this.pickOffset=n);var v=c.getParameter(c.BLEND),T=c.getParameter(c.DITHER);return v&&!this.blend&&c.disable(c.BLEND),T&&c.disable(c.DITHER),c.drawArrays(c.POINTS,0,this.pointCount),v&&!this.blend&&c.enable(c.BLEND),T&&c.enable(c.DITHER),n+this.pointCount}),a.draw=a.unifiedDraw,a.drawPick=a.unifiedDraw,a.pick=function(n,s,r){var c=this.pickOffset,f=this.pointCount;if(r<c||r>=c+f)return null;var d=r-c,g=this.points;return{object:this,pointId:d,dataCoord:[g[2*d],g[2*d+1]]}}},{"./lib/shader":327,"gl-buffer":267,"gl-shader":339,"typedarray-pool":617}],329:[function(i,B,V){B.exports=function(t,h,p,u){var e,l,o,a,n,s=h[0],r=h[1],c=h[2],f=h[3],d=p[0],g=p[1],m=p[2],y=p[3];return(l=s*d+r*g+c*m+f*y)<0&&(l=-l,d=-d,g=-g,m=-m,y=-y),1-l>1e-6?(e=Math.acos(l),o=Math.sin(e),a=Math.sin((1-u)*e)/o,n=Math.sin(u*e)/o):(a=1-u,n=u),t[0]=a*s+n*d,t[1]=a*r+n*g,t[2]=a*c+n*m,t[3]=a*f+n*y,t}},{}],330:[function(i,B,V){B.exports=function(t){return t||t===0?t.toString():""}},{}],331:[function(i,B,V){var t=i("vectorize-text");B.exports=function(p,u,e){var l=h[u];if(l||(l=h[u]={}),p in l)return l[p];var o={textAlign:"center",textBaseline:"middle",lineHeight:1,font:u,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},a=t(p,o);o.triangles=!1;var n,s,r=t(p,o);if(e&&e!==1){for(n=0;n<a.positions.length;++n)for(s=0;s<a.positions[n].length;++s)a.positions[n][s]/=e;for(n=0;n<r.positions.length;++n)for(s=0;s<r.positions[n].length;++s)r.positions[n][s]/=e}var c=[[1/0,1/0],[-1/0,-1/0]],f=r.positions.length;for(n=0;n<f;++n){var d=r.positions[n];for(s=0;s<2;++s)c[0][s]=Math.min(c[0][s],d[s]),c[1][s]=Math.max(c[1][s],d[s])}return l[p]=[a,r,c]};var h={}},{"vectorize-text":623}],332:[function(i,B,V){var t=i("gl-shader"),h=i("glslify"),p=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),u=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),e=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),l=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),o=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),a=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],n={vertex:p,fragment:l,attributes:a},s={vertex:u,fragment:l,attributes:a},r={vertex:e,fragment:l,attributes:a},c={vertex:p,fragment:o,attributes:a},f={vertex:u,fragment:o,attributes:a},d={vertex:e,fragment:o,attributes:a};function g(m,y){var v=t(m,y),T=v.attributes;return T.position.location=0,T.color.location=1,T.glyph.location=2,T.id.location=3,v}V.createPerspective=function(m){return g(m,n)},V.createOrtho=function(m){return g(m,s)},V.createProject=function(m){return g(m,r)},V.createPickPerspective=function(m){return g(m,c)},V.createPickOrtho=function(m){return g(m,f)},V.createPickProject=function(m){return g(m,d)}},{"gl-shader":339,glslify:333}],333:[function(i,B,V){arguments[4][265][0].apply(V,arguments)},{dup:265}],334:[function(i,B,V){var t=i("is-string-blank"),h=i("gl-buffer"),p=i("gl-vao"),u=i("typedarray-pool"),e=i("gl-mat4/multiply"),l=i("./lib/shaders"),o=i("./lib/glyphs"),a=i("./lib/get-simple-string"),n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(F,q){var W=F[0],X=F[1],Q=F[2],Z=F[3];return F[0]=q[0]*W+q[4]*X+q[8]*Q+q[12]*Z,F[1]=q[1]*W+q[5]*X+q[9]*Q+q[13]*Z,F[2]=q[2]*W+q[6]*X+q[10]*Q+q[14]*Z,F[3]=q[3]*W+q[7]*X+q[11]*Q+q[15]*Z,F}function r(F,q,W,X){return s(X,X),s(X,X),s(X,X)}function c(F,q){this.index=F,this.dataCoordinate=this.position=q}function f(F){return F===!0||F>1?1:F}function d(F,q,W,X,Q,Z,Y,N,J,D,U,G){this.gl=F,this.pixelRatio=1,this.shader=q,this.orthoShader=W,this.projectShader=X,this.pointBuffer=Q,this.colorBuffer=Z,this.glyphBuffer=Y,this.idBuffer=N,this.vao=J,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=D,this.pickOrthoShader=U,this.pickProjectShader=G,this.points=[],this._selectResult=new c(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}B.exports=function(F){var q=F.gl,W=l.createPerspective(q),X=l.createOrtho(q),Q=l.createProject(q),Z=l.createPickPerspective(q),Y=l.createPickOrtho(q),N=l.createPickProject(q),J=h(q),D=h(q),U=h(q),G=h(q),$=p(q,[{buffer:J,size:3,type:q.FLOAT},{buffer:D,size:4,type:q.FLOAT},{buffer:U,size:2,type:q.FLOAT},{buffer:G,size:4,type:q.UNSIGNED_BYTE,normalized:!0}]),K=new d(q,W,X,Q,J,D,U,G,$,Z,Y,N);return K.update(F),K};var g=d.prototype;g.pickSlots=1,g.setPickBase=function(F){this.pickId=F},g.isTransparent=function(){if(this.hasAlpha)return!0;for(var F=0;F<3;++F)if(this.axesProject[F]&&this.projectHasAlpha)return!0;return!1},g.isOpaque=function(){if(!this.hasAlpha)return!0;for(var F=0;F<3;++F)if(this.axesProject[F]&&!this.projectHasAlpha)return!0;return!1};var m=[0,0],y=[0,0,0],v=[0,0,0],T=[0,0,0,1],_=[0,0,0,1],k=n.slice(),E=[0,0,0],A=[[0,0,0],[0,0,0]];function b(F){return F[0]=F[1]=F[2]=0,F}function L(F,q){return F[0]=q[0],F[1]=q[1],F[2]=q[2],F[3]=1,F}function w(F,q,W,X){return F[0]=q[0],F[1]=q[1],F[2]=q[2],F[W]=X,F}function C(F,q,W,X){var Q,Z=q.axesProject,Y=q.gl,N=F.uniforms,J=W.model||n,D=W.view||n,U=W.projection||n,G=q.axesBounds,$=function(xe){for(var fe=A,ge=0;ge<2;++ge)for(var ke=0;ke<3;++ke)fe[ge][ke]=Math.max(Math.min(xe[ge][ke],1e8),-1e8);return fe}(q.clipBounds);Q=q.axes&&q.axes.lastCubeProps?q.axes.lastCubeProps.axis:[1,1,1],m[0]=2/Y.drawingBufferWidth,m[1]=2/Y.drawingBufferHeight,F.bind(),N.view=D,N.projection=U,N.screenSize=m,N.highlightId=q.highlightId,N.highlightScale=q.highlightScale,N.clipBounds=$,N.pickGroup=q.pickId/255,N.pixelRatio=X;for(var K=0;K<3;++K)if(Z[K]){N.scale=q.projectScale[K],N.opacity=q.projectOpacity[K];for(var re=k,ne=0;ne<16;++ne)re[ne]=0;for(ne=0;ne<4;++ne)re[5*ne]=1;re[5*K]=0,Q[K]<0?re[12+K]=G[0][K]:re[12+K]=G[1][K],e(re,J,re),N.model=re;var ae=(K+1)%3,ie=(K+2)%3,he=b(y),se=b(v);he[ae]=1,se[ie]=1;var de=r(0,0,0,L(T,he)),ce=r(0,0,0,L(_,se));if(Math.abs(de[1])>Math.abs(ce[1])){var ve=de;de=ce,ce=ve,ve=he,he=se,se=ve;var Ee=ae;ae=ie,ie=Ee}de[0]<0&&(he[ae]=-1),ce[1]>0&&(se[ie]=-1);var Le=0,Te=0;for(ne=0;ne<4;++ne)Le+=Math.pow(J[4*ae+ne],2),Te+=Math.pow(J[4*ie+ne],2);he[ae]/=Math.sqrt(Le),se[ie]/=Math.sqrt(Te),N.axes[0]=he,N.axes[1]=se,N.fragClipBounds[0]=w(E,$[0],K,-1e8),N.fragClipBounds[1]=w(E,$[1],K,1e8),q.vao.bind(),q.vao.draw(Y.TRIANGLES,q.vertexCount),q.lineWidth>0&&(Y.lineWidth(q.lineWidth*X),q.vao.draw(Y.LINES,q.lineVertexCount,q.vertexCount)),q.vao.unbind()}}var S=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function P(F,q,W,X,Q,Z,Y){var N=W.gl;if((Z===W.projectHasAlpha||Y)&&C(q,W,X,Q),Z===W.hasAlpha||Y){F.bind();var J=F.uniforms;J.model=X.model||n,J.view=X.view||n,J.projection=X.projection||n,m[0]=2/N.drawingBufferWidth,m[1]=2/N.drawingBufferHeight,J.screenSize=m,J.highlightId=W.highlightId,J.highlightScale=W.highlightScale,J.fragClipBounds=S,J.clipBounds=W.axes.bounds,J.opacity=W.opacity,J.pickGroup=W.pickId/255,J.pixelRatio=Q,W.vao.bind(),W.vao.draw(N.TRIANGLES,W.vertexCount),W.lineWidth>0&&(N.lineWidth(W.lineWidth*Q),W.vao.draw(N.LINES,W.lineVertexCount,W.vertexCount)),W.vao.unbind()}}function z(F,q,W,X){var Q;Q=Array.isArray(F)?q<F.length?F[q]:void 0:F,Q=a(Q);var Z=!0;t(Q)&&(Q="▼",Z=!1);var Y=o(Q,W,X);return{mesh:Y[0],lines:Y[1],bounds:Y[2],visible:Z}}g.draw=function(F){P(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,F,this.pixelRatio,!1,!1)},g.drawTransparent=function(F){P(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,F,this.pixelRatio,!0,!1)},g.drawPick=function(F){P(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,F,1,!0,!0)},g.pick=function(F){if(!F||F.id!==this.pickId)return null;var q=F.value[2]+(F.value[1]<<8)+(F.value[0]<<16);if(q>=this.pointCount||q<0)return null;var W=this.points[q],X=this._selectResult;X.index=q;for(var Q=0;Q<3;++Q)X.position[Q]=X.dataCoordinate[Q]=W[Q];return X},g.highlight=function(F){if(F){var q=F.index,W=255&q,X=q>>8&255,Q=q>>16&255;this.highlightId=[W/255,X/255,Q/255,0]}else this.highlightId=[1,1,1,1]},g.update=function(F){if("perspective"in(F=F||{})&&(this.useOrtho=!F.perspective),"orthographic"in F&&(this.useOrtho=!!F.orthographic),"lineWidth"in F&&(this.lineWidth=F.lineWidth),"project"in F)if(Array.isArray(F.project))this.axesProject=F.project;else{var q=!!F.project;this.axesProject=[q,q,q]}if("projectScale"in F)if(Array.isArray(F.projectScale))this.projectScale=F.projectScale.slice();else{var W=+F.projectScale;this.projectScale=[W,W,W]}if(this.projectHasAlpha=!1,"projectOpacity"in F){Array.isArray(F.projectOpacity)?this.projectOpacity=F.projectOpacity.slice():(W=+F.projectOpacity,this.projectOpacity=[W,W,W]);for(var X=0;X<3;++X)this.projectOpacity[X]=f(this.projectOpacity[X]),this.projectOpacity[X]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in F&&(this.opacity=f(F.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var Q,Z,Y=F.position,N=F.font||"normal",J=F.alignment||[0,0];if(J.length===2)Q=J[0],Z=J[1];else for(Q=[],Z=[],X=0;X<J.length;++X)Q[X]=J[X][0],Z[X]=J[X][1];var D=[1/0,1/0,1/0],U=[-1/0,-1/0,-1/0],G=F.glyph,$=F.color,K=F.size,re=F.angle,ne=F.lineColor,ae=-1,ie=0,he=0,se=0;if(Y.length){se=Y.length;e:for(X=0;X<se;++X){for(var de=Y[X],ce=0;ce<3;++ce)if(isNaN(de[ce])||!isFinite(de[ce]))continue e;var ve=(Oe=z(G,X,N,this.pixelRatio)).mesh,Ee=Oe.lines,Le=Oe.bounds;ie+=3*ve.cells.length,he+=2*Ee.edges.length}}var Te=ie+he,xe=u.mallocFloat(3*Te),fe=u.mallocFloat(4*Te),ge=u.mallocFloat(2*Te),ke=u.mallocUint32(Te);if(Te>0){var Me=0,Se=ie,De=[0,0,0,1],Be=[0,0,0,1],We=Array.isArray($)&&Array.isArray($[0]),Qe=Array.isArray(ne)&&Array.isArray(ne[0]);e:for(X=0;X<se;++X){for(ae+=1,de=Y[X],ce=0;ce<3;++ce){if(isNaN(de[ce])||!isFinite(de[ce]))continue e;U[ce]=Math.max(U[ce],de[ce]),D[ce]=Math.min(D[ce],de[ce])}ve=(Oe=z(G,X,N,this.pixelRatio)).mesh,Ee=Oe.lines,Le=Oe.bounds;var Oe,Ue=Oe.visible;if(Ue)if(Array.isArray($)){if((Xe=We?X<$.length?$[X]:[0,0,0,0]:$).length===3){for(ce=0;ce<3;++ce)De[ce]=Xe[ce];De[3]=1}else if(Xe.length===4){for(ce=0;ce<4;++ce)De[ce]=Xe[ce];!this.hasAlpha&&Xe[3]<1&&(this.hasAlpha=!0)}}else De[0]=De[1]=De[2]=0,De[3]=1;else De=[1,1,1,0];if(Ue)if(Array.isArray(ne)){var Xe;if((Xe=Qe?X<ne.length?ne[X]:[0,0,0,0]:ne).length===3){for(ce=0;ce<3;++ce)Be[ce]=Xe[ce];Be[ce]=1}else if(Xe.length===4){for(ce=0;ce<4;++ce)Be[ce]=Xe[ce];!this.hasAlpha&&Xe[3]<1&&(this.hasAlpha=!0)}}else Be[0]=Be[1]=Be[2]=0,Be[3]=1;else Be=[1,1,1,0];var Ye=.5;Ue?Array.isArray(K)?Ye=X<K.length?+K[X]:12:K?Ye=+K:this.useOrtho&&(Ye=12):Ye=0;var $e=0;Array.isArray(re)?$e=X<re.length?+re[X]:0:re&&($e=+re);var it=Math.cos($e),ot=Math.sin($e);for(de=Y[X],ce=0;ce<3;++ce)U[ce]=Math.max(U[ce],de[ce]),D[ce]=Math.min(D[ce],de[ce]);var Et=Q,mt=Z;Et=0,Array.isArray(Q)?Et=X<Q.length?Q[X]:0:Q&&(Et=Q),mt=0,Array.isArray(Z)?mt=X<Z.length?Z[X]:0:Z&&(mt=Z);var tt=[Et*=Et>0?1-Le[0][0]:Et<0?1+Le[1][0]:1,mt*=mt>0?1-Le[0][1]:mt<0?1+Le[1][1]:1],Ke=ve.cells||[],Mt=ve.positions||[];for(ce=0;ce<Ke.length;++ce)for(var Jt=Ke[ce],$t=0;$t<3;++$t){for(var je=0;je<3;++je)xe[3*Me+je]=de[je];for(je=0;je<4;++je)fe[4*Me+je]=De[je];ke[Me]=ae;var Ge=Mt[Jt[$t]];ge[2*Me]=Ye*(it*Ge[0]-ot*Ge[1]+tt[0]),ge[2*Me+1]=Ye*(ot*Ge[0]+it*Ge[1]+tt[1]),Me+=1}for(Ke=Ee.edges,Mt=Ee.positions,ce=0;ce<Ke.length;++ce)for(Jt=Ke[ce],$t=0;$t<2;++$t){for(je=0;je<3;++je)xe[3*Se+je]=de[je];for(je=0;je<4;++je)fe[4*Se+je]=Be[je];ke[Se]=ae,Ge=Mt[Jt[$t]],ge[2*Se]=Ye*(it*Ge[0]-ot*Ge[1]+tt[0]),ge[2*Se+1]=Ye*(ot*Ge[0]+it*Ge[1]+tt[1]),Se+=1}}}this.bounds=[D,U],this.points=Y,this.pointCount=Y.length,this.vertexCount=ie,this.lineVertexCount=he,this.pointBuffer.update(xe),this.colorBuffer.update(fe),this.glyphBuffer.update(ge),this.idBuffer.update(ke),u.free(xe),u.free(fe),u.free(ge),u.free(ke)},g.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":330,"./lib/glyphs":331,"./lib/shaders":332,"gl-buffer":267,"gl-mat4/multiply":301,"gl-vao":361,"is-string-blank":458,"typedarray-pool":617}],335:[function(i,B,V){var t=i("glslify");V.boxVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),V.boxFragment=t([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:336}],336:[function(i,B,V){arguments[4][265][0].apply(V,arguments)},{dup:265}],337:[function(i,B,V){var t=i("gl-shader"),h=i("gl-buffer"),p=i("./lib/shaders");function u(l,o,a){this.plot=l,this.boxBuffer=o,this.boxShader=a,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}B.exports=function(l,o){var a=l.gl,n=h(a,[0,0,0,1,1,0,1,1]),s=t(a,p.boxVertex,p.boxFragment),r=new u(l,n,s);return r.update(o),l.addOverlay(r),r};var e=u.prototype;e.draw=function(){if(this.enabled){var l=this.plot,o=this.selectBox,a=this.borderWidth,n=(this.innerFill,this.innerColor),s=(this.outerFill,this.outerColor),r=this.borderColor,c=l.box,f=l.screenBox,d=l.dataBox,g=l.viewBox,m=l.pixelRatio,y=(o[0]-d[0])*(g[2]-g[0])/(d[2]-d[0])+g[0],v=(o[1]-d[1])*(g[3]-g[1])/(d[3]-d[1])+g[1],T=(o[2]-d[0])*(g[2]-g[0])/(d[2]-d[0])+g[0],_=(o[3]-d[1])*(g[3]-g[1])/(d[3]-d[1])+g[1];if(y=Math.max(y,g[0]),v=Math.max(v,g[1]),T=Math.min(T,g[2]),_=Math.min(_,g[3]),!(T<y||_<v)){c.bind();var k=f[2]-f[0],E=f[3]-f[1];if(this.outerFill&&(c.drawBox(0,0,k,v,s),c.drawBox(0,v,y,_,s),c.drawBox(0,_,k,E,s),c.drawBox(T,v,k,_,s)),this.innerFill&&c.drawBox(y,v,T,_,n),a>0){var A=a*m;c.drawBox(y-A,v-A,T+A,v+A,r),c.drawBox(y-A,_-A,T+A,_+A,r),c.drawBox(y-A,v-A,y+A,_+A,r),c.drawBox(T-A,v-A,T+A,_+A,r)}}}},e.update=function(l){l=l||{},this.innerFill=!!l.innerFill,this.outerFill=!!l.outerFill,this.innerColor=(l.innerColor||[0,0,0,.5]).slice(),this.outerColor=(l.outerColor||[0,0,0,.5]).slice(),this.borderColor=(l.borderColor||[0,0,0,1]).slice(),this.borderWidth=l.borderWidth||0,this.selectBox=(l.selectBox||this.selectBox).slice()},e.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":335,"gl-buffer":267,"gl-shader":339}],338:[function(i,B,V){B.exports=function(a,n){var s=n[0],r=n[1],c=t(a,s,r,{}),f=h.mallocUint8(s*r*4);return new l(a,c,f)};var t=i("gl-fbo"),h=i("typedarray-pool"),p=i("ndarray"),u=i("bit-twiddle").nextPow2;function e(a,n,s,r,c){this.coord=[a,n],this.id=s,this.value=r,this.distance=c}function l(a,n,s){this.gl=a,this.fbo=n,this.buffer=s,this._readTimeout=null;var r=this;this._readCallback=function(){r.gl&&(n.bind(),a.readPixels(0,0,n.shape[0],n.shape[1],a.RGBA,a.UNSIGNED_BYTE,r.buffer),r._readTimeout=null)}}var o=l.prototype;Object.defineProperty(o,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(a){if(this.gl){this.fbo.shape=a;var n=this.fbo.shape[0],s=this.fbo.shape[1];if(s*n*4>this.buffer.length){h.free(this.buffer);for(var r=this.buffer=h.mallocUint8(u(s*n*4)),c=0;c<s*n*4;++c)r[c]=255}return a}}}),o.begin=function(){var a=this.gl;this.shape,a&&(this.fbo.bind(),a.clearColor(1,1,1,1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT))},o.end=function(){var a=this.gl;a&&(a.bindFramebuffer(a.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},o.query=function(a,n,s){if(!this.gl)return null;var r=this.fbo.shape.slice();a|=0,n|=0,typeof s!="number"&&(s=1);var c=0|Math.min(Math.max(a-s,0),r[0]),f=0|Math.min(Math.max(a+s,0),r[0]),d=0|Math.min(Math.max(n-s,0),r[1]),g=0|Math.min(Math.max(n+s,0),r[1]);if(f<=c||g<=d)return null;var m=[f-c,g-d],y=p(this.buffer,[m[0],m[1],4],[4,4*r[0],1],4*(c+r[0]*d)),v=function(k,E,A){for(var b=1e8,L=-1,w=-1,C=k.shape[0],S=k.shape[1],P=0;P<C;P++)for(var z=0;z<S;z++){var F=k.get(P,z,0),q=k.get(P,z,1),W=k.get(P,z,2),X=k.get(P,z,3);if(F<255||q<255||W<255||X<255){var Q=E-P,Z=A-z,Y=Q*Q+Z*Z;Y<b&&(b=Y,L=P,w=z)}}return[L,w,b]}(y.hi(m[0],m[1],1),s,s),T=v[0],_=v[1];return T<0||Math.pow(this.radius,2)<v[2]?null:new e(T+c|0,_+d|0,y.get(T,_,0),[y.get(T,_,1),y.get(T,_,2),y.get(T,_,3)],Math.sqrt(v[2]))},o.dispose=function(){this.gl&&(this.fbo.dispose(),h.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":104,"gl-fbo":276,ndarray:483,"typedarray-pool":617}],339:[function(i,B,V){var t=i("./lib/create-uniforms"),h=i("./lib/create-attributes"),p=i("./lib/reflect"),u=i("./lib/shader-cache"),e=i("./lib/runtime-reflect"),l=i("./lib/GLError");function o(s){this.gl=s,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var a=o.prototype;function n(s,r){return s.name<r.name?-1:1}a.bind=function(){var s;this.program||this._relink();var r=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),c=this.gl.lastAttribCount;if(r>c)for(s=c;s<r;s++)this.gl.enableVertexAttribArray(s);else if(c>r)for(s=r;s<c;s++)this.gl.disableVertexAttribArray(s);this.gl.lastAttribCount=r,this.gl.useProgram(this.program)},a.dispose=function(){for(var s=this.gl.lastAttribCount,r=0;r<s;r++)this.gl.disableVertexAttribArray(r);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},a.update=function(s,r,c,f){if(!r||arguments.length===1){var d=s;s=d.vertex,r=d.fragment,c=d.uniforms,f=d.attributes}var g=this,m=g.gl,y=g._vref;g._vref=u.shader(m,m.VERTEX_SHADER,s),y&&y.dispose(),g.vertShader=g._vref.shader;var v=this._fref;if(g._fref=u.shader(m,m.FRAGMENT_SHADER,r),v&&v.dispose(),g.fragShader=g._fref.shader,!c||!f){var T=m.createProgram();if(m.attachShader(T,g.fragShader),m.attachShader(T,g.vertShader),m.linkProgram(T),!m.getProgramParameter(T,m.LINK_STATUS)){var _=m.getProgramInfoLog(T);throw new l(_,"Error linking program:"+_)}c=c||e.uniforms(m,T),f=f||e.attributes(m,T),m.deleteProgram(T)}(f=f.slice()).sort(n);var k,E=[],A=[],b=[];for(k=0;k<f.length;++k){var L=f[k];if(L.type.indexOf("mat")>=0){for(var w=0|L.type.charAt(L.type.length-1),C=new Array(w),S=0;S<w;++S)C[S]=b.length,A.push(L.name+"["+S+"]"),typeof L.location=="number"?b.push(L.location+S):Array.isArray(L.location)&&L.location.length===w&&typeof L.location[S]=="number"?b.push(0|L.location[S]):b.push(-1);E.push({name:L.name,type:L.type,locations:C})}else E.push({name:L.name,type:L.type,locations:[b.length]}),A.push(L.name),typeof L.location=="number"?b.push(0|L.location):b.push(-1)}var P=0;for(k=0;k<b.length;++k)if(b[k]<0){for(;b.indexOf(P)>=0;)P+=1;b[k]=P}var z=new Array(c.length);function F(){g.program=u.program(m,g._vref,g._fref,A,b);for(var q=0;q<c.length;++q)z[q]=m.getUniformLocation(g.program,c[q].name)}F(),g._relink=F,g.types={uniforms:p(c),attributes:p(f)},g.attributes=h(m,g,E,b),Object.defineProperty(g,"uniforms",t(m,g,c,z))},B.exports=function(s,r,c,f,d){var g=new o(s);return g.update(r,c,f,d),g}},{"./lib/GLError":340,"./lib/create-attributes":341,"./lib/create-uniforms":342,"./lib/reflect":343,"./lib/runtime-reflect":344,"./lib/shader-cache":345}],340:[function(i,B,V){function t(h,p,u){this.shortMessage=p||"",this.longMessage=u||"",this.rawError=h||"",this.message="gl-shader: "+(p||h||"")+(u?`
`+u:""),this.stack=new Error().stack}t.prototype=new Error,t.prototype.name="GLError",t.prototype.constructor=t,B.exports=t},{}],341:[function(i,B,V){B.exports=function(l,o,a,n){for(var s={},r=0,c=a.length;r<c;++r){var f=a[r],d=f.name,g=f.type,m=f.locations;switch(g){case"bool":case"int":case"float":u(l,o,m[0],n,1,s,d);break;default:if(g.indexOf("vec")>=0){if((y=g.charCodeAt(g.length-1)-48)<2||y>4)throw new t("","Invalid data type for attribute "+d+": "+g);u(l,o,m[0],n,y,s,d)}else{if(!(g.indexOf("mat")>=0))throw new t("","Unknown data type for attribute "+d+": "+g);var y;if((y=g.charCodeAt(g.length-1)-48)<2||y>4)throw new t("","Invalid data type for attribute "+d+": "+g);e(l,o,m,n,y,s,d)}}}return s};var t=i("./GLError");function h(l,o,a,n,s,r){this._gl=l,this._wrapper=o,this._index=a,this._locations=n,this._dimension=s,this._constFunc=r}var p=h.prototype;function u(l,o,a,n,s,r,c){for(var f=["gl","v"],d=[],g=0;g<s;++g)f.push("x"+g),d.push("x"+g);f.push("if(x0.length===void 0){return gl.vertexAttrib"+s+"f(v,"+d.join()+")}else{return gl.vertexAttrib"+s+"fv(v,x0)}");var m=Function.apply(null,f),y=new h(l,o,a,n,s,m);Object.defineProperty(r,c,{set:function(v){return l.disableVertexAttribArray(n[a]),m(l,n[a],v),v},get:function(){return y},enumerable:!0})}function e(l,o,a,n,s,r,c){for(var f=new Array(s),d=new Array(s),g=0;g<s;++g)u(l,o,a[g],n,s,f,g),d[g]=f[g];Object.defineProperty(f,"location",{set:function(v){if(Array.isArray(v))for(var T=0;T<s;++T)d[T].location=v[T];else for(T=0;T<s;++T)d[T].location=v+T;return v},get:function(){for(var v=new Array(s),T=0;T<s;++T)v[T]=n[a[T]];return v},enumerable:!0}),f.pointer=function(v,T,_,k){v=v||l.FLOAT,T=!!T,_=_||s*s,k=k||0;for(var E=0;E<s;++E){var A=n[a[E]];l.vertexAttribPointer(A,s,v,T,_,k+E*s),l.enableVertexAttribArray(A)}};var m=new Array(s),y=l["vertexAttrib"+s+"fv"];Object.defineProperty(r,c,{set:function(v){for(var T=0;T<s;++T){var _=n[a[T]];if(l.disableVertexAttribArray(_),Array.isArray(v[0]))y.call(l,_,v[T]);else{for(var k=0;k<s;++k)m[k]=v[s*T+k];y.call(l,_,m)}}return v},get:function(){return f},enumerable:!0})}p.pointer=function(l,o,a,n){var s=this._gl,r=this._locations[this._index];s.vertexAttribPointer(r,this._dimension,l||s.FLOAT,!!o,a||0,n||0),s.enableVertexAttribArray(r)},p.set=function(l,o,a,n){return this._constFunc(this._locations[this._index],l,o,a,n)},Object.defineProperty(p,"location",{get:function(){return this._locations[this._index]},set:function(l){return l!==this._locations[this._index]&&(this._locations[this._index]=0|l,this._wrapper.program=null),0|l}})},{"./GLError":340}],342:[function(i,B,V){var t=i("./reflect"),h=i("./GLError");function p(e){return new Function("y","return function(){return y}")(e)}function u(e,l){for(var o=new Array(e),a=0;a<e;++a)o[a]=l;return o}B.exports=function(e,l,o,a){function n(d,g,m){switch(m){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+g+"],obj"+d+")";case"float":return"gl.uniform1f(locations["+g+"],obj"+d+")";default:var y=m.indexOf("vec");if(!(0<=y&&y<=1&&m.length===4+y)){if(m.indexOf("mat")===0&&m.length===4){var v;if((v=m.charCodeAt(m.length-1)-48)<2||v>4)throw new h("","Invalid uniform dimension type for matrix "+name+": "+m);return"gl.uniformMatrix"+v+"fv(locations["+g+"],false,obj"+d+")"}throw new h("","Unknown uniform data type for "+name+": "+m)}if((v=m.charCodeAt(m.length-1)-48)<2||v>4)throw new h("","Invalid data type");switch(m.charAt(0)){case"b":case"i":return"gl.uniform"+v+"iv(locations["+g+"],obj"+d+")";case"v":return"gl.uniform"+v+"fv(locations["+g+"],obj"+d+")";default:throw new h("","Unrecognized data type for vector "+name+": "+m)}}}function s(d){for(var g=["return function updateProperty(obj){"],m=function k(E,A){if(typeof A!="object")return[[E,A]];var b=[];for(var L in A){var w=A[L],C=E;parseInt(L)+""===L?C+="["+L+"]":C+="."+L,typeof w=="object"?b.push.apply(b,k(C,w)):b.push([C,w])}return b}("",d),y=0;y<m.length;++y){var v=m[y],T=v[0],_=v[1];a[_]&&g.push(n(T,_,o[_].type))}return g.push("return obj}"),new Function("gl","locations",g.join(`
`))(e,a)}function r(d,g,m){if(typeof m=="object"){var y=c(m);Object.defineProperty(d,g,{get:p(y),set:s(m),enumerable:!0,configurable:!1})}else a[m]?Object.defineProperty(d,g,{get:(v=m,new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+v+"])}")(e,l,a)),set:s(m),enumerable:!0,configurable:!1}):d[g]=function(T){switch(T){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var _=T.indexOf("vec");if(0<=_&&_<=1&&T.length===4+_){if((k=T.charCodeAt(T.length-1)-48)<2||k>4)throw new h("","Invalid data type");return T.charAt(0)==="b"?u(k,!1):u(k,0)}if(T.indexOf("mat")===0&&T.length===4){var k;if((k=T.charCodeAt(T.length-1)-48)<2||k>4)throw new h("","Invalid uniform dimension type for matrix "+name+": "+T);return u(k*k,0)}throw new h("","Unknown uniform data type for "+name+": "+T)}}(o[m].type);var v}function c(d){var g;if(Array.isArray(d)){g=new Array(d.length);for(var m=0;m<d.length;++m)r(g,m,d[m])}else for(var y in g={},d)r(g,y,d[y]);return g}var f=t(o,!0);return{get:p(c(f)),set:s(f),enumerable:!0,configurable:!0}}},{"./GLError":340,"./reflect":343}],343:[function(i,B,V){B.exports=function(t,h){for(var p={},u=0;u<t.length;++u)for(var e=t[u].name.split("."),l=p,o=0;o<e.length;++o){var a=e[o].split("[");if(a.length>1){a[0]in l||(l[a[0]]=[]),l=l[a[0]];for(var n=1;n<a.length;++n){var s=parseInt(a[n]);n<a.length-1||o<e.length-1?(s in l||(n<a.length-1?l[s]=[]:l[s]={}),l=l[s]):l[s]=h?u:t[u].type}}else o<e.length-1?(a[0]in l||(l[a[0]]={}),l=l[a[0]]):l[a[0]]=h?u:t[u].type}return p}},{}],344:[function(i,B,V){V.uniforms=function(u,e){for(var l=u.getProgramParameter(e,u.ACTIVE_UNIFORMS),o=[],a=0;a<l;++a){var n=u.getActiveUniform(e,a);if(n){var s=p(u,n.type);if(n.size>1)for(var r=0;r<n.size;++r)o.push({name:n.name.replace("[0]","["+r+"]"),type:s});else o.push({name:n.name,type:s})}}return o},V.attributes=function(u,e){for(var l=u.getProgramParameter(e,u.ACTIVE_ATTRIBUTES),o=[],a=0;a<l;++a){var n=u.getActiveAttrib(e,a);n&&o.push({name:n.name,type:p(u,n.type)})}return o};var t={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},h=null;function p(u,e){if(!h){var l=Object.keys(t);h={};for(var o=0;o<l.length;++o){var a=l[o];h[u[a]]=t[a]}}return h[e]}},{}],345:[function(i,B,V){V.shader=function(n,s,r){return a(n).getShaderReference(s,r)},V.program=function(n,s,r,c,f){return a(n).getProgram(s,r,c,f)};var t=i("./GLError"),h=i("gl-format-compiler-error"),p=new(typeof WeakMap>"u"?i("weakmap-shim"):WeakMap),u=0;function e(n,s,r,c,f,d,g){this.id=n,this.src=s,this.type=r,this.shader=c,this.count=d,this.programs=[],this.cache=g}function l(n){this.gl=n,this.shaders=[{},{}],this.programs={}}e.prototype.dispose=function(){if(--this.count==0){for(var n=this.cache,s=n.gl,r=this.programs,c=0,f=r.length;c<f;++c){var d=n.programs[r[c]];d&&(delete n.programs[c],s.deleteProgram(d))}s.deleteShader(this.shader),delete n.shaders[this.type===s.FRAGMENT_SHADER|0][this.src]}};var o=l.prototype;function a(n){var s=p.get(n);return s||(s=new l(n),p.set(n,s)),s}o.getShaderReference=function(n,s){var r=this.gl,c=this.shaders[n===r.FRAGMENT_SHADER|0],f=c[s];if(f&&r.isShader(f.shader))f.count+=1;else{var d=function(g,m,y){var v=g.createShader(m);if(g.shaderSource(v,y),g.compileShader(v),!g.getShaderParameter(v,g.COMPILE_STATUS)){var T=g.getShaderInfoLog(v);try{var _=h(T,y,m)}catch(k){throw console.warn("Failed to format compiler error: "+k),new t(T,`Error compiling shader:
`+T)}throw new t(T,_.short,_.long)}return v}(r,n,s);f=c[s]=new e(u++,s,n,d,[],1,this)}return f},o.getProgram=function(n,s,r,c){var f=[n.id,s.id,r.join(":"),c.join(":")].join("@"),d=this.programs[f];return d&&this.gl.isProgram(d)||(this.programs[f]=d=function(g,m,y,v,T){var _=g.createProgram();g.attachShader(_,m),g.attachShader(_,y);for(var k=0;k<v.length;++k)g.bindAttribLocation(_,T[k],v[k]);if(g.linkProgram(_),!g.getProgramParameter(_,g.LINK_STATUS)){var E=g.getProgramInfoLog(_);throw new t(E,"Error linking program: "+E)}return _}(this.gl,n.shader,s.shader,r,c),n.programs.push(f),s.programs.push(f)),d}},{"./GLError":340,"gl-format-compiler-error":277,"weakmap-shim":628}],346:[function(i,B,V){function t(p){this.plot=p,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}B.exports=function(p,u){var e=new t(p);return e.update(u),p.addOverlay(e),e};var h=t.prototype;h.update=function(p){p=p||{},this.enable=(p.enable||[!0,!0,!1,!1]).slice(),this.width=(p.width||[1,1,1,1]).slice(),this.color=(p.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(u){return u.slice()}),this.center=(p.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},h.draw=function(){var p=this.enable,u=this.width,e=this.color,l=this.center,o=this.plot,a=o.line,n=o.dataBox,s=o.viewBox;if(a.bind(),n[0]<=l[0]&&l[0]<=n[2]&&n[1]<=l[1]&&l[1]<=n[3]){var r=s[0]+(l[0]-n[0])/(n[2]-n[0])*(s[2]-s[0]),c=s[1]+(l[1]-n[1])/(n[3]-n[1])*(s[3]-s[1]);p[0]&&a.drawLine(r,c,s[0],c,u[0],e[0]),p[1]&&a.drawLine(r,c,r,s[1],u[1],e[1]),p[2]&&a.drawLine(r,c,s[2],c,u[2],e[2]),p[3]&&a.drawLine(r,c,r,s[3],u[3],e[3])}},h.dispose=function(){this.plot.removeOverlay(this)}},{}],347:[function(i,B,V){arguments[4][265][0].apply(V,arguments)},{dup:265}],348:[function(i,B,V){var t=i("glslify"),h=i("gl-shader"),p=t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),u=t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);B.exports=function(e){return h(e,p,u,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":339,glslify:347}],349:[function(i,B,V){var t=i("gl-buffer"),h=i("gl-vao"),p=i("./shaders/index");B.exports=function(s,r){var c=[];function f(v,T,_,k,E,A){var b=[v,T,_,0,0,0,1];b[k+3]=1,b[k]=E,c.push.apply(c,b),b[6]=-1,c.push.apply(c,b),b[k]=A,c.push.apply(c,b),c.push.apply(c,b),b[6]=1,c.push.apply(c,b),b[k]=E,c.push.apply(c,b)}f(0,0,0,0,0,1),f(0,0,0,1,0,1),f(0,0,0,2,0,1),f(1,0,0,1,-1,1),f(1,0,0,2,-1,1),f(0,1,0,0,-1,1),f(0,1,0,2,-1,1),f(0,0,1,0,-1,1),f(0,0,1,1,-1,1);var d=t(s,c),g=h(s,[{type:s.FLOAT,buffer:d,size:3,offset:0,stride:28},{type:s.FLOAT,buffer:d,size:3,offset:12,stride:28},{type:s.FLOAT,buffer:d,size:1,offset:24,stride:28}]),m=p(s);m.attributes.position.location=0,m.attributes.color.location=1,m.attributes.weight.location=2;var y=new e(s,d,g,m);return y.update(r),y};var u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(s,r,c,f){this.gl=s,this.buffer=r,this.vao=c,this.shader=f,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var l=e.prototype,o=[0,0,0],a=[0,0,0],n=[0,0];l.isTransparent=function(){return!1},l.drawTransparent=function(s){},l.draw=function(s){var r=this.gl,c=this.vao,f=this.shader;c.bind(),f.bind();var d,g=s.model||u,m=s.view||u,y=s.projection||u;this.axes&&(d=this.axes.lastCubeProps.axis);for(var v=o,T=a,_=0;_<3;++_)d&&d[_]<0?(v[_]=this.bounds[0][_],T[_]=this.bounds[1][_]):(v[_]=this.bounds[1][_],T[_]=this.bounds[0][_]);for(n[0]=r.drawingBufferWidth,n[1]=r.drawingBufferHeight,f.uniforms.model=g,f.uniforms.view=m,f.uniforms.projection=y,f.uniforms.coordinates=[this.position,v,T],f.uniforms.colors=this.colors,f.uniforms.screenShape=n,_=0;_<3;++_)f.uniforms.lineWidth=this.lineWidth[_]*this.pixelRatio,this.enabled[_]&&(c.draw(r.TRIANGLES,6,6*_),this.drawSides[_]&&c.draw(r.TRIANGLES,12,18+12*_));c.unbind()},l.update=function(s){s&&("bounds"in s&&(this.bounds=s.bounds),"position"in s&&(this.position=s.position),"lineWidth"in s&&(this.lineWidth=s.lineWidth),"colors"in s&&(this.colors=s.colors),"enabled"in s&&(this.enabled=s.enabled),"drawSides"in s&&(this.drawSides=s.drawSides))},l.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":348,"gl-buffer":267,"gl-vao":361}],350:[function(i,B,V){var t=i("glslify"),h=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),p=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),u=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);V.meshShader={vertex:h,fragment:p,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},V.pickShader={vertex:u,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:351}],351:[function(i,B,V){arguments[4][265][0].apply(V,arguments)},{dup:265}],352:[function(i,B,V){var t=i("gl-vec3"),h=i("gl-vec4"),p=["xyz","xzy","yxz","yzx","zxy","zyx"],u=function(s,r,c,f){for(var d=0,g=0;g<s.length;g++)for(var m=s[g].velocities,y=0;y<m.length;y++)d=Math.max(d,t.length(m[y]));var v=s.map(function(S){return function(P,z,F,q){for(var W=P.points,X=P.velocities,Q=P.divergences,Z=[],Y=[],N=[],J=[],D=[],U=[],G=0,$=0,K=h.create(),re=h.create(),ne=0;ne<W.length;ne++){var ae=W[ne],ie=X[ne],he=Q[ne];z===0&&(he=.05*F),$=t.length(ie)/q,K=h.create(),t.copy(K,ie),K[3]=he;for(var se=0;se<8;se++)D[se]=[ae[0],ae[1],ae[2],se];if(J.length>0)for(se=0;se<8;se++){var de=(se+1)%8;Z.push(J[se],D[se],D[de],D[de],J[de],J[se]),N.push(re,K,K,K,re,re),U.push(G,$,$,$,G,G);var ce=Z.length;Y.push([ce-6,ce-5,ce-4],[ce-3,ce-2,ce-1])}var ve=J;J=D,D=ve;var Ee=re;re=K,K=Ee;var Le=G;G=$,$=Le}return{positions:Z,cells:Y,vectors:N,vertexIntensity:U}}(S,c,f,d)}),T=[],_=[],k=[],E=[];for(g=0;g<v.length;g++){var A=v[g],b=T.length;for(T=T.concat(A.positions),k=k.concat(A.vectors),E=E.concat(A.vertexIntensity),y=0;y<A.cells.length;y++){var L=A.cells[y],w=[];_.push(w);for(var C=0;C<L.length;C++)w.push(L[C]+b)}}return{positions:T,cells:_,vectors:k,vertexIntensity:E,colormap:r}},e=function(s,r){var c,f=s.length;for(c=0;c<f;c++){var d=s[c];if(d===r)return c;if(d>r)return c-1}return c},l=function(s,r,c){return s<r?r:s>c?c:s},o=function(s){var r=1/0;s.sort(function(g,m){return g-m});for(var c=s.length,f=1;f<c;f++){var d=Math.abs(s[f]-s[f-1]);d<r&&(r=d)}return r};B.exports=function(s,r){var c=s.startingPositions,f=s.maxLength||1e3,d=s.tubeSize||1,g=s.absoluteTubeSize,m=s.gridFill||"+x+y+z",y={};m.indexOf("-x")!==-1&&(y.reversedX=!0),m.indexOf("-y")!==-1&&(y.reversedY=!0),m.indexOf("-z")!==-1&&(y.reversedZ=!0),y.filled=p.indexOf(m.replace(/-/g,"").replace(/\+/g,""));var v=s.getVelocity||function(ne){return function(ae,ie,he){var se=ie.vectors,de=ie.meshgrid,ce=ae[0],ve=ae[1],Ee=ae[2],Le=de[0].length,Te=de[1].length,xe=de[2].length,fe=e(de[0],ce),ge=e(de[1],ve),ke=e(de[2],Ee),Me=fe+1,Se=ge+1,De=ke+1;if(fe=l(fe,0,Le-1),Me=l(Me,0,Le-1),ge=l(ge,0,Te-1),Se=l(Se,0,Te-1),ke=l(ke,0,xe-1),De=l(De,0,xe-1),fe<0||ge<0||ke<0||Me>Le-1||Se>Te-1||De>xe-1)return t.create();var Be,We,Qe,Oe,Ue,Xe,Ye=de[0][fe],$e=de[0][Me],it=de[1][ge],ot=de[1][Se],Et=de[2][ke],mt=(ce-Ye)/($e-Ye),tt=(ve-it)/(ot-it),Ke=(Ee-Et)/(de[2][De]-Et);switch(isFinite(mt)||(mt=.5),isFinite(tt)||(tt=.5),isFinite(Ke)||(Ke=.5),he.reversedX&&(fe=Le-1-fe,Me=Le-1-Me),he.reversedY&&(ge=Te-1-ge,Se=Te-1-Se),he.reversedZ&&(ke=xe-1-ke,De=xe-1-De),he.filled){case 5:Ue=ke,Xe=De,Qe=ge*xe,Oe=Se*xe,Be=fe*xe*Te,We=Me*xe*Te;break;case 4:Ue=ke,Xe=De,Be=fe*xe,We=Me*xe,Qe=ge*xe*Le,Oe=Se*xe*Le;break;case 3:Qe=ge,Oe=Se,Ue=ke*Te,Xe=De*Te,Be=fe*Te*xe,We=Me*Te*xe;break;case 2:Qe=ge,Oe=Se,Be=fe*Te,We=Me*Te,Ue=ke*Te*Le,Xe=De*Te*Le;break;case 1:Be=fe,We=Me,Ue=ke*Le,Xe=De*Le,Qe=ge*Le*xe,Oe=Se*Le*xe;break;default:Be=fe,We=Me,Qe=ge*Le,Oe=Se*Le,Ue=ke*Le*Te,Xe=De*Le*Te}var Mt=se[Be+Qe+Ue],Jt=se[Be+Qe+Xe],$t=se[Be+Oe+Ue],je=se[Be+Oe+Xe],Ge=se[We+Qe+Ue],Ct=se[We+Qe+Xe],Ie=se[We+Oe+Ue],be=se[We+Oe+Xe],Ae=t.create(),Pe=t.create(),ze=t.create(),qe=t.create();t.lerp(Ae,Mt,Ge,mt),t.lerp(Pe,Jt,Ct,mt),t.lerp(ze,$t,Ie,mt),t.lerp(qe,je,be,mt);var ht=t.create(),at=t.create();t.lerp(ht,Ae,ze,tt),t.lerp(at,Pe,qe,tt);var nt=t.create();return t.lerp(nt,ht,at,Ke),nt}(ne,s,y)},T=s.getDivergence||function(ne,ae){var ie=t.create(),he=1e-4;t.add(ie,ne,[he,0,0]);var se=v(ie);t.subtract(se,se,ae),t.scale(se,se,1/he),t.add(ie,ne,[0,he,0]);var de=v(ie);t.subtract(de,de,ae),t.scale(de,de,1/he),t.add(ie,ne,[0,0,he]);var ce=v(ie);return t.subtract(ce,ce,ae),t.scale(ce,ce,1/he),t.add(ie,se,de),t.add(ie,ie,ce),ie},_=[],k=r[0][0],E=r[0][1],A=r[0][2],b=r[1][0],L=r[1][1],w=r[1][2],C=function(ne){var ae=ne[0],ie=ne[1],he=ne[2];return!(ae<k||ae>b||ie<E||ie>L||he<A||he>w)},S=10*t.distance(r[0],r[1])/f,P=S*S,z=1,F=0,q=c.length;q>1&&(z=function(ne){for(var ae=[],ie=[],he=[],se={},de={},ce={},ve=ne.length,Ee=0;Ee<ve;Ee++){var Le=ne[Ee],Te=Le[0],xe=Le[1],fe=Le[2];se[Te]||(ae.push(Te),se[Te]=!0),de[xe]||(ie.push(xe),de[xe]=!0),ce[fe]||(he.push(fe),ce[fe]=!0)}var ge=o(ae),ke=o(ie),Me=o(he),Se=Math.min(ge,ke,Me);return isFinite(Se)?Se:1}(c));for(var W=0;W<q;W++){var X=t.create();t.copy(X,c[W]);var Q=[X],Z=[],Y=v(X),N=X;Z.push(Y);var J=[],D=T(X,Y),U=t.length(D);isFinite(U)&&U>F&&(F=U),J.push(U),_.push({points:Q,velocities:Z,divergences:J});for(var G=0;G<100*f&&Q.length<f&&C(X);){G++;var $=t.clone(Y),K=t.squaredLength($);if(K===0)break;K>P&&t.scale($,$,S/Math.sqrt(K)),t.add($,$,X),Y=v($),t.squaredDistance(N,$)-P>-1e-4*P&&(Q.push($),N=$,Z.push(Y),D=T($,Y),U=t.length(D),isFinite(U)&&U>F&&(F=U),J.push(U)),X=$}}var re=u(_,s.colormap,F,z);return g?re.tubeScale=g:(F===0&&(F=1),re.tubeScale=.5*d*z/F),re};var a=i("./lib/shaders"),n=i("gl-cone3d").createMesh;B.exports.createTubeMesh=function(s,r){return n(s,r,{shaders:a,traceType:"streamtube"})}},{"./lib/shaders":350,"gl-cone3d":268,"gl-vec3":380,"gl-vec4":416}],353:[function(i,B,V){var t=i("gl-shader"),h=i("glslify"),p=h([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),u=h([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color — in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),e=h([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),l=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);V.createShader=function(o){var a=t(o,p,u,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a.attributes.normal.location=2,a},V.createPickShader=function(o){var a=t(o,p,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a.attributes.normal.location=2,a},V.createContourShader=function(o){var a=t(o,e,u,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a},V.createPickContourShader=function(o){var a=t(o,e,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a}},{"gl-shader":339,glslify:442}],354:[function(i,B,V){B.exports=function(Y){var N=Y.gl,J=m(N),D=v(N),U=y(N),G=T(N),$=h(N),K=p(N,[{buffer:$,size:4,stride:40,offset:0},{buffer:$,size:3,stride:40,offset:16},{buffer:$,size:3,stride:40,offset:28}]),re=h(N),ne=p(N,[{buffer:re,size:4,stride:20,offset:0},{buffer:re,size:1,stride:20,offset:16}]),ae=h(N),ie=p(N,[{buffer:ae,size:2,type:N.FLOAT}]),he=u(N,1,256,N.RGBA,N.UNSIGNED_BYTE);he.minFilter=N.LINEAR,he.magFilter=N.LINEAR;var se=new b(N,[0,0],[[0,0,0],[0,0,0]],J,D,$,K,he,U,G,re,ne,ae,ie,[0,0,0]),de={levels:[[],[],[]]};for(var ce in Y)de[ce]=Y[ce];return de.colormap=de.colormap||"jet",se.update(de),se};var t=i("bit-twiddle"),h=i("gl-buffer"),p=i("gl-vao"),u=i("gl-texture2d"),e=i("typedarray-pool"),l=i("colormap"),o=i("ndarray-ops"),a=i("ndarray-pack"),n=i("ndarray"),s=i("surface-nets"),r=i("gl-mat4/multiply"),c=i("gl-mat4/invert"),f=i("binary-search-bounds"),d=i("ndarray-gradient"),g=i("./lib/shaders"),m=g.createShader,y=g.createContourShader,v=g.createPickShader,T=g.createPickContourShader,_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],E=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function A(Y,N,J,D,U){this.position=Y,this.index=N,this.uv=J,this.level=D,this.dataCoordinate=U}(function(){for(var Y=0;Y<3;++Y){var N=E[Y],J=(Y+2)%3;N[(Y+1)%3+0]=1,N[J+3]=1,N[Y+6]=1}})();function b(Y,N,J,D,U,G,$,K,re,ne,ae,ie,he,se,de){this.gl=Y,this.shape=N,this.bounds=J,this.objectOffset=de,this.intensityBounds=[],this._shader=D,this._pickShader=U,this._coordinateBuffer=G,this._vao=$,this._colorMap=K,this._contourShader=re,this._contourPickShader=ne,this._contourBuffer=ae,this._contourVAO=ie,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new A([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=he,this._dynamicVAO=se,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[n(e.mallocFloat(1024),[0,0]),n(e.mallocFloat(1024),[0,0]),n(e.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var L=b.prototype;L.genColormap=function(Y,N){var J=!1,D=a([l({colormap:Y,nshades:256,format:"rgba"}).map(function(U,G){var $=N?function(K,re){if(!re||!re.length)return 1;for(var ne=0;ne<re.length;++ne){if(re.length<2)return 1;if(re[ne][0]===K)return re[ne][1];if(re[ne][0]>K&&ne>0){var ae=(re[ne][0]-K)/(re[ne][0]-re[ne-1][0]);return re[ne][1]*(1-ae)+ae*re[ne-1][1]}}return 1}(G/255,N):U[3];return $<1&&(J=!0),[U[0],U[1],U[2],255*$]})]);return o.divseq(D,255),this.hasAlphaScale=J,D},L.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},L.isOpaque=function(){return!this.isTransparent()},L.pickSlots=1,L.setPickBase=function(Y){this.pickId=Y};var w=[0,0,0],C={showSurface:!1,showContour:!1,projections:[_.slice(),_.slice(),_.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function S(Y,N){var J,D,U,G=N.axes&&N.axes.lastCubeProps.axis||w,$=N.showSurface,K=N.showContour;for(J=0;J<3;++J)for($=$||N.surfaceProject[J],D=0;D<3;++D)K=K||N.contourProject[J][D];for(J=0;J<3;++J){var re=C.projections[J];for(D=0;D<16;++D)re[D]=0;for(D=0;D<4;++D)re[5*D]=1;re[5*J]=0,re[12+J]=N.axesBounds[+(G[J]>0)][J],r(re,Y.model,re);var ne=C.clipBounds[J];for(U=0;U<2;++U)for(D=0;D<3;++D)ne[U][D]=Y.clipBounds[U][D];ne[0][J]=-1e8,ne[1][J]=1e8}return C.showSurface=$,C.showContour=K,C}var P={model:_,view:_,projection:_,inverseModel:_.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},z=_.slice(),F=[1,0,0,0,1,0,0,0,1];function q(Y,N){Y=Y||{};var J=this.gl;J.disable(J.CULL_FACE),this._colorMap.bind(0);var D=P;D.model=Y.model||_,D.view=Y.view||_,D.projection=Y.projection||_,D.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],D.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],D.objectOffset=this.objectOffset,D.contourColor=this.contourColor[0],D.inverseModel=c(D.inverseModel,D.model);for(var U=0;U<2;++U)for(var G=D.clipBounds[U],$=0;$<3;++$)G[$]=Math.min(Math.max(this.clipBounds[U][$],-1e8),1e8);D.kambient=this.ambientLight,D.kdiffuse=this.diffuseLight,D.kspecular=this.specularLight,D.roughness=this.roughness,D.fresnel=this.fresnel,D.opacity=this.opacity,D.height=0,D.permutation=F,D.vertexColor=this.vertexColor;var K=z;for(r(K,D.view,D.model),r(K,D.projection,K),c(K,K),U=0;U<3;++U)D.eyePosition[U]=K[12+U]/K[15];var re=K[15];for(U=0;U<3;++U)re+=this.lightPosition[U]*K[4*U+3];for(U=0;U<3;++U){var ne=K[12+U];for($=0;$<3;++$)ne+=K[4*$+U]*this.lightPosition[$];D.lightPosition[U]=ne/re}var ae=S(D,this);if(ae.showSurface){for(this._shader.bind(),this._shader.uniforms=D,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(J.TRIANGLES,this._vertexCount),U=0;U<3;++U)this.surfaceProject[U]&&this.vertexCount&&(this._shader.uniforms.model=ae.projections[U],this._shader.uniforms.clipBounds=ae.clipBounds[U],this._vao.draw(J.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ae.showContour){var ie=this._contourShader;D.kambient=1,D.kdiffuse=0,D.kspecular=0,D.opacity=1,ie.bind(),ie.uniforms=D;var he=this._contourVAO;for(he.bind(),U=0;U<3;++U)for(ie.uniforms.permutation=E[U],J.lineWidth(this.contourWidth[U]*this.pixelRatio),$=0;$<this.contourLevels[U].length;++$)$===this.highlightLevel[U]?(ie.uniforms.contourColor=this.highlightColor[U],ie.uniforms.contourTint=this.highlightTint[U]):$!==0&&$-1!==this.highlightLevel[U]||(ie.uniforms.contourColor=this.contourColor[U],ie.uniforms.contourTint=this.contourTint[U]),this._contourCounts[U][$]&&(ie.uniforms.height=this.contourLevels[U][$],he.draw(J.LINES,this._contourCounts[U][$],this._contourOffsets[U][$]));for(U=0;U<3;++U)for(ie.uniforms.model=ae.projections[U],ie.uniforms.clipBounds=ae.clipBounds[U],$=0;$<3;++$)if(this.contourProject[U][$]){ie.uniforms.permutation=E[$],J.lineWidth(this.contourWidth[$]*this.pixelRatio);for(var se=0;se<this.contourLevels[$].length;++se)se===this.highlightLevel[$]?(ie.uniforms.contourColor=this.highlightColor[$],ie.uniforms.contourTint=this.highlightTint[$]):se!==0&&se-1!==this.highlightLevel[$]||(ie.uniforms.contourColor=this.contourColor[$],ie.uniforms.contourTint=this.contourTint[$]),this._contourCounts[$][se]&&(ie.uniforms.height=this.contourLevels[$][se],he.draw(J.LINES,this._contourCounts[$][se],this._contourOffsets[$][se]))}for(he.unbind(),(he=this._dynamicVAO).bind(),U=0;U<3;++U)if(this._dynamicCounts[U]!==0)for(ie.uniforms.model=D.model,ie.uniforms.clipBounds=D.clipBounds,ie.uniforms.permutation=E[U],J.lineWidth(this.dynamicWidth[U]*this.pixelRatio),ie.uniforms.contourColor=this.dynamicColor[U],ie.uniforms.contourTint=this.dynamicTint[U],ie.uniforms.height=this.dynamicLevel[U],he.draw(J.LINES,this._dynamicCounts[U],this._dynamicOffsets[U]),$=0;$<3;++$)this.contourProject[$][U]&&(ie.uniforms.model=ae.projections[$],ie.uniforms.clipBounds=ae.clipBounds[$],he.draw(J.LINES,this._dynamicCounts[U],this._dynamicOffsets[U]));he.unbind()}}L.draw=function(Y){return q.call(this,Y,!1)},L.drawTransparent=function(Y){return q.call(this,Y,!0)};var W={model:_,view:_,projection:_,inverseModel:_,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function X(Y,N){return Array.isArray(Y)?[N(Y[0]),N(Y[1]),N(Y[2])]:[N(Y),N(Y),N(Y)]}function Q(Y){return Array.isArray(Y)?Y.length===3?[Y[0],Y[1],Y[2],1]:[Y[0],Y[1],Y[2],Y[3]]:[0,0,0,1]}function Z(Y){if(Array.isArray(Y)){if(Array.isArray(Y))return[Q(Y[0]),Q(Y[1]),Q(Y[2])];var N=Q(Y);return[N.slice(),N.slice(),N.slice()]}}L.drawPick=function(Y){Y=Y||{};var N=this.gl;N.disable(N.CULL_FACE);var J=W;J.model=Y.model||_,J.view=Y.view||_,J.projection=Y.projection||_,J.shape=this._field[2].shape,J.pickId=this.pickId/255,J.lowerBound=this.bounds[0],J.upperBound=this.bounds[1],J.objectOffset=this.objectOffset,J.permutation=F;for(var D=0;D<2;++D)for(var U=J.clipBounds[D],G=0;G<3;++G)U[G]=Math.min(Math.max(this.clipBounds[D][G],-1e8),1e8);var $=S(J,this);if($.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=J,this._vao.bind(),this._vao.draw(N.TRIANGLES,this._vertexCount),D=0;D<3;++D)this.surfaceProject[D]&&(this._pickShader.uniforms.model=$.projections[D],this._pickShader.uniforms.clipBounds=$.clipBounds[D],this._vao.draw(N.TRIANGLES,this._vertexCount));this._vao.unbind()}if($.showContour){var K=this._contourPickShader;K.bind(),K.uniforms=J;var re=this._contourVAO;for(re.bind(),G=0;G<3;++G)for(N.lineWidth(this.contourWidth[G]*this.pixelRatio),K.uniforms.permutation=E[G],D=0;D<this.contourLevels[G].length;++D)this._contourCounts[G][D]&&(K.uniforms.height=this.contourLevels[G][D],re.draw(N.LINES,this._contourCounts[G][D],this._contourOffsets[G][D]));for(D=0;D<3;++D)for(K.uniforms.model=$.projections[D],K.uniforms.clipBounds=$.clipBounds[D],G=0;G<3;++G)if(this.contourProject[D][G]){K.uniforms.permutation=E[G],N.lineWidth(this.contourWidth[G]*this.pixelRatio);for(var ne=0;ne<this.contourLevels[G].length;++ne)this._contourCounts[G][ne]&&(K.uniforms.height=this.contourLevels[G][ne],re.draw(N.LINES,this._contourCounts[G][ne],this._contourOffsets[G][ne]))}re.unbind()}},L.pick=function(Y){if(!Y||Y.id!==this.pickId)return null;var N=this._field[2].shape,J=this._pickResult,D=N[0]*(Y.value[0]+(Y.value[2]>>4)/16)/255,U=Math.floor(D),G=D-U,$=N[1]*(Y.value[1]+(15&Y.value[2])/16)/255,K=Math.floor($),re=$-K;U+=1,K+=1;var ne=J.position;ne[0]=ne[1]=ne[2]=0;for(var ae=0;ae<2;++ae)for(var ie=ae?G:1-G,he=0;he<2;++he)for(var se=U+ae,de=K+he,ce=ie*(he?re:1-re),ve=0;ve<3;++ve)ne[ve]+=this._field[ve].get(se,de)*ce;for(var Ee=this._pickResult.level,Le=0;Le<3;++Le)if(Ee[Le]=f.le(this.contourLevels[Le],ne[Le]),Ee[Le]<0)this.contourLevels[Le].length>0&&(Ee[Le]=0);else if(Ee[Le]<this.contourLevels[Le].length-1){var Te=this.contourLevels[Le][Ee[Le]],xe=this.contourLevels[Le][Ee[Le]+1];Math.abs(Te-ne[Le])>Math.abs(xe-ne[Le])&&(Ee[Le]+=1)}for(J.index[0]=G<.5?U:U+1,J.index[1]=re<.5?K:K+1,J.uv[0]=D/N[0],J.uv[1]=$/N[1],ve=0;ve<3;++ve)J.dataCoordinate[ve]=this._field[ve].get(J.index[0],J.index[1]);return J},L.padField=function(Y,N){var J=N.shape.slice(),D=Y.shape.slice();o.assign(Y.lo(1,1).hi(J[0],J[1]),N),o.assign(Y.lo(1).hi(J[0],1),N.hi(J[0],1)),o.assign(Y.lo(1,D[1]-1).hi(J[0],1),N.lo(0,J[1]-1).hi(J[0],1)),o.assign(Y.lo(0,1).hi(1,J[1]),N.hi(1)),o.assign(Y.lo(D[0]-1,1).hi(1,J[1]),N.lo(J[0]-1)),Y.set(0,0,N.get(0,0)),Y.set(0,D[1]-1,N.get(0,J[1]-1)),Y.set(D[0]-1,0,N.get(J[0]-1,0)),Y.set(D[0]-1,D[1]-1,N.get(J[0]-1,J[1]-1))},L.update=function(Y){Y=Y||{},this.objectOffset=Y.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in Y&&(this.contourWidth=X(Y.contourWidth,Number)),"showContour"in Y&&(this.showContour=X(Y.showContour,Boolean)),"showSurface"in Y&&(this.showSurface=!!Y.showSurface),"contourTint"in Y&&(this.contourTint=X(Y.contourTint,Boolean)),"contourColor"in Y&&(this.contourColor=Z(Y.contourColor)),"contourProject"in Y&&(this.contourProject=X(Y.contourProject,function(At){return X(At,Boolean)})),"surfaceProject"in Y&&(this.surfaceProject=Y.surfaceProject),"dynamicColor"in Y&&(this.dynamicColor=Z(Y.dynamicColor)),"dynamicTint"in Y&&(this.dynamicTint=X(Y.dynamicTint,Number)),"dynamicWidth"in Y&&(this.dynamicWidth=X(Y.dynamicWidth,Number)),"opacity"in Y&&(this.opacity=Y.opacity),"opacityscale"in Y&&(this.opacityscale=Y.opacityscale),"colorBounds"in Y&&(this.colorBounds=Y.colorBounds),"vertexColor"in Y&&(this.vertexColor=Y.vertexColor?1:0),"colormap"in Y&&this._colorMap.setPixels(this.genColormap(Y.colormap,this.opacityscale));var N=Y.field||Y.coords&&Y.coords[2]||null,J=!1;if(N||(N=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in Y||"coords"in Y){var D=(N.shape[0]+2)*(N.shape[1]+2);D>this._field[2].data.length&&(e.freeFloat(this._field[2].data),this._field[2].data=e.mallocFloat(t.nextPow2(D))),this._field[2]=n(this._field[2].data,[N.shape[0]+2,N.shape[1]+2]),this.padField(this._field[2],N),this.shape=N.shape.slice();for(var U=this.shape,G=0;G<2;++G)this._field[2].size>this._field[G].data.length&&(e.freeFloat(this._field[G].data),this._field[G].data=e.mallocFloat(this._field[2].size)),this._field[G]=n(this._field[G].data,[U[0]+2,U[1]+2]);if(Y.coords){var $=Y.coords;if(!Array.isArray($)||$.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(G=0;G<2;++G){var K=$[G];for(he=0;he<2;++he)if(K.shape[he]!==U[he])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[G],K)}}else if(Y.ticks){var re=Y.ticks;if(!Array.isArray(re)||re.length!==2)throw new Error("gl-surface: invalid ticks");for(G=0;G<2;++G){var ne=re[G];if((Array.isArray(ne)||ne.length)&&(ne=n(ne)),ne.shape[0]!==U[G])throw new Error("gl-surface: invalid tick length");var ae=n(ne.data,U);ae.stride[G]=ne.stride[0],ae.stride[1^G]=0,this.padField(this._field[G],ae)}}else{for(G=0;G<2;++G){var ie=[0,0];ie[G]=1,this._field[G]=n(this._field[G].data,[U[0]+2,U[1]+2],ie,0)}this._field[0].set(0,0,0);for(var he=0;he<U[0];++he)this._field[0].set(he+1,0,he);for(this._field[0].set(U[0]+1,0,U[0]-1),this._field[1].set(0,0,0),he=0;he<U[1];++he)this._field[1].set(0,he+1,he);this._field[1].set(0,U[1]+1,U[1]-1)}var se=this._field,de=n(e.mallocFloat(3*se[2].size*2),[3,U[0]+2,U[1]+2,2]);for(G=0;G<3;++G)d(de.pick(G),se[G],"mirror");var ce=n(e.mallocFloat(3*se[2].size),[U[0]+2,U[1]+2,3]);for(G=0;G<U[0]+2;++G)for(he=0;he<U[1]+2;++he){var ve=de.get(0,G,he,0),Ee=de.get(0,G,he,1),Le=de.get(1,G,he,0),Te=de.get(1,G,he,1),xe=de.get(2,G,he,0),fe=de.get(2,G,he,1),ge=Le*fe-Te*xe,ke=xe*Ee-fe*ve,Me=ve*Te-Ee*Le,Se=Math.sqrt(ge*ge+ke*ke+Me*Me);Se<1e-8?(Se=Math.max(Math.abs(ge),Math.abs(ke),Math.abs(Me)))<1e-8?(Me=1,ke=ge=0,Se=1):Se=1/Se:Se=1/Math.sqrt(Se),ce.set(G,he,0,ge*Se),ce.set(G,he,1,ke*Se),ce.set(G,he,2,Me*Se)}e.free(de.data);var De=[1/0,1/0,1/0],Be=[-1/0,-1/0,-1/0],We=1/0,Qe=-1/0,Oe=(U[0]-1)*(U[1]-1)*6,Ue=e.mallocFloat(t.nextPow2(10*Oe)),Xe=0,Ye=0;for(G=0;G<U[0]-1;++G)e:for(he=0;he<U[1]-1;++he){for(var $e=0;$e<2;++$e)for(var it=0;it<2;++it)for(var ot=0;ot<3;++ot){var Et=this._field[ot].get(1+G+$e,1+he+it);if(isNaN(Et)||!isFinite(Et))continue e}for(ot=0;ot<6;++ot){var mt=G+k[ot][0],tt=he+k[ot][1],Ke=this._field[0].get(mt+1,tt+1),Mt=this._field[1].get(mt+1,tt+1);Et=this._field[2].get(mt+1,tt+1),ge=ce.get(mt+1,tt+1,0),ke=ce.get(mt+1,tt+1,1),Me=ce.get(mt+1,tt+1,2),Y.intensity&&(Jt=Y.intensity.get(mt,tt));var Jt=Y.intensity?Y.intensity.get(mt,tt):Et+this.objectOffset[2];Ue[Xe++]=mt,Ue[Xe++]=tt,Ue[Xe++]=Ke,Ue[Xe++]=Mt,Ue[Xe++]=Et,Ue[Xe++]=0,Ue[Xe++]=Jt,Ue[Xe++]=ge,Ue[Xe++]=ke,Ue[Xe++]=Me,De[0]=Math.min(De[0],Ke+this.objectOffset[0]),De[1]=Math.min(De[1],Mt+this.objectOffset[1]),De[2]=Math.min(De[2],Et+this.objectOffset[2]),We=Math.min(We,Jt),Be[0]=Math.max(Be[0],Ke+this.objectOffset[0]),Be[1]=Math.max(Be[1],Mt+this.objectOffset[1]),Be[2]=Math.max(Be[2],Et+this.objectOffset[2]),Qe=Math.max(Qe,Jt),Ye+=1}}for(Y.intensityBounds&&(We=+Y.intensityBounds[0],Qe=+Y.intensityBounds[1]),G=6;G<Xe;G+=10)Ue[G]=(Ue[G]-We)/(Qe-We);this._vertexCount=Ye,this._coordinateBuffer.update(Ue.subarray(0,Xe)),e.freeFloat(Ue),e.free(ce.data),this.bounds=[De,Be],this.intensity=Y.intensity||this._field[2],this.intensityBounds[0]===We&&this.intensityBounds[1]===Qe||(J=!0),this.intensityBounds=[We,Qe]}if("levels"in Y){var $t=Y.levels;for($t=Array.isArray($t[0])?$t.slice():[[],[],$t],G=0;G<3;++G)$t[G]=$t[G].slice(),$t[G].sort(function(At,Bt){return At-Bt});for(G=0;G<3;++G)for(he=0;he<$t[G].length;++he)$t[G][he]-=this.objectOffset[G];e:for(G=0;G<3;++G){if($t[G].length!==this.contourLevels[G].length){J=!0;break}for(he=0;he<$t[G].length;++he)if($t[G][he]!==this.contourLevels[G][he]){J=!0;break e}}this.contourLevels=$t}if(J){se=this._field,U=this.shape;for(var je=[],Ge=0;Ge<3;++Ge){var Ct=this.contourLevels[Ge],Ie=[],be=[],Ae=[0,0,0];for(G=0;G<Ct.length;++G){var Pe=s(this._field[Ge],Ct[G]);Ie.push(je.length/5|0),Ye=0;e:for(he=0;he<Pe.cells.length;++he){var ze=Pe.cells[he];for(ot=0;ot<2;++ot){var qe=Pe.positions[ze[ot]],ht=qe[0],at=0|Math.floor(ht),nt=ht-at,xt=qe[1],Lt=0|Math.floor(xt),bt=xt-Lt,St=!1;t:for(var st=0;st<3;++st){Ae[st]=0;var It=(Ge+st+1)%3;for($e=0;$e<2;++$e){var jt=$e?nt:1-nt;for(mt=0|Math.min(Math.max(at+$e,0),U[0]),it=0;it<2;++it){var Ut=it?bt:1-bt;if(tt=0|Math.min(Math.max(Lt+it,0),U[1]),Et=st<2?this._field[It].get(mt,tt):(this.intensity.get(mt,tt)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(Et)||isNaN(Et)){St=!0;break t}var zt=jt*Ut;Ae[st]+=zt*Et}}}if(St){if(ot>0){for(var Ce=0;Ce<5;++Ce)je.pop();Ye-=1}continue e}je.push(Ae[0],Ae[1],qe[0],qe[1],Ae[2]),Ye+=1}}be.push(Ye)}this._contourOffsets[Ge]=Ie,this._contourCounts[Ge]=be}var lt=e.mallocFloat(je.length);for(G=0;G<je.length;++G)lt[G]=je[G];this._contourBuffer.update(lt),e.freeFloat(lt)}},L.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var Y=0;Y<3;++Y)e.freeFloat(this._field[Y].data)},L.highlight=function(Y){var N,J;if(!Y)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(N=0;N<3;++N)this.enableHighlight[N]?this.highlightLevel[N]=Y.level[N]:this.highlightLevel[N]=-1;for(J=this.snapToData?Y.dataCoordinate:Y.position,N=0;N<3;++N)J[N]-=this.objectOffset[N];if(this.enableDynamic[0]&&J[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&J[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&J[2]!==this.dynamicLevel[2]){for(var D=0,U=this.shape,G=e.mallocFloat(12*U[0]*U[1]),$=0;$<3;++$)if(this.enableDynamic[$]){this.dynamicLevel[$]=J[$];var K=($+1)%3,re=($+2)%3,ne=this._field[$],ae=this._field[K],ie=this._field[re],he=s(ne,J[$]),se=he.cells,de=he.positions;for(this._dynamicOffsets[$]=D,N=0;N<se.length;++N)for(var ce=se[N],ve=0;ve<2;++ve){var Ee=de[ce[ve]],Le=+Ee[0],Te=0|Le,xe=0|Math.min(Te+1,U[0]),fe=Le-Te,ge=1-fe,ke=+Ee[1],Me=0|ke,Se=0|Math.min(Me+1,U[1]),De=ke-Me,Be=1-De,We=ge*Be,Qe=ge*De,Oe=fe*Be,Ue=fe*De,Xe=We*ae.get(Te,Me)+Qe*ae.get(Te,Se)+Oe*ae.get(xe,Me)+Ue*ae.get(xe,Se),Ye=We*ie.get(Te,Me)+Qe*ie.get(Te,Se)+Oe*ie.get(xe,Me)+Ue*ie.get(xe,Se);if(isNaN(Xe)||isNaN(Ye)){ve&&(D-=1);break}G[2*D+0]=Xe,G[2*D+1]=Ye,D+=1}this._dynamicCounts[$]=D-this._dynamicOffsets[$]}else this.dynamicLevel[$]=NaN,this._dynamicCounts[$]=0;this._dynamicBuffer.update(G.subarray(0,2*D)),e.freeFloat(G)}}},{"./lib/shaders":353,"binary-search-bounds":103,"bit-twiddle":104,colormap:137,"gl-buffer":267,"gl-mat4/invert":299,"gl-mat4/multiply":301,"gl-texture2d":356,"gl-vao":361,ndarray:483,"ndarray-gradient":476,"ndarray-ops":478,"ndarray-pack":479,"surface-nets":591,"typedarray-pool":617}],355:[function(i,B,V){var t=i("css-font"),h=i("pick-by-alias"),p=i("regl"),u=i("gl-util/context"),e=i("es6-weak-map"),l=i("color-normalize"),o=i("font-atlas"),a=i("typedarray-pool"),n=i("parse-rect"),s=i("is-plain-obj"),r=i("parse-unit"),c=i("to-px"),f=i("detect-kerning"),d=i("object-assign"),g=i("font-measure"),m=i("flatten-vertex-data"),y=i("bit-twiddle").nextPow2,v=new e,T=!1;if(document.body){var _=document.body.appendChild(document.createElement("div"));_.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(_).fontStretch&&(T=!0),document.body.removeChild(_)}var k=function(E){(function(A){return typeof A=="function"&&A._gl&&A.prop&&A.texture&&A.buffer})(E)?(E={regl:E},this.gl=E.regl._gl):this.gl=u(E),this.shader=v.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=E.regl||p({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),v.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(s(E)?E:{})};k.prototype.createShader=function(){var E=this.regl,A=E({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:E.prop("count"),offset:E.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:E.this("sizeBuffer")},width:{offset:0,stride:8,buffer:E.this("sizeBuffer")},char:E.this("charBuffer"),position:E.this("position")},uniforms:{atlasSize:function(b,L){return[L.atlas.width,L.atlas.height]},atlasDim:function(b,L){return[L.atlas.cols,L.atlas.rows]},atlas:function(b,L){return L.atlas.texture},charStep:function(b,L){return L.atlas.step},em:function(b,L){return L.atlas.em},color:E.prop("color"),opacity:E.prop("opacity"),viewport:E.this("viewportArray"),scale:E.this("scale"),align:E.prop("align"),baseline:E.prop("baseline"),translate:E.this("translate"),positionOffset:E.prop("positionOffset")},primitive:"points",viewport:E.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				`+(k.normalViewport?"":"vec2 positionOffset = vec2(positionOffset.x,- positionOffset.y);")+`

				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ positionOffset))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				`+(k.normalViewport?"position.y = 1. - position.y;":"")+`

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform sampler2D atlas;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`});return{regl:E,draw:A,atlas:{}}},k.prototype.update=function(E){var A=this;if(typeof E=="string")E={text:E};else if(!E)return;(E=h(E,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity!=null&&(Array.isArray(E.opacity)?this.opacity=E.opacity.map(function(ge){return parseFloat(ge)}):this.opacity=parseFloat(E.opacity)),E.viewport!=null&&(this.viewport=n(E.viewport),k.normalViewport&&(this.viewport.y=this.canvas.height-this.viewport.y-this.viewport.height),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),E.kerning!=null&&(this.kerning=E.kerning),E.offset!=null&&(typeof E.offset=="number"&&(E.offset=[E.offset,0]),this.positionOffset=m(E.offset)),E.direction&&(this.direction=E.direction),E.range&&(this.range=E.range,this.scale=[1/(E.range[2]-E.range[0]),1/(E.range[3]-E.range[1])],this.translate=[-E.range[0],-E.range[1]]),E.scale&&(this.scale=E.scale),E.translate&&(this.translate=E.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||E.font||(E.font=k.baseFontSize+"px sans-serif");var b,L=!1,w=!1;if(E.font&&(Array.isArray(E.font)?E.font:[E.font]).forEach(function(ge,ke){if(typeof ge=="string")try{ge=t.parse(ge)}catch{ge=t.parse(k.baseFontSize+"px "+ge)}else ge=t.parse(t.stringify(ge));var Me=t.stringify({size:k.baseFontSize,family:ge.family,stretch:T?ge.stretch:void 0,variant:ge.variant,weight:ge.weight,style:ge.style}),Se=r(ge.size),De=Math.round(Se[0]*c(Se[1]));if(De!==A.fontSize[ke]&&(w=!0,A.fontSize[ke]=De),!(A.font[ke]&&Me==A.font[ke].baseString||(L=!0,A.font[ke]=k.fonts[Me],A.font[ke]))){var Be=ge.family.join(", "),We=[ge.style];ge.style!=ge.variant&&We.push(ge.variant),ge.variant!=ge.weight&&We.push(ge.weight),T&&ge.weight!=ge.stretch&&We.push(ge.stretch),A.font[ke]={baseString:Me,family:Be,weight:ge.weight,stretch:ge.stretch,style:ge.style,variant:ge.variant,width:{},kerning:{},metrics:g(Be,{origin:"top",fontSize:k.baseFontSize,fontStyle:We.join(" ")})},k.fonts[Me]=A.font[ke]}}),(L||w)&&this.font.forEach(function(ge,ke){var Me=t.stringify({size:A.fontSize[ke],family:ge.family,stretch:T?ge.stretch:void 0,variant:ge.variant,weight:ge.weight,style:ge.style});if(A.fontAtlas[ke]=A.shader.atlas[Me],!A.fontAtlas[ke]){var Se=ge.metrics;A.shader.atlas[Me]=A.fontAtlas[ke]={fontString:Me,step:2*Math.ceil(A.fontSize[ke]*Se.bottom*.5),em:A.fontSize[ke],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:A.regl.texture()}}E.text==null&&(E.text=A.text)}),typeof E.text=="string"&&E.position&&E.position.length>2){for(var C=Array(.5*E.position.length),S=0;S<C.length;S++)C[S]=E.text;E.text=C}if(E.text!=null||L){if(this.textOffsets=[0],Array.isArray(E.text)){this.count=E.text[0].length,this.counts=[this.count];for(var P=1;P<E.text.length;P++)this.textOffsets[P]=this.textOffsets[P-1]+E.text[P-1].length,this.count+=E.text[P].length,this.counts.push(E.text[P].length);this.text=E.text.join("")}else this.text=E.text,this.count=this.text.length,this.counts=[this.count];b=[],this.font.forEach(function(ge,ke){k.atlasContext.font=ge.baseString;for(var Me=A.fontAtlas[ke],Se=0;Se<A.text.length;Se++){var De=A.text.charAt(Se);if(Me.ids[De]==null&&(Me.ids[De]=Me.chars.length,Me.chars.push(De),b.push(De)),ge.width[De]==null&&(ge.width[De]=k.atlasContext.measureText(De).width/k.baseFontSize,A.kerning)){var Be=[];for(var We in ge.width)Be.push(We+De,De+We);d(ge.kerning,f(ge.family,{pairs:Be}))}}})}if(E.position)if(E.position.length>2){for(var z=!E.position[0].length,F=a.mallocFloat(2*this.count),q=0,W=0;q<this.counts.length;q++){var X=this.counts[q];if(z)for(var Q=0;Q<X;Q++)F[W++]=E.position[2*q],F[W++]=E.position[2*q+1];else for(var Z=0;Z<X;Z++)F[W++]=E.position[q][0],F[W++]=E.position[q][1]}this.position.call?this.position({type:"float",data:F}):this.position=this.regl.buffer({type:"float",data:F}),a.freeFloat(F)}else this.position.destroy&&this.position.destroy(),this.position={constant:E.position};if(E.text||L){var Y=a.mallocUint8(this.count),N=a.mallocFloat(2*this.count);this.textWidth=[];for(var J=0,D=0;J<this.counts.length;J++){for(var U=this.counts[J],G=this.font[J]||this.font[0],$=this.fontAtlas[J]||this.fontAtlas[0],K=0;K<U;K++){var re=this.text.charAt(D),ne=this.text.charAt(D-1);if(Y[D]=$.ids[re],N[2*D]=G.width[re],K){var ae=N[2*D-2],ie=N[2*D],he=N[2*D-1]+.5*ae+.5*ie;if(this.kerning){var se=G.kerning[ne+re];se&&(he+=.001*se)}N[2*D+1]=he}else N[2*D+1]=.5*N[2*D];D++}this.textWidth.push(N.length?.5*N[2*D-2]+N[2*D-1]:0)}E.align||(E.align=this.align),this.charBuffer({data:Y,type:"uint8",usage:"stream"}),this.sizeBuffer({data:N,type:"float",usage:"stream"}),a.freeUint8(Y),a.freeFloat(N),b.length&&this.font.forEach(function(ge,ke){var Me=A.fontAtlas[ke],Se=Me.step,De=Math.floor(k.maxAtlasSize/Se),Be=Math.min(De,Me.chars.length),We=Math.ceil(Me.chars.length/Be),Qe=y(Be*Se),Oe=y(We*Se);Me.width=Qe,Me.height=Oe,Me.rows=We,Me.cols=Be,Me.em&&Me.texture({data:o({canvas:k.atlasCanvas,font:Me.fontString,chars:Me.chars,shape:[Qe,Oe],step:[Se,Se]})})})}if(E.align&&(this.align=E.align,this.alignOffset=this.textWidth.map(function(ge,ke){var Me=Array.isArray(A.align)?A.align.length>1?A.align[ke]:A.align[0]:A.align;if(typeof Me=="number")return Me;switch(Me){case"right":case"end":return-ge;case"center":case"centre":case"middle":return .5*-ge}return 0})),this.baseline==null&&E.baseline==null&&(E.baseline=0),E.baseline!=null&&(this.baseline=E.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(ge,ke){var Me=(A.font[ke]||A.font[0]).metrics,Se=0;return Se+=.5*Me.bottom,Se+=typeof ge=="number"?ge-Me.baseline:-Me[ge],k.normalViewport||(Se*=-1),Se})),E.color!=null)if(E.color||(E.color="transparent"),typeof E.color!="string"&&isNaN(E.color)){var de;if(typeof E.color[0]=="number"&&E.color.length>this.counts.length){var ce=E.color.length;de=a.mallocUint8(ce);for(var ve=(E.color.subarray||E.color.slice).bind(E.color),Ee=0;Ee<ce;Ee+=4)de.set(l(ve(Ee,Ee+4),"uint8"),Ee)}else{var Le=E.color.length;de=a.mallocUint8(4*Le);for(var Te=0;Te<Le;Te++)de.set(l(E.color[Te]||0,"uint8"),4*Te)}this.color=de}else this.color=l(E.color,"uint8");if(E.position||E.text||E.color||E.baseline||E.align||E.font||E.offset||E.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var xe=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(xe);for(var fe=0;fe<this.batch.length;fe++)this.batch[fe]={count:this.counts.length>1?this.counts[fe]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[fe]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*fe,4*fe+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[fe]:this.opacity,baseline:this.baselineOffset[fe]!=null?this.baselineOffset[fe]:this.baselineOffset[0],align:this.align?this.alignOffset[fe]!=null?this.alignOffset[fe]:this.alignOffset[0]:0,atlas:this.fontAtlas[fe]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*fe,2*fe+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},k.prototype.destroy=function(){},k.prototype.kerning=!0,k.prototype.position={constant:new Float32Array(2)},k.prototype.translate=null,k.prototype.scale=null,k.prototype.font=null,k.prototype.text="",k.prototype.positionOffset=[0,0],k.prototype.opacity=1,k.prototype.color=new Uint8Array([0,0,0,255]),k.prototype.alignOffset=[0,0],k.normalViewport=!1,k.maxAtlasSize=1024,k.atlasCanvas=document.createElement("canvas"),k.atlasContext=k.atlasCanvas.getContext("2d",{alpha:!1}),k.baseFontSize=64,k.fonts={},B.exports=k},{"bit-twiddle":104,"color-normalize":131,"css-font":150,"detect-kerning":181,"es6-weak-map":241,"flatten-vertex-data":252,"font-atlas":253,"font-measure":254,"gl-util/context":357,"is-plain-obj":457,"object-assign":487,"parse-rect":492,"parse-unit":494,"pick-by-alias":498,regl:540,"to-px":600,"typedarray-pool":617}],356:[function(i,B,V){var t=i("ndarray"),h=i("ndarray-ops"),p=i("typedarray-pool");B.exports=function(v){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(u||o(v),typeof arguments[1]=="number")return g(v,arguments[1],arguments[2],arguments[3]||v.RGBA,arguments[4]||v.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return g(v,0|arguments[1][0],0|arguments[1][1],arguments[2]||v.RGBA,arguments[3]||v.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var T=arguments[1],_=a(T)?T:T.raw;if(_)return m(v,_,0|T.width,0|T.height,arguments[2]||v.RGBA,arguments[3]||v.UNSIGNED_BYTE);if(T.shape&&T.data&&T.stride)return y(v,T)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var u=null,e=null,l=null;function o(v){u=[v.LINEAR,v.NEAREST_MIPMAP_LINEAR,v.LINEAR_MIPMAP_NEAREST,v.LINEAR_MIPMAP_NEAREST],e=[v.NEAREST,v.LINEAR,v.NEAREST_MIPMAP_NEAREST,v.NEAREST_MIPMAP_LINEAR,v.LINEAR_MIPMAP_NEAREST,v.LINEAR_MIPMAP_LINEAR],l=[v.REPEAT,v.CLAMP_TO_EDGE,v.MIRRORED_REPEAT]}function a(v){return typeof HTMLCanvasElement<"u"&&v instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&v instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&v instanceof HTMLVideoElement||typeof ImageData<"u"&&v instanceof ImageData}var n=function(v,T){h.muls(v,T,255)};function s(v,T,_){var k=v.gl,E=k.getParameter(k.MAX_TEXTURE_SIZE);if(T<0||T>E||_<0||_>E)throw new Error("gl-texture2d: Invalid texture size");return v._shape=[T,_],v.bind(),k.texImage2D(k.TEXTURE_2D,0,v.format,T,_,0,v.format,v.type,null),v._mipLevels=[0],v}function r(v,T,_,k,E,A){this.gl=v,this.handle=T,this.format=E,this.type=A,this._shape=[_,k],this._mipLevels=[0],this._magFilter=v.NEAREST,this._minFilter=v.NEAREST,this._wrapS=v.CLAMP_TO_EDGE,this._wrapT=v.CLAMP_TO_EDGE,this._anisoSamples=1;var b=this,L=[this._wrapS,this._wrapT];Object.defineProperties(L,[{get:function(){return b._wrapS},set:function(C){return b.wrapS=C}},{get:function(){return b._wrapT},set:function(C){return b.wrapT=C}}]),this._wrapVector=L;var w=[this._shape[0],this._shape[1]];Object.defineProperties(w,[{get:function(){return b._shape[0]},set:function(C){return b.width=C}},{get:function(){return b._shape[1]},set:function(C){return b.height=C}}]),this._shapeVector=w}var c=r.prototype;function f(v,T){return v.length===3?T[2]===1&&T[1]===v[0]*v[2]&&T[0]===v[2]:T[0]===1&&T[1]===v[0]}function d(v){var T=v.createTexture();return v.bindTexture(v.TEXTURE_2D,T),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),T}function g(v,T,_,k,E){var A=v.getParameter(v.MAX_TEXTURE_SIZE);if(T<0||T>A||_<0||_>A)throw new Error("gl-texture2d: Invalid texture shape");if(E===v.FLOAT&&!v.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var b=d(v);return v.texImage2D(v.TEXTURE_2D,0,k,T,_,0,k,E,null),new r(v,b,T,_,k,E)}function m(v,T,_,k,E,A){var b=d(v);return v.texImage2D(v.TEXTURE_2D,0,E,E,A,T),new r(v,b,_,k,E,A)}function y(v,T){var _=T.dtype,k=T.shape.slice(),E=v.getParameter(v.MAX_TEXTURE_SIZE);if(k[0]<0||k[0]>E||k[1]<0||k[1]>E)throw new Error("gl-texture2d: Invalid texture size");var A=f(k,T.stride.slice()),b=0;_==="float32"?b=v.FLOAT:_==="float64"?(b=v.FLOAT,A=!1,_="float32"):_==="uint8"?b=v.UNSIGNED_BYTE:(b=v.UNSIGNED_BYTE,A=!1,_="uint8");var L,w,C=0;if(k.length===2)C=v.LUMINANCE,k=[k[0],k[1],1],T=t(T.data,k,[T.stride[0],T.stride[1],1],T.offset);else{if(k.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(k[2]===1)C=v.ALPHA;else if(k[2]===2)C=v.LUMINANCE_ALPHA;else if(k[2]===3)C=v.RGB;else{if(k[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");C=v.RGBA}}b!==v.FLOAT||v.getExtension("OES_texture_float")||(b=v.UNSIGNED_BYTE,A=!1);var S=T.size;if(A)L=T.offset===0&&T.data.length===S?T.data:T.data.subarray(T.offset,T.offset+S);else{var P=[k[2],k[2]*k[0],1];w=p.malloc(S,_);var z=t(w,k,P,0);_!=="float32"&&_!=="float64"||b!==v.UNSIGNED_BYTE?h.assign(z,T):n(z,T),L=w.subarray(0,S)}var F=d(v);return v.texImage2D(v.TEXTURE_2D,0,C,k[0],k[1],0,C,b,L),A||p.free(w),new r(v,F,k[0],k[1],C,b)}Object.defineProperties(c,{minFilter:{get:function(){return this._minFilter},set:function(v){this.bind();var T=this.gl;if(this.type===T.FLOAT&&u.indexOf(v)>=0&&(T.getExtension("OES_texture_float_linear")||(v=T.NEAREST)),e.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,v),this._minFilter=v}},magFilter:{get:function(){return this._magFilter},set:function(v){this.bind();var T=this.gl;if(this.type===T.FLOAT&&u.indexOf(v)>=0&&(T.getExtension("OES_texture_float_linear")||(v=T.NEAREST)),e.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,v),this._magFilter=v}},mipSamples:{get:function(){return this._anisoSamples},set:function(v){var T=this._anisoSamples;if(this._anisoSamples=0|Math.max(v,1),T!==this._anisoSamples){var _=this.gl.getExtension("EXT_texture_filter_anisotropic");_&&this.gl.texParameterf(this.gl.TEXTURE_2D,_.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(v){if(this.bind(),l.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,v),this._wrapS=v}},wrapT:{get:function(){return this._wrapT},set:function(v){if(this.bind(),l.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,v),this._wrapT=v}},wrap:{get:function(){return this._wrapVector},set:function(v){if(Array.isArray(v)||(v=[v,v]),v.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var T=0;T<2;++T)if(l.indexOf(v[T])<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);this._wrapS=v[0],this._wrapT=v[1];var _=this.gl;return this.bind(),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,this._wrapS),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,this._wrapT),v}},shape:{get:function(){return this._shapeVector},set:function(v){if(Array.isArray(v)){if(v.length!==2)throw new Error("gl-texture2d: Invalid texture shape")}else v=[0|v,0|v];return s(this,0|v[0],0|v[1]),[0|v[0],0|v[1]]}},width:{get:function(){return this._shape[0]},set:function(v){return s(this,v|=0,this._shape[1]),v}},height:{get:function(){return this._shape[1]},set:function(v){return v|=0,s(this,this._shape[0],v),v}}}),c.bind=function(v){var T=this.gl;return v!==void 0&&T.activeTexture(T.TEXTURE0+(0|v)),T.bindTexture(T.TEXTURE_2D,this.handle),v!==void 0?0|v:T.getParameter(T.ACTIVE_TEXTURE)-T.TEXTURE0},c.dispose=function(){this.gl.deleteTexture(this.handle)},c.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var v=Math.min(this._shape[0],this._shape[1]),T=0;v>0;++T,v>>>=1)this._mipLevels.indexOf(T)<0&&this._mipLevels.push(T)},c.setPixels=function(v,T,_,k){var E=this.gl;this.bind(),Array.isArray(T)?(k=_,_=0|T[1],T=0|T[0]):(T=T||0,_=_||0),k=k||0;var A=a(v)?v:v.raw;if(A)this._mipLevels.indexOf(k)<0?(E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,this.type,A),this._mipLevels.push(k)):E.texSubImage2D(E.TEXTURE_2D,k,T,_,this.format,this.type,A);else{if(!(v.shape&&v.stride&&v.data))throw new Error("gl-texture2d: Unsupported data type");if(v.shape.length<2||T+v.shape[1]>this._shape[1]>>>k||_+v.shape[0]>this._shape[0]>>>k||T<0||_<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");(function(b,L,w,C,S,P,z,F){var q=F.dtype,W=F.shape.slice();if(W.length<2||W.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var X=0,Q=0,Z=f(W,F.stride.slice());if(q==="float32"?X=b.FLOAT:q==="float64"?(X=b.FLOAT,Z=!1,q="float32"):q==="uint8"?X=b.UNSIGNED_BYTE:(X=b.UNSIGNED_BYTE,Z=!1,q="uint8"),W.length===2)Q=b.LUMINANCE,W=[W[0],W[1],1],F=t(F.data,W,[F.stride[0],F.stride[1],1],F.offset);else{if(W.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(W[2]===1)Q=b.ALPHA;else if(W[2]===2)Q=b.LUMINANCE_ALPHA;else if(W[2]===3)Q=b.RGB;else{if(W[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");Q=b.RGBA}W[2]}if(Q!==b.LUMINANCE&&Q!==b.ALPHA||S!==b.LUMINANCE&&S!==b.ALPHA||(Q=S),Q!==S)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var Y=F.size,N=z.indexOf(C)<0;if(N&&z.push(C),X===P&&Z)F.offset===0&&F.data.length===Y?N?b.texImage2D(b.TEXTURE_2D,C,S,W[0],W[1],0,S,P,F.data):b.texSubImage2D(b.TEXTURE_2D,C,L,w,W[0],W[1],S,P,F.data):N?b.texImage2D(b.TEXTURE_2D,C,S,W[0],W[1],0,S,P,F.data.subarray(F.offset,F.offset+Y)):b.texSubImage2D(b.TEXTURE_2D,C,L,w,W[0],W[1],S,P,F.data.subarray(F.offset,F.offset+Y));else{var J;J=P===b.FLOAT?p.mallocFloat32(Y):p.mallocUint8(Y);var D=t(J,W,[W[2],W[2]*W[0],1]);X===b.FLOAT&&P===b.UNSIGNED_BYTE?n(D,F):h.assign(D,F),N?b.texImage2D(b.TEXTURE_2D,C,S,W[0],W[1],0,S,P,J.subarray(0,Y)):b.texSubImage2D(b.TEXTURE_2D,C,L,w,W[0],W[1],S,P,J.subarray(0,Y)),P===b.FLOAT?p.freeFloat32(J):p.freeUint8(J)}})(E,T,_,k,this.format,this.type,this._mipLevels,v)}}},{ndarray:483,"ndarray-ops":478,"typedarray-pool":617}],357:[function(i,B,V){(function(t){(function(){var h=i("pick-by-alias");function p(l){if(l.container)if(l.container==document.body)document.body.style.width||(l.canvas.width=l.width||l.pixelRatio*t.innerWidth),document.body.style.height||(l.canvas.height=l.height||l.pixelRatio*t.innerHeight);else{var o=l.container.getBoundingClientRect();l.canvas.width=l.width||o.right-o.left,l.canvas.height=l.height||o.bottom-o.top}}function u(l){return typeof l.getContext=="function"&&"width"in l&&"height"in l}function e(){var l=document.createElement("canvas");return l.style.position="absolute",l.style.top=0,l.style.left=0,l}B.exports=function(l){var o;if(l?typeof l=="string"&&(l={container:l}):l={},u(l)?l={container:l}:l=typeof(o=l).nodeName=="string"&&typeof o.appendChild=="function"&&typeof o.getBoundingClientRect=="function"?{container:l}:function(n){return typeof n.drawArrays=="function"||typeof n.drawElements=="function"}(l)?{gl:l}:h(l,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),l.pixelRatio||(l.pixelRatio=t.pixelRatio||1),l.gl)return l.gl;if(l.canvas&&(l.container=l.canvas.parentNode),l.container){if(typeof l.container=="string"){var a=document.querySelector(l.container);if(!a)throw Error("Element "+l.container+" is not found");l.container=a}u(l.container)?(l.canvas=l.container,l.container=l.canvas.parentNode):l.canvas||(l.canvas=e(),l.container.appendChild(l.canvas),p(l))}else if(!l.canvas){if(typeof document>"u")throw Error("Not DOM environment. Use headless-gl.");l.container=document.body||document.documentElement,l.canvas=e(),l.container.appendChild(l.canvas),p(l)}if(!l.gl)try{l.gl=l.canvas.getContext("webgl",l.attrs)}catch{try{l.gl=l.canvas.getContext("experimental-webgl",l.attrs)}catch{l.gl=l.canvas.getContext("webgl-experimental",l.attrs)}}return l.gl}}).call(this)}).call(this,typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":498}],358:[function(i,B,V){B.exports=function(t,h,p){h?h.bind():t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null);var u=0|t.getParameter(t.MAX_VERTEX_ATTRIBS);if(p){if(p.length>u)throw new Error("gl-vao: Too many vertex attributes");for(var e=0;e<p.length;++e){var l=p[e];if(l.buffer){var o=l.buffer,a=l.size||4,n=l.type||t.FLOAT,s=!!l.normalized,r=l.stride||0,c=l.offset||0;o.bind(),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,a,n,s,r,c)}else{if(typeof l=="number")t.vertexAttrib1f(e,l);else if(l.length===1)t.vertexAttrib1f(e,l[0]);else if(l.length===2)t.vertexAttrib2f(e,l[0],l[1]);else if(l.length===3)t.vertexAttrib3f(e,l[0],l[1],l[2]);else{if(l.length!==4)throw new Error("gl-vao: Invalid vertex attribute");t.vertexAttrib4f(e,l[0],l[1],l[2],l[3])}t.disableVertexAttribArray(e)}}for(;e<u;++e)t.disableVertexAttribArray(e)}else for(t.bindBuffer(t.ARRAY_BUFFER,null),e=0;e<u;++e)t.disableVertexAttribArray(e)}},{}],359:[function(i,B,V){var t=i("./do-bind.js");function h(p){this.gl=p,this._elements=null,this._attributes=null,this._elementsType=p.UNSIGNED_SHORT}h.prototype.bind=function(){t(this.gl,this._elements,this._attributes)},h.prototype.update=function(p,u,e){this._elements=u,this._attributes=p,this._elementsType=e||this.gl.UNSIGNED_SHORT},h.prototype.dispose=function(){},h.prototype.unbind=function(){},h.prototype.draw=function(p,u,e){e=e||0;var l=this.gl;this._elements?l.drawElements(p,u,this._elementsType,e):l.drawArrays(p,e,u)},B.exports=function(p){return new h(p)}},{"./do-bind.js":358}],360:[function(i,B,V){var t=i("./do-bind.js");function h(u,e,l,o,a,n){this.location=u,this.dimension=e,this.a=l,this.b=o,this.c=a,this.d=n}function p(u,e,l){this.gl=u,this._ext=e,this.handle=l,this._attribs=[],this._useElements=!1,this._elementsType=u.UNSIGNED_SHORT}h.prototype.bind=function(u){switch(this.dimension){case 1:u.vertexAttrib1f(this.location,this.a);break;case 2:u.vertexAttrib2f(this.location,this.a,this.b);break;case 3:u.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:u.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},p.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var u=0;u<this._attribs.length;++u)this._attribs[u].bind(this.gl)},p.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},p.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},p.prototype.update=function(u,e,l){if(this.bind(),t(this.gl,e,u),this.unbind(),this._attribs.length=0,u)for(var o=0;o<u.length;++o){var a=u[o];typeof a=="number"?this._attribs.push(new h(o,1,a)):Array.isArray(a)&&this._attribs.push(new h(o,a.length,a[0],a[1],a[2],a[3]))}this._useElements=!!e,this._elementsType=l||this.gl.UNSIGNED_SHORT},p.prototype.draw=function(u,e,l){l=l||0;var o=this.gl;this._useElements?o.drawElements(u,e,this._elementsType,l):o.drawArrays(u,l,e)},B.exports=function(u,e){return new p(u,e,e.createVertexArrayOES())}},{"./do-bind.js":358}],361:[function(i,B,V){var t=i("./lib/vao-native.js"),h=i("./lib/vao-emulated.js");function p(u){this.bindVertexArrayOES=u.bindVertexArray.bind(u),this.createVertexArrayOES=u.createVertexArray.bind(u),this.deleteVertexArrayOES=u.deleteVertexArray.bind(u)}B.exports=function(u,e,l,o){var a,n=u.createVertexArray?new p(u):u.getExtension("OES_vertex_array_object");return(a=n?t(u,n):h(u)).update(e,l,o),a}},{"./lib/vao-emulated.js":359,"./lib/vao-native.js":360}],362:[function(i,B,V){B.exports=function(t,h,p){return t[0]=h[0]+p[0],t[1]=h[1]+p[1],t[2]=h[2]+p[2],t}},{}],363:[function(i,B,V){B.exports=function(u,e){var l=t(u[0],u[1],u[2]),o=t(e[0],e[1],e[2]);h(l,l),h(o,o);var a=p(l,o);return a>1?0:Math.acos(a)};var t=i("./fromValues"),h=i("./normalize"),p=i("./dot")},{"./dot":373,"./fromValues":379,"./normalize":390}],364:[function(i,B,V){B.exports=function(t,h){return t[0]=Math.ceil(h[0]),t[1]=Math.ceil(h[1]),t[2]=Math.ceil(h[2]),t}},{}],365:[function(i,B,V){B.exports=function(t){var h=new Float32Array(3);return h[0]=t[0],h[1]=t[1],h[2]=t[2],h}},{}],366:[function(i,B,V){B.exports=function(t,h){return t[0]=h[0],t[1]=h[1],t[2]=h[2],t}},{}],367:[function(i,B,V){B.exports=function(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}},{}],368:[function(i,B,V){B.exports=function(t,h,p){var u=h[0],e=h[1],l=h[2],o=p[0],a=p[1],n=p[2];return t[0]=e*n-l*a,t[1]=l*o-u*n,t[2]=u*a-e*o,t}},{}],369:[function(i,B,V){B.exports=i("./distance")},{"./distance":370}],370:[function(i,B,V){B.exports=function(t,h){var p=h[0]-t[0],u=h[1]-t[1],e=h[2]-t[2];return Math.sqrt(p*p+u*u+e*e)}},{}],371:[function(i,B,V){B.exports=i("./divide")},{"./divide":372}],372:[function(i,B,V){B.exports=function(t,h,p){return t[0]=h[0]/p[0],t[1]=h[1]/p[1],t[2]=h[2]/p[2],t}},{}],373:[function(i,B,V){B.exports=function(t,h){return t[0]*h[0]+t[1]*h[1]+t[2]*h[2]}},{}],374:[function(i,B,V){B.exports=1e-6},{}],375:[function(i,B,V){B.exports=function(h,p){var u=h[0],e=h[1],l=h[2],o=p[0],a=p[1],n=p[2];return Math.abs(u-o)<=t*Math.max(1,Math.abs(u),Math.abs(o))&&Math.abs(e-a)<=t*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(l-n)<=t*Math.max(1,Math.abs(l),Math.abs(n))};var t=i("./epsilon")},{"./epsilon":374}],376:[function(i,B,V){B.exports=function(t,h){return t[0]===h[0]&&t[1]===h[1]&&t[2]===h[2]}},{}],377:[function(i,B,V){B.exports=function(t,h){return t[0]=Math.floor(h[0]),t[1]=Math.floor(h[1]),t[2]=Math.floor(h[2]),t}},{}],378:[function(i,B,V){B.exports=function(h,p,u,e,l,o){var a,n;for(p||(p=3),u||(u=0),n=e?Math.min(e*p+u,h.length):h.length,a=u;a<n;a+=p)t[0]=h[a],t[1]=h[a+1],t[2]=h[a+2],l(t,t,o),h[a]=t[0],h[a+1]=t[1],h[a+2]=t[2];return h};var t=i("./create")()},{"./create":367}],379:[function(i,B,V){B.exports=function(t,h,p){var u=new Float32Array(3);return u[0]=t,u[1]=h,u[2]=p,u}},{}],380:[function(i,B,V){B.exports={EPSILON:i("./epsilon"),create:i("./create"),clone:i("./clone"),angle:i("./angle"),fromValues:i("./fromValues"),copy:i("./copy"),set:i("./set"),equals:i("./equals"),exactEquals:i("./exactEquals"),add:i("./add"),subtract:i("./subtract"),sub:i("./sub"),multiply:i("./multiply"),mul:i("./mul"),divide:i("./divide"),div:i("./div"),min:i("./min"),max:i("./max"),floor:i("./floor"),ceil:i("./ceil"),round:i("./round"),scale:i("./scale"),scaleAndAdd:i("./scaleAndAdd"),distance:i("./distance"),dist:i("./dist"),squaredDistance:i("./squaredDistance"),sqrDist:i("./sqrDist"),length:i("./length"),len:i("./len"),squaredLength:i("./squaredLength"),sqrLen:i("./sqrLen"),negate:i("./negate"),inverse:i("./inverse"),normalize:i("./normalize"),dot:i("./dot"),cross:i("./cross"),lerp:i("./lerp"),random:i("./random"),transformMat4:i("./transformMat4"),transformMat3:i("./transformMat3"),transformQuat:i("./transformQuat"),rotateX:i("./rotateX"),rotateY:i("./rotateY"),rotateZ:i("./rotateZ"),forEach:i("./forEach")}},{"./add":362,"./angle":363,"./ceil":364,"./clone":365,"./copy":366,"./create":367,"./cross":368,"./dist":369,"./distance":370,"./div":371,"./divide":372,"./dot":373,"./epsilon":374,"./equals":375,"./exactEquals":376,"./floor":377,"./forEach":378,"./fromValues":379,"./inverse":381,"./len":382,"./length":383,"./lerp":384,"./max":385,"./min":386,"./mul":387,"./multiply":388,"./negate":389,"./normalize":390,"./random":391,"./rotateX":392,"./rotateY":393,"./rotateZ":394,"./round":395,"./scale":396,"./scaleAndAdd":397,"./set":398,"./sqrDist":399,"./sqrLen":400,"./squaredDistance":401,"./squaredLength":402,"./sub":403,"./subtract":404,"./transformMat3":405,"./transformMat4":406,"./transformQuat":407}],381:[function(i,B,V){B.exports=function(t,h){return t[0]=1/h[0],t[1]=1/h[1],t[2]=1/h[2],t}},{}],382:[function(i,B,V){B.exports=i("./length")},{"./length":383}],383:[function(i,B,V){B.exports=function(t){var h=t[0],p=t[1],u=t[2];return Math.sqrt(h*h+p*p+u*u)}},{}],384:[function(i,B,V){B.exports=function(t,h,p,u){var e=h[0],l=h[1],o=h[2];return t[0]=e+u*(p[0]-e),t[1]=l+u*(p[1]-l),t[2]=o+u*(p[2]-o),t}},{}],385:[function(i,B,V){B.exports=function(t,h,p){return t[0]=Math.max(h[0],p[0]),t[1]=Math.max(h[1],p[1]),t[2]=Math.max(h[2],p[2]),t}},{}],386:[function(i,B,V){B.exports=function(t,h,p){return t[0]=Math.min(h[0],p[0]),t[1]=Math.min(h[1],p[1]),t[2]=Math.min(h[2],p[2]),t}},{}],387:[function(i,B,V){B.exports=i("./multiply")},{"./multiply":388}],388:[function(i,B,V){B.exports=function(t,h,p){return t[0]=h[0]*p[0],t[1]=h[1]*p[1],t[2]=h[2]*p[2],t}},{}],389:[function(i,B,V){B.exports=function(t,h){return t[0]=-h[0],t[1]=-h[1],t[2]=-h[2],t}},{}],390:[function(i,B,V){B.exports=function(t,h){var p=h[0],u=h[1],e=h[2],l=p*p+u*u+e*e;return l>0&&(l=1/Math.sqrt(l),t[0]=h[0]*l,t[1]=h[1]*l,t[2]=h[2]*l),t}},{}],391:[function(i,B,V){B.exports=function(t,h){h=h||1;var p=2*Math.random()*Math.PI,u=2*Math.random()-1,e=Math.sqrt(1-u*u)*h;return t[0]=Math.cos(p)*e,t[1]=Math.sin(p)*e,t[2]=u*h,t}},{}],392:[function(i,B,V){B.exports=function(t,h,p,u){var e=p[1],l=p[2],o=h[1]-e,a=h[2]-l,n=Math.sin(u),s=Math.cos(u);return t[0]=h[0],t[1]=e+o*s-a*n,t[2]=l+o*n+a*s,t}},{}],393:[function(i,B,V){B.exports=function(t,h,p,u){var e=p[0],l=p[2],o=h[0]-e,a=h[2]-l,n=Math.sin(u),s=Math.cos(u);return t[0]=e+a*n+o*s,t[1]=h[1],t[2]=l+a*s-o*n,t}},{}],394:[function(i,B,V){B.exports=function(t,h,p,u){var e=p[0],l=p[1],o=h[0]-e,a=h[1]-l,n=Math.sin(u),s=Math.cos(u);return t[0]=e+o*s-a*n,t[1]=l+o*n+a*s,t[2]=h[2],t}},{}],395:[function(i,B,V){B.exports=function(t,h){return t[0]=Math.round(h[0]),t[1]=Math.round(h[1]),t[2]=Math.round(h[2]),t}},{}],396:[function(i,B,V){B.exports=function(t,h,p){return t[0]=h[0]*p,t[1]=h[1]*p,t[2]=h[2]*p,t}},{}],397:[function(i,B,V){B.exports=function(t,h,p,u){return t[0]=h[0]+p[0]*u,t[1]=h[1]+p[1]*u,t[2]=h[2]+p[2]*u,t}},{}],398:[function(i,B,V){B.exports=function(t,h,p,u){return t[0]=h,t[1]=p,t[2]=u,t}},{}],399:[function(i,B,V){B.exports=i("./squaredDistance")},{"./squaredDistance":401}],400:[function(i,B,V){B.exports=i("./squaredLength")},{"./squaredLength":402}],401:[function(i,B,V){B.exports=function(t,h){var p=h[0]-t[0],u=h[1]-t[1],e=h[2]-t[2];return p*p+u*u+e*e}},{}],402:[function(i,B,V){B.exports=function(t){var h=t[0],p=t[1],u=t[2];return h*h+p*p+u*u}},{}],403:[function(i,B,V){B.exports=i("./subtract")},{"./subtract":404}],404:[function(i,B,V){B.exports=function(t,h,p){return t[0]=h[0]-p[0],t[1]=h[1]-p[1],t[2]=h[2]-p[2],t}},{}],405:[function(i,B,V){B.exports=function(t,h,p){var u=h[0],e=h[1],l=h[2];return t[0]=u*p[0]+e*p[3]+l*p[6],t[1]=u*p[1]+e*p[4]+l*p[7],t[2]=u*p[2]+e*p[5]+l*p[8],t}},{}],406:[function(i,B,V){B.exports=function(t,h,p){var u=h[0],e=h[1],l=h[2],o=p[3]*u+p[7]*e+p[11]*l+p[15];return o=o||1,t[0]=(p[0]*u+p[4]*e+p[8]*l+p[12])/o,t[1]=(p[1]*u+p[5]*e+p[9]*l+p[13])/o,t[2]=(p[2]*u+p[6]*e+p[10]*l+p[14])/o,t}},{}],407:[function(i,B,V){B.exports=function(t,h,p){var u=h[0],e=h[1],l=h[2],o=p[0],a=p[1],n=p[2],s=p[3],r=s*u+a*l-n*e,c=s*e+n*u-o*l,f=s*l+o*e-a*u,d=-o*u-a*e-n*l;return t[0]=r*s+d*-o+c*-n-f*-a,t[1]=c*s+d*-a+f*-o-r*-n,t[2]=f*s+d*-n+r*-a-c*-o,t}},{}],408:[function(i,B,V){B.exports=function(t,h,p){return t[0]=h[0]+p[0],t[1]=h[1]+p[1],t[2]=h[2]+p[2],t[3]=h[3]+p[3],t}},{}],409:[function(i,B,V){B.exports=function(t){var h=new Float32Array(4);return h[0]=t[0],h[1]=t[1],h[2]=t[2],h[3]=t[3],h}},{}],410:[function(i,B,V){B.exports=function(t,h){return t[0]=h[0],t[1]=h[1],t[2]=h[2],t[3]=h[3],t}},{}],411:[function(i,B,V){B.exports=function(){var t=new Float32Array(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}},{}],412:[function(i,B,V){B.exports=function(t,h){var p=h[0]-t[0],u=h[1]-t[1],e=h[2]-t[2],l=h[3]-t[3];return Math.sqrt(p*p+u*u+e*e+l*l)}},{}],413:[function(i,B,V){B.exports=function(t,h,p){return t[0]=h[0]/p[0],t[1]=h[1]/p[1],t[2]=h[2]/p[2],t[3]=h[3]/p[3],t}},{}],414:[function(i,B,V){B.exports=function(t,h){return t[0]*h[0]+t[1]*h[1]+t[2]*h[2]+t[3]*h[3]}},{}],415:[function(i,B,V){B.exports=function(t,h,p,u){var e=new Float32Array(4);return e[0]=t,e[1]=h,e[2]=p,e[3]=u,e}},{}],416:[function(i,B,V){B.exports={create:i("./create"),clone:i("./clone"),fromValues:i("./fromValues"),copy:i("./copy"),set:i("./set"),add:i("./add"),subtract:i("./subtract"),multiply:i("./multiply"),divide:i("./divide"),min:i("./min"),max:i("./max"),scale:i("./scale"),scaleAndAdd:i("./scaleAndAdd"),distance:i("./distance"),squaredDistance:i("./squaredDistance"),length:i("./length"),squaredLength:i("./squaredLength"),negate:i("./negate"),inverse:i("./inverse"),normalize:i("./normalize"),dot:i("./dot"),lerp:i("./lerp"),random:i("./random"),transformMat4:i("./transformMat4"),transformQuat:i("./transformQuat")}},{"./add":408,"./clone":409,"./copy":410,"./create":411,"./distance":412,"./divide":413,"./dot":414,"./fromValues":415,"./inverse":417,"./length":418,"./lerp":419,"./max":420,"./min":421,"./multiply":422,"./negate":423,"./normalize":424,"./random":425,"./scale":426,"./scaleAndAdd":427,"./set":428,"./squaredDistance":429,"./squaredLength":430,"./subtract":431,"./transformMat4":432,"./transformQuat":433}],417:[function(i,B,V){B.exports=function(t,h){return t[0]=1/h[0],t[1]=1/h[1],t[2]=1/h[2],t[3]=1/h[3],t}},{}],418:[function(i,B,V){B.exports=function(t){var h=t[0],p=t[1],u=t[2],e=t[3];return Math.sqrt(h*h+p*p+u*u+e*e)}},{}],419:[function(i,B,V){B.exports=function(t,h,p,u){var e=h[0],l=h[1],o=h[2],a=h[3];return t[0]=e+u*(p[0]-e),t[1]=l+u*(p[1]-l),t[2]=o+u*(p[2]-o),t[3]=a+u*(p[3]-a),t}},{}],420:[function(i,B,V){B.exports=function(t,h,p){return t[0]=Math.max(h[0],p[0]),t[1]=Math.max(h[1],p[1]),t[2]=Math.max(h[2],p[2]),t[3]=Math.max(h[3],p[3]),t}},{}],421:[function(i,B,V){B.exports=function(t,h,p){return t[0]=Math.min(h[0],p[0]),t[1]=Math.min(h[1],p[1]),t[2]=Math.min(h[2],p[2]),t[3]=Math.min(h[3],p[3]),t}},{}],422:[function(i,B,V){B.exports=function(t,h,p){return t[0]=h[0]*p[0],t[1]=h[1]*p[1],t[2]=h[2]*p[2],t[3]=h[3]*p[3],t}},{}],423:[function(i,B,V){B.exports=function(t,h){return t[0]=-h[0],t[1]=-h[1],t[2]=-h[2],t[3]=-h[3],t}},{}],424:[function(i,B,V){B.exports=function(t,h){var p=h[0],u=h[1],e=h[2],l=h[3],o=p*p+u*u+e*e+l*l;return o>0&&(o=1/Math.sqrt(o),t[0]=p*o,t[1]=u*o,t[2]=e*o,t[3]=l*o),t}},{}],425:[function(i,B,V){var t=i("./normalize"),h=i("./scale");B.exports=function(p,u){return u=u||1,p[0]=Math.random(),p[1]=Math.random(),p[2]=Math.random(),p[3]=Math.random(),t(p,p),h(p,p,u),p}},{"./normalize":424,"./scale":426}],426:[function(i,B,V){B.exports=function(t,h,p){return t[0]=h[0]*p,t[1]=h[1]*p,t[2]=h[2]*p,t[3]=h[3]*p,t}},{}],427:[function(i,B,V){B.exports=function(t,h,p,u){return t[0]=h[0]+p[0]*u,t[1]=h[1]+p[1]*u,t[2]=h[2]+p[2]*u,t[3]=h[3]+p[3]*u,t}},{}],428:[function(i,B,V){B.exports=function(t,h,p,u,e){return t[0]=h,t[1]=p,t[2]=u,t[3]=e,t}},{}],429:[function(i,B,V){B.exports=function(t,h){var p=h[0]-t[0],u=h[1]-t[1],e=h[2]-t[2],l=h[3]-t[3];return p*p+u*u+e*e+l*l}},{}],430:[function(i,B,V){B.exports=function(t){var h=t[0],p=t[1],u=t[2],e=t[3];return h*h+p*p+u*u+e*e}},{}],431:[function(i,B,V){B.exports=function(t,h,p){return t[0]=h[0]-p[0],t[1]=h[1]-p[1],t[2]=h[2]-p[2],t[3]=h[3]-p[3],t}},{}],432:[function(i,B,V){B.exports=function(t,h,p){var u=h[0],e=h[1],l=h[2],o=h[3];return t[0]=p[0]*u+p[4]*e+p[8]*l+p[12]*o,t[1]=p[1]*u+p[5]*e+p[9]*l+p[13]*o,t[2]=p[2]*u+p[6]*e+p[10]*l+p[14]*o,t[3]=p[3]*u+p[7]*e+p[11]*l+p[15]*o,t}},{}],433:[function(i,B,V){B.exports=function(t,h,p){var u=h[0],e=h[1],l=h[2],o=p[0],a=p[1],n=p[2],s=p[3],r=s*u+a*l-n*e,c=s*e+n*u-o*l,f=s*l+o*e-a*u,d=-o*u-a*e-n*l;return t[0]=r*s+d*-o+c*-n-f*-a,t[1]=c*s+d*-a+f*-o-r*-n,t[2]=f*s+d*-n+r*-a-c*-o,t[3]=h[3],t}},{}],434:[function(i,B,V){var t=i("glsl-tokenizer"),h=i("atob-lite");B.exports=function(p){for(var u=Array.isArray(p)?p:t(p),e=0;e<u.length;e++){var l=u[e];if(l.type==="preprocessor"){var o=l.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(o&&o[2]){var a=o[1],n=o[2];return(a?h(n):n).trim()}}}}},{"atob-lite":84,"glsl-tokenizer":441}],435:[function(i,B,V){B.exports=function(o){var a,n,s,r=0,c=0,f=999,d=[],g=[],m=1,y=0,v=0,T=!1,_=!1,k="",E=p,A=t;(o=o||{}).version==="300 es"&&(E=e,A=u);var b={},L={};for(r=0;r<E.length;r++)b[E[r]]=!0;for(r=0;r<A.length;r++)L[A[r]]=!0;return function(Y){return g=[],Y!==null?function(N){r=0,N.toString&&(N=N.toString());var J;for(k+=N.replace(/\r\n/g,`
`),s=k.length;a=k[r],r<s;){switch(J=r,f){case 0:r=z();break;case 1:case 2:r=P();break;case 3:r=F();break;case 4:r=X();break;case 11:r=W();break;case 5:r=Q();break;case 9999:r=Z();break;case 9:r=S();break;case 999:r=C()}if(J!==r)switch(k[J]){case`
`:y=0,++m;break;default:++y}}return c+=r,k=k.slice(r),g}(Y):function(N){return d.length&&w(d.join("")),f=10,w("(eof)"),g}()};function w(Y){Y.length&&g.push({type:l[f],data:Y,position:v,line:m,column:y})}function C(){return d=d.length?[]:d,n==="/"&&a==="*"?(v=c+r-1,f=0,n=a,r+1):n==="/"&&a==="/"?(v=c+r-1,f=1,n=a,r+1):a==="#"?(f=2,v=c+r,r):/\s/.test(a)?(f=9,v=c+r,r):(T=/\d/.test(a),_=/[^\w_]/.test(a),v=c+r,f=T?4:_?3:9999,r)}function S(){return/[^\s]/g.test(a)?(w(d.join("")),f=999,r):(d.push(a),n=a,r+1)}function P(){return a!=="\r"&&a!==`
`||n==="\\"?(d.push(a),n=a,r+1):(w(d.join("")),f=999,r)}function z(){return a==="/"&&n==="*"?(d.push(a),w(d.join("")),f=999,r+1):(d.push(a),n=a,r+1)}function F(){if(n==="."&&/\d/.test(a))return f=5,r;if(n==="/"&&a==="*")return f=0,r;if(n==="/"&&a==="/")return f=1,r;if(a==="."&&d.length){for(;q(d););return f=5,r}if(a===";"||a===")"||a==="("){if(d.length)for(;q(d););return w(a),f=999,r+1}var Y=d.length===2&&a!=="=";if(/[\w_\d\s]/.test(a)||Y){for(;q(d););return f=999,r}return d.push(a),n=a,r+1}function q(Y){for(var N,J,D=0;;){if(N=h.indexOf(Y.slice(0,Y.length+D).join("")),J=h[N],N===-1){if(D--+Y.length>0)continue;J=Y.slice(0,1).join("")}return w(J),v+=J.length,(d=d.slice(J.length)).length}}function W(){return/[^a-fA-F0-9]/.test(a)?(w(d.join("")),f=999,r):(d.push(a),n=a,r+1)}function X(){return a==="."||/[eE]/.test(a)?(d.push(a),f=5,n=a,r+1):a==="x"&&d.length===1&&d[0]==="0"?(f=11,d.push(a),n=a,r+1):/[^\d]/.test(a)?(w(d.join("")),f=999,r):(d.push(a),n=a,r+1)}function Q(){return a==="f"&&(d.push(a),n=a,r+=1),/[eE]/.test(a)?(d.push(a),n=a,r+1):(a!=="-"&&a!=="+"||!/[eE]/.test(n))&&/[^\d]/.test(a)?(w(d.join("")),f=999,r):(d.push(a),n=a,r+1)}function Z(){if(/[^\d\w_]/.test(a)){var Y=d.join("");return f=L[Y]?8:b[Y]?7:6,w(d.join("")),f=999,r}return d.push(a),n=a,r+1}};var t=i("./lib/literals"),h=i("./lib/operators"),p=i("./lib/builtins"),u=i("./lib/literals-300es"),e=i("./lib/builtins-300es"),l=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":437,"./lib/builtins-300es":436,"./lib/literals":439,"./lib/literals-300es":438,"./lib/operators":440}],436:[function(i,B,V){var t=i("./builtins");t=t.slice().filter(function(h){return!/^(gl\_|texture)/.test(h)}),B.exports=t.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":437}],437:[function(i,B,V){B.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],438:[function(i,B,V){var t=i("./literals");B.exports=t.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":439}],439:[function(i,B,V){B.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],440:[function(i,B,V){B.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],441:[function(i,B,V){var t=i("./index");B.exports=function(h,p){var u=t(p),e=[];return e=(e=e.concat(u(h))).concat(u(null))}},{"./index":435}],442:[function(i,B,V){arguments[4][265][0].apply(V,arguments)},{dup:265}],443:[function(i,B,V){(function(t){(function(){var h,p=i("is-browser");h=typeof t.matchMedia=="function"?!t.matchMedia("(hover: none)").matches:p,B.exports=h}).call(this)}).call(this,typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":452}],444:[function(i,B,V){var t=i("is-browser");B.exports=t&&function(){var h=!1;try{var p=Object.defineProperty({},"passive",{get:function(){h=!0}});window.addEventListener("test",null,p),window.removeEventListener("test",null,p)}catch{h=!1}return h}()},{"is-browser":452}],445:[function(i,B,V){V.read=function(t,h,p,u,e){var l,o,a=8*e-u-1,n=(1<<a)-1,s=n>>1,r=-7,c=p?e-1:0,f=p?-1:1,d=t[h+c];for(c+=f,l=d&(1<<-r)-1,d>>=-r,r+=a;r>0;l=256*l+t[h+c],c+=f,r-=8);for(o=l&(1<<-r)-1,l>>=-r,r+=u;r>0;o=256*o+t[h+c],c+=f,r-=8);if(l===0)l=1-s;else{if(l===n)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,u),l-=s}return(d?-1:1)*o*Math.pow(2,l-u)},V.write=function(t,h,p,u,e,l){var o,a,n,s=8*l-e-1,r=(1<<s)-1,c=r>>1,f=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=u?0:l-1,g=u?1:-1,m=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(a=isNaN(h)?1:0,o=r):(o=Math.floor(Math.log(h)/Math.LN2),h*(n=Math.pow(2,-o))<1&&(o--,n*=2),(h+=o+c>=1?f/n:f*Math.pow(2,1-c))*n>=2&&(o++,n/=2),o+c>=r?(a=0,o=r):o+c>=1?(a=(h*n-1)*Math.pow(2,e),o+=c):(a=h*Math.pow(2,c-1)*Math.pow(2,e),o=0));e>=8;t[p+d]=255&a,d+=g,a/=256,e-=8);for(o=o<<e|a,s+=e;s>0;t[p+d]=255&o,d+=g,o/=256,s-=8);t[p+d-g]|=128*m}},{}],446:[function(i,B,V){B.exports=function(n,s){var r=n.length;if(r===0)throw new Error("Must have at least d+1 points");var c=n[0].length;if(r<=c)throw new Error("Must input at least d+1 points");var f=n.slice(0,c+1),d=t.apply(void 0,f);if(d===0)throw new Error("Input not in general position");for(var g=new Array(c+1),m=0;m<=c;++m)g[m]=m;d<0&&(g[0]=1,g[1]=0);var y=new p(g,new Array(c+1),!1),v=y.adjacent,T=new Array(c+2);for(m=0;m<=c;++m){for(var _=g.slice(),k=0;k<=c;++k)k===m&&(_[k]=-1);var E=_[0];_[0]=_[1],_[1]=E;var A=new p(_,new Array(c+1),!0);v[m]=A,T[m]=A}for(T[c+1]=y,m=0;m<=c;++m){_=v[m].vertices;var b=v[m].adjacent;for(k=0;k<=c;++k){var L=_[k];if(L<0)b[k]=y;else for(var w=0;w<=c;++w)v[w].vertices.indexOf(L)<0&&(b[k]=v[w])}}var C=new o(c,f,T),S=!!s;for(m=c+1;m<r;++m)C.insert(n[m],S);return C.boundary()};var t=i("robust-orientation"),h=i("simplicial-complex").compareCells;function p(n,s,r){this.vertices=n,this.adjacent=s,this.boundary=r,this.lastVisited=-1}function u(n,s,r){this.vertices=n,this.cell=s,this.index=r}function e(n,s){return h(n.vertices,s.vertices)}p.prototype.flip=function(){var n=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=n;var s=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=s};var l=[];function o(n,s,r){this.dimension=n,this.vertices=s,this.simplices=r,this.interior=r.filter(function(d){return!d.boundary}),this.tuple=new Array(n+1);for(var c=0;c<=n;++c)this.tuple[c]=this.vertices[c];var f=l[n];f||(f=l[n]=function(d){for(var g=["function orient(){var tuple=this.tuple;return test("],m=0;m<=d;++m)m>0&&g.push(","),g.push("tuple[",m,"]");g.push(")}return orient");var y=new Function("test",g.join("")),v=t[d+1];return v||(v=t),y(v)}(n)),this.orient=f}var a=o.prototype;a.handleBoundaryDegeneracy=function(n,s){var r=this.dimension,c=this.vertices.length-1,f=this.tuple,d=this.vertices,g=[n];for(n.lastVisited=-c;g.length>0;){(n=g.pop()).vertices;for(var m=n.adjacent,y=0;y<=r;++y){var v=m[y];if(v.boundary&&!(v.lastVisited<=-c)){for(var T=v.vertices,_=0;_<=r;++_){var k=T[_];f[_]=k<0?s:d[k]}var E=this.orient();if(E>0)return v;v.lastVisited=-c,E===0&&g.push(v)}}}return null},a.walk=function(n,s){var r=this.vertices.length-1,c=this.dimension,f=this.vertices,d=this.tuple,g=s?this.interior.length*Math.random()|0:this.interior.length-1,m=this.interior[g];e:for(;!m.boundary;){for(var y=m.vertices,v=m.adjacent,T=0;T<=c;++T)d[T]=f[y[T]];for(m.lastVisited=r,T=0;T<=c;++T){var _=v[T];if(!(_.lastVisited>=r)){var k=d[T];d[T]=n;var E=this.orient();if(d[T]=k,E<0){m=_;continue e}_.boundary?_.lastVisited=-r:_.lastVisited=r}}return}return m},a.addPeaks=function(n,s){var r=this.vertices.length-1,c=this.dimension,f=this.vertices,d=this.tuple,g=this.interior,m=this.simplices,y=[s];s.lastVisited=r,s.vertices[s.vertices.indexOf(-1)]=r,s.boundary=!1,g.push(s);for(var v=[];y.length>0;){var T=(s=y.pop()).vertices,_=s.adjacent,k=T.indexOf(r);if(!(k<0)){for(var E=0;E<=c;++E)if(E!==k){var A=_[E];if(A.boundary&&!(A.lastVisited>=r)){var b=A.vertices;if(A.lastVisited!==-r){for(var L=0,w=0;w<=c;++w)b[w]<0?(L=w,d[w]=n):d[w]=f[b[w]];if(this.orient()>0){b[L]=r,A.boundary=!1,g.push(A),y.push(A),A.lastVisited=r;continue}A.lastVisited=-r}var C=A.adjacent,S=T.slice(),P=_.slice(),z=new p(S,P,!0);m.push(z);var F=C.indexOf(s);if(!(F<0))for(C[F]=z,P[k]=A,S[E]=-1,P[E]=s,_[E]=z,z.flip(),w=0;w<=c;++w){var q=S[w];if(!(q<0||q===r)){for(var W=new Array(c-1),X=0,Q=0;Q<=c;++Q){var Z=S[Q];Z<0||Q===w||(W[X++]=Z)}v.push(new u(W,z,w))}}}}}}for(v.sort(e),E=0;E+1<v.length;E+=2){var Y=v[E],N=v[E+1],J=Y.index,D=N.index;J<0||D<0||(Y.cell.adjacent[Y.index]=N.cell,N.cell.adjacent[N.index]=Y.cell)}},a.insert=function(n,s){var r=this.vertices;r.push(n);var c=this.walk(n,s);if(c){for(var f=this.dimension,d=this.tuple,g=0;g<=f;++g){var m=c.vertices[g];d[g]=m<0?n:r[m]}var y=this.orient(d);y<0||(y!==0||(c=this.handleBoundaryDegeneracy(c,n)))&&this.addPeaks(n,c)}},a.boundary=function(){for(var n=this.dimension,s=[],r=this.simplices,c=r.length,f=0;f<c;++f){var d=r[f];if(d.boundary){for(var g=new Array(n),m=d.vertices,y=0,v=0,T=0;T<=n;++T)m[T]>=0?g[y++]=m[T]:v=1&T;if(v===(1&n)){var _=g[0];g[0]=g[1],g[1]=_}s.push(g)}}return s}},{"robust-orientation":548,"simplicial-complex":559}],447:[function(i,B,V){typeof Object.create=="function"?B.exports=function(t,h){h&&(t.super_=h,t.prototype=Object.create(h.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:B.exports=function(t,h){if(h){t.super_=h;var p=function(){};p.prototype=h.prototype,t.prototype=new p,t.prototype.constructor=t}}},{}],448:[function(i,B,V){var t=i("binary-search-bounds");function h(y,v,T,_,k){this.mid=y,this.left=v,this.right=T,this.leftPoints=_,this.rightPoints=k,this.count=(v?v.count:0)+(T?T.count:0)+_.length}B.exports=function(y){return!y||y.length===0?new g(null):new g(d(y))};var p=h.prototype;function u(y,v){y.mid=v.mid,y.left=v.left,y.right=v.right,y.leftPoints=v.leftPoints,y.rightPoints=v.rightPoints,y.count=v.count}function e(y,v){var T=d(v);y.mid=T.mid,y.left=T.left,y.right=T.right,y.leftPoints=T.leftPoints,y.rightPoints=T.rightPoints,y.count=T.count}function l(y,v){var T=y.intervals([]);T.push(v),e(y,T)}function o(y,v){var T=y.intervals([]),_=T.indexOf(v);return _<0?0:(T.splice(_,1),e(y,T),1)}function a(y,v,T){for(var _=0;_<y.length&&y[_][0]<=v;++_){var k=T(y[_]);if(k)return k}}function n(y,v,T){for(var _=y.length-1;_>=0&&y[_][1]>=v;--_){var k=T(y[_]);if(k)return k}}function s(y,v){for(var T=0;T<y.length;++T){var _=v(y[T]);if(_)return _}}function r(y,v){return y-v}function c(y,v){var T=y[0]-v[0];return T||y[1]-v[1]}function f(y,v){var T=y[1]-v[1];return T||y[0]-v[0]}function d(y){if(y.length===0)return null;for(var v=[],T=0;T<y.length;++T)v.push(y[T][0],y[T][1]);v.sort(r);var _=v[v.length>>1],k=[],E=[],A=[];for(T=0;T<y.length;++T){var b=y[T];b[1]<_?k.push(b):_<b[0]?E.push(b):A.push(b)}var L=A,w=A.slice();return L.sort(c),w.sort(f),new h(_,d(k),d(E),L,w)}function g(y){this.root=y}p.intervals=function(y){return y.push.apply(y,this.leftPoints),this.left&&this.left.intervals(y),this.right&&this.right.intervals(y),y},p.insert=function(y){var v=this.count-this.leftPoints.length;if(this.count+=1,y[1]<this.mid)this.left?4*(this.left.count+1)>3*(v+1)?l(this,y):this.left.insert(y):this.left=d([y]);else if(y[0]>this.mid)this.right?4*(this.right.count+1)>3*(v+1)?l(this,y):this.right.insert(y):this.right=d([y]);else{var T=t.ge(this.leftPoints,y,c),_=t.ge(this.rightPoints,y,f);this.leftPoints.splice(T,0,y),this.rightPoints.splice(_,0,y)}},p.remove=function(y){var v=this.count-this.leftPoints;if(y[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(v-1)?o(this,y):(E=this.left.remove(y))===2?(this.left=null,this.count-=1,1):(E===1&&(this.count-=1),E):0;if(y[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(v-1)?o(this,y):(E=this.right.remove(y))===2?(this.right=null,this.count-=1,1):(E===1&&(this.count-=1),E):0;if(this.count===1)return this.leftPoints[0]===y?2:0;if(this.leftPoints.length===1&&this.leftPoints[0]===y){if(this.left&&this.right){for(var T=this,_=this.left;_.right;)T=_,_=_.right;if(T===this)_.right=this.right;else{var k=this.left,E=this.right;T.count-=_.count,T.right=_.left,_.left=k,_.right=E}u(this,_),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?u(this,this.left):u(this,this.right);return 1}for(k=t.ge(this.leftPoints,y,c);k<this.leftPoints.length&&this.leftPoints[k][0]===y[0];++k)if(this.leftPoints[k]===y){for(this.count-=1,this.leftPoints.splice(k,1),E=t.ge(this.rightPoints,y,f);E<this.rightPoints.length&&this.rightPoints[E][1]===y[1];++E)if(this.rightPoints[E]===y)return this.rightPoints.splice(E,1),1}return 0},p.queryPoint=function(y,v){if(y<this.mid)return this.left&&(T=this.left.queryPoint(y,v))?T:a(this.leftPoints,y,v);if(y>this.mid){var T;return this.right&&(T=this.right.queryPoint(y,v))?T:n(this.rightPoints,y,v)}return s(this.leftPoints,v)},p.queryInterval=function(y,v,T){var _;return y<this.mid&&this.left&&(_=this.left.queryInterval(y,v,T))||v>this.mid&&this.right&&(_=this.right.queryInterval(y,v,T))?_:v<this.mid?a(this.leftPoints,v,T):y>this.mid?n(this.rightPoints,y,T):s(this.leftPoints,T)};var m=g.prototype;m.insert=function(y){this.root?this.root.insert(y):this.root=new h(y[0],null,null,[y],[y])},m.remove=function(y){if(this.root){var v=this.root.remove(y);return v===2&&(this.root=null),v!==0}return!1},m.queryPoint=function(y,v){if(this.root)return this.root.queryPoint(y,v)},m.queryInterval=function(y,v,T){if(y<=v&&this.root)return this.root.queryInterval(y,v,T)},Object.defineProperty(m,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(m,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":449}],449:[function(i,B,V){arguments[4][251][0].apply(V,arguments)},{dup:251}],450:[function(i,B,V){B.exports=function(t,h){h=h||new Array(t.length);for(var p=0;p<t.length;++p)h[t[p]]=p;return h}},{}],451:[function(i,B,V){B.exports=function(t){for(var h=new Array(t),p=0;p<t;++p)h[p]=p;return h}},{}],452:[function(i,B,V){B.exports=!0},{}],453:[function(i,B,V){function t(h){return!!h.constructor&&typeof h.constructor.isBuffer=="function"&&h.constructor.isBuffer(h)}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */B.exports=function(h){return h!=null&&(t(h)||function(p){return typeof p.readFloatLE=="function"&&typeof p.slice=="function"&&t(p.slice(0,0))}(h)||!!h._isBuffer)}},{}],454:[function(i,B,V){B.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],455:[function(i,B,V){B.exports=p,B.exports.isMobile=p,B.exports.default=p;var t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,h=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function p(u){u||(u={});var e=u.ua;if(e||typeof navigator>"u"||(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var l=u.tablet?h.test(e):t.test(e);return!l&&u.tablet&&u.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(l=!0),l}},{}],456:[function(i,B,V){B.exports=function(t){var h=typeof t;return t!==null&&(h==="object"||h==="function")}},{}],457:[function(i,B,V){var t=Object.prototype.toString;B.exports=function(h){var p;return t.call(h)==="[object Object]"&&((p=Object.getPrototypeOf(h))===null||p===Object.getPrototypeOf({}))}},{}],458:[function(i,B,V){B.exports=function(t){for(var h,p=t.length,u=0;u<p;u++)if(((h=t.charCodeAt(u))<9||h>13)&&h!==32&&h!==133&&h!==160&&h!==5760&&h!==6158&&(h<8192||h>8205)&&h!==8232&&h!==8233&&h!==8239&&h!==8287&&h!==8288&&h!==12288&&h!==65279)return!1;return!0}},{}],459:[function(i,B,V){B.exports=function(t){return typeof t=="string"&&(t=t.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4))}},{}],460:[function(i,B,V){B.exports=function(t,h,p){return t*(1-p)+h*p}},{}],461:[function(i,B,V){(function(t,h){typeof V=="object"&&B!==void 0?B.exports=h():(t=t||self).mapboxgl=h()})(this,function(){var t,h,p;function u(e,l){if(t)if(h){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+h+")(sharedChunk);",a={};t(a),(p=l(a)).workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"}))}else h=l;else t=l}return u(0,function(e){function l(x,I){return x(I={exports:{}},I.exports),I.exports}var o=a;function a(x,I,H,ee){this.cx=3*x,this.bx=3*(H-x)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*I,this.by=3*(ee-I)-this.cy,this.ay=1-this.cy-this.by,this.p1x=x,this.p1y=ee,this.p2x=H,this.p2y=ee}a.prototype.sampleCurveX=function(x){return((this.ax*x+this.bx)*x+this.cx)*x},a.prototype.sampleCurveY=function(x){return((this.ay*x+this.by)*x+this.cy)*x},a.prototype.sampleCurveDerivativeX=function(x){return(3*this.ax*x+2*this.bx)*x+this.cx},a.prototype.solveCurveX=function(x,I){var H,ee,ue,me,we;for(I===void 0&&(I=1e-6),ue=x,we=0;we<8;we++){if(me=this.sampleCurveX(ue)-x,Math.abs(me)<I)return ue;var Re=this.sampleCurveDerivativeX(ue);if(Math.abs(Re)<1e-6)break;ue-=me/Re}if((ue=x)<(H=0))return H;if(ue>(ee=1))return ee;for(;H<ee;){if(me=this.sampleCurveX(ue),Math.abs(me-x)<I)return ue;x>me?H=ue:ee=ue,ue=.5*(ee-H)+H}return ue},a.prototype.solve=function(x,I){return this.sampleCurveY(this.solveCurveX(x,I))};var n=s;function s(x,I){this.x=x,this.y=I}function r(x,I,H,ee){var ue=new o(x,I,H,ee);return function(me){return ue.solve(me)}}s.prototype={clone:function(){return new s(this.x,this.y)},add:function(x){return this.clone()._add(x)},sub:function(x){return this.clone()._sub(x)},multByPoint:function(x){return this.clone()._multByPoint(x)},divByPoint:function(x){return this.clone()._divByPoint(x)},mult:function(x){return this.clone()._mult(x)},div:function(x){return this.clone()._div(x)},rotate:function(x){return this.clone()._rotate(x)},rotateAround:function(x,I){return this.clone()._rotateAround(x,I)},matMult:function(x){return this.clone()._matMult(x)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(x){return this.x===x.x&&this.y===x.y},dist:function(x){return Math.sqrt(this.distSqr(x))},distSqr:function(x){var I=x.x-this.x,H=x.y-this.y;return I*I+H*H},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(x){return Math.atan2(this.y-x.y,this.x-x.x)},angleWith:function(x){return this.angleWithSep(x.x,x.y)},angleWithSep:function(x,I){return Math.atan2(this.x*I-this.y*x,this.x*x+this.y*I)},_matMult:function(x){var I=x[0]*this.x+x[1]*this.y,H=x[2]*this.x+x[3]*this.y;return this.x=I,this.y=H,this},_add:function(x){return this.x+=x.x,this.y+=x.y,this},_sub:function(x){return this.x-=x.x,this.y-=x.y,this},_mult:function(x){return this.x*=x,this.y*=x,this},_div:function(x){return this.x/=x,this.y/=x,this},_multByPoint:function(x){return this.x*=x.x,this.y*=x.y,this},_divByPoint:function(x){return this.x/=x.x,this.y/=x.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var x=this.y;return this.y=this.x,this.x=-x,this},_rotate:function(x){var I=Math.cos(x),H=Math.sin(x),ee=I*this.x-H*this.y,ue=H*this.x+I*this.y;return this.x=ee,this.y=ue,this},_rotateAround:function(x,I){var H=Math.cos(x),ee=Math.sin(x),ue=I.x+H*(this.x-I.x)-ee*(this.y-I.y),me=I.y+ee*(this.x-I.x)+H*(this.y-I.y);return this.x=ue,this.y=me,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(x){return x instanceof s?x:Array.isArray(x)?new s(x[0],x[1]):x};var c=r(.25,.1,.25,1);function f(x,I,H){return Math.min(H,Math.max(I,x))}function d(x,I,H){var ee=H-I,ue=((x-I)%ee+ee)%ee+I;return ue===I?H:ue}function g(x){for(var I=[],H=arguments.length-1;H-- >0;)I[H]=arguments[H+1];for(var ee=0,ue=I;ee<ue.length;ee+=1){var me=ue[ee];for(var we in me)x[we]=me[we]}return x}var m=1;function y(){return m++}function v(){return function x(I){return I?(I^16*Math.random()>>I/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,x)}()}function T(x){return!!x&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(x)}function _(x,I){x.forEach(function(H){I[H]&&(I[H]=I[H].bind(I))})}function k(x,I){return x.indexOf(I,x.length-I.length)!==-1}function E(x,I,H){var ee={};for(var ue in x)ee[ue]=I.call(H||this,x[ue],ue,x);return ee}function A(x,I,H){var ee={};for(var ue in x)I.call(H||this,x[ue],ue,x)&&(ee[ue]=x[ue]);return ee}function b(x){return Array.isArray(x)?x.map(b):typeof x=="object"&&x?E(x,b):x}var L={};function w(x){L[x]||(typeof console<"u"&&console.warn(x),L[x]=!0)}function C(x,I,H){return(H.y-x.y)*(I.x-x.x)>(I.y-x.y)*(H.x-x.x)}function S(x){for(var I=0,H=0,ee=x.length,ue=ee-1,me=void 0,we=void 0;H<ee;ue=H++)me=x[H],I+=((we=x[ue]).x-me.x)*(me.y+we.y);return I}function P(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function z(x){var I={};if(x.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(ee,ue,me,we){var Re=me||we;return I[ue]=!Re||Re.toLowerCase(),""}),I["max-age"]){var H=parseInt(I["max-age"],10);isNaN(H)?delete I["max-age"]:I["max-age"]=H}return I}var F=null;function q(x){if(F==null){var I=x.navigator?x.navigator.userAgent:null;F=!!x.safari||!(!I||!(/\b(iPad|iPhone|iPod)\b/.test(I)||I.match("Safari")&&!I.match("Chrome")))}return F}function W(x){try{var I=self[x];return I.setItem("_mapbox_test_",1),I.removeItem("_mapbox_test_"),!0}catch{return!1}}var X,Q,Z,Y,N=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),J=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,D=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,U={now:N,frame:function(x){var I=J(x);return{cancel:function(){return D(I)}}},getImageData:function(x,I){I===void 0&&(I=0);var H=self.document.createElement("canvas"),ee=H.getContext("2d");if(!ee)throw new Error("failed to create canvas 2d context");return H.width=x.width,H.height=x.height,ee.drawImage(x,0,0,x.width,x.height),ee.getImageData(-I,-I,x.width+2*I,x.height+2*I)},resolveURL:function(x){return X||(X=self.document.createElement("a")),X.href=x,X.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(Q==null&&(Q=self.matchMedia("(prefers-reduced-motion: reduce)")),Q.matches)}},G={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},$={supported:!1,testSupport:function(x){K||!Y||(re?ne(x):Z=x)}},K=!1,re=!1;function ne(x){var I=x.createTexture();x.bindTexture(x.TEXTURE_2D,I);try{if(x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,Y),x.isContextLost())return;$.supported=!0}catch{}x.deleteTexture(I),K=!0}self.document&&((Y=self.document.createElement("img")).onload=function(){Z&&ne(Z),Z=null,re=!0},Y.onerror=function(){K=!0,Z=null},Y.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ae="01",ie=function(x,I){this._transformRequestFn=x,this._customAccessToken=I,this._createSkuToken()};function he(x){return x.indexOf("mapbox:")===0}ie.prototype._createSkuToken=function(){var x=function(){for(var I="",H=0;H<10;H++)I+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ae,I].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=x.token,this._skuTokenExpiresAt=x.tokenExpiresAt},ie.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ie.prototype.transformRequest=function(x,I){return this._transformRequestFn&&this._transformRequestFn(x,I)||{url:x}},ie.prototype.normalizeStyleURL=function(x,I){if(!he(x))return x;var H=ve(x);return H.path="/styles/v1"+H.path,this._makeAPIURL(H,this._customAccessToken||I)},ie.prototype.normalizeGlyphsURL=function(x,I){if(!he(x))return x;var H=ve(x);return H.path="/fonts/v1"+H.path,this._makeAPIURL(H,this._customAccessToken||I)},ie.prototype.normalizeSourceURL=function(x,I){if(!he(x))return x;var H=ve(x);return H.path="/v4/"+H.authority+".json",H.params.push("secure"),this._makeAPIURL(H,this._customAccessToken||I)},ie.prototype.normalizeSpriteURL=function(x,I,H,ee){var ue=ve(x);return he(x)?(ue.path="/styles/v1"+ue.path+"/sprite"+I+H,this._makeAPIURL(ue,this._customAccessToken||ee)):(ue.path+=""+I+H,Ee(ue))},ie.prototype.normalizeTileURL=function(x,I){if(this._isSkuTokenExpired()&&this._createSkuToken(),x&&!he(x))return x;var H=ve(x),ee=U.devicePixelRatio>=2||I===512?"@2x":"",ue=$.supported?".webp":"$1";H.path=H.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+ee+ue),H.path=H.path.replace(/^.+\/v4\//,"/"),H.path="/v4"+H.path;var me=this._customAccessToken||function(we){for(var Re=0,Ze=we;Re<Ze.length;Re+=1){var ct=Ze[Re].match(/^access_token=(.*)$/);if(ct)return ct[1]}return null}(H.params)||G.ACCESS_TOKEN;return G.REQUIRE_ACCESS_TOKEN&&me&&this._skuToken&&H.params.push("sku="+this._skuToken),this._makeAPIURL(H,me)},ie.prototype.canonicalizeTileURL=function(x,I){var H=ve(x);if(!H.path.match(/(^\/v4\/)/)||!H.path.match(/\.[\w]+$/))return x;var ee="mapbox://tiles/";ee+=H.path.replace("/v4/","");var ue=H.params;return I&&(ue=ue.filter(function(me){return!me.match(/^access_token=/)})),ue.length&&(ee+="?"+ue.join("&")),ee},ie.prototype.canonicalizeTileset=function(x,I){for(var H=!!I&&he(I),ee=[],ue=0,me=x.tiles||[];ue<me.length;ue+=1){var we=me[ue];de(we)?ee.push(this.canonicalizeTileURL(we,H)):ee.push(we)}return ee},ie.prototype._makeAPIURL=function(x,I){var H="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",ee=ve(G.API_URL);if(x.protocol=ee.protocol,x.authority=ee.authority,ee.path!=="/"&&(x.path=""+ee.path+x.path),!G.REQUIRE_ACCESS_TOKEN)return Ee(x);if(!(I=I||G.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+H);if(I[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+H);return x.params=x.params.filter(function(ue){return ue.indexOf("access_token")===-1}),x.params.push("access_token="+I),Ee(x)};var se=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function de(x){return se.test(x)}var ce=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ve(x){var I=x.match(ce);if(!I)throw new Error("Unable to parse URL object");return{protocol:I[1],authority:I[2],path:I[3]||"/",params:I[4]?I[4].split("&"):[]}}function Ee(x){var I=x.params.length?"?"+x.params.join("&"):"";return x.protocol+"://"+x.authority+x.path+I}function Le(x){if(!x)return null;var I,H=x.split(".");if(!H||H.length!==3)return null;try{return JSON.parse((I=H[1],decodeURIComponent(self.atob(I).split("").map(function(ee){return"%"+("00"+ee.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch{return null}}var Te=function(x){this.type=x,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Te.prototype.getStorageKey=function(x){var I,H=Le(G.ACCESS_TOKEN),ee="";return H&&H.u?(I=H.u,ee=self.btoa(encodeURIComponent(I).replace(/%([0-9A-F]{2})/g,function(ue,me){return String.fromCharCode(+("0x"+me))}))):ee=G.ACCESS_TOKEN||"",x?"mapbox.eventData."+x+":"+ee:"mapbox.eventData:"+ee},Te.prototype.fetchEventData=function(){var x=W("localStorage"),I=this.getStorageKey(),H=this.getStorageKey("uuid");if(x)try{var ee=self.localStorage.getItem(I);ee&&(this.eventData=JSON.parse(ee));var ue=self.localStorage.getItem(H);ue&&(this.anonId=ue)}catch{w("Unable to read from LocalStorage")}},Te.prototype.saveEventData=function(){var x=W("localStorage"),I=this.getStorageKey(),H=this.getStorageKey("uuid");if(x)try{self.localStorage.setItem(H,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(I,JSON.stringify(this.eventData))}catch{w("Unable to write to LocalStorage")}},Te.prototype.processRequests=function(x){},Te.prototype.postEvent=function(x,I,H,ee){var ue=this;if(G.EVENTS_URL){var me=ve(G.EVENTS_URL);me.params.push("access_token="+(ee||G.ACCESS_TOKEN||""));var we={event:this.type,created:new Date(x).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:ae,userId:this.anonId},Re=I?g(we,I):we,Ze={url:Ee(me),headers:{"Content-Type":"text/plain"},body:JSON.stringify([Re])};this.pendingRequest=Jt(Ze,function(ct){ue.pendingRequest=null,H(ct),ue.saveEventData(),ue.processRequests(ee)})}},Te.prototype.queueRequest=function(x,I){this.queue.push(x),this.processRequests(I)};var xe,fe,ge=function(x){function I(){x.call(this,"map.load"),this.success={},this.skuToken=""}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.postMapLoadEvent=function(H,ee,ue,me){this.skuToken=ue,(G.EVENTS_URL&&me||G.ACCESS_TOKEN&&Array.isArray(H)&&H.some(function(we){return he(we)||de(we)}))&&this.queueRequest({id:ee,timestamp:Date.now()},me)},I.prototype.processRequests=function(H){var ee=this;if(!this.pendingRequest&&this.queue.length!==0){var ue=this.queue.shift(),me=ue.id,we=ue.timestamp;me&&this.success[me]||(this.anonId||this.fetchEventData(),T(this.anonId)||(this.anonId=v()),this.postEvent(we,{skuToken:this.skuToken},function(Re){Re||me&&(ee.success[me]=!0)},H))}},I}(Te),ke=new(function(x){function I(H){x.call(this,"appUserTurnstile"),this._customAccessToken=H}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.postTurnstileEvent=function(H,ee){G.EVENTS_URL&&G.ACCESS_TOKEN&&Array.isArray(H)&&H.some(function(ue){return he(ue)||de(ue)})&&this.queueRequest(Date.now(),ee)},I.prototype.processRequests=function(H){var ee=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var ue=Le(G.ACCESS_TOKEN),me=ue?ue.u:G.ACCESS_TOKEN,we=me!==this.eventData.tokenU;T(this.anonId)||(this.anonId=v(),we=!0);var Re=this.queue.shift();if(this.eventData.lastSuccess){var Ze=new Date(this.eventData.lastSuccess),ct=new Date(Re),pt=(Re-this.eventData.lastSuccess)/864e5;we=we||pt>=1||pt<-1||Ze.getDate()!==ct.getDate()}else we=!0;if(!we)return this.processRequests();this.postEvent(Re,{"enabled.telemetry":!1},function(Rt){Rt||(ee.eventData.lastSuccess=Re,ee.eventData.tokenU=me)},H)}},I}(Te)),Me=ke.postTurnstileEvent.bind(ke),Se=new ge,De=Se.postMapLoadEvent.bind(Se),Be=500,We=50;function Qe(){self.caches&&!xe&&(xe=self.caches.open("mapbox-tiles"))}function Oe(x,I,H){if(Qe(),xe){var ee={status:I.status,statusText:I.statusText,headers:new self.Headers};I.headers.forEach(function(me,we){return ee.headers.set(we,me)});var ue=z(I.headers.get("Cache-Control")||"");ue["no-store"]||(ue["max-age"]&&ee.headers.set("Expires",new Date(H+1e3*ue["max-age"]).toUTCString()),new Date(ee.headers.get("Expires")).getTime()-H<42e4||function(me,we){if(fe===void 0)try{new Response(new ReadableStream),fe=!0}catch{fe=!1}fe?we(me.body):me.blob().then(we)}(I,function(me){var we=new self.Response(me,ee);Qe(),xe&&xe.then(function(Re){return Re.put(Ue(x.url),we)}).catch(function(Re){return w(Re.message)})}))}}function Ue(x){var I=x.indexOf("?");return I<0?x:x.slice(0,I)}function Xe(x,I){if(Qe(),!xe)return I(null);var H=Ue(x.url);xe.then(function(ee){ee.match(H).then(function(ue){var me=function(we){if(!we)return!1;var Re=new Date(we.headers.get("Expires")||0),Ze=z(we.headers.get("Cache-Control")||"");return Re>Date.now()&&!Ze["no-cache"]}(ue);ee.delete(H),me&&ee.put(H,ue.clone()),I(null,ue,me)}).catch(I)}).catch(I)}var Ye,$e=1/0;function it(){return Ye==null&&(Ye=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Ye}var ot={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ot);var Et=function(x){function I(H,ee,ue){ee===401&&de(ue)&&(H+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),x.call(this,H),this.status=ee,this.url=ue,this.name=this.constructor.name,this.message=H}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},I}(Error),mt=P()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href};function tt(x,I){var H,ee=new self.AbortController,ue=new self.Request(x.url,{method:x.method||"GET",body:x.body,credentials:x.credentials,headers:x.headers,referrer:mt(),signal:ee.signal}),me=!1,we=!1,Re=(H=ue.url).indexOf("sku=")>0&&de(H);x.type==="json"&&ue.headers.set("Accept","application/json");var Ze=function(pt,Rt,Yt){if(!we){if(pt&&pt.message!=="SecurityError"&&w(pt),Rt&&Yt)return ct(Rt);var qt=Date.now();self.fetch(ue).then(function(rr){if(rr.ok){var fr=Re?rr.clone():null;return ct(rr,fr,qt)}return I(new Et(rr.statusText,rr.status,x.url))}).catch(function(rr){rr.code!==20&&I(new Error(rr.message))})}},ct=function(pt,Rt,Yt){(x.type==="arrayBuffer"?pt.arrayBuffer():x.type==="json"?pt.json():pt.text()).then(function(qt){we||(Rt&&Yt&&Oe(ue,Rt,Yt),me=!0,I(null,qt,pt.headers.get("Cache-Control"),pt.headers.get("Expires")))}).catch(function(qt){we||I(new Error(qt.message))})};return Re?Xe(ue,Ze):Ze(null,null),{cancel:function(){we=!0,me||ee.abort()}}}var Ke=function(x,I){if(H=x.url,!(/^file:/.test(H)||/^file:/.test(mt())&&!/^\w+:/.test(H))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return tt(x,I);if(P()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",x,I,void 0,!0)}var H;return function(ee,ue){var me=new self.XMLHttpRequest;for(var we in me.open(ee.method||"GET",ee.url,!0),ee.type==="arrayBuffer"&&(me.responseType="arraybuffer"),ee.headers)me.setRequestHeader(we,ee.headers[we]);return ee.type==="json"&&(me.responseType="text",me.setRequestHeader("Accept","application/json")),me.withCredentials=ee.credentials==="include",me.onerror=function(){ue(new Error(me.statusText))},me.onload=function(){if((me.status>=200&&me.status<300||me.status===0)&&me.response!==null){var Re=me.response;if(ee.type==="json")try{Re=JSON.parse(me.response)}catch(Ze){return ue(Ze)}ue(null,Re,me.getResponseHeader("Cache-Control"),me.getResponseHeader("Expires"))}else ue(new Et(me.statusText,me.status,ee.url))},me.send(ee.body),{cancel:function(){return me.abort()}}}(x,I)},Mt=function(x,I){return Ke(g(x,{type:"arrayBuffer"}),I)},Jt=function(x,I){return Ke(g(x,{method:"POST"}),I)},$t,je;$t=[],je=0;var Ge=function(x,I){if($.supported&&(x.headers||(x.headers={}),x.headers.accept="image/webp,*/*"),je>=G.MAX_PARALLEL_IMAGE_REQUESTS){var H={requestParameters:x,callback:I,cancelled:!1,cancel:function(){this.cancelled=!0}};return $t.push(H),H}je++;var ee=!1,ue=function(){if(!ee)for(ee=!0,je--;$t.length&&je<G.MAX_PARALLEL_IMAGE_REQUESTS;){var we=$t.shift(),Re=we.requestParameters,Ze=we.callback;we.cancelled||(we.cancel=Ge(Re,Ze).cancel)}},me=Mt(x,function(we,Re,Ze,ct){ue(),we?I(we):Re&&(it()?function(pt,Rt){var Yt=new self.Blob([new Uint8Array(pt)],{type:"image/png"});self.createImageBitmap(Yt).then(function(qt){Rt(null,qt)}).catch(function(qt){Rt(new Error("Could not load image because of "+qt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(Re,I):function(pt,Rt,Yt,qt){var rr=new self.Image,fr=self.URL;rr.onload=function(){Rt(null,rr),fr.revokeObjectURL(rr.src)},rr.onerror=function(){return Rt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Er=new self.Blob([new Uint8Array(pt)],{type:"image/png"});rr.cacheControl=Yt,rr.expires=qt,rr.src=pt.byteLength?fr.createObjectURL(Er):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(Re,I,Ze,ct))});return{cancel:function(){me.cancel(),ue()}}};function Ct(x,I,H){H[x]&&H[x].indexOf(I)!==-1||(H[x]=H[x]||[],H[x].push(I))}function Ie(x,I,H){if(H&&H[x]){var ee=H[x].indexOf(I);ee!==-1&&H[x].splice(ee,1)}}var be=function(x,I){I===void 0&&(I={}),g(this,I),this.type=x},Ae=function(x){function I(H,ee){ee===void 0&&(ee={}),x.call(this,"error",g({error:H},ee))}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I}(be),Pe=function(){};Pe.prototype.on=function(x,I){return this._listeners=this._listeners||{},Ct(x,I,this._listeners),this},Pe.prototype.off=function(x,I){return Ie(x,I,this._listeners),Ie(x,I,this._oneTimeListeners),this},Pe.prototype.once=function(x,I){return this._oneTimeListeners=this._oneTimeListeners||{},Ct(x,I,this._oneTimeListeners),this},Pe.prototype.fire=function(x,I){typeof x=="string"&&(x=new be(x,I||{}));var H=x.type;if(this.listens(H)){x.target=this;for(var ee=0,ue=this._listeners&&this._listeners[H]?this._listeners[H].slice():[];ee<ue.length;ee+=1)ue[ee].call(this,x);for(var me=0,we=this._oneTimeListeners&&this._oneTimeListeners[H]?this._oneTimeListeners[H].slice():[];me<we.length;me+=1){var Re=we[me];Ie(H,Re,this._oneTimeListeners),Re.call(this,x)}var Ze=this._eventedParent;Ze&&(g(x,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Ze.fire(x))}else x instanceof Ae&&console.error(x.error);return this},Pe.prototype.listens=function(x){return this._listeners&&this._listeners[x]&&this._listeners[x].length>0||this._oneTimeListeners&&this._oneTimeListeners[x]&&this._oneTimeListeners[x].length>0||this._eventedParent&&this._eventedParent.listens(x)},Pe.prototype.setEventedParent=function(x,I){return this._eventedParent=x,this._eventedParentData=I,this};var ze={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},qe=function(x,I,H,ee){this.message=(x?x+": ":"")+H,ee&&(this.identifier=ee),I!=null&&I.__line__&&(this.line=I.__line__)};function ht(x){var I=x.key,H=x.value;return H?[new qe(I,H,"constants have been deprecated as of v8")]:[]}function at(x){for(var I=[],H=arguments.length-1;H-- >0;)I[H]=arguments[H+1];for(var ee=0,ue=I;ee<ue.length;ee+=1){var me=ue[ee];for(var we in me)x[we]=me[we]}return x}function nt(x){return x instanceof Number||x instanceof String||x instanceof Boolean?x.valueOf():x}function xt(x){if(Array.isArray(x))return x.map(xt);if(x instanceof Object&&!(x instanceof Number||x instanceof String||x instanceof Boolean)){var I={};for(var H in x)I[H]=xt(x[H]);return I}return nt(x)}var Lt=function(x){function I(H,ee){x.call(this,ee),this.message=ee,this.key=H}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I}(Error),bt=function(x,I){I===void 0&&(I=[]),this.parent=x,this.bindings={};for(var H=0,ee=I;H<ee.length;H+=1){var ue=ee[H],me=ue[0],we=ue[1];this.bindings[me]=we}};bt.prototype.concat=function(x){return new bt(this,x)},bt.prototype.get=function(x){if(this.bindings[x])return this.bindings[x];if(this.parent)return this.parent.get(x);throw new Error(x+" not found in scope.")},bt.prototype.has=function(x){return!!this.bindings[x]||!!this.parent&&this.parent.has(x)};var St={kind:"null"},st={kind:"number"},It={kind:"string"},jt={kind:"boolean"},Ut={kind:"color"},zt={kind:"object"},Ce={kind:"value"},lt={kind:"collator"},At={kind:"formatted"},Bt={kind:"resolvedImage"};function Ht(x,I){return{kind:"array",itemType:x,N:I}}function or(x){if(x.kind==="array"){var I=or(x.itemType);return typeof x.N=="number"?"array<"+I+", "+x.N+">":x.itemType.kind==="value"?"array":"array<"+I+">"}return x.kind}var ar=[St,st,It,jt,Ut,At,zt,Ht(Ce),Bt];function Nt(x,I){if(I.kind==="error")return null;if(x.kind==="array"){if(I.kind==="array"&&(I.N===0&&I.itemType.kind==="value"||!Nt(x.itemType,I.itemType))&&(typeof x.N!="number"||x.N===I.N))return null}else{if(x.kind===I.kind)return null;if(x.kind==="value"){for(var H=0,ee=ar;H<ee.length;H+=1)if(!Nt(ee[H],I))return null}}return"Expected "+or(x)+" but found "+or(I)+" instead."}function nr(x,I){return I.some(function(H){return H.kind===x.kind})}function Lr(x,I){return I.some(function(H){return H==="null"?x===null:H==="array"?Array.isArray(x):H==="object"?x&&!Array.isArray(x)&&typeof x=="object":H===typeof x})}var dr=l(function(x,I){var H={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ee(Ze){return(Ze=Math.round(Ze))<0?0:Ze>255?255:Ze}function ue(Ze){return Ze<0?0:Ze>1?1:Ze}function me(Ze){return Ze[Ze.length-1]==="%"?ee(parseFloat(Ze)/100*255):ee(parseInt(Ze))}function we(Ze){return Ze[Ze.length-1]==="%"?ue(parseFloat(Ze)/100):ue(parseFloat(Ze))}function Re(Ze,ct,pt){return pt<0?pt+=1:pt>1&&(pt-=1),6*pt<1?Ze+(ct-Ze)*pt*6:2*pt<1?ct:3*pt<2?Ze+(ct-Ze)*(2/3-pt)*6:Ze}try{I.parseCSSColor=function(Ze){var ct,pt=Ze.replace(/ /g,"").toLowerCase();if(pt in H)return H[pt].slice();if(pt[0]==="#")return pt.length===4?(ct=parseInt(pt.substr(1),16))>=0&&ct<=4095?[(3840&ct)>>4|(3840&ct)>>8,240&ct|(240&ct)>>4,15&ct|(15&ct)<<4,1]:null:pt.length===7&&(ct=parseInt(pt.substr(1),16))>=0&&ct<=16777215?[(16711680&ct)>>16,(65280&ct)>>8,255&ct,1]:null;var Rt=pt.indexOf("("),Yt=pt.indexOf(")");if(Rt!==-1&&Yt+1===pt.length){var qt=pt.substr(0,Rt),rr=pt.substr(Rt+1,Yt-(Rt+1)).split(","),fr=1;switch(qt){case"rgba":if(rr.length!==4)return null;fr=we(rr.pop());case"rgb":return rr.length!==3?null:[me(rr[0]),me(rr[1]),me(rr[2]),fr];case"hsla":if(rr.length!==4)return null;fr=we(rr.pop());case"hsl":if(rr.length!==3)return null;var Er=(parseFloat(rr[0])%360+360)%360/360,Sr=we(rr[1]),Fr=we(rr[2]),Br=Fr<=.5?Fr*(Sr+1):Fr+Sr-Fr*Sr,Ur=2*Fr-Br;return[ee(255*Re(Ur,Br,Er+1/3)),ee(255*Re(Ur,Br,Er)),ee(255*Re(Ur,Br,Er-1/3)),fr];default:return null}}return null}}catch{}}).parseCSSColor,Kt=function(x,I,H,ee){ee===void 0&&(ee=1),this.r=x,this.g=I,this.b=H,this.a=ee};Kt.parse=function(x){if(x){if(x instanceof Kt)return x;if(typeof x=="string"){var I=dr(x);if(I)return new Kt(I[0]/255*I[3],I[1]/255*I[3],I[2]/255*I[3],I[3])}}},Kt.prototype.toString=function(){var x=this.toArray(),I=x[0],H=x[1],ee=x[2],ue=x[3];return"rgba("+Math.round(I)+","+Math.round(H)+","+Math.round(ee)+","+ue+")"},Kt.prototype.toArray=function(){var x=this.r,I=this.g,H=this.b,ee=this.a;return ee===0?[0,0,0,0]:[255*x/ee,255*I/ee,255*H/ee,ee]},Kt.black=new Kt(0,0,0,1),Kt.white=new Kt(1,1,1,1),Kt.transparent=new Kt(0,0,0,0),Kt.red=new Kt(1,0,0,1);var yr=function(x,I,H){this.sensitivity=x?I?"variant":"case":I?"accent":"base",this.locale=H,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};yr.prototype.compare=function(x,I){return this.collator.compare(x,I)},yr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var xr=function(x,I,H,ee,ue){this.text=x,this.image=I,this.scale=H,this.fontStack=ee,this.textColor=ue},gr=function(x){this.sections=x};gr.fromString=function(x){return new gr([new xr(x,null,null,null,null)])},gr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(x){return x.text.length!==0||x.image&&x.image.name.length!==0})},gr.factory=function(x){return x instanceof gr?x:gr.fromString(x)},gr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(x){return x.text}).join("")},gr.prototype.serialize=function(){for(var x=["format"],I=0,H=this.sections;I<H.length;I+=1){var ee=H[I];if(ee.image)x.push(["image",ee.image.name]);else{x.push(ee.text);var ue={};ee.fontStack&&(ue["text-font"]=["literal",ee.fontStack.split(",")]),ee.scale&&(ue["font-scale"]=ee.scale),ee.textColor&&(ue["text-color"]=["rgba"].concat(ee.textColor.toArray())),x.push(ue)}}return x};var wr=function(x){this.name=x.name,this.available=x.available};function zr(x,I,H,ee){return typeof x=="number"&&x>=0&&x<=255&&typeof I=="number"&&I>=0&&I<=255&&typeof H=="number"&&H>=0&&H<=255?ee===void 0||typeof ee=="number"&&ee>=0&&ee<=1?null:"Invalid rgba value ["+[x,I,H,ee].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof ee=="number"?[x,I,H,ee]:[x,I,H]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Rr(x){if(x===null||typeof x=="string"||typeof x=="boolean"||typeof x=="number"||x instanceof Kt||x instanceof yr||x instanceof gr||x instanceof wr)return!0;if(Array.isArray(x)){for(var I=0,H=x;I<H.length;I+=1)if(!Rr(H[I]))return!1;return!0}if(typeof x=="object"){for(var ee in x)if(!Rr(x[ee]))return!1;return!0}return!1}function Wr(x){if(x===null)return St;if(typeof x=="string")return It;if(typeof x=="boolean")return jt;if(typeof x=="number")return st;if(x instanceof Kt)return Ut;if(x instanceof yr)return lt;if(x instanceof gr)return At;if(x instanceof wr)return Bt;if(Array.isArray(x)){for(var I,H=x.length,ee=0,ue=x;ee<ue.length;ee+=1){var me=Wr(ue[ee]);if(I){if(I===me)continue;I=Ce;break}I=me}return Ht(I||Ce,H)}return zt}function gn(x){var I=typeof x;return x===null?"":I==="string"||I==="number"||I==="boolean"?String(x):x instanceof Kt||x instanceof gr||x instanceof wr?x.toString():JSON.stringify(x)}wr.prototype.toString=function(){return this.name},wr.fromString=function(x){return x?new wr({name:x,available:!1}):null},wr.prototype.serialize=function(){return["image",this.name]};var rn=function(x,I){this.type=x,this.value=I};rn.parse=function(x,I){if(x.length!==2)return I.error("'literal' expression requires exactly one argument, but found "+(x.length-1)+" instead.");if(!Rr(x[1]))return I.error("invalid value");var H=x[1],ee=Wr(H),ue=I.expectedType;return ee.kind!=="array"||ee.N!==0||!ue||ue.kind!=="array"||typeof ue.N=="number"&&ue.N!==0||(ee=ue),new rn(ee,H)},rn.prototype.evaluate=function(){return this.value},rn.prototype.eachChild=function(){},rn.prototype.outputDefined=function(){return!0},rn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Kt?["rgba"].concat(this.value.toArray()):this.value instanceof gr?this.value.serialize():this.value};var Zr=function(x){this.name="ExpressionEvaluationError",this.message=x};Zr.prototype.toJSON=function(){return this.message};var bn={string:It,number:st,boolean:jt,object:zt},Dr=function(x,I){this.type=x,this.args=I};Dr.parse=function(x,I){if(x.length<2)return I.error("Expected at least one argument.");var H,ee=1,ue=x[0];if(ue==="array"){var me,we;if(x.length>2){var Re=x[1];if(typeof Re!="string"||!(Re in bn)||Re==="object")return I.error('The item type argument of "array" must be one of string, number, boolean',1);me=bn[Re],ee++}else me=Ce;if(x.length>3){if(x[2]!==null&&(typeof x[2]!="number"||x[2]<0||x[2]!==Math.floor(x[2])))return I.error('The length argument to "array" must be a positive integer literal',2);we=x[2],ee++}H=Ht(me,we)}else H=bn[ue];for(var Ze=[];ee<x.length;ee++){var ct=I.parse(x[ee],ee,Ce);if(!ct)return null;Ze.push(ct)}return new Dr(H,Ze)},Dr.prototype.evaluate=function(x){for(var I=0;I<this.args.length;I++){var H=this.args[I].evaluate(x);if(!Nt(this.type,Wr(H)))return H;if(I===this.args.length-1)throw new Zr("Expected value to be of type "+or(this.type)+", but found "+or(Wr(H))+" instead.")}return null},Dr.prototype.eachChild=function(x){this.args.forEach(x)},Dr.prototype.outputDefined=function(){return this.args.every(function(x){return x.outputDefined()})},Dr.prototype.serialize=function(){var x=this.type,I=[x.kind];if(x.kind==="array"){var H=x.itemType;if(H.kind==="string"||H.kind==="number"||H.kind==="boolean"){I.push(H.kind);var ee=x.N;(typeof ee=="number"||this.args.length>1)&&I.push(ee)}}return I.concat(this.args.map(function(ue){return ue.serialize()}))};var br=function(x){this.type=At,this.sections=x};br.parse=function(x,I){if(x.length<2)return I.error("Expected at least one argument.");var H=x[1];if(!Array.isArray(H)&&typeof H=="object")return I.error("First argument must be an image or text section.");for(var ee=[],ue=!1,me=1;me<=x.length-1;++me){var we=x[me];if(ue&&typeof we=="object"&&!Array.isArray(we)){ue=!1;var Re=null;if(we["font-scale"]&&!(Re=I.parse(we["font-scale"],1,st)))return null;var Ze=null;if(we["text-font"]&&!(Ze=I.parse(we["text-font"],1,Ht(It))))return null;var ct=null;if(we["text-color"]&&!(ct=I.parse(we["text-color"],1,Ut)))return null;var pt=ee[ee.length-1];pt.scale=Re,pt.font=Ze,pt.textColor=ct}else{var Rt=I.parse(x[me],1,Ce);if(!Rt)return null;var Yt=Rt.type.kind;if(Yt!=="string"&&Yt!=="value"&&Yt!=="null"&&Yt!=="resolvedImage")return I.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");ue=!0,ee.push({content:Rt,scale:null,font:null,textColor:null})}}return new br(ee)},br.prototype.evaluate=function(x){return new gr(this.sections.map(function(I){var H=I.content.evaluate(x);return Wr(H)===Bt?new xr("",H,null,null,null):new xr(gn(H),null,I.scale?I.scale.evaluate(x):null,I.font?I.font.evaluate(x).join(","):null,I.textColor?I.textColor.evaluate(x):null)}))},br.prototype.eachChild=function(x){for(var I=0,H=this.sections;I<H.length;I+=1){var ee=H[I];x(ee.content),ee.scale&&x(ee.scale),ee.font&&x(ee.font),ee.textColor&&x(ee.textColor)}},br.prototype.outputDefined=function(){return!1},br.prototype.serialize=function(){for(var x=["format"],I=0,H=this.sections;I<H.length;I+=1){var ee=H[I];x.push(ee.content.serialize());var ue={};ee.scale&&(ue["font-scale"]=ee.scale.serialize()),ee.font&&(ue["text-font"]=ee.font.serialize()),ee.textColor&&(ue["text-color"]=ee.textColor.serialize()),x.push(ue)}return x};var Xr=function(x){this.type=Bt,this.input=x};Xr.parse=function(x,I){if(x.length!==2)return I.error("Expected two arguments.");var H=I.parse(x[1],1,It);return H?new Xr(H):I.error("No image name provided.")},Xr.prototype.evaluate=function(x){var I=this.input.evaluate(x),H=wr.fromString(I);return H&&x.availableImages&&(H.available=x.availableImages.indexOf(I)>-1),H},Xr.prototype.eachChild=function(x){x(this.input)},Xr.prototype.outputDefined=function(){return!1},Xr.prototype.serialize=function(){return["image",this.input.serialize()]};var fn={"to-boolean":jt,"to-color":Ut,"to-number":st,"to-string":It},Qr=function(x,I){this.type=x,this.args=I};Qr.parse=function(x,I){if(x.length<2)return I.error("Expected at least one argument.");var H=x[0];if((H==="to-boolean"||H==="to-string")&&x.length!==2)return I.error("Expected one argument.");for(var ee=fn[H],ue=[],me=1;me<x.length;me++){var we=I.parse(x[me],me,Ce);if(!we)return null;ue.push(we)}return new Qr(ee,ue)},Qr.prototype.evaluate=function(x){if(this.type.kind==="boolean")return!!this.args[0].evaluate(x);if(this.type.kind==="color"){for(var I,H,ee=0,ue=this.args;ee<ue.length;ee+=1){if(H=null,(I=ue[ee].evaluate(x))instanceof Kt)return I;if(typeof I=="string"){var me=x.parseColor(I);if(me)return me}else if(Array.isArray(I)&&!(H=I.length<3||I.length>4?"Invalid rbga value "+JSON.stringify(I)+": expected an array containing either three or four numeric values.":zr(I[0],I[1],I[2],I[3])))return new Kt(I[0]/255,I[1]/255,I[2]/255,I[3])}throw new Zr(H||"Could not parse color from value '"+(typeof I=="string"?I:String(JSON.stringify(I)))+"'")}if(this.type.kind==="number"){for(var we=null,Re=0,Ze=this.args;Re<Ze.length;Re+=1){if((we=Ze[Re].evaluate(x))===null)return 0;var ct=Number(we);if(!isNaN(ct))return ct}throw new Zr("Could not convert "+JSON.stringify(we)+" to number.")}return this.type.kind==="formatted"?gr.fromString(gn(this.args[0].evaluate(x))):this.type.kind==="resolvedImage"?wr.fromString(gn(this.args[0].evaluate(x))):gn(this.args[0].evaluate(x))},Qr.prototype.eachChild=function(x){this.args.forEach(x)},Qr.prototype.outputDefined=function(){return this.args.every(function(x){return x.outputDefined()})},Qr.prototype.serialize=function(){if(this.type.kind==="formatted")return new br([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Xr(this.args[0]).serialize();var x=["to-"+this.type.kind];return this.eachChild(function(I){x.push(I.serialize())}),x};var un=["Unknown","Point","LineString","Polygon"],Pn=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Pn.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Pn.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?un[this.feature.type]:this.feature.type:null},Pn.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Pn.prototype.canonicalID=function(){return this.canonical},Pn.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Pn.prototype.parseColor=function(x){var I=this._parseColorCache[x];return I||(I=this._parseColorCache[x]=Kt.parse(x)),I};var kn=function(x,I,H,ee){this.name=x,this.type=I,this._evaluate=H,this.args=ee};kn.prototype.evaluate=function(x){return this._evaluate(x,this.args)},kn.prototype.eachChild=function(x){this.args.forEach(x)},kn.prototype.outputDefined=function(){return!1},kn.prototype.serialize=function(){return[this.name].concat(this.args.map(function(x){return x.serialize()}))},kn.parse=function(x,I){var H,ee=x[0],ue=kn.definitions[ee];if(!ue)return I.error('Unknown expression "'+ee+'". If you wanted a literal array, use ["literal", [...]].',0);for(var me=Array.isArray(ue)?ue[0]:ue.type,we=Array.isArray(ue)?[[ue[1],ue[2]]]:ue.overloads,Re=we.filter(function(ta){var Vn=ta[0];return!Array.isArray(Vn)||Vn.length===x.length-1}),Ze=null,ct=0,pt=Re;ct<pt.length;ct+=1){var Rt=pt[ct],Yt=Rt[0],qt=Rt[1];Ze=new On(I.registry,I.path,null,I.scope);for(var rr=[],fr=!1,Er=1;Er<x.length;Er++){var Sr=x[Er],Fr=Array.isArray(Yt)?Yt[Er-1]:Yt.type,Br=Ze.parse(Sr,1+rr.length,Fr);if(!Br){fr=!0;break}rr.push(Br)}if(!fr)if(Array.isArray(Yt)&&Yt.length!==rr.length)Ze.error("Expected "+Yt.length+" arguments, but found "+rr.length+" instead.");else{for(var Ur=0;Ur<rr.length;Ur++){var nn=Array.isArray(Yt)?Yt[Ur]:Yt.type,hn=rr[Ur];Ze.concat(Ur+1).checkSubtype(nn,hn.type)}if(Ze.errors.length===0)return new kn(ee,me,qt,rr)}}if(Re.length===1)(H=I.errors).push.apply(H,Ze.errors);else{for(var Ln=(Re.length?Re:we).map(function(ta){var Vn,la=ta[0];return Vn=la,Array.isArray(Vn)?"("+Vn.map(or).join(", ")+")":"("+or(Vn.type)+"...)"}).join(" | "),En=[],Bn=1;Bn<x.length;Bn++){var ea=I.parse(x[Bn],1+En.length);if(!ea)return null;En.push(or(ea.type))}I.error("Expected arguments of type "+Ln+", but found ("+En.join(", ")+") instead.")}return null},kn.register=function(x,I){for(var H in kn.definitions=I,I)x[H]=kn};var Hn=function(x,I,H){this.type=lt,this.locale=H,this.caseSensitive=x,this.diacriticSensitive=I};Hn.parse=function(x,I){if(x.length!==2)return I.error("Expected one argument.");var H=x[1];if(typeof H!="object"||Array.isArray(H))return I.error("Collator options argument must be an object.");var ee=I.parse(H["case-sensitive"]!==void 0&&H["case-sensitive"],1,jt);if(!ee)return null;var ue=I.parse(H["diacritic-sensitive"]!==void 0&&H["diacritic-sensitive"],1,jt);if(!ue)return null;var me=null;return H.locale&&!(me=I.parse(H.locale,1,It))?null:new Hn(ee,ue,me)},Hn.prototype.evaluate=function(x){return new yr(this.caseSensitive.evaluate(x),this.diacriticSensitive.evaluate(x),this.locale?this.locale.evaluate(x):null)},Hn.prototype.eachChild=function(x){x(this.caseSensitive),x(this.diacriticSensitive),this.locale&&x(this.locale)},Hn.prototype.outputDefined=function(){return!1},Hn.prototype.serialize=function(){var x={};return x["case-sensitive"]=this.caseSensitive.serialize(),x["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(x.locale=this.locale.serialize()),["collator",x]};function aa(x,I){x[0]=Math.min(x[0],I[0]),x[1]=Math.min(x[1],I[1]),x[2]=Math.max(x[2],I[0]),x[3]=Math.max(x[3],I[1])}function gt(x,I){return!(x[0]<=I[0])&&!(x[2]>=I[2])&&!(x[1]<=I[1])&&!(x[3]>=I[3])}function Qt(x,I){var H,ee=(180+x[0])/360,ue=(H=x[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+H*Math.PI/360)))/360),me=Math.pow(2,I.z);return[Math.round(ee*me*8192),Math.round(ue*me*8192)]}function Zt(x,I,H){return I[1]>x[1]!=H[1]>x[1]&&x[0]<(H[0]-I[0])*(x[1]-I[1])/(H[1]-I[1])+I[0]}function pr(x,I){for(var H,ee,ue,me,we,Re,Ze,ct=!1,pt=0,Rt=I.length;pt<Rt;pt++)for(var Yt=I[pt],qt=0,rr=Yt.length;qt<rr-1;qt++){if(H=x,ee=Yt[qt],ue=Yt[qt+1],me=void 0,we=void 0,Re=void 0,Ze=void 0,me=H[0]-ee[0],we=H[1]-ee[1],Re=H[0]-ue[0],Ze=H[1]-ue[1],me*Ze-Re*we==0&&me*Re<=0&&we*Ze<=0)return!1;Zt(x,Yt[qt],Yt[qt+1])&&(ct=!ct)}return ct}function Mr(x,I){for(var H=0;H<I.length;H++)if(pr(x,I[H]))return!0;return!1}function Vr(x,I,H,ee){var ue=x[0]-H[0],me=x[1]-H[1],we=I[0]-H[0],Re=I[1]-H[1],Ze=ee[0]-H[0],ct=ee[1]-H[1],pt=ue*ct-Ze*me,Rt=we*ct-Ze*Re;return pt>0&&Rt<0||pt<0&&Rt>0}function kr(x,I,H){for(var ee=0,ue=H;ee<ue.length;ee+=1)for(var me=ue[ee],we=0;we<me.length-1;++we)if(Re=x,Ze=I,ct=me[we],pt=me[we+1],Rt=void 0,Yt=void 0,qt=void 0,rr=void 0,qt=[Ze[0]-Re[0],Ze[1]-Re[1]],rr=[pt[0]-ct[0],pt[1]-ct[1]],(Rt=rr)[0]*(Yt=qt)[1]-Rt[1]*Yt[0]!=0&&Vr(Re,Ze,ct,pt)&&Vr(ct,pt,Re,Ze))return!0;var Re,Ze,ct,pt,Rt,Yt,qt,rr;return!1}function ur(x,I){for(var H=0;H<x.length;++H)if(!pr(x[H],I))return!1;for(var ee=0;ee<x.length-1;++ee)if(kr(x[ee],x[ee+1],I))return!1;return!0}function Ir(x,I){for(var H=0;H<I.length;H++)if(ur(x,I[H]))return!0;return!1}function mr(x,I,H){for(var ee=[],ue=0;ue<x.length;ue++){for(var me=[],we=0;we<x[ue].length;we++){var Re=Qt(x[ue][we],H);aa(I,Re),me.push(Re)}ee.push(me)}return ee}function _r(x,I,H){for(var ee=[],ue=0;ue<x.length;ue++){var me=mr(x[ue],I,H);ee.push(me)}return ee}function Nr(x,I,H,ee){if(x[0]<H[0]||x[0]>H[2]){var ue=.5*ee,me=x[0]-H[0]>ue?-ee:H[0]-x[0]>ue?ee:0;me===0&&(me=x[0]-H[2]>ue?-ee:H[2]-x[0]>ue?ee:0),x[0]+=me}aa(I,x)}function vn(x,I,H,ee){for(var ue=8192*Math.pow(2,ee.z),me=[8192*ee.x,8192*ee.y],we=[],Re=0,Ze=x;Re<Ze.length;Re+=1)for(var ct=0,pt=Ze[Re];ct<pt.length;ct+=1){var Rt=pt[ct],Yt=[Rt.x+me[0],Rt.y+me[1]];Nr(Yt,I,H,ue),we.push(Yt)}return we}function xn(x,I,H,ee){for(var ue,me=8192*Math.pow(2,ee.z),we=[8192*ee.x,8192*ee.y],Re=[],Ze=0,ct=x;Ze<ct.length;Ze+=1){for(var pt=[],Rt=0,Yt=ct[Ze];Rt<Yt.length;Rt+=1){var qt=Yt[Rt],rr=[qt.x+we[0],qt.y+we[1]];aa(I,rr),pt.push(rr)}Re.push(pt)}if(I[2]-I[0]<=me/2){(ue=I)[0]=ue[1]=1/0,ue[2]=ue[3]=-1/0;for(var fr=0,Er=Re;fr<Er.length;fr+=1)for(var Sr=0,Fr=Er[fr];Sr<Fr.length;Sr+=1)Nr(Fr[Sr],I,H,me)}return Re}var wn=function(x,I){this.type=jt,this.geojson=x,this.geometries=I};function ln(x){if(x instanceof kn&&(x.name==="get"&&x.args.length===1||x.name==="feature-state"||x.name==="has"&&x.args.length===1||x.name==="properties"||x.name==="geometry-type"||x.name==="id"||/^filter-/.test(x.name))||x instanceof wn)return!1;var I=!0;return x.eachChild(function(H){I&&!ln(H)&&(I=!1)}),I}function zn(x){if(x instanceof kn&&x.name==="feature-state")return!1;var I=!0;return x.eachChild(function(H){I&&!zn(H)&&(I=!1)}),I}function ca(x,I){if(x instanceof kn&&I.indexOf(x.name)>=0)return!1;var H=!0;return x.eachChild(function(ee){H&&!ca(ee,I)&&(H=!1)}),H}wn.parse=function(x,I){if(x.length!==2)return I.error("'within' expression requires exactly one argument, but found "+(x.length-1)+" instead.");if(Rr(x[1])){var H=x[1];if(H.type==="FeatureCollection")for(var ee=0;ee<H.features.length;++ee){var ue=H.features[ee].geometry.type;if(ue==="Polygon"||ue==="MultiPolygon")return new wn(H,H.features[ee].geometry)}else if(H.type==="Feature"){var me=H.geometry.type;if(me==="Polygon"||me==="MultiPolygon")return new wn(H,H.geometry)}else if(H.type==="Polygon"||H.type==="MultiPolygon")return new wn(H,H)}return I.error("'within' expression requires valid geojson object that contains polygon geometry type.")},wn.prototype.evaluate=function(x){if(x.geometry()!=null&&x.canonicalID()!=null){if(x.geometryType()==="Point")return function(I,H){var ee=[1/0,1/0,-1/0,-1/0],ue=[1/0,1/0,-1/0,-1/0],me=I.canonicalID();if(H.type==="Polygon"){var we=mr(H.coordinates,ue,me),Re=vn(I.geometry(),ee,ue,me);if(!gt(ee,ue))return!1;for(var Ze=0,ct=Re;Ze<ct.length;Ze+=1)if(!pr(ct[Ze],we))return!1}if(H.type==="MultiPolygon"){var pt=_r(H.coordinates,ue,me),Rt=vn(I.geometry(),ee,ue,me);if(!gt(ee,ue))return!1;for(var Yt=0,qt=Rt;Yt<qt.length;Yt+=1)if(!Mr(qt[Yt],pt))return!1}return!0}(x,this.geometries);if(x.geometryType()==="LineString")return function(I,H){var ee=[1/0,1/0,-1/0,-1/0],ue=[1/0,1/0,-1/0,-1/0],me=I.canonicalID();if(H.type==="Polygon"){var we=mr(H.coordinates,ue,me),Re=xn(I.geometry(),ee,ue,me);if(!gt(ee,ue))return!1;for(var Ze=0,ct=Re;Ze<ct.length;Ze+=1)if(!ur(ct[Ze],we))return!1}if(H.type==="MultiPolygon"){var pt=_r(H.coordinates,ue,me),Rt=xn(I.geometry(),ee,ue,me);if(!gt(ee,ue))return!1;for(var Yt=0,qt=Rt;Yt<qt.length;Yt+=1)if(!Ir(qt[Yt],pt))return!1}return!0}(x,this.geometries)}return!1},wn.prototype.eachChild=function(){},wn.prototype.outputDefined=function(){return!0},wn.prototype.serialize=function(){return["within",this.geojson]};var Kn=function(x,I){this.type=I.type,this.name=x,this.boundExpression=I};Kn.parse=function(x,I){if(x.length!==2||typeof x[1]!="string")return I.error("'var' expression requires exactly one string literal argument.");var H=x[1];return I.scope.has(H)?new Kn(H,I.scope.get(H)):I.error('Unknown variable "'+H+'". Make sure "'+H+'" has been bound in an enclosing "let" expression before using it.',1)},Kn.prototype.evaluate=function(x){return this.boundExpression.evaluate(x)},Kn.prototype.eachChild=function(){},Kn.prototype.outputDefined=function(){return!1},Kn.prototype.serialize=function(){return["var",this.name]};var On=function(x,I,H,ee,ue){I===void 0&&(I=[]),ee===void 0&&(ee=new bt),ue===void 0&&(ue=[]),this.registry=x,this.path=I,this.key=I.map(function(me){return"["+me+"]"}).join(""),this.scope=ee,this.errors=ue,this.expectedType=H};function Nn(x,I){for(var H,ee,ue=x.length-1,me=0,we=ue,Re=0;me<=we;)if(H=x[Re=Math.floor((me+we)/2)],ee=x[Re+1],H<=I){if(Re===ue||I<ee)return Re;me=Re+1}else{if(!(H>I))throw new Zr("Input is not a number.");we=Re-1}return 0}On.prototype.parse=function(x,I,H,ee,ue){return ue===void 0&&(ue={}),I?this.concat(I,H,ee)._parse(x,ue):this._parse(x,ue)},On.prototype._parse=function(x,I){function H(ct,pt,Rt){return Rt==="assert"?new Dr(pt,[ct]):Rt==="coerce"?new Qr(pt,[ct]):ct}if(x!==null&&typeof x!="string"&&typeof x!="boolean"&&typeof x!="number"||(x=["literal",x]),Array.isArray(x)){if(x.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var ee=x[0];if(typeof ee!="string")return this.error("Expression name must be a string, but found "+typeof ee+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var ue=this.registry[ee];if(ue){var me=ue.parse(x,this);if(!me)return null;if(this.expectedType){var we=this.expectedType,Re=me.type;if(we.kind!=="string"&&we.kind!=="number"&&we.kind!=="boolean"&&we.kind!=="object"&&we.kind!=="array"||Re.kind!=="value")if(we.kind!=="color"&&we.kind!=="formatted"&&we.kind!=="resolvedImage"||Re.kind!=="value"&&Re.kind!=="string"){if(this.checkSubtype(we,Re))return null}else me=H(me,we,I.typeAnnotation||"coerce");else me=H(me,we,I.typeAnnotation||"assert")}if(!(me instanceof rn)&&me.type.kind!=="resolvedImage"&&function ct(pt){if(pt instanceof Kn)return ct(pt.boundExpression);if(pt instanceof kn&&pt.name==="error"||pt instanceof Hn||pt instanceof wn)return!1;var Rt=pt instanceof Qr||pt instanceof Dr,Yt=!0;return pt.eachChild(function(qt){Yt=Rt?Yt&&ct(qt):Yt&&qt instanceof rn}),Yt?ln(pt)&&ca(pt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}(me)){var Ze=new Pn;try{me=new rn(me.type,me.evaluate(Ze))}catch(ct){return this.error(ct.message),null}}return me}return this.error('Unknown expression "'+ee+'". If you wanted a literal array, use ["literal", [...]].',0)}return x===void 0?this.error("'undefined' value invalid. Use null instead."):typeof x=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof x+" instead.")},On.prototype.concat=function(x,I,H){var ee=typeof x=="number"?this.path.concat(x):this.path,ue=H?this.scope.concat(H):this.scope;return new On(this.registry,ee,I||null,ue,this.errors)},On.prototype.error=function(x){for(var I=[],H=arguments.length-1;H-- >0;)I[H]=arguments[H+1];var ee=""+this.key+I.map(function(ue){return"["+ue+"]"}).join("");this.errors.push(new Lt(ee,x))},On.prototype.checkSubtype=function(x,I){var H=Nt(x,I);return H&&this.error(H),H};var ba=function(x,I,H){this.type=x,this.input=I,this.labels=[],this.outputs=[];for(var ee=0,ue=H;ee<ue.length;ee+=1){var me=ue[ee],we=me[0],Re=me[1];this.labels.push(we),this.outputs.push(Re)}};function Wn(x,I,H){return x*(1-H)+I*H}ba.parse=function(x,I){if(x.length-1<4)return I.error("Expected at least 4 arguments, but found only "+(x.length-1)+".");if((x.length-1)%2!=0)return I.error("Expected an even number of arguments.");var H=I.parse(x[1],1,st);if(!H)return null;var ee=[],ue=null;I.expectedType&&I.expectedType.kind!=="value"&&(ue=I.expectedType);for(var me=1;me<x.length;me+=2){var we=me===1?-1/0:x[me],Re=x[me+1],Ze=me,ct=me+1;if(typeof we!="number")return I.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ze);if(ee.length&&ee[ee.length-1][0]>=we)return I.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Ze);var pt=I.parse(Re,ct,ue);if(!pt)return null;ue=ue||pt.type,ee.push([we,pt])}return new ba(ue,H,ee)},ba.prototype.evaluate=function(x){var I=this.labels,H=this.outputs;if(I.length===1)return H[0].evaluate(x);var ee=this.input.evaluate(x);if(ee<=I[0])return H[0].evaluate(x);var ue=I.length;return ee>=I[ue-1]?H[ue-1].evaluate(x):H[Nn(I,ee)].evaluate(x)},ba.prototype.eachChild=function(x){x(this.input);for(var I=0,H=this.outputs;I<H.length;I+=1)x(H[I])},ba.prototype.outputDefined=function(){return this.outputs.every(function(x){return x.outputDefined()})},ba.prototype.serialize=function(){for(var x=["step",this.input.serialize()],I=0;I<this.labels.length;I++)I>0&&x.push(this.labels[I]),x.push(this.outputs[I].serialize());return x};var cn=Object.freeze({__proto__:null,number:Wn,color:function(x,I,H){return new Kt(Wn(x.r,I.r,H),Wn(x.g,I.g,H),Wn(x.b,I.b,H),Wn(x.a,I.a,H))},array:function(x,I,H){return x.map(function(ee,ue){return Wn(ee,I[ue],H)})}}),$n=6/29,ua=3*$n*$n,Xa=Math.PI/180,Ci=180/Math.PI;function ri(x){return x>.008856451679035631?Math.pow(x,1/3):x/ua+4/29}function vi(x){return x>$n?x*x*x:ua*(x-4/29)}function Aa(x){return 255*(x<=.0031308?12.92*x:1.055*Math.pow(x,1/2.4)-.055)}function Na(x){return(x/=255)<=.04045?x/12.92:Math.pow((x+.055)/1.055,2.4)}function co(x){var I=Na(x.r),H=Na(x.g),ee=Na(x.b),ue=ri((.4124564*I+.3575761*H+.1804375*ee)/.95047),me=ri((.2126729*I+.7151522*H+.072175*ee)/1);return{l:116*me-16,a:500*(ue-me),b:200*(me-ri((.0193339*I+.119192*H+.9503041*ee)/1.08883)),alpha:x.a}}function Fo(x){var I=(x.l+16)/116,H=isNaN(x.a)?I:I+x.a/500,ee=isNaN(x.b)?I:I-x.b/200;return I=1*vi(I),H=.95047*vi(H),ee=1.08883*vi(ee),new Kt(Aa(3.2404542*H-1.5371385*I-.4985314*ee),Aa(-.969266*H+1.8760108*I+.041556*ee),Aa(.0556434*H-.2040259*I+1.0572252*ee),x.alpha)}function Yo(x,I,H){var ee=I-x;return x+H*(ee>180||ee<-180?ee-360*Math.round(ee/360):ee)}var Hi={forward:co,reverse:Fo,interpolate:function(x,I,H){return{l:Wn(x.l,I.l,H),a:Wn(x.a,I.a,H),b:Wn(x.b,I.b,H),alpha:Wn(x.alpha,I.alpha,H)}}},Wi={forward:function(x){var I=co(x),H=I.l,ee=I.a,ue=I.b,me=Math.atan2(ue,ee)*Ci;return{h:me<0?me+360:me,c:Math.sqrt(ee*ee+ue*ue),l:H,alpha:x.a}},reverse:function(x){var I=x.h*Xa,H=x.c;return Fo({l:x.l,a:Math.cos(I)*H,b:Math.sin(I)*H,alpha:x.alpha})},interpolate:function(x,I,H){return{h:Yo(x.h,I.h,H),c:Wn(x.c,I.c,H),l:Wn(x.l,I.l,H),alpha:Wn(x.alpha,I.alpha,H)}}},Bo=Object.freeze({__proto__:null,lab:Hi,hcl:Wi}),Va=function(x,I,H,ee,ue){this.type=x,this.operator=I,this.interpolation=H,this.input=ee,this.labels=[],this.outputs=[];for(var me=0,we=ue;me<we.length;me+=1){var Re=we[me],Ze=Re[0],ct=Re[1];this.labels.push(Ze),this.outputs.push(ct)}};function ko(x,I,H,ee){var ue=ee-H,me=x-H;return ue===0?0:I===1?me/ue:(Math.pow(I,me)-1)/(Math.pow(I,ue)-1)}Va.interpolationFactor=function(x,I,H,ee){var ue=0;if(x.name==="exponential")ue=ko(I,x.base,H,ee);else if(x.name==="linear")ue=ko(I,1,H,ee);else if(x.name==="cubic-bezier"){var me=x.controlPoints;ue=new o(me[0],me[1],me[2],me[3]).solve(ko(I,1,H,ee))}return ue},Va.parse=function(x,I){var H=x[0],ee=x[1],ue=x[2],me=x.slice(3);if(!Array.isArray(ee)||ee.length===0)return I.error("Expected an interpolation type expression.",1);if(ee[0]==="linear")ee={name:"linear"};else if(ee[0]==="exponential"){var we=ee[1];if(typeof we!="number")return I.error("Exponential interpolation requires a numeric base.",1,1);ee={name:"exponential",base:we}}else{if(ee[0]!=="cubic-bezier")return I.error("Unknown interpolation type "+String(ee[0]),1,0);var Re=ee.slice(1);if(Re.length!==4||Re.some(function(Er){return typeof Er!="number"||Er<0||Er>1}))return I.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ee={name:"cubic-bezier",controlPoints:Re}}if(x.length-1<4)return I.error("Expected at least 4 arguments, but found only "+(x.length-1)+".");if((x.length-1)%2!=0)return I.error("Expected an even number of arguments.");if(!(ue=I.parse(ue,2,st)))return null;var Ze=[],ct=null;H==="interpolate-hcl"||H==="interpolate-lab"?ct=Ut:I.expectedType&&I.expectedType.kind!=="value"&&(ct=I.expectedType);for(var pt=0;pt<me.length;pt+=2){var Rt=me[pt],Yt=me[pt+1],qt=pt+3,rr=pt+4;if(typeof Rt!="number")return I.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',qt);if(Ze.length&&Ze[Ze.length-1][0]>=Rt)return I.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',qt);var fr=I.parse(Yt,rr,ct);if(!fr)return null;ct=ct||fr.type,Ze.push([Rt,fr])}return ct.kind==="number"||ct.kind==="color"||ct.kind==="array"&&ct.itemType.kind==="number"&&typeof ct.N=="number"?new Va(ct,H,ee,ue,Ze):I.error("Type "+or(ct)+" is not interpolatable.")},Va.prototype.evaluate=function(x){var I=this.labels,H=this.outputs;if(I.length===1)return H[0].evaluate(x);var ee=this.input.evaluate(x);if(ee<=I[0])return H[0].evaluate(x);var ue=I.length;if(ee>=I[ue-1])return H[ue-1].evaluate(x);var me=Nn(I,ee),we=I[me],Re=I[me+1],Ze=Va.interpolationFactor(this.interpolation,ee,we,Re),ct=H[me].evaluate(x),pt=H[me+1].evaluate(x);return this.operator==="interpolate"?cn[this.type.kind.toLowerCase()](ct,pt,Ze):this.operator==="interpolate-hcl"?Wi.reverse(Wi.interpolate(Wi.forward(ct),Wi.forward(pt),Ze)):Hi.reverse(Hi.interpolate(Hi.forward(ct),Hi.forward(pt),Ze))},Va.prototype.eachChild=function(x){x(this.input);for(var I=0,H=this.outputs;I<H.length;I+=1)x(H[I])},Va.prototype.outputDefined=function(){return this.outputs.every(function(x){return x.outputDefined()})},Va.prototype.serialize=function(){var x;x=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var I=[this.operator,x,this.input.serialize()],H=0;H<this.labels.length;H++)I.push(this.labels[H],this.outputs[H].serialize());return I};var uo=function(x,I){this.type=x,this.args=I};uo.parse=function(x,I){if(x.length<2)return I.error("Expectected at least one argument.");var H=null,ee=I.expectedType;ee&&ee.kind!=="value"&&(H=ee);for(var ue=[],me=0,we=x.slice(1);me<we.length;me+=1){var Re=we[me],Ze=I.parse(Re,1+ue.length,H,void 0,{typeAnnotation:"omit"});if(!Ze)return null;H=H||Ze.type,ue.push(Ze)}var ct=ee&&ue.some(function(pt){return Nt(ee,pt.type)});return new uo(ct?Ce:H,ue)},uo.prototype.evaluate=function(x){for(var I,H=null,ee=0,ue=0,me=this.args;ue<me.length&&(ee++,(H=me[ue].evaluate(x))&&H instanceof wr&&!H.available&&(I||(I=H.name),H=null,ee===this.args.length&&(H=I)),H===null);ue+=1);return H},uo.prototype.eachChild=function(x){this.args.forEach(x)},uo.prototype.outputDefined=function(){return this.args.every(function(x){return x.outputDefined()})},uo.prototype.serialize=function(){var x=["coalesce"];return this.eachChild(function(I){x.push(I.serialize())}),x};var yi=function(x,I){this.type=I.type,this.bindings=[].concat(x),this.result=I};yi.prototype.evaluate=function(x){return this.result.evaluate(x)},yi.prototype.eachChild=function(x){for(var I=0,H=this.bindings;I<H.length;I+=1)x(H[I][1]);x(this.result)},yi.parse=function(x,I){if(x.length<4)return I.error("Expected at least 3 arguments, but found "+(x.length-1)+" instead.");for(var H=[],ee=1;ee<x.length-1;ee+=2){var ue=x[ee];if(typeof ue!="string")return I.error("Expected string, but found "+typeof ue+" instead.",ee);if(/[^a-zA-Z0-9_]/.test(ue))return I.error("Variable names must contain only alphanumeric characters or '_'.",ee);var me=I.parse(x[ee+1],ee+1);if(!me)return null;H.push([ue,me])}var we=I.parse(x[x.length-1],x.length-1,I.expectedType,H);return we?new yi(H,we):null},yi.prototype.outputDefined=function(){return this.result.outputDefined()},yi.prototype.serialize=function(){for(var x=["let"],I=0,H=this.bindings;I<H.length;I+=1){var ee=H[I],ue=ee[0],me=ee[1];x.push(ue,me.serialize())}return x.push(this.result.serialize()),x};var Xi=function(x,I,H){this.type=x,this.index=I,this.input=H};Xi.parse=function(x,I){if(x.length!==3)return I.error("Expected 2 arguments, but found "+(x.length-1)+" instead.");var H=I.parse(x[1],1,st),ee=I.parse(x[2],2,Ht(I.expectedType||Ce));if(!H||!ee)return null;var ue=ee.type;return new Xi(ue.itemType,H,ee)},Xi.prototype.evaluate=function(x){var I=this.index.evaluate(x),H=this.input.evaluate(x);if(I<0)throw new Zr("Array index out of bounds: "+I+" < 0.");if(I>=H.length)throw new Zr("Array index out of bounds: "+I+" > "+(H.length-1)+".");if(I!==Math.floor(I))throw new Zr("Array index must be an integer, but found "+I+" instead.");return H[I]},Xi.prototype.eachChild=function(x){x(this.index),x(this.input)},Xi.prototype.outputDefined=function(){return!1},Xi.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var fo=function(x,I){this.type=jt,this.needle=x,this.haystack=I};fo.parse=function(x,I){if(x.length!==3)return I.error("Expected 2 arguments, but found "+(x.length-1)+" instead.");var H=I.parse(x[1],1,Ce),ee=I.parse(x[2],2,Ce);return H&&ee?nr(H.type,[jt,It,st,St,Ce])?new fo(H,ee):I.error("Expected first argument to be of type boolean, string, number or null, but found "+or(H.type)+" instead"):null},fo.prototype.evaluate=function(x){var I=this.needle.evaluate(x),H=this.haystack.evaluate(x);if(!H)return!1;if(!Lr(I,["boolean","string","number","null"]))throw new Zr("Expected first argument to be of type boolean, string, number or null, but found "+or(Wr(I))+" instead.");if(!Lr(H,["string","array"]))throw new Zr("Expected second argument to be of type array or string, but found "+or(Wr(H))+" instead.");return H.indexOf(I)>=0},fo.prototype.eachChild=function(x){x(this.needle),x(this.haystack)},fo.prototype.outputDefined=function(){return!0},fo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var _o=function(x,I,H){this.type=st,this.needle=x,this.haystack=I,this.fromIndex=H};_o.parse=function(x,I){if(x.length<=2||x.length>=5)return I.error("Expected 3 or 4 arguments, but found "+(x.length-1)+" instead.");var H=I.parse(x[1],1,Ce),ee=I.parse(x[2],2,Ce);if(!H||!ee)return null;if(!nr(H.type,[jt,It,st,St,Ce]))return I.error("Expected first argument to be of type boolean, string, number or null, but found "+or(H.type)+" instead");if(x.length===4){var ue=I.parse(x[3],3,st);return ue?new _o(H,ee,ue):null}return new _o(H,ee)},_o.prototype.evaluate=function(x){var I=this.needle.evaluate(x),H=this.haystack.evaluate(x);if(!Lr(I,["boolean","string","number","null"]))throw new Zr("Expected first argument to be of type boolean, string, number or null, but found "+or(Wr(I))+" instead.");if(!Lr(H,["string","array"]))throw new Zr("Expected second argument to be of type array or string, but found "+or(Wr(H))+" instead.");if(this.fromIndex){var ee=this.fromIndex.evaluate(x);return H.indexOf(I,ee)}return H.indexOf(I)},_o.prototype.eachChild=function(x){x(this.needle),x(this.haystack),this.fromIndex&&x(this.fromIndex)},_o.prototype.outputDefined=function(){return!1},_o.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var x=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),x]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Di=function(x,I,H,ee,ue,me){this.inputType=x,this.type=I,this.input=H,this.cases=ee,this.outputs=ue,this.otherwise=me};Di.parse=function(x,I){if(x.length<5)return I.error("Expected at least 4 arguments, but found only "+(x.length-1)+".");if(x.length%2!=1)return I.error("Expected an even number of arguments.");var H,ee;I.expectedType&&I.expectedType.kind!=="value"&&(ee=I.expectedType);for(var ue={},me=[],we=2;we<x.length-1;we+=2){var Re=x[we],Ze=x[we+1];Array.isArray(Re)||(Re=[Re]);var ct=I.concat(we);if(Re.length===0)return ct.error("Expected at least one branch label.");for(var pt=0,Rt=Re;pt<Rt.length;pt+=1){var Yt=Rt[pt];if(typeof Yt!="number"&&typeof Yt!="string")return ct.error("Branch labels must be numbers or strings.");if(typeof Yt=="number"&&Math.abs(Yt)>Number.MAX_SAFE_INTEGER)return ct.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Yt=="number"&&Math.floor(Yt)!==Yt)return ct.error("Numeric branch labels must be integer values.");if(H){if(ct.checkSubtype(H,Wr(Yt)))return null}else H=Wr(Yt);if(ue[String(Yt)]!==void 0)return ct.error("Branch labels must be unique.");ue[String(Yt)]=me.length}var qt=I.parse(Ze,we,ee);if(!qt)return null;ee=ee||qt.type,me.push(qt)}var rr=I.parse(x[1],1,Ce);if(!rr)return null;var fr=I.parse(x[x.length-1],x.length-1,ee);return fr?rr.type.kind!=="value"&&I.concat(1).checkSubtype(H,rr.type)?null:new Di(H,ee,rr,ue,me,fr):null},Di.prototype.evaluate=function(x){var I=this.input.evaluate(x);return(Wr(I)===this.inputType&&this.outputs[this.cases[I]]||this.otherwise).evaluate(x)},Di.prototype.eachChild=function(x){x(this.input),this.outputs.forEach(x),x(this.otherwise)},Di.prototype.outputDefined=function(){return this.outputs.every(function(x){return x.outputDefined()})&&this.otherwise.outputDefined()},Di.prototype.serialize=function(){for(var x=this,I=["match",this.input.serialize()],H=[],ee={},ue=0,me=Object.keys(this.cases).sort();ue<me.length;ue+=1){var we=me[ue];(Rt=ee[this.cases[we]])===void 0?(ee[this.cases[we]]=H.length,H.push([this.cases[we],[we]])):H[Rt][1].push(we)}for(var Re=function(qt){return x.inputType.kind==="number"?Number(qt):qt},Ze=0,ct=H;Ze<ct.length;Ze+=1){var pt=ct[Ze],Rt=pt[0],Yt=pt[1];Yt.length===1?I.push(Re(Yt[0])):I.push(Yt.map(Re)),I.push(this.outputs[outputIndex$1].serialize())}return I.push(this.otherwise.serialize()),I};var ui=function(x,I,H){this.type=x,this.branches=I,this.otherwise=H};ui.parse=function(x,I){if(x.length<4)return I.error("Expected at least 3 arguments, but found only "+(x.length-1)+".");if(x.length%2!=0)return I.error("Expected an odd number of arguments.");var H;I.expectedType&&I.expectedType.kind!=="value"&&(H=I.expectedType);for(var ee=[],ue=1;ue<x.length-1;ue+=2){var me=I.parse(x[ue],ue,jt);if(!me)return null;var we=I.parse(x[ue+1],ue+1,H);if(!we)return null;ee.push([me,we]),H=H||we.type}var Re=I.parse(x[x.length-1],x.length-1,H);return Re?new ui(H,ee,Re):null},ui.prototype.evaluate=function(x){for(var I=0,H=this.branches;I<H.length;I+=1){var ee=H[I],ue=ee[0],me=ee[1];if(ue.evaluate(x))return me.evaluate(x)}return this.otherwise.evaluate(x)},ui.prototype.eachChild=function(x){for(var I=0,H=this.branches;I<H.length;I+=1){var ee=H[I],ue=ee[0],me=ee[1];x(ue),x(me)}x(this.otherwise)},ui.prototype.outputDefined=function(){return this.branches.every(function(x){return x[0],x[1].outputDefined()})&&this.otherwise.outputDefined()},ui.prototype.serialize=function(){var x=["case"];return this.eachChild(function(I){x.push(I.serialize())}),x};var Gi=function(x,I,H,ee){this.type=x,this.input=I,this.beginIndex=H,this.endIndex=ee};function ms(x,I){return x==="=="||x==="!="?I.kind==="boolean"||I.kind==="string"||I.kind==="number"||I.kind==="null"||I.kind==="value":I.kind==="string"||I.kind==="number"||I.kind==="value"}function bs(x,I,H,ee){return ee.compare(I,H)===0}function qa(x,I,H){var ee=x!=="=="&&x!=="!=";return function(){function ue(me,we,Re){this.type=jt,this.lhs=me,this.rhs=we,this.collator=Re,this.hasUntypedArgument=me.type.kind==="value"||we.type.kind==="value"}return ue.parse=function(me,we){if(me.length!==3&&me.length!==4)return we.error("Expected two or three arguments.");var Re=me[0],Ze=we.parse(me[1],1,Ce);if(!Ze)return null;if(!ms(Re,Ze.type))return we.concat(1).error('"'+Re+`" comparisons are not supported for type '`+or(Ze.type)+"'.");var ct=we.parse(me[2],2,Ce);if(!ct)return null;if(!ms(Re,ct.type))return we.concat(2).error('"'+Re+`" comparisons are not supported for type '`+or(ct.type)+"'.");if(Ze.type.kind!==ct.type.kind&&Ze.type.kind!=="value"&&ct.type.kind!=="value")return we.error("Cannot compare types '"+or(Ze.type)+"' and '"+or(ct.type)+"'.");ee&&(Ze.type.kind==="value"&&ct.type.kind!=="value"?Ze=new Dr(ct.type,[Ze]):Ze.type.kind!=="value"&&ct.type.kind==="value"&&(ct=new Dr(Ze.type,[ct])));var pt=null;if(me.length===4){if(Ze.type.kind!=="string"&&ct.type.kind!=="string"&&Ze.type.kind!=="value"&&ct.type.kind!=="value")return we.error("Cannot use collator to compare non-string types.");if(!(pt=we.parse(me[3],3,lt)))return null}return new ue(Ze,ct,pt)},ue.prototype.evaluate=function(me){var we=this.lhs.evaluate(me),Re=this.rhs.evaluate(me);if(ee&&this.hasUntypedArgument){var Ze=Wr(we),ct=Wr(Re);if(Ze.kind!==ct.kind||Ze.kind!=="string"&&Ze.kind!=="number")throw new Zr('Expected arguments for "'+x+'" to be (string, string) or (number, number), but found ('+Ze.kind+", "+ct.kind+") instead.")}if(this.collator&&!ee&&this.hasUntypedArgument){var pt=Wr(we),Rt=Wr(Re);if(pt.kind!=="string"||Rt.kind!=="string")return I(me,we,Re)}return this.collator?H(me,we,Re,this.collator.evaluate(me)):I(me,we,Re)},ue.prototype.eachChild=function(me){me(this.lhs),me(this.rhs),this.collator&&me(this.collator)},ue.prototype.outputDefined=function(){return!0},ue.prototype.serialize=function(){var me=[x];return this.eachChild(function(we){me.push(we.serialize())}),me},ue}()}Gi.parse=function(x,I){if(x.length<=2||x.length>=5)return I.error("Expected 3 or 4 arguments, but found "+(x.length-1)+" instead.");var H=I.parse(x[1],1,Ce),ee=I.parse(x[2],2,st);if(!H||!ee)return null;if(!nr(H.type,[Ht(Ce),It,Ce]))return I.error("Expected first argument to be of type array or string, but found "+or(H.type)+" instead");if(x.length===4){var ue=I.parse(x[3],3,st);return ue?new Gi(H.type,H,ee,ue):null}return new Gi(H.type,H,ee)},Gi.prototype.evaluate=function(x){var I=this.input.evaluate(x),H=this.beginIndex.evaluate(x);if(!Lr(I,["string","array"]))throw new Zr("Expected first argument to be of type array or string, but found "+or(Wr(I))+" instead.");if(this.endIndex){var ee=this.endIndex.evaluate(x);return I.slice(H,ee)}return I.slice(H)},Gi.prototype.eachChild=function(x){x(this.input),x(this.beginIndex),this.endIndex&&x(this.endIndex)},Gi.prototype.outputDefined=function(){return!1},Gi.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var x=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),x]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var us=qa("==",function(x,I,H){return I===H},bs),Ko=qa("!=",function(x,I,H){return I!==H},function(x,I,H,ee){return!bs(0,I,H,ee)}),_s=qa("<",function(x,I,H){return I<H},function(x,I,H,ee){return ee.compare(I,H)<0}),ws=qa(">",function(x,I,H){return I>H},function(x,I,H,ee){return ee.compare(I,H)>0}),vs=qa("<=",function(x,I,H){return I<=H},function(x,I,H,ee){return ee.compare(I,H)<=0}),Ts=qa(">=",function(x,I,H){return I>=H},function(x,I,H,ee){return ee.compare(I,H)>=0}),Mo=function(x,I,H,ee,ue){this.type=It,this.number=x,this.locale=I,this.currency=H,this.minFractionDigits=ee,this.maxFractionDigits=ue};Mo.parse=function(x,I){if(x.length!==3)return I.error("Expected two arguments.");var H=I.parse(x[1],1,st);if(!H)return null;var ee=x[2];if(typeof ee!="object"||Array.isArray(ee))return I.error("NumberFormat options argument must be an object.");var ue=null;if(ee.locale&&!(ue=I.parse(ee.locale,1,It)))return null;var me=null;if(ee.currency&&!(me=I.parse(ee.currency,1,It)))return null;var we=null;if(ee["min-fraction-digits"]&&!(we=I.parse(ee["min-fraction-digits"],1,st)))return null;var Re=null;return ee["max-fraction-digits"]&&!(Re=I.parse(ee["max-fraction-digits"],1,st))?null:new Mo(H,ue,me,we,Re)},Mo.prototype.evaluate=function(x){return new Intl.NumberFormat(this.locale?this.locale.evaluate(x):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(x):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(x):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(x):void 0}).format(this.number.evaluate(x))},Mo.prototype.eachChild=function(x){x(this.number),this.locale&&x(this.locale),this.currency&&x(this.currency),this.minFractionDigits&&x(this.minFractionDigits),this.maxFractionDigits&&x(this.maxFractionDigits)},Mo.prototype.outputDefined=function(){return!1},Mo.prototype.serialize=function(){var x={};return this.locale&&(x.locale=this.locale.serialize()),this.currency&&(x.currency=this.currency.serialize()),this.minFractionDigits&&(x["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(x["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),x]};var Ao=function(x){this.type=st,this.input=x};Ao.parse=function(x,I){if(x.length!==2)return I.error("Expected 1 argument, but found "+(x.length-1)+" instead.");var H=I.parse(x[1],1);return H?H.type.kind!=="array"&&H.type.kind!=="string"&&H.type.kind!=="value"?I.error("Expected argument of type string or array, but found "+or(H.type)+" instead."):new Ao(H):null},Ao.prototype.evaluate=function(x){var I=this.input.evaluate(x);if(typeof I=="string"||Array.isArray(I))return I.length;throw new Zr("Expected value to be of type string or array, but found "+or(Wr(I))+" instead.")},Ao.prototype.eachChild=function(x){x(this.input)},Ao.prototype.outputDefined=function(){return!1},Ao.prototype.serialize=function(){var x=["length"];return this.eachChild(function(I){x.push(I.serialize())}),x};var No={"==":us,"!=":Ko,">":ws,"<":_s,">=":Ts,"<=":vs,array:Dr,at:Xi,boolean:Dr,case:ui,coalesce:uo,collator:Hn,format:br,image:Xr,in:fo,"index-of":_o,interpolate:Va,"interpolate-hcl":Va,"interpolate-lab":Va,length:Ao,let:yi,literal:rn,match:Di,number:Dr,"number-format":Mo,object:Dr,slice:Gi,step:ba,string:Dr,"to-boolean":Qr,"to-color":Qr,"to-number":Qr,"to-string":Qr,var:Kn,within:wn};function jo(x,I){var H=I[0],ee=I[1],ue=I[2],me=I[3];H=H.evaluate(x),ee=ee.evaluate(x),ue=ue.evaluate(x);var we=me?me.evaluate(x):1,Re=zr(H,ee,ue,we);if(Re)throw new Zr(Re);return new Kt(H/255*we,ee/255*we,ue/255*we,we)}function Uo(x,I){return x in I}function Qo(x,I){var H=I[x];return H===void 0?null:H}function ho(x){return{type:x}}function fs(x){return{result:"success",value:x}}function oo(x){return{result:"error",value:x}}function Vo(x){return x["property-type"]==="data-driven"||x["property-type"]==="cross-faded-data-driven"}function hs(x){return!!x.expression&&x.expression.parameters.indexOf("zoom")>-1}function So(x){return!!x.expression&&x.expression.interpolated}function ja(x){return x instanceof Number?"number":x instanceof String?"string":x instanceof Boolean?"boolean":Array.isArray(x)?"array":x===null?"null":typeof x}function Fe(x){return typeof x=="object"&&x!==null&&!Array.isArray(x)}function Ve(x){return x}function Je(x,I,H){return x!==void 0?x:I!==void 0?I:H!==void 0?H:void 0}function rt(x,I,H,ee,ue){return Je(typeof H===ue?ee[H]:void 0,x.default,I.default)}function dt(x,I,H){if(ja(H)!=="number")return Je(x.default,I.default);var ee=x.stops.length;if(ee===1||H<=x.stops[0][0])return x.stops[0][1];if(H>=x.stops[ee-1][0])return x.stops[ee-1][1];var ue=Nn(x.stops.map(function(me){return me[0]}),H);return x.stops[ue][1]}function ft(x,I,H){var ee=x.base!==void 0?x.base:1;if(ja(H)!=="number")return Je(x.default,I.default);var ue=x.stops.length;if(ue===1||H<=x.stops[0][0])return x.stops[0][1];if(H>=x.stops[ue-1][0])return x.stops[ue-1][1];var me=Nn(x.stops.map(function(Rt){return Rt[0]}),H),we=function(Rt,Yt,qt,rr){var fr=rr-qt,Er=Rt-qt;return fr===0?0:Yt===1?Er/fr:(Math.pow(Yt,Er)-1)/(Math.pow(Yt,fr)-1)}(H,ee,x.stops[me][0],x.stops[me+1][0]),Re=x.stops[me][1],Ze=x.stops[me+1][1],ct=cn[I.type]||Ve;if(x.colorSpace&&x.colorSpace!=="rgb"){var pt=Bo[x.colorSpace];ct=function(Rt,Yt){return pt.reverse(pt.interpolate(pt.forward(Rt),pt.forward(Yt),we))}}return typeof Re.evaluate=="function"?{evaluate:function(){for(var Rt=[],Yt=arguments.length;Yt--;)Rt[Yt]=arguments[Yt];var qt=Re.evaluate.apply(void 0,Rt),rr=Ze.evaluate.apply(void 0,Rt);if(qt!==void 0&&rr!==void 0)return ct(qt,rr,we)}}:ct(Re,Ze,we)}function Tt(x,I,H){return I.type==="color"?H=Kt.parse(H):I.type==="formatted"?H=gr.fromString(H.toString()):I.type==="resolvedImage"?H=wr.fromString(H.toString()):ja(H)===I.type||I.type==="enum"&&I.values[H]||(H=void 0),Je(H,x.default,I.default)}kn.register(No,{error:[{kind:"error"},[It],function(x,I){var H=I[0];throw new Zr(H.evaluate(x))}],typeof:[It,[Ce],function(x,I){return or(Wr(I[0].evaluate(x)))}],"to-rgba":[Ht(st,4),[Ut],function(x,I){return I[0].evaluate(x).toArray()}],rgb:[Ut,[st,st,st],jo],rgba:[Ut,[st,st,st,st],jo],has:{type:jt,overloads:[[[It],function(x,I){return Uo(I[0].evaluate(x),x.properties())}],[[It,zt],function(x,I){var H=I[0],ee=I[1];return Uo(H.evaluate(x),ee.evaluate(x))}]]},get:{type:Ce,overloads:[[[It],function(x,I){return Qo(I[0].evaluate(x),x.properties())}],[[It,zt],function(x,I){var H=I[0],ee=I[1];return Qo(H.evaluate(x),ee.evaluate(x))}]]},"feature-state":[Ce,[It],function(x,I){return Qo(I[0].evaluate(x),x.featureState||{})}],properties:[zt,[],function(x){return x.properties()}],"geometry-type":[It,[],function(x){return x.geometryType()}],id:[Ce,[],function(x){return x.id()}],zoom:[st,[],function(x){return x.globals.zoom}],"heatmap-density":[st,[],function(x){return x.globals.heatmapDensity||0}],"line-progress":[st,[],function(x){return x.globals.lineProgress||0}],accumulated:[Ce,[],function(x){return x.globals.accumulated===void 0?null:x.globals.accumulated}],"+":[st,ho(st),function(x,I){for(var H=0,ee=0,ue=I;ee<ue.length;ee+=1)H+=ue[ee].evaluate(x);return H}],"*":[st,ho(st),function(x,I){for(var H=1,ee=0,ue=I;ee<ue.length;ee+=1)H*=ue[ee].evaluate(x);return H}],"-":{type:st,overloads:[[[st,st],function(x,I){var H=I[0],ee=I[1];return H.evaluate(x)-ee.evaluate(x)}],[[st],function(x,I){return-I[0].evaluate(x)}]]},"/":[st,[st,st],function(x,I){var H=I[0],ee=I[1];return H.evaluate(x)/ee.evaluate(x)}],"%":[st,[st,st],function(x,I){var H=I[0],ee=I[1];return H.evaluate(x)%ee.evaluate(x)}],ln2:[st,[],function(){return Math.LN2}],pi:[st,[],function(){return Math.PI}],e:[st,[],function(){return Math.E}],"^":[st,[st,st],function(x,I){var H=I[0],ee=I[1];return Math.pow(H.evaluate(x),ee.evaluate(x))}],sqrt:[st,[st],function(x,I){var H=I[0];return Math.sqrt(H.evaluate(x))}],log10:[st,[st],function(x,I){var H=I[0];return Math.log(H.evaluate(x))/Math.LN10}],ln:[st,[st],function(x,I){var H=I[0];return Math.log(H.evaluate(x))}],log2:[st,[st],function(x,I){var H=I[0];return Math.log(H.evaluate(x))/Math.LN2}],sin:[st,[st],function(x,I){var H=I[0];return Math.sin(H.evaluate(x))}],cos:[st,[st],function(x,I){var H=I[0];return Math.cos(H.evaluate(x))}],tan:[st,[st],function(x,I){var H=I[0];return Math.tan(H.evaluate(x))}],asin:[st,[st],function(x,I){var H=I[0];return Math.asin(H.evaluate(x))}],acos:[st,[st],function(x,I){var H=I[0];return Math.acos(H.evaluate(x))}],atan:[st,[st],function(x,I){var H=I[0];return Math.atan(H.evaluate(x))}],min:[st,ho(st),function(x,I){return Math.min.apply(Math,I.map(function(H){return H.evaluate(x)}))}],max:[st,ho(st),function(x,I){return Math.max.apply(Math,I.map(function(H){return H.evaluate(x)}))}],abs:[st,[st],function(x,I){var H=I[0];return Math.abs(H.evaluate(x))}],round:[st,[st],function(x,I){var H=I[0].evaluate(x);return H<0?-Math.round(-H):Math.round(H)}],floor:[st,[st],function(x,I){var H=I[0];return Math.floor(H.evaluate(x))}],ceil:[st,[st],function(x,I){var H=I[0];return Math.ceil(H.evaluate(x))}],"filter-==":[jt,[It,Ce],function(x,I){var H=I[0],ee=I[1];return x.properties()[H.value]===ee.value}],"filter-id-==":[jt,[Ce],function(x,I){var H=I[0];return x.id()===H.value}],"filter-type-==":[jt,[It],function(x,I){var H=I[0];return x.geometryType()===H.value}],"filter-<":[jt,[It,Ce],function(x,I){var H=I[0],ee=I[1],ue=x.properties()[H.value],me=ee.value;return typeof ue==typeof me&&ue<me}],"filter-id-<":[jt,[Ce],function(x,I){var H=I[0],ee=x.id(),ue=H.value;return typeof ee==typeof ue&&ee<ue}],"filter->":[jt,[It,Ce],function(x,I){var H=I[0],ee=I[1],ue=x.properties()[H.value],me=ee.value;return typeof ue==typeof me&&ue>me}],"filter-id->":[jt,[Ce],function(x,I){var H=I[0],ee=x.id(),ue=H.value;return typeof ee==typeof ue&&ee>ue}],"filter-<=":[jt,[It,Ce],function(x,I){var H=I[0],ee=I[1],ue=x.properties()[H.value],me=ee.value;return typeof ue==typeof me&&ue<=me}],"filter-id-<=":[jt,[Ce],function(x,I){var H=I[0],ee=x.id(),ue=H.value;return typeof ee==typeof ue&&ee<=ue}],"filter->=":[jt,[It,Ce],function(x,I){var H=I[0],ee=I[1],ue=x.properties()[H.value],me=ee.value;return typeof ue==typeof me&&ue>=me}],"filter-id->=":[jt,[Ce],function(x,I){var H=I[0],ee=x.id(),ue=H.value;return typeof ee==typeof ue&&ee>=ue}],"filter-has":[jt,[Ce],function(x,I){return I[0].value in x.properties()}],"filter-has-id":[jt,[],function(x){return x.id()!==null&&x.id()!==void 0}],"filter-type-in":[jt,[Ht(It)],function(x,I){return I[0].value.indexOf(x.geometryType())>=0}],"filter-id-in":[jt,[Ht(Ce)],function(x,I){return I[0].value.indexOf(x.id())>=0}],"filter-in-small":[jt,[It,Ht(Ce)],function(x,I){var H=I[0];return I[1].value.indexOf(x.properties()[H.value])>=0}],"filter-in-large":[jt,[It,Ht(Ce)],function(x,I){var H=I[0],ee=I[1];return function(ue,me,we,Re){for(;we<=Re;){var Ze=we+Re>>1;if(me[Ze]===ue)return!0;me[Ze]>ue?Re=Ze-1:we=Ze+1}return!1}(x.properties()[H.value],ee.value,0,ee.value.length-1)}],all:{type:jt,overloads:[[[jt,jt],function(x,I){var H=I[0],ee=I[1];return H.evaluate(x)&&ee.evaluate(x)}],[ho(jt),function(x,I){for(var H=0,ee=I;H<ee.length;H+=1)if(!ee[H].evaluate(x))return!1;return!0}]]},any:{type:jt,overloads:[[[jt,jt],function(x,I){var H=I[0],ee=I[1];return H.evaluate(x)||ee.evaluate(x)}],[ho(jt),function(x,I){for(var H=0,ee=I;H<ee.length;H+=1)if(ee[H].evaluate(x))return!0;return!1}]]},"!":[jt,[jt],function(x,I){return!I[0].evaluate(x)}],"is-supported-script":[jt,[It],function(x,I){var H=I[0],ee=x.globals&&x.globals.isSupportedScript;return!ee||ee(H.evaluate(x))}],upcase:[It,[It],function(x,I){return I[0].evaluate(x).toUpperCase()}],downcase:[It,[It],function(x,I){return I[0].evaluate(x).toLowerCase()}],concat:[It,ho(Ce),function(x,I){return I.map(function(H){return gn(H.evaluate(x))}).join("")}],"resolved-locale":[It,[lt],function(x,I){return I[0].evaluate(x).resolvedLocale()}]});var Wt=function(x,I){this.expression=x,this._warningHistory={},this._evaluator=new Pn,this._defaultValue=I?function(H){return H.type==="color"&&Fe(H.default)?new Kt(0,0,0,0):H.type==="color"?Kt.parse(H.default)||null:H.default===void 0?null:H.default}(I):null,this._enumValues=I&&I.type==="enum"?I.values:null};function Xt(x){return Array.isArray(x)&&x.length>0&&typeof x[0]=="string"&&x[0]in No}function Gt(x,I){var H=new On(No,[],I?function(ue){var me={color:Ut,string:It,number:st,enum:It,boolean:jt,formatted:At,resolvedImage:Bt};return ue.type==="array"?Ht(me[ue.value]||Ce,ue.length):me[ue.type]}(I):void 0),ee=H.parse(x,void 0,void 0,void 0,I&&I.type==="string"?{typeAnnotation:"coerce"}:void 0);return ee?fs(new Wt(ee,I)):oo(H.errors)}Wt.prototype.evaluateWithoutErrorHandling=function(x,I,H,ee,ue,me){return this._evaluator.globals=x,this._evaluator.feature=I,this._evaluator.featureState=H,this._evaluator.canonical=ee,this._evaluator.availableImages=ue||null,this._evaluator.formattedSection=me,this.expression.evaluate(this._evaluator)},Wt.prototype.evaluate=function(x,I,H,ee,ue,me){this._evaluator.globals=x,this._evaluator.feature=I||null,this._evaluator.featureState=H||null,this._evaluator.canonical=ee,this._evaluator.availableImages=ue||null,this._evaluator.formattedSection=me||null;try{var we=this.expression.evaluate(this._evaluator);if(we==null||typeof we=="number"&&we!=we)return this._defaultValue;if(this._enumValues&&!(we in this._enumValues))throw new Zr("Expected value to be one of "+Object.keys(this._enumValues).map(function(Re){return JSON.stringify(Re)}).join(", ")+", but found "+JSON.stringify(we)+" instead.");return we}catch(Re){return this._warningHistory[Re.message]||(this._warningHistory[Re.message]=!0,typeof console<"u"&&console.warn(Re.message)),this._defaultValue}};var tr=function(x,I){this.kind=x,this._styleExpression=I,this.isStateDependent=x!=="constant"&&!zn(I.expression)};tr.prototype.evaluateWithoutErrorHandling=function(x,I,H,ee,ue,me){return this._styleExpression.evaluateWithoutErrorHandling(x,I,H,ee,ue,me)},tr.prototype.evaluate=function(x,I,H,ee,ue,me){return this._styleExpression.evaluate(x,I,H,ee,ue,me)};var lr=function(x,I,H,ee){this.kind=x,this.zoomStops=H,this._styleExpression=I,this.isStateDependent=x!=="camera"&&!zn(I.expression),this.interpolationType=ee};function hr(x,I){if((x=Gt(x,I)).result==="error")return x;var H=x.value.expression,ee=ln(H);if(!ee&&!Vo(I))return oo([new Lt("","data expressions not supported")]);var ue=ca(H,["zoom"]);if(!ue&&!hs(I))return oo([new Lt("","zoom expressions not supported")]);var me=function Re(Ze){var ct=null;if(Ze instanceof yi)ct=Re(Ze.result);else if(Ze instanceof uo)for(var pt=0,Rt=Ze.args;pt<Rt.length;pt+=1){var Yt=Rt[pt];if(ct=Re(Yt))break}else(Ze instanceof ba||Ze instanceof Va)&&Ze.input instanceof kn&&Ze.input.name==="zoom"&&(ct=Ze);return ct instanceof Lt||Ze.eachChild(function(qt){var rr=Re(qt);rr instanceof Lt?ct=rr:!ct&&rr?ct=new Lt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):ct&&rr&&ct!==rr&&(ct=new Lt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),ct}(H);if(!me&&!ue)return oo([new Lt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(me instanceof Lt)return oo([me]);if(me instanceof Va&&!So(I))return oo([new Lt("",'"interpolate" expressions cannot be used with this property')]);if(!me)return fs(new tr(ee?"constant":"source",x.value));var we=me instanceof Va?me.interpolation:void 0;return fs(new lr(ee?"camera":"composite",x.value,me.labels,we))}lr.prototype.evaluateWithoutErrorHandling=function(x,I,H,ee,ue,me){return this._styleExpression.evaluateWithoutErrorHandling(x,I,H,ee,ue,me)},lr.prototype.evaluate=function(x,I,H,ee,ue,me){return this._styleExpression.evaluate(x,I,H,ee,ue,me)},lr.prototype.interpolationFactor=function(x,I,H){return this.interpolationType?Va.interpolationFactor(this.interpolationType,x,I,H):0};var vr=function(x,I){this._parameters=x,this._specification=I,at(this,function H(ee,ue){var me,we,Re,Ze=ue.type==="color",ct=ee.stops&&typeof ee.stops[0][0]=="object",pt=ct||ee.property!==void 0,Rt=ct||!pt,Yt=ee.type||(So(ue)?"exponential":"interval");if(Ze&&((ee=at({},ee)).stops&&(ee.stops=ee.stops.map(function(ta){return[ta[0],Kt.parse(ta[1])]})),ee.default?ee.default=Kt.parse(ee.default):ee.default=Kt.parse(ue.default)),ee.colorSpace&&ee.colorSpace!=="rgb"&&!Bo[ee.colorSpace])throw new Error("Unknown color space: "+ee.colorSpace);if(Yt==="exponential")me=ft;else if(Yt==="interval")me=dt;else if(Yt==="categorical"){me=rt,we=Object.create(null);for(var qt=0,rr=ee.stops;qt<rr.length;qt+=1){var fr=rr[qt];we[fr[0]]=fr[1]}Re=typeof ee.stops[0][0]}else{if(Yt!=="identity")throw new Error('Unknown function type "'+Yt+'"');me=Tt}if(ct){for(var Er={},Sr=[],Fr=0;Fr<ee.stops.length;Fr++){var Br=ee.stops[Fr],Ur=Br[0].zoom;Er[Ur]===void 0&&(Er[Ur]={zoom:Ur,type:ee.type,property:ee.property,default:ee.default,stops:[]},Sr.push(Ur)),Er[Ur].stops.push([Br[0].value,Br[1]])}for(var nn=[],hn=0,Ln=Sr;hn<Ln.length;hn+=1){var En=Ln[hn];nn.push([Er[En].zoom,H(Er[En],ue)])}var Bn={name:"linear"};return{kind:"composite",interpolationType:Bn,interpolationFactor:Va.interpolationFactor.bind(void 0,Bn),zoomStops:nn.map(function(ta){return ta[0]}),evaluate:function(ta,Vn){var la=ta.zoom;return ft({stops:nn,base:ee.base},ue,la).evaluate(la,Vn)}}}if(Rt){var ea=Yt==="exponential"?{name:"exponential",base:ee.base!==void 0?ee.base:1}:null;return{kind:"camera",interpolationType:ea,interpolationFactor:Va.interpolationFactor.bind(void 0,ea),zoomStops:ee.stops.map(function(ta){return ta[0]}),evaluate:function(ta){var Vn=ta.zoom;return me(ee,ue,Vn,we,Re)}}}return{kind:"source",evaluate:function(ta,Vn){var la=Vn&&Vn.properties?Vn.properties[ee.property]:void 0;return la===void 0?Je(ee.default,ue.default):me(ee,ue,la,we,Re)}}}(this._parameters,this._specification))};function Pr(x){var I=x.key,H=x.value,ee=x.valueSpec||{},ue=x.objectElementValidators||{},me=x.style,we=x.styleSpec,Re=[],Ze=ja(H);if(Ze!=="object")return[new qe(I,H,"object expected, "+Ze+" found")];for(var ct in H){var pt=ct.split(".")[0],Rt=ee[pt]||ee["*"],Yt=void 0;if(ue[pt])Yt=ue[pt];else if(ee[pt])Yt=ir;else if(ue["*"])Yt=ue["*"];else{if(!ee["*"]){Re.push(new qe(I,H[ct],'unknown property "'+ct+'"'));continue}Yt=ir}Re=Re.concat(Yt({key:(I&&I+".")+ct,value:H[ct],valueSpec:Rt,style:me,styleSpec:we,object:H,objectKey:ct},H))}for(var qt in ee)ue[qt]||ee[qt].required&&ee[qt].default===void 0&&H[qt]===void 0&&Re.push(new qe(I,H,'missing required property "'+qt+'"'));return Re}function Jr(x){var I=x.value,H=x.valueSpec,ee=x.style,ue=x.styleSpec,me=x.key,we=x.arrayElementValidator||ir;if(ja(I)!=="array")return[new qe(me,I,"array expected, "+ja(I)+" found")];if(H.length&&I.length!==H.length)return[new qe(me,I,"array length "+H.length+" expected, length "+I.length+" found")];if(H["min-length"]&&I.length<H["min-length"])return[new qe(me,I,"array length at least "+H["min-length"]+" expected, length "+I.length+" found")];var Re={type:H.value,values:H.values};ue.$version<7&&(Re.function=H.function),ja(H.value)==="object"&&(Re=H.value);for(var Ze=[],ct=0;ct<I.length;ct++)Ze=Ze.concat(we({array:I,arrayIndex:ct,value:I[ct],valueSpec:Re,style:ee,styleSpec:ue,key:me+"["+ct+"]"}));return Ze}function on(x){var I=x.key,H=x.value,ee=x.valueSpec,ue=ja(H);return ue==="number"&&H!=H&&(ue="NaN"),ue!=="number"?[new qe(I,H,"number expected, "+ue+" found")]:"minimum"in ee&&H<ee.minimum?[new qe(I,H,H+" is less than the minimum value "+ee.minimum)]:"maximum"in ee&&H>ee.maximum?[new qe(I,H,H+" is greater than the maximum value "+ee.maximum)]:[]}function _n(x){var I,H,ee,ue=x.valueSpec,me=nt(x.value.type),we={},Re=me!=="categorical"&&x.value.property===void 0,Ze=!Re,ct=ja(x.value.stops)==="array"&&ja(x.value.stops[0])==="array"&&ja(x.value.stops[0][0])==="object",pt=Pr({key:x.key,value:x.value,valueSpec:x.styleSpec.function,style:x.style,styleSpec:x.styleSpec,objectElementValidators:{stops:function(qt){if(me==="identity")return[new qe(qt.key,qt.value,'identity function may not have a "stops" property')];var rr=[],fr=qt.value;return rr=rr.concat(Jr({key:qt.key,value:fr,valueSpec:qt.valueSpec,style:qt.style,styleSpec:qt.styleSpec,arrayElementValidator:Rt})),ja(fr)==="array"&&fr.length===0&&rr.push(new qe(qt.key,fr,"array must have at least one stop")),rr},default:function(qt){return ir({key:qt.key,value:qt.value,valueSpec:ue,style:qt.style,styleSpec:qt.styleSpec})}}});return me==="identity"&&Re&&pt.push(new qe(x.key,x.value,'missing required property "property"')),me==="identity"||x.value.stops||pt.push(new qe(x.key,x.value,'missing required property "stops"')),me==="exponential"&&x.valueSpec.expression&&!So(x.valueSpec)&&pt.push(new qe(x.key,x.value,"exponential functions not supported")),x.styleSpec.$version>=8&&(Ze&&!Vo(x.valueSpec)?pt.push(new qe(x.key,x.value,"property functions not supported")):Re&&!hs(x.valueSpec)&&pt.push(new qe(x.key,x.value,"zoom functions not supported"))),me!=="categorical"&&!ct||x.value.property!==void 0||pt.push(new qe(x.key,x.value,'"property" property is required')),pt;function Rt(qt){var rr=[],fr=qt.value,Er=qt.key;if(ja(fr)!=="array")return[new qe(Er,fr,"array expected, "+ja(fr)+" found")];if(fr.length!==2)return[new qe(Er,fr,"array length 2 expected, length "+fr.length+" found")];if(ct){if(ja(fr[0])!=="object")return[new qe(Er,fr,"object expected, "+ja(fr[0])+" found")];if(fr[0].zoom===void 0)return[new qe(Er,fr,"object stop key must have zoom")];if(fr[0].value===void 0)return[new qe(Er,fr,"object stop key must have value")];if(ee&&ee>nt(fr[0].zoom))return[new qe(Er,fr[0].zoom,"stop zoom values must appear in ascending order")];nt(fr[0].zoom)!==ee&&(ee=nt(fr[0].zoom),H=void 0,we={}),rr=rr.concat(Pr({key:Er+"[0]",value:fr[0],valueSpec:{zoom:{}},style:qt.style,styleSpec:qt.styleSpec,objectElementValidators:{zoom:on,value:Yt}}))}else rr=rr.concat(Yt({key:Er+"[0]",value:fr[0],valueSpec:{},style:qt.style,styleSpec:qt.styleSpec},fr));return Xt(xt(fr[1]))?rr.concat([new qe(Er+"[1]",fr[1],"expressions are not allowed in function stops.")]):rr.concat(ir({key:Er+"[1]",value:fr[1],valueSpec:ue,style:qt.style,styleSpec:qt.styleSpec}))}function Yt(qt,rr){var fr=ja(qt.value),Er=nt(qt.value),Sr=qt.value!==null?qt.value:rr;if(I){if(fr!==I)return[new qe(qt.key,Sr,fr+" stop domain type must match previous stop domain type "+I)]}else I=fr;if(fr!=="number"&&fr!=="string"&&fr!=="boolean")return[new qe(qt.key,Sr,"stop domain value must be a number, string, or boolean")];if(fr!=="number"&&me!=="categorical"){var Fr="number expected, "+fr+" found";return Vo(ue)&&me===void 0&&(Fr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new qe(qt.key,Sr,Fr)]}return me!=="categorical"||fr!=="number"||isFinite(Er)&&Math.floor(Er)===Er?me!=="categorical"&&fr==="number"&&H!==void 0&&Er<H?[new qe(qt.key,Sr,"stop domain values must appear in ascending order")]:(H=Er,me==="categorical"&&Er in we?[new qe(qt.key,Sr,"stop domain values must be unique")]:(we[Er]=!0,[])):[new qe(qt.key,Sr,"integer expected, found "+Er)]}}function Mn(x){var I=(x.expressionContext==="property"?hr:Gt)(xt(x.value),x.valueSpec);if(I.result==="error")return I.value.map(function(ee){return new qe(""+x.key+ee.key,x.value,ee.message)});var H=I.value.expression||I.value._styleExpression.expression;if(x.expressionContext==="property"&&x.propertyKey==="text-font"&&!H.outputDefined())return[new qe(x.key,x.value,'Invalid data expression for "'+x.propertyKey+'". Output values must be contained as literals within the expression.')];if(x.expressionContext==="property"&&x.propertyType==="layout"&&!zn(H))return[new qe(x.key,x.value,'"feature-state" data expressions are not supported with layout properties.')];if(x.expressionContext==="filter"&&!zn(H))return[new qe(x.key,x.value,'"feature-state" data expressions are not supported with filters.')];if(x.expressionContext&&x.expressionContext.indexOf("cluster")===0){if(!ca(H,["zoom","feature-state"]))return[new qe(x.key,x.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(x.expressionContext==="cluster-initial"&&!ln(H))return[new qe(x.key,x.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Rn(x){var I=x.key,H=x.value,ee=x.valueSpec,ue=[];return Array.isArray(ee.values)?ee.values.indexOf(nt(H))===-1&&ue.push(new qe(I,H,"expected one of ["+ee.values.join(", ")+"], "+JSON.stringify(H)+" found")):Object.keys(ee.values).indexOf(nt(H))===-1&&ue.push(new qe(I,H,"expected one of ["+Object.keys(ee.values).join(", ")+"], "+JSON.stringify(H)+" found")),ue}function An(x){if(x===!0||x===!1)return!0;if(!Array.isArray(x)||x.length===0)return!1;switch(x[0]){case"has":return x.length>=2&&x[1]!=="$id"&&x[1]!=="$type";case"in":return x.length>=3&&(typeof x[1]!="string"||Array.isArray(x[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return x.length!==3||Array.isArray(x[1])||Array.isArray(x[2]);case"any":case"all":for(var I=0,H=x.slice(1);I<H.length;I+=1){var ee=H[I];if(!An(ee)&&typeof ee!="boolean")return!1}return!0;default:return!0}}vr.deserialize=function(x){return new vr(x._parameters,x._specification)},vr.serialize=function(x){return{_parameters:x._parameters,_specification:x._specification}};var ha={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function wa(x){if(x==null)return{filter:function(){return!0},needGeometry:!1};An(x)||(x=za(x));var I=Gt(x,ha);if(I.result==="error")throw new Error(I.value.map(function(H){return H.key+": "+H.message}).join(", "));return{filter:function(H,ee,ue){return I.value.evaluate(H,ee,{},ue)},needGeometry:function H(ee){if(!Array.isArray(ee))return!1;if(ee[0]==="within")return!0;for(var ue=1;ue<ee.length;ue++)if(H(ee[ue]))return!0;return!1}(x)}}function Da(x,I){return x<I?-1:x>I?1:0}function za(x){if(!x)return!0;var I,H=x[0];return x.length<=1?H!=="any":H==="=="?Ra(x[1],x[2],"=="):H==="!="?ni(Ra(x[1],x[2],"==")):H==="<"||H===">"||H==="<="||H===">="?Ra(x[1],x[2],H):H==="any"?(I=x.slice(1),["any"].concat(I.map(za))):H==="all"?["all"].concat(x.slice(1).map(za)):H==="none"?["all"].concat(x.slice(1).map(za).map(ni)):H==="in"?xi(x[1],x.slice(2)):H==="!in"?ni(xi(x[1],x.slice(2))):H==="has"?gi(x[1]):H==="!has"?ni(gi(x[1])):H!=="within"||x}function Ra(x,I,H){switch(x){case"$type":return["filter-type-"+H,I];case"$id":return["filter-id-"+H,I];default:return["filter-"+H,x,I]}}function xi(x,I){if(I.length===0)return!1;switch(x){case"$type":return["filter-type-in",["literal",I]];case"$id":return["filter-id-in",["literal",I]];default:return I.length>200&&!I.some(function(H){return typeof H!=typeof I[0]})?["filter-in-large",x,["literal",I.sort(Da)]]:["filter-in-small",x,["literal",I]]}}function gi(x){switch(x){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",x]}}function ni(x){return["!",x]}function ai(x){return An(xt(x.value))?Mn(at({},x,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function I(H){var ee=H.value,ue=H.key;if(ja(ee)!=="array")return[new qe(ue,ee,"array expected, "+ja(ee)+" found")];var me,we=H.styleSpec,Re=[];if(ee.length<1)return[new qe(ue,ee,"filter array must have at least 1 element")];switch(Re=Re.concat(Rn({key:ue+"[0]",value:ee[0],valueSpec:we.filter_operator,style:H.style,styleSpec:H.styleSpec})),nt(ee[0])){case"<":case"<=":case">":case">=":ee.length>=2&&nt(ee[1])==="$type"&&Re.push(new qe(ue,ee,'"$type" cannot be use with operator "'+ee[0]+'"'));case"==":case"!=":ee.length!==3&&Re.push(new qe(ue,ee,'filter array for operator "'+ee[0]+'" must have 3 elements'));case"in":case"!in":ee.length>=2&&(me=ja(ee[1]))!=="string"&&Re.push(new qe(ue+"[1]",ee[1],"string expected, "+me+" found"));for(var Ze=2;Ze<ee.length;Ze++)me=ja(ee[Ze]),nt(ee[1])==="$type"?Re=Re.concat(Rn({key:ue+"["+Ze+"]",value:ee[Ze],valueSpec:we.geometry_type,style:H.style,styleSpec:H.styleSpec})):me!=="string"&&me!=="number"&&me!=="boolean"&&Re.push(new qe(ue+"["+Ze+"]",ee[Ze],"string, number, or boolean expected, "+me+" found"));break;case"any":case"all":case"none":for(var ct=1;ct<ee.length;ct++)Re=Re.concat(I({key:ue+"["+ct+"]",value:ee[ct],style:H.style,styleSpec:H.styleSpec}));break;case"has":case"!has":me=ja(ee[1]),ee.length!==2?Re.push(new qe(ue,ee,'filter array for "'+ee[0]+'" operator must have 2 elements')):me!=="string"&&Re.push(new qe(ue+"[1]",ee[1],"string expected, "+me+" found"));break;case"within":me=ja(ee[1]),ee.length!==2?Re.push(new qe(ue,ee,'filter array for "'+ee[0]+'" operator must have 2 elements')):me!=="object"&&Re.push(new qe(ue+"[1]",ee[1],"object expected, "+me+" found"))}return Re}(x)}function mi(x,I){var H=x.key,ee=x.style,ue=x.styleSpec,me=x.value,we=x.objectKey,Re=ue[I+"_"+x.layerType];if(!Re)return[];var Ze=we.match(/^(.*)-transition$/);if(I==="paint"&&Ze&&Re[Ze[1]]&&Re[Ze[1]].transition)return ir({key:H,value:me,valueSpec:ue.transition,style:ee,styleSpec:ue});var ct,pt=x.valueSpec||Re[we];if(!pt)return[new qe(H,me,'unknown property "'+we+'"')];if(ja(me)==="string"&&Vo(pt)&&!pt.tokens&&(ct=/^{([^}]+)}$/.exec(me)))return[new qe(H,me,'"'+we+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ct[1])+" }`.")];var Rt=[];return x.layerType==="symbol"&&(we==="text-field"&&ee&&!ee.glyphs&&Rt.push(new qe(H,me,'use of "text-field" requires a style "glyphs" property')),we==="text-font"&&Fe(xt(me))&&nt(me.type)==="identity"&&Rt.push(new qe(H,me,'"text-font" does not support identity functions'))),Rt.concat(ir({key:x.key,value:me,valueSpec:pt,style:ee,styleSpec:ue,expressionContext:"property",propertyType:I,propertyKey:we}))}function Ri(x){return mi(x,"paint")}function Zi(x){return mi(x,"layout")}function Ji(x){var I=[],H=x.value,ee=x.key,ue=x.style,me=x.styleSpec;H.type||H.ref||I.push(new qe(ee,H,'either "type" or "ref" is required'));var we,Re=nt(H.type),Ze=nt(H.ref);if(H.id)for(var ct=nt(H.id),pt=0;pt<x.arrayIndex;pt++){var Rt=ue.layers[pt];nt(Rt.id)===ct&&I.push(new qe(ee,H.id,'duplicate layer id "'+H.id+'", previously used at line '+Rt.id.__line__))}if("ref"in H)["type","source","source-layer","filter","layout"].forEach(function(rr){rr in H&&I.push(new qe(ee,H[rr],'"'+rr+'" is prohibited for ref layers'))}),ue.layers.forEach(function(rr){nt(rr.id)===Ze&&(we=rr)}),we?we.ref?I.push(new qe(ee,H.ref,"ref cannot reference another ref layer")):Re=nt(we.type):I.push(new qe(ee,H.ref,'ref layer "'+Ze+'" not found'));else if(Re!=="background")if(H.source){var Yt=ue.sources&&ue.sources[H.source],qt=Yt&&nt(Yt.type);Yt?qt==="vector"&&Re==="raster"?I.push(new qe(ee,H.source,'layer "'+H.id+'" requires a raster source')):qt==="raster"&&Re!=="raster"?I.push(new qe(ee,H.source,'layer "'+H.id+'" requires a vector source')):qt!=="vector"||H["source-layer"]?qt==="raster-dem"&&Re!=="hillshade"?I.push(new qe(ee,H.source,"raster-dem source can only be used with layer type 'hillshade'.")):Re!=="line"||!H.paint||!H.paint["line-gradient"]||qt==="geojson"&&Yt.lineMetrics||I.push(new qe(ee,H,'layer "'+H.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):I.push(new qe(ee,H,'layer "'+H.id+'" must specify a "source-layer"')):I.push(new qe(ee,H.source,'source "'+H.source+'" not found'))}else I.push(new qe(ee,H,'missing required property "source"'));return I=I.concat(Pr({key:ee,value:H,valueSpec:me.layer,style:x.style,styleSpec:x.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return ir({key:ee+".type",value:H.type,valueSpec:me.layer.type,style:x.style,styleSpec:x.styleSpec,object:H,objectKey:"type"})},filter:ai,layout:function(rr){return Pr({layer:H,key:rr.key,value:rr.value,style:rr.style,styleSpec:rr.styleSpec,objectElementValidators:{"*":function(fr){return Zi(at({layerType:Re},fr))}}})},paint:function(rr){return Pr({layer:H,key:rr.key,value:rr.value,style:rr.style,styleSpec:rr.styleSpec,objectElementValidators:{"*":function(fr){return Ri(at({layerType:Re},fr))}}})}}}))}function Ki(x){var I=x.value,H=x.key,ee=ja(I);return ee!=="string"?[new qe(H,I,"string expected, "+ee+" found")]:[]}var Qi={promoteId:function(x){var I=x.key,H=x.value;if(ja(H)==="string")return Ki({key:I,value:H});var ee=[];for(var ue in H)ee.push.apply(ee,Ki({key:I+"."+ue,value:H[ue]}));return ee}};function Ca(x){var I=x.value,H=x.key,ee=x.styleSpec,ue=x.style;if(!I.type)return[new qe(H,I,'"type" is required')];var me,we=nt(I.type);switch(we){case"vector":case"raster":case"raster-dem":return me=Pr({key:H,value:I,valueSpec:ee["source_"+we.replace("-","_")],style:x.style,styleSpec:ee,objectElementValidators:Qi});case"geojson":if(me=Pr({key:H,value:I,valueSpec:ee.source_geojson,style:ue,styleSpec:ee,objectElementValidators:Qi}),I.cluster)for(var Re in I.clusterProperties){var Ze=I.clusterProperties[Re],ct=Ze[0],pt=Ze[1],Rt=typeof ct=="string"?[ct,["accumulated"],["get",Re]]:ct;me.push.apply(me,Mn({key:H+"."+Re+".map",value:pt,expressionContext:"cluster-map"})),me.push.apply(me,Mn({key:H+"."+Re+".reduce",value:Rt,expressionContext:"cluster-reduce"}))}return me;case"video":return Pr({key:H,value:I,valueSpec:ee.source_video,style:ue,styleSpec:ee});case"image":return Pr({key:H,value:I,valueSpec:ee.source_image,style:ue,styleSpec:ee});case"canvas":return[new qe(H,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Rn({key:H+".type",value:I.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:ue,styleSpec:ee})}}function ut(x){var I=x.value,H=x.styleSpec,ee=H.light,ue=x.style,me=[],we=ja(I);if(I===void 0)return me;if(we!=="object")return me=me.concat([new qe("light",I,"object expected, "+we+" found")]);for(var Re in I){var Ze=Re.match(/^(.*)-transition$/);me=Ze&&ee[Ze[1]]&&ee[Ze[1]].transition?me.concat(ir({key:Re,value:I[Re],valueSpec:H.transition,style:ue,styleSpec:H})):ee[Re]?me.concat(ir({key:Re,value:I[Re],valueSpec:ee[Re],style:ue,styleSpec:H})):me.concat([new qe(Re,I[Re],'unknown property "'+Re+'"')])}return me}var Ot={"*":function(){return[]},array:Jr,boolean:function(x){var I=x.value,H=x.key,ee=ja(I);return ee!=="boolean"?[new qe(H,I,"boolean expected, "+ee+" found")]:[]},number:on,color:function(x){var I=x.key,H=x.value,ee=ja(H);return ee!=="string"?[new qe(I,H,"color expected, "+ee+" found")]:dr(H)===null?[new qe(I,H,'color expected, "'+H+'" found')]:[]},constants:ht,enum:Rn,filter:ai,function:_n,layer:Ji,object:Pr,source:Ca,light:ut,string:Ki,formatted:function(x){return Ki(x).length===0?[]:Mn(x)},resolvedImage:function(x){return Ki(x).length===0?[]:Mn(x)}};function ir(x){var I=x.value,H=x.valueSpec,ee=x.styleSpec;return H.expression&&Fe(nt(I))?_n(x):H.expression&&Xt(xt(I))?Mn(x):H.type&&Ot[H.type]?Ot[H.type](x):Pr(at({},x,{valueSpec:H.type?ee[H.type]:H}))}function Vt(x){var I=x.value,H=x.key,ee=Ki(x);return ee.length||(I.indexOf("{fontstack}")===-1&&ee.push(new qe(H,I,'"glyphs" url must include a "{fontstack}" token')),I.indexOf("{range}")===-1&&ee.push(new qe(H,I,'"glyphs" url must include a "{range}" token'))),ee}function sr(x,I){I===void 0&&(I=ze);var H=[];return H=H.concat(ir({key:"",value:x,valueSpec:I.$root,styleSpec:I,style:x,objectElementValidators:{glyphs:Vt,"*":function(){return[]}}})),x.constants&&(H=H.concat(ht({key:"constants",value:x.constants,style:x,styleSpec:I}))),Cr(H)}function Cr(x){return[].concat(x).sort(function(I,H){return I.line-H.line})}function Or(x){return function(){for(var I=[],H=arguments.length;H--;)I[H]=arguments[H];return Cr(x.apply(this,I))}}sr.source=Or(Ca),sr.light=Or(ut),sr.layer=Or(Ji),sr.filter=Or(ai),sr.paintProperty=Or(Ri),sr.layoutProperty=Or(Zi);var qr=sr,en=qr.light,Kr=qr.paintProperty,sn=qr.layoutProperty;function pn(x,I){var H=!1;if(I&&I.length)for(var ee=0,ue=I;ee<ue.length;ee+=1){var me=ue[ee];x.fire(new Ae(new Error(me.message))),H=!0}return H}var tn=dn;function dn(x,I,H){var ee=this.cells=[];if(x instanceof ArrayBuffer){this.arrayBuffer=x;var ue=new Int32Array(this.arrayBuffer);x=ue[0],I=ue[1],H=ue[2],this.d=I+2*H;for(var me=0;me<this.d*this.d;me++){var we=ue[3+me],Re=ue[3+me+1];ee.push(we===Re?null:ue.subarray(we,Re))}var Ze=ue[3+ee.length],ct=ue[3+ee.length+1];this.keys=ue.subarray(Ze,ct),this.bboxes=ue.subarray(ct),this.insert=this._insertReadonly}else{this.d=I+2*H;for(var pt=0;pt<this.d*this.d;pt++)ee.push([]);this.keys=[],this.bboxes=[]}this.n=I,this.extent=x,this.padding=H,this.scale=I/x,this.uid=0;var Rt=H/I*x;this.min=-Rt,this.max=x+Rt}dn.prototype.insert=function(x,I,H,ee,ue){this._forEachCell(I,H,ee,ue,this._insertCell,this.uid++),this.keys.push(x),this.bboxes.push(I),this.bboxes.push(H),this.bboxes.push(ee),this.bboxes.push(ue)},dn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},dn.prototype._insertCell=function(x,I,H,ee,ue,me){this.cells[ue].push(me)},dn.prototype.query=function(x,I,H,ee,ue){var me=this.min,we=this.max;if(x<=me&&I<=me&&we<=H&&we<=ee&&!ue)return Array.prototype.slice.call(this.keys);var Re=[];return this._forEachCell(x,I,H,ee,this._queryCell,Re,{},ue),Re},dn.prototype._queryCell=function(x,I,H,ee,ue,me,we,Re){var Ze=this.cells[ue];if(Ze!==null)for(var ct=this.keys,pt=this.bboxes,Rt=0;Rt<Ze.length;Rt++){var Yt=Ze[Rt];if(we[Yt]===void 0){var qt=4*Yt;(Re?Re(pt[qt+0],pt[qt+1],pt[qt+2],pt[qt+3]):x<=pt[qt+2]&&I<=pt[qt+3]&&H>=pt[qt+0]&&ee>=pt[qt+1])?(we[Yt]=!0,me.push(ct[Yt])):we[Yt]=!1}}},dn.prototype._forEachCell=function(x,I,H,ee,ue,me,we,Re){for(var Ze=this._convertToCellCoord(x),ct=this._convertToCellCoord(I),pt=this._convertToCellCoord(H),Rt=this._convertToCellCoord(ee),Yt=Ze;Yt<=pt;Yt++)for(var qt=ct;qt<=Rt;qt++){var rr=this.d*qt+Yt;if((!Re||Re(this._convertFromCellCoord(Yt),this._convertFromCellCoord(qt),this._convertFromCellCoord(Yt+1),this._convertFromCellCoord(qt+1)))&&ue.call(this,x,I,H,ee,rr,me,we,Re))return}},dn.prototype._convertFromCellCoord=function(x){return(x-this.padding)/this.scale},dn.prototype._convertToCellCoord=function(x){return Math.max(0,Math.min(this.d-1,Math.floor(x*this.scale)+this.padding))},dn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var x=this.cells,I=3+this.cells.length+1+1,H=0,ee=0;ee<this.cells.length;ee++)H+=this.cells[ee].length;var ue=new Int32Array(I+H+this.keys.length+this.bboxes.length);ue[0]=this.extent,ue[1]=this.n,ue[2]=this.padding;for(var me=I,we=0;we<x.length;we++){var Re=x[we];ue[3+we]=me,ue.set(Re,me),me+=Re.length}return ue[3+x.length]=me,ue.set(this.keys,me),me+=this.keys.length,ue[3+x.length+1]=me,ue.set(this.bboxes,me),me+=this.bboxes.length,ue.buffer};var Sn=self.ImageData,Dn=self.ImageBitmap,Qn={};function Hr(x,I,H){H===void 0&&(H={}),Object.defineProperty(I,"_classRegistryKey",{value:x,writeable:!1}),Qn[x]={klass:I,omit:H.omit||[],shallow:H.shallow||[]}}for(var Xn in Hr("Object",Object),tn.serialize=function(x,I){var H=x.toArrayBuffer();return I&&I.push(H),{buffer:H}},tn.deserialize=function(x){return new tn(x.buffer)},Hr("Grid",tn),Hr("Color",Kt),Hr("Error",Error),Hr("ResolvedImage",wr),Hr("StylePropertyFunction",vr),Hr("StyleExpression",Wt,{omit:["_evaluator"]}),Hr("ZoomDependentExpression",lr),Hr("ZoomConstantExpression",tr),Hr("CompoundExpression",kn,{omit:["_evaluate"]}),No)No[Xn]._classRegistryKey||Hr("Expression_"+Xn,No[Xn]);function Tn(x){return x&&typeof ArrayBuffer<"u"&&(x instanceof ArrayBuffer||x.constructor&&x.constructor.name==="ArrayBuffer")}function Cn(x){return Dn&&x instanceof Dn}function Yn(x,I){if(x==null||typeof x=="boolean"||typeof x=="number"||typeof x=="string"||x instanceof Boolean||x instanceof Number||x instanceof String||x instanceof Date||x instanceof RegExp)return x;if(Tn(x)||Cn(x))return I&&I.push(x),x;if(ArrayBuffer.isView(x)){var H=x;return I&&I.push(H.buffer),H}if(x instanceof Sn)return I&&I.push(x.data.buffer),x;if(Array.isArray(x)){for(var ee=[],ue=0,me=x;ue<me.length;ue+=1){var we=me[ue];ee.push(Yn(we,I))}return ee}if(typeof x=="object"){var Re=x.constructor,Ze=Re._classRegistryKey;if(!Ze)throw new Error("can't serialize object of unregistered class");var ct=Re.serialize?Re.serialize(x,I):{};if(!Re.serialize){for(var pt in x)if(x.hasOwnProperty(pt)&&!(Qn[Ze].omit.indexOf(pt)>=0)){var Rt=x[pt];ct[pt]=Qn[Ze].shallow.indexOf(pt)>=0?Rt:Yn(Rt,I)}x instanceof Error&&(ct.message=x.message)}if(ct.$name)throw new Error("$name property is reserved for worker serialization logic.");return Ze!=="Object"&&(ct.$name=Ze),ct}throw new Error("can't serialize object of type "+typeof x)}function _a(x){if(x==null||typeof x=="boolean"||typeof x=="number"||typeof x=="string"||x instanceof Boolean||x instanceof Number||x instanceof String||x instanceof Date||x instanceof RegExp||Tn(x)||Cn(x)||ArrayBuffer.isView(x)||x instanceof Sn)return x;if(Array.isArray(x))return x.map(_a);if(typeof x=="object"){var I=x.$name||"Object",H=Qn[I].klass;if(!H)throw new Error("can't deserialize unregistered class "+I);if(H.deserialize)return H.deserialize(x);for(var ee=Object.create(H.prototype),ue=0,me=Object.keys(x);ue<me.length;ue+=1){var we=me[ue];if(we!=="$name"){var Re=x[we];ee[we]=Qn[I].shallow.indexOf(we)>=0?Re:_a(Re)}}return ee}throw new Error("can't deserialize object of type "+typeof x)}var Sa=function(){this.first=!0};Sa.prototype.update=function(x,I){var H=Math.floor(x);return this.first?(this.first=!1,this.lastIntegerZoom=H,this.lastIntegerZoomTime=0,this.lastZoom=x,this.lastFloorZoom=H,!0):(this.lastFloorZoom>H?(this.lastIntegerZoom=H+1,this.lastIntegerZoomTime=I):this.lastFloorZoom<H&&(this.lastIntegerZoom=H,this.lastIntegerZoomTime=I),x!==this.lastZoom&&(this.lastZoom=x,this.lastFloorZoom=H,!0))};var yn={"Latin-1 Supplement":function(x){return x>=128&&x<=255},Arabic:function(x){return x>=1536&&x<=1791},"Arabic Supplement":function(x){return x>=1872&&x<=1919},"Arabic Extended-A":function(x){return x>=2208&&x<=2303},"Hangul Jamo":function(x){return x>=4352&&x<=4607},"Unified Canadian Aboriginal Syllabics":function(x){return x>=5120&&x<=5759},Khmer:function(x){return x>=6016&&x<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(x){return x>=6320&&x<=6399},"General Punctuation":function(x){return x>=8192&&x<=8303},"Letterlike Symbols":function(x){return x>=8448&&x<=8527},"Number Forms":function(x){return x>=8528&&x<=8591},"Miscellaneous Technical":function(x){return x>=8960&&x<=9215},"Control Pictures":function(x){return x>=9216&&x<=9279},"Optical Character Recognition":function(x){return x>=9280&&x<=9311},"Enclosed Alphanumerics":function(x){return x>=9312&&x<=9471},"Geometric Shapes":function(x){return x>=9632&&x<=9727},"Miscellaneous Symbols":function(x){return x>=9728&&x<=9983},"Miscellaneous Symbols and Arrows":function(x){return x>=11008&&x<=11263},"CJK Radicals Supplement":function(x){return x>=11904&&x<=12031},"Kangxi Radicals":function(x){return x>=12032&&x<=12255},"Ideographic Description Characters":function(x){return x>=12272&&x<=12287},"CJK Symbols and Punctuation":function(x){return x>=12288&&x<=12351},Hiragana:function(x){return x>=12352&&x<=12447},Katakana:function(x){return x>=12448&&x<=12543},Bopomofo:function(x){return x>=12544&&x<=12591},"Hangul Compatibility Jamo":function(x){return x>=12592&&x<=12687},Kanbun:function(x){return x>=12688&&x<=12703},"Bopomofo Extended":function(x){return x>=12704&&x<=12735},"CJK Strokes":function(x){return x>=12736&&x<=12783},"Katakana Phonetic Extensions":function(x){return x>=12784&&x<=12799},"Enclosed CJK Letters and Months":function(x){return x>=12800&&x<=13055},"CJK Compatibility":function(x){return x>=13056&&x<=13311},"CJK Unified Ideographs Extension A":function(x){return x>=13312&&x<=19903},"Yijing Hexagram Symbols":function(x){return x>=19904&&x<=19967},"CJK Unified Ideographs":function(x){return x>=19968&&x<=40959},"Yi Syllables":function(x){return x>=40960&&x<=42127},"Yi Radicals":function(x){return x>=42128&&x<=42191},"Hangul Jamo Extended-A":function(x){return x>=43360&&x<=43391},"Hangul Syllables":function(x){return x>=44032&&x<=55215},"Hangul Jamo Extended-B":function(x){return x>=55216&&x<=55295},"Private Use Area":function(x){return x>=57344&&x<=63743},"CJK Compatibility Ideographs":function(x){return x>=63744&&x<=64255},"Arabic Presentation Forms-A":function(x){return x>=64336&&x<=65023},"Vertical Forms":function(x){return x>=65040&&x<=65055},"CJK Compatibility Forms":function(x){return x>=65072&&x<=65103},"Small Form Variants":function(x){return x>=65104&&x<=65135},"Arabic Presentation Forms-B":function(x){return x>=65136&&x<=65279},"Halfwidth and Fullwidth Forms":function(x){return x>=65280&&x<=65519}};function Pa(x){for(var I=0,H=x;I<H.length;I+=1)if(fa(H[I].charCodeAt(0)))return!0;return!1}function Ma(x){return!yn.Arabic(x)&&!yn["Arabic Supplement"](x)&&!yn["Arabic Extended-A"](x)&&!yn["Arabic Presentation Forms-A"](x)&&!yn["Arabic Presentation Forms-B"](x)}function fa(x){return x===746||x===747||!(x<4352)&&(!!yn["Bopomofo Extended"](x)||!!yn.Bopomofo(x)||!(!yn["CJK Compatibility Forms"](x)||x>=65097&&x<=65103)||!!yn["CJK Compatibility Ideographs"](x)||!!yn["CJK Compatibility"](x)||!!yn["CJK Radicals Supplement"](x)||!!yn["CJK Strokes"](x)||!(!yn["CJK Symbols and Punctuation"](x)||x>=12296&&x<=12305||x>=12308&&x<=12319||x===12336)||!!yn["CJK Unified Ideographs Extension A"](x)||!!yn["CJK Unified Ideographs"](x)||!!yn["Enclosed CJK Letters and Months"](x)||!!yn["Hangul Compatibility Jamo"](x)||!!yn["Hangul Jamo Extended-A"](x)||!!yn["Hangul Jamo Extended-B"](x)||!!yn["Hangul Jamo"](x)||!!yn["Hangul Syllables"](x)||!!yn.Hiragana(x)||!!yn["Ideographic Description Characters"](x)||!!yn.Kanbun(x)||!!yn["Kangxi Radicals"](x)||!!yn["Katakana Phonetic Extensions"](x)||!(!yn.Katakana(x)||x===12540)||!(!yn["Halfwidth and Fullwidth Forms"](x)||x===65288||x===65289||x===65293||x>=65306&&x<=65310||x===65339||x===65341||x===65343||x>=65371&&x<=65503||x===65507||x>=65512&&x<=65519)||!(!yn["Small Form Variants"](x)||x>=65112&&x<=65118||x>=65123&&x<=65126)||!!yn["Unified Canadian Aboriginal Syllabics"](x)||!!yn["Unified Canadian Aboriginal Syllabics Extended"](x)||!!yn["Vertical Forms"](x)||!!yn["Yijing Hexagram Symbols"](x)||!!yn["Yi Syllables"](x)||!!yn["Yi Radicals"](x))}function Ia(x){return!(fa(x)||function(I){return!(!yn["Latin-1 Supplement"](I)||I!==167&&I!==169&&I!==174&&I!==177&&I!==188&&I!==189&&I!==190&&I!==215&&I!==247)||!(!yn["General Punctuation"](I)||I!==8214&&I!==8224&&I!==8225&&I!==8240&&I!==8241&&I!==8251&&I!==8252&&I!==8258&&I!==8263&&I!==8264&&I!==8265&&I!==8273)||!!yn["Letterlike Symbols"](I)||!!yn["Number Forms"](I)||!(!yn["Miscellaneous Technical"](I)||!(I>=8960&&I<=8967||I>=8972&&I<=8991||I>=8996&&I<=9e3||I===9003||I>=9085&&I<=9114||I>=9150&&I<=9165||I===9167||I>=9169&&I<=9179||I>=9186&&I<=9215))||!(!yn["Control Pictures"](I)||I===9251)||!!yn["Optical Character Recognition"](I)||!!yn["Enclosed Alphanumerics"](I)||!!yn["Geometric Shapes"](I)||!(!yn["Miscellaneous Symbols"](I)||I>=9754&&I<=9759)||!(!yn["Miscellaneous Symbols and Arrows"](I)||!(I>=11026&&I<=11055||I>=11088&&I<=11097||I>=11192&&I<=11243))||!!yn["CJK Symbols and Punctuation"](I)||!!yn.Katakana(I)||!!yn["Private Use Area"](I)||!!yn["CJK Compatibility Forms"](I)||!!yn["Small Form Variants"](I)||!!yn["Halfwidth and Fullwidth Forms"](I)||I===8734||I===8756||I===8757||I>=9984&&I<=10087||I>=10102&&I<=10131||I===65532||I===65533}(x))}function Ta(x){return x>=1424&&x<=2303||yn["Arabic Presentation Forms-A"](x)||yn["Arabic Presentation Forms-B"](x)}function Ja(x,I){return!(!I&&Ta(x))&&!(x>=2304&&x<=3583||x>=3840&&x<=4255||yn.Khmer(x))}function Zn(x){for(var I=0,H=x;I<H.length;I+=1)if(Ta(H[I].charCodeAt(0)))return!0;return!1}var Ha="deferred",Fi="loading",Wo="loaded",Io="error",po=null,ga="unavailable",fi=null,go=function(x){x&&typeof x=="string"&&x.indexOf("NetworkError")>-1&&(ga=Io),po&&po(x)};function Ga(){bi.fire(new be("pluginStateChange",{pluginStatus:ga,pluginURL:fi}))}var bi=new Pe,Ui=function(){return ga},Qa=function(){if(ga!==Ha||!fi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ga=Fi,Ga(),fi&&Mt({url:fi},function(x){x?go(x):(ga=Wo,Ga())})},so={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return ga===Wo||so.applyArabicShaping!=null},isLoading:function(){return ga===Fi},setState:function(x){ga=x.pluginStatus,fi=x.pluginURL},isParsed:function(){return so.applyArabicShaping!=null&&so.processBidirectionalText!=null&&so.processStyledBidirectionalText!=null},getPluginURL:function(){return fi}},$a=function(x,I){this.zoom=x,I?(this.now=I.now,this.fadeDuration=I.fadeDuration,this.zoomHistory=I.zoomHistory,this.transition=I.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Sa,this.transition={})};$a.prototype.isSupportedScript=function(x){return function(I,H){for(var ee=0,ue=I;ee<ue.length;ee+=1)if(!Ja(ue[ee].charCodeAt(0),H))return!1;return!0}(x,so.isLoaded())},$a.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},$a.prototype.getCrossfadeParameters=function(){var x=this.zoom,I=x-Math.floor(x),H=this.crossFadingFactor();return x>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:I+(1-I)*H}:{fromScale:.5,toScale:1,t:1-(1-H)*I}};var $i=function(x,I){this.property=x,this.value=I,this.expression=function(H,ee){if(Fe(H))return new vr(H,ee);if(Xt(H)){var ue=hr(H,ee);if(ue.result==="error")throw new Error(ue.value.map(function(we){return we.key+": "+we.message}).join(", "));return ue.value}var me=H;return typeof H=="string"&&ee.type==="color"&&(me=Kt.parse(H)),{kind:"constant",evaluate:function(){return me}}}(I===void 0?x.specification.default:I,x.specification)};$i.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},$i.prototype.possiblyEvaluate=function(x,I,H){return this.property.possiblyEvaluate(this,x,I,H)};var is=function(x){this.property=x,this.value=new $i(x,void 0)};is.prototype.transitioned=function(x,I){return new Ds(this.property,this.value,I,g({},x.transition,this.transition),x.now)},is.prototype.untransitioned=function(){return new Ds(this.property,this.value,null,{},0)};var $o=function(x){this._properties=x,this._values=Object.create(x.defaultTransitionablePropertyValues)};$o.prototype.getValue=function(x){return b(this._values[x].value.value)},$o.prototype.setValue=function(x,I){this._values.hasOwnProperty(x)||(this._values[x]=new is(this._values[x].property)),this._values[x].value=new $i(this._values[x].property,I===null?void 0:b(I))},$o.prototype.getTransition=function(x){return b(this._values[x].transition)},$o.prototype.setTransition=function(x,I){this._values.hasOwnProperty(x)||(this._values[x]=new is(this._values[x].property)),this._values[x].transition=b(I)||void 0},$o.prototype.serialize=function(){for(var x={},I=0,H=Object.keys(this._values);I<H.length;I+=1){var ee=H[I],ue=this.getValue(ee);ue!==void 0&&(x[ee]=ue);var me=this.getTransition(ee);me!==void 0&&(x[ee+"-transition"]=me)}return x},$o.prototype.transitioned=function(x,I){for(var H=new Pi(this._properties),ee=0,ue=Object.keys(this._values);ee<ue.length;ee+=1){var me=ue[ee];H._values[me]=this._values[me].transitioned(x,I._values[me])}return H},$o.prototype.untransitioned=function(){for(var x=new Pi(this._properties),I=0,H=Object.keys(this._values);I<H.length;I+=1){var ee=H[I];x._values[ee]=this._values[ee].untransitioned()}return x};var Ds=function(x,I,H,ee,ue){this.property=x,this.value=I,this.begin=ue+ee.delay||0,this.end=this.begin+ee.duration||0,x.specification.transition&&(ee.delay||ee.duration)&&(this.prior=H)};Ds.prototype.possiblyEvaluate=function(x,I,H){var ee=x.now||0,ue=this.value.possiblyEvaluate(x,I,H),me=this.prior;if(me){if(ee>this.end)return this.prior=null,ue;if(this.value.isDataDriven())return this.prior=null,ue;if(ee<this.begin)return me.possiblyEvaluate(x,I,H);var we=(ee-this.begin)/(this.end-this.begin);return this.property.interpolate(me.possiblyEvaluate(x,I,H),ue,function(Re){if(Re<=0)return 0;if(Re>=1)return 1;var Ze=Re*Re,ct=Ze*Re;return 4*(Re<.5?ct:3*(Re-Ze)+ct-.75)}(we))}return ue};var Pi=function(x){this._properties=x,this._values=Object.create(x.defaultTransitioningPropertyValues)};Pi.prototype.possiblyEvaluate=function(x,I,H){for(var ee=new es(this._properties),ue=0,me=Object.keys(this._values);ue<me.length;ue+=1){var we=me[ue];ee._values[we]=this._values[we].possiblyEvaluate(x,I,H)}return ee},Pi.prototype.hasTransition=function(){for(var x=0,I=Object.keys(this._values);x<I.length;x+=1){var H=I[x];if(this._values[H].prior)return!0}return!1};var Rs=function(x){this._properties=x,this._values=Object.create(x.defaultPropertyValues)};Rs.prototype.getValue=function(x){return b(this._values[x].value)},Rs.prototype.setValue=function(x,I){this._values[x]=new $i(this._values[x].property,I===null?void 0:b(I))},Rs.prototype.serialize=function(){for(var x={},I=0,H=Object.keys(this._values);I<H.length;I+=1){var ee=H[I],ue=this.getValue(ee);ue!==void 0&&(x[ee]=ue)}return x},Rs.prototype.possiblyEvaluate=function(x,I,H){for(var ee=new es(this._properties),ue=0,me=Object.keys(this._values);ue<me.length;ue+=1){var we=me[ue];ee._values[we]=this._values[we].possiblyEvaluate(x,I,H)}return ee};var Ii=function(x,I,H){this.property=x,this.value=I,this.parameters=H};Ii.prototype.isConstant=function(){return this.value.kind==="constant"},Ii.prototype.constantOr=function(x){return this.value.kind==="constant"?this.value.value:x},Ii.prototype.evaluate=function(x,I,H,ee){return this.property.evaluate(this.value,this.parameters,x,I,H,ee)};var es=function(x){this._properties=x,this._values=Object.create(x.defaultPossiblyEvaluatedValues)};es.prototype.get=function(x){return this._values[x]};var na=function(x){this.specification=x};na.prototype.possiblyEvaluate=function(x,I){return x.expression.evaluate(I)},na.prototype.interpolate=function(x,I,H){var ee=cn[this.specification.type];return ee?ee(x,I,H):x};var ma=function(x,I){this.specification=x,this.overrides=I};ma.prototype.possiblyEvaluate=function(x,I,H,ee){return x.expression.kind==="constant"||x.expression.kind==="camera"?new Ii(this,{kind:"constant",value:x.expression.evaluate(I,null,{},H,ee)},I):new Ii(this,x.expression,I)},ma.prototype.interpolate=function(x,I,H){if(x.value.kind!=="constant"||I.value.kind!=="constant")return x;if(x.value.value===void 0||I.value.value===void 0)return new Ii(this,{kind:"constant",value:void 0},x.parameters);var ee=cn[this.specification.type];return ee?new Ii(this,{kind:"constant",value:ee(x.value.value,I.value.value,H)},x.parameters):x},ma.prototype.evaluate=function(x,I,H,ee,ue,me){return x.kind==="constant"?x.value:x.evaluate(I,H,ee,ue,me)};var Fs=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.possiblyEvaluate=function(H,ee,ue,me){if(H.value===void 0)return new Ii(this,{kind:"constant",value:void 0},ee);if(H.expression.kind==="constant"){var we=H.expression.evaluate(ee,null,{},ue,me),Re=H.property.specification.type==="resolvedImage"&&typeof we!="string"?we.name:we,Ze=this._calculate(Re,Re,Re,ee);return new Ii(this,{kind:"constant",value:Ze},ee)}if(H.expression.kind==="camera"){var ct=this._calculate(H.expression.evaluate({zoom:ee.zoom-1}),H.expression.evaluate({zoom:ee.zoom}),H.expression.evaluate({zoom:ee.zoom+1}),ee);return new Ii(this,{kind:"constant",value:ct},ee)}return new Ii(this,H.expression,ee)},I.prototype.evaluate=function(H,ee,ue,me,we,Re){if(H.kind==="source"){var Ze=H.evaluate(ee,ue,me,we,Re);return this._calculate(Ze,Ze,Ze,ee)}return H.kind==="composite"?this._calculate(H.evaluate({zoom:Math.floor(ee.zoom)-1},ue,me),H.evaluate({zoom:Math.floor(ee.zoom)},ue,me),H.evaluate({zoom:Math.floor(ee.zoom)+1},ue,me),ee):H.value},I.prototype._calculate=function(H,ee,ue,me){return me.zoom>me.zoomHistory.lastIntegerZoom?{from:H,to:ee}:{from:ue,to:ee}},I.prototype.interpolate=function(H){return H},I}(ma),Bs=function(x){this.specification=x};Bs.prototype.possiblyEvaluate=function(x,I,H,ee){if(x.value!==void 0){if(x.expression.kind==="constant"){var ue=x.expression.evaluate(I,null,{},H,ee);return this._calculate(ue,ue,ue,I)}return this._calculate(x.expression.evaluate(new $a(Math.floor(I.zoom-1),I)),x.expression.evaluate(new $a(Math.floor(I.zoom),I)),x.expression.evaluate(new $a(Math.floor(I.zoom+1),I)),I)}},Bs.prototype._calculate=function(x,I,H,ee){return ee.zoom>ee.zoomHistory.lastIntegerZoom?{from:x,to:I}:{from:H,to:I}},Bs.prototype.interpolate=function(x){return x};var ts=function(x){this.specification=x};ts.prototype.possiblyEvaluate=function(x,I,H,ee){return!!x.expression.evaluate(I,null,{},H,ee)},ts.prototype.interpolate=function(){return!1};var Eo=function(x){for(var I in this.properties=x,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],x){var H=x[I];H.specification.overridable&&this.overridableProperties.push(I);var ee=this.defaultPropertyValues[I]=new $i(H,void 0),ue=this.defaultTransitionablePropertyValues[I]=new is(H);this.defaultTransitioningPropertyValues[I]=ue.untransitioned(),this.defaultPossiblyEvaluatedValues[I]=ee.possiblyEvaluate({})}};Hr("DataDrivenProperty",ma),Hr("DataConstantProperty",na),Hr("CrossFadedDataDrivenProperty",Fs),Hr("CrossFadedProperty",Bs),Hr("ColorRampProperty",ts);var qo=function(x){function I(H,ee){if(x.call(this),this.id=H.id,this.type=H.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},H.type!=="custom"&&(H=H,this.metadata=H.metadata,this.minzoom=H.minzoom,this.maxzoom=H.maxzoom,H.type!=="background"&&(this.source=H.source,this.sourceLayer=H["source-layer"],this.filter=H.filter),ee.layout&&(this._unevaluatedLayout=new Rs(ee.layout)),ee.paint)){for(var ue in this._transitionablePaint=new $o(ee.paint),H.paint)this.setPaintProperty(ue,H.paint[ue],{validate:!1});for(var me in H.layout)this.setLayoutProperty(me,H.layout[me],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new es(ee.paint)}}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},I.prototype.getLayoutProperty=function(H){return H==="visibility"?this.visibility:this._unevaluatedLayout.getValue(H)},I.prototype.setLayoutProperty=function(H,ee,ue){if(ue===void 0&&(ue={}),ee!=null){var me="layers."+this.id+".layout."+H;if(this._validate(sn,me,H,ee,ue))return}H!=="visibility"?this._unevaluatedLayout.setValue(H,ee):this.visibility=ee},I.prototype.getPaintProperty=function(H){return k(H,"-transition")?this._transitionablePaint.getTransition(H.slice(0,-11)):this._transitionablePaint.getValue(H)},I.prototype.setPaintProperty=function(H,ee,ue){if(ue===void 0&&(ue={}),ee!=null){var me="layers."+this.id+".paint."+H;if(this._validate(Kr,me,H,ee,ue))return!1}if(k(H,"-transition"))return this._transitionablePaint.setTransition(H.slice(0,-11),ee||void 0),!1;var we=this._transitionablePaint._values[H],Re=we.property.specification["property-type"]==="cross-faded-data-driven",Ze=we.value.isDataDriven(),ct=we.value;this._transitionablePaint.setValue(H,ee),this._handleSpecialPaintPropertyUpdate(H);var pt=this._transitionablePaint._values[H].value;return pt.isDataDriven()||Ze||Re||this._handleOverridablePaintPropertyUpdate(H,ct,pt)},I.prototype._handleSpecialPaintPropertyUpdate=function(H){},I.prototype._handleOverridablePaintPropertyUpdate=function(H,ee,ue){return!1},I.prototype.isHidden=function(H){return!!(this.minzoom&&H<this.minzoom)||!!(this.maxzoom&&H>=this.maxzoom)||this.visibility==="none"},I.prototype.updateTransitions=function(H){this._transitioningPaint=this._transitionablePaint.transitioned(H,this._transitioningPaint)},I.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},I.prototype.recalculate=function(H,ee){H.getCrossfadeParameters&&(this._crossfadeParameters=H.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(H,void 0,ee)),this.paint=this._transitioningPaint.possiblyEvaluate(H,void 0,ee)},I.prototype.serialize=function(){var H={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(H.layout=H.layout||{},H.layout.visibility=this.visibility),A(H,function(ee,ue){return!(ee===void 0||ue==="layout"&&!Object.keys(ee).length||ue==="paint"&&!Object.keys(ee).length)})},I.prototype._validate=function(H,ee,ue,me,we){return we===void 0&&(we={}),(!we||we.validate!==!1)&&pn(this,H.call(qr,{key:ee,layerType:this.type,objectKey:ue,value:me,styleSpec:ze,style:{glyphs:!0,sprite:!0}}))},I.prototype.is3D=function(){return!1},I.prototype.isTileClipped=function(){return!1},I.prototype.hasOffscreenPass=function(){return!1},I.prototype.resize=function(){},I.prototype.isStateDependent=function(){for(var H in this.paint._values){var ee=this.paint.get(H);if(ee instanceof Ii&&Vo(ee.property.specification)&&(ee.value.kind==="source"||ee.value.kind==="composite")&&ee.value.isStateDependent)return!0}return!1},I}(Pe),Js={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ks=function(x,I){this._structArray=x,this._pos1=I*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ya=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function ei(x,I){I===void 0&&(I=1);var H=0,ee=0;return{members:x.map(function(ue){var me,we=(me=ue.type,Js[me].BYTES_PER_ELEMENT),Re=H=ps(H,Math.max(I,we)),Ze=ue.components||1;return ee=Math.max(ee,we),H+=we*Ze,{name:ue.name,type:ue.type,components:Ze,offset:Re}}),size:ps(H,Math.max(ee,I)),alignment:I}}function ps(x,I){return Math.ceil(x/I)*I}Ya.serialize=function(x,I){return x._trim(),I&&(x.isTransferred=!0,I.push(x.arrayBuffer)),{length:x.length,arrayBuffer:x.arrayBuffer}},Ya.deserialize=function(x){var I=Object.create(this.prototype);return I.arrayBuffer=x.arrayBuffer,I.length=x.length,I.capacity=x.arrayBuffer.byteLength/I.bytesPerElement,I._refreshViews(),I},Ya.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ya.prototype.clear=function(){this.length=0},Ya.prototype.resize=function(x){this.reserve(x),this.length=x},Ya.prototype.reserve=function(x){if(x>this.capacity){this.capacity=Math.max(x,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var I=this.uint8;this._refreshViews(),I&&this.uint8.set(I)}},Ya.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var os=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee){var ue=this.length;return this.resize(ue+1),this.emplace(ue,H,ee)},I.prototype.emplace=function(H,ee,ue){var me=2*H;return this.int16[me+0]=ee,this.int16[me+1]=ue,H},I}(Ya);os.prototype.bytesPerElement=4,Hr("StructArrayLayout2i4",os);var Si=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me){var we=this.length;return this.resize(we+1),this.emplace(we,H,ee,ue,me)},I.prototype.emplace=function(H,ee,ue,me,we){var Re=4*H;return this.int16[Re+0]=ee,this.int16[Re+1]=ue,this.int16[Re+2]=me,this.int16[Re+3]=we,H},I}(Ya);Si.prototype.bytesPerElement=8,Hr("StructArrayLayout4i8",Si);var ds=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me,we,Re){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,H,ee,ue,me,we,Re)},I.prototype.emplace=function(H,ee,ue,me,we,Re,Ze){var ct=6*H;return this.int16[ct+0]=ee,this.int16[ct+1]=ue,this.int16[ct+2]=me,this.int16[ct+3]=we,this.int16[ct+4]=Re,this.int16[ct+5]=Ze,H},I}(Ya);ds.prototype.bytesPerElement=12,Hr("StructArrayLayout2i4i12",ds);var Ms=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me,we,Re){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,H,ee,ue,me,we,Re)},I.prototype.emplace=function(H,ee,ue,me,we,Re,Ze){var ct=4*H,pt=8*H;return this.int16[ct+0]=ee,this.int16[ct+1]=ue,this.uint8[pt+4]=me,this.uint8[pt+5]=we,this.uint8[pt+6]=Re,this.uint8[pt+7]=Ze,H},I}(Ya);Ms.prototype.bytesPerElement=8,Hr("StructArrayLayout2i4ub8",Ms);var ys=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me,we,Re,Ze,ct,pt,Rt){var Yt=this.length;return this.resize(Yt+1),this.emplace(Yt,H,ee,ue,me,we,Re,Ze,ct,pt,Rt)},I.prototype.emplace=function(H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt){var qt=9*H,rr=18*H;return this.uint16[qt+0]=ee,this.uint16[qt+1]=ue,this.uint16[qt+2]=me,this.uint16[qt+3]=we,this.uint16[qt+4]=Re,this.uint16[qt+5]=Ze,this.uint16[qt+6]=ct,this.uint16[qt+7]=pt,this.uint8[rr+16]=Rt,this.uint8[rr+17]=Yt,H},I}(Ya);ys.prototype.bytesPerElement=18,Hr("StructArrayLayout8ui2ub18",ys);var As=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt){var rr=this.length;return this.resize(rr+1),this.emplace(rr,H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt)},I.prototype.emplace=function(H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt,rr){var fr=12*H;return this.int16[fr+0]=ee,this.int16[fr+1]=ue,this.int16[fr+2]=me,this.int16[fr+3]=we,this.uint16[fr+4]=Re,this.uint16[fr+5]=Ze,this.uint16[fr+6]=ct,this.uint16[fr+7]=pt,this.int16[fr+8]=Rt,this.int16[fr+9]=Yt,this.int16[fr+10]=qt,this.int16[fr+11]=rr,H},I}(Ya);As.prototype.bytesPerElement=24,Hr("StructArrayLayout4i4ui4i24",As);var ss=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue){var me=this.length;return this.resize(me+1),this.emplace(me,H,ee,ue)},I.prototype.emplace=function(H,ee,ue,me){var we=3*H;return this.float32[we+0]=ee,this.float32[we+1]=ue,this.float32[we+2]=me,H},I}(Ya);ss.prototype.bytesPerElement=12,Hr("StructArrayLayout3f12",ss);var Ks=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H){var ee=this.length;return this.resize(ee+1),this.emplace(ee,H)},I.prototype.emplace=function(H,ee){var ue=1*H;return this.uint32[ue+0]=ee,H},I}(Ya);Ks.prototype.bytesPerElement=4,Hr("StructArrayLayout1ul4",Ks);var ol=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me,we,Re,Ze,ct,pt){var Rt=this.length;return this.resize(Rt+1),this.emplace(Rt,H,ee,ue,me,we,Re,Ze,ct,pt)},I.prototype.emplace=function(H,ee,ue,me,we,Re,Ze,ct,pt,Rt){var Yt=10*H,qt=5*H;return this.int16[Yt+0]=ee,this.int16[Yt+1]=ue,this.int16[Yt+2]=me,this.int16[Yt+3]=we,this.int16[Yt+4]=Re,this.int16[Yt+5]=Ze,this.uint32[qt+3]=ct,this.uint16[Yt+8]=pt,this.uint16[Yt+9]=Rt,H},I}(Ya);ol.prototype.bytesPerElement=20,Hr("StructArrayLayout6i1ul2ui20",ol);var gs=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me,we,Re){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,H,ee,ue,me,we,Re)},I.prototype.emplace=function(H,ee,ue,me,we,Re,Ze){var ct=6*H;return this.int16[ct+0]=ee,this.int16[ct+1]=ue,this.int16[ct+2]=me,this.int16[ct+3]=we,this.int16[ct+4]=Re,this.int16[ct+5]=Ze,H},I}(Ya);gs.prototype.bytesPerElement=12,Hr("StructArrayLayout2i2i2i12",gs);var Qs=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me,we){var Re=this.length;return this.resize(Re+1),this.emplace(Re,H,ee,ue,me,we)},I.prototype.emplace=function(H,ee,ue,me,we,Re){var Ze=4*H,ct=8*H;return this.float32[Ze+0]=ee,this.float32[Ze+1]=ue,this.float32[Ze+2]=me,this.int16[ct+6]=we,this.int16[ct+7]=Re,H},I}(Ya);Qs.prototype.bytesPerElement=16,Hr("StructArrayLayout2f1f2i16",Qs);var Ss=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me){var we=this.length;return this.resize(we+1),this.emplace(we,H,ee,ue,me)},I.prototype.emplace=function(H,ee,ue,me,we){var Re=12*H,Ze=3*H;return this.uint8[Re+0]=ee,this.uint8[Re+1]=ue,this.float32[Ze+1]=me,this.float32[Ze+2]=we,H},I}(Ya);Ss.prototype.bytesPerElement=12,Hr("StructArrayLayout2ub2f12",Ss);var eo=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue){var me=this.length;return this.resize(me+1),this.emplace(me,H,ee,ue)},I.prototype.emplace=function(H,ee,ue,me){var we=3*H;return this.uint16[we+0]=ee,this.uint16[we+1]=ue,this.uint16[we+2]=me,H},I}(Ya);eo.prototype.bytesPerElement=6,Hr("StructArrayLayout3ui6",eo);var sl=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt,rr,fr,Er,Sr,Fr){var Br=this.length;return this.resize(Br+1),this.emplace(Br,H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt,rr,fr,Er,Sr,Fr)},I.prototype.emplace=function(H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt,rr,fr,Er,Sr,Fr,Br){var Ur=24*H,nn=12*H,hn=48*H;return this.int16[Ur+0]=ee,this.int16[Ur+1]=ue,this.uint16[Ur+2]=me,this.uint16[Ur+3]=we,this.uint32[nn+2]=Re,this.uint32[nn+3]=Ze,this.uint32[nn+4]=ct,this.uint16[Ur+10]=pt,this.uint16[Ur+11]=Rt,this.uint16[Ur+12]=Yt,this.float32[nn+7]=qt,this.float32[nn+8]=rr,this.uint8[hn+36]=fr,this.uint8[hn+37]=Er,this.uint8[hn+38]=Sr,this.uint32[nn+10]=Fr,this.int16[Ur+22]=Br,H},I}(Ya);sl.prototype.bytesPerElement=48,Hr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",sl);var ll=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt,rr,fr,Er,Sr,Fr,Br,Ur,nn,hn,Ln,En,Bn,ea,ta,Vn,la){var oa=this.length;return this.resize(oa+1),this.emplace(oa,H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt,rr,fr,Er,Sr,Fr,Br,Ur,nn,hn,Ln,En,Bn,ea,ta,Vn,la)},I.prototype.emplace=function(H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt,rr,fr,Er,Sr,Fr,Br,Ur,nn,hn,Ln,En,Bn,ea,ta,Vn,la,oa){var ra=34*H,Wa=17*H;return this.int16[ra+0]=ee,this.int16[ra+1]=ue,this.int16[ra+2]=me,this.int16[ra+3]=we,this.int16[ra+4]=Re,this.int16[ra+5]=Ze,this.int16[ra+6]=ct,this.int16[ra+7]=pt,this.uint16[ra+8]=Rt,this.uint16[ra+9]=Yt,this.uint16[ra+10]=qt,this.uint16[ra+11]=rr,this.uint16[ra+12]=fr,this.uint16[ra+13]=Er,this.uint16[ra+14]=Sr,this.uint16[ra+15]=Fr,this.uint16[ra+16]=Br,this.uint16[ra+17]=Ur,this.uint16[ra+18]=nn,this.uint16[ra+19]=hn,this.uint16[ra+20]=Ln,this.uint16[ra+21]=En,this.uint16[ra+22]=Bn,this.uint32[Wa+12]=ea,this.float32[Wa+13]=ta,this.float32[Wa+14]=Vn,this.float32[Wa+15]=la,this.float32[Wa+16]=oa,H},I}(Ya);ll.prototype.bytesPerElement=68,Hr("StructArrayLayout8i15ui1ul4f68",ll);var oe=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H){var ee=this.length;return this.resize(ee+1),this.emplace(ee,H)},I.prototype.emplace=function(H,ee){var ue=1*H;return this.float32[ue+0]=ee,H},I}(Ya);oe.prototype.bytesPerElement=4,Hr("StructArrayLayout1f4",oe);var M=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue){var me=this.length;return this.resize(me+1),this.emplace(me,H,ee,ue)},I.prototype.emplace=function(H,ee,ue,me){var we=3*H;return this.int16[we+0]=ee,this.int16[we+1]=ue,this.int16[we+2]=me,H},I}(Ya);M.prototype.bytesPerElement=6,Hr("StructArrayLayout3i6",M);var O=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue){var me=this.length;return this.resize(me+1),this.emplace(me,H,ee,ue)},I.prototype.emplace=function(H,ee,ue,me){var we=2*H,Re=4*H;return this.uint32[we+0]=ee,this.uint16[Re+2]=ue,this.uint16[Re+3]=me,H},I}(Ya);O.prototype.bytesPerElement=8,Hr("StructArrayLayout1ul2ui8",O);var R=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee){var ue=this.length;return this.resize(ue+1),this.emplace(ue,H,ee)},I.prototype.emplace=function(H,ee,ue){var me=2*H;return this.uint16[me+0]=ee,this.uint16[me+1]=ue,H},I}(Ya);R.prototype.bytesPerElement=4,Hr("StructArrayLayout2ui4",R);var j=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H){var ee=this.length;return this.resize(ee+1),this.emplace(ee,H)},I.prototype.emplace=function(H,ee){var ue=1*H;return this.uint16[ue+0]=ee,H},I}(Ya);j.prototype.bytesPerElement=2,Hr("StructArrayLayout1ui2",j);var te=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee){var ue=this.length;return this.resize(ue+1),this.emplace(ue,H,ee)},I.prototype.emplace=function(H,ee,ue){var me=2*H;return this.float32[me+0]=ee,this.float32[me+1]=ue,H},I}(Ya);te.prototype.bytesPerElement=8,Hr("StructArrayLayout2f8",te);var le=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(H,ee,ue,me){var we=this.length;return this.resize(we+1),this.emplace(we,H,ee,ue,me)},I.prototype.emplace=function(H,ee,ue,me,we){var Re=4*H;return this.float32[Re+0]=ee,this.float32[Re+1]=ue,this.float32[Re+2]=me,this.float32[Re+3]=we,H},I}(Ya);le.prototype.bytesPerElement=16,Hr("StructArrayLayout4f16",le);var pe=function(x){function I(){x.apply(this,arguments)}x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I;var H={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return H.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},H.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},H.x1.get=function(){return this._structArray.int16[this._pos2+2]},H.y1.get=function(){return this._structArray.int16[this._pos2+3]},H.x2.get=function(){return this._structArray.int16[this._pos2+4]},H.y2.get=function(){return this._structArray.int16[this._pos2+5]},H.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},H.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},H.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},H.anchorPoint.get=function(){return new n(this.anchorPointX,this.anchorPointY)},Object.defineProperties(I.prototype,H),I}(ks);pe.prototype.size=20;var ye=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.get=function(H){return new pe(this,H)},I}(ol);Hr("CollisionBoxArray",ye);var _e=function(x){function I(){x.apply(this,arguments)}x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I;var H={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return H.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},H.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},H.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},H.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},H.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},H.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},H.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},H.segment.get=function(){return this._structArray.uint16[this._pos2+10]},H.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},H.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},H.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},H.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},H.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},H.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},H.placedOrientation.set=function(ee){this._structArray.uint8[this._pos1+37]=ee},H.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},H.hidden.set=function(ee){this._structArray.uint8[this._pos1+38]=ee},H.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},H.crossTileID.set=function(ee){this._structArray.uint32[this._pos4+10]=ee},H.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(I.prototype,H),I}(ks);_e.prototype.size=48;var Ne=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.get=function(H){return new _e(this,H)},I}(sl);Hr("PlacedSymbolArray",Ne);var He=function(x){function I(){x.apply(this,arguments)}x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I;var H={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return H.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},H.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},H.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},H.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},H.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},H.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},H.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},H.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},H.key.get=function(){return this._structArray.uint16[this._pos2+8]},H.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},H.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},H.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},H.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},H.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},H.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},H.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},H.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},H.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},H.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},H.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},H.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},H.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},H.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},H.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},H.crossTileID.set=function(ee){this._structArray.uint32[this._pos4+12]=ee},H.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},H.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},H.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},H.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(I.prototype,H),I}(ks);He.prototype.size=68;var et=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.get=function(H){return new He(this,H)},I}(ll);Hr("SymbolInstanceArray",et);var yt=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.getoffsetX=function(H){return this.float32[1*H+0]},I}(oe);Hr("GlyphOffsetArray",yt);var kt=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.getx=function(H){return this.int16[3*H+0]},I.prototype.gety=function(H){return this.int16[3*H+1]},I.prototype.gettileUnitDistanceFromAnchor=function(H){return this.int16[3*H+2]},I}(M);Hr("SymbolLineVertexArray",kt);var _t=function(x){function I(){x.apply(this,arguments)}x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I;var H={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return H.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},H.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},H.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(I.prototype,H),I}(ks);_t.prototype.size=8;var wt=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.get=function(H){return new _t(this,H)},I}(O);Hr("FeatureIndexArray",wt);var vt=ei([{name:"a_pos",components:2,type:"Int16"}],4).members,Dt=function(x){x===void 0&&(x=[]),this.segments=x};function Pt(x,I){return 256*(x=f(Math.floor(x),0,255))+(I=f(Math.floor(I),0,255))}Dt.prototype.prepareSegment=function(x,I,H,ee){var ue=this.segments[this.segments.length-1];return x>Dt.MAX_VERTEX_ARRAY_LENGTH&&w("Max vertices per segment is "+Dt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+x),(!ue||ue.vertexLength+x>Dt.MAX_VERTEX_ARRAY_LENGTH||ue.sortKey!==ee)&&(ue={vertexOffset:I.length,primitiveOffset:H.length,vertexLength:0,primitiveLength:0},ee!==void 0&&(ue.sortKey=ee),this.segments.push(ue)),ue},Dt.prototype.get=function(){return this.segments},Dt.prototype.destroy=function(){for(var x=0,I=this.segments;x<I.length;x+=1){var H=I[x];for(var ee in H.vaos)H.vaos[ee].destroy()}},Dt.simpleSegment=function(x,I,H,ee){return new Dt([{vertexOffset:x,primitiveOffset:I,vertexLength:H,primitiveLength:ee,vaos:{},sortKey:0}])},Dt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Hr("SegmentVector",Dt);var Ft=ei([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),er=l(function(x){x.exports=function(I,H){var ee,ue,me,we,Re,Ze,ct,pt;for(ee=3&I.length,ue=I.length-ee,me=H,Re=3432918353,Ze=461845907,pt=0;pt<ue;)ct=255&I.charCodeAt(pt)|(255&I.charCodeAt(++pt))<<8|(255&I.charCodeAt(++pt))<<16|(255&I.charCodeAt(++pt))<<24,++pt,me=27492+(65535&(we=5*(65535&(me=(me^=ct=(65535&(ct=(ct=(65535&ct)*Re+(((ct>>>16)*Re&65535)<<16)&4294967295)<<15|ct>>>17))*Ze+(((ct>>>16)*Ze&65535)<<16)&4294967295)<<13|me>>>19))+((5*(me>>>16)&65535)<<16)&4294967295))+((58964+(we>>>16)&65535)<<16);switch(ct=0,ee){case 3:ct^=(255&I.charCodeAt(pt+2))<<16;case 2:ct^=(255&I.charCodeAt(pt+1))<<8;case 1:me^=ct=(65535&(ct=(ct=(65535&(ct^=255&I.charCodeAt(pt)))*Re+(((ct>>>16)*Re&65535)<<16)&4294967295)<<15|ct>>>17))*Ze+(((ct>>>16)*Ze&65535)<<16)&4294967295}return me^=I.length,me=2246822507*(65535&(me^=me>>>16))+((2246822507*(me>>>16)&65535)<<16)&4294967295,me=3266489909*(65535&(me^=me>>>13))+((3266489909*(me>>>16)&65535)<<16)&4294967295,(me^=me>>>16)>>>0}}),cr=l(function(x){x.exports=function(I,H){for(var ee,ue=I.length,me=H^ue,we=0;ue>=4;)ee=1540483477*(65535&(ee=255&I.charCodeAt(we)|(255&I.charCodeAt(++we))<<8|(255&I.charCodeAt(++we))<<16|(255&I.charCodeAt(++we))<<24))+((1540483477*(ee>>>16)&65535)<<16),me=1540483477*(65535&me)+((1540483477*(me>>>16)&65535)<<16)^(ee=1540483477*(65535&(ee^=ee>>>24))+((1540483477*(ee>>>16)&65535)<<16)),ue-=4,++we;switch(ue){case 3:me^=(255&I.charCodeAt(we+2))<<16;case 2:me^=(255&I.charCodeAt(we+1))<<8;case 1:me=1540483477*(65535&(me^=255&I.charCodeAt(we)))+((1540483477*(me>>>16)&65535)<<16)}return me=1540483477*(65535&(me^=me>>>13))+((1540483477*(me>>>16)&65535)<<16),(me^=me>>>15)>>>0}}),Ar=er,Tr=er,Yr=cr;Ar.murmur3=Tr,Ar.murmur2=Yr;var Gr=function(){this.ids=[],this.positions=[],this.indexed=!1};Gr.prototype.add=function(x,I,H,ee){this.ids.push($r(x)),this.positions.push(I,H,ee)},Gr.prototype.getPositions=function(x){for(var I=$r(x),H=0,ee=this.ids.length-1;H<ee;){var ue=H+ee>>1;this.ids[ue]>=I?ee=ue:H=ue+1}for(var me=[];this.ids[H]===I;){var we=this.positions[3*H],Re=this.positions[3*H+1],Ze=this.positions[3*H+2];me.push({index:we,start:Re,end:Ze}),H++}return me},Gr.serialize=function(x,I){var H=new Float64Array(x.ids),ee=new Uint32Array(x.positions);return function ue(me,we,Re,Ze){for(;Re<Ze;){for(var ct=me[Re+Ze>>1],pt=Re-1,Rt=Ze+1;;){do pt++;while(me[pt]<ct);do Rt--;while(me[Rt]>ct);if(pt>=Rt)break;In(me,pt,Rt),In(we,3*pt,3*Rt),In(we,3*pt+1,3*Rt+1),In(we,3*pt+2,3*Rt+2)}Rt-Re<Ze-Rt?(ue(me,we,Re,Rt),Re=Rt+1):(ue(me,we,Rt+1,Ze),Ze=Rt)}}(H,ee,0,H.length-1),I&&I.push(H.buffer,ee.buffer),{ids:H,positions:ee}},Gr.deserialize=function(x){var I=new Gr;return I.ids=x.ids,I.positions=x.positions,I.indexed=!0,I};var an=Math.pow(2,53)-1;function $r(x){var I=+x;return!isNaN(I)&&I<=an?I:Ar(String(x))}function In(x,I,H){var ee=x[I];x[I]=x[H],x[H]=ee}Hr("FeaturePositionMap",Gr);var jn=function(x,I){this.gl=x.gl,this.location=I},ia=function(x){function I(H,ee){x.call(this,H,ee),this.current=0}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.set=function(H){this.current!==H&&(this.current=H,this.gl.uniform1i(this.location,H))},I}(jn),jr=function(x){function I(H,ee){x.call(this,H,ee),this.current=0}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.set=function(H){this.current!==H&&(this.current=H,this.gl.uniform1f(this.location,H))},I}(jn),mn=function(x){function I(H,ee){x.call(this,H,ee),this.current=[0,0]}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.set=function(H){H[0]===this.current[0]&&H[1]===this.current[1]||(this.current=H,this.gl.uniform2f(this.location,H[0],H[1]))},I}(jn),Un=function(x){function I(H,ee){x.call(this,H,ee),this.current=[0,0,0]}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.set=function(H){H[0]===this.current[0]&&H[1]===this.current[1]&&H[2]===this.current[2]||(this.current=H,this.gl.uniform3f(this.location,H[0],H[1],H[2]))},I}(jn),Fn=function(x){function I(H,ee){x.call(this,H,ee),this.current=[0,0,0,0]}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.set=function(H){H[0]===this.current[0]&&H[1]===this.current[1]&&H[2]===this.current[2]&&H[3]===this.current[3]||(this.current=H,this.gl.uniform4f(this.location,H[0],H[1],H[2],H[3]))},I}(jn),Jn=function(x){function I(H,ee){x.call(this,H,ee),this.current=Kt.transparent}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.set=function(H){H.r===this.current.r&&H.g===this.current.g&&H.b===this.current.b&&H.a===this.current.a||(this.current=H,this.gl.uniform4f(this.location,H.r,H.g,H.b,H.a))},I}(jn),sa=new Float32Array(16),ka=function(x){function I(H,ee){x.call(this,H,ee),this.current=sa}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.set=function(H){if(H[12]!==this.current[12]||H[0]!==this.current[0])return this.current=H,void this.gl.uniformMatrix4fv(this.location,!1,H);for(var ee=1;ee<16;ee++)if(H[ee]!==this.current[ee]){this.current=H,this.gl.uniformMatrix4fv(this.location,!1,H);break}},I}(jn);function qn(x){return[Pt(255*x.r,255*x.g),Pt(255*x.b,255*x.a)]}var va=function(x,I,H){this.value=x,this.uniformNames=I.map(function(ee){return"u_"+ee}),this.type=H};va.prototype.setUniform=function(x,I,H){x.set(H.constantOr(this.value))},va.prototype.getBinding=function(x,I,H){return this.type==="color"?new Jn(x,I):new jr(x,I)};var pa=function(x,I){this.uniformNames=I.map(function(H){return"u_"+H}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};pa.prototype.setConstantPatternPositions=function(x,I){this.pixelRatioFrom=I.pixelRatio,this.pixelRatioTo=x.pixelRatio,this.patternFrom=I.tlbr,this.patternTo=x.tlbr},pa.prototype.setUniform=function(x,I,H,ee){var ue=ee==="u_pattern_to"?this.patternTo:ee==="u_pattern_from"?this.patternFrom:ee==="u_pixel_ratio_to"?this.pixelRatioTo:ee==="u_pixel_ratio_from"?this.pixelRatioFrom:null;ue&&x.set(ue)},pa.prototype.getBinding=function(x,I,H){return H.substr(0,9)==="u_pattern"?new Fn(x,I):new jr(x,I)};var Ea=function(x,I,H,ee){this.expression=x,this.type=H,this.maxValue=0,this.paintVertexAttributes=I.map(function(ue){return{name:"a_"+ue,type:"Float32",components:H==="color"?2:1,offset:0}}),this.paintVertexArray=new ee};Ea.prototype.populatePaintArray=function(x,I,H,ee,ue){var me=this.paintVertexArray.length,we=this.expression.evaluate(new $a(0),I,{},ee,[],ue);this.paintVertexArray.resize(x),this._setPaintValue(me,x,we)},Ea.prototype.updatePaintArray=function(x,I,H,ee){var ue=this.expression.evaluate({zoom:0},H,ee);this._setPaintValue(x,I,ue)},Ea.prototype._setPaintValue=function(x,I,H){if(this.type==="color")for(var ee=qn(H),ue=x;ue<I;ue++)this.paintVertexArray.emplace(ue,ee[0],ee[1]);else{for(var me=x;me<I;me++)this.paintVertexArray.emplace(me,H);this.maxValue=Math.max(this.maxValue,Math.abs(H))}},Ea.prototype.upload=function(x){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=x.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ea.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ya=function(x,I,H,ee,ue,me){this.expression=x,this.uniformNames=I.map(function(we){return"u_"+we+"_t"}),this.type=H,this.useIntegerZoom=ee,this.zoom=ue,this.maxValue=0,this.paintVertexAttributes=I.map(function(we){return{name:"a_"+we,type:"Float32",components:H==="color"?4:2,offset:0}}),this.paintVertexArray=new me};ya.prototype.populatePaintArray=function(x,I,H,ee,ue){var me=this.expression.evaluate(new $a(this.zoom),I,{},ee,[],ue),we=this.expression.evaluate(new $a(this.zoom+1),I,{},ee,[],ue),Re=this.paintVertexArray.length;this.paintVertexArray.resize(x),this._setPaintValue(Re,x,me,we)},ya.prototype.updatePaintArray=function(x,I,H,ee){var ue=this.expression.evaluate({zoom:this.zoom},H,ee),me=this.expression.evaluate({zoom:this.zoom+1},H,ee);this._setPaintValue(x,I,ue,me)},ya.prototype._setPaintValue=function(x,I,H,ee){if(this.type==="color")for(var ue=qn(H),me=qn(ee),we=x;we<I;we++)this.paintVertexArray.emplace(we,ue[0],ue[1],me[0],me[1]);else{for(var Re=x;Re<I;Re++)this.paintVertexArray.emplace(Re,H,ee);this.maxValue=Math.max(this.maxValue,Math.abs(H),Math.abs(ee))}},ya.prototype.upload=function(x){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=x.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ya.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ya.prototype.setUniform=function(x,I){var H=this.useIntegerZoom?Math.floor(I.zoom):I.zoom,ee=f(this.expression.interpolationFactor(H,this.zoom,this.zoom+1),0,1);x.set(ee)},ya.prototype.getBinding=function(x,I,H){return new jr(x,I)};var La=function(x,I,H,ee,ue,me){this.expression=x,this.type=I,this.useIntegerZoom=H,this.zoom=ee,this.layerId=me,this.zoomInPaintVertexArray=new ue,this.zoomOutPaintVertexArray=new ue};La.prototype.populatePaintArray=function(x,I,H){var ee=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(x),this.zoomOutPaintVertexArray.resize(x),this._setPaintValues(ee,x,I.patterns&&I.patterns[this.layerId],H)},La.prototype.updatePaintArray=function(x,I,H,ee,ue){this._setPaintValues(x,I,H.patterns&&H.patterns[this.layerId],ue)},La.prototype._setPaintValues=function(x,I,H,ee){if(ee&&H){var ue=H.min,me=H.mid,we=H.max,Re=ee[ue],Ze=ee[me],ct=ee[we];if(Re&&Ze&&ct)for(var pt=x;pt<I;pt++)this.zoomInPaintVertexArray.emplace(pt,Ze.tl[0],Ze.tl[1],Ze.br[0],Ze.br[1],Re.tl[0],Re.tl[1],Re.br[0],Re.br[1],Ze.pixelRatio,Re.pixelRatio),this.zoomOutPaintVertexArray.emplace(pt,Ze.tl[0],Ze.tl[1],Ze.br[0],Ze.br[1],ct.tl[0],ct.tl[1],ct.br[0],ct.br[1],Ze.pixelRatio,ct.pixelRatio)}},La.prototype.upload=function(x){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=x.createVertexBuffer(this.zoomInPaintVertexArray,Ft.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=x.createVertexBuffer(this.zoomOutPaintVertexArray,Ft.members,this.expression.isStateDependent))},La.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Fa=function(x,I,H,ee){this.binders={},this.layoutAttributes=ee,this._buffers=[];var ue=[];for(var me in x.paint._values)if(H(me)){var we=x.paint.get(me);if(we instanceof Ii&&Vo(we.property.specification)){var Re=Ei(me,x.type),Ze=we.value,ct=we.property.specification.type,pt=we.property.useIntegerZoom,Rt=we.property.specification["property-type"],Yt=Rt==="cross-faded"||Rt==="cross-faded-data-driven";if(Ze.kind==="constant")this.binders[me]=Yt?new pa(Ze.value,Re):new va(Ze.value,Re,ct),ue.push("/u_"+me);else if(Ze.kind==="source"||Yt){var qt=Li(me,ct,"source");this.binders[me]=Yt?new La(Ze,ct,pt,I,qt,x.id):new Ea(Ze,Re,ct,qt),ue.push("/a_"+me)}else{var rr=Li(me,ct,"composite");this.binders[me]=new ya(Ze,Re,ct,pt,I,rr),ue.push("/z_"+me)}}}this.cacheKey=ue.sort().join("")};Fa.prototype.getMaxValue=function(x){var I=this.binders[x];return I instanceof Ea||I instanceof ya?I.maxValue:0},Fa.prototype.populatePaintArrays=function(x,I,H,ee,ue){for(var me in this.binders){var we=this.binders[me];(we instanceof Ea||we instanceof ya||we instanceof La)&&we.populatePaintArray(x,I,H,ee,ue)}},Fa.prototype.setConstantPatternPositions=function(x,I){for(var H in this.binders){var ee=this.binders[H];ee instanceof pa&&ee.setConstantPatternPositions(x,I)}},Fa.prototype.updatePaintArrays=function(x,I,H,ee,ue){var me=!1;for(var we in x)for(var Re=0,Ze=I.getPositions(we);Re<Ze.length;Re+=1){var ct=Ze[Re],pt=H.feature(ct.index);for(var Rt in this.binders){var Yt=this.binders[Rt];if((Yt instanceof Ea||Yt instanceof ya||Yt instanceof La)&&Yt.expression.isStateDependent===!0){var qt=ee.paint.get(Rt);Yt.expression=qt.value,Yt.updatePaintArray(ct.start,ct.end,pt,x[we],ue),me=!0}}}return me},Fa.prototype.defines=function(){var x=[];for(var I in this.binders){var H=this.binders[I];(H instanceof va||H instanceof pa)&&x.push.apply(x,H.uniformNames.map(function(ee){return"#define HAS_UNIFORM_"+ee}))}return x},Fa.prototype.getPaintVertexBuffers=function(){return this._buffers},Fa.prototype.getUniforms=function(x,I){var H=[];for(var ee in this.binders){var ue=this.binders[ee];if(ue instanceof va||ue instanceof pa||ue instanceof ya)for(var me=0,we=ue.uniformNames;me<we.length;me+=1){var Re=we[me];if(I[Re]){var Ze=ue.getBinding(x,I[Re],Re);H.push({name:Re,property:ee,binding:Ze})}}}return H},Fa.prototype.setUniforms=function(x,I,H,ee){for(var ue=0,me=I;ue<me.length;ue+=1){var we=me[ue],Re=we.name,Ze=we.property,ct=we.binding;this.binders[Ze].setUniform(ct,ee,H.get(Ze),Re)}},Fa.prototype.updatePaintBuffers=function(x){for(var I in this._buffers=[],this.binders){var H=this.binders[I];if(x&&H instanceof La){var ee=x.fromScale===2?H.zoomInPaintVertexBuffer:H.zoomOutPaintVertexBuffer;ee&&this._buffers.push(ee)}else(H instanceof Ea||H instanceof ya)&&H.paintVertexBuffer&&this._buffers.push(H.paintVertexBuffer)}},Fa.prototype.upload=function(x){for(var I in this.binders){var H=this.binders[I];(H instanceof Ea||H instanceof ya||H instanceof La)&&H.upload(x)}this.updatePaintBuffers()},Fa.prototype.destroy=function(){for(var x in this.binders){var I=this.binders[x];(I instanceof Ea||I instanceof ya||I instanceof La)&&I.destroy()}};var si=function(x,I,H,ee){ee===void 0&&(ee=function(){return!0}),this.programConfigurations={};for(var ue=0,me=I;ue<me.length;ue+=1){var we=me[ue];this.programConfigurations[we.id]=new Fa(we,H,ee,x)}this.needsUpload=!1,this._featureMap=new Gr,this._bufferOffset=0};function Ei(x,I){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[x]||[x.replace(I+"-","").replace(/-/g,"_")]}function Li(x,I,H){var ee={color:{source:te,composite:le},number:{source:oe,composite:te}},ue=function(me){return{"line-pattern":{source:ys,composite:ys},"fill-pattern":{source:ys,composite:ys},"fill-extrusion-pattern":{source:ys,composite:ys}}[me]}(x);return ue&&ue[H]||ee[I][H]}si.prototype.populatePaintArrays=function(x,I,H,ee,ue,me){for(var we in this.programConfigurations)this.programConfigurations[we].populatePaintArrays(x,I,ee,ue,me);I.id!==void 0&&this._featureMap.add(I.id,H,this._bufferOffset,x),this._bufferOffset=x,this.needsUpload=!0},si.prototype.updatePaintArrays=function(x,I,H,ee){for(var ue=0,me=H;ue<me.length;ue+=1){var we=me[ue];this.needsUpload=this.programConfigurations[we.id].updatePaintArrays(x,this._featureMap,I,we,ee)||this.needsUpload}},si.prototype.get=function(x){return this.programConfigurations[x]},si.prototype.upload=function(x){if(this.needsUpload){for(var I in this.programConfigurations)this.programConfigurations[I].upload(x);this.needsUpload=!1}},si.prototype.destroy=function(){for(var x in this.programConfigurations)this.programConfigurations[x].destroy()},Hr("ConstantBinder",va),Hr("CrossFadedConstantBinder",pa),Hr("SourceExpressionBinder",Ea),Hr("CrossFadedCompositeBinder",La),Hr("CompositeExpressionBinder",ya),Hr("ProgramConfiguration",Fa,{omit:["_buffers"]}),Hr("ProgramConfigurationSet",si);var oi,_i=(oi=15,{min:-1*Math.pow(2,oi-1),max:Math.pow(2,oi-1)-1});function hi(x){for(var I=8192/x.extent,H=x.loadGeometry(),ee=0;ee<H.length;ee++)for(var ue=H[ee],me=0;me<ue.length;me++){var we=ue[me];we.x=Math.round(we.x*I),we.y=Math.round(we.y*I),(we.x<_i.min||we.x>_i.max||we.y<_i.min||we.y>_i.max)&&(w("Geometry exceeds allowed extent, reduce your vector tile buffer size"),we.x=f(we.x,_i.min,_i.max),we.y=f(we.y,_i.min,_i.max))}return H}function mo(x,I,H,ee,ue){x.emplaceBack(2*I+(ee+1)/2,2*H+(ue+1)/2)}var Vi=function(x){this.zoom=x.zoom,this.overscaling=x.overscaling,this.layers=x.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=x.index,this.hasPattern=!1,this.layoutVertexArray=new os,this.indexArray=new eo,this.segments=new Dt,this.programConfigurations=new si(vt,x.layers,x.zoom),this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};function Oo(x,I){for(var H=0;H<x.length;H++)if(rs(I,x[H]))return!0;for(var ee=0;ee<I.length;ee++)if(rs(x,I[ee]))return!0;return!!$s(x,I)}function xs(x,I,H){return!!rs(x,I)||!!vo(I,x,H)}function Ns(x,I){if(x.length===1)return ul(I,x[0]);for(var H=0;H<I.length;H++)for(var ee=I[H],ue=0;ue<ee.length;ue++)if(rs(x,ee[ue]))return!0;for(var me=0;me<x.length;me++)if(ul(I,x[me]))return!0;for(var we=0;we<I.length;we++)if($s(x,I[we]))return!0;return!1}function cl(x,I,H){if(x.length>1){if($s(x,I))return!0;for(var ee=0;ee<I.length;ee++)if(vo(I[ee],x,H))return!0}for(var ue=0;ue<x.length;ue++)if(vo(x[ue],I,H))return!0;return!1}function $s(x,I){if(x.length===0||I.length===0)return!1;for(var H=0;H<x.length-1;H++)for(var ee=x[H],ue=x[H+1],me=0;me<I.length-1;me++)if(el(ee,ue,I[me],I[me+1]))return!0;return!1}function el(x,I,H,ee){return C(x,H,ee)!==C(I,H,ee)&&C(x,I,H)!==C(x,I,ee)}function vo(x,I,H){var ee=H*H;if(I.length===1)return x.distSqr(I[0])<ee;for(var ue=1;ue<I.length;ue++)if(qs(x,I[ue-1],I[ue])<ee)return!0;return!1}function qs(x,I,H){var ee=I.distSqr(H);if(ee===0)return x.distSqr(I);var ue=((x.x-I.x)*(H.x-I.x)+(x.y-I.y)*(H.y-I.y))/ee;return ue<0?x.distSqr(I):ue>1?x.distSqr(H):x.distSqr(H.sub(I)._mult(ue)._add(I))}function ul(x,I){for(var H,ee,ue,me=!1,we=0;we<x.length;we++)for(var Re=0,Ze=(H=x[we]).length-1;Re<H.length;Ze=Re++)ee=H[Re],ue=H[Ze],ee.y>I.y!=ue.y>I.y&&I.x<(ue.x-ee.x)*(I.y-ee.y)/(ue.y-ee.y)+ee.x&&(me=!me);return me}function rs(x,I){for(var H=!1,ee=0,ue=x.length-1;ee<x.length;ue=ee++){var me=x[ee],we=x[ue];me.y>I.y!=we.y>I.y&&I.x<(we.x-me.x)*(I.y-me.y)/(we.y-me.y)+me.x&&(H=!H)}return H}function fl(x,I,H){var ee=H[0],ue=H[2];if(x.x<ee.x&&I.x<ee.x||x.x>ue.x&&I.x>ue.x||x.y<ee.y&&I.y<ee.y||x.y>ue.y&&I.y>ue.y)return!1;var me=C(x,I,H[0]);return me!==C(x,I,H[1])||me!==C(x,I,H[2])||me!==C(x,I,H[3])}function wi(x,I,H){var ee=I.paint.get(x).value;return ee.kind==="constant"?ee.value:H.programConfigurations.get(I.id).getMaxValue(x)}function Lo(x){return Math.sqrt(x[0]*x[0]+x[1]*x[1])}function Co(x,I,H,ee,ue){if(!I[0]&&!I[1])return x;var me=n.convert(I)._mult(ue);H==="viewport"&&me._rotate(-ee);for(var we=[],Re=0;Re<x.length;Re++){var Ze=x[Re];we.push(Ze.sub(me))}return we}Vi.prototype.populate=function(x,I,H){var ee=this.layers[0],ue=[],me=null;ee.type==="circle"&&(me=ee.layout.get("circle-sort-key"));for(var we=0,Re=x;we<Re.length;we+=1){var Ze=Re[we],ct=Ze.feature,pt=Ze.id,Rt=Ze.index,Yt=Ze.sourceLayerIndex,qt=this.layers[0]._featureFilter.needGeometry,rr={type:ct.type,id:pt,properties:ct.properties,geometry:qt?hi(ct):[]};if(this.layers[0]._featureFilter.filter(new $a(this.zoom),rr,H)){qt||(rr.geometry=hi(ct));var fr=me?me.evaluate(rr,{},H):void 0,Er={id:pt,properties:ct.properties,type:ct.type,sourceLayerIndex:Yt,index:Rt,geometry:rr.geometry,patterns:{},sortKey:fr};ue.push(Er)}}me&&ue.sort(function(Bn,ea){return Bn.sortKey-ea.sortKey});for(var Sr=0,Fr=ue;Sr<Fr.length;Sr+=1){var Br=Fr[Sr],Ur=Br,nn=Ur.geometry,hn=Ur.index,Ln=Ur.sourceLayerIndex,En=x[hn].feature;this.addFeature(Br,nn,hn,H),I.featureIndex.insert(En,nn,hn,Ln,this.index)}},Vi.prototype.update=function(x,I,H){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(x,I,this.stateDependentLayers,H)},Vi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Vi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Vi.prototype.upload=function(x){this.uploaded||(this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,vt),this.indexBuffer=x.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(x),this.uploaded=!0},Vi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Vi.prototype.addFeature=function(x,I,H,ee){for(var ue=0,me=I;ue<me.length;ue+=1)for(var we=0,Re=me[ue];we<Re.length;we+=1){var Ze=Re[we],ct=Ze.x,pt=Ze.y;if(!(ct<0||ct>=8192||pt<0||pt>=8192)){var Rt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,x.sortKey),Yt=Rt.vertexLength;mo(this.layoutVertexArray,ct,pt,-1,-1),mo(this.layoutVertexArray,ct,pt,1,-1),mo(this.layoutVertexArray,ct,pt,1,1),mo(this.layoutVertexArray,ct,pt,-1,1),this.indexArray.emplaceBack(Yt,Yt+1,Yt+2),this.indexArray.emplaceBack(Yt,Yt+3,Yt+2),Rt.vertexLength+=4,Rt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,x,H,{},ee)},Hr("CircleBucket",Vi,{omit:["layers"]});var _l=new Eo({"circle-sort-key":new ma(ze.layout_circle["circle-sort-key"])}),nu={paint:new Eo({"circle-radius":new ma(ze.paint_circle["circle-radius"]),"circle-color":new ma(ze.paint_circle["circle-color"]),"circle-blur":new ma(ze.paint_circle["circle-blur"]),"circle-opacity":new ma(ze.paint_circle["circle-opacity"]),"circle-translate":new na(ze.paint_circle["circle-translate"]),"circle-translate-anchor":new na(ze.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new na(ze.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new na(ze.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ma(ze.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ma(ze.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ma(ze.paint_circle["circle-stroke-opacity"])}),layout:_l},Xo=typeof Float32Array<"u"?Float32Array:Array;function Zl(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}function hl(x,I,H){var ee=I[0],ue=I[1],me=I[2],we=I[3],Re=I[4],Ze=I[5],ct=I[6],pt=I[7],Rt=I[8],Yt=I[9],qt=I[10],rr=I[11],fr=I[12],Er=I[13],Sr=I[14],Fr=I[15],Br=H[0],Ur=H[1],nn=H[2],hn=H[3];return x[0]=Br*ee+Ur*Re+nn*Rt+hn*fr,x[1]=Br*ue+Ur*Ze+nn*Yt+hn*Er,x[2]=Br*me+Ur*ct+nn*qt+hn*Sr,x[3]=Br*we+Ur*pt+nn*rr+hn*Fr,Br=H[4],Ur=H[5],nn=H[6],hn=H[7],x[4]=Br*ee+Ur*Re+nn*Rt+hn*fr,x[5]=Br*ue+Ur*Ze+nn*Yt+hn*Er,x[6]=Br*me+Ur*ct+nn*qt+hn*Sr,x[7]=Br*we+Ur*pt+nn*rr+hn*Fr,Br=H[8],Ur=H[9],nn=H[10],hn=H[11],x[8]=Br*ee+Ur*Re+nn*Rt+hn*fr,x[9]=Br*ue+Ur*Ze+nn*Yt+hn*Er,x[10]=Br*me+Ur*ct+nn*qt+hn*Sr,x[11]=Br*we+Ur*pt+nn*rr+hn*Fr,Br=H[12],Ur=H[13],nn=H[14],hn=H[15],x[12]=Br*ee+Ur*Re+nn*Rt+hn*fr,x[13]=Br*ue+Ur*Ze+nn*Yt+hn*Er,x[14]=Br*me+Ur*ct+nn*qt+hn*Sr,x[15]=Br*we+Ur*pt+nn*rr+hn*Fr,x}Math.hypot||(Math.hypot=function(){for(var x=arguments,I=0,H=arguments.length;H--;)I+=x[H]*x[H];return Math.sqrt(I)});var au=hl,Hs,iu=function(x,I,H){return x[0]=I[0]-H[0],x[1]=I[1]-H[1],x[2]=I[2]-H[2],x};Hs=new Xo(3),Xo!=Float32Array&&(Hs[0]=0,Hs[1]=0,Hs[2]=0);function wl(x,I,H){var ee=I[0],ue=I[1],me=I[2],we=I[3];return x[0]=H[0]*ee+H[4]*ue+H[8]*me+H[12]*we,x[1]=H[1]*ee+H[5]*ue+H[9]*me+H[13]*we,x[2]=H[2]*ee+H[6]*ue+H[10]*me+H[14]*we,x[3]=H[3]*ee+H[7]*ue+H[11]*me+H[15]*we,x}(function(){(function(){var x=new Xo(4);return Xo!=Float32Array&&(x[0]=0,x[1]=0,x[2]=0,x[3]=0),x})()})();var Jl=function(x){var I=x[0],H=x[1];return I*I+H*H},bh=(function(){(function(){var x=new Xo(2);return Xo!=Float32Array&&(x[0]=0,x[1]=0),x})()}(),function(x){function I(H){x.call(this,H,nu)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.createBucket=function(H){return new Vi(H)},I.prototype.queryRadius=function(H){var ee=H;return wi("circle-radius",this,ee)+wi("circle-stroke-width",this,ee)+Lo(this.paint.get("circle-translate"))},I.prototype.queryIntersectsFeature=function(H,ee,ue,me,we,Re,Ze,ct){for(var pt=Co(H,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Re.angle,Ze),Rt=this.paint.get("circle-radius").evaluate(ee,ue)+this.paint.get("circle-stroke-width").evaluate(ee,ue),Yt=this.paint.get("circle-pitch-alignment")==="map",qt=Yt?pt:function(Ln,En){return Ln.map(function(Bn){return Vu(Bn,En)})}(pt,ct),rr=Yt?Rt*Ze:Rt,fr=0,Er=me;fr<Er.length;fr+=1)for(var Sr=0,Fr=Er[fr];Sr<Fr.length;Sr+=1){var Br=Fr[Sr],Ur=Yt?Br:Vu(Br,ct),nn=rr,hn=wl([],[Br.x,Br.y,0,1],ct);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?nn*=hn[3]/Re.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(nn*=Re.cameraToCenterDistance/hn[3]),xs(qt,Ur,nn))return!0}return!1},I}(qo));function Vu(x,I){var H=wl([],[x.x,x.y,0,1],I);return new n(H[0]/H[3],H[1]/H[3])}var qu=function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I}(Vi);function ou(x,I,H,ee){var ue=I.width,me=I.height;if(ee){if(ee instanceof Uint8ClampedArray)ee=new Uint8Array(ee.buffer);else if(ee.length!==ue*me*H)throw new RangeError("mismatched image size")}else ee=new Uint8Array(ue*me*H);return x.width=ue,x.height=me,x.data=ee,x}function Hu(x,I,H){var ee=I.width,ue=I.height;if(ee!==x.width||ue!==x.height){var me=ou({},{width:ee,height:ue},H);su(x,me,{x:0,y:0},{x:0,y:0},{width:Math.min(x.width,ee),height:Math.min(x.height,ue)},H),x.width=ee,x.height=ue,x.data=me.data}}function su(x,I,H,ee,ue,me){if(ue.width===0||ue.height===0)return I;if(ue.width>x.width||ue.height>x.height||H.x>x.width-ue.width||H.y>x.height-ue.height)throw new RangeError("out of range source coordinates for image copy");if(ue.width>I.width||ue.height>I.height||ee.x>I.width-ue.width||ee.y>I.height-ue.height)throw new RangeError("out of range destination coordinates for image copy");for(var we=x.data,Re=I.data,Ze=0;Ze<ue.height;Ze++)for(var ct=((H.y+Ze)*x.width+H.x)*me,pt=((ee.y+Ze)*I.width+ee.x)*me,Rt=0;Rt<ue.width*me;Rt++)Re[pt+Rt]=we[ct+Rt];return I}Hr("HeatmapBucket",qu,{omit:["layers"]});var pl=function(x,I){ou(this,x,1,I)};pl.prototype.resize=function(x){Hu(this,x,1)},pl.prototype.clone=function(){return new pl({width:this.width,height:this.height},new Uint8Array(this.data))},pl.copy=function(x,I,H,ee,ue){su(x,I,H,ee,ue,1)};var Zo=function(x,I){ou(this,x,4,I)};Zo.prototype.resize=function(x){Hu(this,x,4)},Zo.prototype.replace=function(x,I){I?this.data.set(x):x instanceof Uint8ClampedArray?this.data=new Uint8Array(x.buffer):this.data=x},Zo.prototype.clone=function(){return new Zo({width:this.width,height:this.height},new Uint8Array(this.data))},Zo.copy=function(x,I,H,ee,ue){su(x,I,H,ee,ue,4)},Hr("AlphaImage",pl),Hr("RGBAImage",Zo);var _h={paint:new Eo({"heatmap-radius":new ma(ze.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ma(ze.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new na(ze.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ts(ze.paint_heatmap["heatmap-color"]),"heatmap-opacity":new na(ze.paint_heatmap["heatmap-opacity"])})};function Gu(x,I){for(var H=new Uint8Array(1024),ee={},ue=0,me=0;ue<256;ue++,me+=4){ee[I]=ue/255;var we=x.evaluate(ee);H[me+0]=Math.floor(255*we.r/we.a),H[me+1]=Math.floor(255*we.g/we.a),H[me+2]=Math.floor(255*we.b/we.a),H[me+3]=Math.floor(255*we.a)}return new Zo({width:256,height:1},H)}var wh=function(x){function I(H){x.call(this,H,_h),this._updateColorRamp()}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.createBucket=function(H){return new qu(H)},I.prototype._handleSpecialPaintPropertyUpdate=function(H){H==="heatmap-color"&&this._updateColorRamp()},I.prototype._updateColorRamp=function(){var H=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Gu(H,"heatmapDensity"),this.colorRampTexture=null},I.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},I.prototype.queryRadius=function(){return 0},I.prototype.queryIntersectsFeature=function(){return!1},I.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},I}(qo),Th={paint:new Eo({"hillshade-illumination-direction":new na(ze.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new na(ze.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new na(ze.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new na(ze.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new na(ze.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new na(ze.paint_hillshade["hillshade-accent-color"])})},kh=function(x){function I(H){x.call(this,H,Th)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},I}(qo),Yu=ei([{name:"a_pos",components:2,type:"Int16"}],4).members,lu=xc,Mh=xc;function xc(x,I,H){H=H||2;var ee,ue,me,we,Re,Ze,ct,pt=I&&I.length,Rt=pt?I[0]*H:x.length,Yt=Wu(x,0,Rt,H,!0),qt=[];if(!Yt||Yt.next===Yt.prev)return qt;if(pt&&(Yt=function(fr,Er,Sr,Fr){var Br,Ur,nn,hn,Ln,En=[];for(Br=0,Ur=Er.length;Br<Ur;Br++)nn=Er[Br]*Fr,hn=Br<Ur-1?Er[Br+1]*Fr:fr.length,(Ln=Wu(fr,nn,hn,Fr,!1))===Ln.next&&(Ln.steiner=!0),En.push(Oh(Ln));for(En.sort(Ch),Br=0;Br<En.length;Br++)Ph(En[Br],Sr),Sr=tl(Sr,Sr.next);return Sr}(x,I,Yt,H)),x.length>80*H){ee=me=x[0],ue=we=x[1];for(var rr=H;rr<Rt;rr+=H)(Re=x[rr])<ee&&(ee=Re),(Ze=x[rr+1])<ue&&(ue=Ze),Re>me&&(me=Re),Ze>we&&(we=Ze);ct=(ct=Math.max(me-ee,we-ue))!==0?1/ct:0}return Kl(Yt,qt,H,ee,ue,ct),qt}function Wu(x,I,H,ee,ue){var me,we;if(ue===fu(x,I,H,ee)>0)for(me=I;me<H;me+=ee)we=Ju(me,x[me],x[me+1],we);else for(me=H-ee;me>=I;me-=ee)we=Ju(me,x[me],x[me+1],we);return we&&bc(we,we.next)&&($l(we),we=we.next),we}function tl(x,I){if(!x)return x;I||(I=x);var H,ee=x;do if(H=!1,ee.steiner||!bc(ee,ee.next)&&to(ee.prev,ee,ee.next)!==0)ee=ee.next;else{if($l(ee),(ee=I=ee.prev)===ee.next)break;H=!0}while(H||ee!==I);return I}function Kl(x,I,H,ee,ue,me,we){if(x){!we&&me&&function(pt,Rt,Yt,qt){var rr=pt;do rr.z===null&&(rr.z=cu(rr.x,rr.y,Rt,Yt,qt)),rr.prevZ=rr.prev,rr.nextZ=rr.next,rr=rr.next;while(rr!==pt);rr.prevZ.nextZ=null,rr.prevZ=null,function(fr){var Er,Sr,Fr,Br,Ur,nn,hn,Ln,En=1;do{for(Sr=fr,fr=null,Ur=null,nn=0;Sr;){for(nn++,Fr=Sr,hn=0,Er=0;Er<En&&(hn++,Fr=Fr.nextZ);Er++);for(Ln=En;hn>0||Ln>0&&Fr;)hn!==0&&(Ln===0||!Fr||Sr.z<=Fr.z)?(Br=Sr,Sr=Sr.nextZ,hn--):(Br=Fr,Fr=Fr.nextZ,Ln--),Ur?Ur.nextZ=Br:fr=Br,Br.prevZ=Ur,Ur=Br;Sr=Fr}Ur.nextZ=null,En*=2}while(nn>1)}(rr)}(x,ee,ue,me);for(var Re,Ze,ct=x;x.prev!==x.next;)if(Re=x.prev,Ze=x.next,me?Sh(x,ee,ue,me):Ah(x))I.push(Re.i/H),I.push(x.i/H),I.push(Ze.i/H),$l(x),x=Ze.next,ct=Ze.next;else if((x=Ze)===ct){we?we===1?Kl(x=Eh(tl(x),I,H),I,H,ee,ue,me,2):we===2&&Lh(x,I,H,ee,ue,me):Kl(tl(x),I,H,ee,ue,me,1);break}}}function Ah(x){var I=x.prev,H=x,ee=x.next;if(to(I,H,ee)>=0)return!1;for(var ue=x.next.next;ue!==x.prev;){if(Tl(I.x,I.y,H.x,H.y,ee.x,ee.y,ue.x,ue.y)&&to(ue.prev,ue,ue.next)>=0)return!1;ue=ue.next}return!0}function Sh(x,I,H,ee){var ue=x.prev,me=x,we=x.next;if(to(ue,me,we)>=0)return!1;for(var Re=ue.x<me.x?ue.x<we.x?ue.x:we.x:me.x<we.x?me.x:we.x,Ze=ue.y<me.y?ue.y<we.y?ue.y:we.y:me.y<we.y?me.y:we.y,ct=ue.x>me.x?ue.x>we.x?ue.x:we.x:me.x>we.x?me.x:we.x,pt=ue.y>me.y?ue.y>we.y?ue.y:we.y:me.y>we.y?me.y:we.y,Rt=cu(Re,Ze,I,H,ee),Yt=cu(ct,pt,I,H,ee),qt=x.prevZ,rr=x.nextZ;qt&&qt.z>=Rt&&rr&&rr.z<=Yt;){if(qt!==x.prev&&qt!==x.next&&Tl(ue.x,ue.y,me.x,me.y,we.x,we.y,qt.x,qt.y)&&to(qt.prev,qt,qt.next)>=0||(qt=qt.prevZ,rr!==x.prev&&rr!==x.next&&Tl(ue.x,ue.y,me.x,me.y,we.x,we.y,rr.x,rr.y)&&to(rr.prev,rr,rr.next)>=0))return!1;rr=rr.nextZ}for(;qt&&qt.z>=Rt;){if(qt!==x.prev&&qt!==x.next&&Tl(ue.x,ue.y,me.x,me.y,we.x,we.y,qt.x,qt.y)&&to(qt.prev,qt,qt.next)>=0)return!1;qt=qt.prevZ}for(;rr&&rr.z<=Yt;){if(rr!==x.prev&&rr!==x.next&&Tl(ue.x,ue.y,me.x,me.y,we.x,we.y,rr.x,rr.y)&&to(rr.prev,rr,rr.next)>=0)return!1;rr=rr.nextZ}return!0}function Eh(x,I,H){var ee=x;do{var ue=ee.prev,me=ee.next.next;!bc(ue,me)&&Xu(ue,ee,ee.next,me)&&Ql(ue,me)&&Ql(me,ue)&&(I.push(ue.i/H),I.push(ee.i/H),I.push(me.i/H),$l(ee),$l(ee.next),ee=x=me),ee=ee.next}while(ee!==x);return tl(ee)}function Lh(x,I,H,ee,ue,me){var we=x;do{for(var Re=we.next.next;Re!==we.prev;){if(we.i!==Re.i&&zh(we,Re)){var Ze=Zu(we,Re);return we=tl(we,we.next),Ze=tl(Ze,Ze.next),Kl(we,I,H,ee,ue,me),void Kl(Ze,I,H,ee,ue,me)}Re=Re.next}we=we.next}while(we!==x)}function Ch(x,I){return x.x-I.x}function Ph(x,I){if(I=function(ee,ue){var me,we=ue,Re=ee.x,Ze=ee.y,ct=-1/0;do{if(Ze<=we.y&&Ze>=we.next.y&&we.next.y!==we.y){var pt=we.x+(Ze-we.y)*(we.next.x-we.x)/(we.next.y-we.y);if(pt<=Re&&pt>ct){if(ct=pt,pt===Re){if(Ze===we.y)return we;if(Ze===we.next.y)return we.next}me=we.x<we.next.x?we:we.next}}we=we.next}while(we!==ue);if(!me)return null;if(Re===ct)return me;var Rt,Yt=me,qt=me.x,rr=me.y,fr=1/0;we=me;do Re>=we.x&&we.x>=qt&&Re!==we.x&&Tl(Ze<rr?Re:ct,Ze,qt,rr,Ze<rr?ct:Re,Ze,we.x,we.y)&&(Rt=Math.abs(Ze-we.y)/(Re-we.x),Ql(we,ee)&&(Rt<fr||Rt===fr&&(we.x>me.x||we.x===me.x&&Ih(me,we)))&&(me=we,fr=Rt)),we=we.next;while(we!==Yt);return me}(x,I)){var H=Zu(I,x);tl(I,I.next),tl(H,H.next)}}function Ih(x,I){return to(x.prev,x,I.prev)<0&&to(I.next,x,x.next)<0}function cu(x,I,H,ee,ue){return(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x=32767*(x-H)*ue)|x<<8))|x<<4))|x<<2))|x<<1))|(I=1431655765&((I=858993459&((I=252645135&((I=16711935&((I=32767*(I-ee)*ue)|I<<8))|I<<4))|I<<2))|I<<1))<<1}function Oh(x){var I=x,H=x;do(I.x<H.x||I.x===H.x&&I.y<H.y)&&(H=I),I=I.next;while(I!==x);return H}function Tl(x,I,H,ee,ue,me,we,Re){return(ue-we)*(I-Re)-(x-we)*(me-Re)>=0&&(x-we)*(ee-Re)-(H-we)*(I-Re)>=0&&(H-we)*(me-Re)-(ue-we)*(ee-Re)>=0}function zh(x,I){return x.next.i!==I.i&&x.prev.i!==I.i&&!function(H,ee){var ue=H;do{if(ue.i!==H.i&&ue.next.i!==H.i&&ue.i!==ee.i&&ue.next.i!==ee.i&&Xu(ue,ue.next,H,ee))return!0;ue=ue.next}while(ue!==H);return!1}(x,I)&&(Ql(x,I)&&Ql(I,x)&&function(H,ee){var ue=H,me=!1,we=(H.x+ee.x)/2,Re=(H.y+ee.y)/2;do ue.y>Re!=ue.next.y>Re&&ue.next.y!==ue.y&&we<(ue.next.x-ue.x)*(Re-ue.y)/(ue.next.y-ue.y)+ue.x&&(me=!me),ue=ue.next;while(ue!==H);return me}(x,I)&&(to(x.prev,x,I.prev)||to(x,I.prev,I))||bc(x,I)&&to(x.prev,x,x.next)>0&&to(I.prev,I,I.next)>0)}function to(x,I,H){return(I.y-x.y)*(H.x-I.x)-(I.x-x.x)*(H.y-I.y)}function bc(x,I){return x.x===I.x&&x.y===I.y}function Xu(x,I,H,ee){var ue=wc(to(x,I,H)),me=wc(to(x,I,ee)),we=wc(to(H,ee,x)),Re=wc(to(H,ee,I));return ue!==me&&we!==Re||!(ue!==0||!_c(x,H,I))||!(me!==0||!_c(x,ee,I))||!(we!==0||!_c(H,x,ee))||!(Re!==0||!_c(H,I,ee))}function _c(x,I,H){return I.x<=Math.max(x.x,H.x)&&I.x>=Math.min(x.x,H.x)&&I.y<=Math.max(x.y,H.y)&&I.y>=Math.min(x.y,H.y)}function wc(x){return x>0?1:x<0?-1:0}function Ql(x,I){return to(x.prev,x,x.next)<0?to(x,I,x.next)>=0&&to(x,x.prev,I)>=0:to(x,I,x.prev)<0||to(x,x.next,I)<0}function Zu(x,I){var H=new uu(x.i,x.x,x.y),ee=new uu(I.i,I.x,I.y),ue=x.next,me=I.prev;return x.next=I,I.prev=x,H.next=ue,ue.prev=H,ee.next=H,H.prev=ee,me.next=ee,ee.prev=me,ee}function Ju(x,I,H,ee){var ue=new uu(x,I,H);return ee?(ue.next=ee.next,ue.prev=ee,ee.next.prev=ue,ee.next=ue):(ue.prev=ue,ue.next=ue),ue}function $l(x){x.next.prev=x.prev,x.prev.next=x.next,x.prevZ&&(x.prevZ.nextZ=x.nextZ),x.nextZ&&(x.nextZ.prevZ=x.prevZ)}function uu(x,I,H){this.i=x,this.x=I,this.y=H,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function fu(x,I,H,ee){for(var ue=0,me=I,we=H-ee;me<H;me+=ee)ue+=(x[we]-x[me])*(x[me+1]+x[we+1]),we=me;return ue}function Dh(x,I,H,ee,ue){(function me(we,Re,Ze,ct,pt){for(;ct>Ze;){if(ct-Ze>600){var Rt=ct-Ze+1,Yt=Re-Ze+1,qt=Math.log(Rt),rr=.5*Math.exp(2*qt/3),fr=.5*Math.sqrt(qt*rr*(Rt-rr)/Rt)*(Yt-Rt/2<0?-1:1),Er=Math.max(Ze,Math.floor(Re-Yt*rr/Rt+fr)),Sr=Math.min(ct,Math.floor(Re+(Rt-Yt)*rr/Rt+fr));me(we,Re,Er,Sr,pt)}var Fr=we[Re],Br=Ze,Ur=ct;for(ec(we,Ze,Re),pt(we[ct],Fr)>0&&ec(we,Ze,ct);Br<Ur;){for(ec(we,Br,Ur),Br++,Ur--;pt(we[Br],Fr)<0;)Br++;for(;pt(we[Ur],Fr)>0;)Ur--}pt(we[Ze],Fr)===0?ec(we,Ze,Ur):(Ur++,ec(we,Ur,ct)),Ur<=Re&&(Ze=Ur+1),Re<=Ur&&(ct=Ur-1)}})(x,I,H||0,ee||x.length-1,ue||Rh)}function ec(x,I,H){var ee=x[I];x[I]=x[H],x[H]=ee}function Rh(x,I){return x<I?-1:x>I?1:0}function hu(x,I){var H=x.length;if(H<=1)return[x];for(var ee,ue,me=[],we=0;we<H;we++){var Re=S(x[we]);Re!==0&&(x[we].area=Math.abs(Re),ue===void 0&&(ue=Re<0),ue===Re<0?(ee&&me.push(ee),ee=[x[we]]):ee.push(x[we]))}if(ee&&me.push(ee),I>1)for(var Ze=0;Ze<me.length;Ze++)me[Ze].length<=I||(Dh(me[Ze],I,1,me[Ze].length-1,Fh),me[Ze]=me[Ze].slice(0,I));return me}function Fh(x,I){return I.area-x.area}function pu(x,I,H){for(var ee=H.patternDependencies,ue=!1,me=0,we=I;me<we.length;me+=1){var Re=we[me].paint.get(x+"-pattern");Re.isConstant()||(ue=!0);var Ze=Re.constantOr(null);Ze&&(ue=!0,ee[Ze.to]=!0,ee[Ze.from]=!0)}return ue}function du(x,I,H,ee,ue){for(var me=ue.patternDependencies,we=0,Re=I;we<Re.length;we+=1){var Ze=Re[we],ct=Ze.paint.get(x+"-pattern").value;if(ct.kind!=="constant"){var pt=ct.evaluate({zoom:ee-1},H,{},ue.availableImages),Rt=ct.evaluate({zoom:ee},H,{},ue.availableImages),Yt=ct.evaluate({zoom:ee+1},H,{},ue.availableImages);pt=pt&&pt.name?pt.name:pt,Rt=Rt&&Rt.name?Rt.name:Rt,Yt=Yt&&Yt.name?Yt.name:Yt,me[pt]=!0,me[Rt]=!0,me[Yt]=!0,H.patterns[Ze.id]={min:pt,mid:Rt,max:Yt}}}return H}xc.deviation=function(x,I,H,ee){var ue=I&&I.length,me=ue?I[0]*H:x.length,we=Math.abs(fu(x,0,me,H));if(ue)for(var Re=0,Ze=I.length;Re<Ze;Re++){var ct=I[Re]*H,pt=Re<Ze-1?I[Re+1]*H:x.length;we-=Math.abs(fu(x,ct,pt,H))}var Rt=0;for(Re=0;Re<ee.length;Re+=3){var Yt=ee[Re]*H,qt=ee[Re+1]*H,rr=ee[Re+2]*H;Rt+=Math.abs((x[Yt]-x[rr])*(x[qt+1]-x[Yt+1])-(x[Yt]-x[qt])*(x[rr+1]-x[Yt+1]))}return we===0&&Rt===0?0:Math.abs((Rt-we)/we)},xc.flatten=function(x){for(var I=x[0][0].length,H={vertices:[],holes:[],dimensions:I},ee=0,ue=0;ue<x.length;ue++){for(var me=0;me<x[ue].length;me++)for(var we=0;we<I;we++)H.vertices.push(x[ue][me][we]);ue>0&&(ee+=x[ue-1].length,H.holes.push(ee))}return H},lu.default=Mh;var Es=function(x){this.zoom=x.zoom,this.overscaling=x.overscaling,this.layers=x.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=x.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new os,this.indexArray=new eo,this.indexArray2=new R,this.programConfigurations=new si(Yu,x.layers,x.zoom),this.segments=new Dt,this.segments2=new Dt,this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};Es.prototype.populate=function(x,I,H){this.hasPattern=pu("fill",this.layers,I);for(var ee=this.layers[0].layout.get("fill-sort-key"),ue=[],me=0,we=x;me<we.length;me+=1){var Re=we[me],Ze=Re.feature,ct=Re.id,pt=Re.index,Rt=Re.sourceLayerIndex,Yt=this.layers[0]._featureFilter.needGeometry,qt={type:Ze.type,id:ct,properties:Ze.properties,geometry:Yt?hi(Ze):[]};if(this.layers[0]._featureFilter.filter(new $a(this.zoom),qt,H)){Yt||(qt.geometry=hi(Ze));var rr=ee?ee.evaluate(qt,{},H,I.availableImages):void 0,fr={id:ct,properties:Ze.properties,type:Ze.type,sourceLayerIndex:Rt,index:pt,geometry:qt.geometry,patterns:{},sortKey:rr};ue.push(fr)}}ee&&ue.sort(function(Bn,ea){return Bn.sortKey-ea.sortKey});for(var Er=0,Sr=ue;Er<Sr.length;Er+=1){var Fr=Sr[Er],Br=Fr,Ur=Br.geometry,nn=Br.index,hn=Br.sourceLayerIndex;if(this.hasPattern){var Ln=du("fill",this.layers,Fr,this.zoom,I);this.patternFeatures.push(Ln)}else this.addFeature(Fr,Ur,nn,H,{});var En=x[nn].feature;I.featureIndex.insert(En,Ur,nn,hn,this.index)}},Es.prototype.update=function(x,I,H){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(x,I,this.stateDependentLayers,H)},Es.prototype.addFeatures=function(x,I,H){for(var ee=0,ue=this.patternFeatures;ee<ue.length;ee+=1){var me=ue[ee];this.addFeature(me,me.geometry,me.index,I,H)}},Es.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Es.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Es.prototype.upload=function(x){this.uploaded||(this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,Yu),this.indexBuffer=x.createIndexBuffer(this.indexArray),this.indexBuffer2=x.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(x),this.uploaded=!0},Es.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Es.prototype.addFeature=function(x,I,H,ee,ue){for(var me=0,we=hu(I,500);me<we.length;me+=1){for(var Re=we[me],Ze=0,ct=0,pt=Re;ct<pt.length;ct+=1)Ze+=pt[ct].length;for(var Rt=this.segments.prepareSegment(Ze,this.layoutVertexArray,this.indexArray),Yt=Rt.vertexLength,qt=[],rr=[],fr=0,Er=Re;fr<Er.length;fr+=1){var Sr=Er[fr];if(Sr.length!==0){Sr!==Re[0]&&rr.push(qt.length/2);var Fr=this.segments2.prepareSegment(Sr.length,this.layoutVertexArray,this.indexArray2),Br=Fr.vertexLength;this.layoutVertexArray.emplaceBack(Sr[0].x,Sr[0].y),this.indexArray2.emplaceBack(Br+Sr.length-1,Br),qt.push(Sr[0].x),qt.push(Sr[0].y);for(var Ur=1;Ur<Sr.length;Ur++)this.layoutVertexArray.emplaceBack(Sr[Ur].x,Sr[Ur].y),this.indexArray2.emplaceBack(Br+Ur-1,Br+Ur),qt.push(Sr[Ur].x),qt.push(Sr[Ur].y);Fr.vertexLength+=Sr.length,Fr.primitiveLength+=Sr.length}}for(var nn=lu(qt,rr),hn=0;hn<nn.length;hn+=3)this.indexArray.emplaceBack(Yt+nn[hn],Yt+nn[hn+1],Yt+nn[hn+2]);Rt.vertexLength+=Ze,Rt.primitiveLength+=nn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,x,H,ue,ee)},Hr("FillBucket",Es,{omit:["layers","patternFeatures"]});var Bh=new Eo({"fill-sort-key":new ma(ze.layout_fill["fill-sort-key"])}),Nh={paint:new Eo({"fill-antialias":new na(ze.paint_fill["fill-antialias"]),"fill-opacity":new ma(ze.paint_fill["fill-opacity"]),"fill-color":new ma(ze.paint_fill["fill-color"]),"fill-outline-color":new ma(ze.paint_fill["fill-outline-color"]),"fill-translate":new na(ze.paint_fill["fill-translate"]),"fill-translate-anchor":new na(ze.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fs(ze.paint_fill["fill-pattern"])}),layout:Bh},jh=function(x){function I(H){x.call(this,H,Nh)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.recalculate=function(H,ee){x.prototype.recalculate.call(this,H,ee);var ue=this.paint._values["fill-outline-color"];ue.value.kind==="constant"&&ue.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},I.prototype.createBucket=function(H){return new Es(H)},I.prototype.queryRadius=function(){return Lo(this.paint.get("fill-translate"))},I.prototype.queryIntersectsFeature=function(H,ee,ue,me,we,Re,Ze){return Ns(Co(H,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Re.angle,Ze),me)},I.prototype.isTileClipped=function(){return!0},I}(qo),Ku=ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Qu=kl;function kl(x,I,H,ee,ue){this.properties={},this.extent=H,this.type=0,this._pbf=x,this._geometry=-1,this._keys=ee,this._values=ue,x.readFields(Uh,this,I)}function Uh(x,I,H){x==1?I.id=H.readVarint():x==2?function(ee,ue){for(var me=ee.readVarint()+ee.pos;ee.pos<me;){var we=ue._keys[ee.readVarint()],Re=ue._values[ee.readVarint()];ue.properties[we]=Re}}(H,I):x==3?I.type=H.readVarint():x==4&&(I._geometry=H.pos)}function Vh(x){for(var I,H,ee=0,ue=0,me=x.length,we=me-1;ue<me;we=ue++)I=x[ue],ee+=((H=x[we]).x-I.x)*(I.y+H.y);return ee}kl.types=["Unknown","Point","LineString","Polygon"],kl.prototype.loadGeometry=function(){var x=this._pbf;x.pos=this._geometry;for(var I,H=x.readVarint()+x.pos,ee=1,ue=0,me=0,we=0,Re=[];x.pos<H;){if(ue<=0){var Ze=x.readVarint();ee=7&Ze,ue=Ze>>3}if(ue--,ee===1||ee===2)me+=x.readSVarint(),we+=x.readSVarint(),ee===1&&(I&&Re.push(I),I=[]),I.push(new n(me,we));else{if(ee!==7)throw new Error("unknown command "+ee);I&&I.push(I[0].clone())}}return I&&Re.push(I),Re},kl.prototype.bbox=function(){var x=this._pbf;x.pos=this._geometry;for(var I=x.readVarint()+x.pos,H=1,ee=0,ue=0,me=0,we=1/0,Re=-1/0,Ze=1/0,ct=-1/0;x.pos<I;){if(ee<=0){var pt=x.readVarint();H=7&pt,ee=pt>>3}if(ee--,H===1||H===2)(ue+=x.readSVarint())<we&&(we=ue),ue>Re&&(Re=ue),(me+=x.readSVarint())<Ze&&(Ze=me),me>ct&&(ct=me);else if(H!==7)throw new Error("unknown command "+H)}return[we,Ze,Re,ct]},kl.prototype.toGeoJSON=function(x,I,H){var ee,ue,me=this.extent*Math.pow(2,H),we=this.extent*x,Re=this.extent*I,Ze=this.loadGeometry(),ct=kl.types[this.type];function pt(qt){for(var rr=0;rr<qt.length;rr++){var fr=qt[rr],Er=180-360*(fr.y+Re)/me;qt[rr]=[360*(fr.x+we)/me-180,360/Math.PI*Math.atan(Math.exp(Er*Math.PI/180))-90]}}switch(this.type){case 1:var Rt=[];for(ee=0;ee<Ze.length;ee++)Rt[ee]=Ze[ee][0];pt(Ze=Rt);break;case 2:for(ee=0;ee<Ze.length;ee++)pt(Ze[ee]);break;case 3:for(Ze=function(qt){var rr=qt.length;if(rr<=1)return[qt];for(var fr,Er,Sr=[],Fr=0;Fr<rr;Fr++){var Br=Vh(qt[Fr]);Br!==0&&(Er===void 0&&(Er=Br<0),Er===Br<0?(fr&&Sr.push(fr),fr=[qt[Fr]]):fr.push(qt[Fr]))}return fr&&Sr.push(fr),Sr}(Ze),ee=0;ee<Ze.length;ee++)for(ue=0;ue<Ze[ee].length;ue++)pt(Ze[ee][ue])}Ze.length===1?Ze=Ze[0]:ct="Multi"+ct;var Yt={type:"Feature",geometry:{type:ct,coordinates:Ze},properties:this.properties};return"id"in this&&(Yt.id=this.id),Yt};var $u=ef;function ef(x,I){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=x,this._keys=[],this._values=[],this._features=[],x.readFields(qh,this,I),this.length=this._features.length}function qh(x,I,H){x===15?I.version=H.readVarint():x===1?I.name=H.readString():x===5?I.extent=H.readVarint():x===2?I._features.push(H.pos):x===3?I._keys.push(H.readString()):x===4&&I._values.push(function(ee){for(var ue=null,me=ee.readVarint()+ee.pos;ee.pos<me;){var we=ee.readVarint()>>3;ue=we===1?ee.readString():we===2?ee.readFloat():we===3?ee.readDouble():we===4?ee.readVarint64():we===5?ee.readVarint():we===6?ee.readSVarint():we===7?ee.readBoolean():null}return ue}(H))}function Hh(x,I,H){if(x===3){var ee=new $u(H,H.readVarint()+H.pos);ee.length&&(I[ee.name]=ee)}}ef.prototype.feature=function(x){if(x<0||x>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[x];var I=this._pbf.readVarint()+this._pbf.pos;return new Qu(this._pbf,I,this.extent,this._keys,this._values)};var Ml={VectorTile:function(x,I){this.layers=x.readFields(Hh,{},I)},VectorTileFeature:Qu,VectorTileLayer:$u},Gh=Ml.VectorTileFeature.types,gu=Math.pow(2,13);function tc(x,I,H,ee,ue,me,we,Re){x.emplaceBack(I,H,2*Math.floor(ee*gu)+we,ue*gu*2,me*gu*2,Math.round(Re))}var Ls=function(x){this.zoom=x.zoom,this.overscaling=x.overscaling,this.layers=x.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=x.index,this.hasPattern=!1,this.layoutVertexArray=new ds,this.indexArray=new eo,this.programConfigurations=new si(Ku,x.layers,x.zoom),this.segments=new Dt,this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};function Yh(x,I){return x.x===I.x&&(x.x<0||x.x>8192)||x.y===I.y&&(x.y<0||x.y>8192)}function Wh(x){return x.every(function(I){return I.x<0})||x.every(function(I){return I.x>8192})||x.every(function(I){return I.y<0})||x.every(function(I){return I.y>8192})}Ls.prototype.populate=function(x,I,H){this.features=[],this.hasPattern=pu("fill-extrusion",this.layers,I);for(var ee=0,ue=x;ee<ue.length;ee+=1){var me=ue[ee],we=me.feature,Re=me.id,Ze=me.index,ct=me.sourceLayerIndex,pt=this.layers[0]._featureFilter.needGeometry,Rt={type:we.type,id:Re,properties:we.properties,geometry:pt?hi(we):[]};if(this.layers[0]._featureFilter.filter(new $a(this.zoom),Rt,H)){var Yt={id:Re,sourceLayerIndex:ct,index:Ze,geometry:pt?Rt.geometry:hi(we),properties:we.properties,type:we.type,patterns:{}};we.id!==void 0&&(Yt.id=we.id),this.hasPattern?this.features.push(du("fill-extrusion",this.layers,Yt,this.zoom,I)):this.addFeature(Yt,Yt.geometry,Ze,H,{}),I.featureIndex.insert(we,Yt.geometry,Ze,ct,this.index,!0)}}},Ls.prototype.addFeatures=function(x,I,H){for(var ee=0,ue=this.features;ee<ue.length;ee+=1){var me=ue[ee],we=me.geometry;this.addFeature(me,we,me.index,I,H)}},Ls.prototype.update=function(x,I,H){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(x,I,this.stateDependentLayers,H)},Ls.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ls.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ls.prototype.upload=function(x){this.uploaded||(this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,Ku),this.indexBuffer=x.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(x),this.uploaded=!0},Ls.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ls.prototype.addFeature=function(x,I,H,ee,ue){for(var me=0,we=hu(I,500);me<we.length;me+=1){for(var Re=we[me],Ze=0,ct=0,pt=Re;ct<pt.length;ct+=1)Ze+=pt[ct].length;for(var Rt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Yt=0,qt=Re;Yt<qt.length;Yt+=1){var rr=qt[Yt];if(rr.length!==0&&!Wh(rr))for(var fr=0,Er=0;Er<rr.length;Er++){var Sr=rr[Er];if(Er>=1){var Fr=rr[Er-1];if(!Yh(Sr,Fr)){Rt.vertexLength+4>Dt.MAX_VERTEX_ARRAY_LENGTH&&(Rt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Br=Sr.sub(Fr)._perp()._unit(),Ur=Fr.dist(Sr);fr+Ur>32768&&(fr=0),tc(this.layoutVertexArray,Sr.x,Sr.y,Br.x,Br.y,0,0,fr),tc(this.layoutVertexArray,Sr.x,Sr.y,Br.x,Br.y,0,1,fr),fr+=Ur,tc(this.layoutVertexArray,Fr.x,Fr.y,Br.x,Br.y,0,0,fr),tc(this.layoutVertexArray,Fr.x,Fr.y,Br.x,Br.y,0,1,fr);var nn=Rt.vertexLength;this.indexArray.emplaceBack(nn,nn+2,nn+1),this.indexArray.emplaceBack(nn+1,nn+2,nn+3),Rt.vertexLength+=4,Rt.primitiveLength+=2}}}}if(Rt.vertexLength+Ze>Dt.MAX_VERTEX_ARRAY_LENGTH&&(Rt=this.segments.prepareSegment(Ze,this.layoutVertexArray,this.indexArray)),Gh[x.type]==="Polygon"){for(var hn=[],Ln=[],En=Rt.vertexLength,Bn=0,ea=Re;Bn<ea.length;Bn+=1){var ta=ea[Bn];if(ta.length!==0){ta!==Re[0]&&Ln.push(hn.length/2);for(var Vn=0;Vn<ta.length;Vn++){var la=ta[Vn];tc(this.layoutVertexArray,la.x,la.y,0,0,1,1,0),hn.push(la.x),hn.push(la.y)}}}for(var oa=lu(hn,Ln),ra=0;ra<oa.length;ra+=3)this.indexArray.emplaceBack(En+oa[ra],En+oa[ra+2],En+oa[ra+1]);Rt.primitiveLength+=oa.length/3,Rt.vertexLength+=Ze}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,x,H,ue,ee)},Hr("FillExtrusionBucket",Ls,{omit:["layers","features"]});var Xh={paint:new Eo({"fill-extrusion-opacity":new na(ze["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ma(ze["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new na(ze["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new na(ze["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fs(ze["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ma(ze["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ma(ze["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new na(ze["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Zh=function(x){function I(H){x.call(this,H,Xh)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.createBucket=function(H){return new Ls(H)},I.prototype.queryRadius=function(){return Lo(this.paint.get("fill-extrusion-translate"))},I.prototype.is3D=function(){return!0},I.prototype.queryIntersectsFeature=function(H,ee,ue,me,we,Re,Ze,ct){var pt=Co(H,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Re.angle,Ze),Rt=this.paint.get("fill-extrusion-height").evaluate(ee,ue),Yt=this.paint.get("fill-extrusion-base").evaluate(ee,ue),qt=function(fr,Er,Sr,Fr){for(var Br=[],Ur=0,nn=fr;Ur<nn.length;Ur+=1){var hn=nn[Ur],Ln=[hn.x,hn.y,Fr,1];wl(Ln,Ln,Er),Br.push(new n(Ln[0]/Ln[3],Ln[1]/Ln[3]))}return Br}(pt,ct,0,0),rr=function(fr,Er,Sr,Fr){for(var Br=[],Ur=[],nn=Fr[8]*Er,hn=Fr[9]*Er,Ln=Fr[10]*Er,En=Fr[11]*Er,Bn=Fr[8]*Sr,ea=Fr[9]*Sr,ta=Fr[10]*Sr,Vn=Fr[11]*Sr,la=0,oa=fr;la<oa.length;la+=1){for(var ra=oa[la],Wa=[],Ba=[],Ka=0,xa=ra;Ka<xa.length;Ka+=1){var Ua=xa[Ka],di=Ua.x,li=Ua.y,ki=Fr[0]*di+Fr[4]*li+Fr[12],ci=Fr[1]*di+Fr[5]*li+Fr[13],ao=Fr[2]*di+Fr[6]*li+Fr[14],Mi=Fr[3]*di+Fr[7]*li+Fr[15],Po=ao+Ln,xo=Mi+En,wo=ki+Bn,Ho=ci+ea,Do=ao+ta,io=Mi+Vn,To=new n((ki+nn)/xo,(ci+hn)/xo);To.z=Po/xo,Wa.push(To);var Yi=new n(wo/io,Ho/io);Yi.z=Do/io,Ba.push(Yi)}Br.push(Wa),Ur.push(Ba)}return[Br,Ur]}(me,Yt,Rt,ct);return function(fr,Er,Sr){var Fr=1/0;Ns(Sr,Er)&&(Fr=tf(Sr,Er[0]));for(var Br=0;Br<Er.length;Br++)for(var Ur=Er[Br],nn=fr[Br],hn=0;hn<Ur.length-1;hn++){var Ln=Ur[hn],En=Ur[hn+1],Bn=nn[hn],ea=nn[hn+1],ta=[Ln,En,ea,Bn,Ln];Oo(Sr,ta)&&(Fr=Math.min(Fr,tf(Sr,ta)))}return Fr!==1/0&&Fr}(rr[0],rr[1],qt)},I}(qo);function rc(x,I){return x.x*I.x+x.y*I.y}function tf(x,I){if(x.length===1){for(var H,ee=0,ue=I[ee++];!H||ue.equals(H);)if(!(H=I[ee++]))return 1/0;for(;ee<I.length;ee++){var me=I[ee],we=x[0],Re=H.sub(ue),Ze=me.sub(ue),ct=we.sub(ue),pt=rc(Re,Re),Rt=rc(Re,Ze),Yt=rc(Ze,Ze),qt=rc(ct,Re),rr=rc(ct,Ze),fr=pt*Yt-Rt*Rt,Er=(Yt*qt-Rt*rr)/fr,Sr=(pt*rr-Rt*qt)/fr,Fr=1-Er-Sr,Br=ue.z*Fr+H.z*Er+me.z*Sr;if(isFinite(Br))return Br}return 1/0}for(var Ur=1/0,nn=0,hn=I;nn<hn.length;nn+=1){var Ln=hn[nn];Ur=Math.min(Ur,Ln.z)}return Ur}var rf=ei([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Jh=Ml.VectorTileFeature.types,Kh=Math.cos(Math.PI/180*37.5),nf=Math.pow(2,14)/.5,Jo=function(x){this.zoom=x.zoom,this.overscaling=x.overscaling,this.layers=x.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=x.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ms,this.indexArray=new eo,this.programConfigurations=new si(rf,x.layers,x.zoom),this.segments=new Dt,this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};Jo.prototype.populate=function(x,I,H){this.hasPattern=pu("line",this.layers,I);for(var ee=this.layers[0].layout.get("line-sort-key"),ue=[],me=0,we=x;me<we.length;me+=1){var Re=we[me],Ze=Re.feature,ct=Re.id,pt=Re.index,Rt=Re.sourceLayerIndex,Yt=this.layers[0]._featureFilter.needGeometry,qt={type:Ze.type,id:ct,properties:Ze.properties,geometry:Yt?hi(Ze):[]};if(this.layers[0]._featureFilter.filter(new $a(this.zoom),qt,H)){Yt||(qt.geometry=hi(Ze));var rr=ee?ee.evaluate(qt,{},H):void 0,fr={id:ct,properties:Ze.properties,type:Ze.type,sourceLayerIndex:Rt,index:pt,geometry:qt.geometry,patterns:{},sortKey:rr};ue.push(fr)}}ee&&ue.sort(function(Bn,ea){return Bn.sortKey-ea.sortKey});for(var Er=0,Sr=ue;Er<Sr.length;Er+=1){var Fr=Sr[Er],Br=Fr,Ur=Br.geometry,nn=Br.index,hn=Br.sourceLayerIndex;if(this.hasPattern){var Ln=du("line",this.layers,Fr,this.zoom,I);this.patternFeatures.push(Ln)}else this.addFeature(Fr,Ur,nn,H,{});var En=x[nn].feature;I.featureIndex.insert(En,Ur,nn,hn,this.index)}},Jo.prototype.update=function(x,I,H){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(x,I,this.stateDependentLayers,H)},Jo.prototype.addFeatures=function(x,I,H){for(var ee=0,ue=this.patternFeatures;ee<ue.length;ee+=1){var me=ue[ee];this.addFeature(me,me.geometry,me.index,I,H)}},Jo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Jo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Jo.prototype.upload=function(x){this.uploaded||(this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,rf),this.indexBuffer=x.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(x),this.uploaded=!0},Jo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Jo.prototype.addFeature=function(x,I,H,ee,ue){for(var me=this.layers[0].layout,we=me.get("line-join").evaluate(x,{}),Re=me.get("line-cap"),Ze=me.get("line-miter-limit"),ct=me.get("line-round-limit"),pt=0,Rt=I;pt<Rt.length;pt+=1){var Yt=Rt[pt];this.addLine(Yt,x,we,Re,Ze,ct)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,x,H,ue,ee)},Jo.prototype.addLine=function(x,I,H,ee,ue,me){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,I.properties&&I.properties.hasOwnProperty("mapbox_clip_start")&&I.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+I.properties.mapbox_clip_start,this.clipEnd=+I.properties.mapbox_clip_end;for(var we=0;we<x.length-1;we++)this.totalDistance+=x[we].dist(x[we+1]);this.updateScaledDistance()}for(var Re=Jh[I.type]==="Polygon",Ze=x.length;Ze>=2&&x[Ze-1].equals(x[Ze-2]);)Ze--;for(var ct=0;ct<Ze-1&&x[ct].equals(x[ct+1]);)ct++;if(!(Ze<(Re?3:2))){H==="bevel"&&(ue=1.05);var pt,Rt=this.overscaling<=16?122880/(512*this.overscaling):0,Yt=this.segments.prepareSegment(10*Ze,this.layoutVertexArray,this.indexArray),qt=void 0,rr=void 0,fr=void 0,Er=void 0;this.e1=this.e2=-1,Re&&(pt=x[Ze-2],Er=x[ct].sub(pt)._unit()._perp());for(var Sr=ct;Sr<Ze;Sr++)if(!(rr=Sr===Ze-1?Re?x[ct+1]:void 0:x[Sr+1])||!x[Sr].equals(rr)){Er&&(fr=Er),pt&&(qt=pt),pt=x[Sr],Er=rr?rr.sub(pt)._unit()._perp():fr;var Fr=(fr=fr||Er).add(Er);Fr.x===0&&Fr.y===0||Fr._unit();var Br=fr.x*Er.x+fr.y*Er.y,Ur=Fr.x*Er.x+Fr.y*Er.y,nn=Ur!==0?1/Ur:1/0,hn=2*Math.sqrt(2-2*Ur),Ln=Ur<Kh&&qt&&rr,En=fr.x*Er.y-fr.y*Er.x>0;if(Ln&&Sr>ct){var Bn=pt.dist(qt);if(Bn>2*Rt){var ea=pt.sub(pt.sub(qt)._mult(Rt/Bn)._round());this.updateDistance(qt,ea),this.addCurrentVertex(ea,fr,0,0,Yt),qt=ea}}var ta=qt&&rr,Vn=ta?H:Re?"butt":ee;if(ta&&Vn==="round"&&(nn<me?Vn="miter":nn<=2&&(Vn="fakeround")),Vn==="miter"&&nn>ue&&(Vn="bevel"),Vn==="bevel"&&(nn>2&&(Vn="flipbevel"),nn<ue&&(Vn="miter")),qt&&this.updateDistance(qt,pt),Vn==="miter")Fr._mult(nn),this.addCurrentVertex(pt,Fr,0,0,Yt);else if(Vn==="flipbevel"){if(nn>100)Fr=Er.mult(-1);else{var la=nn*fr.add(Er).mag()/fr.sub(Er).mag();Fr._perp()._mult(la*(En?-1:1))}this.addCurrentVertex(pt,Fr,0,0,Yt),this.addCurrentVertex(pt,Fr.mult(-1),0,0,Yt)}else if(Vn==="bevel"||Vn==="fakeround"){var oa=-Math.sqrt(nn*nn-1),ra=En?oa:0,Wa=En?0:oa;if(qt&&this.addCurrentVertex(pt,fr,ra,Wa,Yt),Vn==="fakeround")for(var Ba=Math.round(180*hn/Math.PI/20),Ka=1;Ka<Ba;Ka++){var xa=Ka/Ba;if(xa!==.5){var Ua=xa-.5;xa+=xa*Ua*(xa-1)*((1.0904+Br*(Br*(3.55645-1.43519*Br)-3.2452))*Ua*Ua+(.848013+Br*(.215638*Br-1.06021)))}var di=Er.sub(fr)._mult(xa)._add(fr)._unit()._mult(En?-1:1);this.addHalfVertex(pt,di.x,di.y,!1,En,0,Yt)}rr&&this.addCurrentVertex(pt,Er,-ra,-Wa,Yt)}else if(Vn==="butt")this.addCurrentVertex(pt,Fr,0,0,Yt);else if(Vn==="square"){var li=qt?1:-1;this.addCurrentVertex(pt,Fr,li,li,Yt)}else Vn==="round"&&(qt&&(this.addCurrentVertex(pt,fr,0,0,Yt),this.addCurrentVertex(pt,fr,1,1,Yt,!0)),rr&&(this.addCurrentVertex(pt,Er,-1,-1,Yt,!0),this.addCurrentVertex(pt,Er,0,0,Yt)));if(Ln&&Sr<Ze-1){var ki=pt.dist(rr);if(ki>2*Rt){var ci=pt.add(rr.sub(pt)._mult(Rt/ki)._round());this.updateDistance(pt,ci),this.addCurrentVertex(ci,Er,0,0,Yt),pt=ci}}}}},Jo.prototype.addCurrentVertex=function(x,I,H,ee,ue,me){me===void 0&&(me=!1);var we=I.x+I.y*H,Re=I.y-I.x*H,Ze=-I.x+I.y*ee,ct=-I.y-I.x*ee;this.addHalfVertex(x,we,Re,me,!1,H,ue),this.addHalfVertex(x,Ze,ct,me,!0,-ee,ue),this.distance>nf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(x,I,H,ee,ue,me))},Jo.prototype.addHalfVertex=function(x,I,H,ee,ue,me,we){var Re=x.x,Ze=x.y,ct=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((Re<<1)+(ee?1:0),(Ze<<1)+(ue?1:0),Math.round(63*I)+128,Math.round(63*H)+128,1+(me===0?0:me<0?-1:1)|(63&ct)<<2,ct>>6);var pt=we.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,pt),we.primitiveLength++),ue?this.e2=pt:this.e1=pt},Jo.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(nf-1):this.distance},Jo.prototype.updateDistance=function(x,I){this.distance+=x.dist(I),this.updateScaledDistance()},Hr("LineBucket",Jo,{omit:["layers","patternFeatures"]});var Qh=new Eo({"line-cap":new na(ze.layout_line["line-cap"]),"line-join":new ma(ze.layout_line["line-join"]),"line-miter-limit":new na(ze.layout_line["line-miter-limit"]),"line-round-limit":new na(ze.layout_line["line-round-limit"]),"line-sort-key":new ma(ze.layout_line["line-sort-key"])}),af={paint:new Eo({"line-opacity":new ma(ze.paint_line["line-opacity"]),"line-color":new ma(ze.paint_line["line-color"]),"line-translate":new na(ze.paint_line["line-translate"]),"line-translate-anchor":new na(ze.paint_line["line-translate-anchor"]),"line-width":new ma(ze.paint_line["line-width"]),"line-gap-width":new ma(ze.paint_line["line-gap-width"]),"line-offset":new ma(ze.paint_line["line-offset"]),"line-blur":new ma(ze.paint_line["line-blur"]),"line-dasharray":new Bs(ze.paint_line["line-dasharray"]),"line-pattern":new Fs(ze.paint_line["line-pattern"]),"line-gradient":new ts(ze.paint_line["line-gradient"])}),layout:Qh},of=new(function(x){function I(){x.apply(this,arguments)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.possiblyEvaluate=function(H,ee){return ee=new $a(Math.floor(ee.zoom),{now:ee.now,fadeDuration:ee.fadeDuration,zoomHistory:ee.zoomHistory,transition:ee.transition}),x.prototype.possiblyEvaluate.call(this,H,ee)},I.prototype.evaluate=function(H,ee,ue,me){return ee=g({},ee,{zoom:Math.floor(ee.zoom)}),x.prototype.evaluate.call(this,H,ee,ue,me)},I}(ma))(af.paint.properties["line-width"].specification);of.useIntegerZoom=!0;var $h=function(x){function I(H){x.call(this,H,af)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype._handleSpecialPaintPropertyUpdate=function(H){H==="line-gradient"&&this._updateGradient()},I.prototype._updateGradient=function(){var H=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Gu(H,"lineProgress"),this.gradientTexture=null},I.prototype.recalculate=function(H,ee){x.prototype.recalculate.call(this,H,ee),this.paint._values["line-floorwidth"]=of.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,H)},I.prototype.createBucket=function(H){return new Jo(H)},I.prototype.queryRadius=function(H){var ee=H,ue=sf(wi("line-width",this,ee),wi("line-gap-width",this,ee)),me=wi("line-offset",this,ee);return ue/2+Math.abs(me)+Lo(this.paint.get("line-translate"))},I.prototype.queryIntersectsFeature=function(H,ee,ue,me,we,Re,Ze){var ct=Co(H,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Re.angle,Ze),pt=Ze/2*sf(this.paint.get("line-width").evaluate(ee,ue),this.paint.get("line-gap-width").evaluate(ee,ue)),Rt=this.paint.get("line-offset").evaluate(ee,ue);return Rt&&(me=function(Yt,qt){for(var rr=[],fr=new n(0,0),Er=0;Er<Yt.length;Er++){for(var Sr=Yt[Er],Fr=[],Br=0;Br<Sr.length;Br++){var Ur=Sr[Br-1],nn=Sr[Br],hn=Sr[Br+1],Ln=Br===0?fr:nn.sub(Ur)._unit()._perp(),En=Br===Sr.length-1?fr:hn.sub(nn)._unit()._perp(),Bn=Ln._add(En)._unit(),ea=Bn.x*En.x+Bn.y*En.y;Bn._mult(1/ea),Fr.push(Bn._mult(qt)._add(nn))}rr.push(Fr)}return rr}(me,Rt*Ze)),function(Yt,qt,rr){for(var fr=0;fr<qt.length;fr++){var Er=qt[fr];if(Yt.length>=3){for(var Sr=0;Sr<Er.length;Sr++)if(rs(Yt,Er[Sr]))return!0}if(cl(Yt,Er,rr))return!0}return!1}(ct,me,pt)},I.prototype.isTileClipped=function(){return!0},I}(qo);function sf(x,I){return I>0?I+2*x:x}var mu=ei([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ep=ei([{name:"a_projected_pos",components:3,type:"Float32"}],4),tp=(ei([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ei([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),lf=(ei([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),rp=ei([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ei([{name:"triangle",components:3,type:"Uint16"}]),ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ei([{type:"Float32",name:"offsetX"}]),ei([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function np(x,I,H){return x.sections.forEach(function(ee){ee.text=function(ue,me,we){var Re=me.layout.get("text-transform").evaluate(we,{});return Re==="uppercase"?ue=ue.toLocaleUpperCase():Re==="lowercase"&&(ue=ue.toLocaleLowerCase()),so.applyArabicShaping&&(ue=so.applyArabicShaping(ue)),ue}(ee.text,I,H)}),x}var nc={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},cf=function(x,I,H,ee,ue){var me,we,Re=8*ue-ee-1,Ze=(1<<Re)-1,ct=Ze>>1,pt=-7,Rt=H?ue-1:0,Yt=H?-1:1,qt=x[I+Rt];for(Rt+=Yt,me=qt&(1<<-pt)-1,qt>>=-pt,pt+=Re;pt>0;me=256*me+x[I+Rt],Rt+=Yt,pt-=8);for(we=me&(1<<-pt)-1,me>>=-pt,pt+=ee;pt>0;we=256*we+x[I+Rt],Rt+=Yt,pt-=8);if(me===0)me=1-ct;else{if(me===Ze)return we?NaN:1/0*(qt?-1:1);we+=Math.pow(2,ee),me-=ct}return(qt?-1:1)*we*Math.pow(2,me-ee)},uf=function(x,I,H,ee,ue,me){var we,Re,Ze,ct=8*me-ue-1,pt=(1<<ct)-1,Rt=pt>>1,Yt=ue===23?Math.pow(2,-24)-Math.pow(2,-77):0,qt=ee?0:me-1,rr=ee?1:-1,fr=I<0||I===0&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?(Re=isNaN(I)?1:0,we=pt):(we=Math.floor(Math.log(I)/Math.LN2),I*(Ze=Math.pow(2,-we))<1&&(we--,Ze*=2),(I+=we+Rt>=1?Yt/Ze:Yt*Math.pow(2,1-Rt))*Ze>=2&&(we++,Ze/=2),we+Rt>=pt?(Re=0,we=pt):we+Rt>=1?(Re=(I*Ze-1)*Math.pow(2,ue),we+=Rt):(Re=I*Math.pow(2,Rt-1)*Math.pow(2,ue),we=0));ue>=8;x[H+qt]=255&Re,qt+=rr,Re/=256,ue-=8);for(we=we<<ue|Re,ct+=ue;ct>0;x[H+qt]=255&we,qt+=rr,we/=256,ct-=8);x[H+qt-rr]|=128*fr},Tc=pi;function pi(x){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(x)?x:new Uint8Array(x||0),this.pos=0,this.type=0,this.length=this.buf.length}pi.Varint=0,pi.Fixed64=1,pi.Bytes=2,pi.Fixed32=5;var ff=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Gs(x){return x.type===pi.Bytes?x.readVarint()+x.pos:x.pos+1}function Al(x,I,H){return H?4294967296*I+(x>>>0):4294967296*(I>>>0)+(x>>>0)}function hf(x,I,H){var ee=I<=16383?1:I<=2097151?2:I<=268435455?3:Math.floor(Math.log(I)/(7*Math.LN2));H.realloc(ee);for(var ue=H.pos-1;ue>=x;ue--)H.buf[ue+ee]=H.buf[ue]}function ap(x,I){for(var H=0;H<x.length;H++)I.writeVarint(x[H])}function ip(x,I){for(var H=0;H<x.length;H++)I.writeSVarint(x[H])}function op(x,I){for(var H=0;H<x.length;H++)I.writeFloat(x[H])}function sp(x,I){for(var H=0;H<x.length;H++)I.writeDouble(x[H])}function lp(x,I){for(var H=0;H<x.length;H++)I.writeBoolean(x[H])}function cp(x,I){for(var H=0;H<x.length;H++)I.writeFixed32(x[H])}function up(x,I){for(var H=0;H<x.length;H++)I.writeSFixed32(x[H])}function fp(x,I){for(var H=0;H<x.length;H++)I.writeFixed64(x[H])}function hp(x,I){for(var H=0;H<x.length;H++)I.writeSFixed64(x[H])}function kc(x,I){return(x[I]|x[I+1]<<8|x[I+2]<<16)+16777216*x[I+3]}function Sl(x,I,H){x[H]=I,x[H+1]=I>>>8,x[H+2]=I>>>16,x[H+3]=I>>>24}function pf(x,I){return(x[I]|x[I+1]<<8|x[I+2]<<16)+(x[I+3]<<24)}pi.prototype={destroy:function(){this.buf=null},readFields:function(x,I,H){for(H=H||this.length;this.pos<H;){var ee=this.readVarint(),ue=ee>>3,me=this.pos;this.type=7&ee,x(ue,I,this),this.pos===me&&this.skip(ee)}return I},readMessage:function(x,I){return this.readFields(x,I,this.readVarint()+this.pos)},readFixed32:function(){var x=kc(this.buf,this.pos);return this.pos+=4,x},readSFixed32:function(){var x=pf(this.buf,this.pos);return this.pos+=4,x},readFixed64:function(){var x=kc(this.buf,this.pos)+4294967296*kc(this.buf,this.pos+4);return this.pos+=8,x},readSFixed64:function(){var x=kc(this.buf,this.pos)+4294967296*pf(this.buf,this.pos+4);return this.pos+=8,x},readFloat:function(){var x=cf(this.buf,this.pos,!0,23,4);return this.pos+=4,x},readDouble:function(){var x=cf(this.buf,this.pos,!0,52,8);return this.pos+=8,x},readVarint:function(x){var I,H,ee=this.buf;return I=127&(H=ee[this.pos++]),H<128?I:(I|=(127&(H=ee[this.pos++]))<<7,H<128?I:(I|=(127&(H=ee[this.pos++]))<<14,H<128?I:(I|=(127&(H=ee[this.pos++]))<<21,H<128?I:function(ue,me,we){var Re,Ze,ct=we.buf;if(Ze=ct[we.pos++],Re=(112&Ze)>>4,Ze<128||(Ze=ct[we.pos++],Re|=(127&Ze)<<3,Ze<128)||(Ze=ct[we.pos++],Re|=(127&Ze)<<10,Ze<128)||(Ze=ct[we.pos++],Re|=(127&Ze)<<17,Ze<128)||(Ze=ct[we.pos++],Re|=(127&Ze)<<24,Ze<128)||(Ze=ct[we.pos++],Re|=(1&Ze)<<31,Ze<128))return Al(ue,Re,me);throw new Error("Expected varint not more than 10 bytes")}(I|=(15&(H=ee[this.pos]))<<28,x,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var x=this.readVarint();return x%2==1?(x+1)/-2:x/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var x=this.readVarint()+this.pos,I=this.pos;return this.pos=x,x-I>=12&&ff?function(H,ee,ue){return ff.decode(H.subarray(ee,ue))}(this.buf,I,x):function(H,ee,ue){for(var me="",we=ee;we<ue;){var Re,Ze,ct,pt=H[we],Rt=null,Yt=pt>239?4:pt>223?3:pt>191?2:1;if(we+Yt>ue)break;Yt===1?pt<128&&(Rt=pt):Yt===2?(192&(Re=H[we+1]))==128&&(Rt=(31&pt)<<6|63&Re)<=127&&(Rt=null):Yt===3?(Re=H[we+1],Ze=H[we+2],(192&Re)==128&&(192&Ze)==128&&((Rt=(15&pt)<<12|(63&Re)<<6|63&Ze)<=2047||Rt>=55296&&Rt<=57343)&&(Rt=null)):Yt===4&&(Re=H[we+1],Ze=H[we+2],ct=H[we+3],(192&Re)==128&&(192&Ze)==128&&(192&ct)==128&&((Rt=(15&pt)<<18|(63&Re)<<12|(63&Ze)<<6|63&ct)<=65535||Rt>=1114112)&&(Rt=null)),Rt===null?(Rt=65533,Yt=1):Rt>65535&&(Rt-=65536,me+=String.fromCharCode(Rt>>>10&1023|55296),Rt=56320|1023&Rt),me+=String.fromCharCode(Rt),we+=Yt}return me}(this.buf,I,x)},readBytes:function(){var x=this.readVarint()+this.pos,I=this.buf.subarray(this.pos,x);return this.pos=x,I},readPackedVarint:function(x,I){if(this.type!==pi.Bytes)return x.push(this.readVarint(I));var H=Gs(this);for(x=x||[];this.pos<H;)x.push(this.readVarint(I));return x},readPackedSVarint:function(x){if(this.type!==pi.Bytes)return x.push(this.readSVarint());var I=Gs(this);for(x=x||[];this.pos<I;)x.push(this.readSVarint());return x},readPackedBoolean:function(x){if(this.type!==pi.Bytes)return x.push(this.readBoolean());var I=Gs(this);for(x=x||[];this.pos<I;)x.push(this.readBoolean());return x},readPackedFloat:function(x){if(this.type!==pi.Bytes)return x.push(this.readFloat());var I=Gs(this);for(x=x||[];this.pos<I;)x.push(this.readFloat());return x},readPackedDouble:function(x){if(this.type!==pi.Bytes)return x.push(this.readDouble());var I=Gs(this);for(x=x||[];this.pos<I;)x.push(this.readDouble());return x},readPackedFixed32:function(x){if(this.type!==pi.Bytes)return x.push(this.readFixed32());var I=Gs(this);for(x=x||[];this.pos<I;)x.push(this.readFixed32());return x},readPackedSFixed32:function(x){if(this.type!==pi.Bytes)return x.push(this.readSFixed32());var I=Gs(this);for(x=x||[];this.pos<I;)x.push(this.readSFixed32());return x},readPackedFixed64:function(x){if(this.type!==pi.Bytes)return x.push(this.readFixed64());var I=Gs(this);for(x=x||[];this.pos<I;)x.push(this.readFixed64());return x},readPackedSFixed64:function(x){if(this.type!==pi.Bytes)return x.push(this.readSFixed64());var I=Gs(this);for(x=x||[];this.pos<I;)x.push(this.readSFixed64());return x},skip:function(x){var I=7&x;if(I===pi.Varint)for(;this.buf[this.pos++]>127;);else if(I===pi.Bytes)this.pos=this.readVarint()+this.pos;else if(I===pi.Fixed32)this.pos+=4;else{if(I!==pi.Fixed64)throw new Error("Unimplemented type: "+I);this.pos+=8}},writeTag:function(x,I){this.writeVarint(x<<3|I)},realloc:function(x){for(var I=this.length||16;I<this.pos+x;)I*=2;if(I!==this.length){var H=new Uint8Array(I);H.set(this.buf),this.buf=H,this.length=I}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(x){this.realloc(4),Sl(this.buf,x,this.pos),this.pos+=4},writeSFixed32:function(x){this.realloc(4),Sl(this.buf,x,this.pos),this.pos+=4},writeFixed64:function(x){this.realloc(8),Sl(this.buf,-1&x,this.pos),Sl(this.buf,Math.floor(x*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(x){this.realloc(8),Sl(this.buf,-1&x,this.pos),Sl(this.buf,Math.floor(x*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(x){(x=+x||0)>268435455||x<0?function(I,H){var ee,ue;if(I>=0?(ee=I%4294967296|0,ue=I/4294967296|0):(ue=~(-I/4294967296),4294967295^(ee=~(-I%4294967296))?ee=ee+1|0:(ee=0,ue=ue+1|0)),I>=18446744073709552e3||I<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");H.realloc(10),function(me,we,Re){Re.buf[Re.pos++]=127&me|128,me>>>=7,Re.buf[Re.pos++]=127&me|128,me>>>=7,Re.buf[Re.pos++]=127&me|128,me>>>=7,Re.buf[Re.pos++]=127&me|128,me>>>=7,Re.buf[Re.pos]=127&me}(ee,0,H),function(me,we){var Re=(7&me)<<4;we.buf[we.pos++]|=Re|((me>>>=3)?128:0),me&&(we.buf[we.pos++]=127&me|((me>>>=7)?128:0),me&&(we.buf[we.pos++]=127&me|((me>>>=7)?128:0),me&&(we.buf[we.pos++]=127&me|((me>>>=7)?128:0),me&&(we.buf[we.pos++]=127&me|((me>>>=7)?128:0),me&&(we.buf[we.pos++]=127&me)))))}(ue,H)}(x,this):(this.realloc(4),this.buf[this.pos++]=127&x|(x>127?128:0),x<=127||(this.buf[this.pos++]=127&(x>>>=7)|(x>127?128:0),x<=127||(this.buf[this.pos++]=127&(x>>>=7)|(x>127?128:0),x<=127||(this.buf[this.pos++]=x>>>7&127))))},writeSVarint:function(x){this.writeVarint(x<0?2*-x-1:2*x)},writeBoolean:function(x){this.writeVarint(!!x)},writeString:function(x){x=String(x),this.realloc(4*x.length),this.pos++;var I=this.pos;this.pos=function(ee,ue,me){for(var we,Re,Ze=0;Ze<ue.length;Ze++){if((we=ue.charCodeAt(Ze))>55295&&we<57344){if(!Re){we>56319||Ze+1===ue.length?(ee[me++]=239,ee[me++]=191,ee[me++]=189):Re=we;continue}if(we<56320){ee[me++]=239,ee[me++]=191,ee[me++]=189,Re=we;continue}we=Re-55296<<10|we-56320|65536,Re=null}else Re&&(ee[me++]=239,ee[me++]=191,ee[me++]=189,Re=null);we<128?ee[me++]=we:(we<2048?ee[me++]=we>>6|192:(we<65536?ee[me++]=we>>12|224:(ee[me++]=we>>18|240,ee[me++]=we>>12&63|128),ee[me++]=we>>6&63|128),ee[me++]=63&we|128)}return me}(this.buf,x,this.pos);var H=this.pos-I;H>=128&&hf(I,H,this),this.pos=I-1,this.writeVarint(H),this.pos+=H},writeFloat:function(x){this.realloc(4),uf(this.buf,x,this.pos,!0,23,4),this.pos+=4},writeDouble:function(x){this.realloc(8),uf(this.buf,x,this.pos,!0,52,8),this.pos+=8},writeBytes:function(x){var I=x.length;this.writeVarint(I),this.realloc(I);for(var H=0;H<I;H++)this.buf[this.pos++]=x[H]},writeRawMessage:function(x,I){this.pos++;var H=this.pos;x(I,this);var ee=this.pos-H;ee>=128&&hf(H,ee,this),this.pos=H-1,this.writeVarint(ee),this.pos+=ee},writeMessage:function(x,I,H){this.writeTag(x,pi.Bytes),this.writeRawMessage(I,H)},writePackedVarint:function(x,I){I.length&&this.writeMessage(x,ap,I)},writePackedSVarint:function(x,I){I.length&&this.writeMessage(x,ip,I)},writePackedBoolean:function(x,I){I.length&&this.writeMessage(x,lp,I)},writePackedFloat:function(x,I){I.length&&this.writeMessage(x,op,I)},writePackedDouble:function(x,I){I.length&&this.writeMessage(x,sp,I)},writePackedFixed32:function(x,I){I.length&&this.writeMessage(x,cp,I)},writePackedSFixed32:function(x,I){I.length&&this.writeMessage(x,up,I)},writePackedFixed64:function(x,I){I.length&&this.writeMessage(x,fp,I)},writePackedSFixed64:function(x,I){I.length&&this.writeMessage(x,hp,I)},writeBytesField:function(x,I){this.writeTag(x,pi.Bytes),this.writeBytes(I)},writeFixed32Field:function(x,I){this.writeTag(x,pi.Fixed32),this.writeFixed32(I)},writeSFixed32Field:function(x,I){this.writeTag(x,pi.Fixed32),this.writeSFixed32(I)},writeFixed64Field:function(x,I){this.writeTag(x,pi.Fixed64),this.writeFixed64(I)},writeSFixed64Field:function(x,I){this.writeTag(x,pi.Fixed64),this.writeSFixed64(I)},writeVarintField:function(x,I){this.writeTag(x,pi.Varint),this.writeVarint(I)},writeSVarintField:function(x,I){this.writeTag(x,pi.Varint),this.writeSVarint(I)},writeStringField:function(x,I){this.writeTag(x,pi.Bytes),this.writeString(I)},writeFloatField:function(x,I){this.writeTag(x,pi.Fixed32),this.writeFloat(I)},writeDoubleField:function(x,I){this.writeTag(x,pi.Fixed64),this.writeDouble(I)},writeBooleanField:function(x,I){this.writeVarintField(x,!!I)}};function pp(x,I,H){x===1&&H.readMessage(dp,I)}function dp(x,I,H){if(x===3){var ee=H.readMessage(gp,{}),ue=ee.id,me=ee.bitmap,we=ee.width,Re=ee.height,Ze=ee.left,ct=ee.top,pt=ee.advance;I.push({id:ue,bitmap:new pl({width:we+6,height:Re+6},me),metrics:{width:we,height:Re,left:Ze,top:ct,advance:pt}})}}function gp(x,I,H){x===1?I.id=H.readVarint():x===2?I.bitmap=H.readBytes():x===3?I.width=H.readVarint():x===4?I.height=H.readVarint():x===5?I.left=H.readSVarint():x===6?I.top=H.readSVarint():x===7&&(I.advance=H.readVarint())}function df(x){for(var I=0,H=0,ee=0,ue=x;ee<ue.length;ee+=1){var me=ue[ee];I+=me.w*me.h,H=Math.max(H,me.w)}x.sort(function(fr,Er){return Er.h-fr.h});for(var we=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(I/.95)),H),h:1/0}],Re=0,Ze=0,ct=0,pt=x;ct<pt.length;ct+=1)for(var Rt=pt[ct],Yt=we.length-1;Yt>=0;Yt--){var qt=we[Yt];if(!(Rt.w>qt.w||Rt.h>qt.h)){if(Rt.x=qt.x,Rt.y=qt.y,Ze=Math.max(Ze,Rt.y+Rt.h),Re=Math.max(Re,Rt.x+Rt.w),Rt.w===qt.w&&Rt.h===qt.h){var rr=we.pop();Yt<we.length&&(we[Yt]=rr)}else Rt.h===qt.h?(qt.x+=Rt.w,qt.w-=Rt.w):Rt.w===qt.w?(qt.y+=Rt.h,qt.h-=Rt.h):(we.push({x:qt.x+Rt.w,y:qt.y,w:qt.w-Rt.w,h:Rt.h}),qt.y+=Rt.h,qt.h-=Rt.h);break}}return{w:Re,h:Ze,fill:I/(Re*Ze)||0}}var Mc=function(x,I){var H=I.pixelRatio,ee=I.version,ue=I.stretchX,me=I.stretchY,we=I.content;this.paddedRect=x,this.pixelRatio=H,this.stretchX=ue,this.stretchY=me,this.content=we,this.version=ee},ac={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};ac.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},ac.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},ac.tlbr.get=function(){return this.tl.concat(this.br)},ac.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Mc.prototype,ac);var ic=function(x,I){var H={},ee={};this.haveRenderCallbacks=[];var ue=[];this.addImages(x,H,ue),this.addImages(I,ee,ue);var me=df(ue),we=me.w,Re=me.h,Ze=new Zo({width:we||1,height:Re||1});for(var ct in x){var pt=x[ct],Rt=H[ct].paddedRect;Zo.copy(pt.data,Ze,{x:0,y:0},{x:Rt.x+1,y:Rt.y+1},pt.data)}for(var Yt in I){var qt=I[Yt],rr=ee[Yt].paddedRect,fr=rr.x+1,Er=rr.y+1,Sr=qt.data.width,Fr=qt.data.height;Zo.copy(qt.data,Ze,{x:0,y:0},{x:fr,y:Er},qt.data),Zo.copy(qt.data,Ze,{x:0,y:Fr-1},{x:fr,y:Er-1},{width:Sr,height:1}),Zo.copy(qt.data,Ze,{x:0,y:0},{x:fr,y:Er+Fr},{width:Sr,height:1}),Zo.copy(qt.data,Ze,{x:Sr-1,y:0},{x:fr-1,y:Er},{width:1,height:Fr}),Zo.copy(qt.data,Ze,{x:0,y:0},{x:fr+Sr,y:Er},{width:1,height:Fr})}this.image=Ze,this.iconPositions=H,this.patternPositions=ee};ic.prototype.addImages=function(x,I,H){for(var ee in x){var ue=x[ee],me={x:0,y:0,w:ue.data.width+2,h:ue.data.height+2};H.push(me),I[ee]=new Mc(me,ue),ue.hasRenderCallback&&this.haveRenderCallbacks.push(ee)}},ic.prototype.patchUpdatedImages=function(x,I){for(var H in x.dispatchRenderCallbacks(this.haveRenderCallbacks),x.updatedImages)this.patchUpdatedImage(this.iconPositions[H],x.getImage(H),I),this.patchUpdatedImage(this.patternPositions[H],x.getImage(H),I)},ic.prototype.patchUpdatedImage=function(x,I,H){if(x&&I&&x.version!==I.version){x.version=I.version;var ee=x.tl,ue=ee[0],me=ee[1];H.update(I.data,void 0,{x:ue,y:me})}},Hr("ImagePosition",Mc),Hr("ImageAtlas",ic);var ls={horizontal:1,vertical:2,horizontalOnly:3},El=function(){this.scale=1,this.fontStack="",this.imageName=null};El.forText=function(x,I){var H=new El;return H.scale=x||1,H.fontStack=I,H},El.forImage=function(x){var I=new El;return I.imageName=x,I};var zo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Ac(x,I,H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt,rr,fr){var Er,Sr=zo.fromFeature(x,ue);Rt===ls.vertical&&Sr.verticalizePunctuation();var Fr=so.processBidirectionalText,Br=so.processStyledBidirectionalText;if(Fr&&Sr.sections.length===1){Er=[];for(var Ur=0,nn=Fr(Sr.toString(),vu(Sr,ct,me,I,ee,qt,rr));Ur<nn.length;Ur+=1){var hn=nn[Ur],Ln=new zo;Ln.text=hn,Ln.sections=Sr.sections;for(var En=0;En<hn.length;En++)Ln.sectionIndex.push(0);Er.push(Ln)}}else if(Br){Er=[];for(var Bn=0,ea=Br(Sr.text,Sr.sectionIndex,vu(Sr,ct,me,I,ee,qt,rr));Bn<ea.length;Bn+=1){var ta=ea[Bn],Vn=new zo;Vn.text=ta[0],Vn.sectionIndex=ta[1],Vn.sections=Sr.sections,Er.push(Vn)}}else Er=function(ra,Wa){for(var Ba=[],Ka=ra.text,xa=0,Ua=0,di=Wa;Ua<di.length;Ua+=1){var li=di[Ua];Ba.push(ra.substring(xa,li)),xa=li}return xa<Ka.length&&Ba.push(ra.substring(xa,Ka.length)),Ba}(Sr,vu(Sr,ct,me,I,ee,qt,rr));var la=[],oa={positionedLines:la,text:Sr.toString(),top:pt[1],bottom:pt[1],left:pt[0],right:pt[0],writingMode:Rt,iconsInText:!1,verticalizable:!1};return function(ra,Wa,Ba,Ka,xa,Ua,di,li,ki,ci,ao,Mi){for(var Po=0,xo=-17,wo=0,Ho=0,Do=li==="right"?1:li==="left"?0:.5,io=0,To=0,Yi=xa;To<Yi.length;To+=1){var lo=Yi[To];lo.trim();var Oa=lo.getMaxScale(),Za=24*(Oa-1),Bi={positionedGlyphs:[],lineOffset:0};ra.positionedLines[io]=Bi;var Ni=Bi.positionedGlyphs,Oi=0;if(lo.length()){for(var Ai=0;Ai<lo.length();Ai++){var ti=lo.getSection(Ai),ji=lo.getSectionIndex(Ai),Go=lo.getCharCode(Ai),as=0,Ro=null,Cs=null,Xs=null,bo=24,Ps=!(ki===ls.horizontal||!ao&&!fa(Go)||ao&&(Sc[Go]||(nl=Go,yn.Arabic(nl)||yn["Arabic Supplement"](nl)||yn["Arabic Extended-A"](nl)||yn["Arabic Presentation Forms-A"](nl)||yn["Arabic Presentation Forms-B"](nl))));if(ti.imageName){var Is=Ka[ti.imageName];if(!Is)continue;Xs=ti.imageName,ra.iconsInText=ra.iconsInText||!0,Cs=Is.paddedRect;var Os=Is.displaySize;ti.scale=24*ti.scale/Mi,Ro={width:Os[0],height:Os[1],left:1,top:-3,advance:Ps?Os[1]:Os[0]};var Su=24-Os[1]*ti.scale;as=Za+Su,bo=Ro.advance;var Rl=Ps?Os[0]*ti.scale-24*Oa:Os[1]*ti.scale-24*Oa;Rl>0&&Rl>Oi&&(Oi=Rl)}else{var Rc=Ba[ti.fontStack],yl=Rc&&Rc[Go];if(yl&&yl.rect)Cs=yl.rect,Ro=yl.metrics;else{var Fc=Wa[ti.fontStack],Bc=Fc&&Fc[Go];if(!Bc)continue;Ro=Bc.metrics}as=24*(Oa-ti.scale)}Ps?(ra.verticalizable=!0,Ni.push({glyph:Go,imageName:Xs,x:Po,y:xo+as,vertical:Ps,scale:ti.scale,fontStack:ti.fontStack,sectionIndex:ji,metrics:Ro,rect:Cs}),Po+=bo*ti.scale+ci):(Ni.push({glyph:Go,imageName:Xs,x:Po,y:xo+as,vertical:Ps,scale:ti.scale,fontStack:ti.fontStack,sectionIndex:ji,metrics:Ro,rect:Cs}),Po+=Ro.advance*ti.scale+ci)}if(Ni.length!==0){var Nc=Po-ci;wo=Math.max(Nc,wo),vp(Ni,0,Ni.length-1,Do,Oi)}Po=0;var jc=Ua*Oa+Oi;Bi.lineOffset=Math.max(Oi,Za),xo+=jc,Ho=Math.max(jc,Ho),++io}else xo+=Ua,++io}var nl,Fl=xo- -17,Uc=yu(di),Bl=Uc.horizontalAlign,al=Uc.verticalAlign;(function(lc,Vc,qc,Hc,cc,Gc,uc,Yc,fc){var Wc=(Vc-qc)*cc,Nl=0;Nl=Gc!==uc?-Yc*Hc- -17:(-Hc*fc+.5)*uc;for(var jl=0,Ul=lc;jl<Ul.length;jl+=1)for(var Xc=Ul[jl],Vl=0,hc=Xc.positionedGlyphs;Vl<hc.length;Vl+=1){var ql=hc[Vl];ql.x+=Wc,ql.y+=Nl}})(ra.positionedLines,Do,Bl,al,wo,Ho,Ua,Fl,xa.length),ra.top+=-al*Fl,ra.bottom=ra.top+Fl,ra.left+=-Bl*wo,ra.right=ra.left+wo}(oa,I,H,ee,Er,we,Re,Ze,Rt,ct,Yt,fr),!function(ra){for(var Wa=0,Ba=ra;Wa<Ba.length;Wa+=1)if(Ba[Wa].positionedGlyphs.length!==0)return!1;return!0}(la)&&oa}zo.fromFeature=function(x,I){for(var H=new zo,ee=0;ee<x.sections.length;ee++){var ue=x.sections[ee];ue.image?H.addImageSection(ue):H.addTextSection(ue,I)}return H},zo.prototype.length=function(){return this.text.length},zo.prototype.getSection=function(x){return this.sections[this.sectionIndex[x]]},zo.prototype.getSectionIndex=function(x){return this.sectionIndex[x]},zo.prototype.getCharCode=function(x){return this.text.charCodeAt(x)},zo.prototype.verticalizePunctuation=function(){this.text=function(x){for(var I="",H=0;H<x.length;H++){var ee=x.charCodeAt(H+1)||null,ue=x.charCodeAt(H-1)||null;(!ee||!Ia(ee)||nc[x[H+1]])&&(!ue||!Ia(ue)||nc[x[H-1]])&&nc[x[H]]?I+=nc[x[H]]:I+=x[H]}return I}(this.text)},zo.prototype.trim=function(){for(var x=0,I=0;I<this.text.length&&Sc[this.text.charCodeAt(I)];I++)x++;for(var H=this.text.length,ee=this.text.length-1;ee>=0&&ee>=x&&Sc[this.text.charCodeAt(ee)];ee--)H--;this.text=this.text.substring(x,H),this.sectionIndex=this.sectionIndex.slice(x,H)},zo.prototype.substring=function(x,I){var H=new zo;return H.text=this.text.substring(x,I),H.sectionIndex=this.sectionIndex.slice(x,I),H.sections=this.sections,H},zo.prototype.toString=function(){return this.text},zo.prototype.getMaxScale=function(){var x=this;return this.sectionIndex.reduce(function(I,H){return Math.max(I,x.sections[H].scale)},0)},zo.prototype.addTextSection=function(x,I){this.text+=x.text,this.sections.push(El.forText(x.scale,x.fontStack||I));for(var H=this.sections.length-1,ee=0;ee<x.text.length;++ee)this.sectionIndex.push(H)},zo.prototype.addImageSection=function(x){var I=x.image?x.image.name:"";if(I.length!==0){var H=this.getNextImageSectionCharCode();H?(this.text+=String.fromCharCode(H),this.sections.push(El.forImage(I)),this.sectionIndex.push(this.sections.length-1)):w("Reached maximum number of images 6401")}else w("Can't add FormattedSection with an empty image.")},zo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Sc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ns={};function gf(x,I,H,ee,ue,me){if(I.imageName){var we=ee[I.imageName];return we?we.displaySize[0]*I.scale*24/me+ue:0}var Re=H[I.fontStack],Ze=Re&&Re[x];return Ze?Ze.metrics.advance*I.scale+ue:0}function mf(x,I,H,ee){var ue=Math.pow(x-I,2);return ee?x<I?ue/2:2*ue:ue+Math.abs(H)*H}function mp(x,I,H){var ee=0;return x===10&&(ee-=1e4),H&&(ee+=150),x!==40&&x!==65288||(ee+=50),I!==41&&I!==65289||(ee+=50),ee}function vf(x,I,H,ee,ue,me){for(var we=null,Re=mf(I,H,ue,me),Ze=0,ct=ee;Ze<ct.length;Ze+=1){var pt=ct[Ze],Rt=mf(I-pt.x,H,ue,me)+pt.badness;Rt<=Re&&(we=pt,Re=Rt)}return{index:x,x:I,priorBreak:we,badness:Re}}function vu(x,I,H,ee,ue,me,we){if(me!=="point")return[];if(!x)return[];for(var Re,Ze=[],ct=function(Er,Sr,Fr,Br,Ur,nn){for(var hn=0,Ln=0;Ln<Er.length();Ln++){var En=Er.getSection(Ln);hn+=gf(Er.getCharCode(Ln),En,Br,Ur,Sr,nn)}return hn/Math.max(1,Math.ceil(hn/Fr))}(x,I,H,ee,ue,we),pt=x.text.indexOf("​")>=0,Rt=0,Yt=0;Yt<x.length();Yt++){var qt=x.getSection(Yt),rr=x.getCharCode(Yt);if(Sc[rr]||(Rt+=gf(rr,qt,ee,ue,I,we)),Yt<x.length()-1){var fr=!!(!((Re=rr)<11904)&&(yn["Bopomofo Extended"](Re)||yn.Bopomofo(Re)||yn["CJK Compatibility Forms"](Re)||yn["CJK Compatibility Ideographs"](Re)||yn["CJK Compatibility"](Re)||yn["CJK Radicals Supplement"](Re)||yn["CJK Strokes"](Re)||yn["CJK Symbols and Punctuation"](Re)||yn["CJK Unified Ideographs Extension A"](Re)||yn["CJK Unified Ideographs"](Re)||yn["Enclosed CJK Letters and Months"](Re)||yn["Halfwidth and Fullwidth Forms"](Re)||yn.Hiragana(Re)||yn["Ideographic Description Characters"](Re)||yn["Kangxi Radicals"](Re)||yn["Katakana Phonetic Extensions"](Re)||yn.Katakana(Re)||yn["Vertical Forms"](Re)||yn["Yi Radicals"](Re)||yn["Yi Syllables"](Re)));(ns[rr]||fr||qt.imageName)&&Ze.push(vf(Yt+1,Rt,ct,Ze,mp(rr,x.getCharCode(Yt+1),fr&&pt),!1))}}return function Er(Sr){return Sr?Er(Sr.priorBreak).concat(Sr.index):[]}(vf(x.length(),Rt,ct,Ze,0,!0))}function yu(x){var I=.5,H=.5;switch(x){case"right":case"top-right":case"bottom-right":I=1;break;case"left":case"top-left":case"bottom-left":I=0}switch(x){case"bottom":case"bottom-right":case"bottom-left":H=1;break;case"top":case"top-right":case"top-left":H=0}return{horizontalAlign:I,verticalAlign:H}}function vp(x,I,H,ee,ue){if(ee||ue)for(var me=x[H],we=me.metrics.advance*me.scale,Re=(x[H].x+we)*ee,Ze=I;Ze<=H;Ze++)x[Ze].x-=Re,x[Ze].y+=ue}function yf(x,I,H,ee,ue,me){var we,Re=x.image;if(Re.content){var Ze=Re.content,ct=Re.pixelRatio||1;we=[Ze[0]/ct,Ze[1]/ct,Re.displaySize[0]-Ze[2]/ct,Re.displaySize[1]-Ze[3]/ct]}var pt,Rt,Yt,qt,rr=I.left*me,fr=I.right*me;H==="width"||H==="both"?(qt=ue[0]+rr-ee[3],Rt=ue[0]+fr+ee[1]):Rt=(qt=ue[0]+(rr+fr-Re.displaySize[0])/2)+Re.displaySize[0];var Er=I.top*me,Sr=I.bottom*me;return H==="height"||H==="both"?(pt=ue[1]+Er-ee[0],Yt=ue[1]+Sr+ee[2]):Yt=(pt=ue[1]+(Er+Sr-Re.displaySize[1])/2)+Re.displaySize[1],{image:Re,top:pt,right:Rt,bottom:Yt,left:qt,collisionPadding:we}}ns[10]=!0,ns[32]=!0,ns[38]=!0,ns[40]=!0,ns[41]=!0,ns[43]=!0,ns[45]=!0,ns[47]=!0,ns[173]=!0,ns[183]=!0,ns[8203]=!0,ns[8208]=!0,ns[8211]=!0,ns[8231]=!0;var Ll=function(x){function I(H,ee,ue,me){x.call(this,H,ee),this.angle=ue,me!==void 0&&(this.segment=me)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.clone=function(){return new I(this.x,this.y,this.angle,this.segment)},I}(n);Hr("Anchor",Ll);function xu(x,I){var H=I.expression;if(H.kind==="constant")return{kind:"constant",layoutSize:H.evaluate(new $a(x+1))};if(H.kind==="source")return{kind:"source"};for(var ee=H.zoomStops,ue=H.interpolationType,me=0;me<ee.length&&ee[me]<=x;)me++;for(var we=me=Math.max(0,me-1);we<ee.length&&ee[we]<x+1;)we++;we=Math.min(ee.length-1,we);var Re=ee[me],Ze=ee[we];return H.kind==="composite"?{kind:"composite",minZoom:Re,maxZoom:Ze,interpolationType:ue}:{kind:"camera",minZoom:Re,maxZoom:Ze,minSize:H.evaluate(new $a(Re)),maxSize:H.evaluate(new $a(Ze)),interpolationType:ue}}function xf(x,I,H){var ee=I.uSize,ue=I.uSizeT,me=H.lowerSize,we=H.upperSize;return x.kind==="source"?me/128:x.kind==="composite"?Wn(me/128,we/128,ue):ee}function bf(x,I){var H=0,ee=0;if(x.kind==="constant")ee=x.layoutSize;else if(x.kind!=="source"){var ue=x.interpolationType,me=x.minZoom,we=x.maxZoom,Re=ue?f(Va.interpolationFactor(ue,I,me,we),0,1):0;x.kind==="camera"?ee=Wn(x.minSize,x.maxSize,Re):H=Re}return{uSizeT:H,uSize:ee}}var yp=Object.freeze({__proto__:null,getSizeData:xu,evaluateSizeForFeature:xf,evaluateSizeForZoom:bf,SIZE_PACK_FACTOR:128});function _f(x,I,H,ee,ue){if(I.segment===void 0)return!0;for(var me=I,we=I.segment+1,Re=0;Re>-H/2;){if(--we<0)return!1;Re-=x[we].dist(me),me=x[we]}Re+=x[we].dist(x[we+1]),we++;for(var Ze=[],ct=0;Re<H/2;){var pt=x[we-1],Rt=x[we],Yt=x[we+1];if(!Yt)return!1;var qt=pt.angleTo(Rt)-Rt.angleTo(Yt);for(qt=Math.abs((qt+3*Math.PI)%(2*Math.PI)-Math.PI),Ze.push({distance:Re,angleDelta:qt}),ct+=qt;Re-Ze[0].distance>ee;)ct-=Ze.shift().angleDelta;if(ct>ue)return!1;we++,Re+=Rt.dist(Yt)}return!0}function wf(x){for(var I=0,H=0;H<x.length-1;H++)I+=x[H].dist(x[H+1]);return I}function Tf(x,I,H){return x?.6*I*H:0}function kf(x,I){return Math.max(x?x.right-x.left:0,I?I.right-I.left:0)}function xp(x,I,H,ee,ue,me){for(var we=Tf(H,ue,me),Re=kf(H,ee)*me,Ze=0,ct=wf(x)/2,pt=0;pt<x.length-1;pt++){var Rt=x[pt],Yt=x[pt+1],qt=Rt.dist(Yt);if(Ze+qt>ct){var rr=(ct-Ze)/qt,fr=Wn(Rt.x,Yt.x,rr),Er=Wn(Rt.y,Yt.y,rr),Sr=new Ll(fr,Er,Yt.angleTo(Rt),pt);return Sr._round(),!we||_f(x,Sr,Re,we,I)?Sr:void 0}Ze+=qt}}function bp(x,I,H,ee,ue,me,we,Re,Ze){var ct=Tf(ee,me,we),pt=kf(ee,ue),Rt=pt*we,Yt=x[0].x===0||x[0].x===Ze||x[0].y===0||x[0].y===Ze;return I-Rt<I/4&&(I=Rt+I/4),function qt(rr,fr,Er,Sr,Fr,Br,Ur,nn,hn){for(var Ln=Br/2,En=wf(rr),Bn=0,ea=fr-Er,ta=[],Vn=0;Vn<rr.length-1;Vn++){for(var la=rr[Vn],oa=rr[Vn+1],ra=la.dist(oa),Wa=oa.angleTo(la);ea+Er<Bn+ra;){var Ba=((ea+=Er)-Bn)/ra,Ka=Wn(la.x,oa.x,Ba),xa=Wn(la.y,oa.y,Ba);if(Ka>=0&&Ka<hn&&xa>=0&&xa<hn&&ea-Ln>=0&&ea+Ln<=En){var Ua=new Ll(Ka,xa,Wa,Vn);Ua._round(),Sr&&!_f(rr,Ua,Br,Sr,Fr)||ta.push(Ua)}}Bn+=ra}return nn||ta.length||Ur||(ta=qt(rr,Bn/2,Er,Sr,Fr,Br,Ur,!0,hn)),ta}(x,Yt?I/2*Re%I:(pt/2+2*me)*we*Re%I,I,ct,H,Rt,Yt,!1,Ze)}function Mf(x,I,H,ee,ue){for(var me=[],we=0;we<x.length;we++)for(var Re=x[we],Ze=void 0,ct=0;ct<Re.length-1;ct++){var pt=Re[ct],Rt=Re[ct+1];pt.x<I&&Rt.x<I||(pt.x<I?pt=new n(I,pt.y+(Rt.y-pt.y)*((I-pt.x)/(Rt.x-pt.x)))._round():Rt.x<I&&(Rt=new n(I,pt.y+(Rt.y-pt.y)*((I-pt.x)/(Rt.x-pt.x)))._round()),pt.y<H&&Rt.y<H||(pt.y<H?pt=new n(pt.x+(Rt.x-pt.x)*((H-pt.y)/(Rt.y-pt.y)),H)._round():Rt.y<H&&(Rt=new n(pt.x+(Rt.x-pt.x)*((H-pt.y)/(Rt.y-pt.y)),H)._round()),pt.x>=ee&&Rt.x>=ee||(pt.x>=ee?pt=new n(ee,pt.y+(Rt.y-pt.y)*((ee-pt.x)/(Rt.x-pt.x)))._round():Rt.x>=ee&&(Rt=new n(ee,pt.y+(Rt.y-pt.y)*((ee-pt.x)/(Rt.x-pt.x)))._round()),pt.y>=ue&&Rt.y>=ue||(pt.y>=ue?pt=new n(pt.x+(Rt.x-pt.x)*((ue-pt.y)/(Rt.y-pt.y)),ue)._round():Rt.y>=ue&&(Rt=new n(pt.x+(Rt.x-pt.x)*((ue-pt.y)/(Rt.y-pt.y)),ue)._round()),Ze&&pt.equals(Ze[Ze.length-1])||(Ze=[pt],me.push(Ze)),Ze.push(Rt)))))}return me}function Af(x,I,H,ee){var ue=[],me=x.image,we=me.pixelRatio,Re=me.paddedRect.w-2,Ze=me.paddedRect.h-2,ct=x.right-x.left,pt=x.bottom-x.top,Rt=me.stretchX||[[0,Re]],Yt=me.stretchY||[[0,Ze]],qt=function(Ua,di){return Ua+di[1]-di[0]},rr=Rt.reduce(qt,0),fr=Yt.reduce(qt,0),Er=Re-rr,Sr=Ze-fr,Fr=0,Br=rr,Ur=0,nn=fr,hn=0,Ln=Er,En=0,Bn=Sr;if(me.content&&ee){var ea=me.content;Fr=Ec(Rt,0,ea[0]),Ur=Ec(Yt,0,ea[1]),Br=Ec(Rt,ea[0],ea[2]),nn=Ec(Yt,ea[1],ea[3]),hn=ea[0]-Fr,En=ea[1]-Ur,Ln=ea[2]-ea[0]-Br,Bn=ea[3]-ea[1]-nn}var ta=function(Ua,di,li,ki){var ci=Lc(Ua.stretch-Fr,Br,ct,x.left),ao=Cc(Ua.fixed-hn,Ln,Ua.stretch,rr),Mi=Lc(di.stretch-Ur,nn,pt,x.top),Po=Cc(di.fixed-En,Bn,di.stretch,fr),xo=Lc(li.stretch-Fr,Br,ct,x.left),wo=Cc(li.fixed-hn,Ln,li.stretch,rr),Ho=Lc(ki.stretch-Ur,nn,pt,x.top),Do=Cc(ki.fixed-En,Bn,ki.stretch,fr),io=new n(ci,Mi),To=new n(xo,Mi),Yi=new n(xo,Ho),lo=new n(ci,Ho),Oa=new n(ao/we,Po/we),Za=new n(wo/we,Do/we),Bi=I*Math.PI/180;if(Bi){var Ni=Math.sin(Bi),Oi=Math.cos(Bi),Ai=[Oi,-Ni,Ni,Oi];io._matMult(Ai),To._matMult(Ai),lo._matMult(Ai),Yi._matMult(Ai)}var ti=Ua.stretch+Ua.fixed,ji=li.stretch+li.fixed,Go=di.stretch+di.fixed,as=ki.stretch+ki.fixed;return{tl:io,tr:To,bl:lo,br:Yi,tex:{x:me.paddedRect.x+1+ti,y:me.paddedRect.y+1+Go,w:ji-ti,h:as-Go},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Oa,pixelOffsetBR:Za,minFontScaleX:Ln/we/ct,minFontScaleY:Bn/we/pt,isSDF:H}};if(ee&&(me.stretchX||me.stretchY))for(var Vn=Sf(Rt,Er,rr),la=Sf(Yt,Sr,fr),oa=0;oa<Vn.length-1;oa++)for(var ra=Vn[oa],Wa=Vn[oa+1],Ba=0;Ba<la.length-1;Ba++){var Ka=la[Ba],xa=la[Ba+1];ue.push(ta(ra,Ka,Wa,xa))}else ue.push(ta({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Re+1},{fixed:0,stretch:Ze+1}));return ue}function Ec(x,I,H){for(var ee=0,ue=0,me=x;ue<me.length;ue+=1){var we=me[ue];ee+=Math.max(I,Math.min(H,we[1]))-Math.max(I,Math.min(H,we[0]))}return ee}function Sf(x,I,H){for(var ee=[{fixed:-1,stretch:0}],ue=0,me=x;ue<me.length;ue+=1){var we=me[ue],Re=we[0],Ze=we[1],ct=ee[ee.length-1];ee.push({fixed:Re-ct.stretch,stretch:ct.stretch}),ee.push({fixed:Re-ct.stretch,stretch:ct.stretch+(Ze-Re)})}return ee.push({fixed:I+1,stretch:H}),ee}function Lc(x,I,H,ee){return x/I*H+ee}function Cc(x,I,H,ee){return x-I*H/ee}var Pc=function(x,I,H,ee,ue,me,we,Re,Ze,ct){if(this.boxStartIndex=x.length,Ze){var pt=me.top,Rt=me.bottom,Yt=me.collisionPadding;Yt&&(pt-=Yt[1],Rt+=Yt[3]);var qt=Rt-pt;qt>0&&(qt=Math.max(10,qt),this.circleDiameter=qt)}else{var rr=me.top*we-Re,fr=me.bottom*we+Re,Er=me.left*we-Re,Sr=me.right*we+Re,Fr=me.collisionPadding;if(Fr&&(Er-=Fr[0]*we,rr-=Fr[1]*we,Sr+=Fr[2]*we,fr+=Fr[3]*we),ct){var Br=new n(Er,rr),Ur=new n(Sr,rr),nn=new n(Er,fr),hn=new n(Sr,fr),Ln=ct*Math.PI/180;Br._rotate(Ln),Ur._rotate(Ln),nn._rotate(Ln),hn._rotate(Ln),Er=Math.min(Br.x,Ur.x,nn.x,hn.x),Sr=Math.max(Br.x,Ur.x,nn.x,hn.x),rr=Math.min(Br.y,Ur.y,nn.y,hn.y),fr=Math.max(Br.y,Ur.y,nn.y,hn.y)}x.emplaceBack(I.x,I.y,Er,rr,Sr,fr,H,ee,ue)}this.boxEndIndex=x.length},Cl=function(x,I){if(x===void 0&&(x=[]),I===void 0&&(I=_p),this.data=x,this.length=this.data.length,this.compare=I,this.length>0)for(var H=(this.length>>1)-1;H>=0;H--)this._down(H)};function _p(x,I){return x<I?-1:x>I?1:0}function wp(x,I,H){I===void 0&&(I=1),H===void 0&&(H=!1);for(var ee=1/0,ue=1/0,me=-1/0,we=-1/0,Re=x[0],Ze=0;Ze<Re.length;Ze++){var ct=Re[Ze];(!Ze||ct.x<ee)&&(ee=ct.x),(!Ze||ct.y<ue)&&(ue=ct.y),(!Ze||ct.x>me)&&(me=ct.x),(!Ze||ct.y>we)&&(we=ct.y)}var pt=me-ee,Rt=we-ue,Yt=Math.min(pt,Rt),qt=Yt/2,rr=new Cl([],Tp);if(Yt===0)return new n(ee,ue);for(var fr=ee;fr<me;fr+=Yt)for(var Er=ue;Er<we;Er+=Yt)rr.push(new Pl(fr+qt,Er+qt,qt,x));for(var Sr=function(Ur){for(var nn=0,hn=0,Ln=0,En=Ur[0],Bn=0,ea=En.length,ta=ea-1;Bn<ea;ta=Bn++){var Vn=En[Bn],la=En[ta],oa=Vn.x*la.y-la.x*Vn.y;hn+=(Vn.x+la.x)*oa,Ln+=(Vn.y+la.y)*oa,nn+=3*oa}return new Pl(hn/nn,Ln/nn,0,Ur)}(x),Fr=rr.length;rr.length;){var Br=rr.pop();(Br.d>Sr.d||!Sr.d)&&(Sr=Br,H&&console.log("found best %d after %d probes",Math.round(1e4*Br.d)/1e4,Fr)),Br.max-Sr.d<=I||(qt=Br.h/2,rr.push(new Pl(Br.p.x-qt,Br.p.y-qt,qt,x)),rr.push(new Pl(Br.p.x+qt,Br.p.y-qt,qt,x)),rr.push(new Pl(Br.p.x-qt,Br.p.y+qt,qt,x)),rr.push(new Pl(Br.p.x+qt,Br.p.y+qt,qt,x)),Fr+=4)}return H&&(console.log("num probes: "+Fr),console.log("best distance: "+Sr.d)),Sr.p}function Tp(x,I){return I.max-x.max}function Pl(x,I,H,ee){this.p=new n(x,I),this.h=H,this.d=function(ue,me){for(var we=!1,Re=1/0,Ze=0;Ze<me.length;Ze++)for(var ct=me[Ze],pt=0,Rt=ct.length,Yt=Rt-1;pt<Rt;Yt=pt++){var qt=ct[pt],rr=ct[Yt];qt.y>ue.y!=rr.y>ue.y&&ue.x<(rr.x-qt.x)*(ue.y-qt.y)/(rr.y-qt.y)+qt.x&&(we=!we),Re=Math.min(Re,qs(ue,qt,rr))}return(we?1:-1)*Math.sqrt(Re)}(this.p,ee),this.max=this.d+this.h*Math.SQRT2}Cl.prototype.push=function(x){this.data.push(x),this.length++,this._up(this.length-1)},Cl.prototype.pop=function(){if(this.length!==0){var x=this.data[0],I=this.data.pop();return this.length--,this.length>0&&(this.data[0]=I,this._down(0)),x}},Cl.prototype.peek=function(){return this.data[0]},Cl.prototype._up=function(x){for(var I=this.data,H=this.compare,ee=I[x];x>0;){var ue=x-1>>1,me=I[ue];if(H(ee,me)>=0)break;I[x]=me,x=ue}I[x]=ee},Cl.prototype._down=function(x){for(var I=this.data,H=this.compare,ee=this.length>>1,ue=I[x];x<ee;){var me=1+(x<<1),we=I[me],Re=me+1;if(Re<this.length&&H(I[Re],we)<0&&(me=Re,we=I[Re]),H(we,ue)>=0)break;I[x]=we,x=me}I[x]=ue};var bu=Number.POSITIVE_INFINITY;function Ef(x,I){return I[1]!==bu?function(H,ee,ue){var me=0,we=0;switch(ee=Math.abs(ee),ue=Math.abs(ue),H){case"top-right":case"top-left":case"top":we=ue-7;break;case"bottom-right":case"bottom-left":case"bottom":we=7-ue}switch(H){case"top-right":case"bottom-right":case"right":me=-ee;break;case"top-left":case"bottom-left":case"left":me=ee}return[me,we]}(x,I[0],I[1]):function(H,ee){var ue=0,me=0;ee<0&&(ee=0);var we=ee/Math.sqrt(2);switch(H){case"top-right":case"top-left":me=we-7;break;case"bottom-right":case"bottom-left":me=7-we;break;case"bottom":me=7-ee;break;case"top":me=ee-7}switch(H){case"top-right":case"bottom-right":ue=-we;break;case"top-left":case"bottom-left":ue=we;break;case"left":ue=ee;break;case"right":ue=-ee}return[ue,me]}(x,I[0])}function _u(x){switch(x){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Lf(x,I,H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt,rr){var fr=function(Ur,nn,hn,Ln,En,Bn,ea,ta){for(var Vn=Ln.layout.get("text-rotate").evaluate(Bn,{})*Math.PI/180,la=[],oa=0,ra=nn.positionedLines;oa<ra.length;oa+=1)for(var Wa=ra[oa],Ba=0,Ka=Wa.positionedGlyphs;Ba<Ka.length;Ba+=1){var xa=Ka[Ba];if(xa.rect){var Ua=xa.rect||{},di=4,li=!0,ki=1,ci=0,ao=(En||ta)&&xa.vertical,Mi=xa.metrics.advance*xa.scale/2;if(ta&&nn.verticalizable){var Po=24*(xa.scale-1),xo=(24-xa.metrics.width*xa.scale)/2;ci=Wa.lineOffset/2-(xa.imageName?-xo:Po)}if(xa.imageName){var wo=ea[xa.imageName];li=wo.sdf,di=1/(ki=wo.pixelRatio)}var Ho=En?[xa.x+Mi,xa.y]:[0,0],Do=En?[0,0]:[xa.x+Mi+hn[0],xa.y+hn[1]-ci],io=[0,0];ao&&(io=Do,Do=[0,0]);var To=(xa.metrics.left-di)*xa.scale-Mi+Do[0],Yi=(-xa.metrics.top-di)*xa.scale+Do[1],lo=To+Ua.w*xa.scale/ki,Oa=Yi+Ua.h*xa.scale/ki,Za=new n(To,Yi),Bi=new n(lo,Yi),Ni=new n(To,Oa),Oi=new n(lo,Oa);if(ao){var Ai=new n(-Mi,Mi- -17),ti=-Math.PI/2,ji=12-Mi,Go=xa.imageName?ji:0,as=new n(22-ji,-Go),Ro=new(Function.prototype.bind.apply(n,[null].concat(io)));Za._rotateAround(ti,Ai)._add(as)._add(Ro),Bi._rotateAround(ti,Ai)._add(as)._add(Ro),Ni._rotateAround(ti,Ai)._add(as)._add(Ro),Oi._rotateAround(ti,Ai)._add(as)._add(Ro)}if(Vn){var Cs=Math.sin(Vn),Xs=Math.cos(Vn),bo=[Xs,-Cs,Cs,Xs];Za._matMult(bo),Bi._matMult(bo),Ni._matMult(bo),Oi._matMult(bo)}var Ps=new n(0,0),Is=new n(0,0);la.push({tl:Za,tr:Bi,bl:Ni,br:Oi,tex:Ua,writingMode:nn.writingMode,glyphOffset:Ho,sectionIndex:xa.sectionIndex,isSDF:li,pixelOffsetTL:Ps,pixelOffsetBR:Is,minFontScaleX:0,minFontScaleY:0})}}return la}(0,H,Re,ue,me,we,ee,x.allowVerticalPlacement),Er=x.textSizeData,Sr=null;Er.kind==="source"?(Sr=[128*ue.layout.get("text-size").evaluate(we,{})])[0]>32640&&w(x.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Er.kind==="composite"&&((Sr=[128*qt.compositeTextSizes[0].evaluate(we,{},rr),128*qt.compositeTextSizes[1].evaluate(we,{},rr)])[0]>32640||Sr[1]>32640)&&w(x.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),x.addSymbols(x.text,fr,Sr,Re,me,we,ct,I,Ze.lineStartIndex,Ze.lineLength,Yt,rr);for(var Fr=0,Br=pt;Fr<Br.length;Fr+=1)Rt[Br[Fr]]=x.text.placedSymbolArray.length-1;return 4*fr.length}function Cf(x){for(var I in x)return x[I];return null}function kp(x,I,H,ee){var ue=x.compareText;if(I in ue){for(var me=ue[I],we=me.length-1;we>=0;we--)if(ee.dist(me[we])<H)return!0}else ue[I]=[];return ue[I].push(ee),!1}var Mp=Ml.VectorTileFeature.types,Ap=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ic(x,I,H,ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt){var qt=Re?Math.min(32640,Math.round(Re[0])):0,rr=Re?Math.min(32640,Math.round(Re[1])):0;x.emplaceBack(I,H,Math.round(32*ee),Math.round(32*ue),me,we,(qt<<1)+(Ze?1:0),rr,16*ct,16*pt,256*Rt,256*Yt)}function wu(x,I,H){x.emplaceBack(I.x,I.y,H),x.emplaceBack(I.x,I.y,H),x.emplaceBack(I.x,I.y,H),x.emplaceBack(I.x,I.y,H)}function Sp(x){for(var I=0,H=x.sections;I<H.length;I+=1)if(Zn(H[I].text))return!0;return!1}var Il=function(x){this.layoutVertexArray=new As,this.indexArray=new eo,this.programConfigurations=x,this.segments=new Dt,this.dynamicLayoutVertexArray=new ss,this.opacityVertexArray=new Ks,this.placedSymbolArray=new Ne};Il.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Il.prototype.upload=function(x,I,H,ee){this.isEmpty()||(H&&(this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,mu.members),this.indexBuffer=x.createIndexBuffer(this.indexArray,I),this.dynamicLayoutVertexBuffer=x.createVertexBuffer(this.dynamicLayoutVertexArray,ep.members,!0),this.opacityVertexBuffer=x.createVertexBuffer(this.opacityVertexArray,Ap,!0),this.opacityVertexBuffer.itemSize=1),(H||ee)&&this.programConfigurations.upload(x))},Il.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Hr("SymbolBuffers",Il);var oc=function(x,I,H){this.layoutVertexArray=new x,this.layoutAttributes=I,this.indexArray=new H,this.segments=new Dt,this.collisionVertexArray=new Ss};oc.prototype.upload=function(x){this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=x.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=x.createVertexBuffer(this.collisionVertexArray,tp.members,!0)},oc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Hr("CollisionBuffers",oc);var ii=function(x){this.collisionBoxArray=x.collisionBoxArray,this.zoom=x.zoom,this.overscaling=x.overscaling,this.layers=x.layers,this.layerIds=this.layers.map(function(we){return we.id}),this.index=x.index,this.pixelRatio=x.pixelRatio,this.sourceLayerIndex=x.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Zl([]),this.placementViewportMatrix=Zl([]);var I=this.layers[0]._unevaluatedLayout._values;this.textSizeData=xu(this.zoom,I["text-size"]),this.iconSizeData=xu(this.zoom,I["icon-size"]);var H=this.layers[0].layout,ee=H.get("symbol-sort-key"),ue=H.get("symbol-z-order");this.sortFeaturesByKey=ue!=="viewport-y"&&ee.constantOr(1)!==void 0;var me=ue==="viewport-y"||ue==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=me&&(H.get("text-allow-overlap")||H.get("icon-allow-overlap")||H.get("text-ignore-placement")||H.get("icon-ignore-placement")),H.get("symbol-placement")==="point"&&(this.writingModes=H.get("text-writing-mode").map(function(we){return ls[we]})),this.stateDependentLayerIds=this.layers.filter(function(we){return we.isStateDependent()}).map(function(we){return we.id}),this.sourceID=x.sourceID};ii.prototype.createArrays=function(){this.text=new Il(new si(mu.members,this.layers,this.zoom,function(x){return/^text/.test(x)})),this.icon=new Il(new si(mu.members,this.layers,this.zoom,function(x){return/^icon/.test(x)})),this.glyphOffsetArray=new yt,this.lineVertexArray=new kt,this.symbolInstances=new et},ii.prototype.calculateGlyphDependencies=function(x,I,H,ee,ue){for(var me=0;me<x.length;me++)if(I[x.charCodeAt(me)]=!0,(H||ee)&&ue){var we=nc[x.charAt(me)];we&&(I[we.charCodeAt(0)]=!0)}},ii.prototype.populate=function(x,I,H){var ee=this.layers[0],ue=ee.layout,me=ue.get("text-font"),we=ue.get("text-field"),Re=ue.get("icon-image"),Ze=(we.value.kind!=="constant"||we.value.value instanceof gr&&!we.value.value.isEmpty()||we.value.value.toString().length>0)&&(me.value.kind!=="constant"||me.value.value.length>0),ct=Re.value.kind!=="constant"||!!Re.value.value||Object.keys(Re.parameters).length>0,pt=ue.get("symbol-sort-key");if(this.features=[],Ze||ct){for(var Rt=I.iconDependencies,Yt=I.glyphDependencies,qt=I.availableImages,rr=new $a(this.zoom),fr=0,Er=x;fr<Er.length;fr+=1){var Sr=Er[fr],Fr=Sr.feature,Br=Sr.id,Ur=Sr.index,nn=Sr.sourceLayerIndex,hn=ee._featureFilter.needGeometry,Ln={type:Fr.type,id:Br,properties:Fr.properties,geometry:hn?hi(Fr):[]};if(ee._featureFilter.filter(rr,Ln,H)){hn||(Ln.geometry=hi(Fr));var En=void 0;if(Ze){var Bn=ee.getValueAndResolveTokens("text-field",Ln,H,qt),ea=gr.factory(Bn);Sp(ea)&&(this.hasRTLText=!0),(!this.hasRTLText||Ui()==="unavailable"||this.hasRTLText&&so.isParsed())&&(En=np(ea,ee,Ln))}var ta=void 0;if(ct){var Vn=ee.getValueAndResolveTokens("icon-image",Ln,H,qt);ta=Vn instanceof wr?Vn:wr.fromString(Vn)}if(En||ta){var la=this.sortFeaturesByKey?pt.evaluate(Ln,{},H):void 0,oa={id:Br,text:En,icon:ta,index:Ur,sourceLayerIndex:nn,geometry:hi(Fr),properties:Fr.properties,type:Mp[Fr.type],sortKey:la};if(this.features.push(oa),ta&&(Rt[ta.name]=!0),En){var ra=me.evaluate(Ln,{},H).join(","),Wa=ue.get("text-rotation-alignment")==="map"&&ue.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ls.vertical)>=0;for(var Ba=0,Ka=En.sections;Ba<Ka.length;Ba+=1){var xa=Ka[Ba];if(xa.image)Rt[xa.image.name]=!0;else{var Ua=Pa(En.toString()),di=xa.fontStack||ra,li=Yt[di]=Yt[di]||{};this.calculateGlyphDependencies(xa.text,li,Wa,this.allowVerticalPlacement,Ua)}}}}}}ue.get("symbol-placement")==="line"&&(this.features=function(ki){var ci={},ao={},Mi=[],Po=0;function xo(Oi){Mi.push(ki[Oi]),Po++}function wo(Oi,Ai,ti){var ji=ao[Oi];return delete ao[Oi],ao[Ai]=ji,Mi[ji].geometry[0].pop(),Mi[ji].geometry[0]=Mi[ji].geometry[0].concat(ti[0]),ji}function Ho(Oi,Ai,ti){var ji=ci[Ai];return delete ci[Ai],ci[Oi]=ji,Mi[ji].geometry[0].shift(),Mi[ji].geometry[0]=ti[0].concat(Mi[ji].geometry[0]),ji}function Do(Oi,Ai,ti){var ji=ti?Ai[0][Ai[0].length-1]:Ai[0][0];return Oi+":"+ji.x+":"+ji.y}for(var io=0;io<ki.length;io++){var To=ki[io],Yi=To.geometry,lo=To.text?To.text.toString():null;if(lo){var Oa=Do(lo,Yi),Za=Do(lo,Yi,!0);if(Oa in ao&&Za in ci&&ao[Oa]!==ci[Za]){var Bi=Ho(Oa,Za,Yi),Ni=wo(Oa,Za,Mi[Bi].geometry);delete ci[Oa],delete ao[Za],ao[Do(lo,Mi[Ni].geometry,!0)]=Ni,Mi[Bi].geometry=null}else Oa in ao?wo(Oa,Za,Yi):Za in ci?Ho(Oa,Za,Yi):(xo(io),ci[Oa]=Po-1,ao[Za]=Po-1)}else xo(io)}return Mi.filter(function(Oi){return Oi.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ki,ci){return ki.sortKey-ci.sortKey})}},ii.prototype.update=function(x,I,H){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(x,I,this.layers,H),this.icon.programConfigurations.updatePaintArrays(x,I,this.layers,H))},ii.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},ii.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ii.prototype.upload=function(x){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(x),this.iconCollisionBox.upload(x)),this.text.upload(x,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(x,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ii.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ii.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ii.prototype.addToLineVertexArray=function(x,I){var H=this.lineVertexArray.length;if(x.segment!==void 0){for(var ee=x.dist(I[x.segment+1]),ue=x.dist(I[x.segment]),me={},we=x.segment+1;we<I.length;we++)me[we]={x:I[we].x,y:I[we].y,tileUnitDistanceFromAnchor:ee},we<I.length-1&&(ee+=I[we+1].dist(I[we]));for(var Re=x.segment||0;Re>=0;Re--)me[Re]={x:I[Re].x,y:I[Re].y,tileUnitDistanceFromAnchor:ue},Re>0&&(ue+=I[Re-1].dist(I[Re]));for(var Ze=0;Ze<I.length;Ze++){var ct=me[Ze];this.lineVertexArray.emplaceBack(ct.x,ct.y,ct.tileUnitDistanceFromAnchor)}}return{lineStartIndex:H,lineLength:this.lineVertexArray.length-H}},ii.prototype.addSymbols=function(x,I,H,ee,ue,me,we,Re,Ze,ct,pt,Rt){for(var Yt=x.indexArray,qt=x.layoutVertexArray,rr=x.segments.prepareSegment(4*I.length,qt,Yt,me.sortKey),fr=this.glyphOffsetArray.length,Er=rr.vertexLength,Sr=this.allowVerticalPlacement&&we===ls.vertical?Math.PI/2:0,Fr=me.text&&me.text.sections,Br=0;Br<I.length;Br++){var Ur=I[Br],nn=Ur.tl,hn=Ur.tr,Ln=Ur.bl,En=Ur.br,Bn=Ur.tex,ea=Ur.pixelOffsetTL,ta=Ur.pixelOffsetBR,Vn=Ur.minFontScaleX,la=Ur.minFontScaleY,oa=Ur.glyphOffset,ra=Ur.isSDF,Wa=Ur.sectionIndex,Ba=rr.vertexLength,Ka=oa[1];Ic(qt,Re.x,Re.y,nn.x,Ka+nn.y,Bn.x,Bn.y,H,ra,ea.x,ea.y,Vn,la),Ic(qt,Re.x,Re.y,hn.x,Ka+hn.y,Bn.x+Bn.w,Bn.y,H,ra,ta.x,ea.y,Vn,la),Ic(qt,Re.x,Re.y,Ln.x,Ka+Ln.y,Bn.x,Bn.y+Bn.h,H,ra,ea.x,ta.y,Vn,la),Ic(qt,Re.x,Re.y,En.x,Ka+En.y,Bn.x+Bn.w,Bn.y+Bn.h,H,ra,ta.x,ta.y,Vn,la),wu(x.dynamicLayoutVertexArray,Re,Sr),Yt.emplaceBack(Ba,Ba+1,Ba+2),Yt.emplaceBack(Ba+1,Ba+2,Ba+3),rr.vertexLength+=4,rr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(oa[0]),Br!==I.length-1&&Wa===I[Br+1].sectionIndex||x.programConfigurations.populatePaintArrays(qt.length,me,me.index,{},Rt,Fr&&Fr[Wa])}x.placedSymbolArray.emplaceBack(Re.x,Re.y,fr,this.glyphOffsetArray.length-fr,Er,Ze,ct,Re.segment,H?H[0]:0,H?H[1]:0,ee[0],ee[1],we,0,!1,0,pt)},ii.prototype._addCollisionDebugVertex=function(x,I,H,ee,ue,me){return I.emplaceBack(0,0),x.emplaceBack(H.x,H.y,ee,ue,Math.round(me.x),Math.round(me.y))},ii.prototype.addCollisionDebugVertices=function(x,I,H,ee,ue,me,we){var Re=ue.segments.prepareSegment(4,ue.layoutVertexArray,ue.indexArray),Ze=Re.vertexLength,ct=ue.layoutVertexArray,pt=ue.collisionVertexArray,Rt=we.anchorX,Yt=we.anchorY;this._addCollisionDebugVertex(ct,pt,me,Rt,Yt,new n(x,I)),this._addCollisionDebugVertex(ct,pt,me,Rt,Yt,new n(H,I)),this._addCollisionDebugVertex(ct,pt,me,Rt,Yt,new n(H,ee)),this._addCollisionDebugVertex(ct,pt,me,Rt,Yt,new n(x,ee)),Re.vertexLength+=4;var qt=ue.indexArray;qt.emplaceBack(Ze,Ze+1),qt.emplaceBack(Ze+1,Ze+2),qt.emplaceBack(Ze+2,Ze+3),qt.emplaceBack(Ze+3,Ze),Re.primitiveLength+=4},ii.prototype.addDebugCollisionBoxes=function(x,I,H,ee){for(var ue=x;ue<I;ue++){var me=this.collisionBoxArray.get(ue),we=me.x1,Re=me.y1,Ze=me.x2,ct=me.y2;this.addCollisionDebugVertices(we,Re,Ze,ct,ee?this.textCollisionBox:this.iconCollisionBox,me.anchorPoint,H)}},ii.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new oc(gs,lf.members,R),this.iconCollisionBox=new oc(gs,lf.members,R);for(var x=0;x<this.symbolInstances.length;x++){var I=this.symbolInstances.get(x);this.addDebugCollisionBoxes(I.textBoxStartIndex,I.textBoxEndIndex,I,!0),this.addDebugCollisionBoxes(I.verticalTextBoxStartIndex,I.verticalTextBoxEndIndex,I,!0),this.addDebugCollisionBoxes(I.iconBoxStartIndex,I.iconBoxEndIndex,I,!1),this.addDebugCollisionBoxes(I.verticalIconBoxStartIndex,I.verticalIconBoxEndIndex,I,!1)}},ii.prototype._deserializeCollisionBoxesForSymbol=function(x,I,H,ee,ue,me,we,Re,Ze){for(var ct={},pt=I;pt<H;pt++){var Rt=x.get(pt);ct.textBox={x1:Rt.x1,y1:Rt.y1,x2:Rt.x2,y2:Rt.y2,anchorPointX:Rt.anchorPointX,anchorPointY:Rt.anchorPointY},ct.textFeatureIndex=Rt.featureIndex;break}for(var Yt=ee;Yt<ue;Yt++){var qt=x.get(Yt);ct.verticalTextBox={x1:qt.x1,y1:qt.y1,x2:qt.x2,y2:qt.y2,anchorPointX:qt.anchorPointX,anchorPointY:qt.anchorPointY},ct.verticalTextFeatureIndex=qt.featureIndex;break}for(var rr=me;rr<we;rr++){var fr=x.get(rr);ct.iconBox={x1:fr.x1,y1:fr.y1,x2:fr.x2,y2:fr.y2,anchorPointX:fr.anchorPointX,anchorPointY:fr.anchorPointY},ct.iconFeatureIndex=fr.featureIndex;break}for(var Er=Re;Er<Ze;Er++){var Sr=x.get(Er);ct.verticalIconBox={x1:Sr.x1,y1:Sr.y1,x2:Sr.x2,y2:Sr.y2,anchorPointX:Sr.anchorPointX,anchorPointY:Sr.anchorPointY},ct.verticalIconFeatureIndex=Sr.featureIndex;break}return ct},ii.prototype.deserializeCollisionBoxes=function(x){this.collisionArrays=[];for(var I=0;I<this.symbolInstances.length;I++){var H=this.symbolInstances.get(I);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(x,H.textBoxStartIndex,H.textBoxEndIndex,H.verticalTextBoxStartIndex,H.verticalTextBoxEndIndex,H.iconBoxStartIndex,H.iconBoxEndIndex,H.verticalIconBoxStartIndex,H.verticalIconBoxEndIndex))}},ii.prototype.hasTextData=function(){return this.text.segments.get().length>0},ii.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ii.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ii.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ii.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ii.prototype.addIndicesForPlacedSymbol=function(x,I){for(var H=x.placedSymbolArray.get(I),ee=H.vertexStartIndex+4*H.numGlyphs,ue=H.vertexStartIndex;ue<ee;ue+=4)x.indexArray.emplaceBack(ue,ue+1,ue+2),x.indexArray.emplaceBack(ue+1,ue+2,ue+3)},ii.prototype.getSortedSymbolIndexes=function(x){if(this.sortedAngle===x&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var I=Math.sin(x),H=Math.cos(x),ee=[],ue=[],me=[],we=0;we<this.symbolInstances.length;++we){me.push(we);var Re=this.symbolInstances.get(we);ee.push(0|Math.round(I*Re.anchorX+H*Re.anchorY)),ue.push(Re.featureIndex)}return me.sort(function(Ze,ct){return ee[Ze]-ee[ct]||ue[ct]-ue[Ze]}),me},ii.prototype.addToSortKeyRanges=function(x,I){var H=this.sortKeyRanges[this.sortKeyRanges.length-1];H&&H.sortKey===I?H.symbolInstanceEnd=x+1:this.sortKeyRanges.push({sortKey:I,symbolInstanceStart:x,symbolInstanceEnd:x+1})},ii.prototype.sortFeatures=function(x){var I=this;if(this.sortFeaturesByY&&this.sortedAngle!==x&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(x),this.sortedAngle=x,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var H=0,ee=this.symbolInstanceIndexes;H<ee.length;H+=1){var ue=ee[H],me=this.symbolInstances.get(ue);this.featureSortOrder.push(me.featureIndex),[me.rightJustifiedTextSymbolIndex,me.centerJustifiedTextSymbolIndex,me.leftJustifiedTextSymbolIndex].forEach(function(we,Re,Ze){we>=0&&Ze.indexOf(we)===Re&&I.addIndicesForPlacedSymbol(I.text,we)}),me.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,me.verticalPlacedTextSymbolIndex),me.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,me.placedIconSymbolIndex),me.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,me.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Hr("SymbolBucket",ii,{omit:["layers","collisionBoxArray","features","compareText"]}),ii.MAX_GLYPHS=65535,ii.addDynamicAttributes=wu;var Ep=new Eo({"symbol-placement":new na(ze.layout_symbol["symbol-placement"]),"symbol-spacing":new na(ze.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new na(ze.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ma(ze.layout_symbol["symbol-sort-key"]),"symbol-z-order":new na(ze.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new na(ze.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new na(ze.layout_symbol["icon-ignore-placement"]),"icon-optional":new na(ze.layout_symbol["icon-optional"]),"icon-rotation-alignment":new na(ze.layout_symbol["icon-rotation-alignment"]),"icon-size":new ma(ze.layout_symbol["icon-size"]),"icon-text-fit":new na(ze.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new na(ze.layout_symbol["icon-text-fit-padding"]),"icon-image":new ma(ze.layout_symbol["icon-image"]),"icon-rotate":new ma(ze.layout_symbol["icon-rotate"]),"icon-padding":new na(ze.layout_symbol["icon-padding"]),"icon-keep-upright":new na(ze.layout_symbol["icon-keep-upright"]),"icon-offset":new ma(ze.layout_symbol["icon-offset"]),"icon-anchor":new ma(ze.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new na(ze.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new na(ze.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new na(ze.layout_symbol["text-rotation-alignment"]),"text-field":new ma(ze.layout_symbol["text-field"]),"text-font":new ma(ze.layout_symbol["text-font"]),"text-size":new ma(ze.layout_symbol["text-size"]),"text-max-width":new ma(ze.layout_symbol["text-max-width"]),"text-line-height":new na(ze.layout_symbol["text-line-height"]),"text-letter-spacing":new ma(ze.layout_symbol["text-letter-spacing"]),"text-justify":new ma(ze.layout_symbol["text-justify"]),"text-radial-offset":new ma(ze.layout_symbol["text-radial-offset"]),"text-variable-anchor":new na(ze.layout_symbol["text-variable-anchor"]),"text-anchor":new ma(ze.layout_symbol["text-anchor"]),"text-max-angle":new na(ze.layout_symbol["text-max-angle"]),"text-writing-mode":new na(ze.layout_symbol["text-writing-mode"]),"text-rotate":new ma(ze.layout_symbol["text-rotate"]),"text-padding":new na(ze.layout_symbol["text-padding"]),"text-keep-upright":new na(ze.layout_symbol["text-keep-upright"]),"text-transform":new ma(ze.layout_symbol["text-transform"]),"text-offset":new ma(ze.layout_symbol["text-offset"]),"text-allow-overlap":new na(ze.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new na(ze.layout_symbol["text-ignore-placement"]),"text-optional":new na(ze.layout_symbol["text-optional"])}),Tu={paint:new Eo({"icon-opacity":new ma(ze.paint_symbol["icon-opacity"]),"icon-color":new ma(ze.paint_symbol["icon-color"]),"icon-halo-color":new ma(ze.paint_symbol["icon-halo-color"]),"icon-halo-width":new ma(ze.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ma(ze.paint_symbol["icon-halo-blur"]),"icon-translate":new na(ze.paint_symbol["icon-translate"]),"icon-translate-anchor":new na(ze.paint_symbol["icon-translate-anchor"]),"text-opacity":new ma(ze.paint_symbol["text-opacity"]),"text-color":new ma(ze.paint_symbol["text-color"],{runtimeType:Ut,getOverride:function(x){return x.textColor},hasOverride:function(x){return!!x.textColor}}),"text-halo-color":new ma(ze.paint_symbol["text-halo-color"]),"text-halo-width":new ma(ze.paint_symbol["text-halo-width"]),"text-halo-blur":new ma(ze.paint_symbol["text-halo-blur"]),"text-translate":new na(ze.paint_symbol["text-translate"]),"text-translate-anchor":new na(ze.paint_symbol["text-translate-anchor"])}),layout:Ep},Ol=function(x){this.type=x.property.overrides?x.property.overrides.runtimeType:St,this.defaultValue=x};Ol.prototype.evaluate=function(x){if(x.formattedSection){var I=this.defaultValue.property.overrides;if(I&&I.hasOverride(x.formattedSection))return I.getOverride(x.formattedSection)}return x.feature&&x.featureState?this.defaultValue.evaluate(x.feature,x.featureState):this.defaultValue.property.specification.default},Ol.prototype.eachChild=function(x){this.defaultValue.isConstant()||x(this.defaultValue.value._styleExpression.expression)},Ol.prototype.outputDefined=function(){return!1},Ol.prototype.serialize=function(){return null},Hr("FormatSectionOverride",Ol,{omit:["defaultValue"]});var Lp=function(x){function I(H){x.call(this,H,Tu)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.recalculate=function(H,ee){if(x.prototype.recalculate.call(this,H,ee),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var ue=this.layout.get("text-writing-mode");if(ue){for(var me=[],we=0,Re=ue;we<Re.length;we+=1){var Ze=Re[we];me.indexOf(Ze)<0&&me.push(Ze)}this.layout._values["text-writing-mode"]=me}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},I.prototype.getValueAndResolveTokens=function(H,ee,ue,me){var we=this.layout.get(H).evaluate(ee,{},ue,me),Re=this._unevaluatedLayout._values[H];return Re.isDataDriven()||Xt(Re.value)||!we?we:function(Ze,ct){return ct.replace(/{([^{}]+)}/g,function(pt,Rt){return Rt in Ze?String(Ze[Rt]):""})}(ee.properties,we)},I.prototype.createBucket=function(H){return new ii(H)},I.prototype.queryRadius=function(){return 0},I.prototype.queryIntersectsFeature=function(){return!1},I.prototype._setPaintOverrides=function(){for(var H=0,ee=Tu.paint.overridableProperties;H<ee.length;H+=1){var ue=ee[H];if(I.hasPaintOverride(this.layout,ue)){var me=this.paint.get(ue),we=new Ol(me),Re=new Wt(we,me.property.specification),Ze=null;Ze=me.value.kind==="constant"||me.value.kind==="source"?new tr("source",Re):new lr("composite",Re,me.value.zoomStops,me.value._interpolationType),this.paint._values[ue]=new Ii(me.property,Ze,me.parameters)}}},I.prototype._handleOverridablePaintPropertyUpdate=function(H,ee,ue){return!(!this.layout||ee.isDataDriven()||ue.isDataDriven())&&I.hasPaintOverride(this.layout,H)},I.hasPaintOverride=function(H,ee){var ue=H.get("text-field"),me=Tu.paint.properties[ee],we=!1,Re=function(pt){for(var Rt=0,Yt=pt;Rt<Yt.length;Rt+=1){var qt=Yt[Rt];if(me.overrides&&me.overrides.hasOverride(qt))return void(we=!0)}};if(ue.value.kind==="constant"&&ue.value.value instanceof gr)Re(ue.value.value.sections);else if(ue.value.kind==="source"){var Ze=function(pt){if(!we)if(pt instanceof rn&&Wr(pt.value)===At){var Rt=pt.value;Re(Rt.sections)}else pt instanceof br?Re(pt.sections):pt.eachChild(Ze)},ct=ue.value;ct._styleExpression&&Ze(ct._styleExpression.expression)}return we},I}(qo),Cp={paint:new Eo({"background-color":new na(ze.paint_background["background-color"]),"background-pattern":new Bs(ze.paint_background["background-pattern"]),"background-opacity":new na(ze.paint_background["background-opacity"])})},Pp=function(x){function I(H){x.call(this,H,Cp)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I}(qo),Ip={paint:new Eo({"raster-opacity":new na(ze.paint_raster["raster-opacity"]),"raster-hue-rotate":new na(ze.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new na(ze.paint_raster["raster-brightness-min"]),"raster-brightness-max":new na(ze.paint_raster["raster-brightness-max"]),"raster-saturation":new na(ze.paint_raster["raster-saturation"]),"raster-contrast":new na(ze.paint_raster["raster-contrast"]),"raster-resampling":new na(ze.paint_raster["raster-resampling"]),"raster-fade-duration":new na(ze.paint_raster["raster-fade-duration"])})},Op=function(x){function I(H){x.call(this,H,Ip)}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I}(qo),zp=function(x){function I(H){x.call(this,H,{}),this.implementation=H}return x&&(I.__proto__=x),I.prototype=Object.create(x&&x.prototype),I.prototype.constructor=I,I.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},I.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},I.prototype.recalculate=function(){},I.prototype.updateTransitions=function(){},I.prototype.hasTransition=function(){},I.prototype.serialize=function(){},I.prototype.onAdd=function(H){this.implementation.onAdd&&this.implementation.onAdd(H,H.painter.context.gl)},I.prototype.onRemove=function(H){this.implementation.onRemove&&this.implementation.onRemove(H,H.painter.context.gl)},I}(qo),Dp={circle:bh,heatmap:wh,hillshade:kh,fill:jh,"fill-extrusion":Zh,line:$h,symbol:Lp,background:Pp,raster:Op},Pf=self.HTMLImageElement,If=self.HTMLCanvasElement,Of=self.HTMLVideoElement,zf=self.ImageData,Oc=self.ImageBitmap,dl=function(x,I,H,ee){this.context=x,this.format=H,this.texture=x.gl.createTexture(),this.update(I,ee)};dl.prototype.update=function(x,I,H){var ee=x.width,ue=x.height,me=!(this.size&&this.size[0]===ee&&this.size[1]===ue||H),we=this.context,Re=we.gl;if(this.useMipmap=!!(I&&I.useMipmap),Re.bindTexture(Re.TEXTURE_2D,this.texture),we.pixelStoreUnpackFlipY.set(!1),we.pixelStoreUnpack.set(1),we.pixelStoreUnpackPremultiplyAlpha.set(this.format===Re.RGBA&&(!I||I.premultiply!==!1)),me)this.size=[ee,ue],x instanceof Pf||x instanceof If||x instanceof Of||x instanceof zf||Oc&&x instanceof Oc?Re.texImage2D(Re.TEXTURE_2D,0,this.format,this.format,Re.UNSIGNED_BYTE,x):Re.texImage2D(Re.TEXTURE_2D,0,this.format,ee,ue,0,this.format,Re.UNSIGNED_BYTE,x.data);else{var Ze=H||{x:0,y:0},ct=Ze.x,pt=Ze.y;x instanceof Pf||x instanceof If||x instanceof Of||x instanceof zf||Oc&&x instanceof Oc?Re.texSubImage2D(Re.TEXTURE_2D,0,ct,pt,Re.RGBA,Re.UNSIGNED_BYTE,x):Re.texSubImage2D(Re.TEXTURE_2D,0,ct,pt,ee,ue,Re.RGBA,Re.UNSIGNED_BYTE,x.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Re.generateMipmap(Re.TEXTURE_2D)},dl.prototype.bind=function(x,I,H){var ee=this.context.gl;ee.bindTexture(ee.TEXTURE_2D,this.texture),H!==ee.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(H=ee.LINEAR),x!==this.filter&&(ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MAG_FILTER,x),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,H||x),this.filter=x),I!==this.wrap&&(ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,I),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,I),this.wrap=I)},dl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},dl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ku=function(x){var I=this;this._callback=x,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){I._triggered=!1,I._callback()})};ku.prototype.trigger=function(){var x=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){x._triggered=!1,x._callback()},0))},ku.prototype.remove=function(){delete this._channel,this._callback=function(){}};var zl=function(x,I,H){this.target=x,this.parent=I,this.mapId=H,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},_(["receive","process"],this),this.invoker=new ku(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=P()?x:self};function Df(x,I,H){var ee=2*Math.PI*6378137/256/Math.pow(2,H);return[x*ee-2*Math.PI*6378137/2,I*ee-2*Math.PI*6378137/2]}zl.prototype.send=function(x,I,H,ee,ue){var me=this;ue===void 0&&(ue=!1);var we=Math.round(1e18*Math.random()).toString(36).substring(0,10);H&&(this.callbacks[we]=H);var Re=q(this.globalScope)?void 0:[];return this.target.postMessage({id:we,type:x,hasCallback:!!H,targetMapId:ee,mustQueue:ue,sourceMapId:this.mapId,data:Yn(I,Re)},Re),{cancel:function(){H&&delete me.callbacks[we],me.target.postMessage({id:we,type:"<cancel>",targetMapId:ee,sourceMapId:me.mapId})}}},zl.prototype.receive=function(x){var I=x.data,H=I.id;if(H&&(!I.targetMapId||this.mapId===I.targetMapId))if(I.type==="<cancel>"){delete this.tasks[H];var ee=this.cancelCallbacks[H];delete this.cancelCallbacks[H],ee&&ee()}else P()||I.mustQueue?(this.tasks[H]=I,this.taskQueue.push(H),this.invoker.trigger()):this.processTask(H,I)},zl.prototype.process=function(){if(this.taskQueue.length){var x=this.taskQueue.shift(),I=this.tasks[x];delete this.tasks[x],this.taskQueue.length&&this.invoker.trigger(),I&&this.processTask(x,I)}},zl.prototype.processTask=function(x,I){var H=this;if(I.type==="<response>"){var ee=this.callbacks[x];delete this.callbacks[x],ee&&(I.error?ee(_a(I.error)):ee(null,_a(I.data)))}else{var ue=!1,me=q(this.globalScope)?void 0:[],we=I.hasCallback?function(pt,Rt){ue=!0,delete H.cancelCallbacks[x],H.target.postMessage({id:x,type:"<response>",sourceMapId:H.mapId,error:pt?Yn(pt):null,data:Yn(Rt,me)},me)}:function(pt){ue=!0},Re=null,Ze=_a(I.data);if(this.parent[I.type])Re=this.parent[I.type](I.sourceMapId,Ze,we);else if(this.parent.getWorkerSource){var ct=I.type.split(".");Re=this.parent.getWorkerSource(I.sourceMapId,ct[0],Ze.source)[ct[1]](Ze,we)}else we(new Error("Could not find function "+I.type));!ue&&Re&&Re.cancel&&(this.cancelCallbacks[x]=Re.cancel)}},zl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ro=function(x,I){x&&(I?this.setSouthWest(x).setNorthEast(I):x.length===4?this.setSouthWest([x[0],x[1]]).setNorthEast([x[2],x[3]]):this.setSouthWest(x[0]).setNorthEast(x[1]))};ro.prototype.setNorthEast=function(x){return this._ne=x instanceof Ti?new Ti(x.lng,x.lat):Ti.convert(x),this},ro.prototype.setSouthWest=function(x){return this._sw=x instanceof Ti?new Ti(x.lng,x.lat):Ti.convert(x),this},ro.prototype.extend=function(x){var I,H,ee=this._sw,ue=this._ne;if(x instanceof Ti)I=x,H=x;else{if(!(x instanceof ro)){if(Array.isArray(x)){if(x.length===4||x.every(Array.isArray)){var me=x;return this.extend(ro.convert(me))}var we=x;return this.extend(Ti.convert(we))}return this}if(I=x._sw,H=x._ne,!I||!H)return this}return ee||ue?(ee.lng=Math.min(I.lng,ee.lng),ee.lat=Math.min(I.lat,ee.lat),ue.lng=Math.max(H.lng,ue.lng),ue.lat=Math.max(H.lat,ue.lat)):(this._sw=new Ti(I.lng,I.lat),this._ne=new Ti(H.lng,H.lat)),this},ro.prototype.getCenter=function(){return new Ti((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ro.prototype.getSouthWest=function(){return this._sw},ro.prototype.getNorthEast=function(){return this._ne},ro.prototype.getNorthWest=function(){return new Ti(this.getWest(),this.getNorth())},ro.prototype.getSouthEast=function(){return new Ti(this.getEast(),this.getSouth())},ro.prototype.getWest=function(){return this._sw.lng},ro.prototype.getSouth=function(){return this._sw.lat},ro.prototype.getEast=function(){return this._ne.lng},ro.prototype.getNorth=function(){return this._ne.lat},ro.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ro.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ro.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ro.prototype.contains=function(x){var I=Ti.convert(x),H=I.lng,ee=I.lat,ue=this._sw.lat<=ee&&ee<=this._ne.lat,me=this._sw.lng<=H&&H<=this._ne.lng;return this._sw.lng>this._ne.lng&&(me=this._sw.lng>=H&&H>=this._ne.lng),ue&&me},ro.convert=function(x){return!x||x instanceof ro?x:new ro(x)};var Ti=function(x,I){if(isNaN(x)||isNaN(I))throw new Error("Invalid LngLat object: ("+x+", "+I+")");if(this.lng=+x,this.lat=+I,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ti.prototype.wrap=function(){return new Ti(d(this.lng,-180,180),this.lat)},Ti.prototype.toArray=function(){return[this.lng,this.lat]},Ti.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ti.prototype.distanceTo=function(x){var I=Math.PI/180,H=this.lat*I,ee=x.lat*I,ue=Math.sin(H)*Math.sin(ee)+Math.cos(H)*Math.cos(ee)*Math.cos((x.lng-this.lng)*I);return 63710088e-1*Math.acos(Math.min(ue,1))},Ti.prototype.toBounds=function(x){x===void 0&&(x=0);var I=360*x/40075017,H=I/Math.cos(Math.PI/180*this.lat);return new ro(new Ti(this.lng-H,this.lat-I),new Ti(this.lng+H,this.lat+I))},Ti.convert=function(x){if(x instanceof Ti)return x;if(Array.isArray(x)&&(x.length===2||x.length===3))return new Ti(Number(x[0]),Number(x[1]));if(!Array.isArray(x)&&typeof x=="object"&&x!==null)return new Ti(Number("lng"in x?x.lng:x.lon),Number(x.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Rf=2*Math.PI*63710088e-1;function Ff(x){return Rf*Math.cos(x*Math.PI/180)}function Bf(x){return(180+x)/360}function Nf(x){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+x*Math.PI/360)))/360}function jf(x,I){return x/Ff(I)}function Mu(x){var I=180-360*x;return 360/Math.PI*Math.atan(Math.exp(I*Math.PI/180))-90}var ml=function(x,I,H){H===void 0&&(H=0),this.x=+x,this.y=+I,this.z=+H};ml.fromLngLat=function(x,I){I===void 0&&(I=0);var H=Ti.convert(x);return new ml(Bf(H.lng),Nf(H.lat),jf(I,H.lat))},ml.prototype.toLngLat=function(){return new Ti(360*this.x-180,Mu(this.y))},ml.prototype.toAltitude=function(){return x=this.z,I=this.y,x*Ff(Mu(I));var x,I},ml.prototype.meterInMercatorCoordinateUnits=function(){return 1/Rf*(x=Mu(this.y),1/Math.cos(x*Math.PI/180));var x};var vl=function(x,I,H){this.z=x,this.x=I,this.y=H,this.key=sc(0,x,x,I,H)};vl.prototype.equals=function(x){return this.z===x.z&&this.x===x.x&&this.y===x.y},vl.prototype.url=function(x,I){var H,ee,ue,me,we,Re=(H=this.x,ee=this.y,ue=this.z,me=Df(256*H,256*(ee=Math.pow(2,ue)-ee-1),ue),we=Df(256*(H+1),256*(ee+1),ue),me[0]+","+me[1]+","+we[0]+","+we[1]),Ze=function(ct,pt,Rt){for(var Yt,qt="",rr=ct;rr>0;rr--)qt+=(pt&(Yt=1<<rr-1)?1:0)+(Rt&Yt?2:0);return qt}(this.z,this.x,this.y);return x[(this.x+this.y)%x.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(I==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",Ze).replace("{bbox-epsg-3857}",Re)},vl.prototype.getTilePoint=function(x){var I=Math.pow(2,this.z);return new n(8192*(x.x*I-this.x),8192*(x.y*I-this.y))},vl.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Uf=function(x,I){this.wrap=x,this.canonical=I,this.key=sc(x,I.z,I.z,I.x,I.y)},no=function(x,I,H,ee,ue){this.overscaledZ=x,this.wrap=I,this.canonical=new vl(H,+ee,+ue),this.key=sc(I,x,H,ee,ue)};function sc(x,I,H,ee,ue){(x*=2)<0&&(x=-1*x-1);var me=1<<H;return(me*me*x+me*ue+ee).toString(36)+H.toString(36)+I.toString(36)}no.prototype.equals=function(x){return this.overscaledZ===x.overscaledZ&&this.wrap===x.wrap&&this.canonical.equals(x.canonical)},no.prototype.scaledTo=function(x){var I=this.canonical.z-x;return x>this.canonical.z?new no(x,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new no(x,this.wrap,x,this.canonical.x>>I,this.canonical.y>>I)},no.prototype.calculateScaledKey=function(x,I){var H=this.canonical.z-x;return x>this.canonical.z?sc(this.wrap*+I,x,this.canonical.z,this.canonical.x,this.canonical.y):sc(this.wrap*+I,x,x,this.canonical.x>>H,this.canonical.y>>H)},no.prototype.isChildOf=function(x){if(x.wrap!==this.wrap)return!1;var I=this.canonical.z-x.canonical.z;return x.overscaledZ===0||x.overscaledZ<this.overscaledZ&&x.canonical.x===this.canonical.x>>I&&x.canonical.y===this.canonical.y>>I},no.prototype.children=function(x){if(this.overscaledZ>=x)return[new no(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var I=this.canonical.z+1,H=2*this.canonical.x,ee=2*this.canonical.y;return[new no(I,this.wrap,I,H,ee),new no(I,this.wrap,I,H+1,ee),new no(I,this.wrap,I,H,ee+1),new no(I,this.wrap,I,H+1,ee+1)]},no.prototype.isLessThan=function(x){return this.wrap<x.wrap||!(this.wrap>x.wrap)&&(this.overscaledZ<x.overscaledZ||!(this.overscaledZ>x.overscaledZ)&&(this.canonical.x<x.canonical.x||!(this.canonical.x>x.canonical.x)&&this.canonical.y<x.canonical.y))},no.prototype.wrapped=function(){return new no(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},no.prototype.unwrapTo=function(x){return new no(this.overscaledZ,x,this.canonical.z,this.canonical.x,this.canonical.y)},no.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},no.prototype.toUnwrapped=function(){return new Uf(this.wrap,this.canonical)},no.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},no.prototype.getTilePoint=function(x){return this.canonical.getTilePoint(new ml(x.x-this.wrap,x.y))},Hr("CanonicalTileID",vl),Hr("OverscaledTileID",no,{omit:["posMatrix"]});var Ys=function(x,I,H){if(this.uid=x,I.height!==I.width)throw new RangeError("DEM tiles must be square");if(H&&H!=="mapbox"&&H!=="terrarium")return w('"'+H+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=I.height;var ee=this.dim=I.height-2;this.data=new Uint32Array(I.data.buffer),this.encoding=H||"mapbox";for(var ue=0;ue<ee;ue++)this.data[this._idx(-1,ue)]=this.data[this._idx(0,ue)],this.data[this._idx(ee,ue)]=this.data[this._idx(ee-1,ue)],this.data[this._idx(ue,-1)]=this.data[this._idx(ue,0)],this.data[this._idx(ue,ee)]=this.data[this._idx(ue,ee-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ee,-1)]=this.data[this._idx(ee-1,0)],this.data[this._idx(-1,ee)]=this.data[this._idx(0,ee-1)],this.data[this._idx(ee,ee)]=this.data[this._idx(ee-1,ee-1)]};Ys.prototype.get=function(x,I){var H=new Uint8Array(this.data.buffer),ee=4*this._idx(x,I);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(H[ee],H[ee+1],H[ee+2])},Ys.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ys.prototype._idx=function(x,I){if(x<-1||x>=this.dim+1||I<-1||I>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(I+1)*this.stride+(x+1)},Ys.prototype._unpackMapbox=function(x,I,H){return(256*x*256+256*I+H)/10-1e4},Ys.prototype._unpackTerrarium=function(x,I,H){return 256*x+I+H/256-32768},Ys.prototype.getPixels=function(){return new Zo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ys.prototype.backfillBorder=function(x,I,H){if(this.dim!==x.dim)throw new Error("dem dimension mismatch");var ee=I*this.dim,ue=I*this.dim+this.dim,me=H*this.dim,we=H*this.dim+this.dim;switch(I){case-1:ee=ue-1;break;case 1:ue=ee+1}switch(H){case-1:me=we-1;break;case 1:we=me+1}for(var Re=-I*this.dim,Ze=-H*this.dim,ct=me;ct<we;ct++)for(var pt=ee;pt<ue;pt++)this.data[this._idx(pt,ct)]=x.data[this._idx(pt+Re,ct+Ze)]},Hr("DEMData",Ys);var zc=function(x){this._stringToNumber={},this._numberToString=[];for(var I=0;I<x.length;I++){var H=x[I];this._stringToNumber[H]=I,this._numberToString[I]=H}};zc.prototype.encode=function(x){return this._stringToNumber[x]},zc.prototype.decode=function(x){return this._numberToString[x]};var Dc=function(x,I,H,ee,ue){this.type="Feature",this._vectorTileFeature=x,x._z=I,x._x=H,x._y=ee,this.properties=x.properties,this.id=ue},Au={geometry:{configurable:!0}};Au.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Au.geometry.set=function(x){this._geometry=x},Dc.prototype.toJSON=function(){var x={geometry:this.geometry};for(var I in this)I!=="_geometry"&&I!=="_vectorTileFeature"&&(x[I]=this[I]);return x},Object.defineProperties(Dc.prototype,Au);var Dl=function(){this.state={},this.stateChanges={},this.deletedStates={}};Dl.prototype.updateState=function(x,I,H){var ee=String(I);if(this.stateChanges[x]=this.stateChanges[x]||{},this.stateChanges[x][ee]=this.stateChanges[x][ee]||{},g(this.stateChanges[x][ee],H),this.deletedStates[x]===null)for(var ue in this.deletedStates[x]={},this.state[x])ue!==ee&&(this.deletedStates[x][ue]=null);else if(this.deletedStates[x]&&this.deletedStates[x][ee]===null)for(var me in this.deletedStates[x][ee]={},this.state[x][ee])H[me]||(this.deletedStates[x][ee][me]=null);else for(var we in H)this.deletedStates[x]&&this.deletedStates[x][ee]&&this.deletedStates[x][ee][we]===null&&delete this.deletedStates[x][ee][we]},Dl.prototype.removeFeatureState=function(x,I,H){if(this.deletedStates[x]!==null){var ee=String(I);if(this.deletedStates[x]=this.deletedStates[x]||{},H&&I!==void 0)this.deletedStates[x][ee]!==null&&(this.deletedStates[x][ee]=this.deletedStates[x][ee]||{},this.deletedStates[x][ee][H]=null);else if(I!==void 0)if(this.stateChanges[x]&&this.stateChanges[x][ee])for(H in this.deletedStates[x][ee]={},this.stateChanges[x][ee])this.deletedStates[x][ee][H]=null;else this.deletedStates[x][ee]=null;else this.deletedStates[x]=null}},Dl.prototype.getState=function(x,I){var H=String(I),ee=this.state[x]||{},ue=this.stateChanges[x]||{},me=g({},ee[H],ue[H]);if(this.deletedStates[x]===null)return{};if(this.deletedStates[x]){var we=this.deletedStates[x][I];if(we===null)return{};for(var Re in we)delete me[Re]}return me},Dl.prototype.initializeTileState=function(x,I){x.setFeatureState(this.state,I)},Dl.prototype.coalesceChanges=function(x,I){var H={};for(var ee in this.stateChanges){this.state[ee]=this.state[ee]||{};var ue={};for(var me in this.stateChanges[ee])this.state[ee][me]||(this.state[ee][me]={}),g(this.state[ee][me],this.stateChanges[ee][me]),ue[me]=this.state[ee][me];H[ee]=ue}for(var we in this.deletedStates){this.state[we]=this.state[we]||{};var Re={};if(this.deletedStates[we]===null)for(var Ze in this.state[we])Re[Ze]={},this.state[we][Ze]={};else for(var ct in this.deletedStates[we]){if(this.deletedStates[we][ct]===null)this.state[we][ct]={};else for(var pt=0,Rt=Object.keys(this.deletedStates[we][ct]);pt<Rt.length;pt+=1){var Yt=Rt[pt];delete this.state[we][ct][Yt]}Re[ct]=this.state[we][ct]}H[we]=H[we]||{},g(H[we],Re)}if(this.stateChanges={},this.deletedStates={},Object.keys(H).length!==0)for(var qt in x)x[qt].setFeatureState(H,I)};var Ws=function(x,I){this.tileID=x,this.x=x.canonical.x,this.y=x.canonical.y,this.z=x.canonical.z,this.grid=new tn(8192,16,0),this.grid3D=new tn(8192,16,0),this.featureIndexArray=new wt,this.promoteId=I};function Vf(x,I,H,ee,ue){return E(x,function(me,we){var Re=I instanceof es?I.get(we):null;return Re&&Re.evaluate?Re.evaluate(H,ee,ue):Re})}function qf(x){for(var I=1/0,H=1/0,ee=-1/0,ue=-1/0,me=0,we=x;me<we.length;me+=1){var Re=we[me];I=Math.min(I,Re.x),H=Math.min(H,Re.y),ee=Math.max(ee,Re.x),ue=Math.max(ue,Re.y)}return{minX:I,minY:H,maxX:ee,maxY:ue}}function Rp(x,I){return I-x}Ws.prototype.insert=function(x,I,H,ee,ue,me){var we=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(H,ee,ue);for(var Re=me?this.grid3D:this.grid,Ze=0;Ze<I.length;Ze++){for(var ct=I[Ze],pt=[1/0,1/0,-1/0,-1/0],Rt=0;Rt<ct.length;Rt++){var Yt=ct[Rt];pt[0]=Math.min(pt[0],Yt.x),pt[1]=Math.min(pt[1],Yt.y),pt[2]=Math.max(pt[2],Yt.x),pt[3]=Math.max(pt[3],Yt.y)}pt[0]<8192&&pt[1]<8192&&pt[2]>=0&&pt[3]>=0&&Re.insert(we,pt[0],pt[1],pt[2],pt[3])}},Ws.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Ml.VectorTile(new Tc(this.rawTileData)).layers,this.sourceLayerCoder=new zc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ws.prototype.query=function(x,I,H,ee){var ue=this;this.loadVTLayers();for(var me=x.params||{},we=8192/x.tileSize/x.scale,Re=wa(me.filter),Ze=x.queryGeometry,ct=x.queryPadding*we,pt=qf(Ze),Rt=this.grid.query(pt.minX-ct,pt.minY-ct,pt.maxX+ct,pt.maxY+ct),Yt=qf(x.cameraQueryGeometry),qt=this.grid3D.query(Yt.minX-ct,Yt.minY-ct,Yt.maxX+ct,Yt.maxY+ct,function(nn,hn,Ln,En){return function(Bn,ea,ta,Vn,la){for(var oa=0,ra=Bn;oa<ra.length;oa+=1){var Wa=ra[oa];if(ea<=Wa.x&&ta<=Wa.y&&Vn>=Wa.x&&la>=Wa.y)return!0}var Ba=[new n(ea,ta),new n(ea,la),new n(Vn,la),new n(Vn,ta)];if(Bn.length>2){for(var Ka=0,xa=Ba;Ka<xa.length;Ka+=1)if(rs(Bn,xa[Ka]))return!0}for(var Ua=0;Ua<Bn.length-1;Ua++)if(fl(Bn[Ua],Bn[Ua+1],Ba))return!0;return!1}(x.cameraQueryGeometry,nn-ct,hn-ct,Ln+ct,En+ct)}),rr=0,fr=qt;rr<fr.length;rr+=1){var Er=fr[rr];Rt.push(Er)}Rt.sort(Rp);for(var Sr,Fr={},Br=function(nn){var hn=Rt[nn];if(hn!==Sr){Sr=hn;var Ln=ue.featureIndexArray.get(hn),En=null;ue.loadMatchingFeature(Fr,Ln.bucketIndex,Ln.sourceLayerIndex,Ln.featureIndex,Re,me.layers,me.availableImages,I,H,ee,function(Bn,ea,ta){return En||(En=hi(Bn)),ea.queryIntersectsFeature(Ze,Bn,ta,En,ue.z,x.transform,we,x.pixelPosMatrix)})}},Ur=0;Ur<Rt.length;Ur++)Br(Ur);return Fr},Ws.prototype.loadMatchingFeature=function(x,I,H,ee,ue,me,we,Re,Ze,ct,pt){var Rt=this.bucketLayerIDs[I];if(!me||function(Ln,En){for(var Bn=0;Bn<Ln.length;Bn++)if(En.indexOf(Ln[Bn])>=0)return!0;return!1}(me,Rt)){var Yt=this.sourceLayerCoder.decode(H),qt=this.vtLayers[Yt].feature(ee);if(ue.filter(new $a(this.tileID.overscaledZ),qt))for(var rr=this.getId(qt,Yt),fr=0;fr<Rt.length;fr++){var Er=Rt[fr];if(!(me&&me.indexOf(Er)<0)){var Sr=Re[Er];if(Sr){var Fr={};rr!==void 0&&ct&&(Fr=ct.getState(Sr.sourceLayer||"_geojsonTileLayer",rr));var Br=Ze[Er];Br.paint=Vf(Br.paint,Sr.paint,qt,Fr,we),Br.layout=Vf(Br.layout,Sr.layout,qt,Fr,we);var Ur=!pt||pt(qt,Sr,Fr);if(Ur){var nn=new Dc(qt,this.z,this.x,this.y,rr);nn.layer=Br;var hn=x[Er];hn===void 0&&(hn=x[Er]=[]),hn.push({featureIndex:ee,feature:nn,intersectionZ:Ur})}}}}}},Ws.prototype.lookupSymbolFeatures=function(x,I,H,ee,ue,me,we,Re){var Ze={};this.loadVTLayers();for(var ct=wa(ue),pt=0,Rt=x;pt<Rt.length;pt+=1){var Yt=Rt[pt];this.loadMatchingFeature(Ze,H,ee,Yt,ct,me,we,Re,I)}return Ze},Ws.prototype.hasLayer=function(x){for(var I=0,H=this.bucketLayerIDs;I<H.length;I+=1)for(var ee=0,ue=H[I];ee<ue.length;ee+=1)if(x===ue[ee])return!0;return!1},Ws.prototype.getId=function(x,I){var H=x.id;if(this.promoteId){var ee=typeof this.promoteId=="string"?this.promoteId:this.promoteId[I];typeof(H=x.properties[ee])=="boolean"&&(H=Number(H))}return H},Hr("FeatureIndex",Ws,{omit:["rawTileData","sourceLayerCoder"]});var yo=function(x,I){this.tileID=x,this.uid=y(),this.uses=0,this.tileSize=I,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};yo.prototype.registerFadeDuration=function(x){var I=x+this.timeAdded;I<U.now()||this.fadeEndTime&&I<this.fadeEndTime||(this.fadeEndTime=I)},yo.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},yo.prototype.loadVectorData=function(x,I,H){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",x){for(var ee in x.featureIndex&&(this.latestFeatureIndex=x.featureIndex,x.rawTileData?(this.latestRawTileData=x.rawTileData,this.latestFeatureIndex.rawTileData=x.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=x.collisionBoxArray,this.buckets=function(ct,pt){var Rt={};if(!pt)return Rt;for(var Yt=function(){var fr=rr[qt],Er=fr.layerIds.map(function(Ur){return pt.getLayer(Ur)}).filter(Boolean);if(Er.length!==0){fr.layers=Er,fr.stateDependentLayerIds&&(fr.stateDependentLayers=fr.stateDependentLayerIds.map(function(Ur){return Er.filter(function(nn){return nn.id===Ur})[0]}));for(var Sr=0,Fr=Er;Sr<Fr.length;Sr+=1){var Br=Fr[Sr];Rt[Br.id]=fr}}},qt=0,rr=ct;qt<rr.length;qt+=1)Yt();return Rt}(x.buckets,I.style),this.hasSymbolBuckets=!1,this.buckets){var ue=this.buckets[ee];if(ue instanceof ii){if(this.hasSymbolBuckets=!0,!H)break;ue.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var me in this.buckets){var we=this.buckets[me];if(we instanceof ii&&we.hasRTLText){this.hasRTLText=!0,so.isLoading()||so.isLoaded()||Ui()!=="deferred"||Qa();break}}for(var Re in this.queryPadding=0,this.buckets){var Ze=this.buckets[Re];this.queryPadding=Math.max(this.queryPadding,I.style.getLayer(Re).queryRadius(Ze))}x.imageAtlas&&(this.imageAtlas=x.imageAtlas),x.glyphAtlasImage&&(this.glyphAtlasImage=x.glyphAtlasImage)}else this.collisionBoxArray=new ye},yo.prototype.unloadVectorData=function(){for(var x in this.buckets)this.buckets[x].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},yo.prototype.getBucket=function(x){return this.buckets[x.id]},yo.prototype.upload=function(x){for(var I in this.buckets){var H=this.buckets[I];H.uploadPending()&&H.upload(x)}var ee=x.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new dl(x,this.imageAtlas.image,ee.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new dl(x,this.glyphAtlasImage,ee.ALPHA),this.glyphAtlasImage=null)},yo.prototype.prepare=function(x){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(x,this.imageAtlasTexture)},yo.prototype.queryRenderedFeatures=function(x,I,H,ee,ue,me,we,Re,Ze,ct){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:ee,cameraQueryGeometry:ue,scale:me,tileSize:this.tileSize,pixelPosMatrix:ct,transform:Re,params:we,queryPadding:this.queryPadding*Ze},x,I,H):{}},yo.prototype.querySourceFeatures=function(x,I){var H=this.latestFeatureIndex;if(H&&H.rawTileData){var ee=H.loadVTLayers(),ue=I?I.sourceLayer:"",me=ee._geojsonTileLayer||ee[ue];if(me)for(var we=wa(I&&I.filter),Re=this.tileID.canonical,Ze=Re.z,ct=Re.x,pt=Re.y,Rt={z:Ze,x:ct,y:pt},Yt=0;Yt<me.length;Yt++){var qt=me.feature(Yt);if(we.filter(new $a(this.tileID.overscaledZ),qt)){var rr=H.getId(qt,ue),fr=new Dc(qt,Ze,ct,pt,rr);fr.tile=Rt,x.push(fr)}}}},yo.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},yo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},yo.prototype.setExpiryData=function(x){var I=this.expirationTime;if(x.cacheControl){var H=z(x.cacheControl);H["max-age"]&&(this.expirationTime=Date.now()+1e3*H["max-age"])}else x.expires&&(this.expirationTime=new Date(x.expires).getTime());if(this.expirationTime){var ee=Date.now(),ue=!1;if(this.expirationTime>ee)ue=!1;else if(I)if(this.expirationTime<I)ue=!0;else{var me=this.expirationTime-I;me?this.expirationTime=ee+Math.max(me,3e4):ue=!0}else ue=!0;ue?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},yo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},yo.prototype.setFeatureState=function(x,I){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(x).length!==0){var H=this.latestFeatureIndex.loadVTLayers();for(var ee in this.buckets)if(I.style.hasLayer(ee)){var ue=this.buckets[ee],me=ue.layers[0].sourceLayer||"_geojsonTileLayer",we=H[me],Re=x[me];if(we&&Re&&Object.keys(Re).length!==0){ue.update(Re,we,this.imageAtlas&&this.imageAtlas.patternPositions||{});var Ze=I&&I.style&&I.style.getLayer(ee);Ze&&(this.queryPadding=Math.max(this.queryPadding,Ze.queryRadius(ue)))}}}},yo.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},yo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<U.now()},yo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},yo.prototype.setHoldDuration=function(x){this.symbolFadeHoldUntil=U.now()+x},yo.prototype.setDependencies=function(x,I){for(var H={},ee=0,ue=I;ee<ue.length;ee+=1)H[ue[ee]]=!0;this.dependencies[x]=H},yo.prototype.hasDependency=function(x,I){for(var H=0,ee=x;H<ee.length;H+=1){var ue=ee[H],me=this.dependencies[ue];if(me){for(var we=0,Re=I;we<Re.length;we+=1)if(me[Re[we]])return!0}}return!1};var rl=self.performance,Hf=function(x){this._marks={start:[x.url,"start"].join("#"),end:[x.url,"end"].join("#"),measure:x.url.toString()},rl.mark(this._marks.start)};Hf.prototype.finish=function(){rl.mark(this._marks.end);var x=rl.getEntriesByName(this._marks.measure);return x.length===0&&(rl.measure(this._marks.measure,this._marks.start,this._marks.end),x=rl.getEntriesByName(this._marks.measure),rl.clearMarks(this._marks.start),rl.clearMarks(this._marks.end),rl.clearMeasures(this._marks.measure)),x},e.Actor=zl,e.AlphaImage=pl,e.CanonicalTileID=vl,e.CollisionBoxArray=ye,e.Color=Kt,e.DEMData=Ys,e.DataConstantProperty=na,e.DictionaryCoder=zc,e.EXTENT=8192,e.ErrorEvent=Ae,e.EvaluationParameters=$a,e.Event=be,e.Evented=Pe,e.FeatureIndex=Ws,e.FillBucket=Es,e.FillExtrusionBucket=Ls,e.ImageAtlas=ic,e.ImagePosition=Mc,e.LineBucket=Jo,e.LngLat=Ti,e.LngLatBounds=ro,e.MercatorCoordinate=ml,e.ONE_EM=24,e.OverscaledTileID=no,e.Point=n,e.Point$1=n,e.Properties=Eo,e.Protobuf=Tc,e.RGBAImage=Zo,e.RequestManager=ie,e.RequestPerformance=Hf,e.ResourceType=ot,e.SegmentVector=Dt,e.SourceFeatureState=Dl,e.StructArrayLayout1ui2=j,e.StructArrayLayout2f1f2i16=Qs,e.StructArrayLayout2i4=os,e.StructArrayLayout3ui6=eo,e.StructArrayLayout4i8=Si,e.SymbolBucket=ii,e.Texture=dl,e.Tile=yo,e.Transitionable=$o,e.Uniform1f=jr,e.Uniform1i=ia,e.Uniform2f=mn,e.Uniform3f=Un,e.Uniform4f=Fn,e.UniformColor=Jn,e.UniformMatrix4f=ka,e.UnwrappedTileID=Uf,e.ValidationError=qe,e.WritingMode=ls,e.ZoomHistory=Sa,e.add=function(x,I,H){return x[0]=I[0]+H[0],x[1]=I[1]+H[1],x[2]=I[2]+H[2],x},e.addDynamicAttributes=wu,e.asyncAll=function(x,I,H){if(!x.length)return H(null,[]);var ee=x.length,ue=new Array(x.length),me=null;x.forEach(function(we,Re){I(we,function(Ze,ct){Ze&&(me=Ze),ue[Re]=ct,--ee==0&&H(me,ue)})})},e.bezier=r,e.bindAll=_,e.browser=U,e.cacheEntryPossiblyAdded=function(x){++$e>We&&(x.getActor().send("enforceCacheSizeLimit",Be),$e=0)},e.clamp=f,e.clearTileCache=function(x){var I=self.caches.delete("mapbox-tiles");x&&I.catch(x).then(function(){return x()})},e.clipLine=Mf,e.clone=function(x){var I=new Xo(16);return I[0]=x[0],I[1]=x[1],I[2]=x[2],I[3]=x[3],I[4]=x[4],I[5]=x[5],I[6]=x[6],I[7]=x[7],I[8]=x[8],I[9]=x[9],I[10]=x[10],I[11]=x[11],I[12]=x[12],I[13]=x[13],I[14]=x[14],I[15]=x[15],I},e.clone$1=b,e.clone$2=function(x){var I=new Xo(3);return I[0]=x[0],I[1]=x[1],I[2]=x[2],I},e.collisionCircleLayout=rp,e.config=G,e.create=function(){var x=new Xo(16);return Xo!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=0,x[12]=0,x[13]=0,x[14]=0),x[0]=1,x[5]=1,x[10]=1,x[15]=1,x},e.create$1=function(){var x=new Xo(9);return Xo!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[5]=0,x[6]=0,x[7]=0),x[0]=1,x[4]=1,x[8]=1,x},e.create$2=function(){var x=new Xo(4);return Xo!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x},e.createCommonjsModule=l,e.createExpression=Gt,e.createLayout=ei,e.createStyleLayer=function(x){return x.type==="custom"?new zp(x):new Dp[x.type](x)},e.cross=function(x,I,H){var ee=I[0],ue=I[1],me=I[2],we=H[0],Re=H[1],Ze=H[2];return x[0]=ue*Ze-me*Re,x[1]=me*we-ee*Ze,x[2]=ee*Re-ue*we,x},e.deepEqual=function x(I,H){if(Array.isArray(I)){if(!Array.isArray(H)||I.length!==H.length)return!1;for(var ee=0;ee<I.length;ee++)if(!x(I[ee],H[ee]))return!1;return!0}if(typeof I=="object"&&I!==null&&H!==null){if(typeof H!="object"||Object.keys(I).length!==Object.keys(H).length)return!1;for(var ue in I)if(!x(I[ue],H[ue]))return!1;return!0}return I===H},e.dot=function(x,I){return x[0]*I[0]+x[1]*I[1]+x[2]*I[2]},e.dot$1=function(x,I){return x[0]*I[0]+x[1]*I[1]+x[2]*I[2]+x[3]*I[3]},e.ease=c,e.emitValidationErrors=pn,e.endsWith=k,e.enforceCacheSizeLimit=function(x){Qe(),xe&&xe.then(function(I){I.keys().then(function(H){for(var ee=0;ee<H.length-x;ee++)I.delete(H[ee])})})},e.evaluateSizeForFeature=xf,e.evaluateSizeForZoom=bf,e.evaluateVariableOffset=Ef,e.evented=bi,e.extend=g,e.featureFilter=wa,e.filterObject=A,e.fromRotation=function(x,I){var H=Math.sin(I),ee=Math.cos(I);return x[0]=ee,x[1]=H,x[2]=0,x[3]=-H,x[4]=ee,x[5]=0,x[6]=0,x[7]=0,x[8]=1,x},e.getAnchorAlignment=yu,e.getAnchorJustification=_u,e.getArrayBuffer=Mt,e.getImage=Ge,e.getJSON=function(x,I){return Ke(g(x,{type:"json"}),I)},e.getRTLTextPluginStatus=Ui,e.getReferrer=mt,e.getVideo=function(x,I){var H,ee,ue=self.document.createElement("video");ue.muted=!0,ue.onloadstart=function(){I(null,ue)};for(var me=0;me<x.length;me++){var we=self.document.createElement("source");H=x[me],ee=void 0,(ee=self.document.createElement("a")).href=H,(ee.protocol!==self.document.location.protocol||ee.host!==self.document.location.host)&&(ue.crossOrigin="Anonymous"),we.src=x[me],ue.appendChild(we)}return{cancel:function(){}}},e.identity=Zl,e.invert=function(x,I){var H=I[0],ee=I[1],ue=I[2],me=I[3],we=I[4],Re=I[5],Ze=I[6],ct=I[7],pt=I[8],Rt=I[9],Yt=I[10],qt=I[11],rr=I[12],fr=I[13],Er=I[14],Sr=I[15],Fr=H*Re-ee*we,Br=H*Ze-ue*we,Ur=H*ct-me*we,nn=ee*Ze-ue*Re,hn=ee*ct-me*Re,Ln=ue*ct-me*Ze,En=pt*fr-Rt*rr,Bn=pt*Er-Yt*rr,ea=pt*Sr-qt*rr,ta=Rt*Er-Yt*fr,Vn=Rt*Sr-qt*fr,la=Yt*Sr-qt*Er,oa=Fr*la-Br*Vn+Ur*ta+nn*ea-hn*Bn+Ln*En;return oa?(oa=1/oa,x[0]=(Re*la-Ze*Vn+ct*ta)*oa,x[1]=(ue*Vn-ee*la-me*ta)*oa,x[2]=(fr*Ln-Er*hn+Sr*nn)*oa,x[3]=(Yt*hn-Rt*Ln-qt*nn)*oa,x[4]=(Ze*ea-we*la-ct*Bn)*oa,x[5]=(H*la-ue*ea+me*Bn)*oa,x[6]=(Er*Ur-rr*Ln-Sr*Br)*oa,x[7]=(pt*Ln-Yt*Ur+qt*Br)*oa,x[8]=(we*Vn-Re*ea+ct*En)*oa,x[9]=(ee*ea-H*Vn-me*En)*oa,x[10]=(rr*hn-fr*Ur+Sr*Fr)*oa,x[11]=(Rt*Ur-pt*hn-qt*Fr)*oa,x[12]=(Re*Bn-we*ta-Ze*En)*oa,x[13]=(H*ta-ee*Bn+ue*En)*oa,x[14]=(fr*Br-rr*nn-Er*Fr)*oa,x[15]=(pt*nn-Rt*Br+Yt*Fr)*oa,x):null},e.isChar=yn,e.isMapboxURL=he,e.keysDifference=function(x,I){var H=[];for(var ee in x)ee in I||H.push(ee);return H},e.makeRequest=Ke,e.mapObject=E,e.mercatorXfromLng=Bf,e.mercatorYfromLat=Nf,e.mercatorZfromAltitude=jf,e.mul=au,e.multiply=hl,e.mvt=Ml,e.normalize=function(x,I){var H=I[0],ee=I[1],ue=I[2],me=H*H+ee*ee+ue*ue;return me>0&&(me=1/Math.sqrt(me)),x[0]=I[0]*me,x[1]=I[1]*me,x[2]=I[2]*me,x},e.number=Wn,e.offscreenCanvasSupported=it,e.ortho=function(x,I,H,ee,ue,me,we){var Re=1/(I-H),Ze=1/(ee-ue),ct=1/(me-we);return x[0]=-2*Re,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*Ze,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=2*ct,x[11]=0,x[12]=(I+H)*Re,x[13]=(ue+ee)*Ze,x[14]=(we+me)*ct,x[15]=1,x},e.parseGlyphPBF=function(x){return new Tc(x).readFields(pp,[])},e.pbf=Tc,e.performSymbolLayout=function(x,I,H,ee,ue,me,we){x.createArrays();var Re=512*x.overscaling;x.tilePixelRatio=8192/Re,x.compareText={},x.iconsNeedLinear=!1;var Ze=x.layers[0].layout,ct=x.layers[0]._unevaluatedLayout._values,pt={};if(x.textSizeData.kind==="composite"){var Rt=x.textSizeData,Yt=Rt.minZoom,qt=Rt.maxZoom;pt.compositeTextSizes=[ct["text-size"].possiblyEvaluate(new $a(Yt),we),ct["text-size"].possiblyEvaluate(new $a(qt),we)]}if(x.iconSizeData.kind==="composite"){var rr=x.iconSizeData,fr=rr.minZoom,Er=rr.maxZoom;pt.compositeIconSizes=[ct["icon-size"].possiblyEvaluate(new $a(fr),we),ct["icon-size"].possiblyEvaluate(new $a(Er),we)]}pt.layoutTextSize=ct["text-size"].possiblyEvaluate(new $a(x.zoom+1),we),pt.layoutIconSize=ct["icon-size"].possiblyEvaluate(new $a(x.zoom+1),we),pt.textMaxSize=ct["text-size"].possiblyEvaluate(new $a(18));for(var Sr=24*Ze.get("text-line-height"),Fr=Ze.get("text-rotation-alignment")==="map"&&Ze.get("symbol-placement")!=="point",Br=Ze.get("text-keep-upright"),Ur=Ze.get("text-size"),nn=function(){var En=Ln[hn],Bn=Ze.get("text-font").evaluate(En,{},we).join(","),ea=Ur.evaluate(En,{},we),ta=pt.layoutTextSize.evaluate(En,{},we),Vn=pt.layoutIconSize.evaluate(En,{},we),la={horizontal:{},vertical:void 0},oa=En.text,ra=[0,0];if(oa){var Wa=oa.toString(),Ba=24*Ze.get("text-letter-spacing").evaluate(En,{},we),Ka=function(Oa){for(var Za=0,Bi=Oa;Za<Bi.length;Za+=1)if(!Ma(Bi[Za].charCodeAt(0)))return!1;return!0}(Wa)?Ba:0,xa=Ze.get("text-anchor").evaluate(En,{},we),Ua=Ze.get("text-variable-anchor");if(!Ua){var di=Ze.get("text-radial-offset").evaluate(En,{},we);ra=di?Ef(xa,[24*di,bu]):Ze.get("text-offset").evaluate(En,{},we).map(function(Oa){return 24*Oa})}var li=Fr?"center":Ze.get("text-justify").evaluate(En,{},we),ki=Ze.get("symbol-placement"),ci=ki==="point"?24*Ze.get("text-max-width").evaluate(En,{},we):0,ao=function(){x.allowVerticalPlacement&&Pa(Wa)&&(la.vertical=Ac(oa,I,H,ue,Bn,ci,Sr,xa,"left",Ka,ra,ls.vertical,!0,ki,ta,ea))};if(!Fr&&Ua){for(var Mi=li==="auto"?Ua.map(function(Oa){return _u(Oa)}):[li],Po=!1,xo=0;xo<Mi.length;xo++){var wo=Mi[xo];if(!la.horizontal[wo])if(Po)la.horizontal[wo]=la.horizontal[0];else{var Ho=Ac(oa,I,H,ue,Bn,ci,Sr,"center",wo,Ka,ra,ls.horizontal,!1,ki,ta,ea);Ho&&(la.horizontal[wo]=Ho,Po=Ho.positionedLines.length===1)}}ao()}else{li==="auto"&&(li=_u(xa));var Do=Ac(oa,I,H,ue,Bn,ci,Sr,xa,li,Ka,ra,ls.horizontal,!1,ki,ta,ea);Do&&(la.horizontal[li]=Do),ao(),Pa(Wa)&&Fr&&Br&&(la.vertical=Ac(oa,I,H,ue,Bn,ci,Sr,xa,li,Ka,ra,ls.vertical,!1,ki,ta,ea))}}var io=void 0,To=!1;if(En.icon&&En.icon.name){var Yi=ee[En.icon.name];Yi&&(io=function(Oa,Za,Bi){var Ni=yu(Bi),Oi=Ni.horizontalAlign,Ai=Ni.verticalAlign,ti=Za[0],ji=Za[1],Go=ti-Oa.displaySize[0]*Oi,as=Go+Oa.displaySize[0],Ro=ji-Oa.displaySize[1]*Ai;return{image:Oa,top:Ro,bottom:Ro+Oa.displaySize[1],left:Go,right:as}}(ue[En.icon.name],Ze.get("icon-offset").evaluate(En,{},we),Ze.get("icon-anchor").evaluate(En,{},we)),To=Yi.sdf,x.sdfIcons===void 0?x.sdfIcons=Yi.sdf:x.sdfIcons!==Yi.sdf&&w("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Yi.pixelRatio!==x.pixelRatio||Ze.get("icon-rotate").constantOr(1)!==0)&&(x.iconsNeedLinear=!0))}var lo=Cf(la.horizontal)||la.vertical;x.iconsInText=!!lo&&lo.iconsInText,(lo||io)&&function(Oa,Za,Bi,Ni,Oi,Ai,ti,ji,Go,as,Ro){var Cs=Ai.textMaxSize.evaluate(Za,{});Cs===void 0&&(Cs=ti);var Xs,bo=Oa.layers[0].layout,Ps=bo.get("icon-offset").evaluate(Za,{},Ro),Is=Cf(Bi.horizontal),Os=ti/24,Su=Oa.tilePixelRatio*Os,Rl=Oa.tilePixelRatio*Cs/24,Rc=Oa.tilePixelRatio*ji,yl=Oa.tilePixelRatio*bo.get("symbol-spacing"),Fc=bo.get("text-padding")*Oa.tilePixelRatio,Bc=bo.get("icon-padding")*Oa.tilePixelRatio,Nc=bo.get("text-max-angle")/180*Math.PI,jc=bo.get("text-rotation-alignment")==="map"&&bo.get("symbol-placement")!=="point",nl=bo.get("icon-rotation-alignment")==="map"&&bo.get("symbol-placement")!=="point",Fl=bo.get("symbol-placement"),Uc=yl/2,Bl=bo.get("icon-text-fit");Ni&&Bl!=="none"&&(Oa.allowVerticalPlacement&&Bi.vertical&&(Xs=yf(Ni,Bi.vertical,Bl,bo.get("icon-text-fit-padding"),Ps,Os)),Is&&(Ni=yf(Ni,Is,Bl,bo.get("icon-text-fit-padding"),Ps,Os)));var al=function(Bp,pc){pc.x<0||pc.x>=8192||pc.y<0||pc.y>=8192||function(qi,zs,Np,il,Iu,Xf,Zc,js,Jc,dc,Kc,Qc,Ou,Zf,gc,Jf,Kf,Qf,$f,eh,cs,$c,th,Us,jp){var zu,xl,Hl,Gl,Yl,Wl=qi.addToLineVertexArray(zs,Np),rh=0,nh=0,ah=0,ih=0,Du=-1,Ru=-1,Zs={},oh=Ar(""),Fu=0,Bu=0;if(js._unevaluatedLayout.getValue("text-radial-offset")===void 0?(zu=js.layout.get("text-offset").evaluate(cs,{},Us).map(function(vc){return 24*vc}),Fu=zu[0],Bu=zu[1]):(Fu=24*js.layout.get("text-radial-offset").evaluate(cs,{},Us),Bu=bu),qi.allowVerticalPlacement&&il.vertical){var sh=js.layout.get("text-rotate").evaluate(cs,{},Us)+90,Up=il.vertical;Gl=new Pc(Jc,zs,dc,Kc,Qc,Up,Ou,Zf,gc,sh),Zc&&(Yl=new Pc(Jc,zs,dc,Kc,Qc,Zc,Kf,Qf,gc,sh))}if(Iu){var Nu=js.layout.get("icon-rotate").evaluate(cs,{}),lh=js.layout.get("icon-text-fit")!=="none",ch=Af(Iu,Nu,th,lh),ju=Zc?Af(Zc,Nu,th,lh):void 0;Hl=new Pc(Jc,zs,dc,Kc,Qc,Iu,Kf,Qf,!1,Nu),rh=4*ch.length;var uh=qi.iconSizeData,mc=null;uh.kind==="source"?(mc=[128*js.layout.get("icon-size").evaluate(cs,{})])[0]>32640&&w(qi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):uh.kind==="composite"&&((mc=[128*$c.compositeIconSizes[0].evaluate(cs,{},Us),128*$c.compositeIconSizes[1].evaluate(cs,{},Us)])[0]>32640||mc[1]>32640)&&w(qi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),qi.addSymbols(qi.icon,ch,mc,eh,$f,cs,!1,zs,Wl.lineStartIndex,Wl.lineLength,-1,Us),Du=qi.icon.placedSymbolArray.length-1,ju&&(nh=4*ju.length,qi.addSymbols(qi.icon,ju,mc,eh,$f,cs,ls.vertical,zs,Wl.lineStartIndex,Wl.lineLength,-1,Us),Ru=qi.icon.placedSymbolArray.length-1)}for(var fh in il.horizontal){var eu=il.horizontal[fh];if(!xl){oh=Ar(eu.text);var Vp=js.layout.get("text-rotate").evaluate(cs,{},Us);xl=new Pc(Jc,zs,dc,Kc,Qc,eu,Ou,Zf,gc,Vp)}var hh=eu.positionedLines.length===1;if(ah+=Lf(qi,zs,eu,Xf,js,gc,cs,Jf,Wl,il.vertical?ls.horizontal:ls.horizontalOnly,hh?Object.keys(il.horizontal):[fh],Zs,Du,$c,Us),hh)break}il.vertical&&(ih+=Lf(qi,zs,il.vertical,Xf,js,gc,cs,Jf,Wl,ls.vertical,["vertical"],Zs,Ru,$c,Us));var qp=xl?xl.boxStartIndex:qi.collisionBoxArray.length,Hp=xl?xl.boxEndIndex:qi.collisionBoxArray.length,Gp=Gl?Gl.boxStartIndex:qi.collisionBoxArray.length,Yp=Gl?Gl.boxEndIndex:qi.collisionBoxArray.length,Wp=Hl?Hl.boxStartIndex:qi.collisionBoxArray.length,Xp=Hl?Hl.boxEndIndex:qi.collisionBoxArray.length,Zp=Yl?Yl.boxStartIndex:qi.collisionBoxArray.length,Jp=Yl?Yl.boxEndIndex:qi.collisionBoxArray.length,Vs=-1,tu=function(vc,dh){return vc&&vc.circleDiameter?Math.max(vc.circleDiameter,dh):dh};Vs=tu(xl,Vs),Vs=tu(Gl,Vs),Vs=tu(Hl,Vs);var ph=(Vs=tu(Yl,Vs))>-1?1:0;ph&&(Vs*=jp/24),qi.glyphOffsetArray.length>=ii.MAX_GLYPHS&&w("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),cs.sortKey!==void 0&&qi.addToSortKeyRanges(qi.symbolInstances.length,cs.sortKey),qi.symbolInstances.emplaceBack(zs.x,zs.y,Zs.right>=0?Zs.right:-1,Zs.center>=0?Zs.center:-1,Zs.left>=0?Zs.left:-1,Zs.vertical||-1,Du,Ru,oh,qp,Hp,Gp,Yp,Wp,Xp,Zp,Jp,dc,ah,ih,rh,nh,ph,0,Ou,Fu,Bu,Vs)}(Oa,pc,Bp,Bi,Ni,Oi,Xs,Oa.layers[0],Oa.collisionBoxArray,Za.index,Za.sourceLayerIndex,Oa.index,Su,Fc,jc,Go,Rc,Bc,nl,Ps,Za,Ai,as,Ro,ti)};if(Fl==="line")for(var lc=0,Vc=Mf(Za.geometry,0,0,8192,8192);lc<Vc.length;lc+=1)for(var qc=Vc[lc],Hc=bp(qc,yl,Nc,Bi.vertical||Is,Ni,24,Rl,Oa.overscaling,8192),cc=0,Gc=Hc;cc<Gc.length;cc+=1){var uc=Gc[cc],Yc=Is;Yc&&kp(Oa,Yc.text,Uc,uc)||al(qc,uc)}else if(Fl==="line-center")for(var fc=0,Wc=Za.geometry;fc<Wc.length;fc+=1){var Nl=Wc[fc];if(Nl.length>1){var jl=xp(Nl,Nc,Bi.vertical||Is,Ni,24,Rl);jl&&al(Nl,jl)}}else if(Za.type==="Polygon")for(var Ul=0,Xc=hu(Za.geometry,0);Ul<Xc.length;Ul+=1){var Vl=Xc[Ul],hc=wp(Vl,16);al(Vl[0],new Ll(hc.x,hc.y,0))}else if(Za.type==="LineString")for(var ql=0,Gf=Za.geometry;ql<Gf.length;ql+=1){var Eu=Gf[ql];al(Eu,new Ll(Eu[0].x,Eu[0].y,0))}else if(Za.type==="Point")for(var Lu=0,Yf=Za.geometry;Lu<Yf.length;Lu+=1)for(var Fp=Yf[Lu],Cu=0,Wf=Fp;Cu<Wf.length;Cu+=1){var Pu=Wf[Cu];al([Pu],new Ll(Pu.x,Pu.y,0))}}(x,En,la,io,ee,pt,ta,Vn,ra,To,we)},hn=0,Ln=x.features;hn<Ln.length;hn+=1)nn();me&&x.generateCollisionDebugBuffers()},e.perspective=function(x,I,H,ee,ue){var me,we=1/Math.tan(I/2);return x[0]=we/H,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=we,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,ue!=null&&ue!==1/0?(me=1/(ee-ue),x[10]=(ue+ee)*me,x[14]=2*ue*ee*me):(x[10]=-1,x[14]=-2*ee),x},e.pick=function(x,I){for(var H={},ee=0;ee<I.length;ee++){var ue=I[ee];ue in x&&(H[ue]=x[ue])}return H},e.plugin=so,e.polygonIntersectsPolygon=Oo,e.postMapLoadEvent=De,e.postTurnstileEvent=Me,e.potpack=df,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Hr,e.registerForPluginStateChange=function(x){return x({pluginStatus:ga,pluginURL:fi}),bi.on("pluginStateChange",x),x},e.rotate=function(x,I,H){var ee=I[0],ue=I[1],me=I[2],we=I[3],Re=Math.sin(H),Ze=Math.cos(H);return x[0]=ee*Ze+me*Re,x[1]=ue*Ze+we*Re,x[2]=ee*-Re+me*Ze,x[3]=ue*-Re+we*Ze,x},e.rotateX=function(x,I,H){var ee=Math.sin(H),ue=Math.cos(H),me=I[4],we=I[5],Re=I[6],Ze=I[7],ct=I[8],pt=I[9],Rt=I[10],Yt=I[11];return I!==x&&(x[0]=I[0],x[1]=I[1],x[2]=I[2],x[3]=I[3],x[12]=I[12],x[13]=I[13],x[14]=I[14],x[15]=I[15]),x[4]=me*ue+ct*ee,x[5]=we*ue+pt*ee,x[6]=Re*ue+Rt*ee,x[7]=Ze*ue+Yt*ee,x[8]=ct*ue-me*ee,x[9]=pt*ue-we*ee,x[10]=Rt*ue-Re*ee,x[11]=Yt*ue-Ze*ee,x},e.rotateZ=function(x,I,H){var ee=Math.sin(H),ue=Math.cos(H),me=I[0],we=I[1],Re=I[2],Ze=I[3],ct=I[4],pt=I[5],Rt=I[6],Yt=I[7];return I!==x&&(x[8]=I[8],x[9]=I[9],x[10]=I[10],x[11]=I[11],x[12]=I[12],x[13]=I[13],x[14]=I[14],x[15]=I[15]),x[0]=me*ue+ct*ee,x[1]=we*ue+pt*ee,x[2]=Re*ue+Rt*ee,x[3]=Ze*ue+Yt*ee,x[4]=ct*ue-me*ee,x[5]=pt*ue-we*ee,x[6]=Rt*ue-Re*ee,x[7]=Yt*ue-Ze*ee,x},e.scale=function(x,I,H){var ee=H[0],ue=H[1],me=H[2];return x[0]=I[0]*ee,x[1]=I[1]*ee,x[2]=I[2]*ee,x[3]=I[3]*ee,x[4]=I[4]*ue,x[5]=I[5]*ue,x[6]=I[6]*ue,x[7]=I[7]*ue,x[8]=I[8]*me,x[9]=I[9]*me,x[10]=I[10]*me,x[11]=I[11]*me,x[12]=I[12],x[13]=I[13],x[14]=I[14],x[15]=I[15],x},e.scale$1=function(x,I,H){return x[0]=I[0]*H,x[1]=I[1]*H,x[2]=I[2]*H,x[3]=I[3]*H,x},e.scale$2=function(x,I,H){return x[0]=I[0]*H,x[1]=I[1]*H,x[2]=I[2]*H,x},e.setCacheLimits=function(x,I){Be=x,We=I},e.setRTLTextPlugin=function(x,I,H){if(H===void 0&&(H=!1),ga===Ha||ga===Fi||ga===Wo)throw new Error("setRTLTextPlugin cannot be called multiple times.");fi=U.resolveURL(x),ga=Ha,po=I,Ga(),H||Qa()},e.sphericalToCartesian=function(x){var I=x[0],H=x[1],ee=x[2];return H+=90,H*=Math.PI/180,ee*=Math.PI/180,{x:I*Math.cos(H)*Math.sin(ee),y:I*Math.sin(H)*Math.sin(ee),z:I*Math.cos(ee)}},e.sqrLen=Jl,e.styleSpec=ze,e.sub=iu,e.symbolSize=yp,e.transformMat3=function(x,I,H){var ee=I[0],ue=I[1],me=I[2];return x[0]=ee*H[0]+ue*H[3]+me*H[6],x[1]=ee*H[1]+ue*H[4]+me*H[7],x[2]=ee*H[2]+ue*H[5]+me*H[8],x},e.transformMat4=wl,e.translate=function(x,I,H){var ee,ue,me,we,Re,Ze,ct,pt,Rt,Yt,qt,rr,fr=H[0],Er=H[1],Sr=H[2];return I===x?(x[12]=I[0]*fr+I[4]*Er+I[8]*Sr+I[12],x[13]=I[1]*fr+I[5]*Er+I[9]*Sr+I[13],x[14]=I[2]*fr+I[6]*Er+I[10]*Sr+I[14],x[15]=I[3]*fr+I[7]*Er+I[11]*Sr+I[15]):(ee=I[0],ue=I[1],me=I[2],we=I[3],Re=I[4],Ze=I[5],ct=I[6],pt=I[7],Rt=I[8],Yt=I[9],qt=I[10],rr=I[11],x[0]=ee,x[1]=ue,x[2]=me,x[3]=we,x[4]=Re,x[5]=Ze,x[6]=ct,x[7]=pt,x[8]=Rt,x[9]=Yt,x[10]=qt,x[11]=rr,x[12]=ee*fr+Re*Er+Rt*Sr+I[12],x[13]=ue*fr+Ze*Er+Yt*Sr+I[13],x[14]=me*fr+ct*Er+qt*Sr+I[14],x[15]=we*fr+pt*Er+rr*Sr+I[15]),x},e.triggerPluginCompletionEvent=go,e.uniqueId=y,e.validateCustomStyleLayer=function(x){var I=[],H=x.id;return H===void 0&&I.push({message:"layers."+H+': missing required property "id"'}),x.render===void 0&&I.push({message:"layers."+H+': missing required method "render"'}),x.renderingMode&&x.renderingMode!=="2d"&&x.renderingMode!=="3d"&&I.push({message:"layers."+H+': property "renderingMode" must be either "2d" or "3d"'}),I},e.validateLight=en,e.validateStyle=qr,e.values=function(x){var I=[];for(var H in x)I.push(x[H]);return I},e.vectorTile=Ml,e.version="1.10.1",e.warnOnce=w,e.webpSupported=$,e.window=self,e.wrap=d}),u(0,function(e){function l(be){var Ae=typeof be;if(Ae==="number"||Ae==="boolean"||Ae==="string"||be==null)return JSON.stringify(be);if(Array.isArray(be)){for(var Pe="[",ze=0,qe=be;ze<qe.length;ze+=1)Pe+=l(qe[ze])+",";return Pe+"]"}for(var ht=Object.keys(be).sort(),at="{",nt=0;nt<ht.length;nt++)at+=JSON.stringify(ht[nt])+":"+l(be[ht[nt]])+",";return at+"}"}function o(be){for(var Ae="",Pe=0,ze=e.refProperties;Pe<ze.length;Pe+=1)Ae+="/"+l(be[ze[Pe]]);return Ae}var a=function(be){this.keyCache={},be&&this.replace(be)};a.prototype.replace=function(be){this._layerConfigs={},this._layers={},this.update(be,[])},a.prototype.update=function(be,Ae){for(var Pe=this,ze=0,qe=be;ze<qe.length;ze+=1){var ht=qe[ze];this._layerConfigs[ht.id]=ht;var at=this._layers[ht.id]=e.createStyleLayer(ht);at._featureFilter=e.featureFilter(at.filter),this.keyCache[ht.id]&&delete this.keyCache[ht.id]}for(var nt=0,xt=Ae;nt<xt.length;nt+=1){var Lt=xt[nt];delete this.keyCache[Lt],delete this._layerConfigs[Lt],delete this._layers[Lt]}this.familiesBySource={};for(var bt=0,St=function(lt,At){for(var Bt={},Ht=0;Ht<lt.length;Ht++){var or=At&&At[lt[Ht].id]||o(lt[Ht]);At&&(At[lt[Ht].id]=or);var ar=Bt[or];ar||(ar=Bt[or]=[]),ar.push(lt[Ht])}var Nt=[];for(var nr in Bt)Nt.push(Bt[nr]);return Nt}(e.values(this._layerConfigs),this.keyCache);bt<St.length;bt+=1){var st=St[bt].map(function(lt){return Pe._layers[lt.id]}),It=st[0];if(It.visibility!=="none"){var jt=It.source||"",Ut=this.familiesBySource[jt];Ut||(Ut=this.familiesBySource[jt]={});var zt=It.sourceLayer||"_geojsonTileLayer",Ce=Ut[zt];Ce||(Ce=Ut[zt]=[]),Ce.push(st)}}};var n=function(be){var Ae={},Pe=[];for(var ze in be){var qe=be[ze],ht=Ae[ze]={};for(var at in qe){var nt=qe[+at];if(nt&&nt.bitmap.width!==0&&nt.bitmap.height!==0){var xt={x:0,y:0,w:nt.bitmap.width+2,h:nt.bitmap.height+2};Pe.push(xt),ht[at]={rect:xt,metrics:nt.metrics}}}}var Lt=e.potpack(Pe),bt=Lt.w,St=Lt.h,st=new e.AlphaImage({width:bt||1,height:St||1});for(var It in be){var jt=be[It];for(var Ut in jt){var zt=jt[+Ut];if(zt&&zt.bitmap.width!==0&&zt.bitmap.height!==0){var Ce=Ae[It][Ut].rect;e.AlphaImage.copy(zt.bitmap,st,{x:0,y:0},{x:Ce.x+1,y:Ce.y+1},zt.bitmap)}}}this.image=st,this.positions=Ae};e.register("GlyphAtlas",n);var s=function(be){this.tileID=new e.OverscaledTileID(be.tileID.overscaledZ,be.tileID.wrap,be.tileID.canonical.z,be.tileID.canonical.x,be.tileID.canonical.y),this.uid=be.uid,this.zoom=be.zoom,this.pixelRatio=be.pixelRatio,this.tileSize=be.tileSize,this.source=be.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=be.showCollisionBoxes,this.collectResourceTiming=!!be.collectResourceTiming,this.returnDependencies=!!be.returnDependencies,this.promoteId=be.promoteId};function r(be,Ae,Pe){for(var ze=new e.EvaluationParameters(Ae),qe=0,ht=be;qe<ht.length;qe+=1)ht[qe].recalculate(ze,Pe)}function c(be,Ae){var Pe=e.getArrayBuffer(be.request,function(ze,qe,ht,at){ze?Ae(ze):qe&&Ae(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(qe)),rawData:qe,cacheControl:ht,expires:at})});return function(){Pe.cancel(),Ae()}}s.prototype.parse=function(be,Ae,Pe,ze,qe){var ht=this;this.status="parsing",this.data=be,this.collisionBoxArray=new e.CollisionBoxArray;var at=new e.DictionaryCoder(Object.keys(be.layers).sort()),nt=new e.FeatureIndex(this.tileID,this.promoteId);nt.bucketLayerIDs=[];var xt,Lt,bt,St,st={},It={featureIndex:nt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Pe},jt=Ae.familiesBySource[this.source];for(var Ut in jt){var zt=be.layers[Ut];if(zt){zt.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+Ut+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ce=at.encode(Ut),lt=[],At=0;At<zt.length;At++){var Bt=zt.feature(At),Ht=nt.getId(Bt,Ut);lt.push({feature:Bt,id:Ht,index:At,sourceLayerIndex:Ce})}for(var or=0,ar=jt[Ut];or<ar.length;or+=1){var Nt=ar[or],nr=Nt[0];nr.minzoom&&this.zoom<Math.floor(nr.minzoom)||nr.maxzoom&&this.zoom>=nr.maxzoom||nr.visibility!=="none"&&(r(Nt,this.zoom,Pe),(st[nr.id]=nr.createBucket({index:nt.bucketLayerIDs.length,layers:Nt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ce,sourceID:this.source})).populate(lt,It,this.tileID.canonical),nt.bucketLayerIDs.push(Nt.map(function(xr){return xr.id})))}}}var Lr=e.mapObject(It.glyphDependencies,function(xr){return Object.keys(xr).map(Number)});Object.keys(Lr).length?ze.send("getGlyphs",{uid:this.uid,stacks:Lr},function(xr,gr){xt||(xt=xr,Lt=gr,yr.call(ht))}):Lt={};var dr=Object.keys(It.iconDependencies);dr.length?ze.send("getImages",{icons:dr,source:this.source,tileID:this.tileID,type:"icons"},function(xr,gr){xt||(xt=xr,bt=gr,yr.call(ht))}):bt={};var Kt=Object.keys(It.patternDependencies);function yr(){if(xt)return qe(xt);if(Lt&&bt&&St){var xr=new n(Lt),gr=new e.ImageAtlas(bt,St);for(var wr in st){var zr=st[wr];zr instanceof e.SymbolBucket?(r(zr.layers,this.zoom,Pe),e.performSymbolLayout(zr,Lt,xr.positions,bt,gr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):zr.hasPattern&&(zr instanceof e.LineBucket||zr instanceof e.FillBucket||zr instanceof e.FillExtrusionBucket)&&(r(zr.layers,this.zoom,Pe),zr.addFeatures(It,this.tileID.canonical,gr.patternPositions))}this.status="done",qe(null,{buckets:e.values(st).filter(function(Rr){return!Rr.isEmpty()}),featureIndex:nt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:xr.image,imageAtlas:gr,glyphMap:this.returnDependencies?Lt:null,iconMap:this.returnDependencies?bt:null,glyphPositions:this.returnDependencies?xr.positions:null})}}Kt.length?ze.send("getImages",{icons:Kt,source:this.source,tileID:this.tileID,type:"patterns"},function(xr,gr){xt||(xt=xr,St=gr,yr.call(ht))}):St={},yr.call(this)};var f=function(be,Ae,Pe,ze){this.actor=be,this.layerIndex=Ae,this.availableImages=Pe,this.loadVectorData=ze||c,this.loading={},this.loaded={}};f.prototype.loadTile=function(be,Ae){var Pe=this,ze=be.uid;this.loading||(this.loading={});var qe=!!(be&&be.request&&be.request.collectResourceTiming)&&new e.RequestPerformance(be.request),ht=this.loading[ze]=new s(be);ht.abort=this.loadVectorData(be,function(at,nt){if(delete Pe.loading[ze],at||!nt)return ht.status="done",Pe.loaded[ze]=ht,Ae(at);var xt=nt.rawData,Lt={};nt.expires&&(Lt.expires=nt.expires),nt.cacheControl&&(Lt.cacheControl=nt.cacheControl);var bt={};if(qe){var St=qe.finish();St&&(bt.resourceTiming=JSON.parse(JSON.stringify(St)))}ht.vectorTile=nt.vectorTile,ht.parse(nt.vectorTile,Pe.layerIndex,Pe.availableImages,Pe.actor,function(st,It){if(st||!It)return Ae(st);Ae(null,e.extend({rawTileData:xt.slice(0)},It,Lt,bt))}),Pe.loaded=Pe.loaded||{},Pe.loaded[ze]=ht})},f.prototype.reloadTile=function(be,Ae){var Pe=this,ze=this.loaded,qe=be.uid,ht=this;if(ze&&ze[qe]){var at=ze[qe];at.showCollisionBoxes=be.showCollisionBoxes;var nt=function(xt,Lt){var bt=at.reloadCallback;bt&&(delete at.reloadCallback,at.parse(at.vectorTile,ht.layerIndex,Pe.availableImages,ht.actor,bt)),Ae(xt,Lt)};at.status==="parsing"?at.reloadCallback=nt:at.status==="done"&&(at.vectorTile?at.parse(at.vectorTile,this.layerIndex,this.availableImages,this.actor,nt):nt())}},f.prototype.abortTile=function(be,Ae){var Pe=this.loading,ze=be.uid;Pe&&Pe[ze]&&Pe[ze].abort&&(Pe[ze].abort(),delete Pe[ze]),Ae()},f.prototype.removeTile=function(be,Ae){var Pe=this.loaded,ze=be.uid;Pe&&Pe[ze]&&delete Pe[ze],Ae()};var d=e.window.ImageBitmap,g=function(){this.loaded={}};g.prototype.loadTile=function(be,Ae){var Pe=be.uid,ze=be.encoding,qe=be.rawImageData,ht=d&&qe instanceof d?this.getImageData(qe):qe,at=new e.DEMData(Pe,ht,ze);this.loaded=this.loaded||{},this.loaded[Pe]=at,Ae(null,at)},g.prototype.getImageData=function(be){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(be.width,be.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=be.width,this.offscreenCanvas.height=be.height,this.offscreenCanvasContext.drawImage(be,0,0,be.width,be.height);var Ae=this.offscreenCanvasContext.getImageData(-1,-1,be.width+2,be.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:Ae.width,height:Ae.height},Ae.data)},g.prototype.removeTile=function(be){var Ae=this.loaded,Pe=be.uid;Ae&&Ae[Pe]&&delete Ae[Pe]};var m=function be(Ae,Pe){var ze,qe=Ae&&Ae.type;if(qe==="FeatureCollection")for(ze=0;ze<Ae.features.length;ze++)be(Ae.features[ze],Pe);else if(qe==="GeometryCollection")for(ze=0;ze<Ae.geometries.length;ze++)be(Ae.geometries[ze],Pe);else if(qe==="Feature")be(Ae.geometry,Pe);else if(qe==="Polygon")y(Ae.coordinates,Pe);else if(qe==="MultiPolygon")for(ze=0;ze<Ae.coordinates.length;ze++)y(Ae.coordinates[ze],Pe);return Ae};function y(be,Ae){if(be.length!==0){v(be[0],Ae);for(var Pe=1;Pe<be.length;Pe++)v(be[Pe],!Ae)}}function v(be,Ae){for(var Pe=0,ze=0,qe=be.length,ht=qe-1;ze<qe;ht=ze++)Pe+=(be[ze][0]-be[ht][0])*(be[ht][1]+be[ze][1]);Pe>=0!=!!Ae&&be.reverse()}var T=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,_=function(be){this._feature=be,this.extent=e.EXTENT,this.type=be.type,this.properties=be.tags,"id"in be&&!isNaN(be.id)&&(this.id=parseInt(be.id,10))};_.prototype.loadGeometry=function(){if(this._feature.type===1){for(var be=[],Ae=0,Pe=this._feature.geometry;Ae<Pe.length;Ae+=1){var ze=Pe[Ae];be.push([new e.Point$1(ze[0],ze[1])])}return be}for(var qe=[],ht=0,at=this._feature.geometry;ht<at.length;ht+=1){for(var nt=[],xt=0,Lt=at[ht];xt<Lt.length;xt+=1){var bt=Lt[xt];nt.push(new e.Point$1(bt[0],bt[1]))}qe.push(nt)}return qe},_.prototype.toGeoJSON=function(be,Ae,Pe){return T.call(this,be,Ae,Pe)};var k=function(be){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=be.length,this._features=be};k.prototype.feature=function(be){return new _(this._features[be])};var E=e.vectorTile.VectorTileFeature,A=b;function b(be,Ae){this.options=Ae||{},this.features=be,this.length=be.length}function L(be,Ae){this.id=typeof be.id=="number"?be.id:void 0,this.type=be.type,this.rawGeometry=be.type===1?[be.geometry]:be.geometry,this.properties=be.tags,this.extent=Ae||4096}b.prototype.feature=function(be){return new L(this.features[be],this.options.extent)},L.prototype.loadGeometry=function(){var be=this.rawGeometry;this.geometry=[];for(var Ae=0;Ae<be.length;Ae++){for(var Pe=be[Ae],ze=[],qe=0;qe<Pe.length;qe++)ze.push(new e.Point$1(Pe[qe][0],Pe[qe][1]));this.geometry.push(ze)}return this.geometry},L.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var be=this.geometry,Ae=1/0,Pe=-1/0,ze=1/0,qe=-1/0,ht=0;ht<be.length;ht++)for(var at=be[ht],nt=0;nt<at.length;nt++){var xt=at[nt];Ae=Math.min(Ae,xt.x),Pe=Math.max(Pe,xt.x),ze=Math.min(ze,xt.y),qe=Math.max(qe,xt.y)}return[Ae,ze,Pe,qe]},L.prototype.toGeoJSON=E.prototype.toGeoJSON;var w=z,C=z,S=function(be,Ae){Ae=Ae||{};var Pe={};for(var ze in be)Pe[ze]=new A(be[ze].features,Ae),Pe[ze].name=ze,Pe[ze].version=Ae.version,Pe[ze].extent=Ae.extent;return z({layers:Pe})},P=A;function z(be){var Ae=new e.pbf;return function(Pe,ze){for(var qe in Pe.layers)ze.writeMessage(3,F,Pe.layers[qe])}(be,Ae),Ae.finish()}function F(be,Ae){var Pe;Ae.writeVarintField(15,be.version||1),Ae.writeStringField(1,be.name||""),Ae.writeVarintField(5,be.extent||4096);var ze={keys:[],values:[],keycache:{},valuecache:{}};for(Pe=0;Pe<be.length;Pe++)ze.feature=be.feature(Pe),Ae.writeMessage(2,q,ze);var qe=ze.keys;for(Pe=0;Pe<qe.length;Pe++)Ae.writeStringField(3,qe[Pe]);var ht=ze.values;for(Pe=0;Pe<ht.length;Pe++)Ae.writeMessage(4,Y,ht[Pe])}function q(be,Ae){var Pe=be.feature;Pe.id!==void 0&&Ae.writeVarintField(1,Pe.id),Ae.writeMessage(2,W,be),Ae.writeVarintField(3,Pe.type),Ae.writeMessage(4,Z,Pe)}function W(be,Ae){var Pe=be.feature,ze=be.keys,qe=be.values,ht=be.keycache,at=be.valuecache;for(var nt in Pe.properties){var xt=ht[nt];xt===void 0&&(ze.push(nt),xt=ze.length-1,ht[nt]=xt),Ae.writeVarint(xt);var Lt=Pe.properties[nt],bt=typeof Lt;bt!=="string"&&bt!=="boolean"&&bt!=="number"&&(Lt=JSON.stringify(Lt));var St=bt+":"+Lt,st=at[St];st===void 0&&(qe.push(Lt),st=qe.length-1,at[St]=st),Ae.writeVarint(st)}}function X(be,Ae){return(Ae<<3)+(7&be)}function Q(be){return be<<1^be>>31}function Z(be,Ae){for(var Pe=be.loadGeometry(),ze=be.type,qe=0,ht=0,at=Pe.length,nt=0;nt<at;nt++){var xt=Pe[nt],Lt=1;ze===1&&(Lt=xt.length),Ae.writeVarint(X(1,Lt));for(var bt=ze===3?xt.length-1:xt.length,St=0;St<bt;St++){St===1&&ze!==1&&Ae.writeVarint(X(2,bt-1));var st=xt[St].x-qe,It=xt[St].y-ht;Ae.writeVarint(Q(st)),Ae.writeVarint(Q(It)),qe+=st,ht+=It}ze===3&&Ae.writeVarint(X(7,1))}}function Y(be,Ae){var Pe=typeof be;Pe==="string"?Ae.writeStringField(1,be):Pe==="boolean"?Ae.writeBooleanField(7,be):Pe==="number"&&(be%1!=0?Ae.writeDoubleField(3,be):be<0?Ae.writeSVarintField(6,be):Ae.writeVarintField(5,be))}function N(be,Ae,Pe,ze,qe,ht){if(!(qe-ze<=Pe)){var at=ze+qe>>1;(function nt(xt,Lt,bt,St,st,It){for(;st>St;){if(st-St>600){var jt=st-St+1,Ut=bt-St+1,zt=Math.log(jt),Ce=.5*Math.exp(2*zt/3),lt=.5*Math.sqrt(zt*Ce*(jt-Ce)/jt)*(Ut-jt/2<0?-1:1),At=Math.max(St,Math.floor(bt-Ut*Ce/jt+lt)),Bt=Math.min(st,Math.floor(bt+(jt-Ut)*Ce/jt+lt));nt(xt,Lt,bt,At,Bt,It)}var Ht=Lt[2*bt+It],or=St,ar=st;for(J(xt,Lt,St,bt),Lt[2*st+It]>Ht&&J(xt,Lt,St,st);or<ar;){for(J(xt,Lt,or,ar),or++,ar--;Lt[2*or+It]<Ht;)or++;for(;Lt[2*ar+It]>Ht;)ar--}Lt[2*St+It]===Ht?J(xt,Lt,St,ar):(ar++,J(xt,Lt,ar,st)),ar<=bt&&(St=ar+1),bt<=ar&&(st=ar-1)}})(be,Ae,at,ze,qe,ht%2),N(be,Ae,Pe,ze,at-1,ht+1),N(be,Ae,Pe,at+1,qe,ht+1)}}function J(be,Ae,Pe,ze){D(be,Pe,ze),D(Ae,2*Pe,2*ze),D(Ae,2*Pe+1,2*ze+1)}function D(be,Ae,Pe){var ze=be[Ae];be[Ae]=be[Pe],be[Pe]=ze}function U(be,Ae,Pe,ze){var qe=be-Pe,ht=Ae-ze;return qe*qe+ht*ht}w.fromVectorTileJs=C,w.fromGeojsonVt=S,w.GeoJSONWrapper=P;var G=function(be){return be[0]},$=function(be){return be[1]},K=function(be,Ae,Pe,ze,qe){Ae===void 0&&(Ae=G),Pe===void 0&&(Pe=$),ze===void 0&&(ze=64),qe===void 0&&(qe=Float64Array),this.nodeSize=ze,this.points=be;for(var ht=be.length<65536?Uint16Array:Uint32Array,at=this.ids=new ht(be.length),nt=this.coords=new qe(2*be.length),xt=0;xt<be.length;xt++)at[xt]=xt,nt[2*xt]=Ae(be[xt]),nt[2*xt+1]=Pe(be[xt]);N(at,nt,ze,0,at.length-1,0)};K.prototype.range=function(be,Ae,Pe,ze){return function(qe,ht,at,nt,xt,Lt,bt){for(var St,st,It=[0,qe.length-1,0],jt=[];It.length;){var Ut=It.pop(),zt=It.pop(),Ce=It.pop();if(zt-Ce<=bt)for(var lt=Ce;lt<=zt;lt++)St=ht[2*lt],st=ht[2*lt+1],St>=at&&St<=xt&&st>=nt&&st<=Lt&&jt.push(qe[lt]);else{var At=Math.floor((Ce+zt)/2);St=ht[2*At],st=ht[2*At+1],St>=at&&St<=xt&&st>=nt&&st<=Lt&&jt.push(qe[At]);var Bt=(Ut+1)%2;(Ut===0?at<=St:nt<=st)&&(It.push(Ce),It.push(At-1),It.push(Bt)),(Ut===0?xt>=St:Lt>=st)&&(It.push(At+1),It.push(zt),It.push(Bt))}}return jt}(this.ids,this.coords,be,Ae,Pe,ze,this.nodeSize)},K.prototype.within=function(be,Ae,Pe){return function(ze,qe,ht,at,nt,xt){for(var Lt=[0,ze.length-1,0],bt=[],St=nt*nt;Lt.length;){var st=Lt.pop(),It=Lt.pop(),jt=Lt.pop();if(It-jt<=xt)for(var Ut=jt;Ut<=It;Ut++)U(qe[2*Ut],qe[2*Ut+1],ht,at)<=St&&bt.push(ze[Ut]);else{var zt=Math.floor((jt+It)/2),Ce=qe[2*zt],lt=qe[2*zt+1];U(Ce,lt,ht,at)<=St&&bt.push(ze[zt]);var At=(st+1)%2;(st===0?ht-nt<=Ce:at-nt<=lt)&&(Lt.push(jt),Lt.push(zt-1),Lt.push(At)),(st===0?ht+nt>=Ce:at+nt>=lt)&&(Lt.push(zt+1),Lt.push(It),Lt.push(At))}}return bt}(this.ids,this.coords,be,Ae,Pe,this.nodeSize)};var re={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(be){return be}},ne=function(be){this.options=ve(Object.create(re),be),this.trees=new Array(this.options.maxZoom+1)};function ae(be,Ae,Pe,ze,qe){return{x:be,y:Ae,zoom:1/0,id:Pe,parentId:-1,numPoints:ze,properties:qe}}function ie(be,Ae){var Pe=be.geometry.coordinates,ze=Pe[0],qe=Pe[1];return{x:de(ze),y:ce(qe),zoom:1/0,index:Ae,parentId:-1}}function he(be){return{type:"Feature",id:be.id,properties:se(be),geometry:{type:"Point",coordinates:[(ze=be.x,360*(ze-.5)),(Ae=be.y,Pe=(180-360*Ae)*Math.PI/180,360*Math.atan(Math.exp(Pe))/Math.PI-90)]}};var Ae,Pe,ze}function se(be){var Ae=be.numPoints,Pe=Ae>=1e4?Math.round(Ae/1e3)+"k":Ae>=1e3?Math.round(Ae/100)/10+"k":Ae;return ve(ve({},be.properties),{cluster:!0,cluster_id:be.id,point_count:Ae,point_count_abbreviated:Pe})}function de(be){return be/360+.5}function ce(be){var Ae=Math.sin(be*Math.PI/180),Pe=.5-.25*Math.log((1+Ae)/(1-Ae))/Math.PI;return Pe<0?0:Pe>1?1:Pe}function ve(be,Ae){for(var Pe in Ae)be[Pe]=Ae[Pe];return be}function Ee(be){return be.x}function Le(be){return be.y}function Te(be,Ae,Pe,ze,qe,ht){var at=qe-Pe,nt=ht-ze;if(at!==0||nt!==0){var xt=((be-Pe)*at+(Ae-ze)*nt)/(at*at+nt*nt);xt>1?(Pe=qe,ze=ht):xt>0&&(Pe+=at*xt,ze+=nt*xt)}return(at=be-Pe)*at+(nt=Ae-ze)*nt}function xe(be,Ae,Pe,ze){var qe={id:be===void 0?null:be,type:Ae,geometry:Pe,tags:ze,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ht){var at=ht.geometry,nt=ht.type;if(nt==="Point"||nt==="MultiPoint"||nt==="LineString")fe(ht,at);else if(nt==="Polygon"||nt==="MultiLineString")for(var xt=0;xt<at.length;xt++)fe(ht,at[xt]);else if(nt==="MultiPolygon")for(xt=0;xt<at.length;xt++)for(var Lt=0;Lt<at[xt].length;Lt++)fe(ht,at[xt][Lt])}(qe),qe}function fe(be,Ae){for(var Pe=0;Pe<Ae.length;Pe+=3)be.minX=Math.min(be.minX,Ae[Pe]),be.minY=Math.min(be.minY,Ae[Pe+1]),be.maxX=Math.max(be.maxX,Ae[Pe]),be.maxY=Math.max(be.maxY,Ae[Pe+1])}function ge(be,Ae,Pe,ze){if(Ae.geometry){var qe=Ae.geometry.coordinates,ht=Ae.geometry.type,at=Math.pow(Pe.tolerance/((1<<Pe.maxZoom)*Pe.extent),2),nt=[],xt=Ae.id;if(Pe.promoteId?xt=Ae.properties[Pe.promoteId]:Pe.generateId&&(xt=ze||0),ht==="Point")ke(qe,nt);else if(ht==="MultiPoint")for(var Lt=0;Lt<qe.length;Lt++)ke(qe[Lt],nt);else if(ht==="LineString")Me(qe,nt,at,!1);else if(ht==="MultiLineString"){if(Pe.lineMetrics){for(Lt=0;Lt<qe.length;Lt++)nt=[],Me(qe[Lt],nt,at,!1),be.push(xe(xt,"LineString",nt,Ae.properties));return}Se(qe,nt,at,!1)}else if(ht==="Polygon")Se(qe,nt,at,!0);else{if(ht!=="MultiPolygon"){if(ht==="GeometryCollection"){for(Lt=0;Lt<Ae.geometry.geometries.length;Lt++)ge(be,{id:xt,geometry:Ae.geometry.geometries[Lt],properties:Ae.properties},Pe,ze);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Lt=0;Lt<qe.length;Lt++){var bt=[];Se(qe[Lt],bt,at,!0),nt.push(bt)}}be.push(xe(xt,ht,nt,Ae.properties))}}function ke(be,Ae){Ae.push(De(be[0])),Ae.push(Be(be[1])),Ae.push(0)}function Me(be,Ae,Pe,ze){for(var qe,ht,at=0,nt=0;nt<be.length;nt++){var xt=De(be[nt][0]),Lt=Be(be[nt][1]);Ae.push(xt),Ae.push(Lt),Ae.push(0),nt>0&&(at+=ze?(qe*Lt-xt*ht)/2:Math.sqrt(Math.pow(xt-qe,2)+Math.pow(Lt-ht,2))),qe=xt,ht=Lt}var bt=Ae.length-3;Ae[2]=1,function St(st,It,jt,Ut){for(var zt,Ce=Ut,lt=jt-It>>1,At=jt-It,Bt=st[It],Ht=st[It+1],or=st[jt],ar=st[jt+1],Nt=It+3;Nt<jt;Nt+=3){var nr=Te(st[Nt],st[Nt+1],Bt,Ht,or,ar);if(nr>Ce)zt=Nt,Ce=nr;else if(nr===Ce){var Lr=Math.abs(Nt-lt);Lr<At&&(zt=Nt,At=Lr)}}Ce>Ut&&(zt-It>3&&St(st,It,zt,Ut),st[zt+2]=Ce,jt-zt>3&&St(st,zt,jt,Ut))}(Ae,0,bt,Pe),Ae[bt+2]=1,Ae.size=Math.abs(at),Ae.start=0,Ae.end=Ae.size}function Se(be,Ae,Pe,ze){for(var qe=0;qe<be.length;qe++){var ht=[];Me(be[qe],ht,Pe,ze),Ae.push(ht)}}function De(be){return be/360+.5}function Be(be){var Ae=Math.sin(be*Math.PI/180),Pe=.5-.25*Math.log((1+Ae)/(1-Ae))/Math.PI;return Pe<0?0:Pe>1?1:Pe}function We(be,Ae,Pe,ze,qe,ht,at,nt){if(ze/=Ae,ht>=(Pe/=Ae)&&at<ze)return be;if(at<Pe||ht>=ze)return null;for(var xt=[],Lt=0;Lt<be.length;Lt++){var bt=be[Lt],St=bt.geometry,st=bt.type,It=qe===0?bt.minX:bt.minY,jt=qe===0?bt.maxX:bt.maxY;if(It>=Pe&&jt<ze)xt.push(bt);else if(!(jt<Pe||It>=ze)){var Ut=[];if(st==="Point"||st==="MultiPoint")Qe(St,Ut,Pe,ze,qe);else if(st==="LineString")Oe(St,Ut,Pe,ze,qe,!1,nt.lineMetrics);else if(st==="MultiLineString")Xe(St,Ut,Pe,ze,qe,!1);else if(st==="Polygon")Xe(St,Ut,Pe,ze,qe,!0);else if(st==="MultiPolygon")for(var zt=0;zt<St.length;zt++){var Ce=[];Xe(St[zt],Ce,Pe,ze,qe,!0),Ce.length&&Ut.push(Ce)}if(Ut.length){if(nt.lineMetrics&&st==="LineString"){for(zt=0;zt<Ut.length;zt++)xt.push(xe(bt.id,st,Ut[zt],bt.tags));continue}st!=="LineString"&&st!=="MultiLineString"||(Ut.length===1?(st="LineString",Ut=Ut[0]):st="MultiLineString"),st!=="Point"&&st!=="MultiPoint"||(st=Ut.length===3?"Point":"MultiPoint"),xt.push(xe(bt.id,st,Ut,bt.tags))}}}return xt.length?xt:null}function Qe(be,Ae,Pe,ze,qe){for(var ht=0;ht<be.length;ht+=3){var at=be[ht+qe];at>=Pe&&at<=ze&&(Ae.push(be[ht]),Ae.push(be[ht+1]),Ae.push(be[ht+2]))}}function Oe(be,Ae,Pe,ze,qe,ht,at){for(var nt,xt,Lt=Ue(be),bt=qe===0?$e:it,St=be.start,st=0;st<be.length-3;st+=3){var It=be[st],jt=be[st+1],Ut=be[st+2],zt=be[st+3],Ce=be[st+4],lt=qe===0?It:jt,At=qe===0?zt:Ce,Bt=!1;at&&(nt=Math.sqrt(Math.pow(It-zt,2)+Math.pow(jt-Ce,2))),lt<Pe?At>Pe&&(xt=bt(Lt,It,jt,zt,Ce,Pe),at&&(Lt.start=St+nt*xt)):lt>ze?At<ze&&(xt=bt(Lt,It,jt,zt,Ce,ze),at&&(Lt.start=St+nt*xt)):Ye(Lt,It,jt,Ut),At<Pe&&lt>=Pe&&(xt=bt(Lt,It,jt,zt,Ce,Pe),Bt=!0),At>ze&&lt<=ze&&(xt=bt(Lt,It,jt,zt,Ce,ze),Bt=!0),!ht&&Bt&&(at&&(Lt.end=St+nt*xt),Ae.push(Lt),Lt=Ue(be)),at&&(St+=nt)}var Ht=be.length-3;It=be[Ht],jt=be[Ht+1],Ut=be[Ht+2],(lt=qe===0?It:jt)>=Pe&&lt<=ze&&Ye(Lt,It,jt,Ut),Ht=Lt.length-3,ht&&Ht>=3&&(Lt[Ht]!==Lt[0]||Lt[Ht+1]!==Lt[1])&&Ye(Lt,Lt[0],Lt[1],Lt[2]),Lt.length&&Ae.push(Lt)}function Ue(be){var Ae=[];return Ae.size=be.size,Ae.start=be.start,Ae.end=be.end,Ae}function Xe(be,Ae,Pe,ze,qe,ht){for(var at=0;at<be.length;at++)Oe(be[at],Ae,Pe,ze,qe,ht,!1)}function Ye(be,Ae,Pe,ze){be.push(Ae),be.push(Pe),be.push(ze)}function $e(be,Ae,Pe,ze,qe,ht){var at=(ht-Ae)/(ze-Ae);return be.push(ht),be.push(Pe+(qe-Pe)*at),be.push(1),at}function it(be,Ae,Pe,ze,qe,ht){var at=(ht-Pe)/(qe-Pe);return be.push(Ae+(ze-Ae)*at),be.push(ht),be.push(1),at}function ot(be,Ae){for(var Pe=[],ze=0;ze<be.length;ze++){var qe,ht=be[ze],at=ht.type;if(at==="Point"||at==="MultiPoint"||at==="LineString")qe=Et(ht.geometry,Ae);else if(at==="MultiLineString"||at==="Polygon"){qe=[];for(var nt=0;nt<ht.geometry.length;nt++)qe.push(Et(ht.geometry[nt],Ae))}else if(at==="MultiPolygon")for(qe=[],nt=0;nt<ht.geometry.length;nt++){for(var xt=[],Lt=0;Lt<ht.geometry[nt].length;Lt++)xt.push(Et(ht.geometry[nt][Lt],Ae));qe.push(xt)}Pe.push(xe(ht.id,at,qe,ht.tags))}return Pe}function Et(be,Ae){var Pe=[];Pe.size=be.size,be.start!==void 0&&(Pe.start=be.start,Pe.end=be.end);for(var ze=0;ze<be.length;ze+=3)Pe.push(be[ze]+Ae,be[ze+1],be[ze+2]);return Pe}function mt(be,Ae){if(be.transformed)return be;var Pe,ze,qe,ht=1<<be.z,at=be.x,nt=be.y;for(Pe=0;Pe<be.features.length;Pe++){var xt=be.features[Pe],Lt=xt.geometry,bt=xt.type;if(xt.geometry=[],bt===1)for(ze=0;ze<Lt.length;ze+=2)xt.geometry.push(tt(Lt[ze],Lt[ze+1],Ae,ht,at,nt));else for(ze=0;ze<Lt.length;ze++){var St=[];for(qe=0;qe<Lt[ze].length;qe+=2)St.push(tt(Lt[ze][qe],Lt[ze][qe+1],Ae,ht,at,nt));xt.geometry.push(St)}}return be.transformed=!0,be}function tt(be,Ae,Pe,ze,qe,ht){return[Math.round(Pe*(be*ze-qe)),Math.round(Pe*(Ae*ze-ht))]}function Ke(be,Ae,Pe,ze,qe){for(var ht=Ae===qe.maxZoom?0:qe.tolerance/((1<<Ae)*qe.extent),at={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Pe,y:ze,z:Ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},nt=0;nt<be.length;nt++){at.numFeatures++,Mt(at,be[nt],ht,qe);var xt=be[nt].minX,Lt=be[nt].minY,bt=be[nt].maxX,St=be[nt].maxY;xt<at.minX&&(at.minX=xt),Lt<at.minY&&(at.minY=Lt),bt>at.maxX&&(at.maxX=bt),St>at.maxY&&(at.maxY=St)}return at}function Mt(be,Ae,Pe,ze){var qe=Ae.geometry,ht=Ae.type,at=[];if(ht==="Point"||ht==="MultiPoint")for(var nt=0;nt<qe.length;nt+=3)at.push(qe[nt]),at.push(qe[nt+1]),be.numPoints++,be.numSimplified++;else if(ht==="LineString")Jt(at,qe,be,Pe,!1,!1);else if(ht==="MultiLineString"||ht==="Polygon")for(nt=0;nt<qe.length;nt++)Jt(at,qe[nt],be,Pe,ht==="Polygon",nt===0);else if(ht==="MultiPolygon")for(var xt=0;xt<qe.length;xt++){var Lt=qe[xt];for(nt=0;nt<Lt.length;nt++)Jt(at,Lt[nt],be,Pe,!0,nt===0)}if(at.length){var bt=Ae.tags||null;if(ht==="LineString"&&ze.lineMetrics){for(var St in bt={},Ae.tags)bt[St]=Ae.tags[St];bt.mapbox_clip_start=qe.start/qe.size,bt.mapbox_clip_end=qe.end/qe.size}var st={geometry:at,type:ht==="Polygon"||ht==="MultiPolygon"?3:ht==="LineString"||ht==="MultiLineString"?2:1,tags:bt};Ae.id!==null&&(st.id=Ae.id),be.features.push(st)}}function Jt(be,Ae,Pe,ze,qe,ht){var at=ze*ze;if(ze>0&&Ae.size<(qe?at:ze))Pe.numPoints+=Ae.length/3;else{for(var nt=[],xt=0;xt<Ae.length;xt+=3)(ze===0||Ae[xt+2]>at)&&(Pe.numSimplified++,nt.push(Ae[xt]),nt.push(Ae[xt+1])),Pe.numPoints++;qe&&function(Lt,bt){for(var St=0,st=0,It=Lt.length,jt=It-2;st<It;jt=st,st+=2)St+=(Lt[st]-Lt[jt])*(Lt[st+1]+Lt[jt+1]);if(St>0===bt)for(st=0,It=Lt.length;st<It/2;st+=2){var Ut=Lt[st],zt=Lt[st+1];Lt[st]=Lt[It-2-st],Lt[st+1]=Lt[It-1-st],Lt[It-2-st]=Ut,Lt[It-1-st]=zt}}(nt,ht),be.push(nt)}}function $t(be,Ae){var Pe=(Ae=this.options=function(qe,ht){for(var at in ht)qe[at]=ht[at];return qe}(Object.create(this.options),Ae)).debug;if(Pe&&console.time("preprocess data"),Ae.maxZoom<0||Ae.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ae.promoteId&&Ae.generateId)throw new Error("promoteId and generateId cannot be used together.");var ze=function(qe,ht){var at=[];if(qe.type==="FeatureCollection")for(var nt=0;nt<qe.features.length;nt++)ge(at,qe.features[nt],ht,nt);else qe.type==="Feature"?ge(at,qe,ht):ge(at,{geometry:qe},ht);return at}(be,Ae);this.tiles={},this.tileCoords=[],Pe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ae.indexMaxZoom,Ae.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ze=function(qe,ht){var at=ht.buffer/ht.extent,nt=qe,xt=We(qe,1,-1-at,at,0,-1,2,ht),Lt=We(qe,1,1-at,2+at,0,-1,2,ht);return(xt||Lt)&&(nt=We(qe,1,-at,1+at,0,-1,2,ht)||[],xt&&(nt=ot(xt,1).concat(nt)),Lt&&(nt=nt.concat(ot(Lt,-1)))),nt}(ze,Ae)).length&&this.splitTile(ze,0,0,0),Pe&&(ze.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function je(be,Ae,Pe){return 32*((1<<be)*Pe+Ae)+be}function Ge(be,Ae){var Pe=be.tileID.canonical;if(!this._geoJSONIndex)return Ae(null,null);var ze=this._geoJSONIndex.getTile(Pe.z,Pe.x,Pe.y);if(!ze)return Ae(null,null);var qe=new k(ze.features),ht=w(qe);ht.byteOffset===0&&ht.byteLength===ht.buffer.byteLength||(ht=new Uint8Array(ht)),Ae(null,{vectorTile:qe,rawData:ht.buffer})}ne.prototype.load=function(be){var Ae=this.options,Pe=Ae.log,ze=Ae.minZoom,qe=Ae.maxZoom,ht=Ae.nodeSize;Pe&&console.time("total time");var at="prepare "+be.length+" points";Pe&&console.time(at),this.points=be;for(var nt=[],xt=0;xt<be.length;xt++)be[xt].geometry&&nt.push(ie(be[xt],xt));this.trees[qe+1]=new K(nt,Ee,Le,ht,Float32Array),Pe&&console.timeEnd(at);for(var Lt=qe;Lt>=ze;Lt--){var bt=+Date.now();nt=this._cluster(nt,Lt),this.trees[Lt]=new K(nt,Ee,Le,ht,Float32Array),Pe&&console.log("z%d: %d clusters in %dms",Lt,nt.length,+Date.now()-bt)}return Pe&&console.timeEnd("total time"),this},ne.prototype.getClusters=function(be,Ae){var Pe=((be[0]+180)%360+360)%360-180,ze=Math.max(-90,Math.min(90,be[1])),qe=be[2]===180?180:((be[2]+180)%360+360)%360-180,ht=Math.max(-90,Math.min(90,be[3]));if(be[2]-be[0]>=360)Pe=-180,qe=180;else if(Pe>qe){var at=this.getClusters([Pe,ze,180,ht],Ae),nt=this.getClusters([-180,ze,qe,ht],Ae);return at.concat(nt)}for(var xt=this.trees[this._limitZoom(Ae)],Lt=[],bt=0,St=xt.range(de(Pe),ce(ht),de(qe),ce(ze));bt<St.length;bt+=1){var st=St[bt],It=xt.points[st];Lt.push(It.numPoints?he(It):this.points[It.index])}return Lt},ne.prototype.getChildren=function(be){var Ae=this._getOriginId(be),Pe=this._getOriginZoom(be),ze="No cluster with the specified id.",qe=this.trees[Pe];if(!qe)throw new Error(ze);var ht=qe.points[Ae];if(!ht)throw new Error(ze);for(var at=this.options.radius/(this.options.extent*Math.pow(2,Pe-1)),nt=[],xt=0,Lt=qe.within(ht.x,ht.y,at);xt<Lt.length;xt+=1){var bt=Lt[xt],St=qe.points[bt];St.parentId===be&&nt.push(St.numPoints?he(St):this.points[St.index])}if(nt.length===0)throw new Error(ze);return nt},ne.prototype.getLeaves=function(be,Ae,Pe){Ae=Ae||10,Pe=Pe||0;var ze=[];return this._appendLeaves(ze,be,Ae,Pe,0),ze},ne.prototype.getTile=function(be,Ae,Pe){var ze=this.trees[this._limitZoom(be)],qe=Math.pow(2,be),ht=this.options,at=ht.extent,nt=ht.radius/at,xt=(Pe-nt)/qe,Lt=(Pe+1+nt)/qe,bt={features:[]};return this._addTileFeatures(ze.range((Ae-nt)/qe,xt,(Ae+1+nt)/qe,Lt),ze.points,Ae,Pe,qe,bt),Ae===0&&this._addTileFeatures(ze.range(1-nt/qe,xt,1,Lt),ze.points,qe,Pe,qe,bt),Ae===qe-1&&this._addTileFeatures(ze.range(0,xt,nt/qe,Lt),ze.points,-1,Pe,qe,bt),bt.features.length?bt:null},ne.prototype.getClusterExpansionZoom=function(be){for(var Ae=this._getOriginZoom(be)-1;Ae<=this.options.maxZoom;){var Pe=this.getChildren(be);if(Ae++,Pe.length!==1)break;be=Pe[0].properties.cluster_id}return Ae},ne.prototype._appendLeaves=function(be,Ae,Pe,ze,qe){for(var ht=0,at=this.getChildren(Ae);ht<at.length;ht+=1){var nt=at[ht],xt=nt.properties;if(xt&&xt.cluster?qe+xt.point_count<=ze?qe+=xt.point_count:qe=this._appendLeaves(be,xt.cluster_id,Pe,ze,qe):qe<ze?qe++:be.push(nt),be.length===Pe)break}return qe},ne.prototype._addTileFeatures=function(be,Ae,Pe,ze,qe,ht){for(var at=0,nt=be;at<nt.length;at+=1){var xt=Ae[nt[at]],Lt=xt.numPoints,bt={type:1,geometry:[[Math.round(this.options.extent*(xt.x*qe-Pe)),Math.round(this.options.extent*(xt.y*qe-ze))]],tags:Lt?se(xt):this.points[xt.index].properties},St=void 0;Lt?St=xt.id:this.options.generateId?St=xt.index:this.points[xt.index].id&&(St=this.points[xt.index].id),St!==void 0&&(bt.id=St),ht.features.push(bt)}},ne.prototype._limitZoom=function(be){return Math.max(this.options.minZoom,Math.min(be,this.options.maxZoom+1))},ne.prototype._cluster=function(be,Ae){for(var Pe=[],ze=this.options,qe=ze.radius,ht=ze.extent,at=ze.reduce,nt=qe/(ht*Math.pow(2,Ae)),xt=0;xt<be.length;xt++){var Lt=be[xt];if(!(Lt.zoom<=Ae)){Lt.zoom=Ae;for(var bt=this.trees[Ae+1],St=bt.within(Lt.x,Lt.y,nt),st=Lt.numPoints||1,It=Lt.x*st,jt=Lt.y*st,Ut=at&&st>1?this._map(Lt,!0):null,zt=(xt<<5)+(Ae+1)+this.points.length,Ce=0,lt=St;Ce<lt.length;Ce+=1){var At=lt[Ce],Bt=bt.points[At];if(!(Bt.zoom<=Ae)){Bt.zoom=Ae;var Ht=Bt.numPoints||1;It+=Bt.x*Ht,jt+=Bt.y*Ht,st+=Ht,Bt.parentId=zt,at&&(Ut||(Ut=this._map(Lt,!0)),at(Ut,this._map(Bt)))}}st===1?Pe.push(Lt):(Lt.parentId=zt,Pe.push(ae(It/st,jt/st,zt,st,Ut)))}}return Pe},ne.prototype._getOriginId=function(be){return be-this.points.length>>5},ne.prototype._getOriginZoom=function(be){return(be-this.points.length)%32},ne.prototype._map=function(be,Ae){if(be.numPoints)return Ae?ve({},be.properties):be.properties;var Pe=this.points[be.index].properties,ze=this.options.map(Pe);return Ae&&ze===Pe?ve({},ze):ze},$t.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$t.prototype.splitTile=function(be,Ae,Pe,ze,qe,ht,at){for(var nt=[be,Ae,Pe,ze],xt=this.options,Lt=xt.debug;nt.length;){ze=nt.pop(),Pe=nt.pop(),Ae=nt.pop(),be=nt.pop();var bt=1<<Ae,St=je(Ae,Pe,ze),st=this.tiles[St];if(!st&&(Lt>1&&console.time("creation"),st=this.tiles[St]=Ke(be,Ae,Pe,ze,xt),this.tileCoords.push({z:Ae,x:Pe,y:ze}),Lt)){Lt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ae,Pe,ze,st.numFeatures,st.numPoints,st.numSimplified),console.timeEnd("creation"));var It="z"+Ae;this.stats[It]=(this.stats[It]||0)+1,this.total++}if(st.source=be,qe){if(Ae===xt.maxZoom||Ae===qe)continue;var jt=1<<qe-Ae;if(Pe!==Math.floor(ht/jt)||ze!==Math.floor(at/jt))continue}else if(Ae===xt.indexMaxZoom||st.numPoints<=xt.indexMaxPoints)continue;if(st.source=null,be.length!==0){Lt>1&&console.time("clipping");var Ut,zt,Ce,lt,At,Bt,Ht=.5*xt.buffer/xt.extent,or=.5-Ht,ar=.5+Ht,Nt=1+Ht;Ut=zt=Ce=lt=null,At=We(be,bt,Pe-Ht,Pe+ar,0,st.minX,st.maxX,xt),Bt=We(be,bt,Pe+or,Pe+Nt,0,st.minX,st.maxX,xt),be=null,At&&(Ut=We(At,bt,ze-Ht,ze+ar,1,st.minY,st.maxY,xt),zt=We(At,bt,ze+or,ze+Nt,1,st.minY,st.maxY,xt),At=null),Bt&&(Ce=We(Bt,bt,ze-Ht,ze+ar,1,st.minY,st.maxY,xt),lt=We(Bt,bt,ze+or,ze+Nt,1,st.minY,st.maxY,xt),Bt=null),Lt>1&&console.timeEnd("clipping"),nt.push(Ut||[],Ae+1,2*Pe,2*ze),nt.push(zt||[],Ae+1,2*Pe,2*ze+1),nt.push(Ce||[],Ae+1,2*Pe+1,2*ze),nt.push(lt||[],Ae+1,2*Pe+1,2*ze+1)}}},$t.prototype.getTile=function(be,Ae,Pe){var ze=this.options,qe=ze.extent,ht=ze.debug;if(be<0||be>24)return null;var at=1<<be,nt=je(be,Ae=(Ae%at+at)%at,Pe);if(this.tiles[nt])return mt(this.tiles[nt],qe);ht>1&&console.log("drilling down to z%d-%d-%d",be,Ae,Pe);for(var xt,Lt=be,bt=Ae,St=Pe;!xt&&Lt>0;)Lt--,bt=Math.floor(bt/2),St=Math.floor(St/2),xt=this.tiles[je(Lt,bt,St)];return xt&&xt.source?(ht>1&&console.log("found parent tile z%d-%d-%d",Lt,bt,St),ht>1&&console.time("drilling down"),this.splitTile(xt.source,Lt,bt,St,be,Ae,Pe),ht>1&&console.timeEnd("drilling down"),this.tiles[nt]?mt(this.tiles[nt],qe):null):null};var Ct=function(be){function Ae(Pe,ze,qe,ht){be.call(this,Pe,ze,qe,Ge),ht&&(this.loadGeoJSON=ht)}return be&&(Ae.__proto__=be),Ae.prototype=Object.create(be&&be.prototype),Ae.prototype.constructor=Ae,Ae.prototype.loadData=function(Pe,ze){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=ze,this._pendingLoadDataParams=Pe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Ae.prototype._loadData=function(){var Pe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var ze=this._pendingCallback,qe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ht=!!(qe&&qe.request&&qe.request.collectResourceTiming)&&new e.RequestPerformance(qe.request);this.loadGeoJSON(qe,function(at,nt){if(at||!nt)return ze(at);if(typeof nt!="object")return ze(new Error("Input data given to '"+qe.source+"' is not a valid GeoJSON object."));m(nt,!0);try{Pe._geoJSONIndex=qe.cluster?new ne(function(bt){var St=bt.superclusterOptions,st=bt.clusterProperties;if(!st||!St)return St;for(var It={},jt={},Ut={accumulated:null,zoom:0},zt={properties:null},Ce=Object.keys(st),lt=0,At=Ce;lt<At.length;lt+=1){var Bt=At[lt],Ht=st[Bt],or=Ht[0],ar=Ht[1],Nt=e.createExpression(ar),nr=e.createExpression(typeof or=="string"?[or,["accumulated"],["get",Bt]]:or);It[Bt]=Nt.value,jt[Bt]=nr.value}return St.map=function(Lr){zt.properties=Lr;for(var dr={},Kt=0,yr=Ce;Kt<yr.length;Kt+=1){var xr=yr[Kt];dr[xr]=It[xr].evaluate(Ut,zt)}return dr},St.reduce=function(Lr,dr){zt.properties=dr;for(var Kt=0,yr=Ce;Kt<yr.length;Kt+=1){var xr=yr[Kt];Ut.accumulated=Lr[xr],Lr[xr]=jt[xr].evaluate(Ut,zt)}},St}(qe)).load(nt.features):function(bt,St){return new $t(bt,St)}(nt,qe.geojsonVtOptions)}catch(bt){return ze(bt)}Pe.loaded={};var xt={};if(ht){var Lt=ht.finish();Lt&&(xt.resourceTiming={},xt.resourceTiming[qe.source]=JSON.parse(JSON.stringify(Lt)))}ze(null,xt)})}},Ae.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Ae.prototype.reloadTile=function(Pe,ze){var qe=this.loaded,ht=Pe.uid;return qe&&qe[ht]?be.prototype.reloadTile.call(this,Pe,ze):this.loadTile(Pe,ze)},Ae.prototype.loadGeoJSON=function(Pe,ze){if(Pe.request)e.getJSON(Pe.request,ze);else{if(typeof Pe.data!="string")return ze(new Error("Input data given to '"+Pe.source+"' is not a valid GeoJSON object."));try{return ze(null,JSON.parse(Pe.data))}catch{return ze(new Error("Input data given to '"+Pe.source+"' is not a valid GeoJSON object."))}}},Ae.prototype.removeSource=function(Pe,ze){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ze()},Ae.prototype.getClusterExpansionZoom=function(Pe,ze){try{ze(null,this._geoJSONIndex.getClusterExpansionZoom(Pe.clusterId))}catch(qe){ze(qe)}},Ae.prototype.getClusterChildren=function(Pe,ze){try{ze(null,this._geoJSONIndex.getChildren(Pe.clusterId))}catch(qe){ze(qe)}},Ae.prototype.getClusterLeaves=function(Pe,ze){try{ze(null,this._geoJSONIndex.getLeaves(Pe.clusterId,Pe.limit,Pe.offset))}catch(qe){ze(qe)}},Ae}(f),Ie=function(be){var Ae=this;this.self=be,this.actor=new e.Actor(be,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:f,geojson:Ct},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Pe,ze){if(Ae.workerSourceTypes[Pe])throw new Error('Worker source with name "'+Pe+'" already registered.');Ae.workerSourceTypes[Pe]=ze},this.self.registerRTLTextPlugin=function(Pe){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=Pe.applyArabicShaping,e.plugin.processBidirectionalText=Pe.processBidirectionalText,e.plugin.processStyledBidirectionalText=Pe.processStyledBidirectionalText}};return Ie.prototype.setReferrer=function(be,Ae){this.referrer=Ae},Ie.prototype.setImages=function(be,Ae,Pe){for(var ze in this.availableImages[be]=Ae,this.workerSources[be]){var qe=this.workerSources[be][ze];for(var ht in qe)qe[ht].availableImages=Ae}Pe()},Ie.prototype.setLayers=function(be,Ae,Pe){this.getLayerIndex(be).replace(Ae),Pe()},Ie.prototype.updateLayers=function(be,Ae,Pe){this.getLayerIndex(be).update(Ae.layers,Ae.removedIds),Pe()},Ie.prototype.loadTile=function(be,Ae,Pe){this.getWorkerSource(be,Ae.type,Ae.source).loadTile(Ae,Pe)},Ie.prototype.loadDEMTile=function(be,Ae,Pe){this.getDEMWorkerSource(be,Ae.source).loadTile(Ae,Pe)},Ie.prototype.reloadTile=function(be,Ae,Pe){this.getWorkerSource(be,Ae.type,Ae.source).reloadTile(Ae,Pe)},Ie.prototype.abortTile=function(be,Ae,Pe){this.getWorkerSource(be,Ae.type,Ae.source).abortTile(Ae,Pe)},Ie.prototype.removeTile=function(be,Ae,Pe){this.getWorkerSource(be,Ae.type,Ae.source).removeTile(Ae,Pe)},Ie.prototype.removeDEMTile=function(be,Ae){this.getDEMWorkerSource(be,Ae.source).removeTile(Ae)},Ie.prototype.removeSource=function(be,Ae,Pe){if(this.workerSources[be]&&this.workerSources[be][Ae.type]&&this.workerSources[be][Ae.type][Ae.source]){var ze=this.workerSources[be][Ae.type][Ae.source];delete this.workerSources[be][Ae.type][Ae.source],ze.removeSource!==void 0?ze.removeSource(Ae,Pe):Pe()}},Ie.prototype.loadWorkerSource=function(be,Ae,Pe){try{this.self.importScripts(Ae.url),Pe()}catch(ze){Pe(ze.toString())}},Ie.prototype.syncRTLPluginState=function(be,Ae,Pe){try{e.plugin.setState(Ae);var ze=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&ze!=null){this.self.importScripts(ze);var qe=e.plugin.isParsed();Pe(qe?void 0:new Error("RTL Text Plugin failed to import scripts from "+ze),qe)}}catch(ht){Pe(ht.toString())}},Ie.prototype.getAvailableImages=function(be){var Ae=this.availableImages[be];return Ae||(Ae=[]),Ae},Ie.prototype.getLayerIndex=function(be){var Ae=this.layerIndexes[be];return Ae||(Ae=this.layerIndexes[be]=new a),Ae},Ie.prototype.getWorkerSource=function(be,Ae,Pe){var ze=this;if(this.workerSources[be]||(this.workerSources[be]={}),this.workerSources[be][Ae]||(this.workerSources[be][Ae]={}),!this.workerSources[be][Ae][Pe]){var qe={send:function(ht,at,nt){ze.actor.send(ht,at,nt,be)}};this.workerSources[be][Ae][Pe]=new this.workerSourceTypes[Ae](qe,this.getLayerIndex(be),this.getAvailableImages(be))}return this.workerSources[be][Ae][Pe]},Ie.prototype.getDEMWorkerSource=function(be,Ae){return this.demWorkerSources[be]||(this.demWorkerSources[be]={}),this.demWorkerSources[be][Ae]||(this.demWorkerSources[be][Ae]=new g),this.demWorkerSources[be][Ae]},Ie.prototype.enforceCacheSizeLimit=function(be,Ae){e.enforceCacheSizeLimit(Ae)},typeof WorkerGlobalScope<"u"&&e.window!==void 0&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Ie(e.window)),Ie}),u(0,function(e){var l=e.createCommonjsModule(function(M){function O(te){return!R(te)}function R(te){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var le,pe,ye=new Blob([""],{type:"text/javascript"}),_e=URL.createObjectURL(ye);try{pe=new Worker(_e),le=!0}catch{le=!1}return pe&&pe.terminate(),URL.revokeObjectURL(_e),le}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var le=document.createElement("canvas");le.width=le.height=1;var pe=le.getContext("2d");if(!pe)return!1;var ye=pe.getImageData(0,0,1,1);return ye&&ye.width===le.width}()?function(le){return j[le]===void 0&&(j[le]=function(pe){var ye=function(Ne){var He=document.createElement("canvas"),et=Object.create(O.webGLContextAttributes);return et.failIfMajorPerformanceCaveat=Ne,He.probablySupportsContext?He.probablySupportsContext("webgl",et)||He.probablySupportsContext("experimental-webgl",et):He.supportsContext?He.supportsContext("webgl",et)||He.supportsContext("experimental-webgl",et):He.getContext("webgl",et)||He.getContext("experimental-webgl",et)}(pe);if(!ye)return!1;var _e=ye.createShader(ye.VERTEX_SHADER);return!_e||ye.isContextLost()?!1:(ye.shaderSource(_e,"void main() {}"),ye.compileShader(_e),ye.getShaderParameter(_e,ye.COMPILE_STATUS)===!0)}(le)),j[le]}(te&&te.failIfMajorPerformanceCaveat)?void 0:"insufficient WebGL support":"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support"}M.exports?M.exports=O:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=O,window.mapboxgl.notSupportedReason=R);var j={};O.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),o={create:function(M,O,R){var j=e.window.document.createElement(M);return O!==void 0&&(j.className=O),R&&R.appendChild(j),j},createNS:function(M,O){return e.window.document.createElementNS(M,O)}},a=e.window.document.documentElement.style;function n(M){if(!a)return M[0];for(var O=0;O<M.length;O++)if(M[O]in a)return M[O];return M[0]}var s,r=n(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);o.disableDrag=function(){a&&r&&(s=a[r],a[r]="none")},o.enableDrag=function(){a&&r&&(a[r]=s)};var c=n(["transform","WebkitTransform"]);o.setTransform=function(M,O){M.style[c]=O};var f=!1;try{var d=Object.defineProperty({},"passive",{get:function(){f=!0}});e.window.addEventListener("test",d,d),e.window.removeEventListener("test",d,d)}catch{f=!1}o.addEventListener=function(M,O,R,j){j===void 0&&(j={}),"passive"in j&&f?M.addEventListener(O,R,j):M.addEventListener(O,R,j.capture)},o.removeEventListener=function(M,O,R,j){j===void 0&&(j={}),"passive"in j&&f?M.removeEventListener(O,R,j):M.removeEventListener(O,R,j.capture)};var g=function(M){M.preventDefault(),M.stopPropagation(),e.window.removeEventListener("click",g,!0)};function m(M){var O=M.userImage;return O&&O.render&&O.render()?(M.data.replace(new Uint8Array(O.data.buffer)),!0):!1}o.suppressClick=function(){e.window.addEventListener("click",g,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",g,!0)},0)},o.mousePos=function(M,O){var R=M.getBoundingClientRect();return new e.Point(O.clientX-R.left-M.clientLeft,O.clientY-R.top-M.clientTop)},o.touchPos=function(M,O){for(var R=M.getBoundingClientRect(),j=[],te=0;te<O.length;te++)j.push(new e.Point(O[te].clientX-R.left-M.clientLeft,O[te].clientY-R.top-M.clientTop));return j},o.mouseButton=function(M){return e.window.InstallTrigger!==void 0&&M.button===2&&M.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:M.button},o.remove=function(M){M.parentNode&&M.parentNode.removeChild(M)};var y=function(M){function O(){M.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.isLoaded=function(){return this.loaded},O.prototype.setLoaded=function(R){if(this.loaded!==R&&(this.loaded=R,R)){for(var j=0,te=this.requestors;j<te.length;j+=1){var le=te[j],pe=le.ids,ye=le.callback;this._notify(pe,ye)}this.requestors=[]}},O.prototype.getImage=function(R){return this.images[R]},O.prototype.addImage=function(R,j){this._validate(R,j)&&(this.images[R]=j)},O.prototype._validate=function(R,j){var te=!0;return this._validateStretch(j.stretchX,j.data&&j.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+R+'" has invalid "stretchX" value'))),te=!1),this._validateStretch(j.stretchY,j.data&&j.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+R+'" has invalid "stretchY" value'))),te=!1),this._validateContent(j.content,j)||(this.fire(new e.ErrorEvent(new Error('Image "'+R+'" has invalid "content" value'))),te=!1),te},O.prototype._validateStretch=function(R,j){if(!R)return!0;for(var te=0,le=0,pe=R;le<pe.length;le+=1){var ye=pe[le];if(ye[0]<te||ye[1]<ye[0]||j<ye[1])return!1;te=ye[1]}return!0},O.prototype._validateContent=function(R,j){return!R||R.length===4&&!(R[0]<0||j.data.width<R[0])&&!(R[1]<0||j.data.height<R[1])&&!(R[2]<0||j.data.width<R[2])&&!(R[3]<0||j.data.height<R[3])&&!(R[2]<R[0])&&!(R[3]<R[1])},O.prototype.updateImage=function(R,j){var te=this.images[R];j.version=te.version+1,this.images[R]=j,this.updatedImages[R]=!0},O.prototype.removeImage=function(R){var j=this.images[R];delete this.images[R],delete this.patterns[R],j.userImage&&j.userImage.onRemove&&j.userImage.onRemove()},O.prototype.listImages=function(){return Object.keys(this.images)},O.prototype.getImages=function(R,j){var te=!0;if(!this.isLoaded())for(var le=0,pe=R;le<pe.length;le+=1){var ye=pe[le];this.images[ye]||(te=!1)}this.isLoaded()||te?this._notify(R,j):this.requestors.push({ids:R,callback:j})},O.prototype._notify=function(R,j){for(var te={},le=0,pe=R;le<pe.length;le+=1){var ye=pe[le];this.images[ye]||this.fire(new e.Event("styleimagemissing",{id:ye}));var _e=this.images[ye];_e?te[ye]={data:_e.data.clone(),pixelRatio:_e.pixelRatio,sdf:_e.sdf,version:_e.version,stretchX:_e.stretchX,stretchY:_e.stretchY,content:_e.content,hasRenderCallback:!!(_e.userImage&&_e.userImage.render)}:e.warnOnce('Image "'+ye+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}j(null,te)},O.prototype.getPixelSize=function(){var R=this.atlasImage;return{width:R.width,height:R.height}},O.prototype.getPattern=function(R){var j=this.patterns[R],te=this.getImage(R);if(!te)return null;if(j&&j.position.version===te.version)return j.position;if(j)j.position.version=te.version;else{var le={w:te.data.width+2,h:te.data.height+2,x:0,y:0},pe=new e.ImagePosition(le,te);this.patterns[R]={bin:le,position:pe}}return this._updatePatternAtlas(),this.patterns[R].position},O.prototype.bind=function(R){var j=R.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(R,this.atlasImage,j.RGBA),this.atlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE)},O.prototype._updatePatternAtlas=function(){var R=[];for(var j in this.patterns)R.push(this.patterns[j].bin);var te=e.potpack(R),le=te.w,pe=te.h,ye=this.atlasImage;for(var _e in ye.resize({width:le||1,height:pe||1}),this.patterns){var Ne=this.patterns[_e].bin,He=Ne.x+1,et=Ne.y+1,yt=this.images[_e].data,kt=yt.width,_t=yt.height;e.RGBAImage.copy(yt,ye,{x:0,y:0},{x:He,y:et},{width:kt,height:_t}),e.RGBAImage.copy(yt,ye,{x:0,y:_t-1},{x:He,y:et-1},{width:kt,height:1}),e.RGBAImage.copy(yt,ye,{x:0,y:0},{x:He,y:et+_t},{width:kt,height:1}),e.RGBAImage.copy(yt,ye,{x:kt-1,y:0},{x:He-1,y:et},{width:1,height:_t}),e.RGBAImage.copy(yt,ye,{x:0,y:0},{x:He+kt,y:et},{width:1,height:_t})}this.dirty=!0},O.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},O.prototype.dispatchRenderCallbacks=function(R){for(var j=0,te=R;j<te.length;j+=1){var le=te[j];if(!this.callbackDispatchedThisFrame[le]){this.callbackDispatchedThisFrame[le]=!0;var pe=this.images[le];m(pe)&&this.updateImage(le,pe)}}},O}(e.Evented),v=k,T=k,_=1e20;function k(M,O,R,j,te,le){this.fontSize=M||24,this.buffer=O===void 0?3:O,this.cutoff=j||.25,this.fontFamily=te||"sans-serif",this.fontWeight=le||"normal",this.radius=R||8;var pe=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=pe,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(pe*pe),this.gridInner=new Float64Array(pe*pe),this.f=new Float64Array(pe),this.d=new Float64Array(pe),this.z=new Float64Array(pe+1),this.v=new Int16Array(pe),this.middle=Math.round(pe/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function E(M,O,R,j,te,le,pe){for(var ye=0;ye<O;ye++){for(var _e=0;_e<R;_e++)j[_e]=M[_e*O+ye];for(A(j,te,le,pe,R),_e=0;_e<R;_e++)M[_e*O+ye]=te[_e]}for(_e=0;_e<R;_e++){for(ye=0;ye<O;ye++)j[ye]=M[_e*O+ye];for(A(j,te,le,pe,O),ye=0;ye<O;ye++)M[_e*O+ye]=Math.sqrt(te[ye])}}function A(M,O,R,j,te){R[0]=0,j[0]=-_,j[1]=+_;for(var le=1,pe=0;le<te;le++){for(var ye=(M[le]+le*le-(M[R[pe]]+R[pe]*R[pe]))/(2*le-2*R[pe]);ye<=j[pe];)pe--,ye=(M[le]+le*le-(M[R[pe]]+R[pe]*R[pe]))/(2*le-2*R[pe]);R[++pe]=le,j[pe]=ye,j[pe+1]=+_}for(le=0,pe=0;le<te;le++){for(;j[pe+1]<le;)pe++;O[le]=(le-R[pe])*(le-R[pe])+M[R[pe]]}}k.prototype.draw=function(M){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(M,this.buffer,this.middle);for(var O=this.ctx.getImageData(0,0,this.size,this.size),R=new Uint8ClampedArray(this.size*this.size),j=0;j<this.size*this.size;j++){var te=O.data[4*j+3]/255;this.gridOuter[j]=te===1?0:te===0?_:Math.pow(Math.max(0,.5-te),2),this.gridInner[j]=te===1?_:te===0?0:Math.pow(Math.max(0,te-.5),2)}for(E(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),E(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),j=0;j<this.size*this.size;j++){var le=this.gridOuter[j]-this.gridInner[j];R[j]=Math.max(0,Math.min(255,Math.round(255-255*(le/this.radius+this.cutoff))))}return R},v.default=T;var b=function(M,O){this.requestManager=M,this.localIdeographFontFamily=O,this.entries={}};b.prototype.setURL=function(M){this.url=M},b.prototype.getGlyphs=function(M,O){var R=this,j=[];for(var te in M)for(var le=0,pe=M[te];le<pe.length;le+=1){var ye=pe[le];j.push({stack:te,id:ye})}e.asyncAll(j,function(_e,Ne){var He=_e.stack,et=_e.id,yt=R.entries[He];yt||(yt=R.entries[He]={glyphs:{},requests:{},ranges:{}});var kt=yt.glyphs[et];if(kt===void 0){if(kt=R._tinySDF(yt,He,et))return yt.glyphs[et]=kt,void Ne(null,{stack:He,id:et,glyph:kt});var _t=Math.floor(et/256);if(256*_t>65535)Ne(new Error("glyphs > 65535 not supported"));else if(yt.ranges[_t])Ne(null,{stack:He,id:et,glyph:kt});else{var wt=yt.requests[_t];wt||(wt=yt.requests[_t]=[],b.loadGlyphRange(He,_t,R.url,R.requestManager,function(vt,Dt){if(Dt){for(var Pt in Dt)R._doesCharSupportLocalGlyph(+Pt)||(yt.glyphs[+Pt]=Dt[+Pt]);yt.ranges[_t]=!0}for(var Ft=0,er=wt;Ft<er.length;Ft+=1)(0,er[Ft])(vt,Dt);delete yt.requests[_t]})),wt.push(function(vt,Dt){vt?Ne(vt):Dt&&Ne(null,{stack:He,id:et,glyph:Dt[et]||null})})}}else Ne(null,{stack:He,id:et,glyph:kt})},function(_e,Ne){if(_e)O(_e);else if(Ne){for(var He={},et=0,yt=Ne;et<yt.length;et+=1){var kt=yt[et],_t=kt.stack,wt=kt.id,vt=kt.glyph;(He[_t]||(He[_t]={}))[wt]=vt&&{id:vt.id,bitmap:vt.bitmap.clone(),metrics:vt.metrics}}O(null,He)}})},b.prototype._doesCharSupportLocalGlyph=function(M){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](M)||e.isChar["Hangul Syllables"](M)||e.isChar.Hiragana(M)||e.isChar.Katakana(M))},b.prototype._tinySDF=function(M,O,R){var j=this.localIdeographFontFamily;if(j&&this._doesCharSupportLocalGlyph(R)){var te=M.tinySDF;if(!te){var le="400";/bold/i.test(O)?le="900":/medium/i.test(O)?le="500":/light/i.test(O)&&(le="200"),te=M.tinySDF=new b.TinySDF(24,3,8,.25,j,le)}return{id:R,bitmap:new e.AlphaImage({width:30,height:30},te.draw(String.fromCharCode(R))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},b.loadGlyphRange=function(M,O,R,j,te){var le=256*O,pe=le+255,ye=j.transformRequest(j.normalizeGlyphsURL(R).replace("{fontstack}",M).replace("{range}",le+"-"+pe),e.ResourceType.Glyphs);e.getArrayBuffer(ye,function(_e,Ne){if(_e)te(_e);else if(Ne){for(var He={},et=0,yt=e.parseGlyphPBF(Ne);et<yt.length;et+=1){var kt=yt[et];He[kt.id]=kt}te(null,He)}})},b.TinySDF=v;var L=function(){this.specification=e.styleSpec.light.position};L.prototype.possiblyEvaluate=function(M,O){return e.sphericalToCartesian(M.expression.evaluate(O))},L.prototype.interpolate=function(M,O,R){return{x:e.number(M.x,O.x,R),y:e.number(M.y,O.y,R),z:e.number(M.z,O.z,R)}};var w=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new L,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),C=function(M){function O(R){M.call(this),this._transitionable=new e.Transitionable(w),this.setLight(R),this._transitioning=this._transitionable.untransitioned()}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getLight=function(){return this._transitionable.serialize()},O.prototype.setLight=function(R,j){if(j===void 0&&(j={}),!this._validate(e.validateLight,R,j))for(var te in R){var le=R[te];e.endsWith(te,"-transition")?this._transitionable.setTransition(te.slice(0,-11),le):this._transitionable.setValue(te,le)}},O.prototype.updateTransitions=function(R){this._transitioning=this._transitionable.transitioned(R,this._transitioning)},O.prototype.hasTransition=function(){return this._transitioning.hasTransition()},O.prototype.recalculate=function(R){this.properties=this._transitioning.possiblyEvaluate(R)},O.prototype._validate=function(R,j,te){return(!te||te.validate!==!1)&&e.emitValidationErrors(this,R.call(e.validateStyle,e.extend({value:j,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},O}(e.Evented),S=function(M,O){this.width=M,this.height=O,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};S.prototype.getDash=function(M,O){var R=M.join(",")+String(O);return this.dashEntry[R]||(this.dashEntry[R]=this.addDash(M,O)),this.dashEntry[R]},S.prototype.getDashRanges=function(M,O,R){var j=[],te=M.length%2==1?-M[M.length-1]*R:0,le=M[0]*R,pe=!0;j.push({left:te,right:le,isDash:pe,zeroLength:M[0]===0});for(var ye=M[0],_e=1;_e<M.length;_e++){pe=!pe;var Ne=M[_e];te=ye*R,le=(ye+=Ne)*R,j.push({left:te,right:le,isDash:pe,zeroLength:Ne===0})}return j},S.prototype.addRoundDash=function(M,O,R){for(var j=O/2,te=-R;te<=R;te++)for(var le=this.nextRow+R+te,pe=this.width*le,ye=0,_e=M[ye],Ne=0;Ne<this.width;Ne++){Ne/_e.right>1&&(_e=M[++ye]);var He=Math.abs(Ne-_e.left),et=Math.abs(Ne-_e.right),yt=Math.min(He,et),kt=void 0,_t=te/R*(j+1);if(_e.isDash){var wt=j-Math.abs(_t);kt=Math.sqrt(yt*yt+wt*wt)}else kt=j-Math.sqrt(yt*yt+_t*_t);this.data[pe+Ne]=Math.max(0,Math.min(255,kt+128))}},S.prototype.addRegularDash=function(M){for(var O=M.length-1;O>=0;--O){var R=M[O],j=M[O+1];R.zeroLength?M.splice(O,1):j&&j.isDash===R.isDash&&(j.left=R.left,M.splice(O,1))}var te=M[0],le=M[M.length-1];te.isDash===le.isDash&&(te.left=le.left-this.width,le.right=te.right+this.width);for(var pe=this.width*this.nextRow,ye=0,_e=M[ye],Ne=0;Ne<this.width;Ne++){Ne/_e.right>1&&(_e=M[++ye]);var He=Math.abs(Ne-_e.left),et=Math.abs(Ne-_e.right),yt=Math.min(He,et),kt=_e.isDash?yt:-yt;this.data[pe+Ne]=Math.max(0,Math.min(255,kt+128))}},S.prototype.addDash=function(M,O){var R=O?7:0,j=2*R+1;if(this.nextRow+j>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var te=0,le=0;le<M.length;le++)te+=M[le];if(te!==0){var pe=this.width/te,ye=this.getDashRanges(M,this.width,pe);O?this.addRoundDash(ye,pe,R):this.addRegularDash(ye)}var _e={y:(this.nextRow+R+.5)/this.height,height:2*R/this.height,width:te};return this.nextRow+=j,this.dirty=!0,_e},S.prototype.bind=function(M){var O=M.gl;this.texture?(O.bindTexture(O.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,O.texSubImage2D(O.TEXTURE_2D,0,0,0,this.width,this.height,O.ALPHA,O.UNSIGNED_BYTE,this.data))):(this.texture=O.createTexture(),O.bindTexture(O.TEXTURE_2D,this.texture),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_S,O.REPEAT),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_T,O.REPEAT),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,O.LINEAR),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,O.LINEAR),O.texImage2D(O.TEXTURE_2D,0,O.ALPHA,this.width,this.height,0,O.ALPHA,O.UNSIGNED_BYTE,this.data))};var P=function M(O,R){this.workerPool=O,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var j=this.workerPool.acquire(this.id),te=0;te<j.length;te++){var le=j[te],pe=new M.Actor(le,R,this.id);pe.name="Worker "+te,this.actors.push(pe)}};function z(M,O,R){var j=function(te,le){if(te)return R(te);if(le){var pe=e.pick(e.extend(le,M),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);le.vector_layers&&(pe.vectorLayers=le.vector_layers,pe.vectorLayerIds=pe.vectorLayers.map(function(ye){return ye.id})),pe.tiles=O.canonicalizeTileset(pe,M.url),R(null,pe)}};return M.url?e.getJSON(O.transformRequest(O.normalizeSourceURL(M.url),e.ResourceType.Source),j):e.browser.frame(function(){return j(null,M)})}P.prototype.broadcast=function(M,O,R){R=R||function(){},e.asyncAll(this.actors,function(j,te){j.send(M,O,te)},R)},P.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},P.prototype.remove=function(){this.actors.forEach(function(M){M.remove()}),this.actors=[],this.workerPool.release(this.id)},P.Actor=e.Actor;var F=function(M,O,R){this.bounds=e.LngLatBounds.convert(this.validateBounds(M)),this.minzoom=O||0,this.maxzoom=R||24};F.prototype.validateBounds=function(M){return Array.isArray(M)&&M.length===4?[Math.max(-180,M[0]),Math.max(-90,M[1]),Math.min(180,M[2]),Math.min(90,M[3])]:[-180,-90,180,90]},F.prototype.contains=function(M){var O=Math.pow(2,M.z),R=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*O),j=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*O),te=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*O),le=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*O);return M.x>=R&&M.x<te&&M.y>=j&&M.y<le};var q=function(M){function O(R,j,te,le){if(M.call(this),this.id=R,this.dispatcher=te,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(j,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},j),this._collectResourceTiming=j.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(le)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.load=function(){var R=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=z(this._options,this.map._requestManager,function(j,te){R._tileJSONRequest=null,R._loaded=!0,j?R.fire(new e.ErrorEvent(j)):te&&(e.extend(R,te),te.bounds&&(R.tileBounds=new F(te.bounds,R.minzoom,R.maxzoom)),e.postTurnstileEvent(te.tiles,R.map._requestManager._customAccessToken),e.postMapLoadEvent(te.tiles,R.map._getMapId(),R.map._requestManager._skuToken,R.map._requestManager._customAccessToken),R.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),R.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},O.prototype.loaded=function(){return this._loaded},O.prototype.hasTile=function(R){return!this.tileBounds||this.tileBounds.contains(R.canonical)},O.prototype.onAdd=function(R){this.map=R,this.load()},O.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},O.prototype.serialize=function(){return e.extend({},this._options)},O.prototype.loadTile=function(R,j){var te=this.map._requestManager.normalizeTileURL(R.tileID.canonical.url(this.tiles,this.scheme)),le={request:this.map._requestManager.transformRequest(te,e.ResourceType.Tile),uid:R.uid,tileID:R.tileID,zoom:R.tileID.overscaledZ,tileSize:this.tileSize*R.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function pe(ye,_e){return delete R.request,R.aborted?j(null):ye&&ye.status!==404?j(ye):(_e&&_e.resourceTiming&&(R.resourceTiming=_e.resourceTiming),this.map._refreshExpiredTiles&&_e&&R.setExpiryData(_e),R.loadVectorData(_e,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),j(null),void(R.reloadCallback&&(this.loadTile(R,R.reloadCallback),R.reloadCallback=null)))}le.request.collectResourceTiming=this._collectResourceTiming,R.actor&&R.state!=="expired"?R.state==="loading"?R.reloadCallback=j:R.request=R.actor.send("reloadTile",le,pe.bind(this)):(R.actor=this.dispatcher.getActor(),R.request=R.actor.send("loadTile",le,pe.bind(this)))},O.prototype.abortTile=function(R){R.request&&(R.request.cancel(),delete R.request),R.actor&&R.actor.send("abortTile",{uid:R.uid,type:this.type,source:this.id},void 0)},O.prototype.unloadTile=function(R){R.unloadVectorData(),R.actor&&R.actor.send("removeTile",{uid:R.uid,type:this.type,source:this.id},void 0)},O.prototype.hasTransition=function(){return!1},O}(e.Evented),W=function(M){function O(R,j,te,le){M.call(this),this.id=R,this.dispatcher=te,this.setEventedParent(le),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},j),e.extend(this,e.pick(j,["url","scheme","tileSize"]))}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.load=function(){var R=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=z(this._options,this.map._requestManager,function(j,te){R._tileJSONRequest=null,R._loaded=!0,j?R.fire(new e.ErrorEvent(j)):te&&(e.extend(R,te),te.bounds&&(R.tileBounds=new F(te.bounds,R.minzoom,R.maxzoom)),e.postTurnstileEvent(te.tiles),e.postMapLoadEvent(te.tiles,R.map._getMapId(),R.map._requestManager._skuToken),R.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),R.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},O.prototype.loaded=function(){return this._loaded},O.prototype.onAdd=function(R){this.map=R,this.load()},O.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},O.prototype.serialize=function(){return e.extend({},this._options)},O.prototype.hasTile=function(R){return!this.tileBounds||this.tileBounds.contains(R.canonical)},O.prototype.loadTile=function(R,j){var te=this,le=this.map._requestManager.normalizeTileURL(R.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);R.request=e.getImage(this.map._requestManager.transformRequest(le,e.ResourceType.Tile),function(pe,ye){if(delete R.request,R.aborted)R.state="unloaded",j(null);else if(pe)R.state="errored",j(pe);else if(ye){te.map._refreshExpiredTiles&&R.setExpiryData(ye),delete ye.cacheControl,delete ye.expires;var _e=te.map.painter.context,Ne=_e.gl;R.texture=te.map.painter.getTileTexture(ye.width),R.texture?R.texture.update(ye,{useMipmap:!0}):(R.texture=new e.Texture(_e,ye,Ne.RGBA,{useMipmap:!0}),R.texture.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE,Ne.LINEAR_MIPMAP_NEAREST),_e.extTextureFilterAnisotropic&&Ne.texParameterf(Ne.TEXTURE_2D,_e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,_e.extTextureFilterAnisotropicMax)),R.state="loaded",e.cacheEntryPossiblyAdded(te.dispatcher),j(null)}})},O.prototype.abortTile=function(R,j){R.request&&(R.request.cancel(),delete R.request),j()},O.prototype.unloadTile=function(R,j){R.texture&&this.map.painter.saveTileTexture(R.texture),j()},O.prototype.hasTransition=function(){return!1},O}(e.Evented),X=function(M){function O(R,j,te,le){M.call(this,R,j,te,le),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},j),this.encoding=j.encoding||"mapbox"}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},O.prototype.loadTile=function(R,j){var te=this.map._requestManager.normalizeTileURL(R.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function le(pe,ye){pe&&(R.state="errored",j(pe)),ye&&(R.dem=ye,R.needsHillshadePrepare=!0,R.state="loaded",j(null))}R.request=e.getImage(this.map._requestManager.transformRequest(te,e.ResourceType.Tile),(function(pe,ye){if(delete R.request,R.aborted)R.state="unloaded",j(null);else if(pe)R.state="errored",j(pe);else if(ye){this.map._refreshExpiredTiles&&R.setExpiryData(ye),delete ye.cacheControl,delete ye.expires;var _e=e.window.ImageBitmap&&ye instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?ye:e.browser.getImageData(ye,1),Ne={uid:R.uid,coord:R.tileID,source:this.id,rawImageData:_e,encoding:this.encoding};R.actor&&R.state!=="expired"||(R.actor=this.dispatcher.getActor(),R.actor.send("loadDEMTile",Ne,le.bind(this)))}}).bind(this)),R.neighboringTiles=this._getNeighboringTiles(R.tileID)},O.prototype._getNeighboringTiles=function(R){var j=R.canonical,te=Math.pow(2,j.z),le=(j.x-1+te)%te,pe=j.x===0?R.wrap-1:R.wrap,ye=(j.x+1+te)%te,_e=j.x+1===te?R.wrap+1:R.wrap,Ne={};return Ne[new e.OverscaledTileID(R.overscaledZ,pe,j.z,le,j.y).key]={backfilled:!1},Ne[new e.OverscaledTileID(R.overscaledZ,_e,j.z,ye,j.y).key]={backfilled:!1},j.y>0&&(Ne[new e.OverscaledTileID(R.overscaledZ,pe,j.z,le,j.y-1).key]={backfilled:!1},Ne[new e.OverscaledTileID(R.overscaledZ,R.wrap,j.z,j.x,j.y-1).key]={backfilled:!1},Ne[new e.OverscaledTileID(R.overscaledZ,_e,j.z,ye,j.y-1).key]={backfilled:!1}),j.y+1<te&&(Ne[new e.OverscaledTileID(R.overscaledZ,pe,j.z,le,j.y+1).key]={backfilled:!1},Ne[new e.OverscaledTileID(R.overscaledZ,R.wrap,j.z,j.x,j.y+1).key]={backfilled:!1},Ne[new e.OverscaledTileID(R.overscaledZ,_e,j.z,ye,j.y+1).key]={backfilled:!1}),Ne},O.prototype.unloadTile=function(R){R.demTexture&&this.map.painter.saveTileTexture(R.demTexture),R.fbo&&(R.fbo.destroy(),delete R.fbo),R.dem&&delete R.dem,delete R.neighboringTiles,R.state="unloaded",R.actor&&R.actor.send("removeDEMTile",{uid:R.uid,source:this.id})},O}(W),Q=function(M){function O(R,j,te,le){M.call(this),this.id=R,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=te.getActor(),this.setEventedParent(le),this._data=j.data,this._options=e.extend({},j),this._collectResourceTiming=j.collectResourceTiming,this._resourceTiming=[],j.maxzoom!==void 0&&(this.maxzoom=j.maxzoom),j.type&&(this.type=j.type),j.attribution&&(this.attribution=j.attribution),this.promoteId=j.promoteId;var pe=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:j.cluster||!1,geojsonVtOptions:{buffer:(j.buffer!==void 0?j.buffer:128)*pe,tolerance:(j.tolerance!==void 0?j.tolerance:.375)*pe,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:j.lineMetrics||!1,generateId:j.generateId||!1},superclusterOptions:{maxZoom:j.clusterMaxZoom!==void 0?Math.min(j.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(j.clusterRadius||50)*pe,log:!1,generateId:j.generateId||!1},clusterProperties:j.clusterProperties},j.workerOptions)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.load=function(){var R=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(j){if(j)R.fire(new e.ErrorEvent(j));else{var te={dataType:"source",sourceDataType:"metadata"};R._collectResourceTiming&&R._resourceTiming&&R._resourceTiming.length>0&&(te.resourceTiming=R._resourceTiming,R._resourceTiming=[]),R.fire(new e.Event("data",te))}})},O.prototype.onAdd=function(R){this.map=R,this.load()},O.prototype.setData=function(R){var j=this;return this._data=R,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(te){if(te)j.fire(new e.ErrorEvent(te));else{var le={dataType:"source",sourceDataType:"content"};j._collectResourceTiming&&j._resourceTiming&&j._resourceTiming.length>0&&(le.resourceTiming=j._resourceTiming,j._resourceTiming=[]),j.fire(new e.Event("data",le))}}),this},O.prototype.getClusterExpansionZoom=function(R,j){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:R,source:this.id},j),this},O.prototype.getClusterChildren=function(R,j){return this.actor.send("geojson.getClusterChildren",{clusterId:R,source:this.id},j),this},O.prototype.getClusterLeaves=function(R,j,te,le){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:R,limit:j,offset:te},le),this},O.prototype._updateWorkerData=function(R){var j=this;this._loaded=!1;var te=e.extend({},this.workerOptions),le=this._data;typeof le=="string"?(te.request=this.map._requestManager.transformRequest(e.browser.resolveURL(le),e.ResourceType.Source),te.request.collectResourceTiming=this._collectResourceTiming):te.data=JSON.stringify(le),this.actor.send(this.type+".loadData",te,function(pe,ye){j._removed||ye&&ye.abandoned||(j._loaded=!0,ye&&ye.resourceTiming&&ye.resourceTiming[j.id]&&(j._resourceTiming=ye.resourceTiming[j.id].slice(0)),j.actor.send(j.type+".coalesce",{source:te.source},null),R(pe))})},O.prototype.loaded=function(){return this._loaded},O.prototype.loadTile=function(R,j){var te=this,le=R.actor?"reloadTile":"loadTile";R.actor=this.actor;var pe={type:this.type,uid:R.uid,tileID:R.tileID,zoom:R.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};R.request=this.actor.send(le,pe,function(ye,_e){return delete R.request,R.unloadVectorData(),R.aborted?j(null):ye?j(ye):(R.loadVectorData(_e,te.map.painter,le==="reloadTile"),j(null))})},O.prototype.abortTile=function(R){R.request&&(R.request.cancel(),delete R.request),R.aborted=!0},O.prototype.unloadTile=function(R){R.unloadVectorData(),this.actor.send("removeTile",{uid:R.uid,type:this.type,source:this.id})},O.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},O.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},O.prototype.hasTransition=function(){return!1},O}(e.Evented),Z=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Y=function(M){function O(R,j,te,le){M.call(this),this.id=R,this.dispatcher=te,this.coordinates=j.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(le),this.options=j}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.load=function(R,j){var te=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(le,pe){te._loaded=!0,le?te.fire(new e.ErrorEvent(le)):pe&&(te.image=pe,R&&(te.coordinates=R),j&&j(),te._finishLoading())})},O.prototype.loaded=function(){return this._loaded},O.prototype.updateImage=function(R){var j=this;return this.image&&R.url?(this.options.url=R.url,this.load(R.coordinates,function(){j.texture=null}),this):this},O.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},O.prototype.onAdd=function(R){this.map=R,this.load()},O.prototype.setCoordinates=function(R){var j=this;this.coordinates=R;var te=R.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(pe){for(var ye=1/0,_e=1/0,Ne=-1/0,He=-1/0,et=0,yt=pe;et<yt.length;et+=1){var kt=yt[et];ye=Math.min(ye,kt.x),_e=Math.min(_e,kt.y),Ne=Math.max(Ne,kt.x),He=Math.max(He,kt.y)}var _t=Ne-ye,wt=He-_e,vt=Math.max(_t,wt),Dt=Math.max(0,Math.floor(-Math.log(vt)/Math.LN2)),Pt=Math.pow(2,Dt);return new e.CanonicalTileID(Dt,Math.floor((ye+Ne)/2*Pt),Math.floor((_e+He)/2*Pt))}(te),this.minzoom=this.maxzoom=this.tileID.z;var le=te.map(function(pe){return j.tileID.getTilePoint(pe)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(le[0].x,le[0].y,0,0),this._boundsArray.emplaceBack(le[1].x,le[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(le[3].x,le[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(le[2].x,le[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},O.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var R=this.map.painter.context,j=R.gl;for(var te in this.boundsBuffer||(this.boundsBuffer=R.createVertexBuffer(this._boundsArray,Z.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(R,this.image,j.RGBA),this.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE)),this.tiles){var le=this.tiles[te];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}}},O.prototype.loadTile=function(R,j){this.tileID&&this.tileID.equals(R.tileID.canonical)?(this.tiles[String(R.tileID.wrap)]=R,R.buckets={},j(null)):(R.state="errored",j(null))},O.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},O.prototype.hasTransition=function(){return!1},O}(e.Evented),N=function(M){function O(R,j,te,le){M.call(this,R,j,te,le),this.roundZoom=!0,this.type="video",this.options=j}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.load=function(){var R=this;this._loaded=!1;var j=this.options;this.urls=[];for(var te=0,le=j.urls;te<le.length;te+=1){var pe=le[te];this.urls.push(this.map._requestManager.transformRequest(pe,e.ResourceType.Source).url)}e.getVideo(this.urls,function(ye,_e){R._loaded=!0,ye?R.fire(new e.ErrorEvent(ye)):_e&&(R.video=_e,R.video.loop=!0,R.video.addEventListener("playing",function(){R.map.triggerRepaint()}),R.map&&R.video.play(),R._finishLoading())})},O.prototype.pause=function(){this.video&&this.video.pause()},O.prototype.play=function(){this.video&&this.video.play()},O.prototype.seek=function(R){if(this.video){var j=this.video.seekable;R<j.start(0)||R>j.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+j.start(0)+" and "+j.end(0)+"-second mark."))):this.video.currentTime=R}},O.prototype.getVideo=function(){return this.video},O.prototype.onAdd=function(R){this.map||(this.map=R,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},O.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var R=this.map.painter.context,j=R.gl;for(var te in this.boundsBuffer||(this.boundsBuffer=R.createVertexBuffer(this._boundsArray,Z.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE),j.texSubImage2D(j.TEXTURE_2D,0,0,0,j.RGBA,j.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(R,this.video,j.RGBA),this.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE)),this.tiles){var le=this.tiles[te];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}}},O.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},O.prototype.hasTransition=function(){return this.video&&!this.video.paused},O}(Y),J=function(M){function O(R,j,te,le){M.call(this,R,j,te,le),j.coordinates?Array.isArray(j.coordinates)&&j.coordinates.length===4&&!j.coordinates.some(function(pe){return!Array.isArray(pe)||pe.length!==2||pe.some(function(ye){return typeof ye!="number"})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+R,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+R,null,'missing required property "coordinates"'))),j.animate&&typeof j.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+R,null,'optional "animate" property must be a boolean value'))),j.canvas?typeof j.canvas=="string"||j.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+R,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+R,null,'missing required property "canvas"'))),this.options=j,this.animate=j.animate===void 0||j.animate}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},O.prototype.getCanvas=function(){return this.canvas},O.prototype.onAdd=function(R){this.map=R,this.load(),this.canvas&&this.animate&&this.play()},O.prototype.onRemove=function(){this.pause()},O.prototype.prepare=function(){var R=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,R=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,R=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var j=this.map.painter.context,te=j.gl;for(var le in this.boundsBuffer||(this.boundsBuffer=j.createVertexBuffer(this._boundsArray,Z.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(R||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(j,this.canvas,te.RGBA,{premultiply:!0}),this.tiles){var pe=this.tiles[le];pe.state!=="loaded"&&(pe.state="loaded",pe.texture=this.texture)}}},O.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},O.prototype.hasTransition=function(){return this._playing},O.prototype._hasInvalidDimensions=function(){for(var R=0,j=[this.canvas.width,this.canvas.height];R<j.length;R+=1){var te=j[R];if(isNaN(te)||te<=0)return!0}return!1},O}(Y),D={vector:q,raster:W,"raster-dem":X,geojson:Q,video:N,image:Y,canvas:J};function U(M,O){var R=e.identity([]);return e.translate(R,R,[1,1,0]),e.scale(R,R,[.5*M.width,.5*M.height,1]),e.multiply(R,R,M.calculatePosMatrix(O.toUnwrapped()))}function G(M,O,R,j,te,le){var pe=function(wt,vt,Dt){if(wt)for(var Pt=0,Ft=wt;Pt<Ft.length;Pt+=1){var er=vt[Ft[Pt]];if(er&&er.source===Dt&&er.type==="fill-extrusion")return!0}else for(var cr in vt){var Ar=vt[cr];if(Ar.source===Dt&&Ar.type==="fill-extrusion")return!0}return!1}(te&&te.layers,O,M.id),ye=le.maxPitchScaleFactor(),_e=M.tilesIn(j,ye,pe);_e.sort($);for(var Ne=[],He=0,et=_e;He<et.length;He+=1){var yt=et[He];Ne.push({wrappedTileID:yt.tileID.wrapped().key,queryResults:yt.tile.queryRenderedFeatures(O,R,M._state,yt.queryGeometry,yt.cameraQueryGeometry,yt.scale,te,le,ye,U(M.transform,yt.tileID))})}var kt=function(wt){for(var vt={},Dt={},Pt=0,Ft=wt;Pt<Ft.length;Pt+=1){var er=Ft[Pt],cr=er.queryResults,Ar=er.wrappedTileID,Tr=Dt[Ar]=Dt[Ar]||{};for(var Yr in cr)for(var Gr=cr[Yr],an=Tr[Yr]=Tr[Yr]||{},$r=vt[Yr]=vt[Yr]||[],In=0,jn=Gr;In<jn.length;In+=1){var ia=jn[In];an[ia.featureIndex]||(an[ia.featureIndex]=!0,$r.push(ia))}}return vt}(Ne);for(var _t in kt)kt[_t].forEach(function(wt){var vt=wt.feature,Dt=M.getFeatureState(vt.layer["source-layer"],vt.id);vt.source=vt.layer.source,vt.layer["source-layer"]&&(vt.sourceLayer=vt.layer["source-layer"]),vt.state=Dt});return kt}function $(M,O){var R=M.tileID,j=O.tileID;return R.overscaledZ-j.overscaledZ||R.canonical.y-j.canonical.y||R.wrap-j.wrap||R.canonical.x-j.canonical.x}var K=function(M,O){this.max=M,this.onRemove=O,this.reset()};K.prototype.reset=function(){for(var M in this.data)for(var O=0,R=this.data[M];O<R.length;O+=1){var j=R[O];j.timeout&&clearTimeout(j.timeout),this.onRemove(j.value)}return this.data={},this.order=[],this},K.prototype.add=function(M,O,R){var j=this,te=M.wrapped().key;this.data[te]===void 0&&(this.data[te]=[]);var le={value:O,timeout:void 0};if(R!==void 0&&(le.timeout=setTimeout(function(){j.remove(M,le)},R)),this.data[te].push(le),this.order.push(te),this.order.length>this.max){var pe=this._getAndRemoveByKey(this.order[0]);pe&&this.onRemove(pe)}return this},K.prototype.has=function(M){return M.wrapped().key in this.data},K.prototype.getAndRemove=function(M){return this.has(M)?this._getAndRemoveByKey(M.wrapped().key):null},K.prototype._getAndRemoveByKey=function(M){var O=this.data[M].shift();return O.timeout&&clearTimeout(O.timeout),this.data[M].length===0&&delete this.data[M],this.order.splice(this.order.indexOf(M),1),O.value},K.prototype.getByKey=function(M){var O=this.data[M];return O?O[0].value:null},K.prototype.get=function(M){return this.has(M)?this.data[M.wrapped().key][0].value:null},K.prototype.remove=function(M,O){if(!this.has(M))return this;var R=M.wrapped().key,j=O===void 0?0:this.data[R].indexOf(O),te=this.data[R][j];return this.data[R].splice(j,1),te.timeout&&clearTimeout(te.timeout),this.data[R].length===0&&delete this.data[R],this.onRemove(te.value),this.order.splice(this.order.indexOf(R),1),this},K.prototype.setMaxSize=function(M){for(this.max=M;this.order.length>this.max;){var O=this._getAndRemoveByKey(this.order[0]);O&&this.onRemove(O)}return this},K.prototype.filter=function(M){var O=[];for(var R in this.data)for(var j=0,te=this.data[R];j<te.length;j+=1){var le=te[j];M(le.value)||O.push(le)}for(var pe=0,ye=O;pe<ye.length;pe+=1){var _e=ye[pe];this.remove(_e.value.tileID,_e)}};var re=function(M,O,R){this.context=M;var j=M.gl;this.buffer=j.createBuffer(),this.dynamicDraw=!!R,this.context.unbindVAO(),M.bindElementBuffer.set(this.buffer),j.bufferData(j.ELEMENT_ARRAY_BUFFER,O.arrayBuffer,this.dynamicDraw?j.DYNAMIC_DRAW:j.STATIC_DRAW),this.dynamicDraw||delete O.arrayBuffer};re.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},re.prototype.updateData=function(M){var O=this.context.gl;this.context.unbindVAO(),this.bind(),O.bufferSubData(O.ELEMENT_ARRAY_BUFFER,0,M.arrayBuffer)},re.prototype.destroy=function(){var M=this.context.gl;this.buffer&&(M.deleteBuffer(this.buffer),delete this.buffer)};var ne={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ae=function(M,O,R,j){this.length=O.length,this.attributes=R,this.itemSize=O.bytesPerElement,this.dynamicDraw=j,this.context=M;var te=M.gl;this.buffer=te.createBuffer(),M.bindVertexBuffer.set(this.buffer),te.bufferData(te.ARRAY_BUFFER,O.arrayBuffer,this.dynamicDraw?te.DYNAMIC_DRAW:te.STATIC_DRAW),this.dynamicDraw||delete O.arrayBuffer};ae.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ae.prototype.updateData=function(M){var O=this.context.gl;this.bind(),O.bufferSubData(O.ARRAY_BUFFER,0,M.arrayBuffer)},ae.prototype.enableAttributes=function(M,O){for(var R=0;R<this.attributes.length;R++){var j=this.attributes[R],te=O.attributes[j.name];te!==void 0&&M.enableVertexAttribArray(te)}},ae.prototype.setVertexAttribPointers=function(M,O,R){for(var j=0;j<this.attributes.length;j++){var te=this.attributes[j],le=O.attributes[te.name];le!==void 0&&M.vertexAttribPointer(le,te.components,M[ne[te.type]],!1,this.itemSize,te.offset+this.itemSize*(R||0))}},ae.prototype.destroy=function(){var M=this.context.gl;this.buffer&&(M.deleteBuffer(this.buffer),delete this.buffer)};var ie=function(M){this.gl=M.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ie.prototype.get=function(){return this.current},ie.prototype.set=function(M){},ie.prototype.getDefault=function(){return this.default},ie.prototype.setDefault=function(){this.set(this.default)};var he=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return e.Color.transparent},O.prototype.set=function(R){var j=this.current;(R.r!==j.r||R.g!==j.g||R.b!==j.b||R.a!==j.a||this.dirty)&&(this.gl.clearColor(R.r,R.g,R.b,R.a),this.current=R,this.dirty=!1)},O}(ie),se=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return 1},O.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.clearDepth(R),this.current=R,this.dirty=!1)},O}(ie),de=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return 0},O.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.clearStencil(R),this.current=R,this.dirty=!1)},O}(ie),ce=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return[!0,!0,!0,!0]},O.prototype.set=function(R){var j=this.current;(R[0]!==j[0]||R[1]!==j[1]||R[2]!==j[2]||R[3]!==j[3]||this.dirty)&&(this.gl.colorMask(R[0],R[1],R[2],R[3]),this.current=R,this.dirty=!1)},O}(ie),ve=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return!0},O.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.depthMask(R),this.current=R,this.dirty=!1)},O}(ie),Ee=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return 255},O.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.stencilMask(R),this.current=R,this.dirty=!1)},O}(ie),Le=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},O.prototype.set=function(R){var j=this.current;(R.func!==j.func||R.ref!==j.ref||R.mask!==j.mask||this.dirty)&&(this.gl.stencilFunc(R.func,R.ref,R.mask),this.current=R,this.dirty=!1)},O}(ie),Te=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){var R=this.gl;return[R.KEEP,R.KEEP,R.KEEP]},O.prototype.set=function(R){var j=this.current;(R[0]!==j[0]||R[1]!==j[1]||R[2]!==j[2]||this.dirty)&&(this.gl.stencilOp(R[0],R[1],R[2]),this.current=R,this.dirty=!1)},O}(ie),xe=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return!1},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;R?j.enable(j.STENCIL_TEST):j.disable(j.STENCIL_TEST),this.current=R,this.dirty=!1}},O}(ie),fe=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return[0,1]},O.prototype.set=function(R){var j=this.current;(R[0]!==j[0]||R[1]!==j[1]||this.dirty)&&(this.gl.depthRange(R[0],R[1]),this.current=R,this.dirty=!1)},O}(ie),ge=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return!1},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;R?j.enable(j.DEPTH_TEST):j.disable(j.DEPTH_TEST),this.current=R,this.dirty=!1}},O}(ie),ke=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return this.gl.LESS},O.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.depthFunc(R),this.current=R,this.dirty=!1)},O}(ie),Me=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return!1},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;R?j.enable(j.BLEND):j.disable(j.BLEND),this.current=R,this.dirty=!1}},O}(ie),Se=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){var R=this.gl;return[R.ONE,R.ZERO]},O.prototype.set=function(R){var j=this.current;(R[0]!==j[0]||R[1]!==j[1]||this.dirty)&&(this.gl.blendFunc(R[0],R[1]),this.current=R,this.dirty=!1)},O}(ie),De=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return e.Color.transparent},O.prototype.set=function(R){var j=this.current;(R.r!==j.r||R.g!==j.g||R.b!==j.b||R.a!==j.a||this.dirty)&&(this.gl.blendColor(R.r,R.g,R.b,R.a),this.current=R,this.dirty=!1)},O}(ie),Be=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return this.gl.FUNC_ADD},O.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.blendEquation(R),this.current=R,this.dirty=!1)},O}(ie),We=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return!1},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;R?j.enable(j.CULL_FACE):j.disable(j.CULL_FACE),this.current=R,this.dirty=!1}},O}(ie),Qe=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return this.gl.BACK},O.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.cullFace(R),this.current=R,this.dirty=!1)},O}(ie),Oe=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return this.gl.CCW},O.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.frontFace(R),this.current=R,this.dirty=!1)},O}(ie),Ue=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return null},O.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.useProgram(R),this.current=R,this.dirty=!1)},O}(ie),Xe=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return this.gl.TEXTURE0},O.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.activeTexture(R),this.current=R,this.dirty=!1)},O}(ie),Ye=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){var R=this.gl;return[0,0,R.drawingBufferWidth,R.drawingBufferHeight]},O.prototype.set=function(R){var j=this.current;(R[0]!==j[0]||R[1]!==j[1]||R[2]!==j[2]||R[3]!==j[3]||this.dirty)&&(this.gl.viewport(R[0],R[1],R[2],R[3]),this.current=R,this.dirty=!1)},O}(ie),$e=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return null},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;j.bindFramebuffer(j.FRAMEBUFFER,R),this.current=R,this.dirty=!1}},O}(ie),it=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return null},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;j.bindRenderbuffer(j.RENDERBUFFER,R),this.current=R,this.dirty=!1}},O}(ie),ot=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return null},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;j.bindTexture(j.TEXTURE_2D,R),this.current=R,this.dirty=!1}},O}(ie),Et=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return null},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;j.bindBuffer(j.ARRAY_BUFFER,R),this.current=R,this.dirty=!1}},O}(ie),mt=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return null},O.prototype.set=function(R){var j=this.gl;j.bindBuffer(j.ELEMENT_ARRAY_BUFFER,R),this.current=R,this.dirty=!1},O}(ie),tt=function(M){function O(R){M.call(this,R),this.vao=R.extVertexArrayObject}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return null},O.prototype.set=function(R){this.vao&&(R!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(R),this.current=R,this.dirty=!1)},O}(ie),Ke=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return 4},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;j.pixelStorei(j.UNPACK_ALIGNMENT,R),this.current=R,this.dirty=!1}},O}(ie),Mt=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return!1},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;j.pixelStorei(j.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R),this.current=R,this.dirty=!1}},O}(ie),Jt=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return!1},O.prototype.set=function(R){if(R!==this.current||this.dirty){var j=this.gl;j.pixelStorei(j.UNPACK_FLIP_Y_WEBGL,R),this.current=R,this.dirty=!1}},O}(ie),$t=function(M){function O(R,j){M.call(this,R),this.context=R,this.parent=j}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getDefault=function(){return null},O}(ie),je=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.setDirty=function(){this.dirty=!0},O.prototype.set=function(R){if(R!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var j=this.gl;j.framebufferTexture2D(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_2D,R,0),this.current=R,this.dirty=!1}},O}($t),Ge=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(R){if(R!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var j=this.gl;j.framebufferRenderbuffer(j.FRAMEBUFFER,j.DEPTH_ATTACHMENT,j.RENDERBUFFER,R),this.current=R,this.dirty=!1}},O}($t),Ct=function(M,O,R,j){this.context=M,this.width=O,this.height=R;var te=M.gl,le=this.framebuffer=te.createFramebuffer();this.colorAttachment=new je(M,le),j&&(this.depthAttachment=new Ge(M,le))};Ct.prototype.destroy=function(){var M=this.context.gl,O=this.colorAttachment.get();if(O&&M.deleteTexture(O),this.depthAttachment){var R=this.depthAttachment.get();R&&M.deleteRenderbuffer(R)}M.deleteFramebuffer(this.framebuffer)};var Ie=function(M,O,R){this.func=M,this.mask=O,this.range=R};Ie.ReadOnly=!1,Ie.ReadWrite=!0,Ie.disabled=new Ie(519,Ie.ReadOnly,[0,1]);var be=function(M,O,R,j,te,le){this.test=M,this.ref=O,this.mask=R,this.fail=j,this.depthFail=te,this.pass=le};be.disabled=new be({func:519,mask:0},0,0,7680,7680,7680);var Ae=function(M,O,R){this.blendFunction=M,this.blendColor=O,this.mask=R};Ae.disabled=new Ae(Ae.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),Ae.unblended=new Ae(Ae.Replace,e.Color.transparent,[!0,!0,!0,!0]),Ae.alphaBlended=new Ae([1,771],e.Color.transparent,[!0,!0,!0,!0]);var Pe=function(M,O,R){this.enable=M,this.mode=O,this.frontFace=R};Pe.disabled=new Pe(!1,1029,2305),Pe.backCCW=new Pe(!0,1029,2305);var ze=function(M){this.gl=M,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new he(this),this.clearDepth=new se(this),this.clearStencil=new de(this),this.colorMask=new ce(this),this.depthMask=new ve(this),this.stencilMask=new Ee(this),this.stencilFunc=new Le(this),this.stencilOp=new Te(this),this.stencilTest=new xe(this),this.depthRange=new fe(this),this.depthTest=new ge(this),this.depthFunc=new ke(this),this.blend=new Me(this),this.blendFunc=new Se(this),this.blendColor=new De(this),this.blendEquation=new Be(this),this.cullFace=new We(this),this.cullFaceSide=new Qe(this),this.frontFace=new Oe(this),this.program=new Ue(this),this.activeTexture=new Xe(this),this.viewport=new Ye(this),this.bindFramebuffer=new $e(this),this.bindRenderbuffer=new it(this),this.bindTexture=new ot(this),this.bindVertexBuffer=new Et(this),this.bindElementBuffer=new mt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new tt(this),this.pixelStoreUnpack=new Ke(this),this.pixelStoreUnpackPremultiplyAlpha=new Mt(this),this.pixelStoreUnpackFlipY=new Jt(this),this.extTextureFilterAnisotropic=M.getExtension("EXT_texture_filter_anisotropic")||M.getExtension("MOZ_EXT_texture_filter_anisotropic")||M.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=M.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=M.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(M.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=M.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=M.getExtension("EXT_disjoint_timer_query")};ze.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ze.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ze.prototype.createIndexBuffer=function(M,O){return new re(this,M,O)},ze.prototype.createVertexBuffer=function(M,O,R){return new ae(this,M,O,R)},ze.prototype.createRenderbuffer=function(M,O,R){var j=this.gl,te=j.createRenderbuffer();return this.bindRenderbuffer.set(te),j.renderbufferStorage(j.RENDERBUFFER,M,O,R),this.bindRenderbuffer.set(null),te},ze.prototype.createFramebuffer=function(M,O,R){return new Ct(this,M,O,R)},ze.prototype.clear=function(M){var O=M.color,R=M.depth,j=this.gl,te=0;O&&(te|=j.COLOR_BUFFER_BIT,this.clearColor.set(O),this.colorMask.set([!0,!0,!0,!0])),R!==void 0&&(te|=j.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(R),this.depthMask.set(!0)),j.clear(te)},ze.prototype.setCullFace=function(M){M.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(M.mode),this.frontFace.set(M.frontFace))},ze.prototype.setDepthMode=function(M){M.func!==this.gl.ALWAYS||M.mask?(this.depthTest.set(!0),this.depthFunc.set(M.func),this.depthMask.set(M.mask),this.depthRange.set(M.range)):this.depthTest.set(!1)},ze.prototype.setStencilMode=function(M){M.test.func!==this.gl.ALWAYS||M.mask?(this.stencilTest.set(!0),this.stencilMask.set(M.mask),this.stencilOp.set([M.fail,M.depthFail,M.pass]),this.stencilFunc.set({func:M.test.func,ref:M.ref,mask:M.test.mask})):this.stencilTest.set(!1)},ze.prototype.setColorMode=function(M){e.deepEqual(M.blendFunction,Ae.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(M.blendFunction),this.blendColor.set(M.blendColor)),this.colorMask.set(M.mask)},ze.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var qe=function(M){function O(R,j,te){var le=this;M.call(this),this.id=R,this.dispatcher=te,this.on("data",function(pe){pe.dataType==="source"&&pe.sourceDataType==="metadata"&&(le._sourceLoaded=!0),le._sourceLoaded&&!le._paused&&pe.dataType==="source"&&pe.sourceDataType==="content"&&(le.reload(),le.transform&&le.update(le.transform))}),this.on("error",function(){le._sourceErrored=!0}),this._source=function(pe,ye,_e,Ne){var He=new D[ye.type](pe,ye,_e,Ne);if(He.id!==pe)throw new Error("Expected Source id to be "+pe+" instead of "+He.id);return e.bindAll(["load","abort","unload","serialize","prepare"],He),He}(R,j,te,this),this._tiles={},this._cache=new K(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.onAdd=function(R){this.map=R,this._maxTileCacheSize=R?R._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(R)},O.prototype.onRemove=function(R){this._source&&this._source.onRemove&&this._source.onRemove(R)},O.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var R in this._tiles){var j=this._tiles[R];if(j.state!=="loaded"&&j.state!=="errored")return!1}return!0},O.prototype.getSource=function(){return this._source},O.prototype.pause=function(){this._paused=!0},O.prototype.resume=function(){if(this._paused){var R=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,R&&this.reload(),this.transform&&this.update(this.transform)}},O.prototype._loadTile=function(R,j){return this._source.loadTile(R,j)},O.prototype._unloadTile=function(R){if(this._source.unloadTile)return this._source.unloadTile(R,function(){})},O.prototype._abortTile=function(R){if(this._source.abortTile)return this._source.abortTile(R,function(){})},O.prototype.serialize=function(){return this._source.serialize()},O.prototype.prepare=function(R){for(var j in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var te=this._tiles[j];te.upload(R),te.prepare(this.map.style.imageManager)}},O.prototype.getIds=function(){return e.values(this._tiles).map(function(R){return R.tileID}).sort(ht).map(function(R){return R.key})},O.prototype.getRenderableIds=function(R){var j=this,te=[];for(var le in this._tiles)this._isIdRenderable(le,R)&&te.push(this._tiles[le]);return R?te.sort(function(pe,ye){var _e=pe.tileID,Ne=ye.tileID,He=new e.Point(_e.canonical.x,_e.canonical.y)._rotate(j.transform.angle),et=new e.Point(Ne.canonical.x,Ne.canonical.y)._rotate(j.transform.angle);return _e.overscaledZ-Ne.overscaledZ||et.y-He.y||et.x-He.x}).map(function(pe){return pe.tileID.key}):te.map(function(pe){return pe.tileID}).sort(ht).map(function(pe){return pe.key})},O.prototype.hasRenderableParent=function(R){var j=this.findLoadedParent(R,0);return!!j&&this._isIdRenderable(j.tileID.key)},O.prototype._isIdRenderable=function(R,j){return this._tiles[R]&&this._tiles[R].hasData()&&!this._coveredTiles[R]&&(j||!this._tiles[R].holdingForFade())},O.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var R in this._cache.reset(),this._tiles)this._tiles[R].state!=="errored"&&this._reloadTile(R,"reloading")},O.prototype._reloadTile=function(R,j){var te=this._tiles[R];te&&(te.state!=="loading"&&(te.state=j),this._loadTile(te,this._tileLoaded.bind(this,te,R,j)))},O.prototype._tileLoaded=function(R,j,te,le){if(le)return R.state="errored",void(le.status!==404?this._source.fire(new e.ErrorEvent(le,{tile:R})):this.update(this.transform));R.timeAdded=e.browser.now(),te==="expired"&&(R.refreshedUponExpiration=!0),this._setTileReloadTimer(j,R),this.getSource().type==="raster-dem"&&R.dem&&this._backfillDEM(R),this._state.initializeTileState(R,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:R,coord:R.tileID}))},O.prototype._backfillDEM=function(R){for(var j=this.getRenderableIds(),te=0;te<j.length;te++){var le=j[te];if(R.neighboringTiles&&R.neighboringTiles[le]){var pe=this.getTileByID(le);ye(R,pe),ye(pe,R)}}function ye(_e,Ne){_e.needsHillshadePrepare=!0;var He=Ne.tileID.canonical.x-_e.tileID.canonical.x,et=Ne.tileID.canonical.y-_e.tileID.canonical.y,yt=Math.pow(2,_e.tileID.canonical.z),kt=Ne.tileID.key;He===0&&et===0||Math.abs(et)>1||(Math.abs(He)>1&&(Math.abs(He+yt)===1?He+=yt:Math.abs(He-yt)===1&&(He-=yt)),Ne.dem&&_e.dem&&(_e.dem.backfillBorder(Ne.dem,He,et),_e.neighboringTiles&&_e.neighboringTiles[kt]&&(_e.neighboringTiles[kt].backfilled=!0)))}},O.prototype.getTile=function(R){return this.getTileByID(R.key)},O.prototype.getTileByID=function(R){return this._tiles[R]},O.prototype._retainLoadedChildren=function(R,j,te,le){for(var pe in this._tiles){var ye=this._tiles[pe];if(!(le[pe]||!ye.hasData()||ye.tileID.overscaledZ<=j||ye.tileID.overscaledZ>te)){for(var _e=ye.tileID;ye&&ye.tileID.overscaledZ>j+1;){var Ne=ye.tileID.scaledTo(ye.tileID.overscaledZ-1);(ye=this._tiles[Ne.key])&&ye.hasData()&&(_e=Ne)}for(var He=_e;He.overscaledZ>j;)if(R[(He=He.scaledTo(He.overscaledZ-1)).key]){le[_e.key]=_e;break}}}},O.prototype.findLoadedParent=function(R,j){if(R.key in this._loadedParentTiles){var te=this._loadedParentTiles[R.key];return te&&te.tileID.overscaledZ>=j?te:null}for(var le=R.overscaledZ-1;le>=j;le--){var pe=R.scaledTo(le),ye=this._getLoadedTile(pe);if(ye)return ye}},O.prototype._getLoadedTile=function(R){var j=this._tiles[R.key];return j&&j.hasData()?j:this._cache.getByKey(R.wrapped().key)},O.prototype.updateCacheSize=function(R){var j=(Math.ceil(R.width/this._source.tileSize)+1)*(Math.ceil(R.height/this._source.tileSize)+1),te=Math.floor(5*j),le=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,te):te;this._cache.setMaxSize(le)},O.prototype.handleWrapJump=function(R){var j=(R-(this._prevLng===void 0?R:this._prevLng))/360,te=Math.round(j);if(this._prevLng=R,te){var le={};for(var pe in this._tiles){var ye=this._tiles[pe];ye.tileID=ye.tileID.unwrapTo(ye.tileID.wrap+te),le[ye.tileID.key]=ye}for(var _e in this._tiles=le,this._timers)clearTimeout(this._timers[_e]),delete this._timers[_e];for(var Ne in this._tiles){var He=this._tiles[Ne];this._setTileReloadTimer(Ne,He)}}},O.prototype.update=function(R){var j=this;if(this.transform=R,this._sourceLoaded&&!this._paused){var te;this.updateCacheSize(R),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?te=R.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Tr){return new e.OverscaledTileID(Tr.canonical.z,Tr.wrap,Tr.canonical.z,Tr.canonical.x,Tr.canonical.y)}):(te=R.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(te=te.filter(function(Tr){return j._source.hasTile(Tr)}))):te=[];var le=R.coveringZoomLevel(this._source),pe=Math.max(le-O.maxOverzooming,this._source.minzoom),ye=Math.max(le+O.maxUnderzooming,this._source.minzoom),_e=this._updateRetainedTiles(te,le);if(at(this._source.type)){for(var Ne={},He={},et=0,yt=Object.keys(_e);et<yt.length;et+=1){var kt=yt[et],_t=_e[kt],wt=this._tiles[kt];if(wt&&!(wt.fadeEndTime&&wt.fadeEndTime<=e.browser.now())){var vt=this.findLoadedParent(_t,pe);vt&&(this._addTile(vt.tileID),Ne[vt.tileID.key]=vt.tileID),He[kt]=_t}}for(var Dt in this._retainLoadedChildren(He,le,ye,_e),Ne)_e[Dt]||(this._coveredTiles[Dt]=!0,_e[Dt]=Ne[Dt])}for(var Pt in _e)this._tiles[Pt].clearFadeHold();for(var Ft=0,er=e.keysDifference(this._tiles,_e);Ft<er.length;Ft+=1){var cr=er[Ft],Ar=this._tiles[cr];Ar.hasSymbolBuckets&&!Ar.holdingForFade()?Ar.setHoldDuration(this.map._fadeDuration):Ar.hasSymbolBuckets&&!Ar.symbolFadeFinished()||this._removeTile(cr)}this._updateLoadedParentTileCache()}},O.prototype.releaseSymbolFadeTiles=function(){for(var R in this._tiles)this._tiles[R].holdingForFade()&&this._removeTile(R)},O.prototype._updateRetainedTiles=function(R,j){for(var te={},le={},pe=Math.max(j-O.maxOverzooming,this._source.minzoom),ye=Math.max(j+O.maxUnderzooming,this._source.minzoom),_e={},Ne=0,He=R;Ne<He.length;Ne+=1){var et=He[Ne],yt=this._addTile(et);te[et.key]=et,yt.hasData()||j<this._source.maxzoom&&(_e[et.key]=et)}this._retainLoadedChildren(_e,j,ye,te);for(var kt=0,_t=R;kt<_t.length;kt+=1){var wt=_t[kt],vt=this._tiles[wt.key];if(!vt.hasData()){if(j+1>this._source.maxzoom){var Dt=wt.children(this._source.maxzoom)[0],Pt=this.getTile(Dt);if(Pt&&Pt.hasData()){te[Dt.key]=Dt;continue}}else{var Ft=wt.children(this._source.maxzoom);if(te[Ft[0].key]&&te[Ft[1].key]&&te[Ft[2].key]&&te[Ft[3].key])continue}for(var er=vt.wasRequested(),cr=wt.overscaledZ-1;cr>=pe;--cr){var Ar=wt.scaledTo(cr);if(le[Ar.key]||(le[Ar.key]=!0,!(vt=this.getTile(Ar))&&er&&(vt=this._addTile(Ar)),vt&&(te[Ar.key]=Ar,er=vt.wasRequested(),vt.hasData())))break}}}return te},O.prototype._updateLoadedParentTileCache=function(){for(var R in this._loadedParentTiles={},this._tiles){for(var j=[],te=void 0,le=this._tiles[R].tileID;le.overscaledZ>0;){if(le.key in this._loadedParentTiles){te=this._loadedParentTiles[le.key];break}j.push(le.key);var pe=le.scaledTo(le.overscaledZ-1);if(te=this._getLoadedTile(pe))break;le=pe}for(var ye=0,_e=j;ye<_e.length;ye+=1){var Ne=_e[ye];this._loadedParentTiles[Ne]=te}}},O.prototype._addTile=function(R){var j=this._tiles[R.key];if(j)return j;(j=this._cache.getAndRemove(R))&&(this._setTileReloadTimer(R.key,j),j.tileID=R,this._state.initializeTileState(j,this.map?this.map.painter:null),this._cacheTimers[R.key]&&(clearTimeout(this._cacheTimers[R.key]),delete this._cacheTimers[R.key],this._setTileReloadTimer(R.key,j)));var te=!!j;return te||(j=new e.Tile(R,this._source.tileSize*R.overscaleFactor()),this._loadTile(j,this._tileLoaded.bind(this,j,R.key,j.state))),j?(j.uses++,this._tiles[R.key]=j,te||this._source.fire(new e.Event("dataloading",{tile:j,coord:j.tileID,dataType:"source"})),j):null},O.prototype._setTileReloadTimer=function(R,j){var te=this;R in this._timers&&(clearTimeout(this._timers[R]),delete this._timers[R]);var le=j.getExpiryTimeout();le&&(this._timers[R]=setTimeout(function(){te._reloadTile(R,"expired"),delete te._timers[R]},le))},O.prototype._removeTile=function(R){var j=this._tiles[R];j&&(j.uses--,delete this._tiles[R],this._timers[R]&&(clearTimeout(this._timers[R]),delete this._timers[R]),j.uses>0||(j.hasData()&&j.state!=="reloading"?this._cache.add(j.tileID,j,j.getExpiryTimeout()):(j.aborted=!0,this._abortTile(j),this._unloadTile(j))))},O.prototype.clearTiles=function(){for(var R in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(R);this._cache.reset()},O.prototype.tilesIn=function(R,j,te){var le=this,pe=[],ye=this.transform;if(!ye)return pe;for(var _e=te?ye.getCameraQueryGeometry(R):R,Ne=R.map(function(cr){return ye.pointCoordinate(cr)}),He=_e.map(function(cr){return ye.pointCoordinate(cr)}),et=this.getIds(),yt=1/0,kt=1/0,_t=-1/0,wt=-1/0,vt=0,Dt=He;vt<Dt.length;vt+=1){var Pt=Dt[vt];yt=Math.min(yt,Pt.x),kt=Math.min(kt,Pt.y),_t=Math.max(_t,Pt.x),wt=Math.max(wt,Pt.y)}for(var Ft=function(cr){var Ar=le._tiles[et[cr]];if(!Ar.holdingForFade()){var Tr=Ar.tileID,Yr=Math.pow(2,ye.zoom-Ar.tileID.overscaledZ),Gr=j*Ar.queryPadding*e.EXTENT/Ar.tileSize/Yr,an=[Tr.getTilePoint(new e.MercatorCoordinate(yt,kt)),Tr.getTilePoint(new e.MercatorCoordinate(_t,wt))];if(an[0].x-Gr<e.EXTENT&&an[0].y-Gr<e.EXTENT&&an[1].x+Gr>=0&&an[1].y+Gr>=0){var $r=Ne.map(function(jn){return Tr.getTilePoint(jn)}),In=He.map(function(jn){return Tr.getTilePoint(jn)});pe.push({tile:Ar,tileID:Tr,queryGeometry:$r,cameraQueryGeometry:In,scale:Yr})}}},er=0;er<et.length;er++)Ft(er);return pe},O.prototype.getVisibleCoordinates=function(R){for(var j=this,te=this.getRenderableIds(R).map(function(_e){return j._tiles[_e].tileID}),le=0,pe=te;le<pe.length;le+=1){var ye=pe[le];ye.posMatrix=this.transform.calculatePosMatrix(ye.toUnwrapped())}return te},O.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(at(this._source.type))for(var R in this._tiles){var j=this._tiles[R];if(j.fadeEndTime!==void 0&&j.fadeEndTime>=e.browser.now())return!0}return!1},O.prototype.setFeatureState=function(R,j,te){R=R||"_geojsonTileLayer",this._state.updateState(R,j,te)},O.prototype.removeFeatureState=function(R,j,te){R=R||"_geojsonTileLayer",this._state.removeFeatureState(R,j,te)},O.prototype.getFeatureState=function(R,j){return R=R||"_geojsonTileLayer",this._state.getState(R,j)},O.prototype.setDependencies=function(R,j,te){var le=this._tiles[R];le&&le.setDependencies(j,te)},O.prototype.reloadTilesForDependencies=function(R,j){for(var te in this._tiles)this._tiles[te].hasDependency(R,j)&&this._reloadTile(te,"reloading");this._cache.filter(function(le){return!le.hasDependency(R,j)})},O}(e.Evented);function ht(M,O){var R=Math.abs(2*M.wrap)-+(M.wrap<0),j=Math.abs(2*O.wrap)-+(O.wrap<0);return M.overscaledZ-O.overscaledZ||j-R||O.canonical.y-M.canonical.y||O.canonical.x-M.canonical.x}function at(M){return M==="raster"||M==="image"||M==="video"}function nt(){return new e.window.Worker(oe.workerUrl)}qe.maxOverzooming=10,qe.maxUnderzooming=3;var xt="mapboxgl_preloaded_worker_pool",Lt=function(){this.active={}};Lt.prototype.acquire=function(M){if(!this.workers)for(this.workers=[];this.workers.length<Lt.workerCount;)this.workers.push(new nt);return this.active[M]=!0,this.workers.slice()},Lt.prototype.release=function(M){delete this.active[M],this.numActive()===0&&(this.workers.forEach(function(O){O.terminate()}),this.workers=null)},Lt.prototype.isPreloaded=function(){return!!this.active[xt]},Lt.prototype.numActive=function(){return Object.keys(this.active).length};var bt,St=Math.floor(e.browser.hardwareConcurrency/2);function st(){return bt||(bt=new Lt),bt}function It(M,O){var R={};for(var j in M)j!=="ref"&&(R[j]=M[j]);return e.refProperties.forEach(function(te){te in O&&(R[te]=O[te])}),R}function jt(M){M=M.slice();for(var O=Object.create(null),R=0;R<M.length;R++)O[M[R].id]=M[R];for(var j=0;j<M.length;j++)"ref"in M[j]&&(M[j]=It(M[j],O[M[j].ref]));return M}Lt.workerCount=Math.max(Math.min(St,6),1);var Ut={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function zt(M,O,R){R.push({command:Ut.addSource,args:[M,O[M]]})}function Ce(M,O,R){O.push({command:Ut.removeSource,args:[M]}),R[M]=!0}function lt(M,O,R,j){Ce(M,R,j),zt(M,O,R)}function At(M,O,R){var j;for(j in M[R])if(M[R].hasOwnProperty(j)&&j!=="data"&&!e.deepEqual(M[R][j],O[R][j]))return!1;for(j in O[R])if(O[R].hasOwnProperty(j)&&j!=="data"&&!e.deepEqual(M[R][j],O[R][j]))return!1;return!0}function Bt(M,O,R,j,te,le){var pe;for(pe in O=O||{},M=M||{})M.hasOwnProperty(pe)&&(e.deepEqual(M[pe],O[pe])||R.push({command:le,args:[j,pe,O[pe],te]}));for(pe in O)O.hasOwnProperty(pe)&&!M.hasOwnProperty(pe)&&(e.deepEqual(M[pe],O[pe])||R.push({command:le,args:[j,pe,O[pe],te]}))}function Ht(M){return M.id}function or(M,O){return M[O.id]=O,M}function ar(M,O){if(!M)return[{command:Ut.setStyle,args:[O]}];var R=[];try{if(!e.deepEqual(M.version,O.version))return[{command:Ut.setStyle,args:[O]}];e.deepEqual(M.center,O.center)||R.push({command:Ut.setCenter,args:[O.center]}),e.deepEqual(M.zoom,O.zoom)||R.push({command:Ut.setZoom,args:[O.zoom]}),e.deepEqual(M.bearing,O.bearing)||R.push({command:Ut.setBearing,args:[O.bearing]}),e.deepEqual(M.pitch,O.pitch)||R.push({command:Ut.setPitch,args:[O.pitch]}),e.deepEqual(M.sprite,O.sprite)||R.push({command:Ut.setSprite,args:[O.sprite]}),e.deepEqual(M.glyphs,O.glyphs)||R.push({command:Ut.setGlyphs,args:[O.glyphs]}),e.deepEqual(M.transition,O.transition)||R.push({command:Ut.setTransition,args:[O.transition]}),e.deepEqual(M.light,O.light)||R.push({command:Ut.setLight,args:[O.light]});var j={},te=[];(function(pe,ye,_e,Ne){var He;for(He in ye=ye||{},pe=pe||{})pe.hasOwnProperty(He)&&(ye.hasOwnProperty(He)||Ce(He,_e,Ne));for(He in ye)ye.hasOwnProperty(He)&&(pe.hasOwnProperty(He)?e.deepEqual(pe[He],ye[He])||(pe[He].type==="geojson"&&ye[He].type==="geojson"&&At(pe,ye,He)?_e.push({command:Ut.setGeoJSONSourceData,args:[He,ye[He].data]}):lt(He,ye,_e,Ne)):zt(He,ye,_e))})(M.sources,O.sources,te,j);var le=[];M.layers&&M.layers.forEach(function(pe){j[pe.source]?R.push({command:Ut.removeLayer,args:[pe.id]}):le.push(pe)}),R=R.concat(te),function(pe,ye,_e){ye=ye||[];var Ne,He,et,yt,kt,_t,wt,vt=(pe=pe||[]).map(Ht),Dt=ye.map(Ht),Pt=pe.reduce(or,{}),Ft=ye.reduce(or,{}),er=vt.slice(),cr=Object.create(null);for(Ne=0,He=0;Ne<vt.length;Ne++)et=vt[Ne],Ft.hasOwnProperty(et)?He++:(_e.push({command:Ut.removeLayer,args:[et]}),er.splice(er.indexOf(et,He),1));for(Ne=0,He=0;Ne<Dt.length;Ne++)et=Dt[Dt.length-1-Ne],er[er.length-1-Ne]!==et&&(Pt.hasOwnProperty(et)?(_e.push({command:Ut.removeLayer,args:[et]}),er.splice(er.lastIndexOf(et,er.length-He),1)):He++,_t=er[er.length-Ne],_e.push({command:Ut.addLayer,args:[Ft[et],_t]}),er.splice(er.length-Ne,0,et),cr[et]=!0);for(Ne=0;Ne<Dt.length;Ne++)if(yt=Pt[et=Dt[Ne]],kt=Ft[et],!cr[et]&&!e.deepEqual(yt,kt))if(e.deepEqual(yt.source,kt.source)&&e.deepEqual(yt["source-layer"],kt["source-layer"])&&e.deepEqual(yt.type,kt.type)){for(wt in Bt(yt.layout,kt.layout,_e,et,null,Ut.setLayoutProperty),Bt(yt.paint,kt.paint,_e,et,null,Ut.setPaintProperty),e.deepEqual(yt.filter,kt.filter)||_e.push({command:Ut.setFilter,args:[et,kt.filter]}),e.deepEqual(yt.minzoom,kt.minzoom)&&e.deepEqual(yt.maxzoom,kt.maxzoom)||_e.push({command:Ut.setLayerZoomRange,args:[et,kt.minzoom,kt.maxzoom]}),yt)yt.hasOwnProperty(wt)&&wt!=="layout"&&wt!=="paint"&&wt!=="filter"&&wt!=="metadata"&&wt!=="minzoom"&&wt!=="maxzoom"&&(wt.indexOf("paint.")===0?Bt(yt[wt],kt[wt],_e,et,wt.slice(6),Ut.setPaintProperty):e.deepEqual(yt[wt],kt[wt])||_e.push({command:Ut.setLayerProperty,args:[et,wt,kt[wt]]}));for(wt in kt)kt.hasOwnProperty(wt)&&!yt.hasOwnProperty(wt)&&wt!=="layout"&&wt!=="paint"&&wt!=="filter"&&wt!=="metadata"&&wt!=="minzoom"&&wt!=="maxzoom"&&(wt.indexOf("paint.")===0?Bt(yt[wt],kt[wt],_e,et,wt.slice(6),Ut.setPaintProperty):e.deepEqual(yt[wt],kt[wt])||_e.push({command:Ut.setLayerProperty,args:[et,wt,kt[wt]]}))}else _e.push({command:Ut.removeLayer,args:[et]}),_t=er[er.lastIndexOf(et)+1],_e.push({command:Ut.addLayer,args:[kt,_t]})}(le,O.layers,R)}catch(pe){console.warn("Unable to compute style diff:",pe),R=[{command:Ut.setStyle,args:[O]}]}return R}var Nt=function(M,O){this.reset(M,O)};Nt.prototype.reset=function(M,O){this.points=M||[],this._distances=[0];for(var R=1;R<this.points.length;R++)this._distances[R]=this._distances[R-1]+this.points[R].dist(this.points[R-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(O||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Nt.prototype.lerp=function(M){if(this.points.length===1)return this.points[0];M=e.clamp(M,0,1);for(var O=1,R=this._distances[O],j=M*this.paddedLength+this.padding;R<j&&O<this._distances.length;)R=this._distances[++O];var te=O-1,le=this._distances[te],pe=R-le,ye=pe>0?(j-le)/pe:0;return this.points[te].mult(1-ye).add(this.points[O].mult(ye))};var nr=function(M,O,R){var j=this.boxCells=[],te=this.circleCells=[];this.xCellCount=Math.ceil(M/R),this.yCellCount=Math.ceil(O/R);for(var le=0;le<this.xCellCount*this.yCellCount;le++)j.push([]),te.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=M,this.height=O,this.xScale=this.xCellCount/M,this.yScale=this.yCellCount/O,this.boxUid=0,this.circleUid=0};function Lr(M,O,R,j,te){var le=e.create();return O?(e.scale(le,le,[1/te,1/te,1]),R||e.rotateZ(le,le,j.angle)):e.multiply(le,j.labelPlaneMatrix,M),le}function dr(M,O,R,j,te){if(O){var le=e.clone(M);return e.scale(le,le,[te,te,1]),R||e.rotateZ(le,le,-j.angle),le}return j.glCoordMatrix}function Kt(M,O){var R=[M.x,M.y,0,1];bn(R,R,O);var j=R[3];return{point:new e.Point(R[0]/j,R[1]/j),signedDistanceFromCamera:j}}function yr(M,O){return .5+M/O*.5}function xr(M,O){var R=M[0]/M[3],j=M[1]/M[3];return R>=-O[0]&&R<=O[0]&&j>=-O[1]&&j<=O[1]}function gr(M,O,R,j,te,le,pe,ye){var _e=j?M.textSizeData:M.iconSizeData,Ne=e.evaluateSizeForZoom(_e,R.transform.zoom),He=[256/R.width*2+1,256/R.height*2+1],et=j?M.text.dynamicLayoutVertexArray:M.icon.dynamicLayoutVertexArray;et.clear();for(var yt=M.lineVertexArray,kt=j?M.text.placedSymbolArray:M.icon.placedSymbolArray,_t=R.transform.width/R.transform.height,wt=!1,vt=0;vt<kt.length;vt++){var Dt=kt.get(vt);if(Dt.hidden||Dt.writingMode===e.WritingMode.vertical&&!wt)Zr(Dt.numGlyphs,et);else{wt=!1;var Pt=[Dt.anchorX,Dt.anchorY,0,1];if(e.transformMat4(Pt,Pt,O),xr(Pt,He)){var Ft=Pt[3],er=yr(R.transform.cameraToCenterDistance,Ft),cr=e.evaluateSizeForFeature(_e,Ne,Dt),Ar=pe?cr/er:cr*er,Tr=new e.Point(Dt.anchorX,Dt.anchorY),Yr=Kt(Tr,te).point,Gr={},an=Rr(Dt,Ar,!1,ye,O,te,le,M.glyphOffsetArray,yt,et,Yr,Tr,Gr,_t);wt=an.useVertical,(an.notEnoughRoom||wt||an.needsFlipping&&Rr(Dt,Ar,!0,ye,O,te,le,M.glyphOffsetArray,yt,et,Yr,Tr,Gr,_t).notEnoughRoom)&&Zr(Dt.numGlyphs,et)}else Zr(Dt.numGlyphs,et)}}j?M.text.dynamicLayoutVertexBuffer.updateData(et):M.icon.dynamicLayoutVertexBuffer.updateData(et)}function wr(M,O,R,j,te,le,pe,ye,_e,Ne,He){var et=ye.glyphStartIndex+ye.numGlyphs,yt=ye.lineStartIndex,kt=ye.lineStartIndex+ye.lineLength,_t=O.getoffsetX(ye.glyphStartIndex),wt=O.getoffsetX(et-1),vt=gn(M*_t,R,j,te,le,pe,ye.segment,yt,kt,_e,Ne,He);if(!vt)return null;var Dt=gn(M*wt,R,j,te,le,pe,ye.segment,yt,kt,_e,Ne,He);return Dt?{first:vt,last:Dt}:null}function zr(M,O,R,j){return M===e.WritingMode.horizontal&&Math.abs(R.y-O.y)>Math.abs(R.x-O.x)*j?{useVertical:!0}:(M===e.WritingMode.vertical?O.y<R.y:O.x>R.x)?{needsFlipping:!0}:null}function Rr(M,O,R,j,te,le,pe,ye,_e,Ne,He,et,yt,kt){var _t,wt=O/24,vt=M.lineOffsetX*wt,Dt=M.lineOffsetY*wt;if(M.numGlyphs>1){var Pt=M.glyphStartIndex+M.numGlyphs,Ft=M.lineStartIndex,er=M.lineStartIndex+M.lineLength,cr=wr(wt,ye,vt,Dt,R,He,et,M,_e,le,yt);if(!cr)return{notEnoughRoom:!0};var Ar=Kt(cr.first.point,pe).point,Tr=Kt(cr.last.point,pe).point;if(j&&!R){var Yr=zr(M.writingMode,Ar,Tr,kt);if(Yr)return Yr}_t=[cr.first];for(var Gr=M.glyphStartIndex+1;Gr<Pt-1;Gr++)_t.push(gn(wt*ye.getoffsetX(Gr),vt,Dt,R,He,et,M.segment,Ft,er,_e,le,yt));_t.push(cr.last)}else{if(j&&!R){var an=Kt(et,te).point,$r=M.lineStartIndex+M.segment+1,In=new e.Point(_e.getx($r),_e.gety($r)),jn=Kt(In,te),ia=jn.signedDistanceFromCamera>0?jn.point:Wr(et,In,an,1,te),jr=zr(M.writingMode,an,ia,kt);if(jr)return jr}var mn=gn(wt*ye.getoffsetX(M.glyphStartIndex),vt,Dt,R,He,et,M.segment,M.lineStartIndex,M.lineStartIndex+M.lineLength,_e,le,yt);if(!mn)return{notEnoughRoom:!0};_t=[mn]}for(var Un=0,Fn=_t;Un<Fn.length;Un+=1){var Jn=Fn[Un];e.addDynamicAttributes(Ne,Jn.point,Jn.angle)}return{}}function Wr(M,O,R,j,te){var le=Kt(M.add(M.sub(O)._unit()),te).point,pe=R.sub(le);return R.add(pe._mult(j/pe.mag()))}function gn(M,O,R,j,te,le,pe,ye,_e,Ne,He,et){var yt=j?M-O:M+O,kt=yt>0?1:-1,_t=0;j&&(kt*=-1,_t=Math.PI),kt<0&&(_t+=Math.PI);for(var wt=kt>0?ye+pe:ye+pe+1,vt=te,Dt=te,Pt=0,Ft=0,er=Math.abs(yt),cr=[];Pt+Ft<=er;){if((wt+=kt)<ye||wt>=_e)return null;if(Dt=vt,cr.push(vt),(vt=et[wt])===void 0){var Ar=new e.Point(Ne.getx(wt),Ne.gety(wt)),Tr=Kt(Ar,He);if(Tr.signedDistanceFromCamera>0)vt=et[wt]=Tr.point;else{var Yr=wt-kt;vt=Wr(Pt===0?le:new e.Point(Ne.getx(Yr),Ne.gety(Yr)),Ar,Dt,er-Pt+1,He)}}Pt+=Ft,Ft=Dt.dist(vt)}var Gr=(er-Pt)/Ft,an=vt.sub(Dt),$r=an.mult(Gr)._add(Dt);$r._add(an._unit()._perp()._mult(R*kt));var In=_t+Math.atan2(vt.y-Dt.y,vt.x-Dt.x);return cr.push($r),{point:$r,angle:In,path:cr}}nr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},nr.prototype.insert=function(M,O,R,j,te){this._forEachCell(O,R,j,te,this._insertBoxCell,this.boxUid++),this.boxKeys.push(M),this.bboxes.push(O),this.bboxes.push(R),this.bboxes.push(j),this.bboxes.push(te)},nr.prototype.insertCircle=function(M,O,R,j){this._forEachCell(O-j,R-j,O+j,R+j,this._insertCircleCell,this.circleUid++),this.circleKeys.push(M),this.circles.push(O),this.circles.push(R),this.circles.push(j)},nr.prototype._insertBoxCell=function(M,O,R,j,te,le){this.boxCells[te].push(le)},nr.prototype._insertCircleCell=function(M,O,R,j,te,le){this.circleCells[te].push(le)},nr.prototype._query=function(M,O,R,j,te,le){if(R<0||M>this.width||j<0||O>this.height)return!te&&[];var pe=[];if(M<=0&&O<=0&&this.width<=R&&this.height<=j){if(te)return!0;for(var ye=0;ye<this.boxKeys.length;ye++)pe.push({key:this.boxKeys[ye],x1:this.bboxes[4*ye],y1:this.bboxes[4*ye+1],x2:this.bboxes[4*ye+2],y2:this.bboxes[4*ye+3]});for(var _e=0;_e<this.circleKeys.length;_e++){var Ne=this.circles[3*_e],He=this.circles[3*_e+1],et=this.circles[3*_e+2];pe.push({key:this.circleKeys[_e],x1:Ne-et,y1:He-et,x2:Ne+et,y2:He+et})}return le?pe.filter(le):pe}var yt={hitTest:te,seenUids:{box:{},circle:{}}};return this._forEachCell(M,O,R,j,this._queryCell,pe,yt,le),te?pe.length>0:pe},nr.prototype._queryCircle=function(M,O,R,j,te){var le=M-R,pe=M+R,ye=O-R,_e=O+R;if(pe<0||le>this.width||_e<0||ye>this.height)return!j&&[];var Ne=[],He={hitTest:j,circle:{x:M,y:O,radius:R},seenUids:{box:{},circle:{}}};return this._forEachCell(le,ye,pe,_e,this._queryCellCircle,Ne,He,te),j?Ne.length>0:Ne},nr.prototype.query=function(M,O,R,j,te){return this._query(M,O,R,j,!1,te)},nr.prototype.hitTest=function(M,O,R,j,te){return this._query(M,O,R,j,!0,te)},nr.prototype.hitTestCircle=function(M,O,R,j){return this._queryCircle(M,O,R,!0,j)},nr.prototype._queryCell=function(M,O,R,j,te,le,pe,ye){var _e=pe.seenUids,Ne=this.boxCells[te];if(Ne!==null)for(var He=this.bboxes,et=0,yt=Ne;et<yt.length;et+=1){var kt=yt[et];if(!_e.box[kt]){_e.box[kt]=!0;var _t=4*kt;if(M<=He[_t+2]&&O<=He[_t+3]&&R>=He[_t+0]&&j>=He[_t+1]&&(!ye||ye(this.boxKeys[kt]))){if(pe.hitTest)return le.push(!0),!0;le.push({key:this.boxKeys[kt],x1:He[_t],y1:He[_t+1],x2:He[_t+2],y2:He[_t+3]})}}}var wt=this.circleCells[te];if(wt!==null)for(var vt=this.circles,Dt=0,Pt=wt;Dt<Pt.length;Dt+=1){var Ft=Pt[Dt];if(!_e.circle[Ft]){_e.circle[Ft]=!0;var er=3*Ft;if(this._circleAndRectCollide(vt[er],vt[er+1],vt[er+2],M,O,R,j)&&(!ye||ye(this.circleKeys[Ft]))){if(pe.hitTest)return le.push(!0),!0;var cr=vt[er],Ar=vt[er+1],Tr=vt[er+2];le.push({key:this.circleKeys[Ft],x1:cr-Tr,y1:Ar-Tr,x2:cr+Tr,y2:Ar+Tr})}}}},nr.prototype._queryCellCircle=function(M,O,R,j,te,le,pe,ye){var _e=pe.circle,Ne=pe.seenUids,He=this.boxCells[te];if(He!==null)for(var et=this.bboxes,yt=0,kt=He;yt<kt.length;yt+=1){var _t=kt[yt];if(!Ne.box[_t]){Ne.box[_t]=!0;var wt=4*_t;if(this._circleAndRectCollide(_e.x,_e.y,_e.radius,et[wt+0],et[wt+1],et[wt+2],et[wt+3])&&(!ye||ye(this.boxKeys[_t])))return le.push(!0),!0}}var vt=this.circleCells[te];if(vt!==null)for(var Dt=this.circles,Pt=0,Ft=vt;Pt<Ft.length;Pt+=1){var er=Ft[Pt];if(!Ne.circle[er]){Ne.circle[er]=!0;var cr=3*er;if(this._circlesCollide(Dt[cr],Dt[cr+1],Dt[cr+2],_e.x,_e.y,_e.radius)&&(!ye||ye(this.circleKeys[er])))return le.push(!0),!0}}},nr.prototype._forEachCell=function(M,O,R,j,te,le,pe,ye){for(var _e=this._convertToXCellCoord(M),Ne=this._convertToYCellCoord(O),He=this._convertToXCellCoord(R),et=this._convertToYCellCoord(j),yt=_e;yt<=He;yt++)for(var kt=Ne;kt<=et;kt++){var _t=this.xCellCount*kt+yt;if(te.call(this,M,O,R,j,_t,le,pe,ye))return}},nr.prototype._convertToXCellCoord=function(M){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(M*this.xScale)))},nr.prototype._convertToYCellCoord=function(M){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(M*this.yScale)))},nr.prototype._circlesCollide=function(M,O,R,j,te,le){var pe=j-M,ye=te-O,_e=R+le;return _e*_e>pe*pe+ye*ye},nr.prototype._circleAndRectCollide=function(M,O,R,j,te,le,pe){var ye=(le-j)/2,_e=Math.abs(M-(j+ye));if(_e>ye+R)return!1;var Ne=(pe-te)/2,He=Math.abs(O-(te+Ne));if(He>Ne+R)return!1;if(_e<=ye||He<=Ne)return!0;var et=_e-ye,yt=He-Ne;return et*et+yt*yt<=R*R};var rn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Zr(M,O){for(var R=0;R<M;R++){var j=O.length;O.resize(j+4),O.float32.set(rn,3*j)}}function bn(M,O,R){var j=O[0],te=O[1];return M[0]=R[0]*j+R[4]*te+R[12],M[1]=R[1]*j+R[5]*te+R[13],M[3]=R[3]*j+R[7]*te+R[15],M}var Dr=function(M,O,R){O===void 0&&(O=new nr(M.width+200,M.height+200,25)),R===void 0&&(R=new nr(M.width+200,M.height+200,25)),this.transform=M,this.grid=O,this.ignoredGrid=R,this.pitchfactor=Math.cos(M._pitch)*M.cameraToCenterDistance,this.screenRightBoundary=M.width+100,this.screenBottomBoundary=M.height+100,this.gridRightBoundary=M.width+200,this.gridBottomBoundary=M.height+200};function br(M,O,R){return O*(e.EXTENT/(M.tileSize*Math.pow(2,R-M.tileID.overscaledZ)))}Dr.prototype.placeCollisionBox=function(M,O,R,j,te){var le=this.projectAndGetPerspectiveRatio(j,M.anchorPointX,M.anchorPointY),pe=R*le.perspectiveRatio,ye=M.x1*pe+le.point.x,_e=M.y1*pe+le.point.y,Ne=M.x2*pe+le.point.x,He=M.y2*pe+le.point.y;return!this.isInsideGrid(ye,_e,Ne,He)||!O&&this.grid.hitTest(ye,_e,Ne,He,te)?{box:[],offscreen:!1}:{box:[ye,_e,Ne,He],offscreen:this.isOffscreen(ye,_e,Ne,He)}},Dr.prototype.placeCollisionCircles=function(M,O,R,j,te,le,pe,ye,_e,Ne,He,et,yt){var kt=[],_t=new e.Point(O.anchorX,O.anchorY),wt=Kt(_t,le),vt=yr(this.transform.cameraToCenterDistance,wt.signedDistanceFromCamera),Dt=(Ne?te/vt:te*vt)/e.ONE_EM,Pt=Kt(_t,pe).point,Ft=wr(Dt,j,O.lineOffsetX*Dt,O.lineOffsetY*Dt,!1,Pt,_t,O,R,pe,{}),er=!1,cr=!1,Ar=!0;if(Ft){for(var Tr=.5*et*vt+yt,Yr=new e.Point(-100,-100),Gr=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),an=new Nt,$r=Ft.first,In=Ft.last,jn=[],ia=$r.path.length-1;ia>=1;ia--)jn.push($r.path[ia]);for(var jr=1;jr<In.path.length;jr++)jn.push(In.path[jr]);var mn=2.5*Tr;if(ye){var Un=jn.map(function(mo){return Kt(mo,ye)});jn=Un.some(function(mo){return mo.signedDistanceFromCamera<=0})?[]:Un.map(function(mo){return mo.point})}var Fn=[];if(jn.length>0){for(var Jn=jn[0].clone(),sa=jn[0].clone(),ka=1;ka<jn.length;ka++)Jn.x=Math.min(Jn.x,jn[ka].x),Jn.y=Math.min(Jn.y,jn[ka].y),sa.x=Math.max(sa.x,jn[ka].x),sa.y=Math.max(sa.y,jn[ka].y);Fn=Jn.x>=Yr.x&&sa.x<=Gr.x&&Jn.y>=Yr.y&&sa.y<=Gr.y?[jn]:sa.x<Yr.x||Jn.x>Gr.x||sa.y<Yr.y||Jn.y>Gr.y?[]:e.clipLine([jn],Yr.x,Yr.y,Gr.x,Gr.y)}for(var qn=0,va=Fn;qn<va.length;qn+=1){var pa=va[qn];an.reset(pa,.25*Tr);var Ea=0;Ea=an.length<=.5*Tr?1:Math.ceil(an.paddedLength/mn)+1;for(var ya=0;ya<Ea;ya++){var La=ya/Math.max(Ea-1,1),Fa=an.lerp(La),si=Fa.x+100,Ei=Fa.y+100;kt.push(si,Ei,Tr,0);var Li=si-Tr,oi=Ei-Tr,_i=si+Tr,hi=Ei+Tr;if(Ar=Ar&&this.isOffscreen(Li,oi,_i,hi),cr=cr||this.isInsideGrid(Li,oi,_i,hi),!M&&this.grid.hitTestCircle(si,Ei,Tr,He)&&(er=!0,!_e))return{circles:[],offscreen:!1,collisionDetected:er}}}}return{circles:!_e&&er||!cr?[]:kt,offscreen:Ar,collisionDetected:er}},Dr.prototype.queryRenderedSymbols=function(M){if(M.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var O=[],R=1/0,j=1/0,te=-1/0,le=-1/0,pe=0,ye=M;pe<ye.length;pe+=1){var _e=ye[pe],Ne=new e.Point(_e.x+100,_e.y+100);R=Math.min(R,Ne.x),j=Math.min(j,Ne.y),te=Math.max(te,Ne.x),le=Math.max(le,Ne.y),O.push(Ne)}for(var He={},et={},yt=0,kt=this.grid.query(R,j,te,le).concat(this.ignoredGrid.query(R,j,te,le));yt<kt.length;yt+=1){var _t=kt[yt],wt=_t.key;if(He[wt.bucketInstanceId]===void 0&&(He[wt.bucketInstanceId]={}),!He[wt.bucketInstanceId][wt.featureIndex]){var vt=[new e.Point(_t.x1,_t.y1),new e.Point(_t.x2,_t.y1),new e.Point(_t.x2,_t.y2),new e.Point(_t.x1,_t.y2)];e.polygonIntersectsPolygon(O,vt)&&(He[wt.bucketInstanceId][wt.featureIndex]=!0,et[wt.bucketInstanceId]===void 0&&(et[wt.bucketInstanceId]=[]),et[wt.bucketInstanceId].push(wt.featureIndex))}}return et},Dr.prototype.insertCollisionBox=function(M,O,R,j,te){var le={bucketInstanceId:R,featureIndex:j,collisionGroupID:te};(O?this.ignoredGrid:this.grid).insert(le,M[0],M[1],M[2],M[3])},Dr.prototype.insertCollisionCircles=function(M,O,R,j,te){for(var le=O?this.ignoredGrid:this.grid,pe={bucketInstanceId:R,featureIndex:j,collisionGroupID:te},ye=0;ye<M.length;ye+=4)le.insertCircle(pe,M[ye],M[ye+1],M[ye+2])},Dr.prototype.projectAndGetPerspectiveRatio=function(M,O,R){var j=[O,R,0,1];return bn(j,j,M),{point:new e.Point((j[0]/j[3]+1)/2*this.transform.width+100,(-j[1]/j[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/j[3]*.5}},Dr.prototype.isOffscreen=function(M,O,R,j){return R<100||M>=this.screenRightBoundary||j<100||O>this.screenBottomBoundary},Dr.prototype.isInsideGrid=function(M,O,R,j){return R>=0&&M<this.gridRightBoundary&&j>=0&&O<this.gridBottomBoundary},Dr.prototype.getViewportMatrix=function(){var M=e.identity([]);return e.translate(M,M,[-100,-100,0]),M};var Xr=function(M,O,R,j){this.opacity=M?Math.max(0,Math.min(1,M.opacity+(M.placed?O:-O))):j&&R?1:0,this.placed=R};Xr.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var fn=function(M,O,R,j,te){this.text=new Xr(M?M.text:null,O,R,te),this.icon=new Xr(M?M.icon:null,O,j,te)};fn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Qr=function(M,O,R){this.text=M,this.icon=O,this.skipFade=R},un=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},Pn=function(M,O,R,j,te){this.bucketInstanceId=M,this.featureIndex=O,this.sourceLayerIndex=R,this.bucketIndex=j,this.tileID=te},kn=function(M){this.crossSourceCollisions=M,this.maxGroupID=0,this.collisionGroups={}};function Hn(M,O,R,j,te){var le=e.getAnchorAlignment(M),pe=-(le.horizontalAlign-.5)*O,ye=-(le.verticalAlign-.5)*R,_e=e.evaluateVariableOffset(M,j);return new e.Point(pe+_e[0]*te,ye+_e[1]*te)}function aa(M,O,R,j,te,le){var pe=M.x1,ye=M.x2,_e=M.y1,Ne=M.y2,He=M.anchorPointX,et=M.anchorPointY,yt=new e.Point(O,R);return j&&yt._rotate(te?le:-le),{x1:pe+yt.x,y1:_e+yt.y,x2:ye+yt.x,y2:Ne+yt.y,anchorPointX:He,anchorPointY:et}}kn.prototype.get=function(M){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[M]){var O=++this.maxGroupID;this.collisionGroups[M]={ID:O,predicate:function(R){return R.collisionGroupID===O}}}return this.collisionGroups[M]};var gt=function(M,O,R,j){this.transform=M.clone(),this.collisionIndex=new Dr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=O,this.retainedQueryData={},this.collisionGroups=new kn(R),this.collisionCircleArrays={},this.prevPlacement=j,j&&(j.prevPlacement=void 0),this.placedOrientations={}};function Qt(M,O,R,j,te){M.emplaceBack(O?1:0,R?1:0,j||0,te||0),M.emplaceBack(O?1:0,R?1:0,j||0,te||0),M.emplaceBack(O?1:0,R?1:0,j||0,te||0),M.emplaceBack(O?1:0,R?1:0,j||0,te||0)}gt.prototype.getBucketParts=function(M,O,R,j){var te=R.getBucket(O),le=R.latestFeatureIndex;if(te&&le&&O.id===te.layerIds[0]){var pe=R.collisionBoxArray,ye=te.layers[0].layout,_e=Math.pow(2,this.transform.zoom-R.tileID.overscaledZ),Ne=R.tileSize/e.EXTENT,He=this.transform.calculatePosMatrix(R.tileID.toUnwrapped()),et=ye.get("text-pitch-alignment")==="map",yt=ye.get("text-rotation-alignment")==="map",kt=br(R,1,this.transform.zoom),_t=Lr(He,et,yt,this.transform,kt),wt=null;if(et){var vt=dr(He,et,yt,this.transform,kt);wt=e.multiply([],this.transform.labelPlaneMatrix,vt)}this.retainedQueryData[te.bucketInstanceId]=new Pn(te.bucketInstanceId,le,te.sourceLayerIndex,te.index,R.tileID);var Dt={bucket:te,layout:ye,posMatrix:He,textLabelPlaneMatrix:_t,labelToScreenMatrix:wt,scale:_e,textPixelRatio:Ne,holdingForFade:R.holdingForFade(),collisionBoxArray:pe,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(te.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(te.sourceID)};if(j)for(var Pt=0,Ft=te.sortKeyRanges;Pt<Ft.length;Pt+=1){var er=Ft[Pt],cr=er.sortKey,Ar=er.symbolInstanceStart,Tr=er.symbolInstanceEnd;M.push({sortKey:cr,symbolInstanceStart:Ar,symbolInstanceEnd:Tr,parameters:Dt})}else M.push({symbolInstanceStart:0,symbolInstanceEnd:te.symbolInstances.length,parameters:Dt})}},gt.prototype.attemptAnchorPlacement=function(M,O,R,j,te,le,pe,ye,_e,Ne,He,et,yt,kt,_t){var wt,vt=[et.textOffset0,et.textOffset1],Dt=Hn(M,R,j,vt,te),Pt=this.collisionIndex.placeCollisionBox(aa(O,Dt.x,Dt.y,le,pe,this.transform.angle),He,ye,_e,Ne.predicate);if(!(_t&&this.collisionIndex.placeCollisionBox(aa(_t,Dt.x,Dt.y,le,pe,this.transform.angle),He,ye,_e,Ne.predicate).box.length===0)&&Pt.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[et.crossTileID]&&this.prevPlacement.placements[et.crossTileID]&&this.prevPlacement.placements[et.crossTileID].text&&(wt=this.prevPlacement.variableOffsets[et.crossTileID].anchor),this.variableOffsets[et.crossTileID]={textOffset:vt,width:R,height:j,anchor:M,textBoxScale:te,prevAnchor:wt},this.markUsedJustification(yt,M,et,kt),yt.allowVerticalPlacement&&(this.markUsedOrientation(yt,kt,et),this.placedOrientations[et.crossTileID]=kt),{shift:Dt,placedGlyphBoxes:Pt}},gt.prototype.placeLayerBucketPart=function(M,O,R){var j=this,te=M.parameters,le=te.bucket,pe=te.layout,ye=te.posMatrix,_e=te.textLabelPlaneMatrix,Ne=te.labelToScreenMatrix,He=te.textPixelRatio,et=te.holdingForFade,yt=te.collisionBoxArray,kt=te.partiallyEvaluatedTextSize,_t=te.collisionGroup,wt=pe.get("text-optional"),vt=pe.get("icon-optional"),Dt=pe.get("text-allow-overlap"),Pt=pe.get("icon-allow-overlap"),Ft=pe.get("text-rotation-alignment")==="map",er=pe.get("text-pitch-alignment")==="map",cr=pe.get("icon-text-fit")!=="none",Ar=pe.get("symbol-z-order")==="viewport-y",Tr=Dt&&(Pt||!le.hasIconData()||vt),Yr=Pt&&(Dt||!le.hasTextData()||wt);!le.collisionArrays&&yt&&le.deserializeCollisionBoxes(yt);var Gr=function(jr,mn){if(!O[jr.crossTileID])if(et)j.placements[jr.crossTileID]=new Qr(!1,!1,!1);else{var Un,Fn=!1,Jn=!1,sa=!0,ka=null,qn={box:null,offscreen:null},va={box:null,offscreen:null},pa=null,Ea=null,ya=0,La=0,Fa=0;mn.textFeatureIndex?ya=mn.textFeatureIndex:jr.useRuntimeCollisionCircles&&(ya=jr.featureIndex),mn.verticalTextFeatureIndex&&(La=mn.verticalTextFeatureIndex);var si=mn.textBox;if(si){var Ei=function(wi){var Lo=e.WritingMode.horizontal;if(le.allowVerticalPlacement&&!wi&&j.prevPlacement){var Co=j.prevPlacement.placedOrientations[jr.crossTileID];Co&&(j.placedOrientations[jr.crossTileID]=Co,Lo=Co,j.markUsedOrientation(le,Lo,jr))}return Lo},Li=function(wi,Lo){if(le.allowVerticalPlacement&&jr.numVerticalGlyphVertices>0&&mn.verticalTextBox)for(var Co=0,_l=le.writingModes;Co<_l.length&&(_l[Co]===e.WritingMode.vertical?(qn=Lo(),va=qn):qn=wi(),!(qn&&qn.box&&qn.box.length));Co+=1);else qn=wi()};if(pe.get("text-variable-anchor")){var oi=pe.get("text-variable-anchor");if(j.prevPlacement&&j.prevPlacement.variableOffsets[jr.crossTileID]){var _i=j.prevPlacement.variableOffsets[jr.crossTileID];oi.indexOf(_i.anchor)>0&&(oi=oi.filter(function(wi){return wi!==_i.anchor})).unshift(_i.anchor)}var hi=function(wi,Lo,Co){for(var _l=wi.x2-wi.x1,nu=wi.y2-wi.y1,Xo=jr.textBoxScale,Zl=cr&&!Pt?Lo:null,hl={box:[],offscreen:!1},au=Dt?2*oi.length:oi.length,Hs=0;Hs<au;++Hs){var iu=oi[Hs%oi.length],wl=Hs>=oi.length,Jl=j.attemptAnchorPlacement(iu,wi,_l,nu,Xo,Ft,er,He,ye,_t,wl,jr,le,Co,Zl);if(Jl&&(hl=Jl.placedGlyphBoxes)&&hl.box&&hl.box.length){Fn=!0,ka=Jl.shift;break}}return hl};Li(function(){return hi(si,mn.iconBox,e.WritingMode.horizontal)},function(){var wi=mn.verticalTextBox,Lo=qn&&qn.box&&qn.box.length;return le.allowVerticalPlacement&&!Lo&&jr.numVerticalGlyphVertices>0&&wi?hi(wi,mn.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),qn&&(Fn=qn.box,sa=qn.offscreen);var mo=Ei(qn&&qn.box);if(!Fn&&j.prevPlacement){var Vi=j.prevPlacement.variableOffsets[jr.crossTileID];Vi&&(j.variableOffsets[jr.crossTileID]=Vi,j.markUsedJustification(le,Vi.anchor,jr,mo))}}else{var Oo=function(wi,Lo){var Co=j.collisionIndex.placeCollisionBox(wi,Dt,He,ye,_t.predicate);return Co&&Co.box&&Co.box.length&&(j.markUsedOrientation(le,Lo,jr),j.placedOrientations[jr.crossTileID]=Lo),Co};Li(function(){return Oo(si,e.WritingMode.horizontal)},function(){var wi=mn.verticalTextBox;return le.allowVerticalPlacement&&jr.numVerticalGlyphVertices>0&&wi?Oo(wi,e.WritingMode.vertical):{box:null,offscreen:null}}),Ei(qn&&qn.box&&qn.box.length)}}if(Fn=(Un=qn)&&Un.box&&Un.box.length>0,sa=Un&&Un.offscreen,jr.useRuntimeCollisionCircles){var xs=le.text.placedSymbolArray.get(jr.centerJustifiedTextSymbolIndex),Ns=e.evaluateSizeForFeature(le.textSizeData,kt,xs),cl=pe.get("text-padding"),$s=jr.collisionCircleDiameter;pa=j.collisionIndex.placeCollisionCircles(Dt,xs,le.lineVertexArray,le.glyphOffsetArray,Ns,ye,_e,Ne,R,er,_t.predicate,$s,cl),Fn=Dt||pa.circles.length>0&&!pa.collisionDetected,sa=sa&&pa.offscreen}if(mn.iconFeatureIndex&&(Fa=mn.iconFeatureIndex),mn.iconBox){var el=function(wi){var Lo=cr&&ka?aa(wi,ka.x,ka.y,Ft,er,j.transform.angle):wi;return j.collisionIndex.placeCollisionBox(Lo,Pt,He,ye,_t.predicate)};Jn=va&&va.box&&va.box.length&&mn.verticalIconBox?(Ea=el(mn.verticalIconBox)).box.length>0:(Ea=el(mn.iconBox)).box.length>0,sa=sa&&Ea.offscreen}var vo=wt||jr.numHorizontalGlyphVertices===0&&jr.numVerticalGlyphVertices===0,qs=vt||jr.numIconVertices===0;if(vo||qs?qs?vo||(Jn=Jn&&Fn):Fn=Jn&&Fn:Jn=Fn=Jn&&Fn,Fn&&Un&&Un.box&&(va&&va.box&&La?j.collisionIndex.insertCollisionBox(Un.box,pe.get("text-ignore-placement"),le.bucketInstanceId,La,_t.ID):j.collisionIndex.insertCollisionBox(Un.box,pe.get("text-ignore-placement"),le.bucketInstanceId,ya,_t.ID)),Jn&&Ea&&j.collisionIndex.insertCollisionBox(Ea.box,pe.get("icon-ignore-placement"),le.bucketInstanceId,Fa,_t.ID),pa&&(Fn&&j.collisionIndex.insertCollisionCircles(pa.circles,pe.get("text-ignore-placement"),le.bucketInstanceId,ya,_t.ID),R)){var ul=le.bucketInstanceId,rs=j.collisionCircleArrays[ul];rs===void 0&&(rs=j.collisionCircleArrays[ul]=new un);for(var fl=0;fl<pa.circles.length;fl+=4)rs.circles.push(pa.circles[fl+0]),rs.circles.push(pa.circles[fl+1]),rs.circles.push(pa.circles[fl+2]),rs.circles.push(pa.collisionDetected?1:0)}j.placements[jr.crossTileID]=new Qr(Fn||Tr,Jn||Yr,sa||le.justReloaded),O[jr.crossTileID]=!0}};if(Ar)for(var an=le.getSortedSymbolIndexes(this.transform.angle),$r=an.length-1;$r>=0;--$r){var In=an[$r];Gr(le.symbolInstances.get(In),le.collisionArrays[In])}else for(var jn=M.symbolInstanceStart;jn<M.symbolInstanceEnd;jn++)Gr(le.symbolInstances.get(jn),le.collisionArrays[jn]);if(R&&le.bucketInstanceId in this.collisionCircleArrays){var ia=this.collisionCircleArrays[le.bucketInstanceId];e.invert(ia.invProjMatrix,ye),ia.viewportMatrix=this.collisionIndex.getViewportMatrix()}le.justReloaded=!1},gt.prototype.markUsedJustification=function(M,O,R,j){var te,le={left:R.leftJustifiedTextSymbolIndex,center:R.centerJustifiedTextSymbolIndex,right:R.rightJustifiedTextSymbolIndex};te=j===e.WritingMode.vertical?R.verticalPlacedTextSymbolIndex:le[e.getAnchorJustification(O)];for(var pe=0,ye=[R.leftJustifiedTextSymbolIndex,R.centerJustifiedTextSymbolIndex,R.rightJustifiedTextSymbolIndex,R.verticalPlacedTextSymbolIndex];pe<ye.length;pe+=1){var _e=ye[pe];_e>=0&&(M.text.placedSymbolArray.get(_e).crossTileID=te>=0&&_e!==te?0:R.crossTileID)}},gt.prototype.markUsedOrientation=function(M,O,R){for(var j=O===e.WritingMode.horizontal||O===e.WritingMode.horizontalOnly?O:0,te=O===e.WritingMode.vertical?O:0,le=0,pe=[R.leftJustifiedTextSymbolIndex,R.centerJustifiedTextSymbolIndex,R.rightJustifiedTextSymbolIndex];le<pe.length;le+=1){var ye=pe[le];M.text.placedSymbolArray.get(ye).placedOrientation=j}R.verticalPlacedTextSymbolIndex&&(M.text.placedSymbolArray.get(R.verticalPlacedTextSymbolIndex).placedOrientation=te)},gt.prototype.commit=function(M){this.commitTime=M,this.zoomAtLastRecencyCheck=this.transform.zoom;var O=this.prevPlacement,R=!1;this.prevZoomAdjustment=O?O.zoomAdjustment(this.transform.zoom):0;var j=O?O.symbolFadeChange(M):1,te=O?O.opacities:{},le=O?O.variableOffsets:{},pe=O?O.placedOrientations:{};for(var ye in this.placements){var _e=this.placements[ye],Ne=te[ye];Ne?(this.opacities[ye]=new fn(Ne,j,_e.text,_e.icon),R=R||_e.text!==Ne.text.placed||_e.icon!==Ne.icon.placed):(this.opacities[ye]=new fn(null,j,_e.text,_e.icon,_e.skipFade),R=R||_e.text||_e.icon)}for(var He in te){var et=te[He];if(!this.opacities[He]){var yt=new fn(et,j,!1,!1);yt.isHidden()||(this.opacities[He]=yt,R=R||et.text.placed||et.icon.placed)}}for(var kt in le)this.variableOffsets[kt]||!this.opacities[kt]||this.opacities[kt].isHidden()||(this.variableOffsets[kt]=le[kt]);for(var _t in pe)this.placedOrientations[_t]||!this.opacities[_t]||this.opacities[_t].isHidden()||(this.placedOrientations[_t]=pe[_t]);R?this.lastPlacementChangeTime=M:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=O?O.lastPlacementChangeTime:M)},gt.prototype.updateLayerOpacities=function(M,O){for(var R={},j=0,te=O;j<te.length;j+=1){var le=te[j],pe=le.getBucket(M);pe&&le.latestFeatureIndex&&M.id===pe.layerIds[0]&&this.updateBucketOpacities(pe,R,le.collisionBoxArray)}},gt.prototype.updateBucketOpacities=function(M,O,R){var j=this;M.hasTextData()&&M.text.opacityVertexArray.clear(),M.hasIconData()&&M.icon.opacityVertexArray.clear(),M.hasIconCollisionBoxData()&&M.iconCollisionBox.collisionVertexArray.clear(),M.hasTextCollisionBoxData()&&M.textCollisionBox.collisionVertexArray.clear();var te=M.layers[0].layout,le=new fn(null,0,!1,!1,!0),pe=te.get("text-allow-overlap"),ye=te.get("icon-allow-overlap"),_e=te.get("text-variable-anchor"),Ne=te.get("text-rotation-alignment")==="map",He=te.get("text-pitch-alignment")==="map",et=te.get("icon-text-fit")!=="none",yt=new fn(null,0,pe&&(ye||!M.hasIconData()||te.get("icon-optional")),ye&&(pe||!M.hasTextData()||te.get("text-optional")),!0);!M.collisionArrays&&R&&(M.hasIconCollisionBoxData()||M.hasTextCollisionBoxData())&&M.deserializeCollisionBoxes(R);for(var kt=function(Dt,Pt,Ft){for(var er=0;er<Pt/4;er++)Dt.opacityVertexArray.emplaceBack(Ft)},_t=function(Dt){var Pt=M.symbolInstances.get(Dt),Ft=Pt.numHorizontalGlyphVertices,er=Pt.numVerticalGlyphVertices,cr=Pt.crossTileID,Ar=O[cr],Tr=j.opacities[cr];Ar?Tr=le:Tr||(Tr=yt,j.opacities[cr]=Tr),O[cr]=!0;var Yr=Ft>0||er>0,Gr=Pt.numIconVertices>0,an=j.placedOrientations[Pt.crossTileID],$r=an===e.WritingMode.vertical,In=an===e.WritingMode.horizontal||an===e.WritingMode.horizontalOnly;if(Yr){var jn=mr(Tr.text),ia=$r?_r:jn;kt(M.text,Ft,ia);var jr=In?_r:jn;kt(M.text,er,jr);var mn=Tr.text.isHidden();[Pt.rightJustifiedTextSymbolIndex,Pt.centerJustifiedTextSymbolIndex,Pt.leftJustifiedTextSymbolIndex].forEach(function(Fa){Fa>=0&&(M.text.placedSymbolArray.get(Fa).hidden=mn||$r?1:0)}),Pt.verticalPlacedTextSymbolIndex>=0&&(M.text.placedSymbolArray.get(Pt.verticalPlacedTextSymbolIndex).hidden=mn||In?1:0);var Un=j.variableOffsets[Pt.crossTileID];Un&&j.markUsedJustification(M,Un.anchor,Pt,an);var Fn=j.placedOrientations[Pt.crossTileID];Fn&&(j.markUsedJustification(M,"left",Pt,Fn),j.markUsedOrientation(M,Fn,Pt))}if(Gr){var Jn=mr(Tr.icon),sa=!(et&&Pt.verticalPlacedIconSymbolIndex&&$r);if(Pt.placedIconSymbolIndex>=0){var ka=sa?Jn:_r;kt(M.icon,Pt.numIconVertices,ka),M.icon.placedSymbolArray.get(Pt.placedIconSymbolIndex).hidden=Tr.icon.isHidden()}if(Pt.verticalPlacedIconSymbolIndex>=0){var qn=sa?_r:Jn;kt(M.icon,Pt.numVerticalIconVertices,qn),M.icon.placedSymbolArray.get(Pt.verticalPlacedIconSymbolIndex).hidden=Tr.icon.isHidden()}}if(M.hasIconCollisionBoxData()||M.hasTextCollisionBoxData()){var va=M.collisionArrays[Dt];if(va){var pa=new e.Point(0,0);if(va.textBox||va.verticalTextBox){var Ea=!0;if(_e){var ya=j.variableOffsets[cr];ya?(pa=Hn(ya.anchor,ya.width,ya.height,ya.textOffset,ya.textBoxScale),Ne&&pa._rotate(He?j.transform.angle:-j.transform.angle)):Ea=!1}va.textBox&&Qt(M.textCollisionBox.collisionVertexArray,Tr.text.placed,!Ea||$r,pa.x,pa.y),va.verticalTextBox&&Qt(M.textCollisionBox.collisionVertexArray,Tr.text.placed,!Ea||In,pa.x,pa.y)}var La=!!(!In&&va.verticalIconBox);va.iconBox&&Qt(M.iconCollisionBox.collisionVertexArray,Tr.icon.placed,La,et?pa.x:0,et?pa.y:0),va.verticalIconBox&&Qt(M.iconCollisionBox.collisionVertexArray,Tr.icon.placed,!La,et?pa.x:0,et?pa.y:0)}}},wt=0;wt<M.symbolInstances.length;wt++)_t(wt);if(M.sortFeatures(this.transform.angle),this.retainedQueryData[M.bucketInstanceId]&&(this.retainedQueryData[M.bucketInstanceId].featureSortOrder=M.featureSortOrder),M.hasTextData()&&M.text.opacityVertexBuffer&&M.text.opacityVertexBuffer.updateData(M.text.opacityVertexArray),M.hasIconData()&&M.icon.opacityVertexBuffer&&M.icon.opacityVertexBuffer.updateData(M.icon.opacityVertexArray),M.hasIconCollisionBoxData()&&M.iconCollisionBox.collisionVertexBuffer&&M.iconCollisionBox.collisionVertexBuffer.updateData(M.iconCollisionBox.collisionVertexArray),M.hasTextCollisionBoxData()&&M.textCollisionBox.collisionVertexBuffer&&M.textCollisionBox.collisionVertexBuffer.updateData(M.textCollisionBox.collisionVertexArray),M.bucketInstanceId in this.collisionCircleArrays){var vt=this.collisionCircleArrays[M.bucketInstanceId];M.placementInvProjMatrix=vt.invProjMatrix,M.placementViewportMatrix=vt.viewportMatrix,M.collisionCircleArray=vt.circles,delete this.collisionCircleArrays[M.bucketInstanceId]}},gt.prototype.symbolFadeChange=function(M){return this.fadeDuration===0?1:(M-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},gt.prototype.zoomAdjustment=function(M){return Math.max(0,(this.transform.zoom-M)/1.5)},gt.prototype.hasTransitions=function(M){return this.stale||M-this.lastPlacementChangeTime<this.fadeDuration},gt.prototype.stillRecent=function(M,O){var R=this.zoomAtLastRecencyCheck===O?1-this.zoomAdjustment(O):1;return this.zoomAtLastRecencyCheck=O,this.commitTime+this.fadeDuration*R>M},gt.prototype.setStale=function(){this.stale=!0};var Zt=Math.pow(2,25),pr=Math.pow(2,24),Mr=Math.pow(2,17),Vr=Math.pow(2,16),kr=Math.pow(2,9),ur=Math.pow(2,8),Ir=Math.pow(2,1);function mr(M){if(M.opacity===0&&!M.placed)return 0;if(M.opacity===1&&M.placed)return 4294967295;var O=M.placed?1:0,R=Math.floor(127*M.opacity);return R*Zt+O*pr+R*Mr+O*Vr+R*kr+O*ur+R*Ir+O}var _r=0,Nr=function(M){this._sortAcrossTiles=M.layout.get("symbol-z-order")!=="viewport-y"&&M.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Nr.prototype.continuePlacement=function(M,O,R,j,te){for(var le=this._bucketParts;this._currentTileIndex<M.length;){var pe=M[this._currentTileIndex];if(O.getBucketParts(le,j,pe,this._sortAcrossTiles),this._currentTileIndex++,te())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,le.sort(function(_e,Ne){return _e.sortKey-Ne.sortKey}));this._currentPartIndex<le.length;){var ye=le[this._currentPartIndex];if(O.placeLayerBucketPart(ye,this._seenCrossTileIDs,R),this._currentPartIndex++,te())return!0}return!1};var vn=function(M,O,R,j,te,le,pe){this.placement=new gt(M,te,le,pe),this._currentPlacementIndex=O.length-1,this._forceFullPlacement=R,this._showCollisionBoxes=j,this._done=!1};vn.prototype.isDone=function(){return this._done},vn.prototype.continuePlacement=function(M,O,R){for(var j=this,te=e.browser.now(),le=function(){var _e=e.browser.now()-te;return!j._forceFullPlacement&&_e>2};this._currentPlacementIndex>=0;){var pe=O[M[this._currentPlacementIndex]],ye=this.placement.collisionIndex.transform.zoom;if(pe.type==="symbol"&&(!pe.minzoom||pe.minzoom<=ye)&&(!pe.maxzoom||pe.maxzoom>ye)){if(this._inProgressLayer||(this._inProgressLayer=new Nr(pe)),this._inProgressLayer.continuePlacement(R[pe.source],this.placement,this._showCollisionBoxes,pe,le))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},vn.prototype.commit=function(M){return this.placement.commit(M),this.placement};var xn=512/e.EXTENT/2,wn=function(M,O,R){this.tileID=M,this.indexedSymbolInstances={},this.bucketInstanceId=R;for(var j=0;j<O.length;j++){var te=O.get(j),le=te.key;this.indexedSymbolInstances[le]||(this.indexedSymbolInstances[le]=[]),this.indexedSymbolInstances[le].push({crossTileID:te.crossTileID,coord:this.getScaledCoordinates(te,M)})}};wn.prototype.getScaledCoordinates=function(M,O){var R=O.canonical.z-this.tileID.canonical.z,j=xn/Math.pow(2,R);return{x:Math.floor((O.canonical.x*e.EXTENT+M.anchorX)*j),y:Math.floor((O.canonical.y*e.EXTENT+M.anchorY)*j)}},wn.prototype.findMatches=function(M,O,R){for(var j=this.tileID.canonical.z<O.canonical.z?1:Math.pow(2,this.tileID.canonical.z-O.canonical.z),te=0;te<M.length;te++){var le=M.get(te);if(!le.crossTileID){var pe=this.indexedSymbolInstances[le.key];if(pe)for(var ye=this.getScaledCoordinates(le,O),_e=0,Ne=pe;_e<Ne.length;_e+=1){var He=Ne[_e];if(Math.abs(He.coord.x-ye.x)<=j&&Math.abs(He.coord.y-ye.y)<=j&&!R[He.crossTileID]){R[He.crossTileID]=!0,le.crossTileID=He.crossTileID;break}}}}};var ln=function(){this.maxCrossTileID=0};ln.prototype.generate=function(){return++this.maxCrossTileID};var zn=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};zn.prototype.handleWrapJump=function(M){var O=Math.round((M-this.lng)/360);if(O!==0)for(var R in this.indexes){var j=this.indexes[R],te={};for(var le in j){var pe=j[le];pe.tileID=pe.tileID.unwrapTo(pe.tileID.wrap+O),te[pe.tileID.key]=pe}this.indexes[R]=te}this.lng=M},zn.prototype.addBucket=function(M,O,R){if(this.indexes[M.overscaledZ]&&this.indexes[M.overscaledZ][M.key]){if(this.indexes[M.overscaledZ][M.key].bucketInstanceId===O.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(M.overscaledZ,this.indexes[M.overscaledZ][M.key])}for(var j=0;j<O.symbolInstances.length;j++)O.symbolInstances.get(j).crossTileID=0;this.usedCrossTileIDs[M.overscaledZ]||(this.usedCrossTileIDs[M.overscaledZ]={});var te=this.usedCrossTileIDs[M.overscaledZ];for(var le in this.indexes){var pe=this.indexes[le];if(Number(le)>M.overscaledZ)for(var ye in pe){var _e=pe[ye];_e.tileID.isChildOf(M)&&_e.findMatches(O.symbolInstances,M,te)}else{var Ne=pe[M.scaledTo(Number(le)).key];Ne&&Ne.findMatches(O.symbolInstances,M,te)}}for(var He=0;He<O.symbolInstances.length;He++){var et=O.symbolInstances.get(He);et.crossTileID||(et.crossTileID=R.generate(),te[et.crossTileID]=!0)}return this.indexes[M.overscaledZ]===void 0&&(this.indexes[M.overscaledZ]={}),this.indexes[M.overscaledZ][M.key]=new wn(M,O.symbolInstances,O.bucketInstanceId),!0},zn.prototype.removeBucketCrossTileIDs=function(M,O){for(var R in O.indexedSymbolInstances)for(var j=0,te=O.indexedSymbolInstances[R];j<te.length;j+=1){var le=te[j];delete this.usedCrossTileIDs[M][le.crossTileID]}},zn.prototype.removeStaleBuckets=function(M){var O=!1;for(var R in this.indexes){var j=this.indexes[R];for(var te in j)M[j[te].bucketInstanceId]||(this.removeBucketCrossTileIDs(R,j[te]),delete j[te],O=!0)}return O};var ca=function(){this.layerIndexes={},this.crossTileIDs=new ln,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ca.prototype.addLayer=function(M,O,R){var j=this.layerIndexes[M.id];j===void 0&&(j=this.layerIndexes[M.id]=new zn);var te=!1,le={};j.handleWrapJump(R);for(var pe=0,ye=O;pe<ye.length;pe+=1){var _e=ye[pe],Ne=_e.getBucket(M);Ne&&M.id===Ne.layerIds[0]&&(Ne.bucketInstanceId||(Ne.bucketInstanceId=++this.maxBucketInstanceId),j.addBucket(_e.tileID,Ne,this.crossTileIDs)&&(te=!0),le[Ne.bucketInstanceId]=!0)}return j.removeStaleBuckets(le)&&(te=!0),te},ca.prototype.pruneUnusedLayers=function(M){var O={};for(var R in M.forEach(function(j){O[j]=!0}),this.layerIndexes)O[R]||delete this.layerIndexes[R]};var Kn=function(M,O){return e.emitValidationErrors(M,O&&O.filter(function(R){return R.identifier!=="source.canvas"}))},On=e.pick(Ut,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Nn=e.pick(Ut,["setCenter","setZoom","setBearing","setPitch"]),ba=function(){var M={},O=e.styleSpec.$version;for(var R in e.styleSpec.$root){var j=e.styleSpec.$root[R];if(j.required){var te=null;(te=R==="version"?O:j.type==="array"?[]:{})!=null&&(M[R]=te)}}return M}(),Wn=function(M){function O(R,j){var te=this;j===void 0&&(j={}),M.call(this),this.map=R,this.dispatcher=new P(st(),this),this.imageManager=new y,this.imageManager.setEventedParent(this),this.glyphManager=new b(R._requestManager,j.localIdeographFontFamily),this.lineAtlas=new S(256,512),this.crossTileSymbolIndex=new ca,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var le=this;this._rtlTextPluginCallback=O.registerForPluginStateChange(function(pe){var ye={pluginStatus:pe.pluginStatus,pluginURL:pe.pluginURL};le.dispatcher.broadcast("syncRTLPluginState",ye,function(_e,Ne){if(e.triggerPluginCompletionEvent(_e),Ne&&Ne.every(function(et){return et}))for(var He in le.sourceCaches)le.sourceCaches[He].reload()})}),this.on("data",function(pe){if(pe.dataType==="source"&&pe.sourceDataType==="metadata"){var ye=te.sourceCaches[pe.sourceId];if(ye){var _e=ye.getSource();if(_e&&_e.vectorLayerIds)for(var Ne in te._layers){var He=te._layers[Ne];He.source===_e.id&&te._validateLayer(He)}}}})}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.loadURL=function(R,j){var te=this;j===void 0&&(j={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var le=typeof j.validate=="boolean"?j.validate:!e.isMapboxURL(R);R=this.map._requestManager.normalizeStyleURL(R,j.accessToken);var pe=this.map._requestManager.transformRequest(R,e.ResourceType.Style);this._request=e.getJSON(pe,function(ye,_e){te._request=null,ye?te.fire(new e.ErrorEvent(ye)):_e&&te._load(_e,le)})},O.prototype.loadJSON=function(R,j){var te=this;j===void 0&&(j={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){te._request=null,te._load(R,j.validate!==!1)})},O.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(ba,!1)},O.prototype._load=function(R,j){if(!j||!Kn(this,e.validateStyle(R))){for(var te in this._loaded=!0,this.stylesheet=R,R.sources)this.addSource(te,R.sources[te],{validate:!1});R.sprite?this._loadSprite(R.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(R.glyphs);var le=jt(this.stylesheet.layers);this._order=le.map(function(Ne){return Ne.id}),this._layers={},this._serializedLayers={};for(var pe=0,ye=le;pe<ye.length;pe+=1){var _e=ye[pe];(_e=e.createStyleLayer(_e)).setEventedParent(this,{layer:{id:_e.id}}),this._layers[_e.id]=_e,this._serializedLayers[_e.id]=_e.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new C(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},O.prototype._loadSprite=function(R){var j=this;this._spriteRequest=function(te,le,pe){var ye,_e,Ne,He=e.browser.devicePixelRatio>1?"@2x":"",et=e.getJSON(le.transformRequest(le.normalizeSpriteURL(te,He,".json"),e.ResourceType.SpriteJSON),function(_t,wt){et=null,Ne||(Ne=_t,ye=wt,kt())}),yt=e.getImage(le.transformRequest(le.normalizeSpriteURL(te,He,".png"),e.ResourceType.SpriteImage),function(_t,wt){yt=null,Ne||(Ne=_t,_e=wt,kt())});function kt(){if(Ne)pe(Ne);else if(ye&&_e){var _t=e.browser.getImageData(_e),wt={};for(var vt in ye){var Dt=ye[vt],Pt=Dt.width,Ft=Dt.height,er=Dt.x,cr=Dt.y,Ar=Dt.sdf,Tr=Dt.pixelRatio,Yr=Dt.stretchX,Gr=Dt.stretchY,an=Dt.content,$r=new e.RGBAImage({width:Pt,height:Ft});e.RGBAImage.copy(_t,$r,{x:er,y:cr},{x:0,y:0},{width:Pt,height:Ft}),wt[vt]={data:$r,pixelRatio:Tr,sdf:Ar,stretchX:Yr,stretchY:Gr,content:an}}pe(null,wt)}}return{cancel:function(){et&&(et.cancel(),et=null),yt&&(yt.cancel(),yt=null)}}}(R,this.map._requestManager,function(te,le){if(j._spriteRequest=null,te)j.fire(new e.ErrorEvent(te));else if(le)for(var pe in le)j.imageManager.addImage(pe,le[pe]);j.imageManager.setLoaded(!0),j._availableImages=j.imageManager.listImages(),j.dispatcher.broadcast("setImages",j._availableImages),j.fire(new e.Event("data",{dataType:"style"}))})},O.prototype._validateLayer=function(R){var j=this.sourceCaches[R.source];if(j){var te=R.sourceLayer;if(te){var le=j.getSource();(le.type==="geojson"||le.vectorLayerIds&&le.vectorLayerIds.indexOf(te)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+te+'" does not exist on source "'+le.id+'" as specified by style layer "'+R.id+'"')))}}},O.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var R in this.sourceCaches)if(!this.sourceCaches[R].loaded())return!1;return!!this.imageManager.isLoaded()},O.prototype._serializeLayers=function(R){for(var j=[],te=0,le=R;te<le.length;te+=1){var pe=le[te],ye=this._layers[pe];ye.type!=="custom"&&j.push(ye.serialize())}return j},O.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var R in this.sourceCaches)if(this.sourceCaches[R].hasTransition())return!0;for(var j in this._layers)if(this._layers[j].hasTransition())return!0;return!1},O.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},O.prototype.update=function(R){if(this._loaded){var j=this._changed;if(this._changed){var te=Object.keys(this._updatedLayers),le=Object.keys(this._removedLayers);for(var pe in(te.length||le.length)&&this._updateWorkerLayers(te,le),this._updatedSources){var ye=this._updatedSources[pe];ye==="reload"?this._reloadSource(pe):ye==="clear"&&this._clearSource(pe)}for(var _e in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[_e].updateTransitions(R);this.light.updateTransitions(R),this._resetUpdates()}for(var Ne in this.sourceCaches)this.sourceCaches[Ne].used=!1;for(var He=0,et=this._order;He<et.length;He+=1){var yt=et[He],kt=this._layers[yt];kt.recalculate(R,this._availableImages),!kt.isHidden(R.zoom)&&kt.source&&(this.sourceCaches[kt.source].used=!0)}this.light.recalculate(R),this.z=R.zoom,j&&this.fire(new e.Event("data",{dataType:"style"}))}},O.prototype._updateTilesForChangedImages=function(){var R=Object.keys(this._changedImages);if(R.length){for(var j in this.sourceCaches)this.sourceCaches[j].reloadTilesForDependencies(["icons","patterns"],R);this._changedImages={}}},O.prototype._updateWorkerLayers=function(R,j){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(R),removedIds:j})},O.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},O.prototype.setState=function(R){var j=this;if(this._checkLoaded(),Kn(this,e.validateStyle(R)))return!1;(R=e.clone$1(R)).layers=jt(R.layers);var te=ar(this.serialize(),R).filter(function(pe){return!(pe.command in Nn)});if(te.length===0)return!1;var le=te.filter(function(pe){return!(pe.command in On)});if(le.length>0)throw new Error("Unimplemented: "+le.map(function(pe){return pe.command}).join(", ")+".");return te.forEach(function(pe){pe.command!=="setTransition"&&j[pe.command].apply(j,pe.args)}),this.stylesheet=R,!0},O.prototype.addImage=function(R,j){if(this.getImage(R))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(R,j),this._availableImages=this.imageManager.listImages(),this._changedImages[R]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},O.prototype.updateImage=function(R,j){this.imageManager.updateImage(R,j)},O.prototype.getImage=function(R){return this.imageManager.getImage(R)},O.prototype.removeImage=function(R){if(!this.getImage(R))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(R),this._availableImages=this.imageManager.listImages(),this._changedImages[R]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},O.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},O.prototype.addSource=function(R,j,te){var le=this;if(te===void 0&&(te={}),this._checkLoaded(),this.sourceCaches[R]!==void 0)throw new Error("There is already a source with this ID");if(!j.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(j).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(j.type)>=0)||!this._validate(e.validateStyle.source,"sources."+R,j,null,te)){this.map&&this.map._collectResourceTiming&&(j.collectResourceTiming=!0);var pe=this.sourceCaches[R]=new qe(R,j,this.dispatcher);pe.style=this,pe.setEventedParent(this,function(){return{isSourceLoaded:le.loaded(),source:pe.serialize(),sourceId:R}}),pe.onAdd(this.map),this._changed=!0}},O.prototype.removeSource=function(R){if(this._checkLoaded(),this.sourceCaches[R]===void 0)throw new Error("There is no source with this ID");for(var j in this._layers)if(this._layers[j].source===R)return this.fire(new e.ErrorEvent(new Error('Source "'+R+'" cannot be removed while layer "'+j+'" is using it.')));var te=this.sourceCaches[R];delete this.sourceCaches[R],delete this._updatedSources[R],te.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:R})),te.setEventedParent(null),te.clearTiles(),te.onRemove&&te.onRemove(this.map),this._changed=!0},O.prototype.setGeoJSONSourceData=function(R,j){this._checkLoaded(),this.sourceCaches[R].getSource().setData(j),this._changed=!0},O.prototype.getSource=function(R){return this.sourceCaches[R]&&this.sourceCaches[R].getSource()},O.prototype.addLayer=function(R,j,te){te===void 0&&(te={}),this._checkLoaded();var le=R.id;if(this.getLayer(le))this.fire(new e.ErrorEvent(new Error('Layer with id "'+le+'" already exists on this map')));else{var pe;if(R.type==="custom"){if(Kn(this,e.validateCustomStyleLayer(R)))return;pe=e.createStyleLayer(R)}else{if(typeof R.source=="object"&&(this.addSource(le,R.source),R=e.clone$1(R),R=e.extend(R,{source:le})),this._validate(e.validateStyle.layer,"layers."+le,R,{arrayIndex:-1},te))return;pe=e.createStyleLayer(R),this._validateLayer(pe),pe.setEventedParent(this,{layer:{id:le}}),this._serializedLayers[pe.id]=pe.serialize()}var ye=j?this._order.indexOf(j):this._order.length;if(j&&ye===-1)this.fire(new e.ErrorEvent(new Error('Layer with id "'+j+'" does not exist on this map.')));else{if(this._order.splice(ye,0,le),this._layerOrderChanged=!0,this._layers[le]=pe,this._removedLayers[le]&&pe.source&&pe.type!=="custom"){var _e=this._removedLayers[le];delete this._removedLayers[le],_e.type!==pe.type?this._updatedSources[pe.source]="clear":(this._updatedSources[pe.source]="reload",this.sourceCaches[pe.source].pause())}this._updateLayer(pe),pe.onAdd&&pe.onAdd(this.map)}}},O.prototype.moveLayer=function(R,j){if(this._checkLoaded(),this._changed=!0,this._layers[R]){if(R!==j){var te=this._order.indexOf(R);this._order.splice(te,1);var le=j?this._order.indexOf(j):this._order.length;j&&le===-1?this.fire(new e.ErrorEvent(new Error('Layer with id "'+j+'" does not exist on this map.'))):(this._order.splice(le,0,R),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be moved.")))},O.prototype.removeLayer=function(R){this._checkLoaded();var j=this._layers[R];if(j){j.setEventedParent(null);var te=this._order.indexOf(R);this._order.splice(te,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[R]=j,delete this._layers[R],delete this._serializedLayers[R],delete this._updatedLayers[R],delete this._updatedPaintProps[R],j.onRemove&&j.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be removed.")))},O.prototype.getLayer=function(R){return this._layers[R]},O.prototype.hasLayer=function(R){return R in this._layers},O.prototype.setLayerZoomRange=function(R,j,te){this._checkLoaded();var le=this.getLayer(R);le?le.minzoom===j&&le.maxzoom===te||(j!=null&&(le.minzoom=j),te!=null&&(le.maxzoom=te),this._updateLayer(le)):this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot have zoom extent.")))},O.prototype.setFilter=function(R,j,te){te===void 0&&(te={}),this._checkLoaded();var le=this.getLayer(R);if(le){if(!e.deepEqual(le.filter,j))return j==null?(le.filter=void 0,void this._updateLayer(le)):void(this._validate(e.validateStyle.filter,"layers."+le.id+".filter",j,null,te)||(le.filter=e.clone$1(j),this._updateLayer(le)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be filtered.")))},O.prototype.getFilter=function(R){return e.clone$1(this.getLayer(R).filter)},O.prototype.setLayoutProperty=function(R,j,te,le){le===void 0&&(le={}),this._checkLoaded();var pe=this.getLayer(R);pe?e.deepEqual(pe.getLayoutProperty(j),te)||(pe.setLayoutProperty(j,te,le),this._updateLayer(pe)):this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be styled.")))},O.prototype.getLayoutProperty=function(R,j){var te=this.getLayer(R);if(te)return te.getLayoutProperty(j);this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style.")))},O.prototype.setPaintProperty=function(R,j,te,le){le===void 0&&(le={}),this._checkLoaded();var pe=this.getLayer(R);pe?e.deepEqual(pe.getPaintProperty(j),te)||(pe.setPaintProperty(j,te,le)&&this._updateLayer(pe),this._changed=!0,this._updatedPaintProps[R]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be styled.")))},O.prototype.getPaintProperty=function(R,j){return this.getLayer(R).getPaintProperty(j)},O.prototype.setFeatureState=function(R,j){this._checkLoaded();var te=R.source,le=R.sourceLayer,pe=this.sourceCaches[te];if(pe!==void 0){var ye=pe.getSource().type;ye==="geojson"&&le?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ye!=="vector"||le?(R.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),pe.setFeatureState(le,R.id,j)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+te+"' does not exist in the map's style.")))},O.prototype.removeFeatureState=function(R,j){this._checkLoaded();var te=R.source,le=this.sourceCaches[te];if(le!==void 0){var pe=le.getSource().type,ye=pe==="vector"?R.sourceLayer:void 0;pe!=="vector"||ye?j&&typeof R.id!="string"&&typeof R.id!="number"?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):le.removeFeatureState(ye,R.id,j):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+te+"' does not exist in the map's style.")))},O.prototype.getFeatureState=function(R){this._checkLoaded();var j=R.source,te=R.sourceLayer,le=this.sourceCaches[j];if(le!==void 0){if(le.getSource().type!=="vector"||te)return R.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),le.getFeatureState(te,R.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+j+"' does not exist in the map's style.")))},O.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},O.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(R){return R.serialize()}),layers:this._serializeLayers(this._order)},function(R){return R!==void 0})},O.prototype._updateLayer=function(R){this._updatedLayers[R.id]=!0,R.source&&!this._updatedSources[R.source]&&this.sourceCaches[R.source].getSource().type!=="raster"&&(this._updatedSources[R.source]="reload",this.sourceCaches[R.source].pause()),this._changed=!0},O.prototype._flattenAndSortRenderedFeatures=function(R){for(var j=this,te=function(an){return j._layers[an].type==="fill-extrusion"},le={},pe=[],ye=this._order.length-1;ye>=0;ye--){var _e=this._order[ye];if(te(_e)){le[_e]=ye;for(var Ne=0,He=R;Ne<He.length;Ne+=1){var et=He[Ne][_e];if(et)for(var yt=0,kt=et;yt<kt.length;yt+=1){var _t=kt[yt];pe.push(_t)}}}}pe.sort(function(an,$r){return $r.intersectionZ-an.intersectionZ});for(var wt=[],vt=this._order.length-1;vt>=0;vt--){var Dt=this._order[vt];if(te(Dt))for(var Pt=pe.length-1;Pt>=0;Pt--){var Ft=pe[Pt].feature;if(le[Ft.layer.id]<vt)break;wt.push(Ft),pe.pop()}else for(var er=0,cr=R;er<cr.length;er+=1){var Ar=cr[er][Dt];if(Ar)for(var Tr=0,Yr=Ar;Tr<Yr.length;Tr+=1){var Gr=Yr[Tr];wt.push(Gr.feature)}}}return wt},O.prototype.queryRenderedFeatures=function(R,j,te){j&&j.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",j.filter,null,j);var le={};if(j&&j.layers){if(!Array.isArray(j.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var pe=0,ye=j.layers;pe<ye.length;pe+=1){var _e=ye[pe],Ne=this._layers[_e];if(!Ne)return this.fire(new e.ErrorEvent(new Error("The layer '"+_e+"' does not exist in the map's style and cannot be queried for features."))),[];le[Ne.source]=!0}}var He=[];for(var et in j.availableImages=this._availableImages,this.sourceCaches)j.layers&&!le[et]||He.push(G(this.sourceCaches[et],this._layers,this._serializedLayers,R,j,te));return this.placement&&He.push(function(yt,kt,_t,wt,vt,Dt,Pt){for(var Ft={},er=Dt.queryRenderedSymbols(wt),cr=[],Ar=0,Tr=Object.keys(er).map(Number);Ar<Tr.length;Ar+=1){var Yr=Tr[Ar];cr.push(Pt[Yr])}cr.sort($);for(var Gr=function(){var ia=$r[an],jr=ia.featureIndex.lookupSymbolFeatures(er[ia.bucketInstanceId],kt,ia.bucketIndex,ia.sourceLayerIndex,vt.filter,vt.layers,vt.availableImages,yt);for(var mn in jr){var Un=Ft[mn]=Ft[mn]||[],Fn=jr[mn];Fn.sort(function(qn,va){var pa=ia.featureSortOrder;if(pa){var Ea=pa.indexOf(qn.featureIndex);return pa.indexOf(va.featureIndex)-Ea}return va.featureIndex-qn.featureIndex});for(var Jn=0,sa=Fn;Jn<sa.length;Jn+=1){var ka=sa[Jn];Un.push(ka)}}},an=0,$r=cr;an<$r.length;an+=1)Gr();var In=function(ia){Ft[ia].forEach(function(jr){var mn=jr.feature,Un=yt[ia],Fn=_t[Un.source].getFeatureState(mn.layer["source-layer"],mn.id);mn.source=mn.layer.source,mn.layer["source-layer"]&&(mn.sourceLayer=mn.layer["source-layer"]),mn.state=Fn})};for(var jn in Ft)In(jn);return Ft}(this._layers,this._serializedLayers,this.sourceCaches,R,j,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(He)},O.prototype.querySourceFeatures=function(R,j){j&&j.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",j.filter,null,j);var te=this.sourceCaches[R];return te?function(le,pe){for(var ye=le.getRenderableIds().map(function(kt){return le.getTileByID(kt)}),_e=[],Ne={},He=0;He<ye.length;He++){var et=ye[He],yt=et.tileID.canonical.key;Ne[yt]||(Ne[yt]=!0,et.querySourceFeatures(_e,pe))}return _e}(te,j):[]},O.prototype.addSourceType=function(R,j,te){return O.getSourceType(R)?te(new Error('A source type called "'+R+'" already exists.')):(O.setSourceType(R,j),j.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:R,url:j.workerSourceURL},te):te(null,null))},O.prototype.getLight=function(){return this.light.getLight()},O.prototype.setLight=function(R,j){j===void 0&&(j={}),this._checkLoaded();var te=this.light.getLight(),le=!1;for(var pe in R)if(!e.deepEqual(R[pe],te[pe])){le=!0;break}if(le){var ye={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(R,j),this.light.updateTransitions(ye)}},O.prototype._validate=function(R,j,te,le,pe){return pe===void 0&&(pe={}),(!pe||pe.validate!==!1)&&Kn(this,R.call(e.validateStyle,e.extend({key:j,style:this.serialize(),value:te,styleSpec:e.styleSpec},le)))},O.prototype._remove=function(){for(var R in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[R].setEventedParent(null);for(var j in this.sourceCaches)this.sourceCaches[j].clearTiles(),this.sourceCaches[j].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},O.prototype._clearSource=function(R){this.sourceCaches[R].clearTiles()},O.prototype._reloadSource=function(R){this.sourceCaches[R].resume(),this.sourceCaches[R].reload()},O.prototype._updateSources=function(R){for(var j in this.sourceCaches)this.sourceCaches[j].update(R)},O.prototype._generateCollisionBoxes=function(){for(var R in this.sourceCaches)this._reloadSource(R)},O.prototype._updatePlacement=function(R,j,te,le,pe){pe===void 0&&(pe=!1);for(var ye=!1,_e=!1,Ne={},He=0,et=this._order;He<et.length;He+=1){var yt=et[He],kt=this._layers[yt];if(kt.type==="symbol"){if(!Ne[kt.source]){var _t=this.sourceCaches[kt.source];Ne[kt.source]=_t.getRenderableIds(!0).map(function(er){return _t.getTileByID(er)}).sort(function(er,cr){return cr.tileID.overscaledZ-er.tileID.overscaledZ||(er.tileID.isLessThan(cr.tileID)?-1:1)})}var wt=this.crossTileSymbolIndex.addLayer(kt,Ne[kt.source],R.center.lng);ye=ye||wt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((pe=pe||this._layerOrderChanged||te===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),R.zoom))&&(this.pauseablePlacement=new vn(R,this._order,pe,j,te,le,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ne),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),_e=!0),ye&&this.pauseablePlacement.placement.setStale()),_e||ye)for(var vt=0,Dt=this._order;vt<Dt.length;vt+=1){var Pt=Dt[vt],Ft=this._layers[Pt];Ft.type==="symbol"&&this.placement.updateLayerOpacities(Ft,Ne[Ft.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},O.prototype._releaseSymbolFadeTiles=function(){for(var R in this.sourceCaches)this.sourceCaches[R].releaseSymbolFadeTiles()},O.prototype.getImages=function(R,j,te){this.imageManager.getImages(j.icons,te),this._updateTilesForChangedImages();var le=this.sourceCaches[j.source];le&&le.setDependencies(j.tileID.key,j.type,j.icons)},O.prototype.getGlyphs=function(R,j,te){this.glyphManager.getGlyphs(j.stacks,te)},O.prototype.getResource=function(R,j,te){return e.makeRequest(j,te)},O}(e.Evented);Wn.getSourceType=function(M){return D[M]},Wn.setSourceType=function(M,O){D[M]=O},Wn.registerForPluginStateChange=e.registerForPluginStateChange;var cn=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),$n=qa(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),ua=qa(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Xa=qa(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ci=qa(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),ri=qa("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),vi=qa(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Aa=qa(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Na=qa("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),co=qa("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Fo=qa("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Yo=qa(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Hi=qa(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Wi=qa(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Bo=qa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Va=qa(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),ko=qa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),uo=qa(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),yi=qa(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Xi=qa(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),fo=qa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),_o=qa(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Di=qa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ui=qa(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Gi=qa(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),ms=qa(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),bs=qa(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function qa(M,O){var R=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,j={};return{fragmentSource:M=M.replace(R,function(te,le,pe,ye,_e){return j[_e]=!0,le==="define"?`
#ifndef HAS_UNIFORM_u_`+_e+`
varying `+pe+" "+ye+" "+_e+`;
#else
uniform `+pe+" "+ye+" u_"+_e+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+_e+`
    `+pe+" "+ye+" "+_e+" = u_"+_e+`;
#endif
`}),vertexSource:O=O.replace(R,function(te,le,pe,ye,_e){var Ne=ye==="float"?"vec2":"vec4",He=_e.match(/color/)?"color":Ne;return j[_e]?le==="define"?`
#ifndef HAS_UNIFORM_u_`+_e+`
uniform lowp float u_`+_e+`_t;
attribute `+pe+" "+Ne+" a_"+_e+`;
varying `+pe+" "+ye+" "+_e+`;
#else
uniform `+pe+" "+ye+" u_"+_e+`;
#endif
`:He==="vec4"?`
#ifndef HAS_UNIFORM_u_`+_e+`
    `+_e+" = a_"+_e+`;
#else
    `+pe+" "+ye+" "+_e+" = u_"+_e+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+_e+`
    `+_e+" = unpack_mix_"+He+"(a_"+_e+", u_"+_e+`_t);
#else
    `+pe+" "+ye+" "+_e+" = u_"+_e+`;
#endif
`:le==="define"?`
#ifndef HAS_UNIFORM_u_`+_e+`
uniform lowp float u_`+_e+`_t;
attribute `+pe+" "+Ne+" a_"+_e+`;
#else
uniform `+pe+" "+ye+" u_"+_e+`;
#endif
`:He==="vec4"?`
#ifndef HAS_UNIFORM_u_`+_e+`
    `+pe+" "+ye+" "+_e+" = a_"+_e+`;
#else
    `+pe+" "+ye+" "+_e+" = u_"+_e+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+_e+`
    `+pe+" "+ye+" "+_e+" = unpack_mix_"+He+"(a_"+_e+", u_"+_e+`_t);
#else
    `+pe+" "+ye+" "+_e+" = u_"+_e+`;
#endif
`})}}var us=Object.freeze({__proto__:null,prelude:$n,background:ua,backgroundPattern:Xa,circle:Ci,clippingMask:ri,heatmap:vi,heatmapTexture:Aa,collisionBox:Na,collisionCircle:co,debug:Fo,fill:Yo,fillOutline:Hi,fillOutlinePattern:Wi,fillPattern:Bo,fillExtrusion:Va,fillExtrusionPattern:ko,hillshadePrepare:uo,hillshade:yi,line:Xi,lineGradient:fo,linePattern:_o,lineSDF:Di,raster:ui,symbolIcon:Gi,symbolSDF:ms,symbolTextAndIcon:bs}),Ko=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Ko.prototype.bind=function(M,O,R,j,te,le,pe,ye){this.context=M;for(var _e=this.boundPaintVertexBuffers.length!==j.length,Ne=0;!_e&&Ne<j.length;Ne++)this.boundPaintVertexBuffers[Ne]!==j[Ne]&&(_e=!0);var He=!this.vao||this.boundProgram!==O||this.boundLayoutVertexBuffer!==R||_e||this.boundIndexBuffer!==te||this.boundVertexOffset!==le||this.boundDynamicVertexBuffer!==pe||this.boundDynamicVertexBuffer2!==ye;!M.extVertexArrayObject||He?this.freshBind(O,R,j,te,le,pe,ye):(M.bindVertexArrayOES.set(this.vao),pe&&pe.bind(),te&&te.dynamicDraw&&te.bind(),ye&&ye.bind())},Ko.prototype.freshBind=function(M,O,R,j,te,le,pe){var ye,_e=M.numAttributes,Ne=this.context,He=Ne.gl;if(Ne.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ne.extVertexArrayObject.createVertexArrayOES(),Ne.bindVertexArrayOES.set(this.vao),ye=0,this.boundProgram=M,this.boundLayoutVertexBuffer=O,this.boundPaintVertexBuffers=R,this.boundIndexBuffer=j,this.boundVertexOffset=te,this.boundDynamicVertexBuffer=le,this.boundDynamicVertexBuffer2=pe;else{ye=Ne.currentNumAttributes||0;for(var et=_e;et<ye;et++)He.disableVertexAttribArray(et)}O.enableAttributes(He,M);for(var yt=0,kt=R;yt<kt.length;yt+=1)kt[yt].enableAttributes(He,M);le&&le.enableAttributes(He,M),pe&&pe.enableAttributes(He,M),O.bind(),O.setVertexAttribPointers(He,M,te);for(var _t=0,wt=R;_t<wt.length;_t+=1){var vt=wt[_t];vt.bind(),vt.setVertexAttribPointers(He,M,te)}le&&(le.bind(),le.setVertexAttribPointers(He,M,te)),j&&j.bind(),pe&&(pe.bind(),pe.setVertexAttribPointers(He,M,te)),Ne.currentNumAttributes=_e},Ko.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var _s=function(M,O,R,j,te){var le=M.gl;this.program=le.createProgram();var pe=R?R.defines():[];te&&pe.push("#define OVERDRAW_INSPECTOR;");var ye=pe.concat($n.fragmentSource,O.fragmentSource).join(`
`),_e=pe.concat($n.vertexSource,O.vertexSource).join(`
`),Ne=le.createShader(le.FRAGMENT_SHADER);if(le.isContextLost())this.failedToCreate=!0;else{le.shaderSource(Ne,ye),le.compileShader(Ne),le.attachShader(this.program,Ne);var He=le.createShader(le.VERTEX_SHADER);if(le.isContextLost())this.failedToCreate=!0;else{le.shaderSource(He,_e),le.compileShader(He),le.attachShader(this.program,He);for(var et=R?R.layoutAttributes:[],yt=0;yt<et.length;yt++)le.bindAttribLocation(this.program,yt,et[yt].name);le.linkProgram(this.program),le.deleteShader(He),le.deleteShader(Ne),this.numAttributes=le.getProgramParameter(this.program,le.ACTIVE_ATTRIBUTES),this.attributes={};for(var kt={},_t=0;_t<this.numAttributes;_t++){var wt=le.getActiveAttrib(this.program,_t);wt&&(this.attributes[wt.name]=le.getAttribLocation(this.program,wt.name))}for(var vt=le.getProgramParameter(this.program,le.ACTIVE_UNIFORMS),Dt=0;Dt<vt;Dt++){var Pt=le.getActiveUniform(this.program,Dt);Pt&&(kt[Pt.name]=le.getUniformLocation(this.program,Pt.name))}this.fixedUniforms=j(M,kt),this.binderUniforms=R?R.getUniforms(M,kt):[]}}};function ws(M,O,R){var j=1/br(R,1,O.transform.tileZoom),te=Math.pow(2,R.tileID.overscaledZ),le=R.tileSize*Math.pow(2,O.transform.tileZoom)/te,pe=le*(R.tileID.canonical.x+R.tileID.wrap*te),ye=le*R.tileID.canonical.y;return{u_image:0,u_texsize:R.imageAtlasTexture.size,u_scale:[j,M.fromScale,M.toScale],u_fade:M.t,u_pixel_coord_upper:[pe>>16,ye>>16],u_pixel_coord_lower:[65535&pe,65535&ye]}}_s.prototype.draw=function(M,O,R,j,te,le,pe,ye,_e,Ne,He,et,yt,kt,_t,wt){var vt,Dt=M.gl;if(!this.failedToCreate){for(var Pt in M.program.set(this.program),M.setDepthMode(R),M.setStencilMode(j),M.setColorMode(te),M.setCullFace(le),this.fixedUniforms)this.fixedUniforms[Pt].set(pe[Pt]);kt&&kt.setUniforms(M,this.binderUniforms,et,{zoom:yt});for(var Ft=(vt={},vt[Dt.LINES]=2,vt[Dt.TRIANGLES]=3,vt[Dt.LINE_STRIP]=1,vt)[O],er=0,cr=He.get();er<cr.length;er+=1){var Ar=cr[er],Tr=Ar.vaos||(Ar.vaos={});(Tr[ye]||(Tr[ye]=new Ko)).bind(M,this,_e,kt?kt.getPaintVertexBuffers():[],Ne,Ar.vertexOffset,_t,wt),Dt.drawElements(O,Ar.primitiveLength*Ft,Dt.UNSIGNED_SHORT,Ar.primitiveOffset*Ft*2)}}};var vs=function(M,O,R,j){var te=O.style.light,le=te.properties.get("position"),pe=[le.x,le.y,le.z],ye=e.create$1();te.properties.get("anchor")==="viewport"&&e.fromRotation(ye,-O.transform.angle),e.transformMat3(pe,pe,ye);var _e=te.properties.get("color");return{u_matrix:M,u_lightpos:pe,u_lightintensity:te.properties.get("intensity"),u_lightcolor:[_e.r,_e.g,_e.b],u_vertical_gradient:+R,u_opacity:j}},Ts=function(M,O,R,j,te,le,pe){return e.extend(vs(M,O,R,j),ws(le,O,pe),{u_height_factor:-Math.pow(2,te.overscaledZ)/pe.tileSize/8})},Mo=function(M){return{u_matrix:M}},Ao=function(M,O,R,j){return e.extend(Mo(M),ws(R,O,j))},No=function(M,O){return{u_matrix:M,u_world:O}},jo=function(M,O,R,j,te){return e.extend(Ao(M,O,R,j),{u_world:te})},Uo=function(M,O,R,j){var te,le,pe=M.transform;if(j.paint.get("circle-pitch-alignment")==="map"){var ye=br(R,1,pe.zoom);te=!0,le=[ye,ye]}else te=!1,le=pe.pixelsToGLUnits;return{u_camera_to_center_distance:pe.cameraToCenterDistance,u_scale_with_map:+(j.paint.get("circle-pitch-scale")==="map"),u_matrix:M.translatePosMatrix(O.posMatrix,R,j.paint.get("circle-translate"),j.paint.get("circle-translate-anchor")),u_pitch_with_map:+te,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:le}},Qo=function(M,O,R){var j=br(R,1,O.zoom),te=Math.pow(2,O.zoom-R.tileID.overscaledZ),le=R.tileID.overscaleFactor();return{u_matrix:M,u_camera_to_center_distance:O.cameraToCenterDistance,u_pixels_to_tile_units:j,u_extrude_scale:[O.pixelsToGLUnits[0]/(j*te),O.pixelsToGLUnits[1]/(j*te)],u_overscale_factor:le}},ho=function(M,O,R){return{u_matrix:M,u_inv_matrix:O,u_camera_to_center_distance:R.cameraToCenterDistance,u_viewport_size:[R.width,R.height]}},fs=function(M,O,R){return R===void 0&&(R=1),{u_matrix:M,u_color:O,u_overlay:0,u_overlay_scale:R}},oo=function(M){return{u_matrix:M}},Vo=function(M,O,R,j){return{u_matrix:M,u_extrude_scale:br(O,1,R),u_intensity:j}};function hs(M,O){var R=Math.pow(2,O.canonical.z),j=O.canonical.y;return[new e.MercatorCoordinate(0,j/R).toLngLat().lat,new e.MercatorCoordinate(0,(j+1)/R).toLngLat().lat]}var So=function(M,O,R){var j=M.transform;return{u_matrix:rt(M,O,R),u_ratio:1/br(O,1,j.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/j.pixelsToGLUnits[0],1/j.pixelsToGLUnits[1]]}},ja=function(M,O,R){return e.extend(So(M,O,R),{u_image:0})},Fe=function(M,O,R,j){var te=M.transform,le=Je(O,te);return{u_matrix:rt(M,O,R),u_texsize:O.imageAtlasTexture.size,u_ratio:1/br(O,1,te.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[le,j.fromScale,j.toScale],u_fade:j.t,u_units_to_pixels:[1/te.pixelsToGLUnits[0],1/te.pixelsToGLUnits[1]]}},Ve=function(M,O,R,j,te){var le=M.transform,pe=M.lineAtlas,ye=Je(O,le),_e=R.layout.get("line-cap")==="round",Ne=pe.getDash(j.from,_e),He=pe.getDash(j.to,_e),et=Ne.width*te.fromScale,yt=He.width*te.toScale;return e.extend(So(M,O,R),{u_patternscale_a:[ye/et,-Ne.height/2],u_patternscale_b:[ye/yt,-He.height/2],u_sdfgamma:pe.width/(256*Math.min(et,yt)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ne.y,u_tex_y_b:He.y,u_mix:te.t})};function Je(M,O){return 1/br(M,1,O.tileZoom)}function rt(M,O,R){return M.translatePosMatrix(O.tileID.posMatrix,O,R.paint.get("line-translate"),R.paint.get("line-translate-anchor"))}var dt=function(M,O,R,j,te){return{u_matrix:M,u_tl_parent:O,u_scale_parent:R,u_buffer_scale:1,u_fade_t:j.mix,u_opacity:j.opacity*te.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:te.paint.get("raster-brightness-min"),u_brightness_high:te.paint.get("raster-brightness-max"),u_saturation_factor:(pe=te.paint.get("raster-saturation"),pe>0?1-1/(1.001-pe):-pe),u_contrast_factor:(le=te.paint.get("raster-contrast"),le>0?1/(1-le):1+le),u_spin_weights:ft(te.paint.get("raster-hue-rotate"))};var le,pe};function ft(M){M*=Math.PI/180;var O=Math.sin(M),R=Math.cos(M);return[(2*R+1)/3,(-Math.sqrt(3)*O-R+1)/3,(Math.sqrt(3)*O-R+1)/3]}var Tt,Wt=function(M,O,R,j,te,le,pe,ye,_e,Ne){var He=te.transform;return{u_is_size_zoom_constant:+(M==="constant"||M==="source"),u_is_size_feature_constant:+(M==="constant"||M==="camera"),u_size_t:O?O.uSizeT:0,u_size:O?O.uSize:0,u_camera_to_center_distance:He.cameraToCenterDistance,u_pitch:He.pitch/360*2*Math.PI,u_rotate_symbol:+R,u_aspect_ratio:He.width/He.height,u_fade_change:te.options.fadeDuration?te.symbolFadeChange:1,u_matrix:le,u_label_plane_matrix:pe,u_coord_matrix:ye,u_is_text:+_e,u_pitch_with_map:+j,u_texsize:Ne,u_texture:0}},Xt=function(M,O,R,j,te,le,pe,ye,_e,Ne,He){var et=te.transform;return e.extend(Wt(M,O,R,j,te,le,pe,ye,_e,Ne),{u_gamma_scale:j?Math.cos(et._pitch)*et.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+He})},Gt=function(M,O,R,j,te,le,pe,ye,_e,Ne){return e.extend(Xt(M,O,R,j,te,le,pe,ye,!0,_e,!0),{u_texsize_icon:Ne,u_texture_icon:1})},tr=function(M,O,R){return{u_matrix:M,u_opacity:O,u_color:R}},lr=function(M,O,R,j,te,le){return e.extend(function(pe,ye,_e,Ne){var He=_e.imageManager.getPattern(pe.from.toString()),et=_e.imageManager.getPattern(pe.to.toString()),yt=_e.imageManager.getPixelSize(),kt=yt.width,_t=yt.height,wt=Math.pow(2,Ne.tileID.overscaledZ),vt=Ne.tileSize*Math.pow(2,_e.transform.tileZoom)/wt,Dt=vt*(Ne.tileID.canonical.x+Ne.tileID.wrap*wt),Pt=vt*Ne.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:He.tl,u_pattern_br_a:He.br,u_pattern_tl_b:et.tl,u_pattern_br_b:et.br,u_texsize:[kt,_t],u_mix:ye.t,u_pattern_size_a:He.displaySize,u_pattern_size_b:et.displaySize,u_scale_a:ye.fromScale,u_scale_b:ye.toScale,u_tile_units_to_pixels:1/br(Ne,1,_e.transform.tileZoom),u_pixel_coord_upper:[Dt>>16,Pt>>16],u_pixel_coord_lower:[65535&Dt,65535&Pt]}}(j,le,R,te),{u_matrix:M,u_opacity:O})},hr={fillExtrusion:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_lightpos:new e.Uniform3f(M,O.u_lightpos),u_lightintensity:new e.Uniform1f(M,O.u_lightintensity),u_lightcolor:new e.Uniform3f(M,O.u_lightcolor),u_vertical_gradient:new e.Uniform1f(M,O.u_vertical_gradient),u_opacity:new e.Uniform1f(M,O.u_opacity)}},fillExtrusionPattern:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_lightpos:new e.Uniform3f(M,O.u_lightpos),u_lightintensity:new e.Uniform1f(M,O.u_lightintensity),u_lightcolor:new e.Uniform3f(M,O.u_lightcolor),u_vertical_gradient:new e.Uniform1f(M,O.u_vertical_gradient),u_height_factor:new e.Uniform1f(M,O.u_height_factor),u_image:new e.Uniform1i(M,O.u_image),u_texsize:new e.Uniform2f(M,O.u_texsize),u_pixel_coord_upper:new e.Uniform2f(M,O.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(M,O.u_pixel_coord_lower),u_scale:new e.Uniform3f(M,O.u_scale),u_fade:new e.Uniform1f(M,O.u_fade),u_opacity:new e.Uniform1f(M,O.u_opacity)}},fill:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix)}},fillPattern:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_image:new e.Uniform1i(M,O.u_image),u_texsize:new e.Uniform2f(M,O.u_texsize),u_pixel_coord_upper:new e.Uniform2f(M,O.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(M,O.u_pixel_coord_lower),u_scale:new e.Uniform3f(M,O.u_scale),u_fade:new e.Uniform1f(M,O.u_fade)}},fillOutline:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_world:new e.Uniform2f(M,O.u_world)}},fillOutlinePattern:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_world:new e.Uniform2f(M,O.u_world),u_image:new e.Uniform1i(M,O.u_image),u_texsize:new e.Uniform2f(M,O.u_texsize),u_pixel_coord_upper:new e.Uniform2f(M,O.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(M,O.u_pixel_coord_lower),u_scale:new e.Uniform3f(M,O.u_scale),u_fade:new e.Uniform1f(M,O.u_fade)}},circle:function(M,O){return{u_camera_to_center_distance:new e.Uniform1f(M,O.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(M,O.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(M,O.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(M,O.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(M,O.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(M,O.u_matrix)}},collisionBox:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_camera_to_center_distance:new e.Uniform1f(M,O.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(M,O.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(M,O.u_extrude_scale),u_overscale_factor:new e.Uniform1f(M,O.u_overscale_factor)}},collisionCircle:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_inv_matrix:new e.UniformMatrix4f(M,O.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(M,O.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(M,O.u_viewport_size)}},debug:function(M,O){return{u_color:new e.UniformColor(M,O.u_color),u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_overlay:new e.Uniform1i(M,O.u_overlay),u_overlay_scale:new e.Uniform1f(M,O.u_overlay_scale)}},clippingMask:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix)}},heatmap:function(M,O){return{u_extrude_scale:new e.Uniform1f(M,O.u_extrude_scale),u_intensity:new e.Uniform1f(M,O.u_intensity),u_matrix:new e.UniformMatrix4f(M,O.u_matrix)}},heatmapTexture:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_world:new e.Uniform2f(M,O.u_world),u_image:new e.Uniform1i(M,O.u_image),u_color_ramp:new e.Uniform1i(M,O.u_color_ramp),u_opacity:new e.Uniform1f(M,O.u_opacity)}},hillshade:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_image:new e.Uniform1i(M,O.u_image),u_latrange:new e.Uniform2f(M,O.u_latrange),u_light:new e.Uniform2f(M,O.u_light),u_shadow:new e.UniformColor(M,O.u_shadow),u_highlight:new e.UniformColor(M,O.u_highlight),u_accent:new e.UniformColor(M,O.u_accent)}},hillshadePrepare:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_image:new e.Uniform1i(M,O.u_image),u_dimension:new e.Uniform2f(M,O.u_dimension),u_zoom:new e.Uniform1f(M,O.u_zoom),u_maxzoom:new e.Uniform1f(M,O.u_maxzoom),u_unpack:new e.Uniform4f(M,O.u_unpack)}},line:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_ratio:new e.Uniform1f(M,O.u_ratio),u_device_pixel_ratio:new e.Uniform1f(M,O.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(M,O.u_units_to_pixels)}},lineGradient:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_ratio:new e.Uniform1f(M,O.u_ratio),u_device_pixel_ratio:new e.Uniform1f(M,O.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(M,O.u_units_to_pixels),u_image:new e.Uniform1i(M,O.u_image)}},linePattern:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_texsize:new e.Uniform2f(M,O.u_texsize),u_ratio:new e.Uniform1f(M,O.u_ratio),u_device_pixel_ratio:new e.Uniform1f(M,O.u_device_pixel_ratio),u_image:new e.Uniform1i(M,O.u_image),u_units_to_pixels:new e.Uniform2f(M,O.u_units_to_pixels),u_scale:new e.Uniform3f(M,O.u_scale),u_fade:new e.Uniform1f(M,O.u_fade)}},lineSDF:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_ratio:new e.Uniform1f(M,O.u_ratio),u_device_pixel_ratio:new e.Uniform1f(M,O.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(M,O.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(M,O.u_patternscale_a),u_patternscale_b:new e.Uniform2f(M,O.u_patternscale_b),u_sdfgamma:new e.Uniform1f(M,O.u_sdfgamma),u_image:new e.Uniform1i(M,O.u_image),u_tex_y_a:new e.Uniform1f(M,O.u_tex_y_a),u_tex_y_b:new e.Uniform1f(M,O.u_tex_y_b),u_mix:new e.Uniform1f(M,O.u_mix)}},raster:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_tl_parent:new e.Uniform2f(M,O.u_tl_parent),u_scale_parent:new e.Uniform1f(M,O.u_scale_parent),u_buffer_scale:new e.Uniform1f(M,O.u_buffer_scale),u_fade_t:new e.Uniform1f(M,O.u_fade_t),u_opacity:new e.Uniform1f(M,O.u_opacity),u_image0:new e.Uniform1i(M,O.u_image0),u_image1:new e.Uniform1i(M,O.u_image1),u_brightness_low:new e.Uniform1f(M,O.u_brightness_low),u_brightness_high:new e.Uniform1f(M,O.u_brightness_high),u_saturation_factor:new e.Uniform1f(M,O.u_saturation_factor),u_contrast_factor:new e.Uniform1f(M,O.u_contrast_factor),u_spin_weights:new e.Uniform3f(M,O.u_spin_weights)}},symbolIcon:function(M,O){return{u_is_size_zoom_constant:new e.Uniform1i(M,O.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(M,O.u_is_size_feature_constant),u_size_t:new e.Uniform1f(M,O.u_size_t),u_size:new e.Uniform1f(M,O.u_size),u_camera_to_center_distance:new e.Uniform1f(M,O.u_camera_to_center_distance),u_pitch:new e.Uniform1f(M,O.u_pitch),u_rotate_symbol:new e.Uniform1i(M,O.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(M,O.u_aspect_ratio),u_fade_change:new e.Uniform1f(M,O.u_fade_change),u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(M,O.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(M,O.u_coord_matrix),u_is_text:new e.Uniform1i(M,O.u_is_text),u_pitch_with_map:new e.Uniform1i(M,O.u_pitch_with_map),u_texsize:new e.Uniform2f(M,O.u_texsize),u_texture:new e.Uniform1i(M,O.u_texture)}},symbolSDF:function(M,O){return{u_is_size_zoom_constant:new e.Uniform1i(M,O.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(M,O.u_is_size_feature_constant),u_size_t:new e.Uniform1f(M,O.u_size_t),u_size:new e.Uniform1f(M,O.u_size),u_camera_to_center_distance:new e.Uniform1f(M,O.u_camera_to_center_distance),u_pitch:new e.Uniform1f(M,O.u_pitch),u_rotate_symbol:new e.Uniform1i(M,O.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(M,O.u_aspect_ratio),u_fade_change:new e.Uniform1f(M,O.u_fade_change),u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(M,O.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(M,O.u_coord_matrix),u_is_text:new e.Uniform1i(M,O.u_is_text),u_pitch_with_map:new e.Uniform1i(M,O.u_pitch_with_map),u_texsize:new e.Uniform2f(M,O.u_texsize),u_texture:new e.Uniform1i(M,O.u_texture),u_gamma_scale:new e.Uniform1f(M,O.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(M,O.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(M,O.u_is_halo)}},symbolTextAndIcon:function(M,O){return{u_is_size_zoom_constant:new e.Uniform1i(M,O.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(M,O.u_is_size_feature_constant),u_size_t:new e.Uniform1f(M,O.u_size_t),u_size:new e.Uniform1f(M,O.u_size),u_camera_to_center_distance:new e.Uniform1f(M,O.u_camera_to_center_distance),u_pitch:new e.Uniform1f(M,O.u_pitch),u_rotate_symbol:new e.Uniform1i(M,O.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(M,O.u_aspect_ratio),u_fade_change:new e.Uniform1f(M,O.u_fade_change),u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(M,O.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(M,O.u_coord_matrix),u_is_text:new e.Uniform1i(M,O.u_is_text),u_pitch_with_map:new e.Uniform1i(M,O.u_pitch_with_map),u_texsize:new e.Uniform2f(M,O.u_texsize),u_texsize_icon:new e.Uniform2f(M,O.u_texsize_icon),u_texture:new e.Uniform1i(M,O.u_texture),u_texture_icon:new e.Uniform1i(M,O.u_texture_icon),u_gamma_scale:new e.Uniform1f(M,O.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(M,O.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(M,O.u_is_halo)}},background:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_opacity:new e.Uniform1f(M,O.u_opacity),u_color:new e.UniformColor(M,O.u_color)}},backgroundPattern:function(M,O){return{u_matrix:new e.UniformMatrix4f(M,O.u_matrix),u_opacity:new e.Uniform1f(M,O.u_opacity),u_image:new e.Uniform1i(M,O.u_image),u_pattern_tl_a:new e.Uniform2f(M,O.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(M,O.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(M,O.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(M,O.u_pattern_br_b),u_texsize:new e.Uniform2f(M,O.u_texsize),u_mix:new e.Uniform1f(M,O.u_mix),u_pattern_size_a:new e.Uniform2f(M,O.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(M,O.u_pattern_size_b),u_scale_a:new e.Uniform1f(M,O.u_scale_a),u_scale_b:new e.Uniform1f(M,O.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(M,O.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(M,O.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(M,O.u_tile_units_to_pixels)}}};function vr(M,O,R,j,te,le,pe){for(var ye=M.context,_e=ye.gl,Ne=M.useProgram("collisionBox"),He=[],et=0,yt=0,kt=0;kt<j.length;kt++){var _t=j[kt],wt=O.getTile(_t),vt=wt.getBucket(R);if(vt){var Dt=_t.posMatrix;te[0]===0&&te[1]===0||(Dt=M.translatePosMatrix(_t.posMatrix,wt,te,le));var Pt=pe?vt.textCollisionBox:vt.iconCollisionBox,Ft=vt.collisionCircleArray;if(Ft.length>0){var er=e.create(),cr=Dt;e.mul(er,vt.placementInvProjMatrix,M.transform.glCoordMatrix),e.mul(er,er,vt.placementViewportMatrix),He.push({circleArray:Ft,circleOffset:yt,transform:cr,invTransform:er}),yt=et+=Ft.length/4}Pt&&Ne.draw(ye,_e.LINES,Ie.disabled,be.disabled,M.colorModeForRenderPass(),Pe.disabled,Qo(Dt,M.transform,wt),R.id,Pt.layoutVertexBuffer,Pt.indexBuffer,Pt.segments,null,M.transform.zoom,null,null,Pt.collisionVertexBuffer)}}if(pe&&He.length){var Ar=M.useProgram("collisionCircle"),Tr=new e.StructArrayLayout2f1f2i16;Tr.resize(4*et),Tr._trim();for(var Yr=0,Gr=0,an=He;Gr<an.length;Gr+=1)for(var $r=an[Gr],In=0;In<$r.circleArray.length/4;In++){var jn=4*In,ia=$r.circleArray[jn+0],jr=$r.circleArray[jn+1],mn=$r.circleArray[jn+2],Un=$r.circleArray[jn+3];Tr.emplace(Yr++,ia,jr,mn,Un,0),Tr.emplace(Yr++,ia,jr,mn,Un,1),Tr.emplace(Yr++,ia,jr,mn,Un,2),Tr.emplace(Yr++,ia,jr,mn,Un,3)}(!Tt||Tt.length<2*et)&&(Tt=function(pa){var Ea=2*pa,ya=new e.StructArrayLayout3ui6;ya.resize(Ea),ya._trim();for(var La=0;La<Ea;La++){var Fa=6*La;ya.uint16[Fa+0]=4*La+0,ya.uint16[Fa+1]=4*La+1,ya.uint16[Fa+2]=4*La+2,ya.uint16[Fa+3]=4*La+2,ya.uint16[Fa+4]=4*La+3,ya.uint16[Fa+5]=4*La+0}return ya}(et));for(var Fn=ye.createIndexBuffer(Tt,!0),Jn=ye.createVertexBuffer(Tr,e.collisionCircleLayout.members,!0),sa=0,ka=He;sa<ka.length;sa+=1){var qn=ka[sa],va=ho(qn.transform,qn.invTransform,M.transform);Ar.draw(ye,_e.TRIANGLES,Ie.disabled,be.disabled,M.colorModeForRenderPass(),Pe.disabled,va,R.id,Jn,Fn,e.SegmentVector.simpleSegment(0,2*qn.circleOffset,qn.circleArray.length,qn.circleArray.length/2),null,M.transform.zoom,null,null,null)}Jn.destroy(),Fn.destroy()}}var Pr=e.identity(new Float32Array(16));function Jr(M,O,R,j,te,le){var pe=e.getAnchorAlignment(M),ye=-(pe.horizontalAlign-.5)*O,_e=-(pe.verticalAlign-.5)*R,Ne=e.evaluateVariableOffset(M,j);return new e.Point((ye/te+Ne[0])*le,(_e/te+Ne[1])*le)}function on(M,O,R,j,te,le,pe,ye,_e,Ne,He){var et=M.text.placedSymbolArray,yt=M.text.dynamicLayoutVertexArray,kt=M.icon.dynamicLayoutVertexArray,_t={};yt.clear();for(var wt=0;wt<et.length;wt++){var vt=et.get(wt),Dt=M.allowVerticalPlacement&&!vt.placedOrientation,Pt=vt.hidden||!vt.crossTileID||Dt?null:j[vt.crossTileID];if(Pt){var Ft=new e.Point(vt.anchorX,vt.anchorY),er=Kt(Ft,R?ye:pe),cr=yr(le.cameraToCenterDistance,er.signedDistanceFromCamera),Ar=te.evaluateSizeForFeature(M.textSizeData,Ne,vt)*cr/e.ONE_EM;R&&(Ar*=M.tilePixelRatio/_e);for(var Tr=Pt.width,Yr=Pt.height,Gr=Jr(Pt.anchor,Tr,Yr,Pt.textOffset,Pt.textBoxScale,Ar),an=R?Kt(Ft.add(Gr),pe).point:er.point.add(O?Gr.rotate(-le.angle):Gr),$r=M.allowVerticalPlacement&&vt.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,In=0;In<vt.numGlyphs;In++)e.addDynamicAttributes(yt,an,$r);He&&vt.associatedIconIndex>=0&&(_t[vt.associatedIconIndex]={shiftedAnchor:an,angle:$r})}else Zr(vt.numGlyphs,yt)}if(He){kt.clear();for(var jn=M.icon.placedSymbolArray,ia=0;ia<jn.length;ia++){var jr=jn.get(ia);if(jr.hidden)Zr(jr.numGlyphs,kt);else{var mn=_t[ia];if(mn)for(var Un=0;Un<jr.numGlyphs;Un++)e.addDynamicAttributes(kt,mn.shiftedAnchor,mn.angle);else Zr(jr.numGlyphs,kt)}}M.icon.dynamicLayoutVertexBuffer.updateData(kt)}M.text.dynamicLayoutVertexBuffer.updateData(yt)}function _n(M,O,R){return R.iconsInText&&O?"symbolTextAndIcon":M?"symbolSDF":"symbolIcon"}function Mn(M,O,R,j,te,le,pe,ye,_e,Ne,He,et){for(var yt=M.context,kt=yt.gl,_t=M.transform,wt=ye==="map",vt=_e==="map",Dt=wt&&R.layout.get("symbol-placement")!=="point",Pt=wt&&!vt&&!Dt,Ft=R.layout.get("symbol-sort-key").constantOr(1)!==void 0,er=M.depthModeForSublayer(0,Ie.ReadOnly),cr=R.layout.get("text-variable-anchor"),Ar=[],Tr=0,Yr=j;Tr<Yr.length;Tr+=1){var Gr=Yr[Tr],an=O.getTile(Gr),$r=an.getBucket(R);if($r){var In=te?$r.text:$r.icon;if(In&&In.segments.get().length){var jn=In.programConfigurations.get(R.id),ia=te||$r.sdfIcons,jr=te?$r.textSizeData:$r.iconSizeData,mn=vt||_t.pitch!==0,Un=M.useProgram(_n(ia,te,$r),jn),Fn=e.evaluateSizeForZoom(jr,_t.zoom),Jn=void 0,sa=[0,0],ka=void 0,qn=void 0,va=null,pa=void 0;if(te){if(ka=an.glyphAtlasTexture,qn=kt.LINEAR,Jn=an.glyphAtlasTexture.size,$r.iconsInText){sa=an.imageAtlasTexture.size,va=an.imageAtlasTexture;var Ea=jr.kind==="composite"||jr.kind==="camera";pa=mn||M.options.rotating||M.options.zooming||Ea?kt.LINEAR:kt.NEAREST}}else{var ya=R.layout.get("icon-size").constantOr(0)!==1||$r.iconsNeedLinear;ka=an.imageAtlasTexture,qn=ia||M.options.rotating||M.options.zooming||ya||mn?kt.LINEAR:kt.NEAREST,Jn=an.imageAtlasTexture.size}var La=br(an,1,M.transform.zoom),Fa=Lr(Gr.posMatrix,vt,wt,M.transform,La),si=dr(Gr.posMatrix,vt,wt,M.transform,La),Ei=cr&&$r.hasTextData(),Li=R.layout.get("icon-text-fit")!=="none"&&Ei&&$r.hasIconData();Dt&&gr($r,Gr.posMatrix,M,te,Fa,si,vt,Ne);var oi=M.translatePosMatrix(Gr.posMatrix,an,le,pe),_i=Dt||te&&cr||Li?Pr:Fa,hi=M.translatePosMatrix(si,an,le,pe,!0),mo=ia&&R.paint.get(te?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Vi={program:Un,buffers:In,uniformValues:ia?$r.iconsInText?Gt(jr.kind,Fn,Pt,vt,M,oi,_i,hi,Jn,sa):Xt(jr.kind,Fn,Pt,vt,M,oi,_i,hi,te,Jn,!0):Wt(jr.kind,Fn,Pt,vt,M,oi,_i,hi,te,Jn),atlasTexture:ka,atlasTextureIcon:va,atlasInterpolation:qn,atlasInterpolationIcon:pa,isSDF:ia,hasHalo:mo};if(Ft)for(var Oo=0,xs=In.segments.get();Oo<xs.length;Oo+=1){var Ns=xs[Oo];Ar.push({segments:new e.SegmentVector([Ns]),sortKey:Ns.sortKey,state:Vi})}else Ar.push({segments:In.segments,sortKey:0,state:Vi})}}}Ft&&Ar.sort(function(ul,rs){return ul.sortKey-rs.sortKey});for(var cl=0,$s=Ar;cl<$s.length;cl+=1){var el=$s[cl],vo=el.state;if(yt.activeTexture.set(kt.TEXTURE0),vo.atlasTexture.bind(vo.atlasInterpolation,kt.CLAMP_TO_EDGE),vo.atlasTextureIcon&&(yt.activeTexture.set(kt.TEXTURE1),vo.atlasTextureIcon&&vo.atlasTextureIcon.bind(vo.atlasInterpolationIcon,kt.CLAMP_TO_EDGE)),vo.isSDF){var qs=vo.uniformValues;vo.hasHalo&&(qs.u_is_halo=1,Rn(vo.buffers,el.segments,R,M,vo.program,er,He,et,qs)),qs.u_is_halo=0}Rn(vo.buffers,el.segments,R,M,vo.program,er,He,et,vo.uniformValues)}}function Rn(M,O,R,j,te,le,pe,ye,_e){var Ne=j.context,He=Ne.gl;te.draw(Ne,He.TRIANGLES,le,pe,ye,Pe.disabled,_e,R.id,M.layoutVertexBuffer,M.indexBuffer,O,R.paint,j.transform.zoom,M.programConfigurations.get(R.id),M.dynamicLayoutVertexBuffer,M.opacityVertexBuffer)}function An(M,O,R,j,te,le,pe){var ye,_e,Ne,He,et,yt=M.context.gl,kt=R.paint.get("fill-pattern"),_t=kt&&kt.constantOr(1),wt=R.getCrossfadeParameters();pe?(_e=_t&&!R.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ye=yt.LINES):(_e=_t?"fillPattern":"fill",ye=yt.TRIANGLES);for(var vt=0,Dt=j;vt<Dt.length;vt+=1){var Pt=Dt[vt],Ft=O.getTile(Pt);if(!_t||Ft.patternsLoaded()){var er=Ft.getBucket(R);if(er){var cr=er.programConfigurations.get(R.id),Ar=M.useProgram(_e,cr);_t&&(M.context.activeTexture.set(yt.TEXTURE0),Ft.imageAtlasTexture.bind(yt.LINEAR,yt.CLAMP_TO_EDGE),cr.updatePaintBuffers(wt));var Tr=kt.constantOr(null);if(Tr&&Ft.imageAtlas){var Yr=Ft.imageAtlas,Gr=Yr.patternPositions[Tr.to.toString()],an=Yr.patternPositions[Tr.from.toString()];Gr&&an&&cr.setConstantPatternPositions(Gr,an)}var $r=M.translatePosMatrix(Pt.posMatrix,Ft,R.paint.get("fill-translate"),R.paint.get("fill-translate-anchor"));if(pe){He=er.indexBuffer2,et=er.segments2;var In=[yt.drawingBufferWidth,yt.drawingBufferHeight];Ne=_e==="fillOutlinePattern"&&_t?jo($r,M,wt,Ft,In):No($r,In)}else He=er.indexBuffer,et=er.segments,Ne=_t?Ao($r,M,wt,Ft):Mo($r);Ar.draw(M.context,ye,te,M.stencilModeForClipping(Pt),le,Pe.disabled,Ne,R.id,er.layoutVertexBuffer,He,et,R.paint,M.transform.zoom,cr)}}}}function ha(M,O,R,j,te,le,pe){for(var ye=M.context,_e=ye.gl,Ne=R.paint.get("fill-extrusion-pattern"),He=Ne.constantOr(1),et=R.getCrossfadeParameters(),yt=R.paint.get("fill-extrusion-opacity"),kt=0,_t=j;kt<_t.length;kt+=1){var wt=_t[kt],vt=O.getTile(wt),Dt=vt.getBucket(R);if(Dt){var Pt=Dt.programConfigurations.get(R.id),Ft=M.useProgram(He?"fillExtrusionPattern":"fillExtrusion",Pt);He&&(M.context.activeTexture.set(_e.TEXTURE0),vt.imageAtlasTexture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),Pt.updatePaintBuffers(et));var er=Ne.constantOr(null);if(er&&vt.imageAtlas){var cr=vt.imageAtlas,Ar=cr.patternPositions[er.to.toString()],Tr=cr.patternPositions[er.from.toString()];Ar&&Tr&&Pt.setConstantPatternPositions(Ar,Tr)}var Yr=M.translatePosMatrix(wt.posMatrix,vt,R.paint.get("fill-extrusion-translate"),R.paint.get("fill-extrusion-translate-anchor")),Gr=R.paint.get("fill-extrusion-vertical-gradient"),an=He?Ts(Yr,M,Gr,yt,wt,et,vt):vs(Yr,M,Gr,yt);Ft.draw(ye,ye.gl.TRIANGLES,te,le,pe,Pe.backCCW,an,R.id,Dt.layoutVertexBuffer,Dt.indexBuffer,Dt.segments,R.paint,M.transform.zoom,Pt)}}}function wa(M,O,R,j,te,le){var pe=M.context,ye=pe.gl,_e=O.fbo;if(_e){var Ne=M.useProgram("hillshade");pe.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_2D,_e.colorAttachment.get());var He=function(et,yt,kt){var _t=kt.paint.get("hillshade-shadow-color"),wt=kt.paint.get("hillshade-highlight-color"),vt=kt.paint.get("hillshade-accent-color"),Dt=kt.paint.get("hillshade-illumination-direction")*(Math.PI/180);kt.paint.get("hillshade-illumination-anchor")==="viewport"&&(Dt-=et.transform.angle);var Pt=!et.options.moving;return{u_matrix:et.transform.calculatePosMatrix(yt.tileID.toUnwrapped(),Pt),u_image:0,u_latrange:hs(et,yt.tileID),u_light:[kt.paint.get("hillshade-exaggeration"),Dt],u_shadow:_t,u_highlight:wt,u_accent:vt}}(M,O,R);Ne.draw(pe,ye.TRIANGLES,j,te,le,Pe.disabled,He,R.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments)}}function Da(M,O,R,j,te,le,pe){var ye=M.context,_e=ye.gl,Ne=O.dem;if(Ne&&Ne.data){var He=Ne.dim,et=Ne.stride,yt=Ne.getPixels();if(ye.activeTexture.set(_e.TEXTURE1),ye.pixelStoreUnpackPremultiplyAlpha.set(!1),O.demTexture=O.demTexture||M.getTileTexture(et),O.demTexture){var kt=O.demTexture;kt.update(yt,{premultiply:!1}),kt.bind(_e.NEAREST,_e.CLAMP_TO_EDGE)}else O.demTexture=new e.Texture(ye,yt,_e.RGBA,{premultiply:!1}),O.demTexture.bind(_e.NEAREST,_e.CLAMP_TO_EDGE);ye.activeTexture.set(_e.TEXTURE0);var _t=O.fbo;if(!_t){var wt=new e.Texture(ye,{width:He,height:He,data:null},_e.RGBA);wt.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),(_t=O.fbo=ye.createFramebuffer(He,He,!0)).colorAttachment.set(wt.texture)}ye.bindFramebuffer.set(_t.framebuffer),ye.viewport.set([0,0,He,He]),M.useProgram("hillshadePrepare").draw(ye,_e.TRIANGLES,te,le,pe,Pe.disabled,function(vt,Dt,Pt){var Ft=Dt.stride,er=e.create();return e.ortho(er,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(er,er,[0,-e.EXTENT,0]),{u_matrix:er,u_image:1,u_dimension:[Ft,Ft],u_zoom:vt.overscaledZ,u_maxzoom:Pt,u_unpack:Dt.getUnpackVector()}}(O.tileID,Ne,j),R.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments),O.needsHillshadePrepare=!1}}function za(M,O,R,j,te){var le=j.paint.get("raster-fade-duration");if(le>0){var pe=e.browser.now(),ye=(pe-M.timeAdded)/le,_e=O?(pe-O.timeAdded)/le:-1,Ne=R.getSource(),He=te.coveringZoomLevel({tileSize:Ne.tileSize,roundZoom:Ne.roundZoom}),et=!O||Math.abs(O.tileID.overscaledZ-He)>Math.abs(M.tileID.overscaledZ-He),yt=et&&M.refreshedUponExpiration?1:e.clamp(et?ye:1-_e,0,1);return M.refreshedUponExpiration&&ye>=1&&(M.refreshedUponExpiration=!1),O?{opacity:1,mix:1-yt}:{opacity:yt,mix:0}}return{opacity:1,mix:0}}var Ra=new e.Color(1,0,0,1),xi=new e.Color(0,1,0,1),gi=new e.Color(0,0,1,1),ni=new e.Color(1,0,1,1),ai=new e.Color(0,1,1,1);function mi(M){var O=M.transform.padding;Ri(M,M.transform.height-(O.top||0),3,Ra),Ri(M,O.bottom||0,3,xi),Zi(M,O.left||0,3,gi),Zi(M,M.transform.width-(O.right||0),3,ni);var R=M.transform.centerPoint;(function(j,te,le,pe){Ji(j,te-1,le-10,2,20,pe),Ji(j,te-10,le-1,20,2,pe)})(M,R.x,M.transform.height-R.y,ai)}function Ri(M,O,R,j){Ji(M,0,O+R/2,M.transform.width,R,j)}function Zi(M,O,R,j){Ji(M,O-R/2,0,R,M.transform.height,j)}function Ji(M,O,R,j,te,le){var pe=M.context,ye=pe.gl;ye.enable(ye.SCISSOR_TEST),ye.scissor(O*e.browser.devicePixelRatio,R*e.browser.devicePixelRatio,j*e.browser.devicePixelRatio,te*e.browser.devicePixelRatio),pe.clear({color:le}),ye.disable(ye.SCISSOR_TEST)}function Ki(M,O,R){var j=M.context,te=j.gl,le=R.posMatrix,pe=M.useProgram("debug"),ye=Ie.disabled,_e=be.disabled,Ne=M.colorModeForRenderPass();j.activeTexture.set(te.TEXTURE0),M.emptyTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),pe.draw(j,te.LINE_STRIP,ye,_e,Ne,Pe.disabled,fs(le,e.Color.red),"$debug",M.debugBuffer,M.tileBorderIndexBuffer,M.debugSegments);var He=O.getTileByID(R.key).latestRawTileData,et=He&&He.byteLength||0,yt=Math.floor(et/1024),kt=O.getTile(R).tileSize,_t=512/Math.min(kt,512)*(R.overscaledZ/M.transform.zoom)*.5,wt=R.canonical.toString();R.overscaledZ!==R.canonical.z&&(wt+=" => "+R.overscaledZ),function(vt,Dt){vt.initDebugOverlayCanvas();var Pt=vt.debugOverlayCanvas,Ft=vt.context.gl,er=vt.debugOverlayCanvas.getContext("2d");er.clearRect(0,0,Pt.width,Pt.height),er.shadowColor="white",er.shadowBlur=2,er.lineWidth=1.5,er.strokeStyle="white",er.textBaseline="top",er.font="bold 36px Open Sans, sans-serif",er.fillText(Dt,5,5),er.strokeText(Dt,5,5),vt.debugOverlayTexture.update(Pt),vt.debugOverlayTexture.bind(Ft.LINEAR,Ft.CLAMP_TO_EDGE)}(M,wt+" "+yt+"kb"),pe.draw(j,te.TRIANGLES,ye,_e,Ae.alphaBlended,Pe.disabled,fs(le,e.Color.transparent,_t),"$debug",M.debugBuffer,M.quadTriangleIndexBuffer,M.debugSegments)}var Qi={symbol:function(M,O,R,j,te){if(M.renderPass==="translucent"){var le=be.disabled,pe=M.colorModeForRenderPass();R.layout.get("text-variable-anchor")&&function(ye,_e,Ne,He,et,yt,kt){for(var _t=_e.transform,wt=et==="map",vt=yt==="map",Dt=0,Pt=ye;Dt<Pt.length;Dt+=1){var Ft=Pt[Dt],er=He.getTile(Ft),cr=er.getBucket(Ne);if(cr&&cr.text&&cr.text.segments.get().length){var Ar=cr.textSizeData,Tr=e.evaluateSizeForZoom(Ar,_t.zoom),Yr=br(er,1,_e.transform.zoom),Gr=Lr(Ft.posMatrix,vt,wt,_e.transform,Yr),an=Ne.layout.get("icon-text-fit")!=="none"&&cr.hasIconData();if(Tr){var $r=Math.pow(2,_t.zoom-er.tileID.overscaledZ);on(cr,wt,vt,kt,e.symbolSize,_t,Gr,Ft.posMatrix,$r,Tr,an)}}}}(j,M,R,O,R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),te),R.paint.get("icon-opacity").constantOr(1)!==0&&Mn(M,O,R,j,!1,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),R.layout.get("icon-rotation-alignment"),R.layout.get("icon-pitch-alignment"),R.layout.get("icon-keep-upright"),le,pe),R.paint.get("text-opacity").constantOr(1)!==0&&Mn(M,O,R,j,!0,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.layout.get("text-keep-upright"),le,pe),O.map.showCollisionBoxes&&(vr(M,O,R,j,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),!0),vr(M,O,R,j,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),!1))}},circle:function(M,O,R,j){if(M.renderPass==="translucent"){var te=R.paint.get("circle-opacity"),le=R.paint.get("circle-stroke-width"),pe=R.paint.get("circle-stroke-opacity"),ye=R.layout.get("circle-sort-key").constantOr(1)!==void 0;if(te.constantOr(1)!==0||le.constantOr(1)!==0&&pe.constantOr(1)!==0){for(var _e=M.context,Ne=_e.gl,He=M.depthModeForSublayer(0,Ie.ReadOnly),et=be.disabled,yt=M.colorModeForRenderPass(),kt=[],_t=0;_t<j.length;_t++){var wt=j[_t],vt=O.getTile(wt),Dt=vt.getBucket(R);if(Dt){var Pt=Dt.programConfigurations.get(R.id),Ft={programConfiguration:Pt,program:M.useProgram("circle",Pt),layoutVertexBuffer:Dt.layoutVertexBuffer,indexBuffer:Dt.indexBuffer,uniformValues:Uo(M,wt,vt,R)};if(ye)for(var er=0,cr=Dt.segments.get();er<cr.length;er+=1){var Ar=cr[er];kt.push({segments:new e.SegmentVector([Ar]),sortKey:Ar.sortKey,state:Ft})}else kt.push({segments:Dt.segments,sortKey:0,state:Ft})}}ye&&kt.sort(function(Un,Fn){return Un.sortKey-Fn.sortKey});for(var Tr=0,Yr=kt;Tr<Yr.length;Tr+=1){var Gr=Yr[Tr],an=Gr.state,$r=an.programConfiguration,In=an.program,jn=an.layoutVertexBuffer,ia=an.indexBuffer,jr=an.uniformValues,mn=Gr.segments;In.draw(_e,Ne.TRIANGLES,He,et,yt,Pe.disabled,jr,R.id,jn,ia,mn,R.paint,M.transform.zoom,$r)}}}},heatmap:function(M,O,R,j){if(R.paint.get("heatmap-opacity")!==0)if(M.renderPass==="offscreen"){var te=M.context,le=te.gl,pe=be.disabled,ye=new Ae([le.ONE,le.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(wt,vt,Dt){var Pt=wt.gl;wt.activeTexture.set(Pt.TEXTURE1),wt.viewport.set([0,0,vt.width/4,vt.height/4]);var Ft=Dt.heatmapFbo;if(Ft)Pt.bindTexture(Pt.TEXTURE_2D,Ft.colorAttachment.get()),wt.bindFramebuffer.set(Ft.framebuffer);else{var er=Pt.createTexture();Pt.bindTexture(Pt.TEXTURE_2D,er),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_WRAP_S,Pt.CLAMP_TO_EDGE),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_WRAP_T,Pt.CLAMP_TO_EDGE),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_MIN_FILTER,Pt.LINEAR),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_MAG_FILTER,Pt.LINEAR),Ft=Dt.heatmapFbo=wt.createFramebuffer(vt.width/4,vt.height/4,!1),function(cr,Ar,Tr,Yr){var Gr=cr.gl,an=cr.extRenderToTextureHalfFloat?cr.extTextureHalfFloat.HALF_FLOAT_OES:Gr.UNSIGNED_BYTE;Gr.texImage2D(Gr.TEXTURE_2D,0,Gr.RGBA,Ar.width/4,Ar.height/4,0,Gr.RGBA,an,null),Yr.colorAttachment.set(Tr)}(wt,vt,er,Ft)}})(te,M,R),te.clear({color:e.Color.transparent});for(var _e=0;_e<j.length;_e++){var Ne=j[_e];if(!O.hasRenderableParent(Ne)){var He=O.getTile(Ne),et=He.getBucket(R);if(et){var yt=et.programConfigurations.get(R.id),kt=M.useProgram("heatmap",yt),_t=M.transform.zoom;kt.draw(te,le.TRIANGLES,Ie.disabled,pe,ye,Pe.disabled,Vo(Ne.posMatrix,He,_t,R.paint.get("heatmap-intensity")),R.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,R.paint,M.transform.zoom,yt)}}}te.viewport.set([0,0,M.width,M.height])}else M.renderPass==="translucent"&&(M.context.setColorMode(M.colorModeForRenderPass()),function(wt,vt){var Dt=wt.context,Pt=Dt.gl,Ft=vt.heatmapFbo;if(Ft){Dt.activeTexture.set(Pt.TEXTURE0),Pt.bindTexture(Pt.TEXTURE_2D,Ft.colorAttachment.get()),Dt.activeTexture.set(Pt.TEXTURE1);var er=vt.colorRampTexture;er||(er=vt.colorRampTexture=new e.Texture(Dt,vt.colorRamp,Pt.RGBA)),er.bind(Pt.LINEAR,Pt.CLAMP_TO_EDGE),wt.useProgram("heatmapTexture").draw(Dt,Pt.TRIANGLES,Ie.disabled,be.disabled,wt.colorModeForRenderPass(),Pe.disabled,function(cr,Ar,Tr,Yr){var Gr=e.create();e.ortho(Gr,0,cr.width,cr.height,0,0,1);var an=cr.context.gl;return{u_matrix:Gr,u_world:[an.drawingBufferWidth,an.drawingBufferHeight],u_image:Tr,u_color_ramp:Yr,u_opacity:Ar.paint.get("heatmap-opacity")}}(wt,vt,0,1),vt.id,wt.viewportBuffer,wt.quadTriangleIndexBuffer,wt.viewportSegments,vt.paint,wt.transform.zoom)}}(M,R))},line:function(M,O,R,j){if(M.renderPass==="translucent"){var te=R.paint.get("line-opacity"),le=R.paint.get("line-width");if(te.constantOr(1)!==0&&le.constantOr(1)!==0){var pe=M.depthModeForSublayer(0,Ie.ReadOnly),ye=M.colorModeForRenderPass(),_e=R.paint.get("line-dasharray"),Ne=R.paint.get("line-pattern"),He=Ne.constantOr(1),et=R.paint.get("line-gradient"),yt=R.getCrossfadeParameters(),kt=He?"linePattern":_e?"lineSDF":et?"lineGradient":"line",_t=M.context,wt=_t.gl,vt=!0;if(et){_t.activeTexture.set(wt.TEXTURE0);var Dt=R.gradientTexture;if(!R.gradient)return;Dt||(Dt=R.gradientTexture=new e.Texture(_t,R.gradient,wt.RGBA)),Dt.bind(wt.LINEAR,wt.CLAMP_TO_EDGE)}for(var Pt=0,Ft=j;Pt<Ft.length;Pt+=1){var er=Ft[Pt],cr=O.getTile(er);if(!He||cr.patternsLoaded()){var Ar=cr.getBucket(R);if(Ar){var Tr=Ar.programConfigurations.get(R.id),Yr=M.context.program.get(),Gr=M.useProgram(kt,Tr),an=vt||Gr.program!==Yr,$r=Ne.constantOr(null);if($r&&cr.imageAtlas){var In=cr.imageAtlas,jn=In.patternPositions[$r.to.toString()],ia=In.patternPositions[$r.from.toString()];jn&&ia&&Tr.setConstantPatternPositions(jn,ia)}var jr=He?Fe(M,cr,R,yt):_e?Ve(M,cr,R,_e,yt):et?ja(M,cr,R):So(M,cr,R);He?(_t.activeTexture.set(wt.TEXTURE0),cr.imageAtlasTexture.bind(wt.LINEAR,wt.CLAMP_TO_EDGE),Tr.updatePaintBuffers(yt)):_e&&(an||M.lineAtlas.dirty)&&(_t.activeTexture.set(wt.TEXTURE0),M.lineAtlas.bind(_t)),Gr.draw(_t,wt.TRIANGLES,pe,M.stencilModeForClipping(er),ye,Pe.disabled,jr,R.id,Ar.layoutVertexBuffer,Ar.indexBuffer,Ar.segments,R.paint,M.transform.zoom,Tr),vt=!1}}}}}},fill:function(M,O,R,j){var te=R.paint.get("fill-color"),le=R.paint.get("fill-opacity");if(le.constantOr(1)!==0){var pe=M.colorModeForRenderPass(),ye=R.paint.get("fill-pattern"),_e=M.opaquePassEnabledForLayer()&&!ye.constantOr(1)&&te.constantOr(e.Color.transparent).a===1&&le.constantOr(0)===1?"opaque":"translucent";if(M.renderPass===_e){var Ne=M.depthModeForSublayer(1,M.renderPass==="opaque"?Ie.ReadWrite:Ie.ReadOnly);An(M,O,R,j,Ne,pe,!1)}if(M.renderPass==="translucent"&&R.paint.get("fill-antialias")){var He=M.depthModeForSublayer(R.getPaintProperty("fill-outline-color")?2:0,Ie.ReadOnly);An(M,O,R,j,He,pe,!0)}}},"fill-extrusion":function(M,O,R,j){var te=R.paint.get("fill-extrusion-opacity");if(te!==0&&M.renderPass==="translucent"){var le=new Ie(M.context.gl.LEQUAL,Ie.ReadWrite,M.depthRangeFor3D);if(te!==1||R.paint.get("fill-extrusion-pattern").constantOr(1))ha(M,O,R,j,le,be.disabled,Ae.disabled),ha(M,O,R,j,le,M.stencilModeFor3D(),M.colorModeForRenderPass());else{var pe=M.colorModeForRenderPass();ha(M,O,R,j,le,be.disabled,pe)}}},hillshade:function(M,O,R,j){if(M.renderPass==="offscreen"||M.renderPass==="translucent"){for(var te=M.context,le=O.getSource().maxzoom,pe=M.depthModeForSublayer(0,Ie.ReadOnly),ye=M.colorModeForRenderPass(),_e=M.renderPass==="translucent"?M.stencilConfigForOverlap(j):[{},j],Ne=_e[0],He=0,et=_e[1];He<et.length;He+=1){var yt=et[He],kt=O.getTile(yt);kt.needsHillshadePrepare&&M.renderPass==="offscreen"?Da(M,kt,R,le,pe,be.disabled,ye):M.renderPass==="translucent"&&wa(M,kt,R,pe,Ne[yt.overscaledZ],ye)}te.viewport.set([0,0,M.width,M.height])}},raster:function(M,O,R,j){if(M.renderPass==="translucent"&&R.paint.get("raster-opacity")!==0&&j.length)for(var te=M.context,le=te.gl,pe=O.getSource(),ye=M.useProgram("raster"),_e=M.colorModeForRenderPass(),Ne=pe instanceof Y?[{},j]:M.stencilConfigForOverlap(j),He=Ne[0],et=Ne[1],yt=et[et.length-1].overscaledZ,kt=!M.options.moving,_t=0,wt=et;_t<wt.length;_t+=1){var vt=wt[_t],Dt=M.depthModeForSublayer(vt.overscaledZ-yt,R.paint.get("raster-opacity")===1?Ie.ReadWrite:Ie.ReadOnly,le.LESS),Pt=O.getTile(vt),Ft=M.transform.calculatePosMatrix(vt.toUnwrapped(),kt);Pt.registerFadeDuration(R.paint.get("raster-fade-duration"));var er=O.findLoadedParent(vt,0),cr=za(Pt,er,O,R,M.transform),Ar=void 0,Tr=void 0,Yr=R.paint.get("raster-resampling")==="nearest"?le.NEAREST:le.LINEAR;te.activeTexture.set(le.TEXTURE0),Pt.texture.bind(Yr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),te.activeTexture.set(le.TEXTURE1),er?(er.texture.bind(Yr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),Ar=Math.pow(2,er.tileID.overscaledZ-Pt.tileID.overscaledZ),Tr=[Pt.tileID.canonical.x*Ar%1,Pt.tileID.canonical.y*Ar%1]):Pt.texture.bind(Yr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST);var Gr=dt(Ft,Tr||[0,0],Ar||1,cr,R);pe instanceof Y?ye.draw(te,le.TRIANGLES,Dt,be.disabled,_e,Pe.disabled,Gr,R.id,pe.boundsBuffer,M.quadTriangleIndexBuffer,pe.boundsSegments):ye.draw(te,le.TRIANGLES,Dt,He[vt.overscaledZ],_e,Pe.disabled,Gr,R.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments)}},background:function(M,O,R){var j=R.paint.get("background-color"),te=R.paint.get("background-opacity");if(te!==0){var le=M.context,pe=le.gl,ye=M.transform,_e=ye.tileSize,Ne=R.paint.get("background-pattern");if(!M.isPatternMissing(Ne)){var He=!Ne&&j.a===1&&te===1&&M.opaquePassEnabledForLayer()?"opaque":"translucent";if(M.renderPass===He){var et=be.disabled,yt=M.depthModeForSublayer(0,He==="opaque"?Ie.ReadWrite:Ie.ReadOnly),kt=M.colorModeForRenderPass(),_t=M.useProgram(Ne?"backgroundPattern":"background"),wt=ye.coveringTiles({tileSize:_e});Ne&&(le.activeTexture.set(pe.TEXTURE0),M.imageManager.bind(M.context));for(var vt=R.getCrossfadeParameters(),Dt=0,Pt=wt;Dt<Pt.length;Dt+=1){var Ft=Pt[Dt],er=M.transform.calculatePosMatrix(Ft.toUnwrapped()),cr=Ne?lr(er,te,M,Ne,{tileID:Ft,tileSize:_e},vt):tr(er,te,j);_t.draw(le,pe.TRIANGLES,yt,et,kt,Pe.disabled,cr,R.id,M.tileExtentBuffer,M.quadTriangleIndexBuffer,M.tileExtentSegments)}}}}},debug:function(M,O,R){for(var j=0;j<R.length;j++)Ki(M,O,R[j])},custom:function(M,O,R){var j=M.context,te=R.implementation;if(M.renderPass==="offscreen"){var le=te.prerender;le&&(M.setCustomLayerDefaults(),j.setColorMode(M.colorModeForRenderPass()),le.call(te,j.gl,M.transform.customLayerMatrix()),j.setDirty(),M.setBaseState())}else if(M.renderPass==="translucent"){M.setCustomLayerDefaults(),j.setColorMode(M.colorModeForRenderPass()),j.setStencilMode(be.disabled);var pe=te.renderingMode==="3d"?new Ie(M.context.gl.LEQUAL,Ie.ReadWrite,M.depthRangeFor3D):M.depthModeForSublayer(0,Ie.ReadOnly);j.setDepthMode(pe),te.render(j.gl,M.transform.customLayerMatrix()),j.setDirty(),M.setBaseState(),j.bindFramebuffer.set(null)}}},Ca=function(M,O){this.context=new ze(M),this.transform=O,this._tileTextures={},this.setup(),this.numSublayers=qe.maxUnderzooming+qe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ca,this.gpuTimers={}};Ca.prototype.resize=function(M,O){if(this.width=M*e.browser.devicePixelRatio,this.height=O*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var R=0,j=this.style._order;R<j.length;R+=1){var te=j[R];this.style._layers[te].resize()}},Ca.prototype.setup=function(){var M=this.context,O=new e.StructArrayLayout2i4;O.emplaceBack(0,0),O.emplaceBack(e.EXTENT,0),O.emplaceBack(0,e.EXTENT),O.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=M.createVertexBuffer(O,cn.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var R=new e.StructArrayLayout2i4;R.emplaceBack(0,0),R.emplaceBack(e.EXTENT,0),R.emplaceBack(0,e.EXTENT),R.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=M.createVertexBuffer(R,cn.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var j=new e.StructArrayLayout4i8;j.emplaceBack(0,0,0,0),j.emplaceBack(e.EXTENT,0,e.EXTENT,0),j.emplaceBack(0,e.EXTENT,0,e.EXTENT),j.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=M.createVertexBuffer(j,Z.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var te=new e.StructArrayLayout2i4;te.emplaceBack(0,0),te.emplaceBack(1,0),te.emplaceBack(0,1),te.emplaceBack(1,1),this.viewportBuffer=M.createVertexBuffer(te,cn.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var le=new e.StructArrayLayout1ui2;le.emplaceBack(0),le.emplaceBack(1),le.emplaceBack(3),le.emplaceBack(2),le.emplaceBack(0),this.tileBorderIndexBuffer=M.createIndexBuffer(le);var pe=new e.StructArrayLayout3ui6;pe.emplaceBack(0,1,2),pe.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=M.createIndexBuffer(pe),this.emptyTexture=new e.Texture(M,{width:1,height:1,data:new Uint8Array([0,0,0,0])},M.gl.RGBA);var ye=this.context.gl;this.stencilClearMode=new be({func:ye.ALWAYS,mask:0},0,255,ye.ZERO,ye.ZERO,ye.ZERO)},Ca.prototype.clearStencil=function(){var M=this.context,O=M.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var R=e.create();e.ortho(R,0,this.width,this.height,0,0,1),e.scale(R,R,[O.drawingBufferWidth,O.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(M,O.TRIANGLES,Ie.disabled,this.stencilClearMode,Ae.disabled,Pe.disabled,oo(R),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Ca.prototype._renderTileClippingMasks=function(M,O){if(this.currentStencilSource!==M.source&&M.isTileClipped()&&O&&O.length){this.currentStencilSource=M.source;var R=this.context,j=R.gl;this.nextStencilID+O.length>256&&this.clearStencil(),R.setColorMode(Ae.disabled),R.setDepthMode(Ie.disabled);var te=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var le=0,pe=O;le<pe.length;le+=1){var ye=pe[le],_e=this._tileClippingMaskIDs[ye.key]=this.nextStencilID++;te.draw(R,j.TRIANGLES,Ie.disabled,new be({func:j.ALWAYS,mask:0},_e,255,j.KEEP,j.KEEP,j.REPLACE),Ae.disabled,Pe.disabled,oo(ye.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Ca.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var M=this.nextStencilID++,O=this.context.gl;return new be({func:O.NOTEQUAL,mask:255},M,255,O.KEEP,O.KEEP,O.REPLACE)},Ca.prototype.stencilModeForClipping=function(M){var O=this.context.gl;return new be({func:O.EQUAL,mask:255},this._tileClippingMaskIDs[M.key],0,O.KEEP,O.KEEP,O.REPLACE)},Ca.prototype.stencilConfigForOverlap=function(M){var O,R=this.context.gl,j=M.sort(function(_e,Ne){return Ne.overscaledZ-_e.overscaledZ}),te=j[j.length-1].overscaledZ,le=j[0].overscaledZ-te+1;if(le>1){this.currentStencilSource=void 0,this.nextStencilID+le>256&&this.clearStencil();for(var pe={},ye=0;ye<le;ye++)pe[ye+te]=new be({func:R.GEQUAL,mask:255},ye+this.nextStencilID,255,R.KEEP,R.KEEP,R.REPLACE);return this.nextStencilID+=le,[pe,j]}return[(O={},O[te]=be.disabled,O),j]},Ca.prototype.colorModeForRenderPass=function(){var M=this.context.gl;return this._showOverdrawInspector?new Ae([M.CONSTANT_COLOR,M.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ae.unblended:Ae.alphaBlended},Ca.prototype.depthModeForSublayer=function(M,O,R){if(!this.opaquePassEnabledForLayer())return Ie.disabled;var j=1-((1+this.currentLayer)*this.numSublayers+M)*this.depthEpsilon;return new Ie(R||this.context.gl.LEQUAL,O,[j,j])},Ca.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Ca.prototype.render=function(M,O){var R=this;this.style=M,this.options=O,this.lineAtlas=M.lineAtlas,this.imageManager=M.imageManager,this.glyphManager=M.glyphManager,this.symbolFadeChange=M.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var j=this.style._order,te=this.style.sourceCaches;for(var le in te){var pe=te[le];pe.used&&pe.prepare(this.context)}var ye,_e,Ne={},He={},et={};for(var yt in te){var kt=te[yt];Ne[yt]=kt.getVisibleCoordinates(),He[yt]=Ne[yt].slice().reverse(),et[yt]=kt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var _t=0;_t<j.length;_t++){var wt=j[_t];if(this.style._layers[wt].is3D()){this.opaquePassCutoff=_t;break}}this.renderPass="offscreen";for(var vt=0,Dt=j;vt<Dt.length;vt+=1){var Pt=Dt[vt],Ft=this.style._layers[Pt];if(Ft.hasOffscreenPass()&&!Ft.isHidden(this.transform.zoom)){var er=He[Ft.source];(Ft.type==="custom"||er.length)&&this.renderLayer(this,te[Ft.source],Ft,er)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:O.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=O.showOverdrawInspector,this.depthRangeFor3D=[0,1-(M._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=j.length-1;this.currentLayer>=0;this.currentLayer--){var cr=this.style._layers[j[this.currentLayer]],Ar=te[cr.source],Tr=Ne[cr.source];this._renderTileClippingMasks(cr,Tr),this.renderLayer(this,Ar,cr,Tr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<j.length;this.currentLayer++){var Yr=this.style._layers[j[this.currentLayer]],Gr=te[Yr.source],an=(Yr.type==="symbol"?et:He)[Yr.source];this._renderTileClippingMasks(Yr,Ne[Yr.source]),this.renderLayer(this,Gr,Yr,an)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function($r){$r.source&&!$r.isHidden(R.transform.zoom)&&($r.source!==(_e&&_e.id)&&(_e=R.style.sourceCaches[$r.source]),(!ye||ye.getSource().maxzoom<_e.getSource().maxzoom)&&(ye=_e))}),ye&&Qi.debug(this,ye,ye.getVisibleCoordinates())),this.options.showPadding&&mi(this),this.context.setDefault()},Ca.prototype.renderLayer=function(M,O,R,j){R.isHidden(this.transform.zoom)||(R.type==="background"||R.type==="custom"||j.length)&&(this.id=R.id,this.gpuTimingStart(R),Qi[R.type](M,O,R,j,this.style.placement.variableOffsets),this.gpuTimingEnd())},Ca.prototype.gpuTimingStart=function(M){if(this.options.gpuTiming){var O=this.context.extTimerQuery,R=this.gpuTimers[M.id];R||(R=this.gpuTimers[M.id]={calls:0,cpuTime:0,query:O.createQueryEXT()}),R.calls++,O.beginQueryEXT(O.TIME_ELAPSED_EXT,R.query)}},Ca.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var M=this.context.extTimerQuery;M.endQueryEXT(M.TIME_ELAPSED_EXT)}},Ca.prototype.collectGpuTimers=function(){var M=this.gpuTimers;return this.gpuTimers={},M},Ca.prototype.queryGpuTimers=function(M){var O={};for(var R in M){var j=M[R],te=this.context.extTimerQuery,le=te.getQueryObjectEXT(j.query,te.QUERY_RESULT_EXT)/1e6;te.deleteQueryEXT(j.query),O[R]=le}return O},Ca.prototype.translatePosMatrix=function(M,O,R,j,te){if(!R[0]&&!R[1])return M;var le=te?j==="map"?this.transform.angle:0:j==="viewport"?-this.transform.angle:0;if(le){var pe=Math.sin(le),ye=Math.cos(le);R=[R[0]*ye-R[1]*pe,R[0]*pe+R[1]*ye]}var _e=[te?R[0]:br(O,R[0],this.transform.zoom),te?R[1]:br(O,R[1],this.transform.zoom),0],Ne=new Float32Array(16);return e.translate(Ne,M,_e),Ne},Ca.prototype.saveTileTexture=function(M){var O=this._tileTextures[M.size[0]];O?O.push(M):this._tileTextures[M.size[0]]=[M]},Ca.prototype.getTileTexture=function(M){var O=this._tileTextures[M];return O&&O.length>0?O.pop():null},Ca.prototype.isPatternMissing=function(M){if(!M)return!1;if(!M.from||!M.to)return!0;var O=this.imageManager.getPattern(M.from.toString()),R=this.imageManager.getPattern(M.to.toString());return!O||!R},Ca.prototype.useProgram=function(M,O){this.cache=this.cache||{};var R=""+M+(O?O.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[R]||(this.cache[R]=new _s(this.context,us[M],O,hr[M],this._showOverdrawInspector)),this.cache[R]},Ca.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Ca.prototype.setBaseState=function(){var M=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(M.FUNC_ADD)},Ca.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var M=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,M.RGBA)}},Ca.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ut=function(M,O){this.points=M,this.planes=O};ut.fromInvProjectionMatrix=function(M,O,R){var j=Math.pow(2,R),te=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(pe){return e.transformMat4([],pe,M)}).map(function(pe){return e.scale$1([],pe,1/pe[3]/O*j)}),le=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(pe){var ye=e.sub([],te[pe[0]],te[pe[1]]),_e=e.sub([],te[pe[2]],te[pe[1]]),Ne=e.normalize([],e.cross([],ye,_e)),He=-e.dot(Ne,te[pe[1]]);return Ne.concat(He)});return new ut(te,le)};var Ot=function(M,O){this.min=M,this.max=O,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Ot.prototype.quadrant=function(M){for(var O=[M%2==0,M<2],R=e.clone$2(this.min),j=e.clone$2(this.max),te=0;te<O.length;te++)R[te]=O[te]?this.min[te]:this.center[te],j[te]=O[te]?this.center[te]:this.max[te];return j[2]=this.max[2],new Ot(R,j)},Ot.prototype.distanceX=function(M){return Math.max(Math.min(this.max[0],M[0]),this.min[0])-M[0]},Ot.prototype.distanceY=function(M){return Math.max(Math.min(this.max[1],M[1]),this.min[1])-M[1]},Ot.prototype.intersects=function(M){for(var O=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],R=!0,j=0;j<M.planes.length;j++){for(var te=M.planes[j],le=0,pe=0;pe<O.length;pe++)le+=e.dot$1(te,O[pe])>=0;if(le===0)return 0;le!==O.length&&(R=!1)}if(R)return 2;for(var ye=0;ye<3;ye++){for(var _e=Number.MAX_VALUE,Ne=-Number.MAX_VALUE,He=0;He<M.points.length;He++){var et=M.points[He][ye]-this.min[ye];_e=Math.min(_e,et),Ne=Math.max(Ne,et)}if(Ne<0||_e>this.max[ye]-this.min[ye])return 0}return 1};var ir=function(M,O,R,j){if(M===void 0&&(M=0),O===void 0&&(O=0),R===void 0&&(R=0),j===void 0&&(j=0),isNaN(M)||M<0||isNaN(O)||O<0||isNaN(R)||R<0||isNaN(j)||j<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=M,this.bottom=O,this.left=R,this.right=j};ir.prototype.interpolate=function(M,O,R){return O.top!=null&&M.top!=null&&(this.top=e.number(M.top,O.top,R)),O.bottom!=null&&M.bottom!=null&&(this.bottom=e.number(M.bottom,O.bottom,R)),O.left!=null&&M.left!=null&&(this.left=e.number(M.left,O.left,R)),O.right!=null&&M.right!=null&&(this.right=e.number(M.right,O.right,R)),this},ir.prototype.getCenter=function(M,O){var R=e.clamp((this.left+M-this.right)/2,0,M),j=e.clamp((this.top+O-this.bottom)/2,0,O);return new e.Point(R,j)},ir.prototype.equals=function(M){return this.top===M.top&&this.bottom===M.bottom&&this.left===M.left&&this.right===M.right},ir.prototype.clone=function(){return new ir(this.top,this.bottom,this.left,this.right)},ir.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Vt=function(M,O,R,j,te){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=te===void 0||te,this._minZoom=M||0,this._maxZoom=O||22,this._minPitch=R??0,this._maxPitch=j??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ir,this._posMatrixCache={},this._alignedPosMatrixCache={}},sr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Vt.prototype.clone=function(){var M=new Vt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return M.tileSize=this.tileSize,M.latRange=this.latRange,M.width=this.width,M.height=this.height,M._center=this._center,M.zoom=this.zoom,M.angle=this.angle,M._fov=this._fov,M._pitch=this._pitch,M._unmodified=this._unmodified,M._edgeInsets=this._edgeInsets.clone(),M._calcMatrices(),M},sr.minZoom.get=function(){return this._minZoom},sr.minZoom.set=function(M){this._minZoom!==M&&(this._minZoom=M,this.zoom=Math.max(this.zoom,M))},sr.maxZoom.get=function(){return this._maxZoom},sr.maxZoom.set=function(M){this._maxZoom!==M&&(this._maxZoom=M,this.zoom=Math.min(this.zoom,M))},sr.minPitch.get=function(){return this._minPitch},sr.minPitch.set=function(M){this._minPitch!==M&&(this._minPitch=M,this.pitch=Math.max(this.pitch,M))},sr.maxPitch.get=function(){return this._maxPitch},sr.maxPitch.set=function(M){this._maxPitch!==M&&(this._maxPitch=M,this.pitch=Math.min(this.pitch,M))},sr.renderWorldCopies.get=function(){return this._renderWorldCopies},sr.renderWorldCopies.set=function(M){M===void 0?M=!0:M===null&&(M=!1),this._renderWorldCopies=M},sr.worldSize.get=function(){return this.tileSize*this.scale},sr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},sr.size.get=function(){return new e.Point(this.width,this.height)},sr.bearing.get=function(){return-this.angle/Math.PI*180},sr.bearing.set=function(M){var O=-e.wrap(M,-180,180)*Math.PI/180;this.angle!==O&&(this._unmodified=!1,this.angle=O,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},sr.pitch.get=function(){return this._pitch/Math.PI*180},sr.pitch.set=function(M){var O=e.clamp(M,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==O&&(this._unmodified=!1,this._pitch=O,this._calcMatrices())},sr.fov.get=function(){return this._fov/Math.PI*180},sr.fov.set=function(M){M=Math.max(.01,Math.min(60,M)),this._fov!==M&&(this._unmodified=!1,this._fov=M/180*Math.PI,this._calcMatrices())},sr.zoom.get=function(){return this._zoom},sr.zoom.set=function(M){var O=Math.min(Math.max(M,this.minZoom),this.maxZoom);this._zoom!==O&&(this._unmodified=!1,this._zoom=O,this.scale=this.zoomScale(O),this.tileZoom=Math.floor(O),this.zoomFraction=O-this.tileZoom,this._constrain(),this._calcMatrices())},sr.center.get=function(){return this._center},sr.center.set=function(M){M.lat===this._center.lat&&M.lng===this._center.lng||(this._unmodified=!1,this._center=M,this._constrain(),this._calcMatrices())},sr.padding.get=function(){return this._edgeInsets.toJSON()},sr.padding.set=function(M){this._edgeInsets.equals(M)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,M,1),this._calcMatrices())},sr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Vt.prototype.isPaddingEqual=function(M){return this._edgeInsets.equals(M)},Vt.prototype.interpolatePadding=function(M,O,R){this._unmodified=!1,this._edgeInsets.interpolate(M,O,R),this._constrain(),this._calcMatrices()},Vt.prototype.coveringZoomLevel=function(M){var O=(M.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/M.tileSize));return Math.max(0,O)},Vt.prototype.getVisibleUnwrappedCoordinates=function(M){var O=[new e.UnwrappedTileID(0,M)];if(this._renderWorldCopies)for(var R=this.pointCoordinate(new e.Point(0,0)),j=this.pointCoordinate(new e.Point(this.width,0)),te=this.pointCoordinate(new e.Point(this.width,this.height)),le=this.pointCoordinate(new e.Point(0,this.height)),pe=Math.floor(Math.min(R.x,j.x,te.x,le.x)),ye=Math.floor(Math.max(R.x,j.x,te.x,le.x)),_e=pe-1;_e<=ye+1;_e++)_e!==0&&O.push(new e.UnwrappedTileID(_e,M));return O},Vt.prototype.coveringTiles=function(M){var O=this.coveringZoomLevel(M),R=O;if(M.minzoom!==void 0&&O<M.minzoom)return[];M.maxzoom!==void 0&&O>M.maxzoom&&(O=M.maxzoom);var j=e.MercatorCoordinate.fromLngLat(this.center),te=Math.pow(2,O),le=[te*j.x,te*j.y,0],pe=ut.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,O),ye=M.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ye=O);var _e=function(an){return{aabb:new Ot([an*te,0,0],[(an+1)*te,te,0]),zoom:0,x:0,y:0,wrap:an,fullyVisible:!1}},Ne=[],He=[],et=O,yt=M.reparseOverscaled?R:O;if(this._renderWorldCopies)for(var kt=1;kt<=3;kt++)Ne.push(_e(-kt)),Ne.push(_e(kt));for(Ne.push(_e(0));Ne.length>0;){var _t=Ne.pop(),wt=_t.x,vt=_t.y,Dt=_t.fullyVisible;if(!Dt){var Pt=_t.aabb.intersects(pe);if(Pt===0)continue;Dt=Pt===2}var Ft=_t.aabb.distanceX(le),er=_t.aabb.distanceY(le),cr=Math.max(Math.abs(Ft),Math.abs(er)),Ar=3+(1<<et-_t.zoom)-2;if(_t.zoom===et||cr>Ar&&_t.zoom>=ye)He.push({tileID:new e.OverscaledTileID(_t.zoom===et?yt:_t.zoom,_t.wrap,_t.zoom,wt,vt),distanceSq:e.sqrLen([le[0]-.5-wt,le[1]-.5-vt])});else for(var Tr=0;Tr<4;Tr++){var Yr=(wt<<1)+Tr%2,Gr=(vt<<1)+(Tr>>1);Ne.push({aabb:_t.aabb.quadrant(Tr),zoom:_t.zoom+1,x:Yr,y:Gr,wrap:_t.wrap,fullyVisible:Dt})}}return He.sort(function(an,$r){return an.distanceSq-$r.distanceSq}).map(function(an){return an.tileID})},Vt.prototype.resize=function(M,O){this.width=M,this.height=O,this.pixelsToGLUnits=[2/M,-2/O],this._constrain(),this._calcMatrices()},sr.unmodified.get=function(){return this._unmodified},Vt.prototype.zoomScale=function(M){return Math.pow(2,M)},Vt.prototype.scaleZoom=function(M){return Math.log(M)/Math.LN2},Vt.prototype.project=function(M){var O=e.clamp(M.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(M.lng)*this.worldSize,e.mercatorYfromLat(O)*this.worldSize)},Vt.prototype.unproject=function(M){return new e.MercatorCoordinate(M.x/this.worldSize,M.y/this.worldSize).toLngLat()},sr.point.get=function(){return this.project(this.center)},Vt.prototype.setLocationAtPoint=function(M,O){var R=this.pointCoordinate(O),j=this.pointCoordinate(this.centerPoint),te=this.locationCoordinate(M),le=new e.MercatorCoordinate(te.x-(R.x-j.x),te.y-(R.y-j.y));this.center=this.coordinateLocation(le),this._renderWorldCopies&&(this.center=this.center.wrap())},Vt.prototype.locationPoint=function(M){return this.coordinatePoint(this.locationCoordinate(M))},Vt.prototype.pointLocation=function(M){return this.coordinateLocation(this.pointCoordinate(M))},Vt.prototype.locationCoordinate=function(M){return e.MercatorCoordinate.fromLngLat(M)},Vt.prototype.coordinateLocation=function(M){return M.toLngLat()},Vt.prototype.pointCoordinate=function(M){var O=[M.x,M.y,0,1],R=[M.x,M.y,1,1];e.transformMat4(O,O,this.pixelMatrixInverse),e.transformMat4(R,R,this.pixelMatrixInverse);var j=O[3],te=R[3],le=O[0]/j,pe=R[0]/te,ye=O[1]/j,_e=R[1]/te,Ne=O[2]/j,He=R[2]/te,et=Ne===He?0:(0-Ne)/(He-Ne);return new e.MercatorCoordinate(e.number(le,pe,et)/this.worldSize,e.number(ye,_e,et)/this.worldSize)},Vt.prototype.coordinatePoint=function(M){var O=[M.x*this.worldSize,M.y*this.worldSize,0,1];return e.transformMat4(O,O,this.pixelMatrix),new e.Point(O[0]/O[3],O[1]/O[3])},Vt.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},Vt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Vt.prototype.setMaxBounds=function(M){M?(this.lngRange=[M.getWest(),M.getEast()],this.latRange=[M.getSouth(),M.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Vt.prototype.calculatePosMatrix=function(M,O){O===void 0&&(O=!1);var R=M.key,j=O?this._alignedPosMatrixCache:this._posMatrixCache;if(j[R])return j[R];var te=M.canonical,le=this.worldSize/this.zoomScale(te.z),pe=te.x+Math.pow(2,te.z)*M.wrap,ye=e.identity(new Float64Array(16));return e.translate(ye,ye,[pe*le,te.y*le,0]),e.scale(ye,ye,[le/e.EXTENT,le/e.EXTENT,1]),e.multiply(ye,O?this.alignedProjMatrix:this.projMatrix,ye),j[R]=new Float32Array(ye),j[R]},Vt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Vt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var M,O,R,j,te=-90,le=90,pe=-180,ye=180,_e=this.size,Ne=this._unmodified;if(this.latRange){var He=this.latRange;te=e.mercatorYfromLat(He[1])*this.worldSize,M=(le=e.mercatorYfromLat(He[0])*this.worldSize)-te<_e.y?_e.y/(le-te):0}if(this.lngRange){var et=this.lngRange;pe=e.mercatorXfromLng(et[0])*this.worldSize,O=(ye=e.mercatorXfromLng(et[1])*this.worldSize)-pe<_e.x?_e.x/(ye-pe):0}var yt=this.point,kt=Math.max(O||0,M||0);if(kt)return this.center=this.unproject(new e.Point(O?(ye+pe)/2:yt.x,M?(le+te)/2:yt.y)),this.zoom+=this.scaleZoom(kt),this._unmodified=Ne,void(this._constraining=!1);if(this.latRange){var _t=yt.y,wt=_e.y/2;_t-wt<te&&(j=te+wt),_t+wt>le&&(j=le-wt)}if(this.lngRange){var vt=yt.x,Dt=_e.x/2;vt-Dt<pe&&(R=pe+Dt),vt+Dt>ye&&(R=ye-Dt)}R===void 0&&j===void 0||(this.center=this.unproject(new e.Point(R!==void 0?R:yt.x,j!==void 0?j:yt.y))),this._unmodified=Ne,this._constraining=!1}},Vt.prototype._calcMatrices=function(){if(this.height){var M=this._fov/2,O=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(M)*this.height;var R=Math.PI/2+this._pitch,j=this._fov*(.5+O.y/this.height),te=Math.sin(j)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-R-j,.01,Math.PI-.01)),le=this.point,pe=le.x,ye=le.y,_e=1.01*(Math.cos(Math.PI/2-this._pitch)*te+this.cameraToCenterDistance),Ne=this.height/50,He=new Float64Array(16);e.perspective(He,this._fov,this.width/this.height,Ne,_e),He[8]=2*-O.x/this.width,He[9]=2*O.y/this.height,e.scale(He,He,[1,-1,1]),e.translate(He,He,[0,0,-this.cameraToCenterDistance]),e.rotateX(He,He,this._pitch),e.rotateZ(He,He,this.angle),e.translate(He,He,[-pe,-ye,0]),this.mercatorMatrix=e.scale([],He,[this.worldSize,this.worldSize,this.worldSize]),e.scale(He,He,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=He,this.invProjMatrix=e.invert([],this.projMatrix);var et=this.width%2/2,yt=this.height%2/2,kt=Math.cos(this.angle),_t=Math.sin(this.angle),wt=pe-Math.round(pe)+kt*et+_t*yt,vt=ye-Math.round(ye)+kt*yt+_t*et,Dt=new Float64Array(He);if(e.translate(Dt,Dt,[wt>.5?wt-1:wt,vt>.5?vt-1:vt,0]),this.alignedProjMatrix=Dt,He=e.create(),e.scale(He,He,[this.width/2,-this.height/2,1]),e.translate(He,He,[1,-1,0]),this.labelPlaneMatrix=He,He=e.create(),e.scale(He,He,[1,-1,1]),e.translate(He,He,[-1,-1,0]),e.scale(He,He,[2/this.width,2/this.height,1]),this.glCoordMatrix=He,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(He=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=He,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Vt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var M=this.pointCoordinate(new e.Point(0,0)),O=[M.x*this.worldSize,M.y*this.worldSize,0,1];return e.transformMat4(O,O,this.pixelMatrix)[3]/this.cameraToCenterDistance},Vt.prototype.getCameraPoint=function(){var M=this._pitch,O=Math.tan(M)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,O))},Vt.prototype.getCameraQueryGeometry=function(M){var O=this.getCameraPoint();if(M.length===1)return[M[0],O];for(var R=O.x,j=O.y,te=O.x,le=O.y,pe=0,ye=M;pe<ye.length;pe+=1){var _e=ye[pe];R=Math.min(R,_e.x),j=Math.min(j,_e.y),te=Math.max(te,_e.x),le=Math.max(le,_e.y)}return[new e.Point(R,j),new e.Point(te,j),new e.Point(te,le),new e.Point(R,le),new e.Point(R,j)]},Object.defineProperties(Vt.prototype,sr);var Cr=function(M){var O,R,j,te,le;this._hashName=M&&encodeURIComponent(M),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(O=this._updateHashUnthrottled.bind(this),R=300,j=!1,te=null,le=function(){te=null,j&&(O(),te=setTimeout(le,R),j=!1)},function(){return j=!0,te||le(),te})};Cr.prototype.addTo=function(M){return this._map=M,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Cr.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Cr.prototype.getHashString=function(M){var O=this._map.getCenter(),R=Math.round(100*this._map.getZoom())/100,j=Math.ceil((R*Math.LN2+Math.log(512/360/.5))/Math.LN10),te=Math.pow(10,j),le=Math.round(O.lng*te)/te,pe=Math.round(O.lat*te)/te,ye=this._map.getBearing(),_e=this._map.getPitch(),Ne="";if(Ne+=M?"/"+le+"/"+pe+"/"+R:R+"/"+pe+"/"+le,(ye||_e)&&(Ne+="/"+Math.round(10*ye)/10),_e&&(Ne+="/"+Math.round(_e)),this._hashName){var He=this._hashName,et=!1,yt=e.window.location.hash.slice(1).split("&").map(function(kt){var _t=kt.split("=")[0];return _t===He?(et=!0,_t+"="+Ne):kt}).filter(function(kt){return kt});return et||yt.push(He+"="+Ne),"#"+yt.join("&")}return"#"+Ne},Cr.prototype._getCurrentHash=function(){var M,O=this,R=e.window.location.hash.replace("#","");return this._hashName?(R.split("&").map(function(j){return j.split("=")}).forEach(function(j){j[0]===O._hashName&&(M=j)}),(M&&M[1]||"").split("/")):R.split("/")},Cr.prototype._onHashChange=function(){var M=this._getCurrentHash();if(M.length>=3&&!M.some(function(R){return isNaN(R)})){var O=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(M[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+M[2],+M[1]],zoom:+M[0],bearing:O,pitch:+(M[4]||0)}),!0}return!1},Cr.prototype._updateHashUnthrottled=function(){var M=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",M)}catch{}};var Or={linearity:.3,easing:e.bezier(0,0,.3,1)},qr=e.extend({deceleration:2500,maxSpeed:1400},Or),en=e.extend({deceleration:20,maxSpeed:1400},Or),Kr=e.extend({deceleration:1e3,maxSpeed:360},Or),sn=e.extend({deceleration:1e3,maxSpeed:90},Or),pn=function(M){this._map=M,this.clear()};function tn(M,O){(!M.duration||M.duration<O.duration)&&(M.duration=O.duration,M.easing=O.easing)}function dn(M,O,R){var j=R.maxSpeed,te=R.linearity,le=R.deceleration,pe=e.clamp(M*te/(O/1e3),-j,j),ye=Math.abs(pe)/(le*te);return{easing:R.easing,duration:1e3*ye,amount:pe*(ye/2)}}pn.prototype.clear=function(){this._inertiaBuffer=[]},pn.prototype.record=function(M){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:M})},pn.prototype._drainInertiaBuffer=function(){for(var M=this._inertiaBuffer,O=e.browser.now();M.length>0&&O-M[0].time>160;)M.shift()},pn.prototype._onMoveEnd=function(M){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var O={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},R=0,j=this._inertiaBuffer;R<j.length;R+=1){var te=j[R].settings;O.zoom+=te.zoomDelta||0,O.bearing+=te.bearingDelta||0,O.pitch+=te.pitchDelta||0,te.panDelta&&O.pan._add(te.panDelta),te.around&&(O.around=te.around),te.pinchAround&&(O.pinchAround=te.pinchAround)}var le=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,pe={};if(O.pan.mag()){var ye=dn(O.pan.mag(),le,e.extend({},qr,M||{}));pe.offset=O.pan.mult(ye.amount/O.pan.mag()),pe.center=this._map.transform.center,tn(pe,ye)}if(O.zoom){var _e=dn(O.zoom,le,en);pe.zoom=this._map.transform.zoom+_e.amount,tn(pe,_e)}if(O.bearing){var Ne=dn(O.bearing,le,Kr);pe.bearing=this._map.transform.bearing+e.clamp(Ne.amount,-179,179),tn(pe,Ne)}if(O.pitch){var He=dn(O.pitch,le,sn);pe.pitch=this._map.transform.pitch+He.amount,tn(pe,He)}if(pe.zoom||pe.bearing){var et=O.pinchAround===void 0?O.around:O.pinchAround;pe.around=et?this._map.unproject(et):this._map.getCenter()}return this.clear(),e.extend(pe,{noMoveStart:!0})}};var Sn=function(M){function O(j,te,le,pe){pe===void 0&&(pe={});var ye=o.mousePos(te.getCanvasContainer(),le),_e=te.unproject(ye);M.call(this,j,e.extend({point:ye,lngLat:_e,originalEvent:le},pe)),this._defaultPrevented=!1,this.target=te}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var R={defaultPrevented:{configurable:!0}};return O.prototype.preventDefault=function(){this._defaultPrevented=!0},R.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(O.prototype,R),O}(e.Event),Dn=function(M){function O(j,te,le){var pe=j==="touchend"?le.changedTouches:le.touches,ye=o.touchPos(te.getCanvasContainer(),pe),_e=ye.map(function(et){return te.unproject(et)}),Ne=ye.reduce(function(et,yt,kt,_t){return et.add(yt.div(_t.length))},new e.Point(0,0)),He=te.unproject(Ne);M.call(this,j,{points:ye,point:Ne,lngLats:_e,lngLat:He,originalEvent:le}),this._defaultPrevented=!1}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var R={defaultPrevented:{configurable:!0}};return O.prototype.preventDefault=function(){this._defaultPrevented=!0},R.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(O.prototype,R),O}(e.Event),Qn=function(M){function O(j,te,le){M.call(this,j,{originalEvent:le}),this._defaultPrevented=!1}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var R={defaultPrevented:{configurable:!0}};return O.prototype.preventDefault=function(){this._defaultPrevented=!0},R.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(O.prototype,R),O}(e.Event),Hr=function(M,O){this._map=M,this._clickTolerance=O.clickTolerance};Hr.prototype.reset=function(){delete this._mousedownPos},Hr.prototype.wheel=function(M){return this._firePreventable(new Qn(M.type,this._map,M))},Hr.prototype.mousedown=function(M,O){return this._mousedownPos=O,this._firePreventable(new Sn(M.type,this._map,M))},Hr.prototype.mouseup=function(M){this._map.fire(new Sn(M.type,this._map,M))},Hr.prototype.click=function(M,O){this._mousedownPos&&this._mousedownPos.dist(O)>=this._clickTolerance||this._map.fire(new Sn(M.type,this._map,M))},Hr.prototype.dblclick=function(M){return this._firePreventable(new Sn(M.type,this._map,M))},Hr.prototype.mouseover=function(M){this._map.fire(new Sn(M.type,this._map,M))},Hr.prototype.mouseout=function(M){this._map.fire(new Sn(M.type,this._map,M))},Hr.prototype.touchstart=function(M){return this._firePreventable(new Dn(M.type,this._map,M))},Hr.prototype.touchmove=function(M){this._map.fire(new Dn(M.type,this._map,M))},Hr.prototype.touchend=function(M){this._map.fire(new Dn(M.type,this._map,M))},Hr.prototype.touchcancel=function(M){this._map.fire(new Dn(M.type,this._map,M))},Hr.prototype._firePreventable=function(M){if(this._map.fire(M),M.defaultPrevented)return{}},Hr.prototype.isEnabled=function(){return!0},Hr.prototype.isActive=function(){return!1},Hr.prototype.enable=function(){},Hr.prototype.disable=function(){};var Xn=function(M){this._map=M};Xn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Xn.prototype.mousemove=function(M){this._map.fire(new Sn(M.type,this._map,M))},Xn.prototype.mousedown=function(){this._delayContextMenu=!0},Xn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Sn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Xn.prototype.contextmenu=function(M){this._delayContextMenu?this._contextMenuEvent=M:this._map.fire(new Sn(M.type,this._map,M)),this._map.listens("contextmenu")&&M.preventDefault()},Xn.prototype.isEnabled=function(){return!0},Xn.prototype.isActive=function(){return!1},Xn.prototype.enable=function(){},Xn.prototype.disable=function(){};var Tn=function(M,O){this._map=M,this._el=M.getCanvasContainer(),this._container=M.getContainer(),this._clickTolerance=O.clickTolerance||1};function Cn(M,O){for(var R={},j=0;j<M.length;j++)R[M[j].identifier]=O[j];return R}Tn.prototype.isEnabled=function(){return!!this._enabled},Tn.prototype.isActive=function(){return!!this._active},Tn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Tn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Tn.prototype.mousedown=function(M,O){this.isEnabled()&&M.shiftKey&&M.button===0&&(o.disableDrag(),this._startPos=this._lastPos=O,this._active=!0)},Tn.prototype.mousemoveWindow=function(M,O){if(this._active){var R=O;if(!(this._lastPos.equals(R)||!this._box&&R.dist(this._startPos)<this._clickTolerance)){var j=this._startPos;this._lastPos=R,this._box||(this._box=o.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",M));var te=Math.min(j.x,R.x),le=Math.max(j.x,R.x),pe=Math.min(j.y,R.y),ye=Math.max(j.y,R.y);o.setTransform(this._box,"translate("+te+"px,"+pe+"px)"),this._box.style.width=le-te+"px",this._box.style.height=ye-pe+"px"}}},Tn.prototype.mouseupWindow=function(M,O){var R=this;if(this._active&&M.button===0){var j=this._startPos,te=O;if(this.reset(),o.suppressClick(),j.x!==te.x||j.y!==te.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:M})),{cameraAnimation:function(le){return le.fitScreenCoordinates(j,te,R._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",M)}},Tn.prototype.keydown=function(M){this._active&&M.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",M))},Tn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(o.remove(this._box),this._box=null),o.enableDrag(),delete this._startPos,delete this._lastPos},Tn.prototype._fireEvent=function(M,O){return this._map.fire(new e.Event(M,{originalEvent:O}))};var Yn=function(M){this.reset(),this.numTouches=M.numTouches};Yn.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Yn.prototype.touchstart=function(M,O,R){(this.centroid||R.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=M.timeStamp),R.length===this.numTouches&&(this.centroid=function(j){for(var te=new e.Point(0,0),le=0,pe=j;le<pe.length;le+=1){var ye=pe[le];te._add(ye)}return te.div(j.length)}(O),this.touches=Cn(R,O)))},Yn.prototype.touchmove=function(M,O,R){if(!this.aborted&&this.centroid){var j=Cn(R,O);for(var te in this.touches){var le=this.touches[te],pe=j[te];(!pe||pe.dist(le)>30)&&(this.aborted=!0)}}},Yn.prototype.touchend=function(M,O,R){if((!this.centroid||M.timeStamp-this.startTime>500)&&(this.aborted=!0),R.length===0){var j=!this.aborted&&this.centroid;if(this.reset(),j)return j}};var _a=function(M){this.singleTap=new Yn(M),this.numTaps=M.numTaps,this.reset()};_a.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},_a.prototype.touchstart=function(M,O,R){this.singleTap.touchstart(M,O,R)},_a.prototype.touchmove=function(M,O,R){this.singleTap.touchmove(M,O,R)},_a.prototype.touchend=function(M,O,R){var j=this.singleTap.touchend(M,O,R);if(j){var te=M.timeStamp-this.lastTime<500,le=!this.lastTap||this.lastTap.dist(j)<30;if(te&&le||this.reset(),this.count++,this.lastTime=M.timeStamp,this.lastTap=j,this.count===this.numTaps)return this.reset(),j}};var Sa=function(){this._zoomIn=new _a({numTouches:1,numTaps:2}),this._zoomOut=new _a({numTouches:2,numTaps:1}),this.reset()};Sa.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Sa.prototype.touchstart=function(M,O,R){this._zoomIn.touchstart(M,O,R),this._zoomOut.touchstart(M,O,R)},Sa.prototype.touchmove=function(M,O,R){this._zoomIn.touchmove(M,O,R),this._zoomOut.touchmove(M,O,R)},Sa.prototype.touchend=function(M,O,R){var j=this,te=this._zoomIn.touchend(M,O,R),le=this._zoomOut.touchend(M,O,R);return te?(this._active=!0,M.preventDefault(),setTimeout(function(){return j.reset()},0),{cameraAnimation:function(pe){return pe.easeTo({duration:300,zoom:pe.getZoom()+1,around:pe.unproject(te)},{originalEvent:M})}}):le?(this._active=!0,M.preventDefault(),setTimeout(function(){return j.reset()},0),{cameraAnimation:function(pe){return pe.easeTo({duration:300,zoom:pe.getZoom()-1,around:pe.unproject(le)},{originalEvent:M})}}):void 0},Sa.prototype.touchcancel=function(){this.reset()},Sa.prototype.enable=function(){this._enabled=!0},Sa.prototype.disable=function(){this._enabled=!1,this.reset()},Sa.prototype.isEnabled=function(){return this._enabled},Sa.prototype.isActive=function(){return this._active};var yn=function(M){this.reset(),this._clickTolerance=M.clickTolerance||1};yn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},yn.prototype._correctButton=function(M,O){return!1},yn.prototype._move=function(M,O){return{}},yn.prototype.mousedown=function(M,O){if(!this._lastPoint){var R=o.mouseButton(M);this._correctButton(M,R)&&(this._lastPoint=O,this._eventButton=R)}},yn.prototype.mousemoveWindow=function(M,O){var R=this._lastPoint;if(R&&(M.preventDefault(),this._moved||!(O.dist(R)<this._clickTolerance)))return this._moved=!0,this._lastPoint=O,this._move(R,O)},yn.prototype.mouseupWindow=function(M){o.mouseButton(M)===this._eventButton&&(this._moved&&o.suppressClick(),this.reset())},yn.prototype.enable=function(){this._enabled=!0},yn.prototype.disable=function(){this._enabled=!1,this.reset()},yn.prototype.isEnabled=function(){return this._enabled},yn.prototype.isActive=function(){return this._active};var Pa=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.mousedown=function(R,j){M.prototype.mousedown.call(this,R,j),this._lastPoint&&(this._active=!0)},O.prototype._correctButton=function(R,j){return j===0&&!R.ctrlKey},O.prototype._move=function(R,j){return{around:j,panDelta:j.sub(R)}},O}(yn),Ma=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._correctButton=function(R,j){return j===0&&R.ctrlKey||j===2},O.prototype._move=function(R,j){var te=.8*(j.x-R.x);if(te)return this._active=!0,{bearingDelta:te}},O.prototype.contextmenu=function(R){R.preventDefault()},O}(yn),fa=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._correctButton=function(R,j){return j===0&&R.ctrlKey||j===2},O.prototype._move=function(R,j){var te=-.5*(j.y-R.y);if(te)return this._active=!0,{pitchDelta:te}},O.prototype.contextmenu=function(R){R.preventDefault()},O}(yn),Ia=function(M){this._minTouches=1,this._clickTolerance=M.clickTolerance||1,this.reset()};Ia.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},Ia.prototype.touchstart=function(M,O,R){return this._calculateTransform(M,O,R)},Ia.prototype.touchmove=function(M,O,R){if(this._active)return M.preventDefault(),this._calculateTransform(M,O,R)},Ia.prototype.touchend=function(M,O,R){this._calculateTransform(M,O,R),this._active&&R.length<this._minTouches&&this.reset()},Ia.prototype.touchcancel=function(){this.reset()},Ia.prototype._calculateTransform=function(M,O,R){R.length>0&&(this._active=!0);var j=Cn(R,O),te=new e.Point(0,0),le=new e.Point(0,0),pe=0;for(var ye in j){var _e=j[ye],Ne=this._touches[ye];Ne&&(te._add(_e),le._add(_e.sub(Ne)),pe++,j[ye]=_e)}if(this._touches=j,!(pe<this._minTouches)&&le.mag()){var He=le.div(pe);if(this._sum._add(He),!(this._sum.mag()<this._clickTolerance))return{around:te.div(pe),panDelta:He}}},Ia.prototype.enable=function(){this._enabled=!0},Ia.prototype.disable=function(){this._enabled=!1,this.reset()},Ia.prototype.isEnabled=function(){return this._enabled},Ia.prototype.isActive=function(){return this._active};var Ta=function(){this.reset()};function Ja(M,O,R){for(var j=0;j<M.length;j++)if(M[j].identifier===R)return O[j]}Ta.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ta.prototype._start=function(M){},Ta.prototype._move=function(M,O,R){return{}},Ta.prototype.touchstart=function(M,O,R){this._firstTwoTouches||R.length<2||(this._firstTwoTouches=[R[0].identifier,R[1].identifier],this._start([O[0],O[1]]))},Ta.prototype.touchmove=function(M,O,R){if(this._firstTwoTouches){M.preventDefault();var j=this._firstTwoTouches,te=j[0],le=j[1],pe=Ja(R,O,te),ye=Ja(R,O,le);if(pe&&ye){var _e=this._aroundCenter?null:pe.add(ye).div(2);return this._move([pe,ye],_e,M)}}},Ta.prototype.touchend=function(M,O,R){if(this._firstTwoTouches){var j=this._firstTwoTouches,te=j[0],le=j[1],pe=Ja(R,O,te),ye=Ja(R,O,le);pe&&ye||(this._active&&o.suppressClick(),this.reset())}},Ta.prototype.touchcancel=function(){this.reset()},Ta.prototype.enable=function(M){this._enabled=!0,this._aroundCenter=!!M&&M.around==="center"},Ta.prototype.disable=function(){this._enabled=!1,this.reset()},Ta.prototype.isEnabled=function(){return this._enabled},Ta.prototype.isActive=function(){return this._active};function Zn(M,O){return Math.log(M/O)/Math.LN2}var Ha=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.reset=function(){M.prototype.reset.call(this),delete this._distance,delete this._startDistance},O.prototype._start=function(R){this._startDistance=this._distance=R[0].dist(R[1])},O.prototype._move=function(R,j){var te=this._distance;if(this._distance=R[0].dist(R[1]),this._active||!(Math.abs(Zn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Zn(this._distance,te),pinchAround:j}},O}(Ta);function Fi(M,O){return 180*M.angleWith(O)/Math.PI}var Wo=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.reset=function(){M.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},O.prototype._start=function(R){this._startVector=this._vector=R[0].sub(R[1]),this._minDiameter=R[0].dist(R[1])},O.prototype._move=function(R,j){var te=this._vector;if(this._vector=R[0].sub(R[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Fi(this._vector,te),pinchAround:j}},O.prototype._isBelowThreshold=function(R){this._minDiameter=Math.min(this._minDiameter,R.mag());var j=25/(Math.PI*this._minDiameter)*360,te=Fi(R,this._startVector);return Math.abs(te)<j},O}(Ta);function Io(M){return Math.abs(M.y)>Math.abs(M.x)}var po=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.reset=function(){M.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},O.prototype._start=function(R){this._lastPoints=R,Io(R[0].sub(R[1]))&&(this._valid=!1)},O.prototype._move=function(R,j,te){var le=R[0].sub(this._lastPoints[0]),pe=R[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(le,pe,te.timeStamp),this._valid)return this._lastPoints=R,this._active=!0,{pitchDelta:-.5*((le.y+pe.y)/2)}},O.prototype.gestureBeginsVertically=function(R,j,te){if(this._valid!==void 0)return this._valid;var le=R.mag()>=2,pe=j.mag()>=2;if(le||pe){if(!le||!pe)return this._firstMove===void 0&&(this._firstMove=te),te-this._firstMove<100&&void 0;var ye=R.y>0==j.y>0;return Io(R)&&Io(j)&&ye}},O}(Ta),ga={panStep:100,bearingStep:15,pitchStep:10},fi=function(){var M=ga;this._panStep=M.panStep,this._bearingStep=M.bearingStep,this._pitchStep=M.pitchStep};function go(M){return M*(2-M)}fi.prototype.reset=function(){this._active=!1},fi.prototype.keydown=function(M){var O=this;if(!(M.altKey||M.ctrlKey||M.metaKey)){var R=0,j=0,te=0,le=0,pe=0;switch(M.keyCode){case 61:case 107:case 171:case 187:R=1;break;case 189:case 109:case 173:R=-1;break;case 37:M.shiftKey?j=-1:(M.preventDefault(),le=-1);break;case 39:M.shiftKey?j=1:(M.preventDefault(),le=1);break;case 38:M.shiftKey?te=1:(M.preventDefault(),pe=-1);break;case 40:M.shiftKey?te=-1:(M.preventDefault(),pe=1);break;default:return}return{cameraAnimation:function(ye){var _e=ye.getZoom();ye.easeTo({duration:300,easeId:"keyboardHandler",easing:go,zoom:R?Math.round(_e)+R*(M.shiftKey?2:1):_e,bearing:ye.getBearing()+j*O._bearingStep,pitch:ye.getPitch()+te*O._pitchStep,offset:[-le*O._panStep,-pe*O._panStep],center:ye.getCenter()},{originalEvent:M})}}}},fi.prototype.enable=function(){this._enabled=!0},fi.prototype.disable=function(){this._enabled=!1,this.reset()},fi.prototype.isEnabled=function(){return this._enabled},fi.prototype.isActive=function(){return this._active};var Ga=function(M,O){this._map=M,this._el=M.getCanvasContainer(),this._handler=O,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ga.prototype.setZoomRate=function(M){this._defaultZoomRate=M},Ga.prototype.setWheelZoomRate=function(M){this._wheelZoomRate=M},Ga.prototype.isEnabled=function(){return!!this._enabled},Ga.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ga.prototype.isZooming=function(){return!!this._zooming},Ga.prototype.enable=function(M){this.isEnabled()||(this._enabled=!0,this._aroundCenter=M&&M.around==="center")},Ga.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ga.prototype.wheel=function(M){if(this.isEnabled()){var O=M.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*M.deltaY:M.deltaY,R=e.browser.now(),j=R-(this._lastWheelEventTime||0);this._lastWheelEventTime=R,O!==0&&O%4.000244140625==0?this._type="wheel":O!==0&&Math.abs(O)<4?this._type="trackpad":j>400?(this._type=null,this._lastValue=O,this._timeout=setTimeout(this._onTimeout,40,M)):this._type||(this._type=Math.abs(j*O)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,O+=this._lastValue)),M.shiftKey&&O&&(O/=4),this._type&&(this._lastWheelEvent=M,this._delta-=O,this._active||this._start(M)),M.preventDefault()}},Ga.prototype._onTimeout=function(M){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(M)},Ga.prototype._start=function(M){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var O=o.mousePos(this._el,M);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(O)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ga.prototype.renderFrame=function(){return this._onScrollFrame()},Ga.prototype._onScrollFrame=function(){var M=this;if(this._frameId&&(this._frameId=null,this.isActive())){var O=this._map.transform;if(this._delta!==0){var R=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,j=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&j!==0&&(j=1/j);var te=typeof this._targetZoom=="number"?O.zoomScale(this._targetZoom):O.scale;this._targetZoom=Math.min(O.maxZoom,Math.max(O.minZoom,O.scaleZoom(te*j))),this._type==="wheel"&&(this._startZoom=O.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var le,pe=typeof this._targetZoom=="number"?this._targetZoom:O.zoom,ye=this._startZoom,_e=this._easing,Ne=!1;if(this._type==="wheel"&&ye&&_e){var He=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),et=_e(He);le=e.number(ye,pe,et),He<1?this._frameId||(this._frameId=!0):Ne=!0}else le=pe,Ne=!0;return this._active=!0,Ne&&(this._active=!1,this._finishTimeout=setTimeout(function(){M._zooming=!1,M._handler._triggerRenderFrame(),delete M._targetZoom,delete M._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ne,zoomDelta:le-O.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ga.prototype._smoothOutEasing=function(M){var O=e.ease;if(this._prevEase){var R=this._prevEase,j=(e.browser.now()-R.start)/R.duration,te=R.easing(j+.01)-R.easing(j),le=.27/Math.sqrt(te*te+1e-4)*.01,pe=Math.sqrt(.0729-le*le);O=e.bezier(le,pe,.25,1)}return this._prevEase={start:e.browser.now(),duration:M,easing:O},O},Ga.prototype.reset=function(){this._active=!1};var bi=function(M,O){this._clickZoom=M,this._tapZoom=O};bi.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},bi.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},bi.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},bi.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ui=function(){this.reset()};Ui.prototype.reset=function(){this._active=!1},Ui.prototype.dblclick=function(M,O){return M.preventDefault(),{cameraAnimation:function(R){R.easeTo({duration:300,zoom:R.getZoom()+(M.shiftKey?-1:1),around:R.unproject(O)},{originalEvent:M})}}},Ui.prototype.enable=function(){this._enabled=!0},Ui.prototype.disable=function(){this._enabled=!1,this.reset()},Ui.prototype.isEnabled=function(){return this._enabled},Ui.prototype.isActive=function(){return this._active};var Qa=function(){this._tap=new _a({numTouches:1,numTaps:1}),this.reset()};Qa.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Qa.prototype.touchstart=function(M,O,R){this._swipePoint||(this._tapTime&&M.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?R.length>0&&(this._swipePoint=O[0],this._swipeTouch=R[0].identifier):this._tap.touchstart(M,O,R))},Qa.prototype.touchmove=function(M,O,R){if(this._tapTime){if(this._swipePoint){if(R[0].identifier!==this._swipeTouch)return;var j=O[0],te=j.y-this._swipePoint.y;return this._swipePoint=j,M.preventDefault(),this._active=!0,{zoomDelta:te/128}}}else this._tap.touchmove(M,O,R)},Qa.prototype.touchend=function(M,O,R){this._tapTime?this._swipePoint&&R.length===0&&this.reset():this._tap.touchend(M,O,R)&&(this._tapTime=M.timeStamp)},Qa.prototype.touchcancel=function(){this.reset()},Qa.prototype.enable=function(){this._enabled=!0},Qa.prototype.disable=function(){this._enabled=!1,this.reset()},Qa.prototype.isEnabled=function(){return this._enabled},Qa.prototype.isActive=function(){return this._active};var so=function(M,O,R){this._el=M,this._mousePan=O,this._touchPan=R};so.prototype.enable=function(M){this._inertiaOptions=M||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},so.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},so.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},so.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var $a=function(M,O,R){this._pitchWithRotate=M.pitchWithRotate,this._mouseRotate=O,this._mousePitch=R};$a.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},$a.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},$a.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},$a.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var $i=function(M,O,R,j){this._el=M,this._touchZoom=O,this._touchRotate=R,this._tapDragZoom=j,this._rotationDisabled=!1,this._enabled=!0};$i.prototype.enable=function(M){this._touchZoom.enable(M),this._rotationDisabled||this._touchRotate.enable(M),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},$i.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},$i.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},$i.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},$i.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},$i.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var is=function(M){return M.zoom||M.drag||M.pitch||M.rotate},$o=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(e.Event);function Ds(M){return M.panDelta&&M.panDelta.mag()||M.zoomDelta||M.bearingDelta||M.pitchDelta}var Pi=function(M,O){this._map=M,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new pn(M),this._bearingSnap=O.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(O),e.bindAll(["handleEvent","handleWindowEvent"],this);var R=this._el;this._listeners=[[R,"touchstart",{passive:!1}],[R,"touchmove",{passive:!1}],[R,"touchend",void 0],[R,"touchcancel",void 0],[R,"mousedown",void 0],[R,"mousemove",void 0],[R,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[R,"mouseover",void 0],[R,"mouseout",void 0],[R,"dblclick",void 0],[R,"click",void 0],[R,"keydown",{capture:!1}],[R,"keyup",void 0],[R,"wheel",{passive:!1}],[R,"contextmenu",void 0],[e.window,"blur",void 0]];for(var j=0,te=this._listeners;j<te.length;j+=1){var le=te[j],pe=le[0],ye=le[1],_e=le[2];o.addEventListener(pe,ye,pe===e.window.document?this.handleWindowEvent:this.handleEvent,_e)}};Pi.prototype.destroy=function(){for(var M=0,O=this._listeners;M<O.length;M+=1){var R=O[M],j=R[0],te=R[1],le=R[2];o.removeEventListener(j,te,j===e.window.document?this.handleWindowEvent:this.handleEvent,le)}},Pi.prototype._addDefaultHandlers=function(M){var O=this._map,R=O.getCanvasContainer();this._add("mapEvent",new Hr(O,M));var j=O.boxZoom=new Tn(O,M);this._add("boxZoom",j);var te=new Sa,le=new Ui;O.doubleClickZoom=new bi(le,te),this._add("tapZoom",te),this._add("clickZoom",le);var pe=new Qa;this._add("tapDragZoom",pe);var ye=O.touchPitch=new po;this._add("touchPitch",ye);var _e=new Ma(M),Ne=new fa(M);O.dragRotate=new $a(M,_e,Ne),this._add("mouseRotate",_e,["mousePitch"]),this._add("mousePitch",Ne,["mouseRotate"]);var He=new Pa(M),et=new Ia(M);O.dragPan=new so(R,He,et),this._add("mousePan",He),this._add("touchPan",et,["touchZoom","touchRotate"]);var yt=new Wo,kt=new Ha;O.touchZoomRotate=new $i(R,kt,yt,pe),this._add("touchRotate",yt,["touchPan","touchZoom"]),this._add("touchZoom",kt,["touchPan","touchRotate"]);var _t=O.scrollZoom=new Ga(O,this);this._add("scrollZoom",_t,["mousePan"]);var wt=O.keyboard=new fi;this._add("keyboard",wt),this._add("blockableMapEvent",new Xn(O));for(var vt=0,Dt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];vt<Dt.length;vt+=1){var Pt=Dt[vt];M.interactive&&M[Pt]&&O[Pt].enable(M[Pt])}},Pi.prototype._add=function(M,O,R){this._handlers.push({handlerName:M,handler:O,allowed:R}),this._handlersById[M]=O},Pi.prototype.stop=function(){if(!this._updatingCamera){for(var M=0,O=this._handlers;M<O.length;M+=1)O[M].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Pi.prototype.isActive=function(){for(var M=0,O=this._handlers;M<O.length;M+=1)if(O[M].handler.isActive())return!0;return!1},Pi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Pi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Pi.prototype.isMoving=function(){return!!is(this._eventsInProgress)||this.isZooming()},Pi.prototype._blockedByActive=function(M,O,R){for(var j in M)if(j!==R&&(!O||O.indexOf(j)<0))return!0;return!1},Pi.prototype.handleWindowEvent=function(M){this.handleEvent(M,M.type+"Window")},Pi.prototype._getMapTouches=function(M){for(var O=[],R=0,j=M;R<j.length;R+=1){var te=j[R],le=te.target;this._el.contains(le)&&O.push(te)}return O},Pi.prototype.handleEvent=function(M,O){if(M.type!=="blur"){this._updatingCamera=!0;for(var R=M.type==="renderFrame"?void 0:M,j={needsRenderFrame:!1},te={},le={},pe=M.touches?this._getMapTouches(M.touches):void 0,ye=pe?o.touchPos(this._el,pe):o.mousePos(this._el,M),_e=0,Ne=this._handlers;_e<Ne.length;_e+=1){var He=Ne[_e],et=He.handlerName,yt=He.handler,kt=He.allowed;if(yt.isEnabled()){var _t=void 0;this._blockedByActive(le,kt,et)?yt.reset():yt[O||M.type]&&(_t=yt[O||M.type](M,ye,pe),this.mergeHandlerResult(j,te,_t,et,R),_t&&_t.needsRenderFrame&&this._triggerRenderFrame()),(_t||yt.isActive())&&(le[et]=yt)}}var wt={};for(var vt in this._previousActiveHandlers)le[vt]||(wt[vt]=R);this._previousActiveHandlers=le,(Object.keys(wt).length||Ds(j))&&(this._changes.push([j,te,wt]),this._triggerRenderFrame()),(Object.keys(le).length||Ds(j))&&this._map._stop(!0),this._updatingCamera=!1;var Dt=j.cameraAnimation;Dt&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],Dt(this._map))}else this.stop()},Pi.prototype.mergeHandlerResult=function(M,O,R,j,te){if(R){e.extend(M,R);var le={handlerName:j,originalEvent:R.originalEvent||te};R.zoomDelta!==void 0&&(O.zoom=le),R.panDelta!==void 0&&(O.drag=le),R.pitchDelta!==void 0&&(O.pitch=le),R.bearingDelta!==void 0&&(O.rotate=le)}},Pi.prototype._applyChanges=function(){for(var M={},O={},R={},j=0,te=this._changes;j<te.length;j+=1){var le=te[j],pe=le[0],ye=le[1],_e=le[2];pe.panDelta&&(M.panDelta=(M.panDelta||new e.Point(0,0))._add(pe.panDelta)),pe.zoomDelta&&(M.zoomDelta=(M.zoomDelta||0)+pe.zoomDelta),pe.bearingDelta&&(M.bearingDelta=(M.bearingDelta||0)+pe.bearingDelta),pe.pitchDelta&&(M.pitchDelta=(M.pitchDelta||0)+pe.pitchDelta),pe.around!==void 0&&(M.around=pe.around),pe.pinchAround!==void 0&&(M.pinchAround=pe.pinchAround),pe.noInertia&&(M.noInertia=pe.noInertia),e.extend(O,ye),e.extend(R,_e)}this._updateMapTransform(M,O,R),this._changes=[]},Pi.prototype._updateMapTransform=function(M,O,R){var j=this._map,te=j.transform;if(!Ds(M))return this._fireEvents(O,R);var le=M.panDelta,pe=M.zoomDelta,ye=M.bearingDelta,_e=M.pitchDelta,Ne=M.around,He=M.pinchAround;He!==void 0&&(Ne=He),j._stop(!0),Ne=Ne||j.transform.centerPoint;var et=te.pointLocation(le?Ne.sub(le):Ne);ye&&(te.bearing+=ye),_e&&(te.pitch+=_e),pe&&(te.zoom+=pe),te.setLocationAtPoint(et,Ne),this._map._update(),M.noInertia||this._inertia.record(M),this._fireEvents(O,R)},Pi.prototype._fireEvents=function(M,O){var R=this,j=is(this._eventsInProgress),te=is(M),le={};for(var pe in M){var ye=M[pe].originalEvent;this._eventsInProgress[pe]||(le[pe+"start"]=ye),this._eventsInProgress[pe]=M[pe]}for(var _e in!j&&te&&this._fireEvent("movestart",te.originalEvent),le)this._fireEvent(_e,le[_e]);for(var Ne in M.rotate&&(this._bearingChanged=!0),te&&this._fireEvent("move",te.originalEvent),M){var He=M[Ne].originalEvent;this._fireEvent(Ne,He)}var et,yt={};for(var kt in this._eventsInProgress){var _t=this._eventsInProgress[kt],wt=_t.handlerName,vt=_t.originalEvent;this._handlersById[wt].isActive()||(delete this._eventsInProgress[kt],et=O[wt]||vt,yt[kt+"end"]=et)}for(var Dt in yt)this._fireEvent(Dt,yt[Dt]);var Pt=is(this._eventsInProgress);if((j||te)&&!Pt){this._updatingCamera=!0;var Ft=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),er=function(cr){return cr!==0&&-R._bearingSnap<cr&&cr<R._bearingSnap};Ft?(er(Ft.bearing||this._map.getBearing())&&(Ft.bearing=0),this._map.easeTo(Ft,{originalEvent:et})):(this._map.fire(new e.Event("moveend",{originalEvent:et})),er(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Pi.prototype._fireEvent=function(M,O){this._map.fire(new e.Event(M,O?{originalEvent:O}:{}))},Pi.prototype._triggerRenderFrame=function(){var M=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(O){delete M._frameId,M.handleEvent(new $o("renderFrame",{timeStamp:O})),M._applyChanges()}))};var Rs=function(M){function O(R,j){M.call(this),this._moving=!1,this._zooming=!1,this.transform=R,this._bearingSnap=j.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},O.prototype.setCenter=function(R,j){return this.jumpTo({center:R},j)},O.prototype.panBy=function(R,j,te){return R=e.Point.convert(R).mult(-1),this.panTo(this.transform.center,e.extend({offset:R},j),te)},O.prototype.panTo=function(R,j,te){return this.easeTo(e.extend({center:R},j),te)},O.prototype.getZoom=function(){return this.transform.zoom},O.prototype.setZoom=function(R,j){return this.jumpTo({zoom:R},j),this},O.prototype.zoomTo=function(R,j,te){return this.easeTo(e.extend({zoom:R},j),te)},O.prototype.zoomIn=function(R,j){return this.zoomTo(this.getZoom()+1,R,j),this},O.prototype.zoomOut=function(R,j){return this.zoomTo(this.getZoom()-1,R,j),this},O.prototype.getBearing=function(){return this.transform.bearing},O.prototype.setBearing=function(R,j){return this.jumpTo({bearing:R},j),this},O.prototype.getPadding=function(){return this.transform.padding},O.prototype.setPadding=function(R,j){return this.jumpTo({padding:R},j),this},O.prototype.rotateTo=function(R,j,te){return this.easeTo(e.extend({bearing:R},j),te)},O.prototype.resetNorth=function(R,j){return this.rotateTo(0,e.extend({duration:1e3},R),j),this},O.prototype.resetNorthPitch=function(R,j){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},R),j),this},O.prototype.snapToNorth=function(R,j){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(R,j):this},O.prototype.getPitch=function(){return this.transform.pitch},O.prototype.setPitch=function(R,j){return this.jumpTo({pitch:R},j),this},O.prototype.cameraForBounds=function(R,j){return R=e.LngLatBounds.convert(R),this._cameraForBoxAndBearing(R.getNorthWest(),R.getSouthEast(),0,j)},O.prototype._cameraForBoxAndBearing=function(R,j,te,le){var pe={top:0,bottom:0,right:0,left:0};if(typeof(le=e.extend({padding:pe,offset:[0,0],maxZoom:this.transform.maxZoom},le)).padding=="number"){var ye=le.padding;le.padding={top:ye,bottom:ye,right:ye,left:ye}}le.padding=e.extend(pe,le.padding);var _e=this.transform,Ne=_e.padding,He=_e.project(e.LngLat.convert(R)),et=_e.project(e.LngLat.convert(j)),yt=He.rotate(-te*Math.PI/180),kt=et.rotate(-te*Math.PI/180),_t=new e.Point(Math.max(yt.x,kt.x),Math.max(yt.y,kt.y)),wt=new e.Point(Math.min(yt.x,kt.x),Math.min(yt.y,kt.y)),vt=_t.sub(wt),Dt=(_e.width-(Ne.left+Ne.right+le.padding.left+le.padding.right))/vt.x,Pt=(_e.height-(Ne.top+Ne.bottom+le.padding.top+le.padding.bottom))/vt.y;if(!(Pt<0||Dt<0)){var Ft=Math.min(_e.scaleZoom(_e.scale*Math.min(Dt,Pt)),le.maxZoom),er=e.Point.convert(le.offset),cr=(le.padding.left-le.padding.right)/2,Ar=(le.padding.top-le.padding.bottom)/2,Tr=new e.Point(er.x+cr,er.y+Ar).mult(_e.scale/_e.zoomScale(Ft));return{center:_e.unproject(He.add(et).div(2).sub(Tr)),zoom:Ft,bearing:te}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},O.prototype.fitBounds=function(R,j,te){return this._fitInternal(this.cameraForBounds(R,j),j,te)},O.prototype.fitScreenCoordinates=function(R,j,te,le,pe){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(R)),this.transform.pointLocation(e.Point.convert(j)),te,le),le,pe)},O.prototype._fitInternal=function(R,j,te){return R?(delete(j=e.extend(R,j)).padding,j.linear?this.easeTo(j,te):this.flyTo(j,te)):this},O.prototype.jumpTo=function(R,j){this.stop();var te=this.transform,le=!1,pe=!1,ye=!1;return"zoom"in R&&te.zoom!==+R.zoom&&(le=!0,te.zoom=+R.zoom),R.center!==void 0&&(te.center=e.LngLat.convert(R.center)),"bearing"in R&&te.bearing!==+R.bearing&&(pe=!0,te.bearing=+R.bearing),"pitch"in R&&te.pitch!==+R.pitch&&(ye=!0,te.pitch=+R.pitch),R.padding==null||te.isPaddingEqual(R.padding)||(te.padding=R.padding),this.fire(new e.Event("movestart",j)).fire(new e.Event("move",j)),le&&this.fire(new e.Event("zoomstart",j)).fire(new e.Event("zoom",j)).fire(new e.Event("zoomend",j)),pe&&this.fire(new e.Event("rotatestart",j)).fire(new e.Event("rotate",j)).fire(new e.Event("rotateend",j)),ye&&this.fire(new e.Event("pitchstart",j)).fire(new e.Event("pitch",j)).fire(new e.Event("pitchend",j)),this.fire(new e.Event("moveend",j))},O.prototype.easeTo=function(R,j){var te=this;this._stop(!1,R.easeId),((R=e.extend({offset:[0,0],duration:500,easing:e.ease},R)).animate===!1||!R.essential&&e.browser.prefersReducedMotion)&&(R.duration=0);var le=this.transform,pe=this.getZoom(),ye=this.getBearing(),_e=this.getPitch(),Ne=this.getPadding(),He="zoom"in R?+R.zoom:pe,et="bearing"in R?this._normalizeBearing(R.bearing,ye):ye,yt="pitch"in R?+R.pitch:_e,kt="padding"in R?R.padding:le.padding,_t=e.Point.convert(R.offset),wt=le.centerPoint.add(_t),vt=le.pointLocation(wt),Dt=e.LngLat.convert(R.center||vt);this._normalizeCenter(Dt);var Pt,Ft,er=le.project(vt),cr=le.project(Dt).sub(er),Ar=le.zoomScale(He-pe);R.around&&(Pt=e.LngLat.convert(R.around),Ft=le.locationPoint(Pt));var Tr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||He!==pe,this._rotating=this._rotating||ye!==et,this._pitching=this._pitching||yt!==_e,this._padding=!le.isPaddingEqual(kt),this._easeId=R.easeId,this._prepareEase(j,R.noMoveStart,Tr),clearTimeout(this._easeEndTimeoutID),this._ease(function(Yr){if(te._zooming&&(le.zoom=e.number(pe,He,Yr)),te._rotating&&(le.bearing=e.number(ye,et,Yr)),te._pitching&&(le.pitch=e.number(_e,yt,Yr)),te._padding&&(le.interpolatePadding(Ne,kt,Yr),wt=le.centerPoint.add(_t)),Pt)le.setLocationAtPoint(Pt,Ft);else{var Gr=le.zoomScale(le.zoom-pe),an=He>pe?Math.min(2,Ar):Math.max(.5,Ar),$r=Math.pow(an,1-Yr),In=le.unproject(er.add(cr.mult(Yr*$r)).mult(Gr));le.setLocationAtPoint(le.renderWorldCopies?In.wrap():In,wt)}te._fireMoveEvents(j)},function(Yr){te._afterEase(j,Yr)},R),this},O.prototype._prepareEase=function(R,j,te){te===void 0&&(te={}),this._moving=!0,j||te.moving||this.fire(new e.Event("movestart",R)),this._zooming&&!te.zooming&&this.fire(new e.Event("zoomstart",R)),this._rotating&&!te.rotating&&this.fire(new e.Event("rotatestart",R)),this._pitching&&!te.pitching&&this.fire(new e.Event("pitchstart",R))},O.prototype._fireMoveEvents=function(R){this.fire(new e.Event("move",R)),this._zooming&&this.fire(new e.Event("zoom",R)),this._rotating&&this.fire(new e.Event("rotate",R)),this._pitching&&this.fire(new e.Event("pitch",R))},O.prototype._afterEase=function(R,j){if(!this._easeId||!j||this._easeId!==j){delete this._easeId;var te=this._zooming,le=this._rotating,pe=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,te&&this.fire(new e.Event("zoomend",R)),le&&this.fire(new e.Event("rotateend",R)),pe&&this.fire(new e.Event("pitchend",R)),this.fire(new e.Event("moveend",R))}},O.prototype.flyTo=function(R,j){var te=this;if(!R.essential&&e.browser.prefersReducedMotion){var le=e.pick(R,["center","zoom","bearing","pitch","around"]);return this.jumpTo(le,j)}this.stop(),R=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},R);var pe=this.transform,ye=this.getZoom(),_e=this.getBearing(),Ne=this.getPitch(),He=this.getPadding(),et="zoom"in R?e.clamp(+R.zoom,pe.minZoom,pe.maxZoom):ye,yt="bearing"in R?this._normalizeBearing(R.bearing,_e):_e,kt="pitch"in R?+R.pitch:Ne,_t="padding"in R?R.padding:pe.padding,wt=pe.zoomScale(et-ye),vt=e.Point.convert(R.offset),Dt=pe.centerPoint.add(vt),Pt=pe.pointLocation(Dt),Ft=e.LngLat.convert(R.center||Pt);this._normalizeCenter(Ft);var er=pe.project(Pt),cr=pe.project(Ft).sub(er),Ar=R.curve,Tr=Math.max(pe.width,pe.height),Yr=Tr/wt,Gr=cr.mag();if("minZoom"in R){var an=e.clamp(Math.min(R.minZoom,ye,et),pe.minZoom,pe.maxZoom),$r=Tr/pe.zoomScale(an-ye);Ar=Math.sqrt($r/Gr*2)}var In=Ar*Ar;function jn(qn){var va=(Yr*Yr-Tr*Tr+(qn?-1:1)*In*In*Gr*Gr)/(2*(qn?Yr:Tr)*In*Gr);return Math.log(Math.sqrt(va*va+1)-va)}function ia(qn){return(Math.exp(qn)-Math.exp(-qn))/2}function jr(qn){return(Math.exp(qn)+Math.exp(-qn))/2}var mn=jn(0),Un=function(qn){return jr(mn)/jr(mn+Ar*qn)},Fn=function(qn){return Tr*((jr(mn)*(ia(va=mn+Ar*qn)/jr(va))-ia(mn))/In)/Gr;var va},Jn=(jn(1)-mn)/Ar;if(Math.abs(Gr)<1e-6||!isFinite(Jn)){if(Math.abs(Tr-Yr)<1e-6)return this.easeTo(R,j);var sa=Yr<Tr?-1:1;Jn=Math.abs(Math.log(Yr/Tr))/Ar,Fn=function(){return 0},Un=function(qn){return Math.exp(sa*Ar*qn)}}if("duration"in R)R.duration=+R.duration;else{var ka="screenSpeed"in R?+R.screenSpeed/Ar:+R.speed;R.duration=1e3*Jn/ka}return R.maxDuration&&R.duration>R.maxDuration&&(R.duration=0),this._zooming=!0,this._rotating=_e!==yt,this._pitching=kt!==Ne,this._padding=!pe.isPaddingEqual(_t),this._prepareEase(j,!1),this._ease(function(qn){var va=qn*Jn,pa=1/Un(va);pe.zoom=qn===1?et:ye+pe.scaleZoom(pa),te._rotating&&(pe.bearing=e.number(_e,yt,qn)),te._pitching&&(pe.pitch=e.number(Ne,kt,qn)),te._padding&&(pe.interpolatePadding(He,_t,qn),Dt=pe.centerPoint.add(vt));var Ea=qn===1?Ft:pe.unproject(er.add(cr.mult(Fn(va))).mult(pa));pe.setLocationAtPoint(pe.renderWorldCopies?Ea.wrap():Ea,Dt),te._fireMoveEvents(j)},function(){return te._afterEase(j)},R),this},O.prototype.isEasing=function(){return!!this._easeFrameId},O.prototype.stop=function(){return this._stop()},O.prototype._stop=function(R,j){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var te=this._onEaseEnd;delete this._onEaseEnd,te.call(this,j)}if(!R){var le=this.handlers;le&&le.stop()}return this},O.prototype._ease=function(R,j,te){te.animate===!1||te.duration===0?(R(1),j()):(this._easeStart=e.browser.now(),this._easeOptions=te,this._onEaseFrame=R,this._onEaseEnd=j,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},O.prototype._renderFrameCallback=function(){var R=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(R)),R<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},O.prototype._normalizeBearing=function(R,j){R=e.wrap(R,-180,180);var te=Math.abs(R-j);return Math.abs(R-360-j)<te&&(R-=360),Math.abs(R+360-j)<te&&(R+=360),R},O.prototype._normalizeCenter=function(R){var j=this.transform;if(j.renderWorldCopies&&!j.lngRange){var te=R.lng-j.center.lng;R.lng+=te>180?-360:te<-180?360:0}},O}(e.Evented),Ii=function(M){M===void 0&&(M={}),this.options=M,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Ii.prototype.getDefaultPosition=function(){return"bottom-right"},Ii.prototype.onAdd=function(M){var O=this.options&&this.options.compact;return this._map=M,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=o.create("div","mapboxgl-ctrl-attrib-inner",this._container),O&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),O===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ii.prototype.onRemove=function(){o.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ii.prototype._updateEditLink=function(){var M=this._editLink;M||(M=this._editLink=this._container.querySelector(".mapbox-improve-map"));var O=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(M){var R=O.reduce(function(j,te,le){return te.value&&(j+=te.key+"="+te.value+(le<O.length-1?"&":"")),j},"?");M.href=e.config.FEEDBACK_URL+"/"+R+(this._map._hash?this._map._hash.getHashString(!0):""),M.rel="noopener nofollow"}},Ii.prototype._updateData=function(M){!M||M.sourceDataType!=="metadata"&&M.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Ii.prototype._updateAttributions=function(){if(this._map.style){var M=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?M=M.concat(this.options.customAttribution.map(function(ye){return typeof ye!="string"?"":ye})):typeof this.options.customAttribution=="string"&&M.push(this.options.customAttribution)),this._map.style.stylesheet){var O=this._map.style.stylesheet;this.styleOwner=O.owner,this.styleId=O.id}var R=this._map.style.sourceCaches;for(var j in R){var te=R[j];if(te.used){var le=te.getSource();le.attribution&&M.indexOf(le.attribution)<0&&M.push(le.attribution)}}M.sort(function(ye,_e){return ye.length-_e.length});var pe=(M=M.filter(function(ye,_e){for(var Ne=_e+1;Ne<M.length;Ne++)if(M[Ne].indexOf(ye)>=0)return!1;return!0})).join(" | ");pe!==this._attribHTML&&(this._attribHTML=pe,M.length?(this._innerContainer.innerHTML=pe,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ii.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var es=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};es.prototype.onAdd=function(M){this._map=M,this._container=o.create("div","mapboxgl-ctrl");var O=o.create("a","mapboxgl-ctrl-logo");return O.target="_blank",O.rel="noopener nofollow",O.href="https://www.mapbox.com/",O.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),O.setAttribute("rel","noopener nofollow"),this._container.appendChild(O),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},es.prototype.onRemove=function(){o.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},es.prototype.getDefaultPosition=function(){return"bottom-left"},es.prototype._updateLogo=function(M){M&&M.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},es.prototype._logoRequired=function(){if(this._map.style){var M=this._map.style.sourceCaches;for(var O in M)if(M[O].getSource().mapbox_logo)return!0;return!1}},es.prototype._updateCompact=function(){var M=this._container.children;if(M.length){var O=M[0];this._map.getCanvasContainer().offsetWidth<250?O.classList.add("mapboxgl-compact"):O.classList.remove("mapboxgl-compact")}};var na=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};na.prototype.add=function(M){var O=++this._id;return this._queue.push({callback:M,id:O,cancelled:!1}),O},na.prototype.remove=function(M){for(var O=this._currentlyRunning,R=0,j=O?this._queue.concat(O):this._queue;R<j.length;R+=1){var te=j[R];if(te.id===M)return void(te.cancelled=!0)}},na.prototype.run=function(M){M===void 0&&(M=0);var O=this._currentlyRunning=this._queue;this._queue=[];for(var R=0,j=O;R<j.length;R+=1){var te=j[R];if(!te.cancelled&&(te.callback(M),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},na.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ma={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Fs=e.window.HTMLImageElement,Bs=e.window.HTMLElement,ts=e.window.ImageBitmap,Eo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},qo=function(M){function O(j){var te=this;if((j=e.extend({},Eo,j)).minZoom!=null&&j.maxZoom!=null&&j.minZoom>j.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(j.minPitch!=null&&j.maxPitch!=null&&j.minPitch>j.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(j.minPitch!=null&&j.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(j.maxPitch!=null&&j.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var le=new Vt(j.minZoom,j.maxZoom,j.minPitch,j.maxPitch,j.renderWorldCopies);if(M.call(this,le,j),this._interactive=j.interactive,this._maxTileCacheSize=j.maxTileCacheSize,this._failIfMajorPerformanceCaveat=j.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=j.preserveDrawingBuffer,this._antialias=j.antialias,this._trackResize=j.trackResize,this._bearingSnap=j.bearingSnap,this._refreshExpiredTiles=j.refreshExpiredTiles,this._fadeDuration=j.fadeDuration,this._crossSourceCollisions=j.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=j.collectResourceTiming,this._renderTaskQueue=new na,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},ma,j.locale),this._requestManager=new e.RequestManager(j.transformRequest,j.accessToken),typeof j.container=="string"){if(this._container=e.window.document.getElementById(j.container),!this._container)throw new Error("Container '"+j.container+"' not found.")}else{if(!(j.container instanceof Bs))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=j.container}if(j.maxBounds&&this.setMaxBounds(j.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return te._update(!1)}),this.on("moveend",function(){return te._update(!1)}),this.on("zoom",function(){return te._update(!0)}),e.window!==void 0&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Pi(this,j);var pe=typeof j.hash=="string"&&j.hash||void 0;this._hash=j.hash&&new Cr(pe).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:j.center,zoom:j.zoom,bearing:j.bearing,pitch:j.pitch}),j.bounds&&(this.resize(),this.fitBounds(j.bounds,e.extend({},j.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=j.localIdeographFontFamily,j.style&&this.setStyle(j.style,{localIdeographFontFamily:j.localIdeographFontFamily}),j.attributionControl&&this.addControl(new Ii({customAttribution:j.customAttribution})),this.addControl(new es,j.logoPosition),this.on("style.load",function(){te.transform.unmodified&&te.jumpTo(te.style.stylesheet)}),this.on("data",function(ye){te._update(ye.dataType==="style"),te.fire(new e.Event(ye.dataType+"data",ye))}),this.on("dataloading",function(ye){te.fire(new e.Event(ye.dataType+"dataloading",ye))})}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var R={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return O.prototype._getMapId=function(){return this._mapId},O.prototype.addControl=function(j,te){if(te===void 0&&j.getDefaultPosition&&(te=j.getDefaultPosition()),te===void 0&&(te="top-right"),!j||!j.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var le=j.onAdd(this);this._controls.push(j);var pe=this._controlPositions[te];return te.indexOf("bottom")!==-1?pe.insertBefore(le,pe.firstChild):pe.appendChild(le),this},O.prototype.removeControl=function(j){if(!j||!j.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var te=this._controls.indexOf(j);return te>-1&&this._controls.splice(te,1),j.onRemove(this),this},O.prototype.resize=function(j){var te=this._containerDimensions(),le=te[0],pe=te[1];this._resizeCanvas(le,pe),this.transform.resize(le,pe),this.painter.resize(le,pe);var ye=!this._moving;return ye&&(this.stop(),this.fire(new e.Event("movestart",j)).fire(new e.Event("move",j))),this.fire(new e.Event("resize",j)),ye&&this.fire(new e.Event("moveend",j)),this},O.prototype.getBounds=function(){return this.transform.getBounds()},O.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},O.prototype.setMaxBounds=function(j){return this.transform.setMaxBounds(e.LngLatBounds.convert(j)),this._update()},O.prototype.setMinZoom=function(j){if((j=j??-2)>=-2&&j<=this.transform.maxZoom)return this.transform.minZoom=j,this._update(),this.getZoom()<j&&this.setZoom(j),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},O.prototype.getMinZoom=function(){return this.transform.minZoom},O.prototype.setMaxZoom=function(j){if((j=j??22)>=this.transform.minZoom)return this.transform.maxZoom=j,this._update(),this.getZoom()>j&&this.setZoom(j),this;throw new Error("maxZoom must be greater than the current minZoom")},O.prototype.getMaxZoom=function(){return this.transform.maxZoom},O.prototype.setMinPitch=function(j){if((j=j??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(j>=0&&j<=this.transform.maxPitch)return this.transform.minPitch=j,this._update(),this.getPitch()<j&&this.setPitch(j),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},O.prototype.getMinPitch=function(){return this.transform.minPitch},O.prototype.setMaxPitch=function(j){if((j=j??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(j>=this.transform.minPitch)return this.transform.maxPitch=j,this._update(),this.getPitch()>j&&this.setPitch(j),this;throw new Error("maxPitch must be greater than the current minPitch")},O.prototype.getMaxPitch=function(){return this.transform.maxPitch},O.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},O.prototype.setRenderWorldCopies=function(j){return this.transform.renderWorldCopies=j,this._update()},O.prototype.project=function(j){return this.transform.locationPoint(e.LngLat.convert(j))},O.prototype.unproject=function(j){return this.transform.pointLocation(e.Point.convert(j))},O.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},O.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},O.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},O.prototype._createDelegatedListener=function(j,te,le){var pe,ye=this;if(j==="mouseenter"||j==="mouseover"){var _e=!1;return{layer:te,listener:le,delegates:{mousemove:function(He){var et=ye.getLayer(te)?ye.queryRenderedFeatures(He.point,{layers:[te]}):[];et.length?_e||(_e=!0,le.call(ye,new Sn(j,ye,He.originalEvent,{features:et}))):_e=!1},mouseout:function(){_e=!1}}}}if(j==="mouseleave"||j==="mouseout"){var Ne=!1;return{layer:te,listener:le,delegates:{mousemove:function(He){(ye.getLayer(te)?ye.queryRenderedFeatures(He.point,{layers:[te]}):[]).length?Ne=!0:Ne&&(Ne=!1,le.call(ye,new Sn(j,ye,He.originalEvent)))},mouseout:function(He){Ne&&(Ne=!1,le.call(ye,new Sn(j,ye,He.originalEvent)))}}}}return{layer:te,listener:le,delegates:(pe={},pe[j]=function(He){var et=ye.getLayer(te)?ye.queryRenderedFeatures(He.point,{layers:[te]}):[];et.length&&(He.features=et,le.call(ye,He),delete He.features)},pe)}},O.prototype.on=function(j,te,le){if(le===void 0)return M.prototype.on.call(this,j,te);var pe=this._createDelegatedListener(j,te,le);for(var ye in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[j]=this._delegatedListeners[j]||[],this._delegatedListeners[j].push(pe),pe.delegates)this.on(ye,pe.delegates[ye]);return this},O.prototype.once=function(j,te,le){if(le===void 0)return M.prototype.once.call(this,j,te);var pe=this._createDelegatedListener(j,te,le);for(var ye in pe.delegates)this.once(ye,pe.delegates[ye]);return this},O.prototype.off=function(j,te,le){var pe=this;return le===void 0?M.prototype.off.call(this,j,te):(this._delegatedListeners&&this._delegatedListeners[j]&&function(ye){for(var _e=ye[j],Ne=0;Ne<_e.length;Ne++){var He=_e[Ne];if(He.layer===te&&He.listener===le){for(var et in He.delegates)pe.off(et,He.delegates[et]);return _e.splice(Ne,1),pe}}}(this._delegatedListeners),this)},O.prototype.queryRenderedFeatures=function(j,te){if(!this.style)return[];var le;if(te!==void 0||j===void 0||j instanceof e.Point||Array.isArray(j)||(te=j,j=void 0),te=te||{},(j=j||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||typeof j[0]=="number")le=[e.Point.convert(j)];else{var pe=e.Point.convert(j[0]),ye=e.Point.convert(j[1]);le=[pe,new e.Point(ye.x,pe.y),ye,new e.Point(pe.x,ye.y),pe]}return this.style.queryRenderedFeatures(le,te,this.transform)},O.prototype.querySourceFeatures=function(j,te){return this.style.querySourceFeatures(j,te)},O.prototype.setStyle=function(j,te){return(te=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},te)).diff!==!1&&te.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&j?(this._diffStyle(j,te),this):(this._localIdeographFontFamily=te.localIdeographFontFamily,this._updateStyle(j,te))},O.prototype._getUIString=function(j){var te=this._locale[j];if(te==null)throw new Error("Missing UI string '"+j+"'");return te},O.prototype._updateStyle=function(j,te){return this.style&&(this.style.setEventedParent(null),this.style._remove()),j?(this.style=new Wn(this,te||{}),this.style.setEventedParent(this,{style:this.style}),typeof j=="string"?this.style.loadURL(j):this.style.loadJSON(j),this):(delete this.style,this)},O.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Wn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},O.prototype._diffStyle=function(j,te){var le=this;if(typeof j=="string"){var pe=this._requestManager.normalizeStyleURL(j),ye=this._requestManager.transformRequest(pe,e.ResourceType.Style);e.getJSON(ye,function(_e,Ne){_e?le.fire(new e.ErrorEvent(_e)):Ne&&le._updateDiff(Ne,te)})}else typeof j=="object"&&this._updateDiff(j,te)},O.prototype._updateDiff=function(j,te){try{this.style.setState(j)&&this._update(!0)}catch(le){e.warnOnce("Unable to perform style diff: "+(le.message||le.error||le)+".  Rebuilding the style from scratch."),this._updateStyle(j,te)}},O.prototype.getStyle=function(){if(this.style)return this.style.serialize()},O.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},O.prototype.addSource=function(j,te){return this._lazyInitEmptyStyle(),this.style.addSource(j,te),this._update(!0)},O.prototype.isSourceLoaded=function(j){var te=this.style&&this.style.sourceCaches[j];if(te!==void 0)return te.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+j+"'")))},O.prototype.areTilesLoaded=function(){var j=this.style&&this.style.sourceCaches;for(var te in j){var le=j[te]._tiles;for(var pe in le){var ye=le[pe];if(ye.state!=="loaded"&&ye.state!=="errored")return!1}}return!0},O.prototype.addSourceType=function(j,te,le){return this._lazyInitEmptyStyle(),this.style.addSourceType(j,te,le)},O.prototype.removeSource=function(j){return this.style.removeSource(j),this._update(!0)},O.prototype.getSource=function(j){return this.style.getSource(j)},O.prototype.addImage=function(j,te,le){le===void 0&&(le={});var pe=le.pixelRatio;pe===void 0&&(pe=1);var ye=le.sdf;ye===void 0&&(ye=!1);var _e=le.stretchX,Ne=le.stretchY,He=le.content;if(this._lazyInitEmptyStyle(),te instanceof Fs||ts&&te instanceof ts){var et=e.browser.getImageData(te),yt=et.width,kt=et.height,_t=et.data;this.style.addImage(j,{data:new e.RGBAImage({width:yt,height:kt},_t),pixelRatio:pe,stretchX:_e,stretchY:Ne,content:He,sdf:ye,version:0})}else{if(te.width===void 0||te.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var wt=te.width,vt=te.height,Dt=te.data,Pt=te;this.style.addImage(j,{data:new e.RGBAImage({width:wt,height:vt},new Uint8Array(Dt)),pixelRatio:pe,stretchX:_e,stretchY:Ne,content:He,sdf:ye,version:0,userImage:Pt}),Pt.onAdd&&Pt.onAdd(this,j)}},O.prototype.updateImage=function(j,te){var le=this.style.getImage(j);if(!le)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var pe=te instanceof Fs||ts&&te instanceof ts?e.browser.getImageData(te):te,ye=pe.width,_e=pe.height,Ne=pe.data;if(ye===void 0||_e===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ye!==le.data.width||_e!==le.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var He=!(te instanceof Fs||ts&&te instanceof ts);le.data.replace(Ne,He),this.style.updateImage(j,le)},O.prototype.hasImage=function(j){return j?!!this.style.getImage(j):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},O.prototype.removeImage=function(j){this.style.removeImage(j)},O.prototype.loadImage=function(j,te){e.getImage(this._requestManager.transformRequest(j,e.ResourceType.Image),te)},O.prototype.listImages=function(){return this.style.listImages()},O.prototype.addLayer=function(j,te){return this._lazyInitEmptyStyle(),this.style.addLayer(j,te),this._update(!0)},O.prototype.moveLayer=function(j,te){return this.style.moveLayer(j,te),this._update(!0)},O.prototype.removeLayer=function(j){return this.style.removeLayer(j),this._update(!0)},O.prototype.getLayer=function(j){return this.style.getLayer(j)},O.prototype.setLayerZoomRange=function(j,te,le){return this.style.setLayerZoomRange(j,te,le),this._update(!0)},O.prototype.setFilter=function(j,te,le){return le===void 0&&(le={}),this.style.setFilter(j,te,le),this._update(!0)},O.prototype.getFilter=function(j){return this.style.getFilter(j)},O.prototype.setPaintProperty=function(j,te,le,pe){return pe===void 0&&(pe={}),this.style.setPaintProperty(j,te,le,pe),this._update(!0)},O.prototype.getPaintProperty=function(j,te){return this.style.getPaintProperty(j,te)},O.prototype.setLayoutProperty=function(j,te,le,pe){return pe===void 0&&(pe={}),this.style.setLayoutProperty(j,te,le,pe),this._update(!0)},O.prototype.getLayoutProperty=function(j,te){return this.style.getLayoutProperty(j,te)},O.prototype.setLight=function(j,te){return te===void 0&&(te={}),this._lazyInitEmptyStyle(),this.style.setLight(j,te),this._update(!0)},O.prototype.getLight=function(){return this.style.getLight()},O.prototype.setFeatureState=function(j,te){return this.style.setFeatureState(j,te),this._update()},O.prototype.removeFeatureState=function(j,te){return this.style.removeFeatureState(j,te),this._update()},O.prototype.getFeatureState=function(j){return this.style.getFeatureState(j)},O.prototype.getContainer=function(){return this._container},O.prototype.getCanvasContainer=function(){return this._canvasContainer},O.prototype.getCanvas=function(){return this._canvas},O.prototype._containerDimensions=function(){var j=0,te=0;return this._container&&(j=this._container.clientWidth||400,te=this._container.clientHeight||300),[j,te]},O.prototype._detectMissingCSS=function(){e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},O.prototype._setupContainer=function(){var j=this._container;j.classList.add("mapboxgl-map"),(this._missingCSSCanary=o.create("div","mapboxgl-canary",j)).style.visibility="hidden",this._detectMissingCSS();var te=this._canvasContainer=o.create("div","mapboxgl-canvas-container",j);this._interactive&&te.classList.add("mapboxgl-interactive"),this._canvas=o.create("canvas","mapboxgl-canvas",te),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var le=this._containerDimensions();this._resizeCanvas(le[0],le[1]);var pe=this._controlContainer=o.create("div","mapboxgl-control-container",j),ye=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(_e){ye[_e]=o.create("div","mapboxgl-ctrl-"+_e,pe)})},O.prototype._resizeCanvas=function(j,te){var le=e.browser.devicePixelRatio||1;this._canvas.width=le*j,this._canvas.height=le*te,this._canvas.style.width=j+"px",this._canvas.style.height=te+"px"},O.prototype._setupPainter=function(){var j=e.extend({},l.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),te=this._canvas.getContext("webgl",j)||this._canvas.getContext("experimental-webgl",j);te?(this.painter=new Ca(te,this.transform),e.webpSupported.testSupport(te)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},O.prototype._contextLost=function(j){j.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:j}))},O.prototype._contextRestored=function(j){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:j}))},O.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},O.prototype._update=function(j){return this.style?(this._styleDirty=this._styleDirty||j,this._sourcesDirty=!0,this.triggerRepaint(),this):this},O.prototype._requestRenderFrame=function(j){return this._update(),this._renderTaskQueue.add(j)},O.prototype._cancelRenderFrame=function(j){this._renderTaskQueue.remove(j)},O.prototype._render=function(j){var te,le=this,pe=0,ye=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(te=ye.createQueryEXT(),ye.beginQueryEXT(ye.TIME_ELAPSED_EXT,te),pe=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(j),!this._removed){var _e=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ne=this.transform.zoom,He=e.browser.now();this.style.zoomHistory.update(Ne,He);var et=new e.EvaluationParameters(Ne,{now:He,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),yt=et.crossFadingFactor();yt===1&&yt===this._crossFadingFactor||(_e=!0,this._crossFadingFactor=yt),this.style.update(et)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||_e)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var kt=e.browser.now()-pe;ye.endQueryEXT(ye.TIME_ELAPSED_EXT,te),setTimeout(function(){var wt=ye.getQueryObjectEXT(te,ye.QUERY_RESULT_EXT)/1e6;ye.deleteQueryEXT(te),le.fire(new e.Event("gpu-timing-frame",{cpuTime:kt,gpuTime:wt}))},50)}if(this.listens("gpu-timing-layer")){var _t=this.painter.collectGpuTimers();setTimeout(function(){var wt=le.painter.queryGpuTimers(_t);le.fire(new e.Event("gpu-timing-layer",{layerTimes:wt}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},O.prototype.remove=function(){this._hash&&this._hash.remove();for(var j=0,te=this._controls;j<te.length;j+=1)te[j].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),e.window!==void 0&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var le=this.painter.context.gl.getExtension("WEBGL_lose_context");le&&le.loseContext(),Js(this._canvasContainer),Js(this._controlContainer),Js(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},O.prototype.triggerRepaint=function(){var j=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(te){j._frame=null,j._render(te)}))},O.prototype._onWindowOnline=function(){this._update()},O.prototype._onWindowResize=function(j){this._trackResize&&this.resize({originalEvent:j})._update()},R.showTileBoundaries.get=function(){return!!this._showTileBoundaries},R.showTileBoundaries.set=function(j){this._showTileBoundaries!==j&&(this._showTileBoundaries=j,this._update())},R.showPadding.get=function(){return!!this._showPadding},R.showPadding.set=function(j){this._showPadding!==j&&(this._showPadding=j,this._update())},R.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},R.showCollisionBoxes.set=function(j){this._showCollisionBoxes!==j&&(this._showCollisionBoxes=j,j?this.style._generateCollisionBoxes():this._update())},R.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},R.showOverdrawInspector.set=function(j){this._showOverdrawInspector!==j&&(this._showOverdrawInspector=j,this._update())},R.repaint.get=function(){return!!this._repaint},R.repaint.set=function(j){this._repaint!==j&&(this._repaint=j,this.triggerRepaint())},R.vertices.get=function(){return!!this._vertices},R.vertices.set=function(j){this._vertices=j,this._update()},O.prototype._setCacheLimits=function(j,te){e.setCacheLimits(j,te)},R.version.get=function(){return e.version},Object.defineProperties(O.prototype,R),O}(Rs);function Js(M){M.parentNode&&M.parentNode.removeChild(M)}var ks={showCompass:!0,showZoom:!0,visualizePitch:!1},Ya=function(M){var O=this;this.options=e.extend({},ks,M),this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(R){return R.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(R){return O._map.zoomIn({},{originalEvent:R})}),o.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(R){return O._map.zoomOut({},{originalEvent:R})}),o.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(R){O.options.visualizePitch?O._map.resetNorthPitch({},{originalEvent:R}):O._map.resetNorth({},{originalEvent:R})}),this._compassIcon=o.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ya.prototype._updateZoomButtons=function(){var M=this._map.getZoom();this._zoomInButton.disabled=M===this._map.getMaxZoom(),this._zoomOutButton.disabled=M===this._map.getMinZoom()},Ya.prototype._rotateCompassArrow=function(){var M=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=M},Ya.prototype.onAdd=function(M){return this._map=M,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ei(this._map,this._compass,this.options.visualizePitch)),this._container},Ya.prototype.onRemove=function(){o.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ya.prototype._createButton=function(M,O){var R=o.create("button",M,this._container);return R.type="button",R.addEventListener("click",O),R},Ya.prototype._setButtonTitle=function(M,O){var R=this._map._getUIString("NavigationControl."+O);M.title=R,M.setAttribute("aria-label",R)};var ei=function(M,O,R){R===void 0&&(R=!1),this._clickTolerance=10,this.element=O,this.mouseRotate=new Ma({clickTolerance:M.dragRotate._mouseRotate._clickTolerance}),this.map=M,R&&(this.mousePitch=new fa({clickTolerance:M.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),o.addEventListener(O,"mousedown",this.mousedown),o.addEventListener(O,"touchstart",this.touchstart,{passive:!1}),o.addEventListener(O,"touchmove",this.touchmove),o.addEventListener(O,"touchend",this.touchend),o.addEventListener(O,"touchcancel",this.reset)};function ps(M,O,R){if(M=new e.LngLat(M.lng,M.lat),O){var j=new e.LngLat(M.lng-360,M.lat),te=new e.LngLat(M.lng+360,M.lat),le=R.locationPoint(M).distSqr(O);R.locationPoint(j).distSqr(O)<le?M=j:R.locationPoint(te).distSqr(O)<le&&(M=te)}for(;Math.abs(M.lng-R.center.lng)>180;){var pe=R.locationPoint(M);if(pe.x>=0&&pe.y>=0&&pe.x<=R.width&&pe.y<=R.height)break;M.lng>R.center.lng?M.lng-=360:M.lng+=360}return M}ei.prototype.down=function(M,O){this.mouseRotate.mousedown(M,O),this.mousePitch&&this.mousePitch.mousedown(M,O),o.disableDrag()},ei.prototype.move=function(M,O){var R=this.map,j=this.mouseRotate.mousemoveWindow(M,O);if(j&&j.bearingDelta&&R.setBearing(R.getBearing()+j.bearingDelta),this.mousePitch){var te=this.mousePitch.mousemoveWindow(M,O);te&&te.pitchDelta&&R.setPitch(R.getPitch()+te.pitchDelta)}},ei.prototype.off=function(){var M=this.element;o.removeEventListener(M,"mousedown",this.mousedown),o.removeEventListener(M,"touchstart",this.touchstart,{passive:!1}),o.removeEventListener(M,"touchmove",this.touchmove),o.removeEventListener(M,"touchend",this.touchend),o.removeEventListener(M,"touchcancel",this.reset),this.offTemp()},ei.prototype.offTemp=function(){o.enableDrag(),o.removeEventListener(e.window,"mousemove",this.mousemove),o.removeEventListener(e.window,"mouseup",this.mouseup)},ei.prototype.mousedown=function(M){this.down(e.extend({},M,{ctrlKey:!0,preventDefault:function(){return M.preventDefault()}}),o.mousePos(this.element,M)),o.addEventListener(e.window,"mousemove",this.mousemove),o.addEventListener(e.window,"mouseup",this.mouseup)},ei.prototype.mousemove=function(M){this.move(M,o.mousePos(this.element,M))},ei.prototype.mouseup=function(M){this.mouseRotate.mouseupWindow(M),this.mousePitch&&this.mousePitch.mouseupWindow(M),this.offTemp()},ei.prototype.touchstart=function(M){M.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=o.touchPos(this.element,M.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return M.preventDefault()}},this._startPos))},ei.prototype.touchmove=function(M){M.targetTouches.length!==1?this.reset():(this._lastPos=o.touchPos(this.element,M.targetTouches)[0],this.move({preventDefault:function(){return M.preventDefault()}},this._lastPos))},ei.prototype.touchend=function(M){M.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},ei.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var os={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Si(M,O,R){var j=M.classList;for(var te in os)j.remove("mapboxgl-"+R+"-anchor-"+te);j.add("mapboxgl-"+R+"-anchor-"+O)}var ds,Ms=function(M){function O(R,j){var te=this;if(M.call(this),(R instanceof e.window.HTMLElement||j)&&(R=e.extend({element:R},j)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=R&&R.anchor||"center",this._color=R&&R.color||"#3FB1CE",this._draggable=R&&R.draggable||!1,this._state="inactive",this._rotation=R&&R.rotation||0,this._rotationAlignment=R&&R.rotationAlignment||"auto",this._pitchAlignment=R&&R.pitchAlignment&&R.pitchAlignment!=="auto"?R.pitchAlignment:this._rotationAlignment,R&&R.element)this._element=R.element,this._offset=e.Point.convert(R&&R.offset||[0,0]);else{this._defaultMarker=!0,this._element=o.create("div"),this._element.setAttribute("aria-label","Map marker");var le=o.createNS("http://www.w3.org/2000/svg","svg");le.setAttributeNS(null,"display","block"),le.setAttributeNS(null,"height","41px"),le.setAttributeNS(null,"width","27px"),le.setAttributeNS(null,"viewBox","0 0 27 41");var pe=o.createNS("http://www.w3.org/2000/svg","g");pe.setAttributeNS(null,"stroke","none"),pe.setAttributeNS(null,"stroke-width","1"),pe.setAttributeNS(null,"fill","none"),pe.setAttributeNS(null,"fill-rule","evenodd");var ye=o.createNS("http://www.w3.org/2000/svg","g");ye.setAttributeNS(null,"fill-rule","nonzero");var _e=o.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(3.0, 29.0)"),_e.setAttributeNS(null,"fill","#000000");for(var Ne=0,He=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ne<He.length;Ne+=1){var et=He[Ne],yt=o.createNS("http://www.w3.org/2000/svg","ellipse");yt.setAttributeNS(null,"opacity","0.04"),yt.setAttributeNS(null,"cx","10.5"),yt.setAttributeNS(null,"cy","5.80029008"),yt.setAttributeNS(null,"rx",et.rx),yt.setAttributeNS(null,"ry",et.ry),_e.appendChild(yt)}var kt=o.createNS("http://www.w3.org/2000/svg","g");kt.setAttributeNS(null,"fill",this._color);var _t=o.createNS("http://www.w3.org/2000/svg","path");_t.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),kt.appendChild(_t);var wt=o.createNS("http://www.w3.org/2000/svg","g");wt.setAttributeNS(null,"opacity","0.25"),wt.setAttributeNS(null,"fill","#000000");var vt=o.createNS("http://www.w3.org/2000/svg","path");vt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),wt.appendChild(vt);var Dt=o.createNS("http://www.w3.org/2000/svg","g");Dt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Dt.setAttributeNS(null,"fill","#FFFFFF");var Pt=o.createNS("http://www.w3.org/2000/svg","g");Pt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Ft=o.createNS("http://www.w3.org/2000/svg","circle");Ft.setAttributeNS(null,"fill","#000000"),Ft.setAttributeNS(null,"opacity","0.25"),Ft.setAttributeNS(null,"cx","5.5"),Ft.setAttributeNS(null,"cy","5.5"),Ft.setAttributeNS(null,"r","5.4999962");var er=o.createNS("http://www.w3.org/2000/svg","circle");er.setAttributeNS(null,"fill","#FFFFFF"),er.setAttributeNS(null,"cx","5.5"),er.setAttributeNS(null,"cy","5.5"),er.setAttributeNS(null,"r","5.4999962"),Pt.appendChild(Ft),Pt.appendChild(er),ye.appendChild(_e),ye.appendChild(kt),ye.appendChild(wt),ye.appendChild(Dt),ye.appendChild(Pt),le.appendChild(ye),this._element.appendChild(le),this._offset=e.Point.convert(R&&R.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(cr){cr.preventDefault()}),this._element.addEventListener("mousedown",function(cr){cr.preventDefault()}),this._element.addEventListener("focus",function(){var cr=te._map.getContainer();cr.scrollTop=0,cr.scrollLeft=0}),Si(this._element,this._anchor,"marker"),this._popup=null}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.addTo=function(R){return this.remove(),this._map=R,R.getCanvasContainer().appendChild(this._element),R.on("move",this._update),R.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},O.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),o.remove(this._element),this._popup&&this._popup.remove(),this},O.prototype.getLngLat=function(){return this._lngLat},O.prototype.setLngLat=function(R){return this._lngLat=e.LngLat.convert(R),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},O.prototype.getElement=function(){return this._element},O.prototype.setPopup=function(R){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),R){if(!("offset"in R.options)){var j=Math.sqrt(Math.pow(13.5,2)/2);R.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[j,-1*(24.6+j)],"bottom-right":[-j,-1*(24.6+j)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=R,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},O.prototype._onKeyPress=function(R){var j=R.code,te=R.charCode||R.keyCode;j!=="Space"&&j!=="Enter"&&te!==32&&te!==13||this.togglePopup()},O.prototype._onMapClick=function(R){var j=R.originalEvent.target,te=this._element;this._popup&&(j===te||te.contains(j))&&this.togglePopup()},O.prototype.getPopup=function(){return this._popup},O.prototype.togglePopup=function(){var R=this._popup;return R?(R.isOpen()?R.remove():R.addTo(this._map),this):this},O.prototype._update=function(R){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ps(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var j="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?j="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(j="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var te="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?te="rotateX(0deg)":this._pitchAlignment==="map"&&(te="rotateX("+this._map.getPitch()+"deg)"),R&&R.type!=="moveend"||(this._pos=this._pos.round()),o.setTransform(this._element,os[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+te+" "+j)}},O.prototype.getOffset=function(){return this._offset},O.prototype.setOffset=function(R){return this._offset=e.Point.convert(R),this._update(),this},O.prototype._onMove=function(R){this._pos=R.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},O.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},O.prototype._addDragHandler=function(R){this._element.contains(R.originalEvent.target)&&(R.preventDefault(),this._positionDelta=R.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},O.prototype.setDraggable=function(R){return this._draggable=!!R,this._map&&(R?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},O.prototype.isDraggable=function(){return this._draggable},O.prototype.setRotation=function(R){return this._rotation=R||0,this._update(),this},O.prototype.getRotation=function(){return this._rotation},O.prototype.setRotationAlignment=function(R){return this._rotationAlignment=R||"auto",this._update(),this},O.prototype.getRotationAlignment=function(){return this._rotationAlignment},O.prototype.setPitchAlignment=function(R){return this._pitchAlignment=R&&R!=="auto"?R:this._rotationAlignment,this._update(),this},O.prototype.getPitchAlignment=function(){return this._pitchAlignment},O}(e.Evented),ys={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},As=0,ss=!1,Ks=function(M){function O(R){M.call(this),this.options=e.extend({},ys,R),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.onAdd=function(R){var j;return this._map=R,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),j=this._setupUI,ds!==void 0?j(ds):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(te){ds=te.state!=="denied",j(ds)}):(ds=!!e.window.navigator.geolocation,j(ds)),this._container},O.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),o.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,As=0,ss=!1},O.prototype._isOutOfMapMaxBounds=function(R){var j=this._map.getMaxBounds(),te=R.coords;return j&&(te.longitude<j.getWest()||te.longitude>j.getEast()||te.latitude<j.getSouth()||te.latitude>j.getNorth())},O.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},O.prototype._onSuccess=function(R){if(this._map){if(this._isOutOfMapMaxBounds(R))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",R)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=R,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(R),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(R),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",R)),this._finish()}},O.prototype._updateCamera=function(R){var j=new e.LngLat(R.coords.longitude,R.coords.latitude),te=R.coords.accuracy,le=this._map.getBearing(),pe=e.extend({bearing:le},this.options.fitBoundsOptions);this._map.fitBounds(j.toBounds(te),pe,{geolocateSource:!0})},O.prototype._updateMarker=function(R){if(R){var j=new e.LngLat(R.coords.longitude,R.coords.latitude);this._accuracyCircleMarker.setLngLat(j).addTo(this._map),this._userLocationDotMarker.setLngLat(j).addTo(this._map),this._accuracy=R.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},O.prototype._updateCircleRadius=function(){var R=this._map._container.clientHeight/2,j=this._map.unproject([0,R]),te=this._map.unproject([1,R]),le=j.distanceTo(te),pe=Math.ceil(2*this._accuracy/le);this._circleElement.style.width=pe+"px",this._circleElement.style.height=pe+"px"},O.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},O.prototype._onError=function(R){if(this._map){if(this.options.trackUserLocation)if(R.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var j=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=j,this._geolocateButton.setAttribute("aria-label",j),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(R.code===3&&ss)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",R)),this._finish()}},O.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},O.prototype._setupUI=function(R){var j=this;if(this._container.addEventListener("contextmenu",function(pe){return pe.preventDefault()}),this._geolocateButton=o.create("button","mapboxgl-ctrl-geolocate",this._container),o.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",R===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var te=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=te,this._geolocateButton.setAttribute("aria-label",te)}else{var le=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=le,this._geolocateButton.setAttribute("aria-label",le)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ms(this._dotElement),this._circleElement=o.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ms({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(pe){var ye=pe.originalEvent&&pe.originalEvent.type==="resize";pe.geolocateSource||j._watchState!=="ACTIVE_LOCK"||ye||(j._watchState="BACKGROUND",j._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),j._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),j.fire(new e.Event("trackuserlocationend")))})},O.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":As--,ss=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var R;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++As>1?(R={maximumAge:6e5,timeout:0},ss=!0):(R=this.options.positionOptions,ss=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,R)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},O.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},O}(e.Evented),ol={maxWidth:100,unit:"metric"},gs=function(M){this.options=e.extend({},ol,M),e.bindAll(["_onMove","setUnit"],this)};function Qs(M,O,R){var j=R&&R.maxWidth||100,te=M._container.clientHeight/2,le=M.unproject([0,te]),pe=M.unproject([j,te]),ye=le.distanceTo(pe);if(R&&R.unit==="imperial"){var _e=3.2808*ye;_e>5280?Ss(O,j,_e/5280,M._getUIString("ScaleControl.Miles")):Ss(O,j,_e,M._getUIString("ScaleControl.Feet"))}else R&&R.unit==="nautical"?Ss(O,j,ye/1852,M._getUIString("ScaleControl.NauticalMiles")):ye>=1e3?Ss(O,j,ye/1e3,M._getUIString("ScaleControl.Kilometers")):Ss(O,j,ye,M._getUIString("ScaleControl.Meters"))}function Ss(M,O,R,j){var te,le,pe,ye=(te=R,le=Math.pow(10,(""+Math.floor(te)).length-1),pe=(pe=te/le)>=10?10:pe>=5?5:pe>=3?3:pe>=2?2:pe>=1?1:function(Ne){var He=Math.pow(10,Math.ceil(-Math.log(Ne)/Math.LN10));return Math.round(Ne*He)/He}(pe),le*pe),_e=ye/R;M.style.width=O*_e+"px",M.innerHTML=ye+"&nbsp;"+j}gs.prototype.getDefaultPosition=function(){return"bottom-left"},gs.prototype._onMove=function(){Qs(this._map,this._container,this.options)},gs.prototype.onAdd=function(M){return this._map=M,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",M.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},gs.prototype.onRemove=function(){o.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},gs.prototype.setUnit=function(M){this.options.unit=M,Qs(this._map,this._container,this.options)};var eo=function(M){this._fullscreen=!1,M&&M.container&&(M.container instanceof e.window.HTMLElement?this._container=M.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};eo.prototype.onAdd=function(M){return this._map=M,this._container||(this._container=this._map.getContainer()),this._controlContainer=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},eo.prototype.onRemove=function(){o.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},eo.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},eo.prototype._setupUI=function(){var M=this._fullscreenButton=o.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);o.create("span","mapboxgl-ctrl-icon",M).setAttribute("aria-hidden",!0),M.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},eo.prototype._updateTitle=function(){var M=this._getTitle();this._fullscreenButton.setAttribute("aria-label",M),this._fullscreenButton.title=M},eo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},eo.prototype._isFullscreen=function(){return this._fullscreen},eo.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},eo.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var sl={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},ll=function(M){function O(R){M.call(this),this.options=e.extend(Object.create(sl),R),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.addTo=function(R){return this._map&&this.remove(),this._map=R,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},O.prototype.isOpen=function(){return!!this._map},O.prototype.remove=function(){return this._content&&o.remove(this._content),this._container&&(o.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},O.prototype.getLngLat=function(){return this._lngLat},O.prototype.setLngLat=function(R){return this._lngLat=e.LngLat.convert(R),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},O.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},O.prototype.getElement=function(){return this._container},O.prototype.setText=function(R){return this.setDOMContent(e.window.document.createTextNode(R))},O.prototype.setHTML=function(R){var j,te=e.window.document.createDocumentFragment(),le=e.window.document.createElement("body");for(le.innerHTML=R;j=le.firstChild;)te.appendChild(j);return this.setDOMContent(te)},O.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},O.prototype.setMaxWidth=function(R){return this.options.maxWidth=R,this._update(),this},O.prototype.setDOMContent=function(R){return this._createContent(),this._content.appendChild(R),this._update(),this},O.prototype.addClassName=function(R){this._container&&this._container.classList.add(R)},O.prototype.removeClassName=function(R){this._container&&this._container.classList.remove(R)},O.prototype.toggleClassName=function(R){if(this._container)return this._container.classList.toggle(R)},O.prototype._createContent=function(){this._content&&o.remove(this._content),this._content=o.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=o.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},O.prototype._onMouseUp=function(R){this._update(R.point)},O.prototype._onMouseMove=function(R){this._update(R.point)},O.prototype._onDrag=function(R){this._update(R.point)},O.prototype._update=function(R){var j=this,te=this._lngLat||this._trackPointer;if(this._map&&te&&this._content&&(this._container||(this._container=o.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=o.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(yt){return j._container.classList.add(yt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ps(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||R)){var le=this._pos=this._trackPointer&&R?R:this._map.project(this._lngLat),pe=this.options.anchor,ye=function yt(kt){if(kt){if(typeof kt=="number"){var _t=Math.round(Math.sqrt(.5*Math.pow(kt,2)));return{center:new e.Point(0,0),top:new e.Point(0,kt),"top-left":new e.Point(_t,_t),"top-right":new e.Point(-_t,_t),bottom:new e.Point(0,-kt),"bottom-left":new e.Point(_t,-_t),"bottom-right":new e.Point(-_t,-_t),left:new e.Point(kt,0),right:new e.Point(-kt,0)}}if(kt instanceof e.Point||Array.isArray(kt)){var wt=e.Point.convert(kt);return{center:wt,top:wt,"top-left":wt,"top-right":wt,bottom:wt,"bottom-left":wt,"bottom-right":wt,left:wt,right:wt}}return{center:e.Point.convert(kt.center||[0,0]),top:e.Point.convert(kt.top||[0,0]),"top-left":e.Point.convert(kt["top-left"]||[0,0]),"top-right":e.Point.convert(kt["top-right"]||[0,0]),bottom:e.Point.convert(kt.bottom||[0,0]),"bottom-left":e.Point.convert(kt["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(kt["bottom-right"]||[0,0]),left:e.Point.convert(kt.left||[0,0]),right:e.Point.convert(kt.right||[0,0])}}return yt(new e.Point(0,0))}(this.options.offset);if(!pe){var _e,Ne=this._container.offsetWidth,He=this._container.offsetHeight;_e=le.y+ye.bottom.y<He?["top"]:le.y>this._map.transform.height-He?["bottom"]:[],le.x<Ne/2?_e.push("left"):le.x>this._map.transform.width-Ne/2&&_e.push("right"),pe=_e.length===0?"bottom":_e.join("-")}var et=le.add(ye[pe]).round();o.setTransform(this._container,os[pe]+" translate("+et.x+"px,"+et.y+"px)"),Si(this._container,pe,"popup")}},O.prototype._onClose=function(){this.remove()},O}(e.Evented),oe={version:e.version,supported:l,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:qo,NavigationControl:Ya,GeolocateControl:Ks,AttributionControl:Ii,ScaleControl:gs,FullscreenControl:eo,Popup:ll,Marker:Ms,Style:Wn,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){st().acquire(xt)},clearPrewarmedResources:function(){var M=bt;M&&(M.isPreloaded()&&M.numActive()===1?(M.release(xt),bt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(M){e.config.ACCESS_TOKEN=M},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(M){e.config.API_URL=M},get workerCount(){return Lt.workerCount},set workerCount(M){Lt.workerCount=M},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(M){e.config.MAX_PARALLEL_IMAGE_REQUESTS=M},clearStorage:function(M){e.clearTileCache(M)},workerUrl:""};return oe}),p})},{}],462:[function(i,B,V){B.exports=function(u){for(var e=1<<u+1,l=new Array(e),o=0;o<e;++o)l[o]=p(u,o);return l};var t=i("convex-hull");function h(u,e,l){for(var o=new Array(u),a=0;a<u;++a)o[a]=0,a===e&&(o[a]+=.5),a===l&&(o[a]+=.5);return o}function p(u,e){if(e===0||e===(1<<u+1)-1)return[];for(var l=[],o=[],a=0;a<=u;++a)if(e&1<<a){l.push(h(u,a-1,a-1)),o.push(null);for(var n=0;n<=u;++n)~e&1<<n&&(l.push(h(u,a-1,n-1)),o.push([a,n]))}var s=t(l),r=[];e:for(a=0;a<s.length;++a){var c=s[a],f=[];for(n=0;n<c.length;++n){if(!o[c[n]])continue e;f.push(o[c[n]].slice())}r.push(f)}return r}},{"convex-hull":141}],463:[function(i,B,V){var t=i("./normalize"),h=i("gl-mat4/create"),p=i("gl-mat4/clone"),u=i("gl-mat4/determinant"),e=i("gl-mat4/invert"),l=i("gl-mat4/transpose"),o={length:i("gl-vec3/length"),normalize:i("gl-vec3/normalize"),dot:i("gl-vec3/dot"),cross:i("gl-vec3/cross")},a=h(),n=h(),s=[0,0,0,0],r=[[0,0,0],[0,0,0],[0,0,0]],c=[0,0,0];function f(d,g,m,y,v){d[0]=g[0]*y+m[0]*v,d[1]=g[1]*y+m[1]*v,d[2]=g[2]*y+m[2]*v}B.exports=function(d,g,m,y,v,T){if(g||(g=[0,0,0]),m||(m=[0,0,0]),y||(y=[0,0,0]),v||(v=[0,0,0,1]),T||(T=[0,0,0,1]),!t(a,d)||(p(n,a),n[3]=0,n[7]=0,n[11]=0,n[15]=1,Math.abs(u(n)<1e-8)))return!1;var _,k,E,A,b,L,w,C=a[3],S=a[7],P=a[11],z=a[12],F=a[13],q=a[14],W=a[15];if(C!==0||S!==0||P!==0){if(s[0]=C,s[1]=S,s[2]=P,s[3]=W,!e(n,n))return!1;l(n,n),_=v,E=n,A=(k=s)[0],b=k[1],L=k[2],w=k[3],_[0]=E[0]*A+E[4]*b+E[8]*L+E[12]*w,_[1]=E[1]*A+E[5]*b+E[9]*L+E[13]*w,_[2]=E[2]*A+E[6]*b+E[10]*L+E[14]*w,_[3]=E[3]*A+E[7]*b+E[11]*L+E[15]*w}else v[0]=v[1]=v[2]=0,v[3]=1;if(g[0]=z,g[1]=F,g[2]=q,function(Q,Z){Q[0][0]=Z[0],Q[0][1]=Z[1],Q[0][2]=Z[2],Q[1][0]=Z[4],Q[1][1]=Z[5],Q[1][2]=Z[6],Q[2][0]=Z[8],Q[2][1]=Z[9],Q[2][2]=Z[10]}(r,a),m[0]=o.length(r[0]),o.normalize(r[0],r[0]),y[0]=o.dot(r[0],r[1]),f(r[1],r[1],r[0],1,-y[0]),m[1]=o.length(r[1]),o.normalize(r[1],r[1]),y[0]/=m[1],y[1]=o.dot(r[0],r[2]),f(r[2],r[2],r[0],1,-y[1]),y[2]=o.dot(r[1],r[2]),f(r[2],r[2],r[1],1,-y[2]),m[2]=o.length(r[2]),o.normalize(r[2],r[2]),y[1]/=m[2],y[2]/=m[2],o.cross(c,r[1],r[2]),o.dot(r[0],c)<0)for(var X=0;X<3;X++)m[X]*=-1,r[X][0]*=-1,r[X][1]*=-1,r[X][2]*=-1;return T[0]=.5*Math.sqrt(Math.max(1+r[0][0]-r[1][1]-r[2][2],0)),T[1]=.5*Math.sqrt(Math.max(1-r[0][0]+r[1][1]-r[2][2],0)),T[2]=.5*Math.sqrt(Math.max(1-r[0][0]-r[1][1]+r[2][2],0)),T[3]=.5*Math.sqrt(Math.max(1+r[0][0]+r[1][1]+r[2][2],0)),r[2][1]>r[1][2]&&(T[0]=-T[0]),r[0][2]>r[2][0]&&(T[1]=-T[1]),r[1][0]>r[0][1]&&(T[2]=-T[2]),!0}},{"./normalize":464,"gl-mat4/clone":284,"gl-mat4/create":286,"gl-mat4/determinant":287,"gl-mat4/invert":299,"gl-mat4/transpose":312,"gl-vec3/cross":368,"gl-vec3/dot":373,"gl-vec3/length":383,"gl-vec3/normalize":390}],464:[function(i,B,V){B.exports=function(t,h){var p=h[15];if(p===0)return!1;for(var u=1/p,e=0;e<16;e++)t[e]=h[e]*u;return!0}},{}],465:[function(i,B,V){var t=i("gl-vec3/lerp"),h=i("mat4-recompose"),p=i("mat4-decompose"),u=i("gl-mat4/determinant"),e=i("quat-slerp"),l=n(),o=n(),a=n();function n(){return{translate:s(),scale:s(1),skew:s(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function s(r){return[r||0,r||0,r||0]}B.exports=function(r,c,f,d){if(u(c)===0||u(f)===0)return!1;var g=p(c,l.translate,l.scale,l.skew,l.perspective,l.quaternion),m=p(f,o.translate,o.scale,o.skew,o.perspective,o.quaternion);return!(!g||!m)&&(t(a.translate,l.translate,o.translate,d),t(a.skew,l.skew,o.skew,d),t(a.scale,l.scale,o.scale,d),t(a.perspective,l.perspective,o.perspective,d),e(a.quaternion,l.quaternion,o.quaternion,d),h(r,a.translate,a.scale,a.skew,a.perspective,a.quaternion),!0)}},{"gl-mat4/determinant":287,"gl-vec3/lerp":384,"mat4-decompose":463,"mat4-recompose":466,"quat-slerp":529}],466:[function(i,B,V){var t={identity:i("gl-mat4/identity"),translate:i("gl-mat4/translate"),multiply:i("gl-mat4/multiply"),create:i("gl-mat4/create"),scale:i("gl-mat4/scale"),fromRotationTranslation:i("gl-mat4/fromRotationTranslation")},h=(t.create(),t.create());B.exports=function(p,u,e,l,o,a){return t.identity(p),t.fromRotationTranslation(p,a,u),p[3]=o[0],p[7]=o[1],p[11]=o[2],p[15]=o[3],t.identity(h),l[2]!==0&&(h[9]=l[2],t.multiply(p,p,h)),l[1]!==0&&(h[9]=0,h[8]=l[1],t.multiply(p,p,h)),l[0]!==0&&(h[8]=0,h[4]=l[0],t.multiply(p,p,h)),t.scale(p,p,e),p}},{"gl-mat4/create":286,"gl-mat4/fromRotationTranslation":290,"gl-mat4/identity":297,"gl-mat4/multiply":301,"gl-mat4/scale":309,"gl-mat4/translate":311}],467:[function(i,B,V){B.exports=Math.log2||function(t){return Math.log(t)*Math.LOG2E}},{}],468:[function(i,B,V){var t=i("binary-search-bounds"),h=i("mat4-interpolate"),p=i("gl-mat4/invert"),u=i("gl-mat4/rotateX"),e=i("gl-mat4/rotateY"),l=i("gl-mat4/rotateZ"),o=i("gl-mat4/lookAt"),a=i("gl-mat4/translate"),n=(i("gl-mat4/scale"),i("gl-vec3/normalize")),s=[0,0,0];function r(d){this._components=d.slice(),this._time=[0],this.prevMatrix=d.slice(),this.nextMatrix=d.slice(),this.computedMatrix=d.slice(),this.computedInverse=d.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}B.exports=function(d){return new r((d=d||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var c=r.prototype;c.recalcMatrix=function(d){var g=this._time,m=t.le(g,d),y=this.computedMatrix;if(!(m<0)){var v=this._components;if(m===g.length-1)for(var T=16*m,_=0;_<16;++_)y[_]=v[T++];else{var k=g[m+1]-g[m],E=(T=16*m,this.prevMatrix),A=!0;for(_=0;_<16;++_)E[_]=v[T++];var b=this.nextMatrix;for(_=0;_<16;++_)b[_]=v[T++],A=A&&E[_]===b[_];if(k<1e-6||A)for(_=0;_<16;++_)y[_]=E[_];else h(y,E,b,(d-g[m])/k)}var L=this.computedUp;L[0]=y[1],L[1]=y[5],L[2]=y[9],n(L,L);var w=this.computedInverse;p(w,y);var C=this.computedEye,S=w[15];C[0]=w[12]/S,C[1]=w[13]/S,C[2]=w[14]/S;var P=this.computedCenter,z=Math.exp(this.computedRadius[0]);for(_=0;_<3;++_)P[_]=C[_]-y[2+4*_]*z}},c.idle=function(d){if(!(d<this.lastT())){for(var g=this._components,m=g.length-16,y=0;y<16;++y)g.push(g[m++]);this._time.push(d)}},c.flush=function(d){var g=t.gt(this._time,d)-2;g<0||(this._time.splice(0,g),this._components.splice(0,16*g))},c.lastT=function(){return this._time[this._time.length-1]},c.lookAt=function(d,g,m,y){this.recalcMatrix(d),g=g||this.computedEye,m=m||s,y=y||this.computedUp,this.setMatrix(d,o(this.computedMatrix,g,m,y));for(var v=0,T=0;T<3;++T)v+=Math.pow(m[T]-g[T],2);v=Math.log(Math.sqrt(v)),this.computedRadius[0]=v},c.rotate=function(d,g,m,y){this.recalcMatrix(d);var v=this.computedInverse;g&&e(v,v,g),m&&u(v,v,m),y&&l(v,v,y),this.setMatrix(d,p(this.computedMatrix,v))};var f=[0,0,0];c.pan=function(d,g,m,y){f[0]=-(g||0),f[1]=-(m||0),f[2]=-(y||0),this.recalcMatrix(d);var v=this.computedInverse;a(v,v,f),this.setMatrix(d,p(v,v))},c.translate=function(d,g,m,y){f[0]=g||0,f[1]=m||0,f[2]=y||0,this.recalcMatrix(d);var v=this.computedMatrix;a(v,v,f),this.setMatrix(d,v)},c.setMatrix=function(d,g){if(!(d<this.lastT())){this._time.push(d);for(var m=0;m<16;++m)this._components.push(g[m])}},c.setDistance=function(d,g){this.computedRadius[0]=g},c.setDistanceLimits=function(d,g){var m=this._limits;m[0]=d,m[1]=g},c.getDistanceLimits=function(d){var g=this._limits;return d?(d[0]=g[0],d[1]=g[1],d):g}},{"binary-search-bounds":103,"gl-mat4/invert":299,"gl-mat4/lookAt":300,"gl-mat4/rotateX":306,"gl-mat4/rotateY":307,"gl-mat4/rotateZ":308,"gl-mat4/scale":309,"gl-mat4/translate":311,"gl-vec3/normalize":390,"mat4-interpolate":465}],469:[function(i,B,V){B.exports=function(h){var p=h.length;if(p<3){for(var u=new Array(p),e=0;e<p;++e)u[e]=e;return p===2&&h[0][0]===h[1][0]&&h[0][1]===h[1][1]?[0]:u}var l=new Array(p);for(e=0;e<p;++e)l[e]=e;l.sort(function(g,m){var y=h[g][0]-h[m][0];return y||h[g][1]-h[m][1]});var o=[l[0],l[1]],a=[l[0],l[1]];for(e=2;e<p;++e){for(var n=l[e],s=h[n],r=o.length;r>1&&t(h[o[r-2]],h[o[r-1]],s)<=0;)r-=1,o.pop();for(o.push(n),r=a.length;r>1&&t(h[a[r-2]],h[a[r-1]],s)>=0;)r-=1,a.pop();a.push(n)}u=new Array(a.length+o.length-2);for(var c=0,f=(e=0,o.length);e<f;++e)u[c++]=o[e];for(var d=a.length-2;d>0;--d)u[c++]=a[d];return u};var t=i("robust-orientation")[3]},{"robust-orientation":548}],470:[function(i,B,V){B.exports=function(h,p){p||(p=h,h=window);var u=0,e=0,l=0,o={shift:!1,alt:!1,control:!1,meta:!1},a=!1;function n(T){var _=!1;return"altKey"in T&&(_=_||T.altKey!==o.alt,o.alt=!!T.altKey),"shiftKey"in T&&(_=_||T.shiftKey!==o.shift,o.shift=!!T.shiftKey),"ctrlKey"in T&&(_=_||T.ctrlKey!==o.control,o.control=!!T.ctrlKey),"metaKey"in T&&(_=_||T.metaKey!==o.meta,o.meta=!!T.metaKey),_}function s(T,_){var k=t.x(_),E=t.y(_);"buttons"in _&&(T=0|_.buttons),(T!==u||k!==e||E!==l||n(_))&&(u=0|T,e=k||0,l=E||0,p&&p(u,e,l,o))}function r(T){s(0,T)}function c(){(u||e||l||o.shift||o.alt||o.meta||o.control)&&(e=l=0,u=0,o.shift=o.alt=o.control=o.meta=!1,p&&p(0,0,0,o))}function f(T){n(T)&&p&&p(u,e,l,o)}function d(T){t.buttons(T)===0?s(0,T):s(u,T)}function g(T){s(u|t.buttons(T),T)}function m(T){s(u&~t.buttons(T),T)}function y(){a||(a=!0,h.addEventListener("mousemove",d),h.addEventListener("mousedown",g),h.addEventListener("mouseup",m),h.addEventListener("mouseleave",r),h.addEventListener("mouseenter",r),h.addEventListener("mouseout",r),h.addEventListener("mouseover",r),h.addEventListener("blur",c),h.addEventListener("keyup",f),h.addEventListener("keydown",f),h.addEventListener("keypress",f),h!==window&&(window.addEventListener("blur",c),window.addEventListener("keyup",f),window.addEventListener("keydown",f),window.addEventListener("keypress",f)))}y();var v={element:h};return Object.defineProperties(v,{enabled:{get:function(){return a},set:function(T){T?y():function(){a&&(a=!1,h.removeEventListener("mousemove",d),h.removeEventListener("mousedown",g),h.removeEventListener("mouseup",m),h.removeEventListener("mouseleave",r),h.removeEventListener("mouseenter",r),h.removeEventListener("mouseout",r),h.removeEventListener("mouseover",r),h.removeEventListener("blur",c),h.removeEventListener("keyup",f),h.removeEventListener("keydown",f),h.removeEventListener("keypress",f),h!==window&&(window.removeEventListener("blur",c),window.removeEventListener("keyup",f),window.removeEventListener("keydown",f),window.removeEventListener("keypress",f)))}()},enumerable:!0},buttons:{get:function(){return u},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return l},enumerable:!0},mods:{get:function(){return o},enumerable:!0}}),v};var t=i("mouse-event")},{"mouse-event":472}],471:[function(i,B,V){var t={left:0,top:0};B.exports=function(h,p,u){p=p||h.currentTarget||h.srcElement,Array.isArray(u)||(u=[0,0]);var e=h.clientX||0,l=h.clientY||0,o=(a=p,a===window||a===document||a===document.body?t:a.getBoundingClientRect()),a;return u[0]=e-o.left,u[1]=l-o.top,u}},{}],472:[function(i,B,V){function t(h){return h.target||h.srcElement||window}V.buttons=function(h){if(typeof h=="object"){if("buttons"in h)return h.buttons;if("which"in h){if((p=h.which)===2)return 4;if(p===3)return 2;if(p>0)return 1<<p-1}else if("button"in h){var p;if((p=h.button)===1)return 4;if(p===2)return 2;if(p>=0)return 1<<p}}return 0},V.element=t,V.x=function(h){if(typeof h=="object"){if("offsetX"in h)return h.offsetX;var p=t(h).getBoundingClientRect();return h.clientX-p.left}return 0},V.y=function(h){if(typeof h=="object"){if("offsetY"in h)return h.offsetY;var p=t(h).getBoundingClientRect();return h.clientY-p.top}return 0}},{}],473:[function(i,B,V){var t=i("to-px");B.exports=function(h,p,u){typeof h=="function"&&(u=!!p,p=h,h=window);var e=t("ex",h),l=function(o){u&&o.preventDefault();var a=o.deltaX||0,n=o.deltaY||0,s=o.deltaZ||0,r=1;switch(o.deltaMode){case 1:r=e;break;case 2:r=window.innerHeight}if(n*=r,s*=r,(a*=r)||n||s)return p(a,n,s,o)};return h.addEventListener("wheel",l),l}},{"to-px":600}],474:[function(i,B,V){(function(t,h){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(p,u,e){u[p]=u[p]||e(),B!==void 0&&B.exports&&(B.exports=u[p])})("Promise",t!==void 0?t:this,function(){var p,u,e,l=Object.prototype.toString,o=h!==void 0?function(T){return h(T)}:setTimeout;try{Object.defineProperty({},"x",{}),p=function(T,_,k,E){return Object.defineProperty(T,_,{value:k,writable:!0,configurable:E!==!1})}}catch{p=function(_,k,E){return _[k]=E,_}}function a(T,_){e.add(T,_),u||(u=o(e.drain))}function n(T){var _,k=typeof T;return T==null||k!="object"&&k!="function"||(_=T.then),typeof _=="function"&&_}function s(){for(var T=0;T<this.chain.length;T++)r(this,this.state===1?this.chain[T].success:this.chain[T].failure,this.chain[T]);this.chain.length=0}function r(T,_,k){var E,A;try{_===!1?k.reject(T.msg):(E=_===!0?T.msg:_.call(void 0,T.msg))===k.promise?k.reject(TypeError("Promise-chain cycle")):(A=n(E))?A.call(E,k.resolve,k.reject):k.resolve(E)}catch(b){k.reject(b)}}function c(T){var _,k=this;if(!k.triggered){k.triggered=!0,k.def&&(k=k.def);try{(_=n(T))?a(function(){var E=new g(k);try{_.call(T,function(){c.apply(E,arguments)},function(){f.apply(E,arguments)})}catch(A){f.call(E,A)}}):(k.msg=T,k.state=1,k.chain.length>0&&a(s,k))}catch(E){f.call(new g(k),E)}}}function f(T){var _=this;_.triggered||(_.triggered=!0,_.def&&(_=_.def),_.msg=T,_.state=2,_.chain.length>0&&a(s,_))}function d(T,_,k,E){for(var A=0;A<_.length;A++)(function(b){T.resolve(_[b]).then(function(L){k(b,L)},E)})(A)}function g(T){this.def=T,this.triggered=!1}function m(T){this.promise=T,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function y(T){if(typeof T!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var _=new m(this);this.then=function(k,E){var A={success:typeof k!="function"||k,failure:typeof E=="function"&&E};return A.promise=new this.constructor(function(b,L){if(typeof b!="function"||typeof L!="function")throw TypeError("Not a function");A.resolve=b,A.reject=L}),_.chain.push(A),_.state!==0&&a(s,_),A.promise},this.catch=function(k){return this.then(void 0,k)};try{T.call(void 0,function(k){c.call(_,k)},function(k){f.call(_,k)})}catch(k){f.call(_,k)}}e=function(){var T,_,k;function E(A,b){this.fn=A,this.self=b,this.next=void 0}return{add:function(A,b){k=new E(A,b),_?_.next=k:T=k,_=k,k=void 0},drain:function(){var A=T;for(T=_=u=void 0;A;)A.fn.call(A.self),A=A.next}}}();var v=p({},"constructor",y,!1);return y.prototype=v,p(v,"__NPO__",0,!1),p(y,"resolve",function(T){return T&&typeof T=="object"&&T.__NPO__===1?T:new this(function(_,k){if(typeof _!="function"||typeof k!="function")throw TypeError("Not a function");_(T)})}),p(y,"reject",function(T){return new this(function(_,k){if(typeof _!="function"||typeof k!="function")throw TypeError("Not a function");k(T)})}),p(y,"all",function(T){var _=this;return l.call(T)!="[object Array]"?_.reject(TypeError("Not an array")):T.length===0?_.resolve([]):new _(function(k,E){if(typeof k!="function"||typeof E!="function")throw TypeError("Not a function");var A=T.length,b=Array(A),L=0;d(_,T,function(w,C){b[w]=C,++L===A&&k(b)},E)})}),p(y,"race",function(T){var _=this;return l.call(T)!="[object Array]"?_.reject(TypeError("Not an array")):new _(function(k,E){if(typeof k!="function"||typeof E!="function")throw TypeError("Not a function");d(_,T,function(A,b){k(b)},E)})}),y})}).call(this)}).call(this,typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{},i("timers").setImmediate)},{timers:597}],475:[function(i,B,V){var t=i("typedarray-pool");function h(v){return"a"+v}function p(v){return"d"+v}function u(v,T){return"c"+v+"_"+T}function e(v){return"s"+v}function l(v,T){return"t"+v+"_"+T}function o(v){return"o"+v}function a(v){return"x"+v}function n(v){return"p"+v}function s(v,T){return"d"+v+"_"+T}function r(v){return"i"+v}function c(v,T){return"u"+v+"_"+T}function f(v){return"b"+v}function d(v){return"y"+v}function g(v){return"e"+v}function m(v){return"v"+v}B.exports=function(v){function T(w){throw new Error("ndarray-extract-contour: "+w)}typeof v!="object"&&T("Must specify arguments");var _=v.order;Array.isArray(_)||T("Must specify order");var k=v.arrayArguments||1;k<1&&T("Must have at least one array argument");var E=v.scalarArguments||0;E<0&&T("Scalar arg count must be > 0"),typeof v.vertex!="function"&&T("Must specify vertex creation function"),typeof v.cell!="function"&&T("Must specify cell creation function"),typeof v.phase!="function"&&T("Must specify phase function");for(var A=v.getters||[],b=new Array(k),L=0;L<k;++L)A.indexOf(L)>=0?b[L]=!0:b[L]=!1;return function(w,C,S,P,z,F){var q=F.length,W=z.length;if(W<2)throw new Error("ndarray-extract-contour: Dimension must be at least 2");for(var X="extractContour"+z.join("_"),Q=[],Z=[],Y=[],N=0;N<q;++N)Y.push(h(N));for(N=0;N<P;++N)Y.push(a(N));for(N=0;N<W;++N)Z.push(e(N)+"="+h(0)+".shape["+N+"]|0");for(N=0;N<q;++N){Z.push(p(N)+"="+h(N)+".data",o(N)+"="+h(N)+".offset|0");for(var J=0;J<W;++J)Z.push(l(N,J)+"="+h(N)+".stride["+J+"]|0")}for(N=0;N<q;++N)for(Z.push(n(N)+"="+o(N)),Z.push(u(N,0)),J=1;J<1<<W;++J){for(var D=[],U=0;U<W;++U)J&1<<U&&D.push("-"+l(N,U));Z.push(s(N,J)+"=("+D.join("")+")|0"),Z.push(u(N,J)+"=0")}for(N=0;N<q;++N)for(J=0;J<W;++J){var G=[l(N,z[J])];J>0&&G.push(l(N,z[J-1])+"*"+e(z[J-1])),Z.push(c(N,z[J])+"=("+G.join("-")+")|0")}for(N=0;N<W;++N)Z.push(r(N)+"=0");Z.push("N=0");var $=["2"];for(N=W-2;N>=0;--N)$.push(e(z[N]));for(Z.push("Q=("+$.join("*")+")|0","P=mallocUint32(Q)","V=mallocUint32(Q)","X=0"),Z.push(f(0)+"=0"),J=1;J<1<<W;++J){var K=[],re=[];for(U=0;U<W;++U)J&1<<U&&(re.length===0?K.push("1"):K.unshift(re.join("*"))),re.push(e(z[U]));var ne="";K[0].indexOf(e(z[W-2]))<0&&(ne="-");var ae=y(W,J,z);Z.push(g(ae)+"=(-"+K.join("-")+")|0",d(ae)+"=("+ne+K.join("-")+")|0",f(ae)+"=0")}function ie(ce,ve){Q.push("for(",r(z[ce]),"=",ve,";",r(z[ce]),"<",e(z[ce]),";","++",r(z[ce]),"){")}function he(ce){for(var ve=0;ve<q;++ve)Q.push(n(ve),"+=",c(ve,z[ce]),";");Q.push("}")}function se(){for(var ce=1;ce<1<<W;++ce)Q.push("T","=",g(ce),";",g(ce),"=",d(ce),";",d(ce),"=","T",";")}Z.push(m(0)+"=0","T=0"),function ce(ve,Ee){if(ve<0)(function(Te){for(var xe=0;xe<q;++xe)F[xe]?Q.push(u(xe,0),"=",p(xe),".get(",n(xe),");"):Q.push(u(xe,0),"=",p(xe),"[",n(xe),"];");var fe=[];for(xe=0;xe<q;++xe)fe.push(u(xe,0));for(xe=0;xe<P;++xe)fe.push(a(xe));Q.push(f(0),"=","P","[","X","]=phase(",fe.join(),");");for(var ge=1;ge<1<<W;++ge)Q.push(f(ge),"=","P","[","X","+",g(ge),"];");var ke=[];for(ge=1;ge<1<<W;++ge)ke.push("("+f(0)+"!=="+f(ge)+")");Q.push("if(",ke.join("||"),"){");var Me=[];for(xe=0;xe<W;++xe)Me.push(r(xe));for(xe=0;xe<q;++xe)for(Me.push(u(xe,0)),ge=1;ge<1<<W;++ge)F[xe]?Q.push(u(xe,ge),"=",p(xe),".get(",n(xe),"+",s(xe,ge),");"):Q.push(u(xe,ge),"=",p(xe),"[",n(xe),"+",s(xe,ge),"];"),Me.push(u(xe,ge));for(xe=0;xe<1<<W;++xe)Me.push(f(xe));for(xe=0;xe<P;++xe)Me.push(a(xe));Q.push("vertex(",Me.join(),");",m(0),"=","V","[","X","]=","N","++;");var Se=(1<<W)-1,De=f(Se);for(ge=0;ge<W;++ge)if(!(Te&~(1<<ge))){for(var Be=Se^1<<ge,We=f(Be),Qe=[],Oe=Be;Oe>0;Oe=Oe-1&Be)Qe.push("V[X+"+g(Oe)+"]");for(Qe.push(m(0)),Oe=0;Oe<q;++Oe)1&ge?Qe.push(u(Oe,Se),u(Oe,Be)):Qe.push(u(Oe,Be),u(Oe,Se));for(1&ge?Qe.push(De,We):Qe.push(We,De),Oe=0;Oe<P;++Oe)Qe.push(a(Oe));Q.push("if(",De,"!==",We,"){","face(",Qe.join(),")}")}Q.push("}","X","+=1;")})(Ee);else{(function(Te){for(var xe=Te-1;xe>=0;--xe)ie(xe,0);var fe=[];for(xe=0;xe<q;++xe)F[xe]?fe.push(p(xe)+".get("+n(xe)+")"):fe.push(p(xe)+"["+n(xe)+"]");for(xe=0;xe<P;++xe)fe.push(a(xe));for(Q.push("P","[","X","++]=phase(",fe.join(),");"),xe=0;xe<Te;++xe)he(xe);for(var ge=0;ge<q;++ge)Q.push(n(ge),"+=",c(ge,z[Te]),";")})(ve),Q.push("if(",e(z[ve]),">0){",r(z[ve]),"=1;"),ce(ve-1,Ee|1<<z[ve]);for(var Le=0;Le<q;++Le)Q.push(n(Le),"+=",c(Le,z[ve]),";");ve===W-1&&(Q.push("X","=0;"),se()),ie(ve,2),ce(ve-1,Ee),ve===W-1&&(Q.push("if(",r(z[W-1]),"&1){","X","=0;}"),se()),he(ve),Q.push("}")}}(W-1,0),Q.push("freeUint32(","V",");freeUint32(","P",");");var de=["'use strict';","function ",X,"(",Y.join(),"){","var ",Z.join(),";",Q.join(""),"}","return ",X].join("");return new Function("vertex","face","phase","mallocUint32","freeUint32",de)(w,C,S,t.mallocUint32,t.freeUint32)}(v.vertex,v.cell,v.phase,E,_,b)};function y(v,T,_){for(var k=0,E=0;E<v;++E)T&1<<E&&(k|=1<<_[E]);return k}},{"typedarray-pool":617}],476:[function(i,B,V){B.exports=function(n,s,r){if(Array.isArray(r)){if(r.length!==s.dimension)throw new Error("ndarray-gradient: invalid boundary conditions")}else r=t(s.dimension,typeof r=="string"?r:"clamp");if(n.dimension!==s.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(n.shape[s.dimension]!==s.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var c=0;c<s.dimension;++c)if(n.shape[c]!==s.shape[c])throw new Error("ndarray-gradient: shape mismatch");return s.size===0?n:s.dimension<=0?(n.set(0),n):function(f){var d=f.join();if(L=u[d])return L;var g=f.length,m=["function gradient(dst,src){var s=src.shape.slice();"];function y(w){for(var C=g-w.length,S=[],P=[],z=[],F=0;F<g;++F)w.indexOf(F+1)>=0?z.push("0"):w.indexOf(-(F+1))>=0?z.push("s["+F+"]-1"):(z.push("-1"),S.push("1"),P.push("s["+F+"]-2"));var q=".lo("+S.join()+").hi("+P.join()+")";if(S.length===0&&(q=""),C>0){for(m.push("if(1"),F=0;F<g;++F)w.indexOf(F+1)>=0||w.indexOf(-(F+1))>=0||m.push("&&s[",F,"]>2");for(m.push("){grad",C,"(src.pick(",z.join(),")",q),F=0;F<g;++F)w.indexOf(F+1)>=0||w.indexOf(-(F+1))>=0||m.push(",dst.pick(",z.join(),",",F,")",q);m.push(");")}for(F=0;F<w.length;++F){var W=Math.abs(w[F])-1,X="dst.pick("+z.join()+","+W+")"+q;switch(f[W]){case"clamp":var Q=z.slice(),Z=z.slice();w[F]<0?Q[W]="s["+W+"]-2":Z[W]="1",C===0?m.push("if(s[",W,"]>1){dst.set(",z.join(),",",W,",0.5*(src.get(",Q.join(),")-src.get(",Z.join(),")))}else{dst.set(",z.join(),",",W,",0)};"):m.push("if(s[",W,"]>1){diff(",X,",src.pick(",Q.join(),")",q,",src.pick(",Z.join(),")",q,");}else{zero(",X,");};");break;case"mirror":C===0?m.push("dst.set(",z.join(),",",W,",0);"):m.push("zero(",X,");");break;case"wrap":var Y=z.slice(),N=z.slice();w[F]<0?(Y[W]="s["+W+"]-2",N[W]="0"):(Y[W]="s["+W+"]-1",N[W]="1"),C===0?m.push("if(s[",W,"]>2){dst.set(",z.join(),",",W,",0.5*(src.get(",Y.join(),")-src.get(",N.join(),")))}else{dst.set(",z.join(),",",W,",0)};"):m.push("if(s[",W,"]>2){diff(",X,",src.pick(",Y.join(),")",q,",src.pick(",N.join(),")",q,");}else{zero(",X,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}C>0&&m.push("};")}for(var v=0;v<1<<g;++v){for(var T=[],_=0;_<g;++_)v&1<<_&&T.push(_+1);for(var k=0;k<1<<T.length;++k){var E=T.slice();for(_=0;_<T.length;++_)k&1<<_&&(E[_]=-E[_]);y(E)}}m.push("return dst;};return gradient");var A=["diff","zero"],b=[l,o];for(v=1;v<=g;++v)A.push("grad"+v),b.push(a(v));A.push(m.join(""));var L=Function.apply(void 0,A).apply(void 0,b);return p[d]=L,L}(r)(n,s)};var t=i("dup"),h=i("cwise-compiler"),p={},u={},e={body:"",args:[],thisVars:[],localVars:[]},l=h({args:["array","array","array"],pre:e,post:e,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),o=h({args:["array"],pre:e,post:e,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function a(n){if(n in p)return p[n];for(var s=[],r=0;r<n;++r)s.push("out",r,"s=0.5*(inp",r,"l-inp",r,"r);");var c=["array"],f=["junk"];for(r=0;r<n;++r){c.push("array"),f.push("out"+r+"s");var d=t(n);d[r]=-1,c.push({array:0,offset:d.slice()}),d[r]=1,c.push({array:0,offset:d.slice()}),f.push("inp"+r+"l","inp"+r+"r")}return p[n]=h({args:c,pre:e,post:e,body:{body:s.join(""),args:f.map(function(g){return{name:g,lvalue:g.indexOf("out")===0,rvalue:g.indexOf("inp")===0,count:g!=="junk"|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+n})}},{"cwise-compiler":157,dup:185}],477:[function(i,B,V){function t(e,l){var o=Math.floor(l),a=l-o,n=0<=o&&o<e.shape[0],s=0<=o+1&&o+1<e.shape[0];return(1-a)*(n?+e.get(o):0)+a*(s?+e.get(o+1):0)}function h(e,l,o){var a=Math.floor(l),n=l-a,s=0<=a&&a<e.shape[0],r=0<=a+1&&a+1<e.shape[0],c=Math.floor(o),f=o-c,d=0<=c&&c<e.shape[1],g=0<=c+1&&c+1<e.shape[1],m=s&&d?e.get(a,c):0,y=s&&g?e.get(a,c+1):0;return(1-f)*((1-n)*m+n*(r&&d?e.get(a+1,c):0))+f*((1-n)*y+n*(r&&g?e.get(a+1,c+1):0))}function p(e,l,o,a){var n=Math.floor(l),s=l-n,r=0<=n&&n<e.shape[0],c=0<=n+1&&n+1<e.shape[0],f=Math.floor(o),d=o-f,g=0<=f&&f<e.shape[1],m=0<=f+1&&f+1<e.shape[1],y=Math.floor(a),v=a-y,T=0<=y&&y<e.shape[2],_=0<=y+1&&y+1<e.shape[2],k=r&&g&&T?e.get(n,f,y):0,E=r&&m&&T?e.get(n,f+1,y):0,A=c&&g&&T?e.get(n+1,f,y):0,b=c&&m&&T?e.get(n+1,f+1,y):0,L=r&&g&&_?e.get(n,f,y+1):0,w=r&&m&&_?e.get(n,f+1,y+1):0;return(1-v)*((1-d)*((1-s)*k+s*A)+d*((1-s)*E+s*b))+v*((1-d)*((1-s)*L+s*(c&&g&&_?e.get(n+1,f,y+1):0))+d*((1-s)*w+s*(c&&m&&_?e.get(n+1,f+1,y+1):0)))}function u(e){var l,o,a=0|e.shape.length,n=new Array(a),s=new Array(a),r=new Array(a),c=new Array(a);for(l=0;l<a;++l)o=+arguments[l+1],n[l]=Math.floor(o),s[l]=o-n[l],r[l]=0<=n[l]&&n[l]<e.shape[l],c[l]=0<=n[l]+1&&n[l]+1<e.shape[l];var f,d,g,m=0;e:for(l=0;l<1<<a;++l){for(d=1,g=e.offset,f=0;f<a;++f)if(l&1<<f){if(!c[f])continue e;d*=s[f],g+=e.stride[f]*(n[f]+1)}else{if(!r[f])continue e;d*=1-s[f],g+=e.stride[f]*n[f]}m+=d*e.data[g]}return m}B.exports=function(e,l,o,a){switch(e.shape.length){case 0:return 0;case 1:return t(e,l);case 2:return h(e,l,o);case 3:return p(e,l,o,a);default:return u.apply(void 0,arguments)}},B.exports.d1=t,B.exports.d2=h,B.exports.d3=p},{}],478:[function(i,B,V){var t=i("cwise-compiler"),h={body:"",args:[],thisVars:[],localVars:[]};function p(r){if(!r)return h;for(var c=0;c<r.args.length;++c){var f=r.args[c];r.args[c]=c===0?{name:f,lvalue:!0,rvalue:!!r.rvalue,count:r.count||1}:{name:f,lvalue:!1,rvalue:!0,count:1}}return r.thisVars||(r.thisVars=[]),r.localVars||(r.localVars=[]),r}function u(r){for(var c=[],f=0;f<r.args.length;++f)c.push("a"+f);return new Function("P",["return function ",r.funcName,"_ndarrayops(",c.join(","),") {P(",c.join(","),");return a0}"].join(""))(function(d){return t({args:d.args,pre:p(d.pre),body:p(d.body),post:p(d.proc),funcName:d.funcName})}(r))}var e={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var r in e){var c=e[r];V[r]=u({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+c+"c"},funcName:r}),V[r+"eq"]=u({args:["array","array"],body:{args:["a","b"],body:"a"+c+"=b"},rvalue:!0,funcName:r+"eq"}),V[r+"s"]=u({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+c+"s"},funcName:r+"s"}),V[r+"seq"]=u({args:["array","scalar"],body:{args:["a","s"],body:"a"+c+"=s"},rvalue:!0,funcName:r+"seq"})}})();var l={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var r in l){var c=l[r];V[r]=u({args:["array","array"],body:{args:["a","b"],body:"a="+c+"b"},funcName:r}),V[r+"eq"]=u({args:["array"],body:{args:["a"],body:"a="+c+"a"},rvalue:!0,count:2,funcName:r+"eq"})}})();var o={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var r in o){var c=o[r];V[r]=u({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+c+"c"},funcName:r}),V[r+"s"]=u({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+c+"s"},funcName:r+"s"}),V[r+"eq"]=u({args:["array","array"],body:{args:["a","b"],body:"a=a"+c+"b"},rvalue:!0,count:2,funcName:r+"eq"}),V[r+"seq"]=u({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+c+"s"},rvalue:!0,count:2,funcName:r+"seq"})}})();var a=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var r=0;r<a.length;++r){var c=a[r];V[c]=u({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:c}),V[c+"eq"]=u({args:["array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"eq"})}})();var n=["max","min","atan2","pow"];(function(){for(var r=0;r<n.length;++r){var c=n[r];V[c]=u({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:c}),V[c+"s"]=u({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:c+"s"}),V[c+"eq"]=u({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"eq"}),V[c+"seq"]=u({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"seq"})}})();var s=["atan2","pow"];(function(){for(var r=0;r<s.length;++r){var c=s[r];V[c+"op"]=u({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:c+"op"}),V[c+"ops"]=u({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:c+"ops"}),V[c+"opeq"]=u({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"opeq"}),V[c+"opseq"]=u({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"opseq"})}})(),V.any=t({args:["array"],pre:h,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),V.all=t({args:["array"],pre:h,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),V.sum=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),V.prod=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),V.norm2squared=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),V.norm2=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),V.norminf=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),V.norm1=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),V.sup=t({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),V.inf=t({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),V.argmin=t({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),V.argmax=t({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),V.random=u({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),V.assign=u({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),V.assigns=u({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),V.equals=t({args:["array","array"],pre:h,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":157}],479:[function(i,B,V){var t=i("ndarray"),h=i("./doConvert.js");B.exports=function(p,u){for(var e=[],l=p,o=1;Array.isArray(l);)e.push(l.length),o*=l.length,l=l[0];return e.length===0?t():(u||(u=t(new Float64Array(o),e)),h(u,p),u)}},{"./doConvert.js":480,ndarray:483}],480:[function(i,B,V){B.exports=i("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:`{
var _inline_1_v=_inline_1_arg1_,_inline_1_i
for(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {
_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]
}
_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]
}`,args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":157}],481:[function(i,B,V){var t=i("typedarray-pool"),h=32;function p(e){switch(e){case"uint8":return[t.mallocUint8,t.freeUint8];case"uint16":return[t.mallocUint16,t.freeUint16];case"uint32":return[t.mallocUint32,t.freeUint32];case"int8":return[t.mallocInt8,t.freeInt8];case"int16":return[t.mallocInt16,t.freeInt16];case"int32":return[t.mallocInt32,t.freeInt32];case"float32":return[t.mallocFloat,t.freeFloat];case"float64":return[t.mallocDouble,t.freeDouble];default:return null}}function u(e){for(var l=[],o=0;o<e;++o)l.push("s"+o);for(o=0;o<e;++o)l.push("n"+o);for(o=1;o<e;++o)l.push("d"+o);for(o=1;o<e;++o)l.push("e"+o);for(o=1;o<e;++o)l.push("f"+o);return l}B.exports=function(e,l){var o=["'use strict'"],a=["ndarraySortWrapper",e.join("d"),l].join("");o.push(["function ",a,"(",["array"].join(","),"){"].join(""));for(var n=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"],s=0;s<e.length;++s)n.push(["s",s,"=stride[",s,"]|0,n",s,"=shape[",s,"]|0"].join(""));var r=new Array(e.length),c=[];for(s=0;s<e.length;++s)(g=e[s])!==0&&(c.length===0?r[g]="1":r[g]=c.join("*"),c.push("n"+g));var f=-1,d=-1;for(s=0;s<e.length;++s){var g,m=e[s];m!==0&&(f>0?n.push(["d",m,"=s",m,"-d",f,"*n",f].join("")):n.push(["d",m,"=s",m].join("")),f=m),(g=e.length-1-s)!==0&&(d>0?n.push(["e",g,"=s",g,"-e",d,"*n",d,",f",g,"=",r[g],"-f",d,"*n",d].join("")):n.push(["e",g,"=s",g,",f",g,"=",r[g]].join("")),d=g)}o.push("var "+n.join(","));var y=["0","n0-1","data","offset"].concat(u(e.length));o.push(["if(n0<=",h,"){","insertionSort(",y.join(","),")}else{","quickSort(",y.join(","),")}"].join("")),o.push("}return "+a);var v=new Function("insertionSort","quickSort",o.join(`
`)),T=function(k,E){var A=["'use strict'"],b=["ndarrayInsertionSort",k.join("d"),E].join(""),L=["left","right","data","offset"].concat(u(k.length)),w=p(E),C=["i,j,cptr,ptr=left*s0+offset"];if(k.length>1){for(var S=[],P=1;P<k.length;++P)C.push("i"+P),S.push("n"+P);w?C.push("scratch=malloc("+S.join("*")+")"):C.push("scratch=new Array("+S.join("*")+")"),C.push("dptr","sptr","a","b")}else C.push("scratch");function z(W){return E==="generic"?["data.get(",W,")"].join(""):["data[",W,"]"].join("")}function F(W,X){return E==="generic"?["data.set(",W,",",X,")"].join(""):["data[",W,"]=",X].join("")}if(A.push(["function ",b,"(",L.join(","),"){var ",C.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr"),k.length>1){for(A.push("dptr=0;sptr=ptr"),P=k.length-1;P>=0;--P)(q=k[P])!==0&&A.push(["for(i",q,"=0;i",q,"<n",q,";++i",q,"){"].join(""));for(A.push("scratch[dptr++]=",z("sptr")),P=0;P<k.length;++P)(q=k[P])!==0&&A.push("sptr+=d"+q,"}");for(A.push("__g:while(j-->left){","dptr=0","sptr=cptr-s0"),P=1;P<k.length;++P)P===1&&A.push("__l:"),A.push(["for(i",P,"=0;i",P,"<n",P,";++i",P,"){"].join(""));for(A.push(["a=",z("sptr"),`
b=scratch[dptr]
if(a<b){break __g}
if(a>b){break __l}`].join("")),P=k.length-1;P>=1;--P)A.push("sptr+=e"+P,"dptr+=f"+P,"}");for(A.push("dptr=cptr;sptr=cptr-s0"),P=k.length-1;P>=0;--P)(q=k[P])!==0&&A.push(["for(i",q,"=0;i",q,"<n",q,";++i",q,"){"].join(""));for(A.push(F("dptr",z("sptr"))),P=0;P<k.length;++P)(q=k[P])!==0&&A.push(["dptr+=d",q,";sptr+=d",q].join(""),"}");for(A.push(`cptr-=s0
}`),A.push("dptr=cptr;sptr=0"),P=k.length-1;P>=0;--P)(q=k[P])!==0&&A.push(["for(i",q,"=0;i",q,"<n",q,";++i",q,"){"].join(""));for(A.push(F("dptr","scratch[sptr++]")),P=0;P<k.length;++P){var q;(q=k[P])!==0&&A.push("dptr+=d"+q,"}")}}else A.push("scratch="+z("ptr"),"while((j-->left)&&("+z("cptr-s0")+">scratch)){",F("cptr",z("cptr-s0")),"cptr-=s0","}",F("cptr","scratch"));return A.push("}"),k.length>1&&w&&A.push("free(scratch)"),A.push("} return "+b),w?new Function("malloc","free",A.join(`
`))(w[0],w[1]):new Function(A.join(`
`))()}(e,l),_=function(k,E,A){var b=["'use strict'"],L=["ndarrayQuickSort",k.join("d"),E].join(""),w=["left","right","data","offset"].concat(u(k.length)),C=p(E),S=0;b.push(["function ",L,"(",w.join(","),"){"].join(""));var P=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(k.length>1){for(var z=[],F=1;F<k.length;++F)z.push("n"+F),P.push("i"+F);for(F=0;F<8;++F)P.push("b_ptr"+F);P.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+z.join("*")),C?P.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)"):P.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}else P.push("pivot1","pivot2");function q(ae){return["(offset+",ae,"*s0)"].join("")}function W(ae){return E==="generic"?["data.get(",ae,")"].join(""):["data[",ae,"]"].join("")}function X(ae,ie){return E==="generic"?["data.set(",ae,",",ie,")"].join(""):["data[",ae,"]=",ie].join("")}function Q(ae,ie,he){if(ae.length===1)b.push("ptr0="+q(ae[0]));else for(var se=0;se<ae.length;++se)b.push(["b_ptr",se,"=s0*",ae[se]].join(""));for(ie&&b.push("pivot_ptr=0"),b.push("ptr_shift=offset"),se=k.length-1;se>=0;--se)(de=k[se])!==0&&b.push(["for(i",de,"=0;i",de,"<n",de,";++i",de,"){"].join(""));if(ae.length>1)for(se=0;se<ae.length;++se)b.push(["ptr",se,"=b_ptr",se,"+ptr_shift"].join(""));for(b.push(he),ie&&b.push("++pivot_ptr"),se=0;se<k.length;++se){var de;(de=k[se])!==0&&(ae.length>1?b.push("ptr_shift+=d"+de):b.push("ptr0+=d"+de),b.push("}"))}}function Z(ae,ie,he,se){if(ie.length===1)b.push("ptr0="+q(ie[0]));else{for(var de=0;de<ie.length;++de)b.push(["b_ptr",de,"=s0*",ie[de]].join(""));b.push("ptr_shift=offset")}for(he&&b.push("pivot_ptr=0"),ae&&b.push(ae+":"),de=1;de<k.length;++de)b.push(["for(i",de,"=0;i",de,"<n",de,";++i",de,"){"].join(""));if(ie.length>1)for(de=0;de<ie.length;++de)b.push(["ptr",de,"=b_ptr",de,"+ptr_shift"].join(""));for(b.push(se),de=k.length-1;de>=1;--de)he&&b.push("pivot_ptr+=f"+de),ie.length>1?b.push("ptr_shift+=e"+de):b.push("ptr0+=e"+de),b.push("}")}function Y(){k.length>1&&C&&b.push("free(pivot1)","free(pivot2)")}function N(ae,ie){var he="el"+ae,se="el"+ie;if(k.length>1){var de="__l"+ ++S;Z(de,[he,se],!1,["comp=",W("ptr0"),"-",W("ptr1"),`
`,"if(comp>0){tmp0=",he,";",he,"=",se,";",se,"=tmp0;break ",de,`}
`,"if(comp<0){break ",de,"}"].join(""))}else b.push(["if(",W(q(he)),">",W(q(se)),"){tmp0=",he,";",he,"=",se,";",se,"=tmp0}"].join(""))}function J(ae,ie){k.length>1?Q([ae,ie],!1,X("ptr0",W("ptr1"))):b.push(X(q(ae),W(q(ie))))}function D(ae,ie,he){if(k.length>1){var se="__l"+ ++S;Z(se,[ie],!0,[ae,"=",W("ptr0"),"-pivot",he,`[pivot_ptr]
`,"if(",ae,"!==0){break ",se,"}"].join(""))}else b.push([ae,"=",W(q(ie)),"-pivot",he].join(""))}function U(ae,ie){k.length>1?Q([ae,ie],!1,["tmp=",W("ptr0"),`
`,X("ptr0",W("ptr1")),`
`,X("ptr1","tmp")].join("")):b.push(["ptr0=",q(ae),`
`,"ptr1=",q(ie),`
`,"tmp=",W("ptr0"),`
`,X("ptr0",W("ptr1")),`
`,X("ptr1","tmp")].join(""))}function G(ae,ie,he){k.length>1?(Q([ae,ie,he],!1,["tmp=",W("ptr0"),`
`,X("ptr0",W("ptr1")),`
`,X("ptr1",W("ptr2")),`
`,X("ptr2","tmp")].join("")),b.push("++"+ie,"--"+he)):b.push(["ptr0=",q(ae),`
`,"ptr1=",q(ie),`
`,"ptr2=",q(he),`
`,"++",ie,`
`,"--",he,`
`,"tmp=",W("ptr0"),`
`,X("ptr0",W("ptr1")),`
`,X("ptr1",W("ptr2")),`
`,X("ptr2","tmp")].join(""))}function $(ae,ie){U(ae,ie),b.push("--"+ie)}function K(ae,ie,he){k.length>1?Q([ae,ie],!0,[X("ptr0",W("ptr1")),`
`,X("ptr1",["pivot",he,"[pivot_ptr]"].join(""))].join("")):b.push(X(q(ae),W(q(ie))),X(q(ie),"pivot"+he))}function re(ae,ie){b.push(["if((",ie,"-",ae,")<=",h,`){
`,"insertionSort(",ae,",",ie,",data,offset,",u(k.length).join(","),`)
`,`}else{
`,L,"(",ae,",",ie,",data,offset,",u(k.length).join(","),`)
`,"}"].join(""))}function ne(ae,ie,he){k.length>1?(b.push(["__l",++S,":while(true){"].join("")),Q([ae],!0,["if(",W("ptr0"),"!==pivot",ie,"[pivot_ptr]){break __l",S,"}"].join("")),b.push(he,"}")):b.push(["while(",W(q(ae)),"===pivot",ie,"){",he,"}"].join(""))}return b.push("var "+P.join(",")),N(1,2),N(4,5),N(1,3),N(2,3),N(1,4),N(3,4),N(2,5),N(2,3),N(4,5),k.length>1?Q(["el1","el2","el3","el4","el5","index1","index3","index5"],!0,["pivot1[pivot_ptr]=",W("ptr1"),`
`,"pivot2[pivot_ptr]=",W("ptr3"),`
`,`pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])
`,"x=",W("ptr0"),`
`,"y=",W("ptr2"),`
`,"z=",W("ptr4"),`
`,X("ptr5","x"),`
`,X("ptr6","y"),`
`,X("ptr7","z")].join("")):b.push(["pivot1=",W(q("el2")),`
`,"pivot2=",W(q("el4")),`
`,`pivots_are_equal=pivot1===pivot2
`,"x=",W(q("el1")),`
`,"y=",W(q("el3")),`
`,"z=",W(q("el5")),`
`,X(q("index1"),"x"),`
`,X(q("index3"),"y"),`
`,X(q("index5"),"z")].join("")),J("index2","left"),J("index4","right"),b.push("if(pivots_are_equal){"),b.push("for(k=less;k<=great;++k){"),D("comp","k",1),b.push("if(comp===0){continue}"),b.push("if(comp<0){"),b.push("if(k!==less){"),U("k","less"),b.push("}"),b.push("++less"),b.push("}else{"),b.push("while(true){"),D("comp","great",1),b.push("if(comp>0){"),b.push("great--"),b.push("}else if(comp<0){"),G("k","less","great"),b.push("break"),b.push("}else{"),$("k","great"),b.push("break"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),b.push("}else{"),b.push("for(k=less;k<=great;++k){"),D("comp_pivot1","k",1),b.push("if(comp_pivot1<0){"),b.push("if(k!==less){"),U("k","less"),b.push("}"),b.push("++less"),b.push("}else{"),D("comp_pivot2","k",2),b.push("if(comp_pivot2>0){"),b.push("while(true){"),D("comp","great",2),b.push("if(comp>0){"),b.push("if(--great<k){break}"),b.push("continue"),b.push("}else{"),D("comp","great",1),b.push("if(comp<0){"),G("k","less","great"),b.push("}else{"),$("k","great"),b.push("}"),b.push("break"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),K("left","(less-1)",1),K("right","(great+1)",2),re("left","(less-2)"),re("(great+2)","right"),b.push("if(pivots_are_equal){"),Y(),b.push("return"),b.push("}"),b.push("if(less<index1&&great>index5){"),ne("less",1,"++less"),ne("great",2,"--great"),b.push("for(k=less;k<=great;++k){"),D("comp_pivot1","k",1),b.push("if(comp_pivot1===0){"),b.push("if(k!==less){"),U("k","less"),b.push("}"),b.push("++less"),b.push("}else{"),D("comp_pivot2","k",2),b.push("if(comp_pivot2===0){"),b.push("while(true){"),D("comp","great",2),b.push("if(comp===0){"),b.push("if(--great<k){break}"),b.push("continue"),b.push("}else{"),D("comp","great",1),b.push("if(comp<0){"),G("k","less","great"),b.push("}else{"),$("k","great"),b.push("}"),b.push("break"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),Y(),re("less","great"),b.push("}return "+L),k.length>1&&C?new Function("insertionSort","malloc","free",b.join(`
`))(A,C[0],C[1]):new Function("insertionSort",b.join(`
`))(A)}(e,l,T);return v(T,_)}},{"typedarray-pool":617}],482:[function(i,B,V){var t=i("./lib/compile_sort.js"),h={};B.exports=function(p){var u=p.order,e=p.dtype,l=[u,e].join(":"),o=h[l];return o||(h[l]=o=t(u,e)),o(p),p}},{"./lib/compile_sort.js":481}],483:[function(i,B,V){var t=i("iota-array"),h=i("is-buffer"),p=typeof Float64Array<"u";function u(a,n){return a[0]-n[0]}function e(){var a,n=this.stride,s=new Array(n.length);for(a=0;a<s.length;++a)s[a]=[Math.abs(n[a]),a];s.sort(u);var r=new Array(s.length);for(a=0;a<r.length;++a)r[a]=s[a][1];return r}function l(a,n){var s=["View",n,"d",a].join("");n<0&&(s="View_Nil"+a);var r=a==="generic";if(n===-1){var c="function "+s+"(a){this.data=a;};var proto="+s+".prototype;proto.dtype='"+a+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+s+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+s+"(a){return new "+s+"(a);}";return new Function(c)()}if(n===0)return c="function "+s+"(a,d) {this.data = a;this.offset = d};var proto="+s+".prototype;proto.dtype='"+a+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+s+"_copy() {return new "+s+"(this.data,this.offset)};proto.pick=function "+s+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+s+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+s+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+s+"(a,b,c,d){return new "+s+"(a,d)}",new Function("TrivialArray",c)(o[a][0]);c=["'use strict'"];var f=t(n),d=f.map(function(A){return"i"+A}),g="this.offset+"+f.map(function(A){return"this.stride["+A+"]*i"+A}).join("+"),m=f.map(function(A){return"b"+A}).join(","),y=f.map(function(A){return"c"+A}).join(",");c.push("function "+s+"(a,"+m+","+y+",d){this.data=a","this.shape=["+m+"]","this.stride=["+y+"]","this.offset=d|0}","var proto="+s+".prototype","proto.dtype='"+a+"'","proto.dimension="+n),c.push("Object.defineProperty(proto,'size',{get:function "+s+"_size(){return "+f.map(function(A){return"this.shape["+A+"]"}).join("*"),"}})"),n===1?c.push("proto.order=[0]"):(c.push("Object.defineProperty(proto,'order',{get:"),n<4?(c.push("function "+s+"_order(){"),n===2?c.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):n===3&&c.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):c.push("ORDER})")),c.push("proto.set=function "+s+"_set("+d.join(",")+",v){"),r?c.push("return this.data.set("+g+",v)}"):c.push("return this.data["+g+"]=v}"),c.push("proto.get=function "+s+"_get("+d.join(",")+"){"),r?c.push("return this.data.get("+g+")}"):c.push("return this.data["+g+"]}"),c.push("proto.index=function "+s+"_index(",d.join(),"){return "+g+"}"),c.push("proto.hi=function "+s+"_hi("+d.join(",")+"){return new "+s+"(this.data,"+f.map(function(A){return["(typeof i",A,"!=='number'||i",A,"<0)?this.shape[",A,"]:i",A,"|0"].join("")}).join(",")+","+f.map(function(A){return"this.stride["+A+"]"}).join(",")+",this.offset)}");var v=f.map(function(A){return"a"+A+"=this.shape["+A+"]"}),T=f.map(function(A){return"c"+A+"=this.stride["+A+"]"});c.push("proto.lo=function "+s+"_lo("+d.join(",")+"){var b=this.offset,d=0,"+v.join(",")+","+T.join(","));for(var _=0;_<n;++_)c.push("if(typeof i"+_+"==='number'&&i"+_+">=0){d=i"+_+"|0;b+=c"+_+"*d;a"+_+"-=d}");for(c.push("return new "+s+"(this.data,"+f.map(function(A){return"a"+A}).join(",")+","+f.map(function(A){return"c"+A}).join(",")+",b)}"),c.push("proto.step=function "+s+"_step("+d.join(",")+"){var "+f.map(function(A){return"a"+A+"=this.shape["+A+"]"}).join(",")+","+f.map(function(A){return"b"+A+"=this.stride["+A+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),_=0;_<n;++_)c.push("if(typeof i"+_+"==='number'){d=i"+_+"|0;if(d<0){c+=b"+_+"*(a"+_+"-1);a"+_+"=ceil(-a"+_+"/d)}else{a"+_+"=ceil(a"+_+"/d)}b"+_+"*=d}");c.push("return new "+s+"(this.data,"+f.map(function(A){return"a"+A}).join(",")+","+f.map(function(A){return"b"+A}).join(",")+",c)}");var k=new Array(n),E=new Array(n);for(_=0;_<n;++_)k[_]="a[i"+_+"]",E[_]="b[i"+_+"]";for(c.push("proto.transpose=function "+s+"_transpose("+d+"){"+d.map(function(A,b){return A+"=("+A+"===undefined?"+b+":"+A+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+s+"(this.data,"+k.join(",")+","+E.join(",")+",this.offset)}"),c.push("proto.pick=function "+s+"_pick("+d+"){var a=[],b=[],c=this.offset"),_=0;_<n;++_)c.push("if(typeof i"+_+"==='number'&&i"+_+">=0){c=(c+this.stride["+_+"]*i"+_+")|0}else{a.push(this.shape["+_+"]);b.push(this.stride["+_+"])}");return c.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),c.push("return function construct_"+s+"(data,shape,stride,offset){return new "+s+"(data,"+f.map(function(A){return"shape["+A+"]"}).join(",")+","+f.map(function(A){return"stride["+A+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",c.join(`
`))(o[a],e)}var o={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};B.exports=function(a,n,s,r){if(a===void 0)return(0,o.array[0])([]);typeof a=="number"&&(a=[a]),n===void 0&&(n=[a.length]);var c=n.length;if(s===void 0){s=new Array(c);for(var f=c-1,d=1;f>=0;--f)s[f]=d,d*=n[f]}if(r===void 0)for(r=0,f=0;f<c;++f)s[f]<0&&(r-=(n[f]-1)*s[f]);for(var g=function(y){if(h(y))return"buffer";if(p)switch(Object.prototype.toString.call(y)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(y)?"array":"generic"}(a),m=o[g];m.length<=c+1;)m.push(l(g,m.length-1));return(0,m[c+1])(a,n,s,r)}},{"iota-array":451,"is-buffer":453}],484:[function(i,B,V){var t=i("double-bits"),h=Math.pow(2,-1074);B.exports=function(p,u){if(isNaN(p)||isNaN(u))return NaN;if(p===u)return p;if(p===0)return u<0?-h:h;var e=t.hi(p),l=t.lo(p);return u>p==p>0?l===-1>>>0?(e+=1,l=0):l+=1:l===0?(l=-1>>>0,e-=1):l-=1,t.pack(l,e)}},{"double-bits":182}],485:[function(i,B,V){var t=Math.PI,h=o(120);function p(a,n,s,r){return["C",a,n,s,r,s,r]}function u(a,n,s,r,c,f){return["C",a/3+2/3*s,n/3+2/3*r,c/3+2/3*s,f/3+2/3*r,c,f]}function e(a,n,s,r,c,f,d,g,m,y){if(y)C=y[0],S=y[1],L=y[2],w=y[3];else{var v=l(a,n,-c);a=v.x,n=v.y;var T=(a-(g=(v=l(g,m,-c)).x))/2,_=(n-(m=v.y))/2,k=T*T/(s*s)+_*_/(r*r);k>1&&(s*=k=Math.sqrt(k),r*=k);var E=s*s,A=r*r,b=(f==d?-1:1)*Math.sqrt(Math.abs((E*A-E*_*_-A*T*T)/(E*_*_+A*T*T)));b==1/0&&(b=1);var L=b*s*_/r+(a+g)/2,w=b*-r*T/s+(n+m)/2,C=Math.asin(((n-w)/r).toFixed(9)),S=Math.asin(((m-w)/r).toFixed(9));(C=a<L?t-C:C)<0&&(C=2*t+C),(S=g<L?t-S:S)<0&&(S=2*t+S),d&&C>S&&(C-=2*t),!d&&S>C&&(S-=2*t)}if(Math.abs(S-C)>h){var P=S,z=g,F=m;S=C+h*(d&&S>C?1:-1);var q=e(g=L+s*Math.cos(S),m=w+r*Math.sin(S),s,r,c,0,d,z,F,[S,P,L,w])}var W=Math.tan((S-C)/4),X=4/3*s*W,Q=4/3*r*W,Z=[2*a-(a+X*Math.sin(C)),2*n-(n-Q*Math.cos(C)),g+X*Math.sin(S),m-Q*Math.cos(S),g,m];if(y)return Z;q&&(Z=Z.concat(q));for(var Y=0;Y<Z.length;){var N=l(Z[Y],Z[Y+1],c);Z[Y++]=N.x,Z[Y++]=N.y}return Z}function l(a,n,s){return{x:a*Math.cos(s)-n*Math.sin(s),y:a*Math.sin(s)+n*Math.cos(s)}}function o(a){return a*(t/180)}B.exports=function(a){for(var n,s=[],r=0,c=0,f=0,d=0,g=null,m=null,y=0,v=0,T=0,_=a.length;T<_;T++){var k=a[T],E=k[0];switch(E){case"M":f=k[1],d=k[2];break;case"A":(k=e(y,v,k[1],k[2],o(k[3]),k[4],k[5],k[6],k[7])).unshift("C"),k.length>7&&(s.push(k.splice(0,7)),k.unshift("C"));break;case"S":var A=y,b=v;n!="C"&&n!="S"||(A+=A-r,b+=b-c),k=["C",A,b,k[1],k[2],k[3],k[4]];break;case"T":n=="Q"||n=="T"?(g=2*y-g,m=2*v-m):(g=y,m=v),k=u(y,v,g,m,k[1],k[2]);break;case"Q":g=k[1],m=k[2],k=u(y,v,k[1],k[2],k[3],k[4]);break;case"L":k=p(y,v,k[1],k[2]);break;case"H":k=p(y,v,k[1],v);break;case"V":k=p(y,v,y,k[1]);break;case"Z":k=p(y,v,f,d)}n=E,y=k[k.length-2],v=k[k.length-1],k.length>4?(r=k[k.length-4],c=k[k.length-3]):(r=y,c=v),s.push(k)}return s}},{}],486:[function(i,B,V){V.vertexNormals=function(t,h,p){for(var u=h.length,e=new Array(u),l=p===void 0?1e-6:p,o=0;o<u;++o)e[o]=[0,0,0];for(o=0;o<t.length;++o)for(var a=t[o],n=0,s=a[a.length-1],r=a[0],c=0;c<a.length;++c){n=s,s=r,r=a[(c+1)%a.length];for(var f=h[n],d=h[s],g=h[r],m=new Array(3),y=0,v=new Array(3),T=0,_=0;_<3;++_)m[_]=f[_]-d[_],y+=m[_]*m[_],v[_]=g[_]-d[_],T+=v[_]*v[_];if(y*T>l){var k=e[s],E=1/Math.sqrt(y*T);for(_=0;_<3;++_){var A=(_+1)%3,b=(_+2)%3;k[_]+=E*(v[A]*m[b]-v[b]*m[A])}}}for(o=0;o<u;++o){k=e[o];var L=0;for(_=0;_<3;++_)L+=k[_]*k[_];if(L>l)for(E=1/Math.sqrt(L),_=0;_<3;++_)k[_]*=E;else for(_=0;_<3;++_)k[_]=0}return e},V.faceNormals=function(t,h,p){for(var u=t.length,e=new Array(u),l=p===void 0?1e-6:p,o=0;o<u;++o){for(var a=t[o],n=new Array(3),s=0;s<3;++s)n[s]=h[a[s]];var r=new Array(3),c=new Array(3);for(s=0;s<3;++s)r[s]=n[1][s]-n[0][s],c[s]=n[2][s]-n[0][s];var f=new Array(3),d=0;for(s=0;s<3;++s){var g=(s+1)%3,m=(s+2)%3;f[s]=r[g]*c[m]-r[m]*c[g],d+=f[s]*f[s]}for(d=d>l?1/Math.sqrt(d):0,s=0;s<3;++s)f[s]*=d;e[o]=f}return e}},{}],487:[function(i,B,V){var t=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;function u(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}B.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var l={},o=0;o<10;o++)l["_"+String.fromCharCode(o)]=o;if(Object.getOwnPropertyNames(l).map(function(n){return l[n]}).join("")!=="0123456789")return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(n){a[n]=n}),Object.keys(Object.assign({},a)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(e,l){for(var o,a,n=u(e),s=1;s<arguments.length;s++){for(var r in o=Object(arguments[s]))h.call(o,r)&&(n[r]=o[r]);if(t){a=t(o);for(var c=0;c<a.length;c++)p.call(o,a[c])&&(n[a[c]]=o[a[c]])}}return n}},{}],488:[function(i,B,V){B.exports=function(t,h,p,u,e,l,o,a,n,s){var r=h+l+s;if(c>0){var c=Math.sqrt(r+1);t[0]=.5*(o-n)/c,t[1]=.5*(a-u)/c,t[2]=.5*(p-l)/c,t[3]=.5*c}else{var f=Math.max(h,l,s);c=Math.sqrt(2*f-r+1),h>=f?(t[0]=.5*c,t[1]=.5*(e+p)/c,t[2]=.5*(a+u)/c,t[3]=.5*(o-n)/c):l>=f?(t[0]=.5*(p+e)/c,t[1]=.5*c,t[2]=.5*(n+o)/c,t[3]=.5*(a-u)/c):(t[0]=.5*(u+a)/c,t[1]=.5*(o+n)/c,t[2]=.5*c,t[3]=.5*(p-e)/c)}return t}},{}],489:[function(i,B,V){B.exports=function(r){var c=(r=r||{}).center||[0,0,0],f=r.rotation||[0,0,0,1],d=r.radius||1;c=[].slice.call(c,0,3),a(f=[].slice.call(f,0,4),f);var g=new n(f,c,Math.log(d));return g.setDistanceLimits(r.zoomMin,r.zoomMax),("eye"in r||"up"in r)&&g.lookAt(0,r.eye,r.center,r.up),g};var t=i("filtered-vector"),h=i("gl-mat4/lookAt"),p=i("gl-mat4/fromQuat"),u=i("gl-mat4/invert"),e=i("./lib/quatFromFrame");function l(r,c,f){return Math.sqrt(Math.pow(r,2)+Math.pow(c,2)+Math.pow(f,2))}function o(r,c,f,d){return Math.sqrt(Math.pow(r,2)+Math.pow(c,2)+Math.pow(f,2)+Math.pow(d,2))}function a(r,c){var f=c[0],d=c[1],g=c[2],m=c[3],y=o(f,d,g,m);y>1e-6?(r[0]=f/y,r[1]=d/y,r[2]=g/y,r[3]=m/y):(r[0]=r[1]=r[2]=0,r[3]=1)}function n(r,c,f){this.radius=t([f]),this.center=t(c),this.rotation=t(r),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var s=n.prototype;s.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},s.recalcMatrix=function(r){this.radius.curve(r),this.center.curve(r),this.rotation.curve(r);var c=this.computedRotation;a(c,c);var f=this.computedMatrix;p(f,c);var d=this.computedCenter,g=this.computedEye,m=this.computedUp,y=Math.exp(this.computedRadius[0]);g[0]=d[0]+y*f[2],g[1]=d[1]+y*f[6],g[2]=d[2]+y*f[10],m[0]=f[1],m[1]=f[5],m[2]=f[9];for(var v=0;v<3;++v){for(var T=0,_=0;_<3;++_)T+=f[v+4*_]*g[_];f[12+v]=-T}},s.getMatrix=function(r,c){this.recalcMatrix(r);var f=this.computedMatrix;if(c){for(var d=0;d<16;++d)c[d]=f[d];return c}return f},s.idle=function(r){this.center.idle(r),this.radius.idle(r),this.rotation.idle(r)},s.flush=function(r){this.center.flush(r),this.radius.flush(r),this.rotation.flush(r)},s.pan=function(r,c,f,d){c=c||0,f=f||0,d=d||0,this.recalcMatrix(r);var g=this.computedMatrix,m=g[1],y=g[5],v=g[9],T=l(m,y,v);m/=T,y/=T,v/=T;var _=g[0],k=g[4],E=g[8],A=_*m+k*y+E*v,b=l(_-=m*A,k-=y*A,E-=v*A);_/=b,k/=b,E/=b,g[2],g[6],g[10];var L=_*c+m*f,w=k*c+y*f,C=E*c+v*f;this.center.move(r,L,w,C);var S=Math.exp(this.computedRadius[0]);S=Math.max(1e-4,S+d),this.radius.set(r,Math.log(S))},s.rotate=function(r,c,f,d){this.recalcMatrix(r),c=c||0,f=f||0;var g=this.computedMatrix,m=g[0],y=g[4],v=g[8],T=g[1],_=g[5],k=g[9],E=g[2],A=g[6],b=g[10],L=c*m+f*T,w=c*y+f*_,C=c*v+f*k,S=-(A*C-b*w),P=-(b*L-E*C),z=-(E*w-A*L),F=Math.sqrt(Math.max(0,1-Math.pow(S,2)-Math.pow(P,2)-Math.pow(z,2))),q=o(S,P,z,F);q>1e-6?(S/=q,P/=q,z/=q,F/=q):(S=P=z=0,F=1);var W=this.computedRotation,X=W[0],Q=W[1],Z=W[2],Y=W[3],N=X*F+Y*S+Q*z-Z*P,J=Q*F+Y*P+Z*S-X*z,D=Z*F+Y*z+X*P-Q*S,U=Y*F-X*S-Q*P-Z*z;if(d){S=E,P=A,z=b;var G=Math.sin(d)/l(S,P,z);S*=G,P*=G,z*=G,U=U*(F=Math.cos(c))-(N=N*F+U*S+J*z-D*P)*S-(J=J*F+U*P+D*S-N*z)*P-(D=D*F+U*z+N*P-J*S)*z}var $=o(N,J,D,U);$>1e-6?(N/=$,J/=$,D/=$,U/=$):(N=J=D=0,U=1),this.rotation.set(r,N,J,D,U)},s.lookAt=function(r,c,f,d){this.recalcMatrix(r),f=f||this.computedCenter,c=c||this.computedEye,d=d||this.computedUp;var g=this.computedMatrix;h(g,c,f,d);var m=this.computedRotation;e(m,g[0],g[1],g[2],g[4],g[5],g[6],g[8],g[9],g[10]),a(m,m),this.rotation.set(r,m[0],m[1],m[2],m[3]);for(var y=0,v=0;v<3;++v)y+=Math.pow(f[v]-c[v],2);this.radius.set(r,.5*Math.log(Math.max(y,1e-6))),this.center.set(r,f[0],f[1],f[2])},s.translate=function(r,c,f,d){this.center.move(r,c||0,f||0,d||0)},s.setMatrix=function(r,c){var f=this.computedRotation;e(f,c[0],c[1],c[2],c[4],c[5],c[6],c[8],c[9],c[10]),a(f,f),this.rotation.set(r,f[0],f[1],f[2],f[3]);var d=this.computedMatrix;u(d,c);var g=d[15];if(Math.abs(g)>1e-6){var m=d[12]/g,y=d[13]/g,v=d[14]/g;this.recalcMatrix(r);var T=Math.exp(this.computedRadius[0]);this.center.set(r,m-d[2]*T,y-d[6]*T,v-d[10]*T),this.radius.idle(r)}else this.center.idle(r),this.radius.idle(r)},s.setDistance=function(r,c){c>0&&this.radius.set(r,Math.log(c))},s.setDistanceLimits=function(r,c){r=r>0?Math.log(r):-1/0,c=c>0?Math.log(c):1/0,c=Math.max(c,r),this.radius.bounds[0][0]=r,this.radius.bounds[1][0]=c},s.getDistanceLimits=function(r){var c=this.radius.bounds;return r?(r[0]=Math.exp(c[0][0]),r[1]=Math.exp(c[1][0]),r):[Math.exp(c[0][0]),Math.exp(c[1][0])]},s.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},s.fromJSON=function(r){var c=this.lastT(),f=r.center;f&&this.center.set(c,f[0],f[1],f[2]);var d=r.rotation;d&&this.rotation.set(c,d[0],d[1],d[2],d[3]);var g=r.distance;g&&g>0&&this.radius.set(c,Math.log(g)),this.setDistanceLimits(r.zoomMin,r.zoomMax)}},{"./lib/quatFromFrame":488,"filtered-vector":250,"gl-mat4/fromQuat":288,"gl-mat4/invert":299,"gl-mat4/lookAt":300}],490:[function(i,B,V){var t=i("repeat-string");B.exports=function(h,p,u){return t(u=u!==void 0?u+"":" ",p)+h}},{"repeat-string":541}],491:[function(i,B,V){function t(u,e){if(typeof u!="string")return[u];var l=[u];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var o=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],a=e.escape||"___",n=!!e.flat;o.forEach(function(r){var c=new RegExp(["\\",r[0],"[^\\",r[0],"\\",r[1],"]*\\",r[1]].join("")),f=[];function d(g,m,y){var v=l.push(g.slice(r[0].length,-r[1].length))-1;return f.push(v),a+v+a}l.forEach(function(g,m){for(var y,v=0;g!=y;)if(y=g,g=g.replace(c,d),v++>1e4)throw Error("References have circular dependency. Please, check them.");l[m]=g}),f=f.reverse(),l=l.map(function(g){return f.forEach(function(m){g=g.replace(new RegExp("(\\"+a+m+"\\"+a+")","g"),r[0]+"$1"+r[1])}),g})});var s=new RegExp("\\"+a+"([0-9]+)\\"+a);return n?l:function r(c,f,d){for(var g,m=[],y=0;g=s.exec(c);){if(y++>1e4)throw Error("Circular references in parenthesis");m.push(c.slice(0,g.index)),m.push(r(f[g[1]],f)),c=c.slice(g.index+g[0].length)}return m.push(c),m}(l[0],l)}function h(u,e){if(e&&e.flat){var l,o=e&&e.escape||"___",a=u[0];if(!a)return"";for(var n=new RegExp("\\"+o+"([0-9]+)\\"+o),s=0;a!=l;){if(s++>1e4)throw Error("Circular references in "+u);l=a,a=a.replace(n,r)}return a}return u.reduce(function c(f,d){return Array.isArray(d)&&(d=d.reduce(c,"")),f+d},"");function r(c,f){if(u[f]==null)throw Error("Reference "+f+"is undefined");return u[f]}}function p(u,e){return Array.isArray(u)?h(u,e):t(u,e)}p.parse=t,p.stringify=h,B.exports=p},{}],492:[function(i,B,V){var t=i("pick-by-alias");B.exports=function(h){var p;return arguments.length>1&&(h=arguments),typeof h=="string"?h=h.split(/\s/).map(parseFloat):typeof h=="number"&&(h=[h]),h.length&&typeof h[0]=="number"?p=h.length===1?{width:h[0],height:h[0],x:0,y:0}:h.length===2?{width:h[0],height:h[1],x:0,y:0}:{x:h[0],y:h[1],width:h[2]-h[0]||0,height:h[3]-h[1]||0}:h&&(h=t(h,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),p={x:h.left||0,y:h.top||0},h.width==null?h.right?p.width=h.right-p.x:p.width=0:p.width=h.width,h.height==null?h.bottom?p.height=h.bottom-p.y:p.height=0:p.height=h.height),p}},{"pick-by-alias":498}],493:[function(i,B,V){B.exports=function(u){var e=[];return u.replace(h,function(l,o,a){var n=o.toLowerCase();for(a=function(s){var r=s.match(p);return r?r.map(Number):[]}(a),n=="m"&&a.length>2&&(e.push([o].concat(a.splice(0,2))),n="l",o=o=="m"?"l":"L");;){if(a.length==t[n])return a.unshift(o),e.push(a);if(a.length<t[n])throw new Error("malformed path data");e.push([o].concat(a.splice(0,t[n])))}}),e};var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},h=/([astvzqmhlc])([^astvzqmhlc]*)/gi,p=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],494:[function(i,B,V){B.exports=function(t,h){h||(h=[0,""]),t=String(t);var p=parseFloat(t,10);return h[0]=p,h[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"",h}},{}],495:[function(i,B,V){(function(t){(function(){(function(){var h,p,u,e,l,o;typeof performance<"u"&&performance!==null&&performance.now?B.exports=function(){return performance.now()}:t!=null&&t.hrtime?(B.exports=function(){return(h()-l)/1e6},p=t.hrtime,e=(h=function(){var a;return 1e9*(a=p())[0]+a[1]})(),o=1e9*t.uptime(),l=e-o):Date.now?(B.exports=function(){return Date.now()-u},u=Date.now()):(B.exports=function(){return new Date().getTime()-u},u=new Date().getTime())}).call(this)}).call(this)}).call(this,i("_process"))},{_process:528}],496:[function(i,B,V){B.exports=function(h){var p=h.length;if(p<32){for(var u=1,e=0;e<p;++e)for(var l=0;l<e;++l)if(h[e]<h[l])u=-u;else if(h[e]===h[l])return 0;return u}var o=t.mallocUint8(p);for(e=0;e<p;++e)o[e]=0;for(u=1,e=0;e<p;++e)if(!o[e]){var a=1;for(o[e]=1,l=h[e];l!==e;l=h[l]){if(o[l])return t.freeUint8(o),0;a+=1,o[l]=1}1&a||(u=-u)}return t.freeUint8(o),u};var t=i("typedarray-pool")},{"typedarray-pool":617}],497:[function(i,B,V){var t=i("typedarray-pool"),h=i("invert-permutation");V.rank=function(p){var u=p.length;switch(u){case 0:case 1:return 0;case 2:return p[1]}var e,l,o,a=t.mallocUint32(u),n=t.mallocUint32(u),s=0;for(h(p,n),o=0;o<u;++o)a[o]=p[o];for(o=u-1;o>0;--o)l=n[o],e=a[o],a[o]=a[l],a[l]=e,n[o]=n[e],n[e]=l,s=(s+e)*o;return t.freeUint32(n),t.freeUint32(a),s},V.unrank=function(p,u,e){switch(p){case 0:return e||[];case 1:return e?(e[0]=0,e):[0];case 2:return e?(u?(e[0]=0,e[1]=1):(e[0]=1,e[1]=0),e):u?[0,1]:[1,0]}var l,o,a,n=1;for((e=e||new Array(p))[0]=0,a=1;a<p;++a)e[a]=a,n=n*a|0;for(a=p-1;a>0;--a)u=u-(l=u/n|0)*n|0,n=n/a|0,o=0|e[a],e[a]=0|e[l],e[l]=0|o;return e}},{"invert-permutation":450,"typedarray-pool":617}],498:[function(i,B,V){B.exports=function(p,u,e){var l,o,a={};if(typeof u=="string"&&(u=h(u)),Array.isArray(u)){var n={};for(o=0;o<u.length;o++)n[u[o]]=!0;u=n}for(l in u)u[l]=h(u[l]);var s={};for(l in u){var r=u[l];if(Array.isArray(r))for(o=0;o<r.length;o++){var c=r[o];if(e&&(s[c]=!0),c in p){if(a[l]=p[c],e)for(var f=o;f<r.length;f++)s[r[f]]=!0;break}}else l in p&&(u[l]&&(a[l]=p[l]),e&&(s[l]=!0))}if(e)for(l in p)s[l]||(a[l]=p[l]);return a};var t={};function h(p){return t[p]?t[p]:(typeof p=="string"&&(p=t[p]=p.split(/\s*,\s*|\s+/)),p)}},{}],499:[function(i,B,V){B.exports=function(h,p){for(var u=0|p.length,e=h.length,l=[new Array(u),new Array(u)],o=0;o<u;++o)l[0][o]=[],l[1][o]=[];for(o=0;o<e;++o){var a=h[o];l[0][a[0]].push(a),l[1][a[1]].push(a)}var n=[];for(o=0;o<u;++o)l[0][o].length+l[1][o].length===0&&n.push([o]);function s(y,v){var T=l[v][y[v]];T.splice(T.indexOf(y),1)}function r(y,v,T){for(var _,k,E,A=0;A<2;++A)if(l[A][v].length>0){_=l[A][v][0],E=A;break}k=_[1^E];for(var b=0;b<2;++b)for(var L=l[b][v],w=0;w<L.length;++w){var C=L[w],S=C[1^b];t(p[y],p[v],p[k],p[S])>0&&(_=C,k=S,E=b)}return T||_&&s(_,E),k}function c(y,v){var T=l[v][y][0],_=[y];s(T,v);for(var k=T[1^v];;){for(;k!==y;)_.push(k),k=r(_[_.length-2],k,!1);if(l[0][y].length+l[1][y].length===0)break;var E=_[_.length-1],A=y,b=_[1],L=r(E,A,!0);if(t(p[E],p[A],p[b],p[L])<0)break;_.push(y),k=r(E,A)}return _}function f(y,v){return v[1]===v[v.length-1]}for(o=0;o<u;++o)for(var d=0;d<2;++d){for(var g=[];l[d][o].length>0;){l[0][o].length;var m=c(o,d);f(0,m)?g.push.apply(g,m):(g.length>0&&n.push(g),g=m)}g.length>0&&n.push(g)}return n};var t=i("compare-angle")},{"compare-angle":138}],500:[function(i,B,V){B.exports=function(h,p){for(var u=t(h,p.length),e=new Array(p.length),l=new Array(p.length),o=[],a=0;a<p.length;++a){var n=u[a].length;l[a]=n,e[a]=!0,n<=1&&o.push(a)}for(;o.length>0;){var s=o.pop();e[s]=!1;var r=u[s];for(a=0;a<r.length;++a){var c=r[a];--l[c]==0&&o.push(c)}}var f=new Array(p.length),d=[];for(a=0;a<p.length;++a)e[a]?(s=d.length,f[a]=s,d.push(p[a])):f[a]=-1;var g=[];for(a=0;a<h.length;++a){var m=h[a];e[m[0]]&&e[m[1]]&&g.push([f[m[0]],f[m[1]]])}return[g,d]};var t=i("edges-to-adjacency-list")},{"edges-to-adjacency-list":187}],501:[function(i,B,V){B.exports=function(n,s){var r=o(n,s);n=r[0];for(var c=(s=r[1]).length,f=(n.length,t(n,s.length)),d=0;d<c;++d)if(f[d].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var g=h(n,s),m=(g=g.filter(function(ne){for(var ae=ne.length,ie=[0],he=0;he<ae;++he){var se=s[ne[he]],de=s[ne[(he+1)%ae]],ce=u(-se[0],se[1]),ve=u(-se[0],de[1]),Ee=u(de[0],se[1]),Le=u(de[0],de[1]);ie=e(ie,e(e(ce,ve),e(Ee,Le)))}return ie[ie.length-1]>0})).length,y=new Array(m),v=new Array(m);for(d=0;d<m;++d){y[d]=d;var T=new Array(m),_=g[d].map(function(ne){return s[ne]}),k=p([_]),E=0;e:for(var A=0;A<m;++A)if(T[A]=0,d!==A){for(var b=(K=g[A]).length,L=0;L<b;++L){var w=k(s[K[L]]);if(w!==0){w<0&&(T[A]=1,E+=1);continue e}}T[A]=1,E+=1}v[d]=[E,d,T]}for(v.sort(function(ne,ae){return ae[0]-ne[0]}),d=0;d<m;++d){var C=(T=v[d])[1],S=T[2];for(A=0;A<m;++A)S[A]&&(y[A]=C)}var P=function(ne){for(var ae=new Array(ne),ie=0;ie<ne;++ie)ae[ie]=[];return ae}(m);for(d=0;d<m;++d)P[d].push(y[d]),P[y[d]].push(d);var z={},F=a(c,!1);for(d=0;d<m;++d)for(b=(K=g[d]).length,A=0;A<b;++A){var q=K[A],W=K[(A+1)%b],X=Math.min(q,W)+":"+Math.max(q,W);if(X in z){var Q=z[X];P[Q].push(d),P[d].push(Q),F[q]=F[W]=!0}else z[X]=d}function Z(ne){for(var ae=ne.length,ie=0;ie<ae;++ie)if(!F[ne[ie]])return!1;return!0}var Y=[],N=a(m,-1);for(d=0;d<m;++d)y[d]!==d||Z(g[d])?N[d]=-1:(Y.push(d),N[d]=0);for(r=[];Y.length>0;){var J=Y.pop(),D=P[J];l(D,function(ne,ae){return ne-ae});var U,G=D.length,$=N[J];if($===0){var K=g[J];U=[K]}for(d=0;d<G;++d){var re=D[d];N[re]>=0||(N[re]=1^$,Y.push(re),$===0&&(Z(K=g[re])||(K.reverse(),U.push(K))))}$===0&&r.push(U)}return r};var t=i("edges-to-adjacency-list"),h=i("planar-dual"),p=i("point-in-big-polygon"),u=i("two-product"),e=i("robust-sum"),l=i("uniq"),o=i("./lib/trim-leaves");function a(n,s){for(var r=new Array(n),c=0;c<n;++c)r[c]=s;return r}},{"./lib/trim-leaves":500,"edges-to-adjacency-list":187,"planar-dual":499,"point-in-big-polygon":503,"robust-sum":553,"two-product":604,uniq:619}],502:[function(i,B,V){arguments[4][251][0].apply(V,arguments)},{dup:251}],503:[function(i,B,V){B.exports=function(a){for(var n=a.length,s=[],r=[],c=0;c<n;++c)for(var f=a[c],d=f.length,g=d-1,m=0;m<d;g=m++){var y=f[g],v=f[m];y[0]===v[0]?r.push([y,v]):s.push([y,v])}if(s.length===0)return r.length===0?o:(T=l(r),function(E){return T(E[0],E[1])?0:1});var T,_=h(s),k=function(E,A){return function(b){var L=u.le(A,b[0]);if(L<0)return 1;var w=E[L];if(!w){if(!(L>0&&A[L]===b[0]))return 1;w=E[L-1]}for(var C=1;w;){var S=w.key,P=t(b,S[0],S[1]);if(S[0][0]<S[1][0])if(P<0)w=w.left;else{if(!(P>0))return 0;C=-1,w=w.right}else if(P>0)w=w.left;else{if(!(P<0))return 0;C=1,w=w.right}}return C}}(_.slabs,_.coordinates);return r.length===0?k:function(E,A){return function(b){return E(b[0],b[1])?0:A(b)}}(l(r),k)};var t=i("robust-orientation")[3],h=i("slab-decomposition"),p=i("interval-tree-1d"),u=i("binary-search-bounds");function e(){return!0}function l(a){for(var n={},s=0;s<a.length;++s){var r=a[s],c=r[0][0],f=r[0][1],d=r[1][1],g=[Math.min(f,d),Math.max(f,d)];c in n?n[c].push(g):n[c]=[g]}var m={},y=Object.keys(n);for(s=0;s<y.length;++s){var v=n[y[s]];m[y[s]]=p(v)}return function(T){return function(_,k){var E=T[_];return!!E&&!!E.queryPoint(k,e)}}(m)}function o(a){return 1}},{"binary-search-bounds":502,"interval-tree-1d":448,"robust-orientation":548,"slab-decomposition":566}],504:[function(i,B,V){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var t,h=i("./lib/build-log"),p=i("./lib/epsilon"),u=i("./lib/intersecter"),e=i("./lib/segment-chainer"),l=i("./lib/segment-selector"),o=i("./lib/geojson"),a=!1,n=p();function s(r,c,f){var d=t.segments(r),g=t.segments(c),m=f(t.combine(d,g));return t.polygon(m)}t={buildLog:function(r){return r===!0?a=h():r===!1&&(a=!1),a!==!1&&a.list},epsilon:function(r){return n.epsilon(r)},segments:function(r){var c=u(!0,n,a);return r.regions.forEach(c.addRegion),{segments:c.calculate(r.inverted),inverted:r.inverted}},combine:function(r,c){return{combined:u(!1,n,a).calculate(r.segments,r.inverted,c.segments,c.inverted),inverted1:r.inverted,inverted2:c.inverted}},selectUnion:function(r){return{segments:l.union(r.combined,a),inverted:r.inverted1||r.inverted2}},selectIntersect:function(r){return{segments:l.intersect(r.combined,a),inverted:r.inverted1&&r.inverted2}},selectDifference:function(r){return{segments:l.difference(r.combined,a),inverted:r.inverted1&&!r.inverted2}},selectDifferenceRev:function(r){return{segments:l.differenceRev(r.combined,a),inverted:!r.inverted1&&r.inverted2}},selectXor:function(r){return{segments:l.xor(r.combined,a),inverted:r.inverted1!==r.inverted2}},polygon:function(r){return{regions:e(r.segments,n,a),inverted:r.inverted}},polygonFromGeoJSON:function(r){return o.toPolygon(t,r)},polygonToGeoJSON:function(r){return o.fromPolygon(t,n,r)},union:function(r,c){return s(r,c,t.selectUnion)},intersect:function(r,c){return s(r,c,t.selectIntersect)},difference:function(r,c){return s(r,c,t.selectDifference)},differenceRev:function(r,c){return s(r,c,t.selectDifferenceRev)},xor:function(r,c){return s(r,c,t.selectXor)}},typeof window=="object"&&(window.PolyBool=t),B.exports=t},{"./lib/build-log":505,"./lib/epsilon":506,"./lib/geojson":507,"./lib/intersecter":508,"./lib/segment-chainer":510,"./lib/segment-selector":511}],505:[function(i,B,V){B.exports=function(){var t,h=0,p=!1;function u(e,l){return t.list.push({type:e,data:l?JSON.parse(JSON.stringify(l)):void 0}),t}return t={list:[],segmentId:function(){return h++},checkIntersection:function(e,l){return u("check",{seg1:e,seg2:l})},segmentChop:function(e,l){return u("div_seg",{seg:e,pt:l}),u("chop",{seg:e,pt:l})},statusRemove:function(e){return u("pop_seg",{seg:e})},segmentUpdate:function(e){return u("seg_update",{seg:e})},segmentNew:function(e,l){return u("new_seg",{seg:e,primary:l})},segmentRemove:function(e){return u("rem_seg",{seg:e})},tempStatus:function(e,l,o){return u("temp_status",{seg:e,above:l,below:o})},rewind:function(e){return u("rewind",{seg:e})},status:function(e,l,o){return u("status",{seg:e,above:l,below:o})},vert:function(e){return e===p?t:(p=e,u("vert",{x:e}))},log:function(e){return typeof e!="string"&&(e=JSON.stringify(e,!1,"  ")),u("log",{txt:e})},reset:function(){return u("reset")},selected:function(e){return u("selected",{segs:e})},chainStart:function(e){return u("chain_start",{seg:e})},chainRemoveHead:function(e,l){return u("chain_rem_head",{index:e,pt:l})},chainRemoveTail:function(e,l){return u("chain_rem_tail",{index:e,pt:l})},chainNew:function(e,l){return u("chain_new",{pt1:e,pt2:l})},chainMatch:function(e){return u("chain_match",{index:e})},chainClose:function(e){return u("chain_close",{index:e})},chainAddHead:function(e,l){return u("chain_add_head",{index:e,pt:l})},chainAddTail:function(e,l){return u("chain_add_tail",{index:e,pt:l})},chainConnect:function(e,l){return u("chain_con",{index1:e,index2:l})},chainReverse:function(e){return u("chain_rev",{index:e})},chainJoin:function(e,l){return u("chain_join",{index1:e,index2:l})},done:function(){return u("done")}}}},{}],506:[function(i,B,V){B.exports=function(t){typeof t!="number"&&(t=1e-10);var h={epsilon:function(p){return typeof p=="number"&&(t=p),t},pointAboveOrOnLine:function(p,u,e){var l=u[0],o=u[1],a=e[0],n=e[1],s=p[0];return(a-l)*(p[1]-o)-(n-o)*(s-l)>=-t},pointBetween:function(p,u,e){var l=p[1]-u[1],o=e[0]-u[0],a=p[0]-u[0],n=e[1]-u[1],s=a*o+l*n;return!(s<t)&&!(s-(o*o+n*n)>-t)},pointsSameX:function(p,u){return Math.abs(p[0]-u[0])<t},pointsSameY:function(p,u){return Math.abs(p[1]-u[1])<t},pointsSame:function(p,u){return h.pointsSameX(p,u)&&h.pointsSameY(p,u)},pointsCompare:function(p,u){return h.pointsSameX(p,u)?h.pointsSameY(p,u)?0:p[1]<u[1]?-1:1:p[0]<u[0]?-1:1},pointsCollinear:function(p,u,e){var l=p[0]-u[0],o=p[1]-u[1],a=u[0]-e[0],n=u[1]-e[1];return Math.abs(l*n-a*o)<t},linesIntersect:function(p,u,e,l){var o=u[0]-p[0],a=u[1]-p[1],n=l[0]-e[0],s=l[1]-e[1],r=o*s-a*n;if(Math.abs(r)<t)return!1;var c=p[0]-e[0],f=p[1]-e[1],d=(n*f-s*c)/r,g=(o*f-a*c)/r,m={alongA:0,alongB:0,pt:[p[0]+d*o,p[1]+d*a]};return m.alongA=d<=-t?-2:d<t?-1:d-1<=-t?0:d-1<t?1:2,m.alongB=g<=-t?-2:g<t?-1:g-1<=-t?0:g-1<t?1:2,m},pointInsideRegion:function(p,u){for(var e=p[0],l=p[1],o=u[u.length-1][0],a=u[u.length-1][1],n=!1,s=0;s<u.length;s++){var r=u[s][0],c=u[s][1];c-l>t!=a-l>t&&(o-r)*(l-c)/(a-c)+r-e>t&&(n=!n),o=r,a=c}return n}};return h}},{}],507:[function(i,B,V){var t={toPolygon:function(h,p){function u(o){if(o.length<=0)return h.segments({inverted:!1,regions:[]});function a(r){var c=r.slice(0,r.length-1);return h.segments({inverted:!1,regions:[c]})}for(var n=a(o[0]),s=1;s<o.length;s++)n=h.selectDifference(h.combine(n,a(o[s])));return n}if(p.type==="Polygon")return h.polygon(u(p.coordinates));if(p.type==="MultiPolygon"){for(var e=h.segments({inverted:!1,regions:[]}),l=0;l<p.coordinates.length;l++)e=h.selectUnion(h.combine(e,u(p.coordinates[l])));return h.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(h,p,u){function e(g,m){return p.pointInsideRegion([.5*(g[0][0]+g[1][0]),.5*(g[0][1]+g[1][1])],m)}function l(g){return{region:g,children:[]}}u=h.polygon(h.segments(u));var o=l(null);function a(g,m){for(var y=0;y<g.children.length;y++)if(e(m,(T=g.children[y]).region))return void a(T,m);var v=l(m);for(y=0;y<g.children.length;y++){var T;e((T=g.children[y]).region,m)&&(v.children.push(T),g.children.splice(y,1),y--)}g.children.push(v)}for(var n=0;n<u.regions.length;n++){var s=u.regions[n];s.length<3||a(o,s)}function r(g,m){for(var y=0,v=g[g.length-1][0],T=g[g.length-1][1],_=[],k=0;k<g.length;k++){var E=g[k][0],A=g[k][1];_.push([E,A]),y+=A*v-E*T,v=E,T=A}return y<0!==m&&_.reverse(),_.push([_[0][0],_[0][1]]),_}var c=[];function f(g){var m=[r(g.region,!1)];c.push(m);for(var y=0;y<g.children.length;y++)m.push(d(g.children[y]))}function d(g){for(var m=0;m<g.children.length;m++)f(g.children[m]);return r(g.region,!0)}for(n=0;n<o.children.length;n++)f(o.children[n]);return c.length<=0?{type:"Polygon",coordinates:[]}:c.length==1?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}};B.exports=t},{}],508:[function(i,B,V){var t=i("./linked-list");B.exports=function(h,p,u){function e(r,c,f){return{id:u?u.segmentId():-1,start:r,end:c,myFill:{above:f.myFill.above,below:f.myFill.below},otherFill:null}}var l=t.create();function o(r,c){l.insertBefore(r,function(f){return function(d,g,m,y,v,T){var _=p.pointsCompare(g,v);return _!==0?_:p.pointsSame(m,T)?0:d!==y?d?1:-1:p.pointAboveOrOnLine(m,y?v:T,y?T:v)?1:-1}(r.isStart,r.pt,c,f.isStart,f.pt,f.other.pt)<0})}function a(r,c){var f=function(d,g){var m=t.node({isStart:!0,pt:d.start,seg:d,primary:g,other:null,status:null});return o(m,d.end),m}(r,c);return function(d,g,m){var y=t.node({isStart:!1,pt:g.end,seg:g,primary:m,other:d,status:null});d.other=y,o(y,d.pt)}(f,r,c),f}function n(r,c){var f=e(c,r.seg.end,r.seg);return function(d,g){u&&u.segmentChop(d.seg,g),d.other.remove(),d.seg.end=g,d.other.pt=g,o(d.other,d.pt)}(r,c),a(f,r.primary)}function s(r,c){var f=t.create();function d(w){return f.findTransition(function(C){var S,P,z,F,q,W;return S=w,P=C.ev,z=S.seg.start,F=S.seg.end,q=P.seg.start,W=P.seg.end,(p.pointsCollinear(z,q,W)?p.pointsCollinear(F,q,W)||p.pointAboveOrOnLine(F,q,W)?1:-1:p.pointAboveOrOnLine(z,q,W)?1:-1)>0})}function g(w,C){var S=w.seg,P=C.seg,z=S.start,F=S.end,q=P.start,W=P.end;u&&u.checkIntersection(S,P);var X=p.linesIntersect(z,F,q,W);if(X===!1){if(!p.pointsCollinear(z,F,q)||p.pointsSame(z,W)||p.pointsSame(F,q))return!1;var Q=p.pointsSame(z,q),Z=p.pointsSame(F,W);if(Q&&Z)return C;var Y=!Q&&p.pointBetween(z,q,W),N=!Z&&p.pointBetween(F,q,W);if(Q)return N?n(C,F):n(w,W),C;Y&&(Z||(N?n(C,F):n(w,W)),n(C,z))}else X.alongA===0&&(X.alongB===-1?n(w,q):X.alongB===0?n(w,X.pt):X.alongB===1&&n(w,W)),X.alongB===0&&(X.alongA===-1?n(C,z):X.alongA===0?n(C,X.pt):X.alongA===1&&n(C,F));return!1}for(var m=[];!l.isEmpty();){var y=l.getHead();if(u&&u.vert(y.pt[0]),y.isStart){let w=function(){if(T){var C=g(y,T);if(C)return C}return!!_&&g(y,_)};u&&u.segmentNew(y.seg,y.primary);var v=d(y),T=v.before?v.before.ev:null,_=v.after?v.after.ev:null;u&&u.tempStatus(y.seg,!!T&&T.seg,!!_&&_.seg);var k,E=w();if(E){var A;h?(A=y.seg.myFill.below===null||y.seg.myFill.above!==y.seg.myFill.below)&&(E.seg.myFill.above=!E.seg.myFill.above):E.seg.otherFill=y.seg.myFill,u&&u.segmentUpdate(E.seg),y.other.remove(),y.remove()}if(l.getHead()!==y){u&&u.rewind(y.seg);continue}h?(A=y.seg.myFill.below===null||y.seg.myFill.above!==y.seg.myFill.below,y.seg.myFill.below=_?_.seg.myFill.above:r,y.seg.myFill.above=A?!y.seg.myFill.below:y.seg.myFill.below):y.seg.otherFill===null&&(k=_?y.primary===_.primary?_.seg.otherFill.above:_.seg.myFill.above:y.primary?c:r,y.seg.otherFill={above:k,below:k}),u&&u.status(y.seg,!!T&&T.seg,!!_&&_.seg),y.other.status=v.insert(t.node({ev:y}))}else{var b=y.status;if(b===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(f.exists(b.prev)&&f.exists(b.next)&&g(b.prev.ev,b.next.ev),u&&u.statusRemove(b.ev.seg),b.remove(),!y.primary){var L=y.seg.myFill;y.seg.myFill=y.seg.otherFill,y.seg.otherFill=L}m.push(y.seg)}l.getHead().remove()}return u&&u.done(),m}return h?{addRegion:function(r){for(var c,f,d,g=r[r.length-1],m=0;m<r.length;m++){c=g,g=r[m];var y=p.pointsCompare(c,g);y!==0&&a((f=y<0?c:g,d=y<0?g:c,{id:u?u.segmentId():-1,start:f,end:d,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(r){return s(r,!1)}}:{calculate:function(r,c,f,d){return r.forEach(function(g){a(e(g.start,g.end,g),!0)}),f.forEach(function(g){a(e(g.start,g.end,g),!1)}),s(c,d)}}}},{"./linked-list":509}],509:[function(i,B,V){B.exports={create:function(){var t={root:{root:!0,next:null},exists:function(h){return h!==null&&h!==t.root},isEmpty:function(){return t.root.next===null},getHead:function(){return t.root.next},insertBefore:function(h,p){for(var u=t.root,e=t.root.next;e!==null;){if(p(e))return h.prev=e.prev,h.next=e,e.prev.next=h,void(e.prev=h);u=e,e=e.next}u.next=h,h.prev=u,h.next=null},findTransition:function(h){for(var p=t.root,u=t.root.next;u!==null&&!h(u);)p=u,u=u.next;return{before:p===t.root?null:p,after:u,insert:function(e){return e.prev=p,e.next=u,p.next=e,u!==null&&(u.prev=e),e}}}};return t},node:function(t){return t.prev=null,t.next=null,t.remove=function(){t.prev.next=t.next,t.next&&(t.next.prev=t.prev),t.prev=null,t.next=null},t}}},{}],510:[function(i,B,V){B.exports=function(t,h,p){var u=[],e=[];return t.forEach(function(l){var o=l.start,a=l.end;if(h.pointsSame(o,a))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{p&&p.chainStart(l);for(var n={index:0,matches_head:!1,matches_pt1:!1},s={index:0,matches_head:!1,matches_pt1:!1},r=n,c=0;c<u.length;c++){var f=(v=u[c])[0],d=(v[1],v[v.length-1]);if(v[v.length-2],h.pointsSame(f,o)){if(w(c,!0,!0))break}else if(h.pointsSame(f,a)){if(w(c,!0,!1))break}else if(h.pointsSame(d,o)){if(w(c,!1,!0))break}else if(h.pointsSame(d,a)&&w(c,!1,!1))break}if(r===n)return u.push([o,a]),void(p&&p.chainNew(o,a));if(r===s){p&&p.chainMatch(n.index);var g=n.index,m=n.matches_pt1?a:o,y=n.matches_head,v=u[g],T=y?v[0]:v[v.length-1],_=y?v[1]:v[v.length-2],k=y?v[v.length-1]:v[0],E=y?v[v.length-2]:v[1];return h.pointsCollinear(_,T,m)&&(y?(p&&p.chainRemoveHead(n.index,m),v.shift()):(p&&p.chainRemoveTail(n.index,m),v.pop()),T=_),h.pointsSame(k,m)?(u.splice(g,1),h.pointsCollinear(E,k,T)&&(y?(p&&p.chainRemoveTail(n.index,T),v.pop()):(p&&p.chainRemoveHead(n.index,T),v.shift())),p&&p.chainClose(n.index),void e.push(v)):void(y?(p&&p.chainAddHead(n.index,m),v.unshift(m)):(p&&p.chainAddTail(n.index,m),v.push(m)))}var A=n.index,b=s.index;p&&p.chainConnect(A,b);var L=u[A].length<u[b].length;n.matches_head?s.matches_head?L?(C(A),S(A,b)):(C(b),S(b,A)):S(b,A):s.matches_head?S(A,b):L?(C(A),S(b,A)):(C(b),S(A,b))}function w(P,z,F){return r.index=P,r.matches_head=z,r.matches_pt1=F,r===n?(r=s,!1):(r=null,!0)}function C(P){p&&p.chainReverse(P),u[P].reverse()}function S(P,z){var F=u[P],q=u[z],W=F[F.length-1],X=F[F.length-2],Q=q[0],Z=q[1];h.pointsCollinear(X,W,Q)&&(p&&p.chainRemoveTail(P,W),F.pop(),W=X),h.pointsCollinear(W,Q,Z)&&(p&&p.chainRemoveHead(z,Q),q.shift()),p&&p.chainJoin(P,z),u[P]=F.concat(q),u.splice(z,1)}}),e}},{}],511:[function(i,B,V){function t(p,u,e){var l=[];return p.forEach(function(o){var a=(o.myFill.above?8:0)+(o.myFill.below?4:0)+(o.otherFill&&o.otherFill.above?2:0)+(o.otherFill&&o.otherFill.below?1:0);u[a]!==0&&l.push({id:e?e.segmentId():-1,start:o.start,end:o.end,myFill:{above:u[a]===1,below:u[a]===2},otherFill:null})}),e&&e.selected(l),l}var h={union:function(p,u){return t(p,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],u)},intersect:function(p,u){return t(p,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],u)},difference:function(p,u){return t(p,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],u)},differenceRev:function(p,u){return t(p,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],u)},xor:function(p,u){return t(p,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],u)}};B.exports=h},{}],512:[function(i,B,V){var t=new Float64Array(4),h=new Float64Array(4),p=new Float64Array(4);B.exports=function(u,e,l,o,a){t.length<o.length&&(t=new Float64Array(o.length),h=new Float64Array(o.length),p=new Float64Array(o.length));for(var n=0;n<o.length;++n)t[n]=u[n]-o[n],h[n]=e[n]-u[n],p[n]=l[n]-u[n];var s=0,r=0,c=0,f=0,d=0,g=0;for(n=0;n<o.length;++n){var m=h[n],y=p[n],v=t[n];s+=m*m,r+=m*y,c+=y*y,f+=v*m,d+=v*y,g+=v*v}var T,_,k,E,A,b=Math.abs(s*c-r*r),L=r*d-c*f,w=r*f-s*d;if(L+w<=b)if(L<0)w<0&&f<0?(w=0,-f>=s?(L=1,T=s+2*f+g):T=f*(L=-f/s)+g):(L=0,d>=0?(w=0,T=g):-d>=c?(w=1,T=c+2*d+g):T=d*(w=-d/c)+g);else if(w<0)w=0,f>=0?(L=0,T=g):-f>=s?(L=1,T=s+2*f+g):T=f*(L=-f/s)+g;else{var C=1/b;T=(L*=C)*(s*L+r*(w*=C)+2*f)+w*(r*L+c*w+2*d)+g}else L<0?(k=c+d)>(_=r+f)?(E=k-_)>=(A=s-2*r+c)?(L=1,w=0,T=s+2*f+g):T=(L=E/A)*(s*L+r*(w=1-L)+2*f)+w*(r*L+c*w+2*d)+g:(L=0,k<=0?(w=1,T=c+2*d+g):d>=0?(w=0,T=g):T=d*(w=-d/c)+g):w<0?(k=s+f)>(_=r+d)?(E=k-_)>=(A=s-2*r+c)?(w=1,L=0,T=c+2*d+g):T=(L=1-(w=E/A))*(s*L+r*w+2*f)+w*(r*L+c*w+2*d)+g:(w=0,k<=0?(L=1,T=s+2*f+g):f>=0?(L=0,T=g):T=f*(L=-f/s)+g):(E=c+d-r-f)<=0?(L=0,w=1,T=c+2*d+g):E>=(A=s-2*r+c)?(L=1,w=0,T=s+2*f+g):T=(L=E/A)*(s*L+r*(w=1-L)+2*f)+w*(r*L+c*w+2*d)+g;var S=1-L-w;for(n=0;n<o.length;++n)a[n]=S*u[n]+L*e[n]+w*l[n];return T<0?0:T}},{}],513:[function(i,B,V){var t=i("stream").Transform,h=i("stream-parser");function p(){t.call(this,{readableObjectMode:!0})}function u(e,l,o){Error.call(this),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e,l&&(this.code=l),o&&(this.statusCode=o)}p.prototype=Object.create(t.prototype),p.prototype.constructor=p,h(p.prototype),V.ParserStream=p,V.sliceEq=function(e,l,o){for(var a=l,n=0;n<o.length;)if(e[a++]!==o[n++])return!1;return!0},V.str2arr=function(e,l){var o=[],a=0;if(l&&l==="hex")for(;a<e.length;)o.push(parseInt(e.slice(a,a+2),16)),a+=2;else for(;a<e.length;a++)o.push(255&e.charCodeAt(a));return o},V.readUInt16LE=function(e,l){return e[l]|e[l+1]<<8},V.readUInt16BE=function(e,l){return e[l+1]|e[l]<<8},V.readUInt32LE=function(e,l){return e[l]|e[l+1]<<8|e[l+2]<<16|16777216*e[l+3]},V.readUInt32BE=function(e,l){return e[l+3]|e[l+2]<<8|e[l+1]<<16|16777216*e[l]},u.prototype=Object.create(Error.prototype),u.prototype.constructor=u,V.ProbeError=u},{stream:569,"stream-parser":585}],514:[function(i,B,V){function t(u,e){var l=new Error(u);return l.code=e,l}function h(u){try{return decodeURIComponent(escape(u))}catch{return u}}function p(u,e,l){this.input=u.subarray(e,l),this.start=e;var o=String.fromCharCode.apply(null,this.input.subarray(0,4));if(o!=="II*\0"&&o!=="MM\0*")throw t("invalid TIFF signature","EBADDATA");this.big_endian=o[0]==="M"}p.prototype.each=function(u){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var l=this.ifds_to_read.shift();l.offset&&this.scan_ifd(l.id,l.offset,u)}},p.prototype.read_uint16=function(u){var e=this.input;if(u+2>e.length)throw t("unexpected EOF","EBADDATA");return this.big_endian?256*e[u]+e[u+1]:e[u]+256*e[u+1]},p.prototype.read_uint32=function(u){var e=this.input;if(u+4>e.length)throw t("unexpected EOF","EBADDATA");return this.big_endian?16777216*e[u]+65536*e[u+1]+256*e[u+2]+e[u+3]:e[u]+256*e[u+1]+65536*e[u+2]+16777216*e[u+3]},p.prototype.is_subifd_link=function(u,e){return u===0&&e===34665||u===0&&e===34853||u===34665&&e===40965},p.prototype.exif_format_length=function(u){switch(u){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},p.prototype.exif_format_read=function(u,e){var l;switch(u){case 1:case 2:return l=this.input[e];case 6:return(l=this.input[e])|33554430*(128&l);case 3:return l=this.read_uint16(e);case 8:return(l=this.read_uint16(e))|131070*(32768&l);case 4:return l=this.read_uint32(e);case 9:return 0|(l=this.read_uint32(e));case 5:case 10:case 11:case 12:case 7:default:return null}},p.prototype.scan_ifd=function(u,e,l){var o=this.read_uint16(e);e+=2;for(var a=0;a<o;a++){var n=this.read_uint16(e),s=this.read_uint16(e+2),r=this.read_uint32(e+4),c=this.exif_format_length(s),f=r*c,d=f<=4?e+8:this.read_uint32(e+8),g=!1;if(d+f>this.input.length)throw t("unexpected EOF","EBADDATA");for(var m=[],y=d,v=0;v<r;v++,y+=c){var T=this.exif_format_read(s,y);if(T===null){m=null;break}m.push(T)}if(Array.isArray(m)&&s===2&&(m=h(String.fromCharCode.apply(null,m)))&&m[m.length-1]==="\0"&&(m=m.slice(0,-1)),this.is_subifd_link(u,n)&&Array.isArray(m)&&Number.isInteger(m[0])&&m[0]>0&&(this.ifds_to_read.push({id:n,offset:m[0]}),g=!0),l({is_big_endian:this.big_endian,ifd:u,tag:n,format:s,count:r,entry_offset:e+this.start,data_length:f,data_offset:d+this.start,value:m,is_subifd_link:g})===!1)return void(this.aborted=!0);e+=12}u===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},B.exports.ExifParser=p,B.exports.get_orientation=function(u){var e=0;try{return new p(u,0,u.length).each(function(l){if(l.ifd===0&&l.tag===274&&Array.isArray(l.value))return e=l.value[0],!1}),e}catch{return-1}}},{}],515:[function(i,B,V){var t=i("./common").readUInt16BE,h=i("./common").readUInt32BE;function p(n,s){if(n.length<4+s)return null;var r=h(n,s);return n.length<r+s||r<8?null:{boxtype:String.fromCharCode.apply(null,n.slice(s+4,s+8)),data:n.slice(s+8,s+r),end:s+r}}function u(n,s){for(var r=0;;){var c=p(n,r);if(!c)break;switch(c.boxtype){case"ispe":s.sizes.push({width:h(c.data,4),height:h(c.data,8)});break;case"irot":s.transforms.push({type:"irot",value:3&c.data[0]});break;case"imir":s.transforms.push({type:"imir",value:1&c.data[0]})}r=c.end}}function e(n,s,r){for(var c=0,f=0;f<r;f++)c=256*c+(n[s+f]||0);return c}function l(n,s){for(var r=n[4]>>4&15,c=15&n[4],f=n[5]>>4&15,d=t(n,6),g=8,m=0;m<d;m++){var y=t(n,g),v=t(n,g+=2),T=e(n,g+=2,f),_=t(n,g+=f);if(g+=2,v===0&&_===1){var k=e(n,g,r),E=e(n,g+r,c);s.item_loc[y]={length:E,offset:k+T}}g+=_*(r+c)}}function o(n,s){for(var r=t(n,4),c=6,f=0;f<r;f++){var d=p(n,c);if(!d)break;if(d.boxtype==="infe"){for(var g=t(d.data,4),m="",y=8;y<d.data.length&&d.data[y];y++)m+=String.fromCharCode(d.data[y]);s.item_inf[m]=g}c=d.end}}function a(n,s){for(var r=0;;){var c=p(n,r);if(!c)break;c.boxtype==="ipco"&&u(c.data,s),r=c.end}}B.exports.unbox=p,B.exports.readSizeFromMeta=function(n){var s={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(y,v){for(var T=4;;){var _=p(y,T);if(!_)break;_.boxtype==="iprp"&&a(_.data,v),_.boxtype==="iloc"&&l(_.data,v),_.boxtype==="iinf"&&o(_.data,v),T=_.end}}(n,s),s.sizes.length){var r,c,f,d=(r=s.sizes,c=r.reduce(function(y,v){return y.width>v.width||y.width===v.width&&y.height>v.height?y:v}),f=r.reduce(function(y,v){return y.height>v.height||y.height===v.height&&y.width>v.width?y:v}),c.width>f.height||c.width===f.height&&c.height>f.width?c:f),g=1;s.transforms.forEach(function(y){var v={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},T={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(y.type==="imir"&&(g=y.value===0?T[g]:v[g=v[g=T[g]]]),y.type==="irot")for(var _=0;_<y.value;_++)g=v[g]});var m=null;return s.item_inf.Exif&&(m=s.item_loc[s.item_inf.Exif]),{width:d.width,height:d.height,orientation:s.transforms.length?g:null,variants:s.sizes,exif_location:m}}},B.exports.getMimeType=function(n){var s=String.fromCharCode.apply(null,n.slice(0,4)),r={};r[s]=!0;for(var c=8;c<n.length;c+=4)r[String.fromCharCode.apply(null,n.slice(c,c+4))]=!0;if(r.mif1||r.msf1||r.miaf)return s==="avif"||s==="avis"||s==="avio"?{type:"avif",mime:"image/avif"}:s==="heic"||s==="heix"?{type:"heic",mime:"image/heic"}:s==="hevc"||s==="hevx"?{type:"heic",mime:"image/heic-sequence"}:r.avif||r.avis?{type:"avif",mime:"image/avif"}:r.heic||r.heix||r.hevc||r.hevx||r.heis?r.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":513}],516:[function(i,B,V){var t=i("../common").str2arr,h=i("../common").sliceEq,p=i("../common").readUInt32BE,u=i("../miaf_utils"),e=i("../exif_utils"),l=t("ftyp");B.exports=function(o){if(h(o,4,l)){var a=u.unbox(o,0);if(a){var n=u.getMimeType(a.data);if(n){for(var s,r=a.end;;){var c=u.unbox(o,r);if(!c)break;if(r=c.end,c.boxtype==="mdat")return;if(c.boxtype==="meta"){s=c.data;break}}if(s){var f=u.readSizeFromMeta(s);if(f){var d={width:f.width,height:f.height,type:n.type,mime:n.mime,wUnits:"px",hUnits:"px"};if(f.variants.length>1&&(d.variants=f.variants),f.orientation&&(d.orientation=f.orientation),f.exif_location&&f.exif_location.offset+f.exif_location.length<=o.length){var g=p(o,f.exif_location.offset),m=o.slice(f.exif_location.offset+g+4,f.exif_location.offset+f.exif_location.length),y=e.get_orientation(m);y>0&&(d.orientation=y)}return d}}}}}}},{"../common":513,"../exif_utils":514,"../miaf_utils":515}],517:[function(i,B,V){var t=i("../common").str2arr,h=i("../common").sliceEq,p=i("../common").readUInt16LE,u=t("BM");B.exports=function(e){if(!(e.length<26)&&h(e,0,u))return{width:p(e,18),height:p(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":513}],518:[function(i,B,V){var t=i("../common").str2arr,h=i("../common").sliceEq,p=i("../common").readUInt16LE,u=t("GIF87a"),e=t("GIF89a");B.exports=function(l){if(!(l.length<10)&&(h(l,0,u)||h(l,0,e)))return{width:p(l,6),height:p(l,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":513}],519:[function(i,B,V){var t=i("../common").readUInt16LE;B.exports=function(h){var p=t(h,0),u=t(h,2),e=t(h,4);if(p===0&&u===1&&e){for(var l=[],o={width:0,height:0},a=0;a<e;a++){var n=h[6+16*a]||256,s=h[6+16*a+1]||256,r={width:n,height:s};l.push(r),(n>o.width||s>o.height)&&(o=r)}return{width:o.width,height:o.height,variants:l,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":513}],520:[function(i,B,V){var t=i("../common").readUInt16BE,h=i("../common").str2arr,p=i("../common").sliceEq,u=i("../exif_utils"),e=h("Exif\0\0");B.exports=function(l){if(!(l.length<2)&&l[0]===255&&l[1]===216)for(var o=2;;){if(l.length-o<2||l[o++]!==255)return;for(var a,n,s=l[o++];s===255;)s=l[o++];if(208<=s&&s<=217||s===1)a=0;else{if(!(192<=s&&s<=254)||l.length-o<2)return;a=t(l,o)-2,o+=2}if(s===217||s===218)return;if(s===225&&a>=10&&p(l,o,e)&&(n=u.get_orientation(l.slice(o+6,o+a))),a>=5&&192<=s&&s<=207&&s!==196&&s!==200&&s!==204){if(l.length-o<a)return;var r={width:t(l,o+3),height:t(l,o+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return n>0&&(r.orientation=n),r}o+=a}}},{"../common":513,"../exif_utils":514}],521:[function(i,B,V){var t=i("../common").str2arr,h=i("../common").sliceEq,p=i("../common").readUInt32BE,u=t(`PNG\r

`),e=t("IHDR");B.exports=function(l){if(!(l.length<24)&&h(l,0,u)&&h(l,12,e))return{width:p(l,16),height:p(l,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":513}],522:[function(i,B,V){var t=i("../common").str2arr,h=i("../common").sliceEq,p=i("../common").readUInt32BE,u=t("8BPS\0");B.exports=function(e){if(!(e.length<22)&&h(e,0,u))return{width:p(e,18),height:p(e,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":513}],523:[function(i,B,V){function t(n){return typeof n=="number"&&isFinite(n)&&n>0}var h=/<[-_.:a-zA-Z0-9][^>]*>/,p=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,u=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,e=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,l=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,o=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function a(n){return o.test(n)?n.match(o)[0]:"px"}B.exports=function(n){if(function(k){var E,A=0,b=k.length;for(k[0]===239&&k[1]===187&&k[2]===191&&(A=3);A<b&&((E=k[A])===32||E===9||E===13||E===10);)A++;return A!==b&&k[A]===60}(n)){for(var s="",r=0;r<n.length;r++)s+=String.fromCharCode(n[r]);var c=(s.match(h)||[""])[0];if(p.test(c)){var f=function(k){var E=k.match(u),A=k.match(e),b=k.match(l);return{width:E&&(E[1]||E[2]),height:A&&(A[1]||A[2]),viewbox:b&&(b[1]||b[2])}}(c),d=parseFloat(f.width),g=parseFloat(f.height);if(f.width&&f.height)return!t(d)||!t(g)?void 0:{width:d,height:g,type:"svg",mime:"image/svg+xml",wUnits:a(f.width),hUnits:a(f.height)};var m=(f.viewbox||"").split(" "),y={width:m[2],height:m[3]},v=parseFloat(y.width),T=parseFloat(y.height);if(t(v)&&t(T)&&a(y.width)===a(y.height)){var _=v/T;return f.width?t(d)?{width:d,height:d/_,type:"svg",mime:"image/svg+xml",wUnits:a(f.width),hUnits:a(f.width)}:void 0:f.height?t(g)?{width:g*_,height:g,type:"svg",mime:"image/svg+xml",wUnits:a(f.height),hUnits:a(f.height)}:void 0:{width:v,height:T,type:"svg",mime:"image/svg+xml",wUnits:a(y.width),hUnits:a(y.height)}}}}}},{}],524:[function(i,B,V){var t=i("../common").str2arr,h=i("../common").sliceEq,p=i("../common").readUInt16LE,u=i("../common").readUInt16BE,e=i("../common").readUInt32LE,l=i("../common").readUInt32BE,o=t("II*\0"),a=t("MM\0*");function n(c,f,d){return d?u(c,f):p(c,f)}function s(c,f,d){return d?l(c,f):e(c,f)}function r(c,f,d){var g=n(c,f+2,d);return s(c,f+4,d)!==1||g!==3&&g!==4?null:g===3?n(c,f+8,d):s(c,f+8,d)}B.exports=function(c){if(!(c.length<8)&&(h(c,0,o)||h(c,0,a))){var f=c[0]===77,d=s(c,4,f)-8;if(!(d<0)){var g=d+8;if(!(c.length-g<2)){var m=12*n(c,g+0,f);if(!(m<=0||(g+=2,c.length-g<m))){var y,v,T,_;for(y=0;y<m;y+=12)(_=n(c,g+y,f))===256?v=r(c,g+y,f):_===257&&(T=r(c,g+y,f));return v&&T?{width:v,height:T,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":513}],525:[function(i,B,V){var t=i("../common").str2arr,h=i("../common").sliceEq,p=i("../common").readUInt16LE,u=i("../common").readUInt32LE,e=i("../exif_utils"),l=t("RIFF"),o=t("WEBP");function a(r,c){if(r[c+3]===157&&r[c+4]===1&&r[c+5]===42)return{width:16383&p(r,c+6),height:16383&p(r,c+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function n(r,c){if(r[c]===47){var f=u(r,c+1);return{width:1+(16383&f),height:1+(f>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function s(r,c){return{width:1+(r[c+6]<<16|r[c+5]<<8|r[c+4]),height:1+(r[c+9]<<c|r[c+8]<<8|r[c+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}B.exports=function(r){if(!(r.length<16)&&(h(r,0,l)||h(r,8,o))){var c=12,f=null,d=0,g=u(r,4)+8;if(!(g>r.length)){for(;c+8<g;)if(r[c]!==0){var m=String.fromCharCode.apply(null,r.slice(c,c+4)),y=u(r,c+4);m==="VP8 "&&y>=10?f=f||a(r,c+8):m==="VP8L"&&y>=9?f=f||n(r,c+8):m==="VP8X"&&y>=10?f=f||s(r,c+8):m==="EXIF"&&(d=e.get_orientation(r.slice(c+8,c+8+y)),c=1/0),c+=8+y}else c++;if(f)return d>0&&(f.orientation=d),f}}}},{"../common":513,"../exif_utils":514}],526:[function(i,B,V){B.exports={avif:i("./parse_sync/avif"),bmp:i("./parse_sync/bmp"),gif:i("./parse_sync/gif"),ico:i("./parse_sync/ico"),jpeg:i("./parse_sync/jpeg"),png:i("./parse_sync/png"),psd:i("./parse_sync/psd"),svg:i("./parse_sync/svg"),tiff:i("./parse_sync/tiff"),webp:i("./parse_sync/webp")}},{"./parse_sync/avif":516,"./parse_sync/bmp":517,"./parse_sync/gif":518,"./parse_sync/ico":519,"./parse_sync/jpeg":520,"./parse_sync/png":521,"./parse_sync/psd":522,"./parse_sync/svg":523,"./parse_sync/tiff":524,"./parse_sync/webp":525}],527:[function(i,B,V){var t=i("./lib/parsers_sync");B.exports=function(h){return function(p){for(var u=Object.keys(t),e=0;e<u.length;e++){var l=t[u[e]](p);if(l)return l}return null}(h)},B.exports.parsers=t},{"./lib/parsers_sync":526}],528:[function(i,B,V){var t,h,p=B.exports={};function u(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function l(g){if(t===setTimeout)return setTimeout(g,0);if((t===u||!t)&&setTimeout)return t=setTimeout,setTimeout(g,0);try{return t(g,0)}catch{try{return t.call(null,g,0)}catch{return t.call(this,g,0)}}}(function(){try{t=typeof setTimeout=="function"?setTimeout:u}catch{t=u}try{h=typeof clearTimeout=="function"?clearTimeout:e}catch{h=e}})();var o,a=[],n=!1,s=-1;function r(){n&&o&&(n=!1,o.length?a=o.concat(a):s=-1,a.length&&c())}function c(){if(!n){var g=l(r);n=!0;for(var m=a.length;m;){for(o=a,a=[];++s<m;)o&&o[s].run();s=-1,m=a.length}o=null,n=!1,function(y){if(h===clearTimeout)return clearTimeout(y);if((h===e||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(y);try{h(y)}catch{try{return h.call(null,y)}catch{return h.call(this,y)}}}(g)}}function f(g,m){this.fun=g,this.array=m}function d(){}p.nextTick=function(g){var m=new Array(arguments.length-1);if(arguments.length>1)for(var y=1;y<arguments.length;y++)m[y-1]=arguments[y];a.push(new f(g,m)),a.length!==1||n||l(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=d,p.addListener=d,p.once=d,p.off=d,p.removeListener=d,p.removeAllListeners=d,p.emit=d,p.prependListener=d,p.prependOnceListener=d,p.listeners=function(g){return[]},p.binding=function(g){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(g){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],529:[function(i,B,V){B.exports=i("gl-quat/slerp")},{"gl-quat/slerp":329}],530:[function(i,B,V){(function(t){(function(){for(var h=i("performance-now"),p=typeof window>"u"?t:window,u=["moz","webkit"],e="AnimationFrame",l=p["request"+e],o=p["cancel"+e]||p["cancelRequest"+e],a=0;!l&&a<u.length;a++)l=p[u[a]+"Request"+e],o=p[u[a]+"Cancel"+e]||p[u[a]+"CancelRequest"+e];if(!l||!o){var n=0,s=0,r=[];l=function(c){if(r.length===0){var f=h(),d=Math.max(0,1e3/60-(f-n));n=d+f,setTimeout(function(){var g=r.slice(0);r.length=0;for(var m=0;m<g.length;m++)if(!g[m].cancelled)try{g[m].callback(n)}catch(y){setTimeout(function(){throw y},0)}},Math.round(d))}return r.push({handle:++s,callback:c,cancelled:!1}),s},o=function(c){for(var f=0;f<r.length;f++)r[f].handle===c&&(r[f].cancelled=!0)}}B.exports=function(c){return l.call(p,c)},B.exports.cancel=function(){o.apply(p,arguments)},B.exports.polyfill=function(c){c||(c=p),c.requestAnimationFrame=l,c.cancelAnimationFrame=o}}).call(this)}).call(this,typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":495}],531:[function(i,B,V){var t=i("big-rat/add");B.exports=function(h,p){for(var u=h.length,e=new Array(u),l=0;l<u;++l)e[l]=t(h[l],p[l]);return e}},{"big-rat/add":87}],532:[function(i,B,V){B.exports=function(h){for(var p=new Array(h.length),u=0;u<h.length;++u)p[u]=t(h[u]);return p};var t=i("big-rat")},{"big-rat":90}],533:[function(i,B,V){var t=i("big-rat"),h=i("big-rat/mul");B.exports=function(p,u){for(var e=t(u),l=p.length,o=new Array(l),a=0;a<l;++a)o[a]=h(p[a],e);return o}},{"big-rat":90,"big-rat/mul":99}],534:[function(i,B,V){var t=i("big-rat/sub");B.exports=function(h,p){for(var u=h.length,e=new Array(u),l=0;l<u;++l)e[l]=t(h[l],p[l]);return e}},{"big-rat/sub":101}],535:[function(i,B,V){var t=i("compare-cell"),h=i("compare-oriented-cell"),p=i("cell-orientation");B.exports=function(u){u.sort(h);for(var e=u.length,l=0,o=0;o<e;++o){var a=u[o],n=p(a);if(n!==0){if(l>0){var s=u[l-1];if(t(a,s)===0&&p(s)!==n){l-=1;continue}}u[l++]=a}}return u.length=l,u}},{"cell-orientation":123,"compare-cell":139,"compare-oriented-cell":140}],536:[function(i,B,V){var t=i("array-bounds"),h=i("color-normalize"),p=i("update-diff"),u=i("pick-by-alias"),e=i("object-assign"),l=i("flatten-vertex-data"),o=i("to-float32"),a=o.float32,n=o.fract32;B.exports=function(r,c){if(typeof r=="function"?(c||(c={}),c.regl=r):c=r,c.length&&(c.positions=c),!(r=c.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var f,d,g,m,y,v,T=r._gl,_={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},k=[];return m=r.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),d=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),g=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),y=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),v=r.buffer({usage:"static",type:"float",data:s}),L(c),f=r({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:r.prop("range"),lineWidth:r.prop("lineWidth"),capSize:r.prop("capSize"),opacity:r.prop("opacity"),scale:r.prop("scale"),translate:r.prop("translate"),scaleFract:r.prop("scaleFract"),translateFract:r.prop("translateFract"),viewport:function(C,S){return[S.viewport.x,S.viewport.y,C.viewportWidth,C.viewportHeight]}},attributes:{color:{buffer:m,offset:function(C,S){return 4*S.offset},divisor:1},position:{buffer:d,offset:function(C,S){return 8*S.offset},divisor:1},positionFract:{buffer:g,offset:function(C,S){return 8*S.offset},divisor:1},error:{buffer:y,offset:function(C,S){return 16*S.offset},divisor:1},direction:{buffer:v,stride:24,offset:0},lineOffset:{buffer:v,stride:24,offset:8},capOffset:{buffer:v,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:r.prop("viewport")},viewport:r.prop("viewport"),stencil:!1,instances:r.prop("count"),count:s.length}),e(E,{update:L,draw:A,destroy:w,regl:r,gl:T,canvas:T.canvas,groups:k}),E;function E(C){C?L(C):C===null&&w(),A()}function A(C){if(typeof C=="number")return b(C);C&&!Array.isArray(C)&&(C=[C]),r._refresh(),k.forEach(function(S,P){S&&(C&&(C[P]?S.draw=!0:S.draw=!1),S.draw?b(P):S.draw=!0)})}function b(C){typeof C=="number"&&(C=k[C]),C!=null&&C&&C.count&&C.color&&C.opacity&&C.positions&&C.positions.length>1&&(C.scaleRatio=[C.scale[0]*C.viewport.width,C.scale[1]*C.viewport.height],f(C),C.after&&C.after(C))}function L(C){if(C){C.length!=null?typeof C[0]=="number"&&(C=[{positions:C}]):Array.isArray(C)||(C=[C]);var S=0,P=0;if(E.groups=k=C.map(function(Z,Y){var N=k[Y];return Z&&(typeof Z=="function"?Z={after:Z}:typeof Z[0]=="number"&&(Z={positions:Z}),Z=u(Z,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),N||(k[Y]=N={id:Y,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},Z=e({},_,Z)),p(N,Z,[{lineWidth:function(J){return .5*+J},capSize:function(J){return .5*+J},opacity:parseFloat,errors:function(J){return J=l(J),P+=J.length,J},positions:function(J,D){return J=l(J,"float64"),D.count=Math.floor(J.length/2),D.bounds=t(J,2),D.offset=S,S+=D.count,J}},{color:function(J,D){var U=D.count;if(J||(J="transparent"),!Array.isArray(J)||typeof J[0]=="number"){var G=J;J=Array(U);for(var $=0;$<U;$++)J[$]=G}if(J.length<U)throw Error("Not enough colors");for(var K=new Uint8Array(4*U),re=0;re<U;re++){var ne=h(J[re],"uint8");K.set(ne,4*re)}return K},range:function(J,D,U){var G=D.bounds;return J||(J=G),D.scale=[1/(J[2]-J[0]),1/(J[3]-J[1])],D.translate=[-J[0],-J[1]],D.scaleFract=n(D.scale),D.translateFract=n(D.translate),J},viewport:function(J){var D;return Array.isArray(J)?D={x:J[0],y:J[1],width:J[2]-J[0],height:J[3]-J[1]}:J?(D={x:J.x||J.left||0,y:J.y||J.top||0},J.right?D.width=J.right-D.x:D.width=J.w||J.width||0,J.bottom?D.height=J.bottom-D.y:D.height=J.h||J.height||0):D={x:0,y:0,width:T.drawingBufferWidth,height:T.drawingBufferHeight},D}}])),N}),S||P){var z=k.reduce(function(Z,Y,N){return Z+(Y?Y.count:0)},0),F=new Float64Array(2*z),q=new Uint8Array(4*z),W=new Float32Array(4*z);k.forEach(function(Z,Y){if(Z){var N=Z.positions,J=Z.count,D=Z.offset,U=Z.color,G=Z.errors;J&&(q.set(U,4*D),W.set(G,4*D),F.set(N,2*D))}});var X=a(F);d(X);var Q=n(F,X);g(Q),m(q),y(W)}}}function w(){d.destroy(),g.destroy(),m.destroy(),y.destroy(),v.destroy()}};var s=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":76,"color-normalize":131,"flatten-vertex-data":252,"object-assign":487,"pick-by-alias":498,"to-float32":599,"update-diff":621}],537:[function(i,B,V){var t=i("color-normalize"),h=i("array-bounds"),p=i("object-assign"),u=i("glslify"),e=i("pick-by-alias"),l=i("flatten-vertex-data"),o=i("earcut"),a=i("array-normalize"),n=i("to-float32"),s=n.float32,r=n.fract32,c=i("es6-weak-map"),f=i("parse-rect"),d=i("array-find-index");function g(m,y){if(!(this instanceof g))return new g(m,y);if(typeof m=="function"?(y||(y={}),y.regl=m):y=m,y.length&&(y.positions=y),!(m=y.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=m._gl,this.regl=m,this.passes=[],this.shaders=g.shaders.has(m)?g.shaders.get(m):g.shaders.set(m,g.createShaders(m)).get(m),this.update(y)}B.exports=g,g.dashMult=2,g.maxPatternLength=256,g.precisionThreshold=3e6,g.maxPoints=1e4,g.maxLines=2048,g.shaders=new c,g.createShaders=function(m){var y,v=m.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),T={primitive:"triangle strip",instances:m.prop("count"),count:4,offset:0,uniforms:{miterMode:function(k,E){return E.join==="round"?2:1},miterLimit:m.prop("miterLimit"),scale:m.prop("scale"),scaleFract:m.prop("scaleFract"),translateFract:m.prop("translateFract"),translate:m.prop("translate"),thickness:m.prop("thickness"),dashPattern:m.prop("dashTexture"),opacity:m.prop("opacity"),pixelRatio:m.context("pixelRatio"),id:m.prop("id"),dashSize:m.prop("dashLength"),viewport:function(k,E){return[E.viewport.x,E.viewport.y,k.viewportWidth,k.viewportHeight]},depth:m.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(k,E){return!E.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:m.prop("viewport")},viewport:m.prop("viewport")},_=m(p({vert:u([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:u([`precision highp float;
#define GLSLIFY 1

uniform sampler2D dashPattern;

uniform float dashSize, pixelRatio, thickness, opacity, id;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;
	float dash = texture2D(dashPattern, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:v,divisor:0,stride:8,offset:0},lineTop:{buffer:v,divisor:0,stride:8,offset:4},aCoord:{buffer:m.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:m.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:m.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:m.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:m.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},T));try{y=m(p({cull:{enable:!0,face:"back"},vert:u([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:u([`precision highp float;
#define GLSLIFY 1

uniform sampler2D dashPattern;
uniform float dashSize, pixelRatio, thickness, opacity, id, miterMode;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;
	float dash = texture2D(dashPattern, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:v,divisor:0,stride:8,offset:0},lineTop:{buffer:v,divisor:0,stride:8,offset:4},aColor:{buffer:m.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:m.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:m.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:m.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:m.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:m.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},T))}catch{y=_}return{fill:m({primitive:"triangle",elements:function(k,E){return E.triangles},offset:0,vert:u([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:u([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:m.prop("scale"),color:m.prop("fill"),scaleFract:m.prop("scaleFract"),translateFract:m.prop("translateFract"),translate:m.prop("translate"),opacity:m.prop("opacity"),pixelRatio:m.context("pixelRatio"),id:m.prop("id"),viewport:function(k,E){return[E.viewport.x,E.viewport.y,k.viewportWidth,k.viewportHeight]}},attributes:{position:{buffer:m.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:m.prop("positionFractBuffer"),stride:8,offset:8}},blend:T.blend,depth:{enable:!1},scissor:T.scissor,stencil:T.stencil,viewport:T.viewport}),rect:_,miter:y}},g.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},g.prototype.render=function(){for(var m,y=[],v=arguments.length;v--;)y[v]=arguments[v];y.length&&(m=this).update.apply(m,y),this.draw()},g.prototype.draw=function(){for(var m=this,y=[],v=arguments.length;v--;)y[v]=arguments[v];return(y.length?y:this.passes).forEach(function(T,_){var k;if(T&&Array.isArray(T))return(k=m).draw.apply(k,T);typeof T=="number"&&(T=m.passes[T]),T&&T.count>1&&T.opacity&&(m.regl._refresh(),T.fill&&T.triangles&&T.triangles.length>2&&m.shaders.fill(T),T.thickness&&(T.scale[0]*T.viewport.width>g.precisionThreshold||T.scale[1]*T.viewport.height>g.precisionThreshold||T.join==="rect"||!T.join&&(T.thickness<=2||T.count>=g.maxPoints)?m.shaders.rect(T):m.shaders.miter(T)))}),this},g.prototype.update=function(m){var y=this;if(m){m.length!=null?typeof m[0]=="number"&&(m=[{positions:m}]):Array.isArray(m)||(m=[m]);var v=this.regl,T=this.gl;if(m.forEach(function(b,L){var w=y.passes[L];if(b!==void 0)if(b!==null){if(typeof b[0]=="number"&&(b={positions:b}),b=e(b,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),w||(y.passes[L]=w={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:v.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:v.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:v.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:v.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},b=p({},g.defaults,b)),b.thickness!=null&&(w.thickness=parseFloat(b.thickness)),b.opacity!=null&&(w.opacity=parseFloat(b.opacity)),b.miterLimit!=null&&(w.miterLimit=parseFloat(b.miterLimit)),b.overlay!=null&&(w.overlay=!!b.overlay,L<g.maxLines&&(w.depth=2*(g.maxLines-1-L%g.maxLines)/g.maxLines-1)),b.join!=null&&(w.join=b.join),b.hole!=null&&(w.hole=b.hole),b.fill!=null&&(w.fill=b.fill?t(b.fill,"uint8"):null),b.viewport!=null&&(w.viewport=f(b.viewport)),w.viewport||(w.viewport=f([T.drawingBufferWidth,T.drawingBufferHeight])),b.close!=null&&(w.close=b.close),b.positions===null&&(b.positions=[]),b.positions){var C,S;if(b.positions.x&&b.positions.y){var P=b.positions.x,z=b.positions.y;S=w.count=Math.max(P.length,z.length),C=new Float64Array(2*S);for(var F=0;F<S;F++)C[2*F]=P[F],C[2*F+1]=z[F]}else C=l(b.positions,"float64"),S=w.count=Math.floor(C.length/2);var q=w.bounds=h(C,2);if(w.fill){for(var W=[],X={},Q=0,Z=0,Y=0,N=w.count;Z<N;Z++){var J=C[2*Z],D=C[2*Z+1];isNaN(J)||isNaN(D)||J==null||D==null?(J=C[2*Q],D=C[2*Q+1],X[Z]=Q):Q=Z,W[Y++]=J,W[Y++]=D}if(b.splitNull){w.count-1 in X||(X[w.count]=w.count-1);var U=Object.keys(X).map(Number).sort(function(Mt,Jt){return Mt-Jt}),G=[],$=0,K=w.hole!=null?w.hole[0]:null;if(K!=null){var re=d(U,function(Mt){return Mt>=K});(U=U.slice(0,re)).push(K)}for(var ne=function(Mt){var Jt=W.slice(2*$,2*U[Mt]).concat(K?W.slice(2*K):[]),$t=(w.hole||[]).map(function(Ge){return Ge-K+(U[Mt]-$)}),je=o(Jt,$t);je=je.map(function(Ge){return Ge+$+(Ge+$<U[Mt]?0:K-U[Mt])}),G.push.apply(G,je),$=U[Mt]+1},ae=0;ae<U.length;ae++)ne(ae);for(var ie=0,he=G.length;ie<he;ie++)X[G[ie]]!=null&&(G[ie]=X[G[ie]]);w.triangles=G}else{for(var se=o(W,w.hole||[]),de=0,ce=se.length;de<ce;de++)X[se[de]]!=null&&(se[de]=X[se[de]]);w.triangles=se}}var ve=new Float64Array(C);a(ve,2,q);var Ee=new Float64Array(2*S+6);w.close?C[0]===C[2*S-2]&&C[1]===C[2*S-1]?(Ee[0]=ve[2*S-4],Ee[1]=ve[2*S-3]):(Ee[0]=ve[2*S-2],Ee[1]=ve[2*S-1]):(Ee[0]=ve[0],Ee[1]=ve[1]),Ee.set(ve,2),w.close?C[0]===C[2*S-2]&&C[1]===C[2*S-1]?(Ee[2*S+2]=ve[2],Ee[2*S+3]=ve[3],w.count-=1):(Ee[2*S+2]=ve[0],Ee[2*S+3]=ve[1],Ee[2*S+4]=ve[2],Ee[2*S+5]=ve[3]):(Ee[2*S+2]=ve[2*S-2],Ee[2*S+3]=ve[2*S-1],Ee[2*S+4]=ve[2*S-2],Ee[2*S+5]=ve[2*S-1]);var Le=s(Ee);w.positionBuffer(Le);var Te=r(Ee,Le);w.positionFractBuffer(Te)}if(b.range?w.range=b.range:w.range||(w.range=w.bounds),(b.range||b.positions)&&w.count){var xe=w.bounds,fe=xe[2]-xe[0],ge=xe[3]-xe[1],ke=w.range[2]-w.range[0],Me=w.range[3]-w.range[1];w.scale=[fe/ke,ge/Me],w.translate=[-w.range[0]/ke+xe[0]/ke||0,-w.range[1]/Me+xe[1]/Me||0],w.scaleFract=r(w.scale),w.translateFract=r(w.translate)}if(b.dashes){var Se,De=0;if(!b.dashes||b.dashes.length<2)De=1,Se=new Uint8Array([255,255,255,255,255,255,255,255]);else{De=0;for(var Be=0;Be<b.dashes.length;++Be)De+=b.dashes[Be];Se=new Uint8Array(De*g.dashMult);for(var We=0,Qe=255,Oe=0;Oe<2;Oe++)for(var Ue=0;Ue<b.dashes.length;++Ue){for(var Xe=0,Ye=b.dashes[Ue]*g.dashMult*.5;Xe<Ye;++Xe)Se[We++]=Qe;Qe^=255}}w.dashLength=De,w.dashTexture({channels:1,data:Se,width:Se.length,height:1,mag:"linear",min:"linear"},0,0)}if(b.color){var $e=w.count,it=b.color;it||(it="transparent");var ot=new Uint8Array(4*$e+4);if(Array.isArray(it)&&typeof it[0]!="number"){for(var Et=0;Et<$e;Et++){var mt=t(it[Et],"uint8");ot.set(mt,4*Et)}ot.set(t(it[0],"uint8"),4*$e)}else for(var tt=t(it,"uint8"),Ke=0;Ke<$e+1;Ke++)ot.set(tt,4*Ke);w.colorBuffer({usage:"dynamic",type:"uint8",data:ot})}}else y.passes[L]=null}),m.length<this.passes.length){for(var _=m.length;_<this.passes.length;_++){var k=this.passes[_];k&&(k.colorBuffer.destroy(),k.positionBuffer.destroy(),k.dashTexture.destroy())}this.passes.length=m.length}for(var E=[],A=0;A<this.passes.length;A++)this.passes[A]!==null&&E.push(this.passes[A]);return this.passes=E,this}},g.prototype.destroy=function(){return this.passes.forEach(function(m){m.colorBuffer.destroy(),m.positionBuffer.destroy(),m.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":76,"array-find-index":77,"array-normalize":78,"color-normalize":131,earcut:186,"es6-weak-map":241,"flatten-vertex-data":252,glslify:442,"object-assign":487,"parse-rect":492,"pick-by-alias":498,"to-float32":599}],538:[function(i,B,V){function t(_,k){return function(E){if(Array.isArray(E))return E}(_)||function(E,A){var b=E==null?null:typeof Symbol<"u"&&E[Symbol.iterator]||E["@@iterator"];if(b!=null){var L,w,C=[],S=!0,P=!1;try{for(b=b.call(E);!(S=(L=b.next()).done)&&(C.push(L.value),!A||C.length!==A);S=!0);}catch(z){P=!0,w=z}finally{try{S||b.return==null||b.return()}finally{if(P)throw w}}return C}}(_,k)||p(_,k)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function h(_){return function(k){if(Array.isArray(k))return u(k)}(_)||function(k){if(typeof Symbol<"u"&&k[Symbol.iterator]!=null||k["@@iterator"]!=null)return Array.from(k)}(_)||p(_)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function p(_,k){if(_){if(typeof _=="string")return u(_,k);var E=Object.prototype.toString.call(_).slice(8,-1);return E==="Object"&&_.constructor&&(E=_.constructor.name),E==="Map"||E==="Set"?Array.from(_):E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E)?u(_,k):void 0}}function u(_,k){(k==null||k>_.length)&&(k=_.length);for(var E=0,A=new Array(k);E<k;E++)A[E]=_[E];return A}var e=i("color-normalize"),l=i("array-bounds"),o=i("color-id"),a=i("@plotly/point-cluster"),n=i("object-assign"),s=i("glslify"),r=i("pick-by-alias"),c=i("update-diff"),f=i("flatten-vertex-data"),d=i("is-iexplorer"),g=i("to-float32"),m=i("parse-rect"),y=v;function v(_,k){var E=this;if(!(this instanceof v))return new v(_,k);typeof _=="function"?(k||(k={}),k.regl=_):(k=_,_=null),k&&k.length&&(k.positions=k);var A,b=(_=k.regl)._gl,L=[];this.tooManyColors=d,A=_.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),n(this,{regl:_,gl:b,groups:[],markerCache:[null],markerTextures:[null],palette:L,paletteIds:{},paletteTexture:A,maxColors:255,maxSize:100,canvas:b.canvas}),this.update(k);var w={uniforms:{constPointSize:!!k.constPointSize,pixelRatio:_.context("pixelRatio"),palette:A,paletteSize:function(P,z){return[E.tooManyColors?0:255,A.height]},scale:_.prop("scale"),scaleFract:_.prop("scaleFract"),translate:_.prop("translate"),translateFract:_.prop("translateFract"),opacity:_.prop("opacity"),marker:_.prop("markerTexture")},attributes:{x:function(P,z){return z.xAttr||{buffer:z.positionBuffer,stride:8,offset:0}},y:function(P,z){return z.yAttr||{buffer:z.positionBuffer,stride:8,offset:4}},xFract:function(P,z){return z.xAttr?{constant:[0,0]}:{buffer:z.positionFractBuffer,stride:8,offset:0}},yFract:function(P,z){return z.yAttr?{constant:[0,0]}:{buffer:z.positionFractBuffer,stride:8,offset:4}},size:function(P,z){return z.size.length?{buffer:z.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*z.size/E.maxSize)]}},borderSize:function(P,z){return z.borderSize.length?{buffer:z.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*z.borderSize/E.maxSize)]}},colorId:function(P,z){return z.color.length?{buffer:z.colorBuffer,stride:E.tooManyColors?8:4,offset:0}:{constant:E.tooManyColors?L.slice(4*z.color,4*z.color+4):[z.color]}},borderColorId:function(P,z){return z.borderColor.length?{buffer:z.colorBuffer,stride:E.tooManyColors?8:4,offset:E.tooManyColors?4:2}:{constant:E.tooManyColors?L.slice(4*z.borderColor,4*z.borderColor+4):[z.borderColor]}},isActive:function(P,z){return z.activation===!0?{constant:[1]}:z.activation?z.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:_.prop("viewport")},viewport:_.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:_.prop("elements"),count:_.prop("count"),offset:_.prop("offset"),primitive:"points"},C=n({},w);C.frag=s([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

uniform sampler2D marker;
uniform float opacity;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(marker, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),C.vert=s([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform float pixelRatio;
uniform bool constPointSize;
uniform sampler2D palette;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(palette,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=_(C);var S=n({},w);S.frag=s([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;

uniform float opacity;
varying float fragBorderRadius, fragWidth;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),S.vert=s([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio;
uniform bool constPointSize;
uniform sampler2D palette;
uniform vec2 paletteSize;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(palette,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),d&&(S.frag=S.frag.replace("smoothstep","smoothStep"),C.frag=C.frag.replace("smoothstep","smoothStep")),this.drawCircle=_(S)}v.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},v.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},v.prototype.draw=function(){for(var _=this,k=arguments.length,E=new Array(k),A=0;A<k;A++)E[A]=arguments[A];var b=this.groups;if(E.length===1&&Array.isArray(E[0])&&(E[0][0]===null||Array.isArray(E[0][0]))&&(E=E[0]),this.regl._refresh(),E.length)for(var L=0;L<E.length;L++)this.drawItem(L,E[L]);else b.forEach(function(w,C){_.drawItem(C)});return this},v.prototype.drawItem=function(_,k){var E=this.groups,A=E[_];if(typeof k=="number"&&(_=k,A=E[k],k=null),A&&A.count&&A.opacity){A.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,A,k));for(var b=[],L=1;L<A.activation.length;L++)A.activation[L]&&(A.activation[L]===!0||A.activation[L].data.length)&&b.push.apply(b,h(this.getMarkerDrawOptions(L,A,k)));b.length&&this.drawMarker(b)}},v.prototype.getMarkerDrawOptions=function(_,k,E){var A=k.range,b=k.tree,L=k.viewport,w=k.activation,C=k.selectionBuffer,S=k.count;if(this.regl,!b)return E?[n({},k,{markerTexture:this.markerTextures[_],activation:w[_],count:E.length,elements:E,offset:0})]:[n({},k,{markerTexture:this.markerTextures[_],activation:w[_],offset:0})];var P=[],z=b.range(A,{lod:!0,px:[(A[2]-A[0])/L.width,(A[3]-A[1])/L.height]});if(E){for(var F=w[_].data,q=new Uint8Array(S),W=0;W<E.length;W++){var X=E[W];q[X]=F?F[X]:1}C.subdata(q)}for(var Q=z.length;Q--;){var Z=t(z[Q],2),Y=Z[0],N=Z[1];P.push(n({},k,{markerTexture:this.markerTextures[_],activation:E?C:w[_],offset:Y,count:N-Y}))}return P},v.prototype.update=function(){for(var _=this,k=arguments.length,E=new Array(k),A=0;A<k;A++)E[A]=arguments[A];if(E.length){E.length===1&&Array.isArray(E[0])&&(E=E[0]);var b=this.groups,L=this.gl,w=this.regl,C=this.maxSize,S=this.maxColors,P=this.palette;this.groups=b=E.map(function(z,F){var q=b[F];if(z===void 0)return q;z===null?z={positions:null}:typeof z=="function"?z={ondraw:z}:typeof z[0]=="number"&&(z={positions:z}),(z=r(z,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions===null&&(z.positions=[]),z.tooManyColors!=null&&(_.tooManyColors=z.tooManyColors),q||(b[F]=q={id:F,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:w.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:w.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:w.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:w.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:w.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},z=n({},v.defaults,z)),z.positions&&!("marker"in z)&&(z.marker=q.marker,delete q.marker),z.marker&&!("positions"in z)&&(z.positions=q.positions,delete q.positions);var W=0,X=0;if(c(q,z,[{snap:!0,size:function(ce,ve){return ce==null&&(ce=v.defaults.size),W+=ce&&ce.length?1:0,ce},borderSize:function(ce,ve){return ce==null&&(ce=v.defaults.borderSize),W+=ce&&ce.length?1:0,ce},opacity:parseFloat,color:function(ce,ve){return ce==null&&(ce=v.defaults.color),ce=_.updateColor(ce),X++,ce},borderColor:function(ce,ve){return ce==null&&(ce=v.defaults.borderColor),ce=_.updateColor(ce),X++,ce},bounds:function(ce,ve,Ee){return"range"in Ee||(Ee.range=null),ce},positions:function(ce,ve,Ee){var Le=ve.snap,Te=ve.positionBuffer,xe=ve.positionFractBuffer,fe=ve.selectionBuffer;if(ce.x||ce.y)return ce.x.length?ve.xAttr={buffer:w.buffer(ce.x),offset:0,stride:4,count:ce.x.length}:ve.xAttr={buffer:ce.x.buffer,offset:4*ce.x.offset||0,stride:4*(ce.x.stride||1),count:ce.x.count},ce.y.length?ve.yAttr={buffer:w.buffer(ce.y),offset:0,stride:4,count:ce.y.length}:ve.yAttr={buffer:ce.y.buffer,offset:4*ce.y.offset||0,stride:4*(ce.y.stride||1),count:ce.y.count},ve.count=Math.max(ve.xAttr.count,ve.yAttr.count),ce;ce=f(ce,"float64");var ge=ve.count=Math.floor(ce.length/2),ke=ve.bounds=ge?l(ce,2):null;if(Ee.range||ve.range||(delete ve.range,Ee.range=ke),Ee.marker||ve.marker||(delete ve.marker,Ee.marker=null),Le&&(Le===!0||ge>Le)?ve.tree=a(ce,{bounds:ke}):Le&&Le.length&&(ve.tree=Le),ve.tree){var Me={primitive:"points",usage:"static",data:ve.tree,type:"uint32"};ve.elements?ve.elements(Me):ve.elements=w.elements(Me)}var Se=g.float32(ce);return Te({data:Se,usage:"dynamic"}),xe({data:g.fract32(ce,Se),usage:"dynamic"}),fe({data:new Uint8Array(ge),type:"uint8",usage:"stream"}),ce}},{marker:function(ce,ve,Ee){var Le=ve.activation;if(Le.forEach(function(Se){return Se&&Se.destroy&&Se.destroy()}),Le.length=0,ce&&typeof ce[0]!="number"){for(var Te=[],xe=0,fe=Math.min(ce.length,ve.count);xe<fe;xe++){var ge=_.addMarker(ce[xe]);Te[ge]||(Te[ge]=new Uint8Array(ve.count)),Te[ge][xe]=1}for(var ke=0;ke<Te.length;ke++)if(Te[ke]){var Me={data:Te[ke],type:"uint8",usage:"static"};Le[ke]?Le[ke](Me):Le[ke]=w.buffer(Me),Le[ke].data=Te[ke]}}else Le[_.addMarker(ce)]=!0;return ce},range:function(ce,ve,Ee){var Le=ve.bounds;if(Le)return ce||(ce=Le),ve.scale=[1/(ce[2]-ce[0]),1/(ce[3]-ce[1])],ve.translate=[-ce[0],-ce[1]],ve.scaleFract=g.fract(ve.scale),ve.translateFract=g.fract(ve.translate),ce},viewport:function(ce){return m(ce||[L.drawingBufferWidth,L.drawingBufferHeight])}}]),W){var Q=q,Z=Q.count,Y=Q.size,N=Q.borderSize,J=Q.sizeBuffer,D=new Uint8Array(2*Z);if(Y.length||N.length)for(var U=0;U<Z;U++)D[2*U]=Math.round(255*(Y[U]==null?Y:Y[U])/C),D[2*U+1]=Math.round(255*(N[U]==null?N:N[U])/C);J({data:D,usage:"dynamic"})}if(X){var G,$=q,K=$.count,re=$.color,ne=$.borderColor,ae=$.colorBuffer;if(_.tooManyColors){if(re.length||ne.length){G=new Uint8Array(8*K);for(var ie=0;ie<K;ie++){var he=re[ie];G[8*ie]=P[4*he],G[8*ie+1]=P[4*he+1],G[8*ie+2]=P[4*he+2],G[8*ie+3]=P[4*he+3];var se=ne[ie];G[8*ie+4]=P[4*se],G[8*ie+5]=P[4*se+1],G[8*ie+6]=P[4*se+2],G[8*ie+7]=P[4*se+3]}}}else if(re.length||ne.length){G=new Uint8Array(4*K+2);for(var de=0;de<K;de++)re[de]!=null&&(G[4*de]=re[de]%S,G[4*de+1]=Math.floor(re[de]/S)),ne[de]!=null&&(G[4*de+2]=ne[de]%S,G[4*de+3]=Math.floor(ne[de]/S))}ae({data:G||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return q})}},v.prototype.addMarker=function(_){var k,E=this.markerTextures,A=this.regl,b=this.markerCache,L=_==null?0:b.indexOf(_);if(L>=0)return L;if(_ instanceof Uint8Array||_ instanceof Uint8ClampedArray)k=_;else{k=new Uint8Array(_.length);for(var w=0,C=_.length;w<C;w++)k[w]=255*_[w]}var S=Math.floor(Math.sqrt(k.length));return L=E.length,b.push(_),E.push(A.texture({channels:1,data:k,radius:S,mag:"linear",min:"linear"})),L},v.prototype.updateColor=function(_){var k=this.paletteIds,E=this.palette,A=this.maxColors;Array.isArray(_)||(_=[_]);var b=[];if(typeof _[0]=="number"){var L=[];if(Array.isArray(_))for(var w=0;w<_.length;w+=4)L.push(_.slice(w,w+4));else for(var C=0;C<_.length;C+=4)L.push(_.subarray(C,C+4));_=L}for(var S=0;S<_.length;S++){var P=_[S];P=e(P,"uint8");var z=o(P,!1);if(k[z]==null){var F=E.length;k[z]=Math.floor(F/4),E[F]=P[0],E[F+1]=P[1],E[F+2]=P[2],E[F+3]=P[3]}b[S]=k[z]}return!this.tooManyColors&&E.length>4*A&&(this.tooManyColors=!0),this.updatePalette(E),b.length===1?b[0]:b},v.prototype.updatePalette=function(_){if(!this.tooManyColors){var k=this.maxColors,E=this.paletteTexture,A=Math.ceil(.25*_.length/k);if(A>1)for(var b=.25*(_=_.slice()).length%k;b<A*k;b++)_.push(0,0,0,0);E.height<A&&E.resize(k,A),E.subimage({width:Math.min(.25*_.length,k),height:A,data:_},0,0)}},v.prototype.destroy=function(){return this.groups.forEach(function(_){_.sizeBuffer.destroy(),_.positionBuffer.destroy(),_.positionFractBuffer.destroy(),_.colorBuffer.destroy(),_.activation.forEach(function(k){return k&&k.destroy&&k.destroy()}),_.selectionBuffer.destroy(),_.elements&&_.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(_){return _&&_.destroy&&_.destroy()}),this};var T=i("object-assign");B.exports=function(_,k){var E=new y(_,k),A=E.render.bind(E);return T(A,{render:A,update:E.update.bind(E),draw:E.draw.bind(E),destroy:E.destroy.bind(E),regl:E.regl,gl:E.gl,canvas:E.gl.canvas,groups:E.groups,markers:E.markerCache,palette:E.palette}),A}},{"@plotly/point-cluster":59,"array-bounds":76,"color-id":129,"color-normalize":131,"flatten-vertex-data":252,glslify:442,"is-iexplorer":454,"object-assign":487,"parse-rect":492,"pick-by-alias":498,"to-float32":599,"update-diff":621}],539:[function(i,B,V){var t=i("regl-scatter2d"),h=i("pick-by-alias"),p=i("array-bounds"),u=i("raf"),e=i("array-range"),l=i("parse-rect"),o=i("flatten-vertex-data");function a(c,f){if(!(this instanceof a))return new a(c);this.traces=[],this.passes={},this.regl=c,this.scatter=t(c),this.canvas=this.scatter.canvas}function n(c,f,d){return(c.id!=null?c.id:c)<<16|(255&f)<<8|255&d}function s(c,f,d){var g,m,y,v,T=c[f],_=c[d];return T.length>2?(T[0],T[2],g=T[1],m=T[3]):T.length?(g=T[0],m=T[1]):(T.x,g=T.y,T.x+T.width,m=T.y+T.height),_.length>2?(y=_[0],v=_[2],_[1],_[3]):_.length?(y=_[0],v=_[1]):(y=_.x,_.y,v=_.x+_.width,_.y+_.height),[y,g,v,m]}function r(c){if(typeof c=="number")return[c,c,c,c];if(c.length===2)return[c[0],c[1],c[0],c[1]];var f=l(c);return[f.x,f.y,f.x+f.width,f.y+f.height]}B.exports=a,a.prototype.render=function(){for(var c,f=this,d=[],g=arguments.length;g--;)d[g]=arguments[g];return d.length&&(c=this).update.apply(c,d),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=u(function(){f.draw(),f.dirty=!0,f.planned=null})):(this.draw(),this.dirty=!0,u(function(){f.dirty=!1})),this)},a.prototype.update=function(){for(var c,f=[],d=arguments.length;d--;)f[d]=arguments[d];if(f.length){for(var g=0;g<f.length;g++)this.updateItem(g,f[g]);this.traces=this.traces.filter(Boolean);for(var m=[],y=0,v=0;v<this.traces.length;v++){for(var T=this.traces[v],_=this.traces[v].passes,k=0;k<_.length;k++)m.push(this.passes[_[k]]);T.passOffset=y,y+=T.passes.length}return(c=this.scatter).update.apply(c,m),this}},a.prototype.updateItem=function(c,f){var d=this.regl;if(f===null)return this.traces[c]=null,this;if(!f)return this;var g,m=h(f,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),y=this.traces[c]||(this.traces[c]={id:c,buffer:d.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:l([d._gl.drawingBufferWidth,d._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(m.color!=null&&(y.color=m.color),m.size!=null&&(y.size=m.size),m.marker!=null&&(y.marker=m.marker),m.borderColor!=null&&(y.borderColor=m.borderColor),m.borderSize!=null&&(y.borderSize=m.borderSize),m.opacity!=null&&(y.opacity=m.opacity),m.viewport&&(y.viewport=l(m.viewport)),m.diagonal!=null&&(y.diagonal=m.diagonal),m.upper!=null&&(y.upper=m.upper),m.lower!=null&&(y.lower=m.lower),m.data){y.buffer(o(m.data)),y.columns=m.data.length,y.count=m.data[0].length,y.bounds=[];for(var v=0;v<y.columns;v++)y.bounds[v]=p(m.data[v],1)}m.range&&(y.range=m.range,g=y.range&&typeof y.range[0]!="number"),m.domain&&(y.domain=m.domain);var T=!1;m.padding!=null&&(Array.isArray(m.padding)&&m.padding.length===y.columns&&typeof m.padding[m.padding.length-1]=="number"?(y.padding=m.padding.map(r),T=!0):y.padding=r(m.padding));var _=y.columns,k=y.count,E=y.viewport.width,A=y.viewport.height,b=y.viewport.x,L=y.viewport.y,w=E/_,C=A/_;y.passes=[];for(var S=0;S<_;S++)for(var P=0;P<_;P++)if((y.diagonal||P!==S)&&(y.upper||!(S>P))&&(y.lower||!(S<P))){var z=n(y.id,S,P),F=this.passes[z]||(this.passes[z]={});if(m.data&&(m.transpose?F.positions={x:{buffer:y.buffer,offset:P,count:k,stride:_},y:{buffer:y.buffer,offset:S,count:k,stride:_}}:F.positions={x:{buffer:y.buffer,offset:P*k,count:k},y:{buffer:y.buffer,offset:S*k,count:k}},F.bounds=s(y.bounds,S,P)),m.domain||m.viewport||m.data){var q=T?s(y.padding,S,P):y.padding;if(y.domain){var W=s(y.domain,S,P),X=W[0],Q=W[1],Z=W[2],Y=W[3];F.viewport=[b+X*E+q[0],L+Q*A+q[1],b+Z*E-q[2],L+Y*A-q[3]]}else F.viewport=[b+P*w+w*q[0],L+S*C+C*q[1],b+(P+1)*w-w*q[2],L+(S+1)*C-C*q[3]]}m.color&&(F.color=y.color),m.size&&(F.size=y.size),m.marker&&(F.marker=y.marker),m.borderSize&&(F.borderSize=y.borderSize),m.borderColor&&(F.borderColor=y.borderColor),m.opacity&&(F.opacity=y.opacity),m.range&&(F.range=g?s(y.range,S,P):y.range||F.bounds),y.passes.push(z)}return this},a.prototype.draw=function(){for(var c,f=[],d=arguments.length;d--;)f[d]=arguments[d];if(f.length){for(var g=[],m=0;m<f.length;m++)if(typeof f[m]=="number"){var y=this.traces[f[m]],v=y.passes,T=y.passOffset;g.push.apply(g,e(T,T+v.length))}else if(f[m].length){var _=f[m],k=this.traces[m],E=k.passes,A=k.passOffset;E=E.map(function(b,L){g[A+L]=_})}(c=this.scatter).draw.apply(c,g)}else this.scatter.draw();return this},a.prototype.destroy=function(){return this.traces.forEach(function(c){c.buffer&&c.buffer.destroy&&c.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":76,"array-range":79,"flatten-vertex-data":252,"parse-rect":492,"pick-by-alias":498,raf:530,"regl-scatter2d":538}],540:[function(i,B,V){(function(t,h){typeof V=="object"&&B!==void 0?B.exports=h():t.createREGL=h()})(this,function(){function t(Ie,be){this.id=$++,this.type=Ie,this.data=be}function h(Ie){return"["+function be(Ae){if(Ae.length===0)return[];var Pe=Ae.charAt(0),ze=Ae.charAt(Ae.length-1);if(1<Ae.length&&Pe===ze&&(Pe==='"'||Pe==="'"))return['"'+Ae.substr(1,Ae.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Pe=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Ae))return be(Ae.substr(0,Pe.index)).concat(be(Pe[1])).concat(be(Ae.substr(Pe.index+Pe[0].length)));if((Pe=Ae.split(".")).length===1)return['"'+Ae.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(Ae=[],ze=0;ze<Pe.length;++ze)Ae=Ae.concat(be(Pe[ze]));return Ae}(Ie).join("][")+"]"}function p(Ie){return typeof Ie=="string"?Ie.split():Ie}function u(Ie){return typeof Ie=="string"?document.querySelector(Ie):Ie}function e(Ie){var be,Ae,Pe,ze,qe=Ie||{};Ie={};var ht=[],at=[],nt=typeof window>"u"?1:window.devicePixelRatio,xt=!1,Lt=function(St){},bt=function(){};if(typeof qe=="string"?be=document.querySelector(qe):typeof qe=="object"&&(typeof qe.nodeName=="string"&&typeof qe.appendChild=="function"&&typeof qe.getBoundingClientRect=="function"?be=qe:typeof qe.drawArrays=="function"||typeof qe.drawElements=="function"?Pe=(ze=qe).canvas:("gl"in qe?ze=qe.gl:"canvas"in qe?Pe=u(qe.canvas):"container"in qe&&(Ae=u(qe.container)),"attributes"in qe&&(Ie=qe.attributes),"extensions"in qe&&(ht=p(qe.extensions)),"optionalExtensions"in qe&&(at=p(qe.optionalExtensions)),"onDone"in qe&&(Lt=qe.onDone),"profile"in qe&&(xt=!!qe.profile),"pixelRatio"in qe&&(nt=+qe.pixelRatio))),be&&(be.nodeName.toLowerCase()==="canvas"?Pe=be:Ae=be),!ze){if(!Pe){if(!(be=function(St,st,It){function jt(){var Ce=window.innerWidth,lt=window.innerHeight;St!==document.body&&(Ce=(lt=St.getBoundingClientRect()).right-lt.left,lt=lt.bottom-lt.top),zt.width=It*Ce,zt.height=It*lt,G(zt.style,{width:Ce+"px",height:lt+"px"})}var Ut,zt=document.createElement("canvas");return G(zt.style,{border:0,margin:0,padding:0,top:0,left:0}),St.appendChild(zt),St===document.body&&(zt.style.position="absolute",G(St.style,{margin:0,padding:0})),St!==document.body&&typeof ResizeObserver=="function"?(Ut=new ResizeObserver(function(){setTimeout(jt)})).observe(St):window.addEventListener("resize",jt,!1),jt(),{canvas:zt,onDestroy:function(){Ut?Ut.disconnect():window.removeEventListener("resize",jt),St.removeChild(zt)}}}(Ae||document.body,0,nt)))return null;Pe=be.canvas,bt=be.onDestroy}Ie.premultipliedAlpha===void 0&&(Ie.premultipliedAlpha=!0),ze=function(St,st){function It(jt){try{return St.getContext(jt,st)}catch{return null}}return It("webgl")||It("experimental-webgl")||It("webgl-experimental")}(Pe,Ie)}return ze?{gl:ze,canvas:Pe,container:Ae,extensions:ht,optionalExtensions:at,pixelRatio:nt,profile:xt,onDone:Lt,onDestroy:bt}:(bt(),Lt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function l(Ie,be){for(var Ae=Array(Ie),Pe=0;Pe<Ie;++Pe)Ae[Pe]=be(Pe);return Ae}function o(Ie){var be,Ae;return be=(65535<Ie)<<4,be|=Ae=(255<(Ie>>>=be))<<3,(be|=Ae=(15<(Ie>>>=Ae))<<2)|(Ae=(3<(Ie>>>=Ae))<<1)|Ie>>>Ae>>1}function a(){function Ie(Pe){e:{for(var ze=16;268435456>=ze;ze*=16)if(Pe<=ze){Pe=ze;break e}Pe=0}return 0<(ze=Ae[o(Pe)>>2]).length?ze.pop():new ArrayBuffer(Pe)}function be(Pe){Ae[o(Pe.byteLength)>>2].push(Pe)}var Ae=l(8,function(){return[]});return{alloc:Ie,free:be,allocType:function(Pe,ze){var qe=null;switch(Pe){case 5120:qe=new Int8Array(Ie(ze),0,ze);break;case 5121:qe=new Uint8Array(Ie(ze),0,ze);break;case 5122:qe=new Int16Array(Ie(2*ze),0,ze);break;case 5123:qe=new Uint16Array(Ie(2*ze),0,ze);break;case 5124:qe=new Int32Array(Ie(4*ze),0,ze);break;case 5125:qe=new Uint32Array(Ie(4*ze),0,ze);break;case 5126:qe=new Float32Array(Ie(4*ze),0,ze);break;default:return null}return qe.length!==ze?qe.subarray(0,ze):qe},freeType:function(Pe){be(Pe.buffer)}}}function n(Ie){return!!Ie&&typeof Ie=="object"&&Array.isArray(Ie.shape)&&Array.isArray(Ie.stride)&&typeof Ie.offset=="number"&&Ie.shape.length===Ie.stride.length&&(Array.isArray(Ie.data)||he(Ie.data))}function s(Ie,be,Ae,Pe,ze,qe){for(var ht=0;ht<be;++ht)for(var at=Ie[ht],nt=0;nt<Ae;++nt)for(var xt=at[nt],Lt=0;Lt<Pe;++Lt)ze[qe++]=xt[Lt]}function r(Ie){return 0|ce[Object.prototype.toString.call(Ie)]}function c(Ie,be){for(var Ae=0;Ae<be.length;++Ae)Ie[Ae]=be[Ae]}function f(Ie,be,Ae,Pe,ze,qe,ht){for(var at=0,nt=0;nt<Ae;++nt)for(var xt=0;xt<Pe;++xt)Ie[at++]=be[ze*nt+qe*xt+ht]}function d(Ie,be,Ae,Pe){function ze(bt){this.id=nt++,this.buffer=Ie.createBuffer(),this.type=bt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Ae.profile&&(this.stats={size:0})}function qe(bt,St,st){bt.byteLength=St.byteLength,Ie.bufferData(bt.type,St,st)}function ht(bt,St,st,It,jt,Ut){if(bt.usage=st,Array.isArray(St)){if(bt.dtype=It||5126,0<St.length)if(Array.isArray(St[0])){jt=Te(St);for(var zt=It=1;zt<jt.length;++zt)It*=jt[zt];bt.dimension=It,qe(bt,St=Le(St,jt,bt.dtype),st),Ut?bt.persistentData=St:ae.freeType(St)}else typeof St[0]=="number"?(bt.dimension=jt,c(jt=ae.allocType(bt.dtype,St.length),St),qe(bt,jt,st),Ut?bt.persistentData=jt:ae.freeType(jt)):he(St[0])&&(bt.dimension=St[0].length,bt.dtype=It||r(St[0])||5126,qe(bt,St=Le(St,[St.length,St[0].length],bt.dtype),st),Ut?bt.persistentData=St:ae.freeType(St))}else if(he(St))bt.dtype=It||r(St),bt.dimension=jt,qe(bt,St,st),Ut&&(bt.persistentData=new Uint8Array(new Uint8Array(St.buffer)));else if(n(St)){jt=St.shape;var Ce=St.stride,lt=(zt=St.offset,0),At=0,Bt=0,Ht=0;jt.length===1?(lt=jt[0],At=1,Bt=Ce[0],Ht=0):jt.length===2&&(lt=jt[0],At=jt[1],Bt=Ce[0],Ht=Ce[1]),bt.dtype=It||r(St.data)||5126,bt.dimension=At,f(jt=ae.allocType(bt.dtype,lt*At),St.data,lt,At,Bt,Ht,zt),qe(bt,jt,st),Ut?bt.persistentData=jt:ae.freeType(jt)}else St instanceof ArrayBuffer&&(bt.dtype=5121,bt.dimension=jt,qe(bt,St,st),Ut&&(bt.persistentData=new Uint8Array(new Uint8Array(St))))}function at(bt){be.bufferCount--,Pe(bt),Ie.deleteBuffer(bt.buffer),bt.buffer=null,delete xt[bt.id]}var nt=0,xt={};ze.prototype.bind=function(){Ie.bindBuffer(this.type,this.buffer)},ze.prototype.destroy=function(){at(this)};var Lt=[];return Ae.profile&&(be.getTotalBufferSize=function(){var bt=0;return Object.keys(xt).forEach(function(St){bt+=xt[St].stats.size}),bt}),{create:function(bt,St,st,It){function jt(zt){var Ce=35044,lt=null,At=0,Bt=0,Ht=1;return Array.isArray(zt)||he(zt)||n(zt)||zt instanceof ArrayBuffer?lt=zt:typeof zt=="number"?At=0|zt:zt&&("data"in zt&&(lt=zt.data),"usage"in zt&&(Ce=Ee[zt.usage]),"type"in zt&&(Bt=ve[zt.type]),"dimension"in zt&&(Ht=0|zt.dimension),"length"in zt&&(At=0|zt.length)),Ut.bind(),lt?ht(Ut,lt,Ce,Bt,Ht,It):(At&&Ie.bufferData(Ut.type,At,Ce),Ut.dtype=Bt||5121,Ut.usage=Ce,Ut.dimension=Ht,Ut.byteLength=At),Ae.profile&&(Ut.stats.size=Ut.byteLength*xe[Ut.dtype]),jt}be.bufferCount++;var Ut=new ze(St);return xt[Ut.id]=Ut,st||jt(bt),jt._reglType="buffer",jt._buffer=Ut,jt.subdata=function(zt,Ce){var lt,At=0|(Ce||0);if(Ut.bind(),he(zt)||zt instanceof ArrayBuffer)Ie.bufferSubData(Ut.type,At,zt);else if(Array.isArray(zt)){if(0<zt.length)if(typeof zt[0]=="number"){var Bt=ae.allocType(Ut.dtype,zt.length);c(Bt,zt),Ie.bufferSubData(Ut.type,At,Bt),ae.freeType(Bt)}else(Array.isArray(zt[0])||he(zt[0]))&&(lt=Te(zt),Bt=Le(zt,lt,Ut.dtype),Ie.bufferSubData(Ut.type,At,Bt),ae.freeType(Bt))}else if(n(zt)){lt=zt.shape;var Ht=zt.stride,or=Bt=0,ar=0,Nt=0;lt.length===1?(Bt=lt[0],or=1,ar=Ht[0],Nt=0):lt.length===2&&(Bt=lt[0],or=lt[1],ar=Ht[0],Nt=Ht[1]),lt=Array.isArray(zt.data)?Ut.dtype:r(zt.data),f(lt=ae.allocType(lt,Bt*or),zt.data,Bt,or,ar,Nt,zt.offset),Ie.bufferSubData(Ut.type,At,lt),ae.freeType(lt)}return jt},Ae.profile&&(jt.stats=Ut.stats),jt.destroy=function(){at(Ut)},jt},createStream:function(bt,St){var st=Lt.pop();return st||(st=new ze(bt)),st.bind(),ht(st,St,35040,0,1,!1),st},destroyStream:function(bt){Lt.push(bt)},clear:function(){se(xt).forEach(at),Lt.forEach(at)},getBuffer:function(bt){return bt&&bt._buffer instanceof ze?bt._buffer:null},restore:function(){se(xt).forEach(function(bt){bt.buffer=Ie.createBuffer(),Ie.bindBuffer(bt.type,bt.buffer),Ie.bufferData(bt.type,bt.persistentData||bt.byteLength,bt.usage)})},_initBuffer:ht}}function g(Ie,be,Ae,Pe){function ze(bt){this.id=nt++,at[this.id]=this,this.buffer=bt,this.primType=4,this.type=this.vertCount=0}function qe(bt,St,st,It,jt,Ut,zt){var Ce;if(bt.buffer.bind(),St?((Ce=zt)||he(St)&&(!n(St)||he(St.data))||(Ce=be.oes_element_index_uint?5125:5123),Ae._initBuffer(bt.buffer,St,st,Ce,3)):(Ie.bufferData(34963,Ut,st),bt.buffer.dtype=Ce||5121,bt.buffer.usage=st,bt.buffer.dimension=3,bt.buffer.byteLength=Ut),Ce=zt,!zt){switch(bt.buffer.dtype){case 5121:case 5120:Ce=5121;break;case 5123:case 5122:Ce=5123;break;case 5125:case 5124:Ce=5125}bt.buffer.dtype=Ce}bt.type=Ce,0>(St=jt)&&(St=bt.buffer.byteLength,Ce===5123?St>>=1:Ce===5125&&(St>>=2)),bt.vertCount=St,St=It,0>It&&(St=4,(It=bt.buffer.dimension)===1&&(St=0),It===2&&(St=1),It===3&&(St=4)),bt.primType=St}function ht(bt){Pe.elementsCount--,delete at[bt.id],bt.buffer.destroy(),bt.buffer=null}var at={},nt=0,xt={uint8:5121,uint16:5123};be.oes_element_index_uint&&(xt.uint32=5125),ze.prototype.bind=function(){this.buffer.bind()};var Lt=[];return{create:function(bt,St){function st(Ut){if(Ut)if(typeof Ut=="number")It(Ut),jt.primType=4,jt.vertCount=0|Ut,jt.type=5121;else{var zt=null,Ce=35044,lt=-1,At=-1,Bt=0,Ht=0;Array.isArray(Ut)||he(Ut)||n(Ut)?zt=Ut:("data"in Ut&&(zt=Ut.data),"usage"in Ut&&(Ce=Ee[Ut.usage]),"primitive"in Ut&&(lt=fe[Ut.primitive]),"count"in Ut&&(At=0|Ut.count),"type"in Ut&&(Ht=xt[Ut.type]),"length"in Ut?Bt=0|Ut.length:(Bt=At,Ht===5123||Ht===5122?Bt*=2:Ht!==5125&&Ht!==5124||(Bt*=4))),qe(jt,zt,Ce,lt,At,Bt,Ht)}else It(),jt.primType=4,jt.vertCount=0,jt.type=5121;return st}var It=Ae.create(null,34963,!0),jt=new ze(It._buffer);return Pe.elementsCount++,st(bt),st._reglType="elements",st._elements=jt,st.subdata=function(Ut,zt){return It.subdata(Ut,zt),st},st.destroy=function(){ht(jt)},st},createStream:function(bt){var St=Lt.pop();return St||(St=new ze(Ae.create(null,34963,!0,!1)._buffer)),qe(St,bt,35040,-1,-1,0,0),St},destroyStream:function(bt){Lt.push(bt)},getElements:function(bt){return typeof bt=="function"&&bt._elements instanceof ze?bt._elements:null},clear:function(){se(at).forEach(ht)}}}function m(Ie){for(var be=ae.allocType(5123,Ie.length),Ae=0;Ae<Ie.length;++Ae)if(isNaN(Ie[Ae]))be[Ae]=65535;else if(1/0===Ie[Ae])be[Ae]=31744;else if(-1/0===Ie[Ae])be[Ae]=64512;else{ge[0]=Ie[Ae];var Pe=(qe=ke[0])>>>31<<15,ze=(qe<<1>>>24)-127,qe=qe>>13&1023;be[Ae]=-24>ze?Pe:-14>ze?Pe+(qe+1024>>-14-ze):15<ze?Pe+31744:Pe+(ze+15<<10)+qe}return be}function y(Ie){return Array.isArray(Ie)||he(Ie)}function v(Ie){return"[object "+Ie+"]"}function T(Ie){return Array.isArray(Ie)&&(Ie.length===0||typeof Ie[0]=="number")}function _(Ie){return!(!Array.isArray(Ie)||Ie.length===0||!y(Ie[0]))}function k(Ie){return Object.prototype.toString.call(Ie)}function E(Ie){if(!Ie)return!1;var be=k(Ie);return 0<=Ye.indexOf(be)||T(Ie)||_(Ie)||n(Ie)}function A(Ie,be){Ie.type===36193?(Ie.data=m(be),ae.freeType(be)):Ie.data=be}function b(Ie,be,Ae,Pe,ze,qe){if(Ie=it[Ie]!==void 0?it[Ie]:De[Ie]*$e[be],qe&&(Ie*=6),ze){for(Pe=0;1<=Ae;)Pe+=Ie*Ae*Ae,Ae/=2;return Pe}return Ie*Ae*Pe}function L(Ie,be,Ae,Pe,ze,qe,ht){function at(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function nt(gt,Qt){gt.internalformat=Qt.internalformat,gt.format=Qt.format,gt.type=Qt.type,gt.compressed=Qt.compressed,gt.premultiplyAlpha=Qt.premultiplyAlpha,gt.flipY=Qt.flipY,gt.unpackAlignment=Qt.unpackAlignment,gt.colorSpace=Qt.colorSpace,gt.width=Qt.width,gt.height=Qt.height,gt.channels=Qt.channels}function xt(gt,Qt){if(typeof Qt=="object"&&Qt){"premultiplyAlpha"in Qt&&(gt.premultiplyAlpha=Qt.premultiplyAlpha),"flipY"in Qt&&(gt.flipY=Qt.flipY),"alignment"in Qt&&(gt.unpackAlignment=Qt.alignment),"colorSpace"in Qt&&(gt.colorSpace=wr[Qt.colorSpace]),"type"in Qt&&(gt.type=zr[Qt.type]);var Zt=gt.width,pr=gt.height,Mr=gt.channels,Vr=!1;"shape"in Qt?(Zt=Qt.shape[0],pr=Qt.shape[1],Qt.shape.length===3&&(Mr=Qt.shape[2],Vr=!0)):("radius"in Qt&&(Zt=pr=Qt.radius),"width"in Qt&&(Zt=Qt.width),"height"in Qt&&(pr=Qt.height),"channels"in Qt&&(Mr=Qt.channels,Vr=!0)),gt.width=0|Zt,gt.height=0|pr,gt.channels=0|Mr,Zt=!1,"format"in Qt&&(Zt=Qt.format,pr=gt.internalformat=Rr[Zt],gt.format=fn[pr],Zt in zr&&!("type"in Qt)&&(gt.type=zr[Zt]),Zt in Wr&&(gt.compressed=!0),Zt=!0),!Vr&&Zt?gt.channels=De[gt.format]:Vr&&!Zt&&gt.channels!==Se[gt.format]&&(gt.format=gt.internalformat=Se[gt.channels])}}function Lt(gt){Ie.pixelStorei(37440,gt.flipY),Ie.pixelStorei(37441,gt.premultiplyAlpha),Ie.pixelStorei(37443,gt.colorSpace),Ie.pixelStorei(3317,gt.unpackAlignment)}function bt(){at.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function St(gt,Qt){var Zt=null;if(E(Qt)?Zt=Qt:Qt&&(xt(gt,Qt),"x"in Qt&&(gt.xOffset=0|Qt.x),"y"in Qt&&(gt.yOffset=0|Qt.y),E(Qt.data)&&(Zt=Qt.data)),Qt.copy){var pr=ze.viewportWidth,Mr=ze.viewportHeight;gt.width=gt.width||pr-gt.xOffset,gt.height=gt.height||Mr-gt.yOffset,gt.needsCopy=!0}else if(Zt){if(he(Zt))gt.channels=gt.channels||4,gt.data=Zt,"type"in Qt||gt.type!==5121||(gt.type=0|ce[Object.prototype.toString.call(Zt)]);else if(T(Zt)){switch(gt.channels=gt.channels||4,Mr=(pr=Zt).length,gt.type){case 5121:case 5123:case 5125:case 5126:(Mr=ae.allocType(gt.type,Mr)).set(pr),gt.data=Mr;break;case 36193:gt.data=m(pr)}gt.alignment=1,gt.needsFree=!0}else if(n(Zt)){pr=Zt.data,Array.isArray(pr)||gt.type!==5121||(gt.type=0|ce[Object.prototype.toString.call(pr)]),Mr=Zt.shape;var Vr,kr,ur,Ir,mr=Zt.stride;Mr.length===3?(ur=Mr[2],Ir=mr[2]):Ir=ur=1,Vr=Mr[0],kr=Mr[1],Mr=mr[0],mr=mr[1],gt.alignment=1,gt.width=Vr,gt.height=kr,gt.channels=ur,gt.format=gt.internalformat=Se[ur],gt.needsFree=!0,Vr=Ir,Zt=Zt.offset,ur=gt.width,Ir=gt.height,kr=gt.channels;for(var _r=ae.allocType(gt.type===36193?5126:gt.type,ur*Ir*kr),Nr=0,vn=0;vn<Ir;++vn)for(var xn=0;xn<ur;++xn)for(var wn=0;wn<kr;++wn)_r[Nr++]=pr[Mr*xn+mr*vn+Vr*wn+Zt];A(gt,_r)}else if(k(Zt)===Be||k(Zt)===We||k(Zt)===Qe)k(Zt)===Be||k(Zt)===We?gt.element=Zt:gt.element=Zt.canvas,gt.width=gt.element.width,gt.height=gt.element.height,gt.channels=4;else if(k(Zt)===Oe)gt.element=Zt,gt.width=Zt.width,gt.height=Zt.height,gt.channels=4;else if(k(Zt)===Ue)gt.element=Zt,gt.width=Zt.naturalWidth,gt.height=Zt.naturalHeight,gt.channels=4;else if(k(Zt)===Xe)gt.element=Zt,gt.width=Zt.videoWidth,gt.height=Zt.videoHeight,gt.channels=4;else if(_(Zt)){for(pr=gt.width||Zt[0].length,Mr=gt.height||Zt.length,mr=gt.channels,mr=y(Zt[0][0])?mr||Zt[0][0].length:mr||1,Vr=de.shape(Zt),ur=1,Ir=0;Ir<Vr.length;++Ir)ur*=Vr[Ir];ur=ae.allocType(gt.type===36193?5126:gt.type,ur),de.flatten(Zt,Vr,"",ur),A(gt,ur),gt.alignment=1,gt.width=pr,gt.height=Mr,gt.channels=mr,gt.format=gt.internalformat=Se[mr],gt.needsFree=!0}}else gt.width=gt.width||1,gt.height=gt.height||1,gt.channels=gt.channels||4}function st(gt,Qt,Zt,pr,Mr){var Vr=gt.element,kr=gt.data,ur=gt.internalformat,Ir=gt.format,mr=gt.type,_r=gt.width,Nr=gt.height;Lt(gt),Vr?Ie.texSubImage2D(Qt,Mr,Zt,pr,Ir,mr,Vr):gt.compressed?Ie.compressedTexSubImage2D(Qt,Mr,Zt,pr,ur,_r,Nr,kr):gt.needsCopy?(Pe(),Ie.copyTexSubImage2D(Qt,Mr,Zt,pr,gt.xOffset,gt.yOffset,_r,Nr)):Ie.texSubImage2D(Qt,Mr,Zt,pr,_r,Nr,Ir,mr,kr)}function It(){return Qr.pop()||new bt}function jt(gt){gt.needsFree&&ae.freeType(gt.data),bt.call(gt),Qr.push(gt)}function Ut(){at.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function zt(gt,Qt,Zt){var pr=gt.images[0]=It();gt.mipmask=1,pr.width=gt.width=Qt,pr.height=gt.height=Zt,pr.channels=gt.channels=4}function Ce(gt,Qt){var Zt=null;if(E(Qt))nt(Zt=gt.images[0]=It(),gt),St(Zt,Qt),gt.mipmask=1;else if(xt(gt,Qt),Array.isArray(Qt.mipmap))for(var pr=Qt.mipmap,Mr=0;Mr<pr.length;++Mr)nt(Zt=gt.images[Mr]=It(),gt),Zt.width>>=Mr,Zt.height>>=Mr,St(Zt,pr[Mr]),gt.mipmask|=1<<Mr;else nt(Zt=gt.images[0]=It(),gt),St(Zt,Qt),gt.mipmask=1;nt(gt,gt.images[0])}function lt(gt,Qt){for(var Zt=gt.images,pr=0;pr<Zt.length&&Zt[pr];++pr){var Mr=Zt[pr],Vr=Qt,kr=pr,ur=Mr.element,Ir=Mr.data,mr=Mr.internalformat,_r=Mr.format,Nr=Mr.type,vn=Mr.width,xn=Mr.height;Lt(Mr),ur?Ie.texImage2D(Vr,kr,_r,_r,Nr,ur):Mr.compressed?Ie.compressedTexImage2D(Vr,kr,mr,vn,xn,0,Ir):Mr.needsCopy?(Pe(),Ie.copyTexImage2D(Vr,kr,_r,Mr.xOffset,Mr.yOffset,vn,xn,0)):Ie.texImage2D(Vr,kr,_r,vn,xn,0,_r,Nr,Ir||null)}}function At(){var gt=un.pop()||new Ut;at.call(gt);for(var Qt=gt.mipmask=0;16>Qt;++Qt)gt.images[Qt]=null;return gt}function Bt(gt){for(var Qt=gt.images,Zt=0;Zt<Qt.length;++Zt)Qt[Zt]&&jt(Qt[Zt]),Qt[Zt]=null;un.push(gt)}function Ht(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function or(gt,Qt){"min"in Qt&&(gt.minFilter=gr[Qt.min],0<=Me.indexOf(gt.minFilter)&&!("faces"in Qt)&&(gt.genMipmaps=!0)),"mag"in Qt&&(gt.magFilter=xr[Qt.mag]);var Zt=gt.wrapS,pr=gt.wrapT;if("wrap"in Qt){var Mr=Qt.wrap;typeof Mr=="string"?Zt=pr=yr[Mr]:Array.isArray(Mr)&&(Zt=yr[Mr[0]],pr=yr[Mr[1]])}else"wrapS"in Qt&&(Zt=yr[Qt.wrapS]),"wrapT"in Qt&&(pr=yr[Qt.wrapT]);if(gt.wrapS=Zt,gt.wrapT=pr,"anisotropic"in Qt&&(gt.anisotropic=Qt.anisotropic),"mipmap"in Qt){switch(Zt=!1,typeof Qt.mipmap){case"string":gt.mipmapHint=Kt[Qt.mipmap],Zt=gt.genMipmaps=!0;break;case"boolean":Zt=gt.genMipmaps=Qt.mipmap;break;case"object":gt.genMipmaps=!1,Zt=!0}!Zt||"min"in Qt||(gt.minFilter=9984)}}function ar(gt,Qt){Ie.texParameteri(Qt,10241,gt.minFilter),Ie.texParameteri(Qt,10240,gt.magFilter),Ie.texParameteri(Qt,10242,gt.wrapS),Ie.texParameteri(Qt,10243,gt.wrapT),be.ext_texture_filter_anisotropic&&Ie.texParameteri(Qt,34046,gt.anisotropic),gt.genMipmaps&&(Ie.hint(33170,gt.mipmapHint),Ie.generateMipmap(Qt))}function Nt(gt){at.call(this),this.mipmask=0,this.internalformat=6408,this.id=Pn++,this.refCount=1,this.target=gt,this.texture=Ie.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ht,ht.profile&&(this.stats={size:0})}function nr(gt){Ie.activeTexture(33984),Ie.bindTexture(gt.target,gt.texture)}function Lr(){var gt=aa[0];gt?Ie.bindTexture(gt.target,gt.texture):Ie.bindTexture(3553,null)}function dr(gt){var Qt=gt.texture,Zt=gt.unit,pr=gt.target;0<=Zt&&(Ie.activeTexture(33984+Zt),Ie.bindTexture(pr,null),aa[Zt]=null),Ie.deleteTexture(Qt),gt.texture=null,gt.params=null,gt.pixels=null,gt.refCount=0,delete kn[gt.id],qe.textureCount--}var Kt={"don't care":4352,"dont care":4352,nice:4354,fast:4353},yr={repeat:10497,clamp:33071,mirror:33648},xr={nearest:9728,linear:9729},gr=G({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},xr),wr={none:0,browser:37444},zr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Rr={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Wr={};be.ext_srgb&&(Rr.srgb=35904,Rr.srgba=35906),be.oes_texture_float&&(zr.float32=zr.float=5126),be.oes_texture_half_float&&(zr.float16=zr["half float"]=36193),be.webgl_depth_texture&&(G(Rr,{depth:6402,"depth stencil":34041}),G(zr,{uint16:5123,uint32:5125,"depth stencil":34042})),be.webgl_compressed_texture_s3tc&&G(Wr,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),be.webgl_compressed_texture_atc&&G(Wr,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),be.webgl_compressed_texture_pvrtc&&G(Wr,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),be.webgl_compressed_texture_etc1&&(Wr["rgb etc1"]=36196);var gn=Array.prototype.slice.call(Ie.getParameter(34467));Object.keys(Wr).forEach(function(gt){var Qt=Wr[gt];0<=gn.indexOf(Qt)&&(Rr[gt]=Qt)});var rn=Object.keys(Rr);Ae.textureFormats=rn;var Zr=[];Object.keys(Rr).forEach(function(gt){Zr[Rr[gt]]=gt});var bn=[];Object.keys(zr).forEach(function(gt){bn[zr[gt]]=gt});var Dr=[];Object.keys(xr).forEach(function(gt){Dr[xr[gt]]=gt});var br=[];Object.keys(gr).forEach(function(gt){br[gr[gt]]=gt});var Xr=[];Object.keys(yr).forEach(function(gt){Xr[yr[gt]]=gt});var fn=rn.reduce(function(gt,Qt){var Zt=Rr[Qt];return Zt===6409||Zt===6406||Zt===6409||Zt===6410||Zt===6402||Zt===34041||be.ext_srgb&&(Zt===35904||Zt===35906)?gt[Zt]=Zt:Zt===32855||0<=Qt.indexOf("rgba")?gt[Zt]=6408:gt[Zt]=6407,gt},{}),Qr=[],un=[],Pn=0,kn={},Hn=Ae.maxTextureUnits,aa=Array(Hn).map(function(){return null});return G(Nt.prototype,{bind:function(){this.bindCount+=1;var gt=this.unit;if(0>gt){for(var Qt=0;Qt<Hn;++Qt){var Zt=aa[Qt];if(Zt){if(0<Zt.bindCount)continue;Zt.unit=-1}aa[Qt]=this,gt=Qt;break}ht.profile&&qe.maxTextureUnits<gt+1&&(qe.maxTextureUnits=gt+1),this.unit=gt,Ie.activeTexture(33984+gt),Ie.bindTexture(this.target,this.texture)}return gt},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&dr(this)}}),ht.profile&&(qe.getTotalTextureSize=function(){var gt=0;return Object.keys(kn).forEach(function(Qt){gt+=kn[Qt].stats.size}),gt}),{create2D:function(gt,Qt){function Zt(Mr,Vr){var kr=pr.texInfo;Ht.call(kr);var ur=At();return typeof Mr=="number"?zt(ur,0|Mr,typeof Vr=="number"?0|Vr:0|Mr):Mr?(or(kr,Mr),Ce(ur,Mr)):zt(ur,1,1),kr.genMipmaps&&(ur.mipmask=(ur.width<<1)-1),pr.mipmask=ur.mipmask,nt(pr,ur),pr.internalformat=ur.internalformat,Zt.width=ur.width,Zt.height=ur.height,nr(pr),lt(ur,3553),ar(kr,3553),Lr(),Bt(ur),ht.profile&&(pr.stats.size=b(pr.internalformat,pr.type,ur.width,ur.height,kr.genMipmaps,!1)),Zt.format=Zr[pr.internalformat],Zt.type=bn[pr.type],Zt.mag=Dr[kr.magFilter],Zt.min=br[kr.minFilter],Zt.wrapS=Xr[kr.wrapS],Zt.wrapT=Xr[kr.wrapT],Zt}var pr=new Nt(3553);return kn[pr.id]=pr,qe.textureCount++,Zt(gt,Qt),Zt.subimage=function(Mr,Vr,kr,ur){Vr|=0,kr|=0,ur|=0;var Ir=It();return nt(Ir,pr),Ir.width=0,Ir.height=0,St(Ir,Mr),Ir.width=Ir.width||(pr.width>>ur)-Vr,Ir.height=Ir.height||(pr.height>>ur)-kr,nr(pr),st(Ir,3553,Vr,kr,ur),Lr(),jt(Ir),Zt},Zt.resize=function(Mr,Vr){var kr=0|Mr,ur=0|Vr||kr;if(kr===pr.width&&ur===pr.height)return Zt;Zt.width=pr.width=kr,Zt.height=pr.height=ur,nr(pr);for(var Ir=0;pr.mipmask>>Ir;++Ir){var mr=kr>>Ir,_r=ur>>Ir;if(!mr||!_r)break;Ie.texImage2D(3553,Ir,pr.format,mr,_r,0,pr.format,pr.type,null)}return Lr(),ht.profile&&(pr.stats.size=b(pr.internalformat,pr.type,kr,ur,!1,!1)),Zt},Zt._reglType="texture2d",Zt._texture=pr,ht.profile&&(Zt.stats=pr.stats),Zt.destroy=function(){pr.decRef()},Zt},createCube:function(gt,Qt,Zt,pr,Mr,Vr){function kr(mr,_r,Nr,vn,xn,wn){var ln,zn=ur.texInfo;for(Ht.call(zn),ln=0;6>ln;++ln)Ir[ln]=At();if(typeof mr!="number"&&mr){if(typeof mr=="object")if(_r)Ce(Ir[0],mr),Ce(Ir[1],_r),Ce(Ir[2],Nr),Ce(Ir[3],vn),Ce(Ir[4],xn),Ce(Ir[5],wn);else if(or(zn,mr),xt(ur,mr),"faces"in mr)for(mr=mr.faces,ln=0;6>ln;++ln)nt(Ir[ln],ur),Ce(Ir[ln],mr[ln]);else for(ln=0;6>ln;++ln)Ce(Ir[ln],mr)}else for(mr=0|mr||1,ln=0;6>ln;++ln)zt(Ir[ln],mr,mr);for(nt(ur,Ir[0]),ur.mipmask=zn.genMipmaps?(Ir[0].width<<1)-1:Ir[0].mipmask,ur.internalformat=Ir[0].internalformat,kr.width=Ir[0].width,kr.height=Ir[0].height,nr(ur),ln=0;6>ln;++ln)lt(Ir[ln],34069+ln);for(ar(zn,34067),Lr(),ht.profile&&(ur.stats.size=b(ur.internalformat,ur.type,kr.width,kr.height,zn.genMipmaps,!0)),kr.format=Zr[ur.internalformat],kr.type=bn[ur.type],kr.mag=Dr[zn.magFilter],kr.min=br[zn.minFilter],kr.wrapS=Xr[zn.wrapS],kr.wrapT=Xr[zn.wrapT],ln=0;6>ln;++ln)Bt(Ir[ln]);return kr}var ur=new Nt(34067);kn[ur.id]=ur,qe.cubeCount++;var Ir=Array(6);return kr(gt,Qt,Zt,pr,Mr,Vr),kr.subimage=function(mr,_r,Nr,vn,xn){Nr|=0,vn|=0,xn|=0;var wn=It();return nt(wn,ur),wn.width=0,wn.height=0,St(wn,_r),wn.width=wn.width||(ur.width>>xn)-Nr,wn.height=wn.height||(ur.height>>xn)-vn,nr(ur),st(wn,34069+mr,Nr,vn,xn),Lr(),jt(wn),kr},kr.resize=function(mr){if((mr|=0)!==ur.width){kr.width=ur.width=mr,kr.height=ur.height=mr,nr(ur);for(var _r=0;6>_r;++_r)for(var Nr=0;ur.mipmask>>Nr;++Nr)Ie.texImage2D(34069+_r,Nr,ur.format,mr>>Nr,mr>>Nr,0,ur.format,ur.type,null);return Lr(),ht.profile&&(ur.stats.size=b(ur.internalformat,ur.type,kr.width,kr.height,!1,!0)),kr}},kr._reglType="textureCube",kr._texture=ur,ht.profile&&(kr.stats=ur.stats),kr.destroy=function(){ur.decRef()},kr},clear:function(){for(var gt=0;gt<Hn;++gt)Ie.activeTexture(33984+gt),Ie.bindTexture(3553,null),aa[gt]=null;se(kn).forEach(dr),qe.cubeCount=0,qe.textureCount=0},getTexture:function(gt){return null},restore:function(){for(var gt=0;gt<Hn;++gt){var Qt=aa[gt];Qt&&(Qt.bindCount=0,Qt.unit=-1,aa[gt]=null)}se(kn).forEach(function(Zt){Zt.texture=Ie.createTexture(),Ie.bindTexture(Zt.target,Zt.texture);for(var pr=0;32>pr;++pr)if(Zt.mipmask&1<<pr)if(Zt.target===3553)Ie.texImage2D(3553,pr,Zt.internalformat,Zt.width>>pr,Zt.height>>pr,0,Zt.internalformat,Zt.type,null);else for(var Mr=0;6>Mr;++Mr)Ie.texImage2D(34069+Mr,pr,Zt.internalformat,Zt.width>>pr,Zt.height>>pr,0,Zt.internalformat,Zt.type,null);ar(Zt.texInfo,Zt.target)})}}}function w(Ie,be,Ae,Pe,ze,qe){function ht(Nt,nr,Lr){this.target=Nt,this.texture=nr,this.renderbuffer=Lr;var dr=Nt=0;nr?(Nt=nr.width,dr=nr.height):Lr&&(Nt=Lr.width,dr=Lr.height),this.width=Nt,this.height=dr}function at(Nt){Nt&&(Nt.texture&&Nt.texture._texture.decRef(),Nt.renderbuffer&&Nt.renderbuffer._renderbuffer.decRef())}function nt(Nt,nr,Lr){Nt&&(Nt.texture?Nt.texture._texture.refCount+=1:Nt.renderbuffer._renderbuffer.refCount+=1)}function xt(Nt,nr){nr&&(nr.texture?Ie.framebufferTexture2D(36160,Nt,nr.target,nr.texture._texture.texture,0):Ie.framebufferRenderbuffer(36160,Nt,36161,nr.renderbuffer._renderbuffer.renderbuffer))}function Lt(Nt){var nr=3553,Lr=null,dr=null,Kt=Nt;return typeof Nt=="object"&&(Kt=Nt.data,"target"in Nt&&(nr=0|Nt.target)),(Nt=Kt._reglType)==="texture2d"||Nt==="textureCube"?Lr=Kt:Nt==="renderbuffer"&&(dr=Kt,nr=36161),new ht(nr,Lr,dr)}function bt(Nt,nr,Lr,dr,Kt){return Lr?((Nt=Pe.create2D({width:Nt,height:nr,format:dr,type:Kt}))._texture.refCount=0,new ht(3553,Nt,null)):((Nt=ze.create({width:Nt,height:nr,format:dr}))._renderbuffer.refCount=0,new ht(36161,null,Nt))}function St(Nt){return Nt&&(Nt.texture||Nt.renderbuffer)}function st(Nt,nr,Lr){Nt&&(Nt.texture?Nt.texture.resize(nr,Lr):Nt.renderbuffer&&Nt.renderbuffer.resize(nr,Lr),Nt.width=nr,Nt.height=Lr)}function It(){this.id=or++,ar[this.id]=this,this.framebuffer=Ie.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function jt(Nt){Nt.colorAttachments.forEach(at),at(Nt.depthAttachment),at(Nt.stencilAttachment),at(Nt.depthStencilAttachment)}function Ut(Nt){Ie.deleteFramebuffer(Nt.framebuffer),Nt.framebuffer=null,qe.framebufferCount--,delete ar[Nt.id]}function zt(Nt){var nr;Ie.bindFramebuffer(36160,Nt.framebuffer);var Lr=Nt.colorAttachments;for(nr=0;nr<Lr.length;++nr)xt(36064+nr,Lr[nr]);for(nr=Lr.length;nr<Ae.maxColorAttachments;++nr)Ie.framebufferTexture2D(36160,36064+nr,3553,null,0);Ie.framebufferTexture2D(36160,33306,3553,null,0),Ie.framebufferTexture2D(36160,36096,3553,null,0),Ie.framebufferTexture2D(36160,36128,3553,null,0),xt(36096,Nt.depthAttachment),xt(36128,Nt.stencilAttachment),xt(33306,Nt.depthStencilAttachment),Ie.checkFramebufferStatus(36160),Ie.isContextLost(),Ie.bindFramebuffer(36160,lt.next?lt.next.framebuffer:null),lt.cur=lt.next,Ie.getError()}function Ce(Nt,nr){function Lr(Kt,yr){var xr,gr=0,wr=0,zr=!0,Rr=!0;xr=null;var Wr=!0,gn="rgba",rn="uint8",Zr=1,bn=null,Dr=null,br=null,Xr=!1;typeof Kt=="number"?(gr=0|Kt,wr=0|yr||gr):Kt?("shape"in Kt?(gr=(wr=Kt.shape)[0],wr=wr[1]):("radius"in Kt&&(gr=wr=Kt.radius),"width"in Kt&&(gr=Kt.width),"height"in Kt&&(wr=Kt.height)),("color"in Kt||"colors"in Kt)&&(xr=Kt.color||Kt.colors,Array.isArray(xr)),xr||("colorCount"in Kt&&(Zr=0|Kt.colorCount),"colorTexture"in Kt&&(Wr=!!Kt.colorTexture,gn="rgba4"),"colorType"in Kt&&(rn=Kt.colorType,!Wr)&&(rn==="half float"||rn==="float16"?gn="rgba16f":rn!=="float"&&rn!=="float32"||(gn="rgba32f")),"colorFormat"in Kt&&(gn=Kt.colorFormat,0<=At.indexOf(gn)?Wr=!0:0<=Bt.indexOf(gn)&&(Wr=!1))),("depthTexture"in Kt||"depthStencilTexture"in Kt)&&(Xr=!(!Kt.depthTexture&&!Kt.depthStencilTexture)),"depth"in Kt&&(typeof Kt.depth=="boolean"?zr=Kt.depth:(bn=Kt.depth,Rr=!1)),"stencil"in Kt&&(typeof Kt.stencil=="boolean"?Rr=Kt.stencil:(Dr=Kt.stencil,zr=!1)),"depthStencil"in Kt&&(typeof Kt.depthStencil=="boolean"?zr=Rr=Kt.depthStencil:(br=Kt.depthStencil,Rr=zr=!1))):gr=wr=1;var fn=null,Qr=null,un=null,Pn=null;if(Array.isArray(xr))fn=xr.map(Lt);else if(xr)fn=[Lt(xr)];else for(fn=Array(Zr),xr=0;xr<Zr;++xr)fn[xr]=bt(gr,wr,Wr,gn,rn);for(gr=gr||fn[0].width,wr=wr||fn[0].height,bn?Qr=Lt(bn):zr&&!Rr&&(Qr=bt(gr,wr,Xr,"depth","uint32")),Dr?un=Lt(Dr):Rr&&!zr&&(un=bt(gr,wr,!1,"stencil","uint8")),br?Pn=Lt(br):!bn&&!Dr&&Rr&&zr&&(Pn=bt(gr,wr,Xr,"depth stencil","depth stencil")),zr=null,xr=0;xr<fn.length;++xr)nt(fn[xr]),fn[xr]&&fn[xr].texture&&(Rr=mt[fn[xr].texture._texture.format]*tt[fn[xr].texture._texture.type],zr===null&&(zr=Rr));return nt(Qr),nt(un),nt(Pn),jt(dr),dr.width=gr,dr.height=wr,dr.colorAttachments=fn,dr.depthAttachment=Qr,dr.stencilAttachment=un,dr.depthStencilAttachment=Pn,Lr.color=fn.map(St),Lr.depth=St(Qr),Lr.stencil=St(un),Lr.depthStencil=St(Pn),Lr.width=dr.width,Lr.height=dr.height,zt(dr),Lr}var dr=new It;return qe.framebufferCount++,Lr(Nt,nr),G(Lr,{resize:function(Kt,yr){var xr=Math.max(0|Kt,1),gr=Math.max(0|yr||xr,1);if(xr===dr.width&&gr===dr.height)return Lr;for(var wr=dr.colorAttachments,zr=0;zr<wr.length;++zr)st(wr[zr],xr,gr);return st(dr.depthAttachment,xr,gr),st(dr.stencilAttachment,xr,gr),st(dr.depthStencilAttachment,xr,gr),dr.width=Lr.width=xr,dr.height=Lr.height=gr,zt(dr),Lr},_reglType:"framebuffer",_framebuffer:dr,destroy:function(){Ut(dr),jt(dr)},use:function(Kt){lt.setFBO({framebuffer:Lr},Kt)}})}var lt={cur:null,next:null,dirty:!1,setFBO:null},At=["rgba"],Bt=["rgba4","rgb565","rgb5 a1"];be.ext_srgb&&Bt.push("srgba"),be.ext_color_buffer_half_float&&Bt.push("rgba16f","rgb16f"),be.webgl_color_buffer_float&&Bt.push("rgba32f");var Ht=["uint8"];be.oes_texture_half_float&&Ht.push("half float","float16"),be.oes_texture_float&&Ht.push("float","float32");var or=0,ar={};return G(lt,{getFramebuffer:function(Nt){return typeof Nt=="function"&&Nt._reglType==="framebuffer"&&(Nt=Nt._framebuffer)instanceof It?Nt:null},create:Ce,createCube:function(Nt){function nr(dr){var Kt,yr={color:null},xr=0,gr=null;Kt="rgba";var wr="uint8",zr=1;if(typeof dr=="number"?xr=0|dr:dr?("shape"in dr?xr=dr.shape[0]:("radius"in dr&&(xr=0|dr.radius),"width"in dr?xr=0|dr.width:"height"in dr&&(xr=0|dr.height)),("color"in dr||"colors"in dr)&&(gr=dr.color||dr.colors,Array.isArray(gr)),gr||("colorCount"in dr&&(zr=0|dr.colorCount),"colorType"in dr&&(wr=dr.colorType),"colorFormat"in dr&&(Kt=dr.colorFormat)),"depth"in dr&&(yr.depth=dr.depth),"stencil"in dr&&(yr.stencil=dr.stencil),"depthStencil"in dr&&(yr.depthStencil=dr.depthStencil)):xr=1,gr)if(Array.isArray(gr))for(dr=[],Kt=0;Kt<gr.length;++Kt)dr[Kt]=gr[Kt];else dr=[gr];else for(dr=Array(zr),gr={radius:xr,format:Kt,type:wr},Kt=0;Kt<zr;++Kt)dr[Kt]=Pe.createCube(gr);for(yr.color=Array(dr.length),Kt=0;Kt<dr.length;++Kt)zr=dr[Kt],xr=xr||zr.width,yr.color[Kt]={target:34069,data:dr[Kt]};for(Kt=0;6>Kt;++Kt){for(zr=0;zr<dr.length;++zr)yr.color[zr].target=34069+Kt;0<Kt&&(yr.depth=Lr[0].depth,yr.stencil=Lr[0].stencil,yr.depthStencil=Lr[0].depthStencil),Lr[Kt]?Lr[Kt](yr):Lr[Kt]=Ce(yr)}return G(nr,{width:xr,height:xr,color:dr})}var Lr=Array(6);return nr(Nt),G(nr,{faces:Lr,resize:function(dr){var Kt=0|dr;if(Kt===nr.width)return nr;var yr=nr.color;for(dr=0;dr<yr.length;++dr)yr[dr].resize(Kt);for(dr=0;6>dr;++dr)Lr[dr].resize(Kt);return nr.width=nr.height=Kt,nr},_reglType:"framebufferCube",destroy:function(){Lr.forEach(function(dr){dr.destroy()})}})},clear:function(){se(ar).forEach(Ut)},restore:function(){lt.cur=null,lt.next=null,lt.dirty=!0,se(ar).forEach(function(Nt){Nt.framebuffer=Ie.createFramebuffer(),zt(Nt)})}})}function C(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function S(Ie,be,Ae,Pe,ze){function qe(){this.id=++nt,this.attributes=[];var bt=be.oes_vertex_array_object;this.vao=bt?bt.createVertexArrayOES():null,xt[this.id]=this,this.buffers=[]}var ht=Ae.maxAttributes,at=Array(ht);for(Ae=0;Ae<ht;++Ae)at[Ae]=new C;var nt=0,xt={},Lt={Record:C,scope:{},state:at,currentVAO:null,targetVAO:null,restore:be.oes_vertex_array_object?function(){be.oes_vertex_array_object&&se(xt).forEach(function(bt){bt.refresh()})}:function(){},createVAO:function(bt){function St(It){for(var jt=0;jt<st.buffers.length;++jt)st.buffers[jt].destroy();st.buffers.length=0,(jt=st.attributes).length=It.length;for(var Ut=0;Ut<It.length;++Ut){var zt=It[Ut],Ce=jt[Ut]=new C;Array.isArray(zt)||he(zt)||n(zt)?(zt=ze.create(zt,34962,!1,!0),Ce.buffer=ze.getBuffer(zt),Ce.size=0|Ce.buffer.dimension,Ce.normalized=!1,Ce.type=Ce.buffer.dtype,Ce.offset=0,Ce.stride=0,Ce.divisor=0,Ce.state=1,st.buffers.push(zt)):ze.getBuffer(zt)?(Ce.buffer=ze.getBuffer(zt),Ce.size=0|Ce.buffer.dimension,Ce.normalized=!1,Ce.type=Ce.buffer.dtype,Ce.offset=0,Ce.stride=0,Ce.divisor=0,Ce.state=1):ze.getBuffer(zt.buffer)?(Ce.buffer=ze.getBuffer(zt.buffer),Ce.size=0|(+zt.size||Ce.buffer.dimension),Ce.normalized=!!zt.normalized||!1,Ce.type="type"in zt?ve[zt.type]:Ce.buffer.dtype,Ce.offset=0|(zt.offset||0),Ce.stride=0|(zt.stride||0),Ce.divisor=0|(zt.divisor||0),Ce.state=1):"x"in zt&&(Ce.x=+zt.x||0,Ce.y=+zt.y||0,Ce.z=+zt.z||0,Ce.w=+zt.w||0,Ce.state=2)}return st.refresh(),St}var st=new qe;return Pe.vaoCount+=1,St.destroy=function(){st.destroy()},St._vao=st,St._reglType="vao",St(bt)},getVAO:function(bt){return typeof bt=="function"&&bt._vao?bt._vao:null},destroyBuffer:function(bt){for(var St=0;St<at.length;++St){var st=at[St];st.buffer===bt&&(Ie.disableVertexAttribArray(St),st.buffer=null)}},setVAO:be.oes_vertex_array_object?function(bt){if(bt!==Lt.currentVAO){var St=be.oes_vertex_array_object;bt?St.bindVertexArrayOES(bt.vao):St.bindVertexArrayOES(null),Lt.currentVAO=bt}}:function(bt){if(bt!==Lt.currentVAO){if(bt)bt.bindAttrs();else for(var St=be.angle_instanced_arrays,st=0;st<at.length;++st){var It=at[st];It.buffer?(Ie.enableVertexAttribArray(st),Ie.vertexAttribPointer(st,It.size,It.type,It.normalized,It.stride,It.offfset),St&&St.vertexAttribDivisorANGLE(st,It.divisor)):(Ie.disableVertexAttribArray(st),Ie.vertexAttrib4f(st,It.x,It.y,It.z,It.w))}Lt.currentVAO=bt}},clear:be.oes_vertex_array_object?function(){se(xt).forEach(function(bt){bt.destroy()})}:function(){}};return qe.prototype.bindAttrs=function(){for(var bt=be.angle_instanced_arrays,St=this.attributes,st=0;st<St.length;++st){var It=St[st];It.buffer?(Ie.enableVertexAttribArray(st),Ie.bindBuffer(34962,It.buffer.buffer),Ie.vertexAttribPointer(st,It.size,It.type,It.normalized,It.stride,It.offset),bt&&bt.vertexAttribDivisorANGLE(st,It.divisor)):(Ie.disableVertexAttribArray(st),Ie.vertexAttrib4f(st,It.x,It.y,It.z,It.w))}for(bt=St.length;bt<ht;++bt)Ie.disableVertexAttribArray(bt)},qe.prototype.refresh=function(){var bt=be.oes_vertex_array_object;bt&&(bt.bindVertexArrayOES(this.vao),this.bindAttrs(),Lt.currentVAO=this)},qe.prototype.destroy=function(){if(this.vao){var bt=be.oes_vertex_array_object;this===Lt.currentVAO&&(Lt.currentVAO=null,bt.bindVertexArrayOES(null)),bt.deleteVertexArrayOES(this.vao),this.vao=null}xt[this.id]&&(delete xt[this.id],--Pe.vaoCount)},Lt}function P(Ie,be,Ae,Pe){function ze(It,jt,Ut,zt){this.name=It,this.id=jt,this.location=Ut,this.info=zt}function qe(It,jt){for(var Ut=0;Ut<It.length;++Ut)if(It[Ut].id===jt.id)return void(It[Ut].location=jt.location);It.push(jt)}function ht(It,jt,Ut){if(!(Ce=(Ut=It===35632?xt:Lt)[jt])){var zt=be.str(jt),Ce=Ie.createShader(It);Ie.shaderSource(Ce,zt),Ie.compileShader(Ce),Ut[jt]=Ce}return Ce}function at(It,jt){this.id=st++,this.fragId=It,this.vertId=jt,this.program=null,this.uniforms=[],this.attributes=[],Pe.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function nt(It,jt,Ut){var zt;zt=ht(35632,It.fragId);var Ce=ht(35633,It.vertId);if(jt=It.program=Ie.createProgram(),Ie.attachShader(jt,zt),Ie.attachShader(jt,Ce),Ut)for(zt=0;zt<Ut.length;++zt)Ce=Ut[zt],Ie.bindAttribLocation(jt,Ce[0],Ce[1]);Ie.linkProgram(jt),Ce=Ie.getProgramParameter(jt,35718),Pe.profile&&(It.stats.uniformsCount=Ce);var lt=It.uniforms;for(zt=0;zt<Ce;++zt)if(Ut=Ie.getActiveUniform(jt,zt))if(1<Ut.size)for(var At=0;At<Ut.size;++At){var Bt=Ut.name.replace("[0]","["+At+"]");qe(lt,new ze(Bt,be.id(Bt),Ie.getUniformLocation(jt,Bt),Ut))}else qe(lt,new ze(Ut.name,be.id(Ut.name),Ie.getUniformLocation(jt,Ut.name),Ut));for(Ce=Ie.getProgramParameter(jt,35721),Pe.profile&&(It.stats.attributesCount=Ce),It=It.attributes,zt=0;zt<Ce;++zt)(Ut=Ie.getActiveAttrib(jt,zt))&&qe(It,new ze(Ut.name,be.id(Ut.name),Ie.getAttribLocation(jt,Ut.name),Ut))}var xt={},Lt={},bt={},St=[],st=0;return Pe.profile&&(Ae.getMaxUniformsCount=function(){var It=0;return St.forEach(function(jt){jt.stats.uniformsCount>It&&(It=jt.stats.uniformsCount)}),It},Ae.getMaxAttributesCount=function(){var It=0;return St.forEach(function(jt){jt.stats.attributesCount>It&&(It=jt.stats.attributesCount)}),It}),{clear:function(){var It=Ie.deleteShader.bind(Ie);se(xt).forEach(It),xt={},se(Lt).forEach(It),Lt={},St.forEach(function(jt){Ie.deleteProgram(jt.program)}),St.length=0,bt={},Ae.shaderCount=0},program:function(It,jt,Ut,zt){var Ce=bt[jt];Ce||(Ce=bt[jt]={});var lt=Ce[It];return lt&&!zt?lt:(jt=new at(jt,It),Ae.shaderCount++,nt(jt,Ut,zt),lt||(Ce[It]=jt),St.push(jt),jt)},restore:function(){xt={},Lt={};for(var It=0;It<St.length;++It)nt(St[It],null,St[It].attributes.map(function(jt){return[jt.location,jt.name]}))},shader:ht,frag:-1,vert:-1}}function z(Ie,be,Ae,Pe,ze,qe,ht){function at(nt){var xt;xt=be.next===null?5121:be.next.colorAttachments[0].texture._texture.type;var Lt=0,bt=0,St=Pe.framebufferWidth,st=Pe.framebufferHeight,It=null;return he(nt)?It=nt:nt&&(Lt=0|nt.x,bt=0|nt.y,St=0|(nt.width||Pe.framebufferWidth-Lt),st=0|(nt.height||Pe.framebufferHeight-bt),It=nt.data||null),Ae(),nt=St*st*4,It||(xt===5121?It=new Uint8Array(nt):xt===5126&&(It=It||new Float32Array(nt))),Ie.pixelStorei(3333,4),Ie.readPixels(Lt,bt,St,st,6408,xt,It),It}return function(nt){return nt&&"framebuffer"in nt?function(xt){var Lt;return be.setFBO({framebuffer:xt.framebuffer},function(){Lt=at(xt)}),Lt}(nt):at(nt)}}function F(Ie){return Array.prototype.slice.call(Ie)}function q(Ie){return F(Ie).join("")}function W(){function Ie(){var at=[],nt=[];return G(function(){at.push.apply(at,F(arguments))},{def:function(){var xt="v"+Ae++;return nt.push(xt),0<arguments.length&&(at.push(xt,"="),at.push.apply(at,F(arguments)),at.push(";")),xt},toString:function(){return q([0<nt.length?"var "+nt.join(",")+";":"",q(at)])}})}function be(){function at(St,st){xt(St,st,"=",nt.def(St,st),";")}var nt=Ie(),xt=Ie(),Lt=nt.toString,bt=xt.toString;return G(function(){nt.apply(nt,F(arguments))},{def:nt.def,entry:nt,exit:xt,save:at,set:function(St,st,It){at(St,st),nt(St,st,"=",It,";")},toString:function(){return Lt()+bt()}})}var Ae=0,Pe=[],ze=[],qe=Ie(),ht={};return{global:qe,link:function(at){for(var nt=0;nt<ze.length;++nt)if(ze[nt]===at)return Pe[nt];return nt="g"+Ae++,Pe.push(nt),ze.push(at),nt},block:Ie,proc:function(at,nt){function xt(){var st="a"+Lt.length;return Lt.push(st),st}var Lt=[];nt=nt||0;for(var bt=0;bt<nt;++bt)xt();var St=(bt=be()).toString;return ht[at]=G(bt,{arg:xt,toString:function(){return q(["function(",Lt.join(),"){",St(),"}"])}})},scope:be,cond:function(){var at=q(arguments),nt=be(),xt=be(),Lt=nt.toString,bt=xt.toString;return G(nt,{then:function(){return nt.apply(nt,F(arguments)),this},else:function(){return xt.apply(xt,F(arguments)),this},toString:function(){var St=bt();return St&&(St="else{"+St+"}"),q(["if(",at,"){",Lt(),"}",St])}})},compile:function(){var at=['"use strict";',qe,"return {"];Object.keys(ht).forEach(function(xt){at.push('"',xt,'":',ht[xt].toString(),",")}),at.push("}");var nt=q(at).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return Function.apply(null,Pe.concat(nt)).apply(null,ze)}}}function X(Ie){return Array.isArray(Ie)||he(Ie)||n(Ie)}function Q(Ie){return Ie.sort(function(be,Ae){return be==="viewport"?-1:Ae==="viewport"?1:be<Ae?-1:1})}function Z(Ie,be,Ae,Pe){this.thisDep=Ie,this.contextDep=be,this.propDep=Ae,this.append=Pe}function Y(Ie){return Ie&&!(Ie.thisDep||Ie.contextDep||Ie.propDep)}function N(Ie){return new Z(!1,!1,!1,Ie)}function J(Ie,be){var Ae=Ie.type;return Ae===0?new Z(!0,1<=(Ae=Ie.data.length),2<=Ae,be):Ae===4?new Z((Ae=Ie.data).thisDep,Ae.contextDep,Ae.propDep,be):new Z(Ae===3,Ae===2,Ae===1,be)}function D(Ie,be,Ae,Pe,ze,qe,ht,at,nt,xt,Lt,bt,St,st,It){function jt(gt){return gt.replace(".","_")}function Ut(gt,Qt,Zt){var pr=jt(gt);Qr.push(gt),fn[pr]=Xr[pr]=!!Zt,un[pr]=Qt}function zt(gt,Qt,Zt){var pr=jt(gt);Qr.push(gt),Array.isArray(Zt)?(Xr[pr]=Zt.slice(),fn[pr]=Zt.slice()):Xr[pr]=fn[pr]=Zt,Pn[pr]=Qt}function Ce(){var gt=W(),Qt=gt.link,Zt=gt.global;gt.id=aa++,gt.batchId="0";var pr=Qt(kn),Mr=gt.shared={props:"a0"};Object.keys(kn).forEach(function(mr){Mr[mr]=Zt.def(pr,".",mr)});var Vr=gt.next={},kr=gt.current={};Object.keys(Pn).forEach(function(mr){Array.isArray(Xr[mr])&&(Vr[mr]=Zt.def(Mr.next,".",mr),kr[mr]=Zt.def(Mr.current,".",mr))});var ur=gt.constants={};Object.keys(Hn).forEach(function(mr){ur[mr]=Zt.def(JSON.stringify(Hn[mr]))}),gt.invoke=function(mr,_r){switch(_r.type){case 0:var Nr=["this",Mr.context,Mr.props,gt.batchId];return mr.def(Qt(_r.data),".call(",Nr.slice(0,Math.max(_r.data.length+1,4)),")");case 1:return mr.def(Mr.props,_r.data);case 2:return mr.def(Mr.context,_r.data);case 3:return mr.def("this",_r.data);case 4:return _r.data.append(gt,mr),_r.data.ref}},gt.attribCache={};var Ir={};return gt.scopeAttrib=function(mr){if((mr=be.id(mr))in Ir)return Ir[mr];var _r=xt.scope[mr];return _r||(_r=xt.scope[mr]=new Zr),Ir[mr]=Qt(_r)},gt}function lt(gt,Qt){var Zt=gt.static,pr=gt.dynamic;if("framebuffer"in Zt){var Mr=Zt.framebuffer;return Mr?(Mr=at.getFramebuffer(Mr),N(function(kr,ur){var Ir=kr.link(Mr),mr=kr.shared;return ur.set(mr.framebuffer,".next",Ir),mr=mr.context,ur.set(mr,".framebufferWidth",Ir+".width"),ur.set(mr,".framebufferHeight",Ir+".height"),Ir})):N(function(kr,ur){var Ir=kr.shared;return ur.set(Ir.framebuffer,".next","null"),Ir=Ir.context,ur.set(Ir,".framebufferWidth",Ir+".drawingBufferWidth"),ur.set(Ir,".framebufferHeight",Ir+".drawingBufferHeight"),"null"})}if("framebuffer"in pr){var Vr=pr.framebuffer;return J(Vr,function(kr,ur){var Ir=kr.invoke(ur,Vr),mr=kr.shared,_r=mr.framebuffer;return Ir=ur.def(_r,".getFramebuffer(",Ir,")"),ur.set(_r,".next",Ir),mr=mr.context,ur.set(mr,".framebufferWidth",Ir+"?"+Ir+".width:"+mr+".drawingBufferWidth"),ur.set(mr,".framebufferHeight",Ir+"?"+Ir+".height:"+mr+".drawingBufferHeight"),Ir})}return null}function At(gt,Qt,Zt){function pr(mr){if(mr in Mr){var _r=be.id(Mr[mr]);return(mr=N(function(){return _r})).id=_r,mr}if(mr in Vr){var Nr=Vr[mr];return J(Nr,function(vn,xn){var wn=vn.invoke(xn,Nr);return xn.def(vn.shared.strings,".id(",wn,")")})}return null}var Mr=gt.static,Vr=gt.dynamic,kr=pr("frag"),ur=pr("vert"),Ir=null;return Y(kr)&&Y(ur)?(Ir=Lt.program(ur.id,kr.id,null,Zt),gt=N(function(mr,_r){return mr.link(Ir)})):gt=new Z(kr&&kr.thisDep||ur&&ur.thisDep,kr&&kr.contextDep||ur&&ur.contextDep,kr&&kr.propDep||ur&&ur.propDep,function(mr,_r){var Nr,vn,xn=mr.shared.shader;return Nr=kr?kr.append(mr,_r):_r.def(xn,".","frag"),vn=ur?ur.append(mr,_r):_r.def(xn,".","vert"),_r.def(xn+".program("+vn+","+Nr+")")}),{frag:kr,vert:ur,progVar:gt,program:Ir}}function Bt(gt,Qt){function Zt(ur,Ir){if(ur in pr){var mr=0|pr[ur];return N(function(Nr,vn){return Ir&&(Nr.OFFSET=mr),mr})}if(ur in Mr){var _r=Mr[ur];return J(_r,function(Nr,vn){var xn=Nr.invoke(vn,_r);return Ir&&(Nr.OFFSET=xn),xn})}return Ir&&Vr?N(function(Nr,vn){return Nr.OFFSET="0",0}):null}var pr=gt.static,Mr=gt.dynamic,Vr=function(){if("elements"in pr){var ur=pr.elements;X(ur)?ur=qe.getElements(qe.create(ur,!0)):ur&&(ur=qe.getElements(ur));var Ir=N(function(_r,Nr){if(ur){var vn=_r.link(ur);return _r.ELEMENTS=vn}return _r.ELEMENTS=null});return Ir.value=ur,Ir}if("elements"in Mr){var mr=Mr.elements;return J(mr,function(_r,Nr){var vn=(xn=_r.shared).isBufferArgs,xn=xn.elements,wn=_r.invoke(Nr,mr),ln=Nr.def("null");return vn=Nr.def(vn,"(",wn,")"),wn=_r.cond(vn).then(ln,"=",xn,".createStream(",wn,");").else(ln,"=",xn,".getElements(",wn,");"),Nr.entry(wn),Nr.exit(_r.cond(vn).then(xn,".destroyStream(",ln,");")),_r.ELEMENTS=ln})}return null}(),kr=Zt("offset",!0);return{elements:Vr,primitive:function(){if("primitive"in pr){var ur=pr.primitive;return N(function(mr,_r){return fe[ur]})}if("primitive"in Mr){var Ir=Mr.primitive;return J(Ir,function(mr,_r){var Nr=mr.constants.primTypes,vn=mr.invoke(_r,Ir);return _r.def(Nr,"[",vn,"]")})}return Vr?Y(Vr)?Vr.value?N(function(mr,_r){return _r.def(mr.ELEMENTS,".primType")}):N(function(){return 4}):new Z(Vr.thisDep,Vr.contextDep,Vr.propDep,function(mr,_r){var Nr=mr.ELEMENTS;return _r.def(Nr,"?",Nr,".primType:",4)}):null}(),count:function(){if("count"in pr){var ur=0|pr.count;return N(function(){return ur})}if("count"in Mr){var Ir=Mr.count;return J(Ir,function(mr,_r){return mr.invoke(_r,Ir)})}return Vr?Y(Vr)?Vr?kr?new Z(kr.thisDep,kr.contextDep,kr.propDep,function(mr,_r){return _r.def(mr.ELEMENTS,".vertCount-",mr.OFFSET)}):N(function(mr,_r){return _r.def(mr.ELEMENTS,".vertCount")}):N(function(){return-1}):new Z(Vr.thisDep||kr.thisDep,Vr.contextDep||kr.contextDep,Vr.propDep||kr.propDep,function(mr,_r){var Nr=mr.ELEMENTS;return mr.OFFSET?_r.def(Nr,"?",Nr,".vertCount-",mr.OFFSET,":-1"):_r.def(Nr,"?",Nr,".vertCount:-1")}):null}(),instances:Zt("instances",!1),offset:kr}}function Ht(gt,Qt){var Zt=gt.static,pr=gt.dynamic,Mr={};return Object.keys(Zt).forEach(function(Vr){var kr=Zt[Vr],ur=be.id(Vr),Ir=new Zr;if(X(kr))Ir.state=1,Ir.buffer=ze.getBuffer(ze.create(kr,34962,!1,!0)),Ir.type=0;else if(_r=ze.getBuffer(kr))Ir.state=1,Ir.buffer=_r,Ir.type=0;else if("constant"in kr){var mr=kr.constant;Ir.buffer="null",Ir.state=2,typeof mr=="number"?Ir.x=mr:Ke.forEach(function(zn,ca){ca<mr.length&&(Ir[zn]=mr[ca])})}else{var _r=X(kr.buffer)?ze.getBuffer(ze.create(kr.buffer,34962,!1,!0)):ze.getBuffer(kr.buffer),Nr=0|kr.offset,vn=0|kr.stride,xn=0|kr.size,wn=!!kr.normalized,ln=0;"type"in kr&&(ln=ve[kr.type]),kr=0|kr.divisor,Ir.buffer=_r,Ir.state=1,Ir.size=xn,Ir.normalized=wn,Ir.type=ln||_r.dtype,Ir.offset=Nr,Ir.stride=vn,Ir.divisor=kr}Mr[Vr]=N(function(zn,ca){var Kn=zn.attribCache;if(ur in Kn)return Kn[ur];var On={isStream:!1};return Object.keys(Ir).forEach(function(Nn){On[Nn]=Ir[Nn]}),Ir.buffer&&(On.buffer=zn.link(Ir.buffer),On.type=On.type||On.buffer+".dtype"),Kn[ur]=On})}),Object.keys(pr).forEach(function(Vr){var kr=pr[Vr];Mr[Vr]=J(kr,function(ur,Ir){function mr(Kn){Ir(wn[Kn],"=",_r,".",Kn,"|0;")}var _r=ur.invoke(Ir,kr),Nr=ur.shared,vn=ur.constants,xn=Nr.isBufferArgs,wn=(Nr=Nr.buffer,{isStream:Ir.def(!1)}),ln=new Zr;ln.state=1,Object.keys(ln).forEach(function(Kn){wn[Kn]=Ir.def(""+ln[Kn])});var zn=wn.buffer,ca=wn.type;return Ir("if(",xn,"(",_r,")){",wn.isStream,"=true;",zn,"=",Nr,".createStream(",34962,",",_r,");",ca,"=",zn,".dtype;","}else{",zn,"=",Nr,".getBuffer(",_r,");","if(",zn,"){",ca,"=",zn,".dtype;",'}else if("constant" in ',_r,"){",wn.state,"=",2,";","if(typeof "+_r+'.constant === "number"){',wn[Ke[0]],"=",_r,".constant;",Ke.slice(1).map(function(Kn){return wn[Kn]}).join("="),"=0;","}else{",Ke.map(function(Kn,On){return wn[Kn]+"="+_r+".constant.length>"+On+"?"+_r+".constant["+On+"]:0;"}).join(""),"}}else{","if(",xn,"(",_r,".buffer)){",zn,"=",Nr,".createStream(",34962,",",_r,".buffer);","}else{",zn,"=",Nr,".getBuffer(",_r,".buffer);","}",ca,'="type" in ',_r,"?",vn.glTypes,"[",_r,".type]:",zn,".dtype;",wn.normalized,"=!!",_r,".normalized;"),mr("size"),mr("offset"),mr("stride"),mr("divisor"),Ir("}}"),Ir.exit("if(",wn.isStream,"){",Nr,".destroyStream(",zn,");","}"),wn})}),Mr}function or(gt,Qt,Zt,pr,Mr){function Vr(ln){var zn=ur[ln];zn&&(mr[ln]=zn)}var kr=function(ln,zn){if(typeof(ca=ln.static).frag=="string"&&typeof ca.vert=="string"){if(0<Object.keys(zn.dynamic).length)return null;var ca=zn.static,Kn=Object.keys(ca);if(0<Kn.length&&typeof ca[Kn[0]]=="number"){for(var On=[],Nn=0;Nn<Kn.length;++Nn)On.push([0|ca[Kn[Nn]],Kn[Nn]]);return On}}return null}(gt,Qt),ur=function(ln,zn,ca){function Kn(Wn){if(Wn in On){var cn=On[Wn];Wn=!0;var $n,ua,Xa=0|cn.x,Ci=0|cn.y;return"width"in cn?$n=0|cn.width:Wn=!1,"height"in cn?ua=0|cn.height:Wn=!1,new Z(!Wn&&zn&&zn.thisDep,!Wn&&zn&&zn.contextDep,!Wn&&zn&&zn.propDep,function(vi,Aa){var Na=vi.shared.context,co=$n;"width"in cn||(co=Aa.def(Na,".","framebufferWidth","-",Xa));var Fo=ua;return"height"in cn||(Fo=Aa.def(Na,".","framebufferHeight","-",Ci)),[Xa,Ci,co,Fo]})}if(Wn in Nn){var ri=Nn[Wn];return Wn=J(ri,function(vi,Aa){var Na=vi.invoke(Aa,ri),co=vi.shared.context,Fo=Aa.def(Na,".x|0"),Yo=Aa.def(Na,".y|0");return[Fo,Yo,Aa.def('"width" in ',Na,"?",Na,".width|0:","(",co,".","framebufferWidth","-",Fo,")"),Na=Aa.def('"height" in ',Na,"?",Na,".height|0:","(",co,".","framebufferHeight","-",Yo,")")]}),zn&&(Wn.thisDep=Wn.thisDep||zn.thisDep,Wn.contextDep=Wn.contextDep||zn.contextDep,Wn.propDep=Wn.propDep||zn.propDep),Wn}return zn?new Z(zn.thisDep,zn.contextDep,zn.propDep,function(vi,Aa){var Na=vi.shared.context;return[0,0,Aa.def(Na,".","framebufferWidth"),Aa.def(Na,".","framebufferHeight")]}):null}var On=ln.static,Nn=ln.dynamic;if(ln=Kn("viewport")){var ba=ln;ln=new Z(ln.thisDep,ln.contextDep,ln.propDep,function(Wn,cn){var $n=ba.append(Wn,cn),ua=Wn.shared.context;return cn.set(ua,".viewportWidth",$n[2]),cn.set(ua,".viewportHeight",$n[3]),$n})}return{viewport:ln,scissor_box:Kn("scissor.box")}}(gt,Nr=lt(gt)),Ir=Bt(gt),mr=function(ln,zn){var ca=ln.static,Kn=ln.dynamic,On={};return Qr.forEach(function(Nn){function ba(cn,$n){if(Nn in ca){var ua=cn(ca[Nn]);On[Wn]=N(function(){return ua})}else if(Nn in Kn){var Xa=Kn[Nn];On[Wn]=J(Xa,function(Ci,ri){return $n(Ci,ri,Ci.invoke(ri,Xa))})}}var Wn=jt(Nn);switch(Nn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return ba(function(cn){return cn},function(cn,$n,ua){return ua});case"depth.func":return ba(function(cn){return $t[cn]},function(cn,$n,ua){return $n.def(cn.constants.compareFuncs,"[",ua,"]")});case"depth.range":return ba(function(cn){return cn},function(cn,$n,ua){return[$n.def("+",ua,"[0]"),$n=$n.def("+",ua,"[1]")]});case"blend.func":return ba(function(cn){return[Jt["srcRGB"in cn?cn.srcRGB:cn.src],Jt["dstRGB"in cn?cn.dstRGB:cn.dst],Jt["srcAlpha"in cn?cn.srcAlpha:cn.src],Jt["dstAlpha"in cn?cn.dstAlpha:cn.dst]]},function(cn,$n,ua){function Xa(Aa,Na){return $n.def('"',Aa,Na,'" in ',ua,"?",ua,".",Aa,Na,":",ua,".",Aa)}cn=cn.constants.blendFuncs;var Ci=Xa("src","RGB"),ri=Xa("dst","RGB"),vi=(Ci=$n.def(cn,"[",Ci,"]"),$n.def(cn,"[",Xa("src","Alpha"),"]"));return[Ci,ri=$n.def(cn,"[",ri,"]"),vi,cn=$n.def(cn,"[",Xa("dst","Alpha"),"]")]});case"blend.equation":return ba(function(cn){return typeof cn=="string"?[bn[cn],bn[cn]]:typeof cn=="object"?[bn[cn.rgb],bn[cn.alpha]]:void 0},function(cn,$n,ua){var Xa=cn.constants.blendEquations,Ci=$n.def(),ri=$n.def();return(cn=cn.cond("typeof ",ua,'==="string"')).then(Ci,"=",ri,"=",Xa,"[",ua,"];"),cn.else(Ci,"=",Xa,"[",ua,".rgb];",ri,"=",Xa,"[",ua,".alpha];"),$n(cn),[Ci,ri]});case"blend.color":return ba(function(cn){return l(4,function($n){return+cn[$n]})},function(cn,$n,ua){return l(4,function(Xa){return $n.def("+",ua,"[",Xa,"]")})});case"stencil.mask":return ba(function(cn){return 0|cn},function(cn,$n,ua){return $n.def(ua,"|0")});case"stencil.func":return ba(function(cn){return[$t[cn.cmp||"keep"],cn.ref||0,"mask"in cn?cn.mask:-1]},function(cn,$n,ua){return[cn=$n.def('"cmp" in ',ua,"?",cn.constants.compareFuncs,"[",ua,".cmp]",":",7680),$n.def(ua,".ref|0"),$n=$n.def('"mask" in ',ua,"?",ua,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return ba(function(cn){return[Nn==="stencil.opBack"?1029:1028,je[cn.fail||"keep"],je[cn.zfail||"keep"],je[cn.zpass||"keep"]]},function(cn,$n,ua){function Xa(ri){return $n.def('"',ri,'" in ',ua,"?",Ci,"[",ua,".",ri,"]:",7680)}var Ci=cn.constants.stencilOps;return[Nn==="stencil.opBack"?1029:1028,Xa("fail"),Xa("zfail"),Xa("zpass")]});case"polygonOffset.offset":return ba(function(cn){return[0|cn.factor,0|cn.units]},function(cn,$n,ua){return[$n.def(ua,".factor|0"),$n=$n.def(ua,".units|0")]});case"cull.face":return ba(function(cn){var $n=0;return cn==="front"?$n=1028:cn==="back"&&($n=1029),$n},function(cn,$n,ua){return $n.def(ua,'==="front"?',1028,":",1029)});case"lineWidth":return ba(function(cn){return cn},function(cn,$n,ua){return ua});case"frontFace":return ba(function(cn){return Ge[cn]},function(cn,$n,ua){return $n.def(ua+'==="cw"?2304:2305')});case"colorMask":return ba(function(cn){return cn.map(function($n){return!!$n})},function(cn,$n,ua){return l(4,function(Xa){return"!!"+ua+"["+Xa+"]"})});case"sample.coverage":return ba(function(cn){return["value"in cn?cn.value:1,!!cn.invert]},function(cn,$n,ua){return[$n.def('"value" in ',ua,"?+",ua,".value:1"),$n=$n.def("!!",ua,".invert")]})}}),On}(gt),_r=At(gt,0,kr);Vr("viewport"),Vr(jt("scissor.box"));var Nr,vn=0<Object.keys(mr).length;if((Nr={framebuffer:Nr,draw:Ir,shader:_r,state:mr,dirty:vn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(ln){var zn,ca=ln.static;if(ln=ln.dynamic,"profile"in ca){var Kn=!!ca.profile;(zn=N(function(Nn,ba){return Kn})).enable=Kn}else if("profile"in ln){var On=ln.profile;zn=J(On,function(Nn,ba){return Nn.invoke(ba,On)})}return zn}(gt),Nr.uniforms=function(ln,zn){var ca=ln.static,Kn=ln.dynamic,On={};return Object.keys(ca).forEach(function(Nn){var ba,Wn=ca[Nn];if(typeof Wn=="number"||typeof Wn=="boolean")ba=N(function(){return Wn});else if(typeof Wn=="function"){var cn=Wn._reglType;cn==="texture2d"||cn==="textureCube"?ba=N(function($n){return $n.link(Wn)}):cn!=="framebuffer"&&cn!=="framebufferCube"||(ba=N(function($n){return $n.link(Wn.color[0])}))}else y(Wn)&&(ba=N(function($n){return $n.global.def("[",l(Wn.length,function(ua){return Wn[ua]}),"]")}));ba.value=Wn,On[Nn]=ba}),Object.keys(Kn).forEach(function(Nn){var ba=Kn[Nn];On[Nn]=J(ba,function(Wn,cn){return Wn.invoke(cn,ba)})}),On}(Zt),Nr.drawVAO=Nr.scopeVAO=function(ln,zn){var ca=ln.static,Kn=ln.dynamic;if("vao"in ca){var On=ca.vao;return On!==null&&xt.getVAO(On)===null&&(On=xt.createVAO(On)),N(function(ba){return ba.link(xt.getVAO(On))})}if("vao"in Kn){var Nn=Kn.vao;return J(Nn,function(ba,Wn){var cn=ba.invoke(Wn,Nn);return Wn.def(ba.shared.vao+".getVAO("+cn+")")})}return null}(gt),!Nr.drawVAO&&_r.program&&!kr&&Ae.angle_instanced_arrays){var xn=!0;if(gt=_r.program.attributes.map(function(ln){return ln=Qt.static[ln],xn=xn&&!!ln,ln}),xn&&0<gt.length){var wn=xt.getVAO(xt.createVAO(gt));Nr.drawVAO=new Z(null,null,null,function(ln,zn){return ln.link(wn)}),Nr.useVAO=!0}}return kr?Nr.useVAO=!0:Nr.attributes=Ht(Qt),Nr.context=function(ln){var zn=ln.static,ca=ln.dynamic,Kn={};return Object.keys(zn).forEach(function(On){var Nn=zn[On];Kn[On]=N(function(ba,Wn){return typeof Nn=="number"||typeof Nn=="boolean"?""+Nn:ba.link(Nn)})}),Object.keys(ca).forEach(function(On){var Nn=ca[On];Kn[On]=J(Nn,function(ba,Wn){return ba.invoke(Wn,Nn)})}),Kn}(pr),Nr}function ar(gt,Qt,Zt){var pr=gt.shared.context,Mr=gt.scope();Object.keys(Zt).forEach(function(Vr){Qt.save(pr,"."+Vr),Mr(pr,".",Vr,"=",Zt[Vr].append(gt,Qt),";")}),Qt(Mr)}function Nt(gt,Qt,Zt,pr){var Mr,Vr=(ur=gt.shared).gl,kr=ur.framebuffer;br&&(Mr=Qt.def(ur.extensions,".webgl_draw_buffers"));var ur=(Ir=gt.constants).drawBuffer,Ir=Ir.backBuffer;gt=Zt?Zt.append(gt,Qt):Qt.def(kr,".next"),pr||Qt("if(",gt,"!==",kr,".cur){"),Qt("if(",gt,"){",Vr,".bindFramebuffer(",36160,",",gt,".framebuffer);"),br&&Qt(Mr,".drawBuffersWEBGL(",ur,"[",gt,".colorAttachments.length]);"),Qt("}else{",Vr,".bindFramebuffer(",36160,",null);"),br&&Qt(Mr,".drawBuffersWEBGL(",Ir,");"),Qt("}",kr,".cur=",gt,";"),pr||Qt("}")}function nr(gt,Qt,Zt){var pr=gt.shared,Mr=pr.gl,Vr=gt.current,kr=gt.next,ur=pr.current,Ir=pr.next,mr=gt.cond(ur,".dirty");Qr.forEach(function(_r){var Nr,vn;if(!((_r=jt(_r))in Zt.state))if(_r in kr){Nr=kr[_r],vn=Vr[_r];var xn=l(Xr[_r].length,function(wn){return mr.def(Nr,"[",wn,"]")});mr(gt.cond(xn.map(function(wn,ln){return wn+"!=="+vn+"["+ln+"]"}).join("||")).then(Mr,".",Pn[_r],"(",xn,");",xn.map(function(wn,ln){return vn+"["+ln+"]="+wn}).join(";"),";"))}else Nr=mr.def(Ir,".",_r),xn=gt.cond(Nr,"!==",ur,".",_r),mr(xn),_r in un?xn(gt.cond(Nr).then(Mr,".enable(",un[_r],");").else(Mr,".disable(",un[_r],");"),ur,".",_r,"=",Nr,";"):xn(Mr,".",Pn[_r],"(",Nr,");",ur,".",_r,"=",Nr,";")}),Object.keys(Zt.state).length===0&&mr(ur,".dirty=false;"),Qt(mr)}function Lr(gt,Qt,Zt,pr){var Mr=gt.shared,Vr=gt.current,kr=Mr.current,ur=Mr.gl;Q(Object.keys(Zt)).forEach(function(Ir){var mr=Zt[Ir];if(!pr||pr(mr)){var _r=mr.append(gt,Qt);if(un[Ir]){var Nr=un[Ir];Y(mr)?Qt(ur,_r?".enable(":".disable(",Nr,");"):Qt(gt.cond(_r).then(ur,".enable(",Nr,");").else(ur,".disable(",Nr,");")),Qt(kr,".",Ir,"=",_r,";")}else if(y(_r)){var vn=Vr[Ir];Qt(ur,".",Pn[Ir],"(",_r,");",_r.map(function(xn,wn){return vn+"["+wn+"]="+xn}).join(";"),";")}else Qt(ur,".",Pn[Ir],"(",_r,");",kr,".",Ir,"=",_r,";")}})}function dr(gt,Qt){Dr&&(gt.instancing=Qt.def(gt.shared.extensions,".angle_instanced_arrays"))}function Kt(gt,Qt,Zt,pr,Mr){function Vr(){return typeof performance>"u"?"Date.now()":"performance.now()"}function kr(ln){ln(mr=Qt.def(),"=",Vr(),";"),typeof Mr=="string"?ln(vn,".count+=",Mr,";"):ln(vn,".count++;"),st&&(pr?ln(_r=Qt.def(),"=",wn,".getNumPendingQueries();"):ln(wn,".beginQuery(",vn,");"))}function ur(ln){ln(vn,".cpuTime+=",Vr(),"-",mr,";"),st&&(pr?ln(wn,".pushScopeStats(",_r,",",wn,".getNumPendingQueries(),",vn,");"):ln(wn,".endQuery();"))}function Ir(ln){var zn=Qt.def(xn,".profile");Qt(xn,".profile=",ln,";"),Qt.exit(xn,".profile=",zn,";")}var mr,_r,Nr=gt.shared,vn=gt.stats,xn=Nr.current,wn=Nr.timer;if(Zt=Zt.profile){if(Y(Zt))return void(Zt.enable?(kr(Qt),ur(Qt.exit),Ir("true")):Ir("false"));Ir(Zt=Zt.append(gt,Qt))}else Zt=Qt.def(xn,".profile");kr(Nr=gt.block()),Qt("if(",Zt,"){",Nr,"}"),ur(gt=gt.block()),Qt.exit("if(",Zt,"){",gt,"}")}function yr(gt,Qt,Zt,pr,Mr){function Vr(ur,Ir,mr){function _r(){Qt("if(!",wn,".buffer){",vn,".enableVertexAttribArray(",xn,");}");var Kn,On=mr.type;Kn=mr.size?Qt.def(mr.size,"||",Ir):Ir,Qt("if(",wn,".type!==",On,"||",wn,".size!==",Kn,"||",ca.map(function(Nn){return wn+"."+Nn+"!=="+mr[Nn]}).join("||"),"){",vn,".bindBuffer(",34962,",",ln,".buffer);",vn,".vertexAttribPointer(",[xn,Kn,On,mr.normalized,mr.stride,mr.offset],");",wn,".type=",On,";",wn,".size=",Kn,";",ca.map(function(Nn){return wn+"."+Nn+"="+mr[Nn]+";"}).join(""),"}"),Dr&&(On=mr.divisor,Qt("if(",wn,".divisor!==",On,"){",gt.instancing,".vertexAttribDivisorANGLE(",[xn,On],");",wn,".divisor=",On,";}"))}function Nr(){Qt("if(",wn,".buffer){",vn,".disableVertexAttribArray(",xn,");",wn,".buffer=null;","}if(",Ke.map(function(Kn,On){return wn+"."+Kn+"!=="+zn[On]}).join("||"),"){",vn,".vertexAttrib4f(",xn,",",zn,");",Ke.map(function(Kn,On){return wn+"."+Kn+"="+zn[On]+";"}).join(""),"}")}var vn=kr.gl,xn=Qt.def(ur,".location"),wn=Qt.def(kr.attributes,"[",xn,"]");ur=mr.state;var ln=mr.buffer,zn=[mr.x,mr.y,mr.z,mr.w],ca=["buffer","normalized","offset","stride"];ur===1?_r():ur===2?Nr():(Qt("if(",ur,"===",1,"){"),_r(),Qt("}else{"),Nr(),Qt("}"))}var kr=gt.shared;pr.forEach(function(ur){var Ir,mr=ur.name,_r=Zt.attributes[mr];if(_r){if(!Mr(_r))return;Ir=_r.append(gt,Qt)}else{if(!Mr(Ct))return;var Nr=gt.scopeAttrib(mr);Ir={},Object.keys(new Zr).forEach(function(vn){Ir[vn]=Qt.def(Nr,".",vn)})}Vr(gt.link(ur),function(vn){switch(vn){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(ur.info.type),Ir)})}function xr(gt,Qt,Zt,pr,Mr){for(var Vr,kr=gt.shared,ur=kr.gl,Ir=0;Ir<pr.length;++Ir){var mr,_r=(xn=pr[Ir]).name,Nr=xn.info.type,vn=Zt.uniforms[_r],xn=gt.link(xn)+".location";if(vn){if(!Mr(vn))continue;if(Y(vn)){if(_r=vn.value,Nr===35678||Nr===35680)Qt(ur,".uniform1i(",xn,",",(Nr=gt.link(_r._texture||_r.color[0]._texture))+".bind());"),Qt.exit(Nr,".unbind();");else if(Nr===35674||Nr===35675||Nr===35676)vn=2,Nr===35675?vn=3:Nr===35676&&(vn=4),Qt(ur,".uniformMatrix",vn,"fv(",xn,",false,",_r=gt.global.def("new Float32Array(["+Array.prototype.slice.call(_r)+"])"),");");else{switch(Nr){case 5126:Vr="1f";break;case 35664:Vr="2f";break;case 35665:Vr="3f";break;case 35666:Vr="4f";break;case 35670:case 5124:Vr="1i";break;case 35671:case 35667:Vr="2i";break;case 35672:case 35668:Vr="3i";break;case 35673:Vr="4i";break;case 35669:Vr="4i"}Qt(ur,".uniform",Vr,"(",xn,",",y(_r)?Array.prototype.slice.call(_r):_r,");")}continue}mr=vn.append(gt,Qt)}else{if(!Mr(Ct))continue;mr=Qt.def(kr.uniforms,"[",be.id(_r),"]")}switch(Nr===35678?Qt("if(",mr,"&&",mr,'._reglType==="framebuffer"){',mr,"=",mr,".color[0];","}"):Nr===35680&&Qt("if(",mr,"&&",mr,'._reglType==="framebufferCube"){',mr,"=",mr,".color[0];","}"),_r=1,Nr){case 35678:case 35680:Nr=Qt.def(mr,"._texture"),Qt(ur,".uniform1i(",xn,",",Nr,".bind());"),Qt.exit(Nr,".unbind();");continue;case 5124:case 35670:Vr="1i";break;case 35667:case 35671:Vr="2i",_r=2;break;case 35668:case 35672:Vr="3i",_r=3;break;case 35669:case 35673:Vr="4i",_r=4;break;case 5126:Vr="1f";break;case 35664:Vr="2f",_r=2;break;case 35665:Vr="3f",_r=3;break;case 35666:Vr="4f",_r=4;break;case 35674:Vr="Matrix2fv";break;case 35675:Vr="Matrix3fv";break;case 35676:Vr="Matrix4fv"}if(Qt(ur,".uniform",Vr,"(",xn,","),Vr.charAt(0)==="M"){xn=Math.pow(Nr-35674+2,2);var wn=gt.global.def("new Float32Array(",xn,")");Qt("false,(Array.isArray(",mr,")||",mr," instanceof Float32Array)?",mr,":(",l(xn,function(ln){return wn+"["+ln+"]="+mr+"["+ln+"]"}),",",wn,")")}else Qt(1<_r?l(_r,function(ln){return mr+"["+ln+"]"}):mr);Qt(");")}}function gr(gt,Qt,Zt,pr){function Mr(On){var Nn=vn[On];return Nn?Nn.contextDep&&pr.contextDynamic||Nn.propDep?Nn.append(gt,Zt):Nn.append(gt,Qt):Qt.def(Nr,".",On)}function Vr(){function On(){Zt(Ir,".drawElementsInstancedANGLE(",[wn,zn,ca,ln+"<<(("+ca+"-5121)>>1)",ur],");")}function Nn(){Zt(Ir,".drawArraysInstancedANGLE(",[wn,ln,zn,ur],");")}xn?Kn?On():(Zt("if(",xn,"){"),On(),Zt("}else{"),Nn(),Zt("}")):Nn()}function kr(){function On(){Zt(_r+".drawElements("+[wn,zn,ca,ln+"<<(("+ca+"-5121)>>1)"]+");")}function Nn(){Zt(_r+".drawArrays("+[wn,ln,zn]+");")}xn?Kn?On():(Zt("if(",xn,"){"),On(),Zt("}else{"),Nn(),Zt("}")):Nn()}var ur,Ir,mr=gt.shared,_r=mr.gl,Nr=mr.draw,vn=pr.draw,xn=function(){var On=vn.elements,Nn=Qt;return On?((On.contextDep&&pr.contextDynamic||On.propDep)&&(Nn=Zt),On=On.append(gt,Nn)):On=Nn.def(Nr,".","elements"),On&&Nn("if("+On+")"+_r+".bindBuffer(34963,"+On+".buffer.buffer);"),On}(),wn=Mr("primitive"),ln=Mr("offset"),zn=function(){var On=vn.count,Nn=Qt;return On?((On.contextDep&&pr.contextDynamic||On.propDep)&&(Nn=Zt),On=On.append(gt,Nn)):On=Nn.def(Nr,".","count"),On}();if(typeof zn=="number"){if(zn===0)return}else Zt("if(",zn,"){"),Zt.exit("}");Dr&&(ur=Mr("instances"),Ir=gt.instancing);var ca=xn+".type",Kn=vn.elements&&Y(vn.elements);Dr&&(typeof ur!="number"||0<=ur)?typeof ur=="string"?(Zt("if(",ur,">0){"),Vr(),Zt("}else if(",ur,"<0){"),kr(),Zt("}")):Vr():kr()}function wr(gt,Qt,Zt,pr,Mr){return Mr=(Qt=Ce()).proc("body",Mr),Dr&&(Qt.instancing=Mr.def(Qt.shared.extensions,".angle_instanced_arrays")),gt(Qt,Mr,Zt,pr),Qt.compile().body}function zr(gt,Qt,Zt,pr){dr(gt,Qt),Zt.useVAO?Zt.drawVAO?Qt(gt.shared.vao,".setVAO(",Zt.drawVAO.append(gt,Qt),");"):Qt(gt.shared.vao,".setVAO(",gt.shared.vao,".targetVAO);"):(Qt(gt.shared.vao,".setVAO(null);"),yr(gt,Qt,Zt,pr.attributes,function(){return!0})),xr(gt,Qt,Zt,pr.uniforms,function(){return!0}),gr(gt,Qt,Qt,Zt)}function Rr(gt,Qt,Zt,pr){function Mr(){return!0}gt.batchId="a1",dr(gt,Qt),yr(gt,Qt,Zt,pr.attributes,Mr),xr(gt,Qt,Zt,pr.uniforms,Mr),gr(gt,Qt,Qt,Zt)}function Wr(gt,Qt,Zt,pr){function Mr(Nr){return Nr.contextDep&&kr||Nr.propDep}function Vr(Nr){return!Mr(Nr)}dr(gt,Qt);var kr=Zt.contextDep,ur=Qt.def(),Ir=Qt.def();gt.shared.props=Ir,gt.batchId=ur;var mr=gt.scope(),_r=gt.scope();Qt(mr.entry,"for(",ur,"=0;",ur,"<","a1",";++",ur,"){",Ir,"=","a0","[",ur,"];",_r,"}",mr.exit),Zt.needsContext&&ar(gt,_r,Zt.context),Zt.needsFramebuffer&&Nt(gt,_r,Zt.framebuffer),Lr(gt,_r,Zt.state,Mr),Zt.profile&&Mr(Zt.profile)&&Kt(gt,_r,Zt,!1,!0),pr?(Zt.useVAO?Zt.drawVAO?Mr(Zt.drawVAO)?_r(gt.shared.vao,".setVAO(",Zt.drawVAO.append(gt,_r),");"):mr(gt.shared.vao,".setVAO(",Zt.drawVAO.append(gt,mr),");"):mr(gt.shared.vao,".setVAO(",gt.shared.vao,".targetVAO);"):(mr(gt.shared.vao,".setVAO(null);"),yr(gt,mr,Zt,pr.attributes,Vr),yr(gt,_r,Zt,pr.attributes,Mr)),xr(gt,mr,Zt,pr.uniforms,Vr),xr(gt,_r,Zt,pr.uniforms,Mr),gr(gt,mr,_r,Zt)):(Qt=gt.global.def("{}"),pr=Zt.shader.progVar.append(gt,_r),Ir=_r.def(pr,".id"),mr=_r.def(Qt,"[",Ir,"]"),_r(gt.shared.gl,".useProgram(",pr,".program);","if(!",mr,"){",mr,"=",Qt,"[",Ir,"]=",gt.link(function(Nr){return wr(Rr,gt,Zt,Nr,2)}),"(",pr,");}",mr,".call(this,a0[",ur,"],",ur,");"))}function gn(gt,Qt){function Zt(kr){var ur=Qt.shader[kr];ur&&pr.set(Mr.shader,"."+kr,ur.append(gt,pr))}var pr=gt.proc("scope",3);gt.batchId="a2";var Mr=gt.shared,Vr=Mr.current;ar(gt,pr,Qt.context),Qt.framebuffer&&Qt.framebuffer.append(gt,pr),Q(Object.keys(Qt.state)).forEach(function(kr){var ur=Qt.state[kr].append(gt,pr);y(ur)?ur.forEach(function(Ir,mr){pr.set(gt.next[kr],"["+mr+"]",Ir)}):pr.set(Mr.next,"."+kr,ur)}),Kt(gt,pr,Qt,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(kr){var ur=Qt.draw[kr];ur&&pr.set(Mr.draw,"."+kr,""+ur.append(gt,pr))}),Object.keys(Qt.uniforms).forEach(function(kr){pr.set(Mr.uniforms,"["+be.id(kr)+"]",Qt.uniforms[kr].append(gt,pr))}),Object.keys(Qt.attributes).forEach(function(kr){var ur=Qt.attributes[kr].append(gt,pr),Ir=gt.scopeAttrib(kr);Object.keys(new Zr).forEach(function(mr){pr.set(Ir,"."+mr,ur[mr])})}),Qt.scopeVAO&&pr.set(Mr.vao,".targetVAO",Qt.scopeVAO.append(gt,pr)),Zt("vert"),Zt("frag"),0<Object.keys(Qt.state).length&&(pr(Vr,".dirty=true;"),pr.exit(Vr,".dirty=true;")),pr("a1(",gt.shared.context,",a0,",gt.batchId,");")}function rn(gt,Qt,Zt){var pr=Qt.static[Zt];if(pr&&function(_r){if(typeof _r=="object"&&!y(_r)){for(var Nr=Object.keys(_r),vn=0;vn<Nr.length;++vn)if(K.isDynamic(_r[Nr[vn]]))return!0;return!1}}(pr)){var Mr=gt.global,Vr=Object.keys(pr),kr=!1,ur=!1,Ir=!1,mr=gt.global.def("{}");Vr.forEach(function(_r){var Nr=pr[_r];if(K.isDynamic(Nr))typeof Nr=="function"&&(Nr=pr[_r]=K.unbox(Nr)),_r=J(Nr,null),kr=kr||_r.thisDep,Ir=Ir||_r.propDep,ur=ur||_r.contextDep;else{switch(Mr(mr,".",_r,"="),typeof Nr){case"number":Mr(Nr);break;case"string":Mr('"',Nr,'"');break;case"object":Array.isArray(Nr)&&Mr("[",Nr.join(),"]");break;default:Mr(gt.link(Nr))}Mr(";")}}),Qt.dynamic[Zt]=new K.DynamicVariable(4,{thisDep:kr,contextDep:ur,propDep:Ir,ref:mr,append:function(_r,Nr){Vr.forEach(function(vn){var xn=pr[vn];K.isDynamic(xn)&&(xn=_r.invoke(Nr,xn),Nr(mr,".",vn,"=",xn,";"))})}}),delete Qt.static[Zt]}}var Zr=xt.Record,bn={add:32774,subtract:32778,"reverse subtract":32779};Ae.ext_blend_minmax&&(bn.min=32775,bn.max=32776);var Dr=Ae.angle_instanced_arrays,br=Ae.webgl_draw_buffers,Xr={dirty:!0,profile:It.profile},fn={},Qr=[],un={},Pn={};Ut("dither",3024),Ut("blend.enable",3042),zt("blend.color","blendColor",[0,0,0,0]),zt("blend.equation","blendEquationSeparate",[32774,32774]),zt("blend.func","blendFuncSeparate",[1,0,1,0]),Ut("depth.enable",2929,!0),zt("depth.func","depthFunc",513),zt("depth.range","depthRange",[0,1]),zt("depth.mask","depthMask",!0),zt("colorMask","colorMask",[!0,!0,!0,!0]),Ut("cull.enable",2884),zt("cull.face","cullFace",1029),zt("frontFace","frontFace",2305),zt("lineWidth","lineWidth",1),Ut("polygonOffset.enable",32823),zt("polygonOffset.offset","polygonOffset",[0,0]),Ut("sample.alpha",32926),Ut("sample.enable",32928),zt("sample.coverage","sampleCoverage",[1,!1]),Ut("stencil.enable",2960),zt("stencil.mask","stencilMask",-1),zt("stencil.func","stencilFunc",[519,0,-1]),zt("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),zt("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),Ut("scissor.enable",3089),zt("scissor.box","scissor",[0,0,Ie.drawingBufferWidth,Ie.drawingBufferHeight]),zt("viewport","viewport",[0,0,Ie.drawingBufferWidth,Ie.drawingBufferHeight]);var kn={gl:Ie,context:St,strings:be,next:fn,current:Xr,draw:bt,elements:qe,buffer:ze,shader:Lt,attributes:xt.state,vao:xt,uniforms:nt,framebuffer:at,extensions:Ae,timer:st,isBufferArgs:X},Hn={primTypes:fe,compareFuncs:$t,blendFuncs:Jt,blendEquations:bn,stencilOps:je,glTypes:ve,orientationType:Ge};br&&(Hn.backBuffer=[1029],Hn.drawBuffer=l(Pe.maxDrawbuffers,function(gt){return gt===0?[0]:l(gt,function(Qt){return 36064+Qt})}));var aa=0;return{next:fn,current:Xr,procs:function(){var gt=Ce(),Qt=gt.proc("poll"),Zt=gt.proc("refresh"),pr=gt.block();Qt(pr),Zt(pr);var Mr,Vr=gt.shared,kr=Vr.gl,ur=Vr.next,Ir=Vr.current;pr(Ir,".dirty=false;"),Nt(gt,Qt),Nt(gt,Zt,null,!0),Dr&&(Mr=gt.link(Dr)),Ae.oes_vertex_array_object&&Zt(gt.link(Ae.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var mr=0;mr<Pe.maxAttributes;++mr){var _r=Zt.def(Vr.attributes,"[",mr,"]"),Nr=gt.cond(_r,".buffer");Nr.then(kr,".enableVertexAttribArray(",mr,");",kr,".bindBuffer(",34962,",",_r,".buffer.buffer);",kr,".vertexAttribPointer(",mr,",",_r,".size,",_r,".type,",_r,".normalized,",_r,".stride,",_r,".offset);").else(kr,".disableVertexAttribArray(",mr,");",kr,".vertexAttrib4f(",mr,",",_r,".x,",_r,".y,",_r,".z,",_r,".w);",_r,".buffer=null;"),Zt(Nr),Dr&&Zt(Mr,".vertexAttribDivisorANGLE(",mr,",",_r,".divisor);")}return Zt(gt.shared.vao,".currentVAO=null;",gt.shared.vao,".setVAO(",gt.shared.vao,".targetVAO);"),Object.keys(un).forEach(function(vn){var xn=un[vn],wn=pr.def(ur,".",vn),ln=gt.block();ln("if(",wn,"){",kr,".enable(",xn,")}else{",kr,".disable(",xn,")}",Ir,".",vn,"=",wn,";"),Zt(ln),Qt("if(",wn,"!==",Ir,".",vn,"){",ln,"}")}),Object.keys(Pn).forEach(function(vn){var xn,wn,ln=Pn[vn],zn=Xr[vn],ca=gt.block();ca(kr,".",ln,"("),y(zn)?(ln=zn.length,xn=gt.global.def(ur,".",vn),wn=gt.global.def(Ir,".",vn),ca(l(ln,function(Kn){return xn+"["+Kn+"]"}),");",l(ln,function(Kn){return wn+"["+Kn+"]="+xn+"["+Kn+"];"}).join("")),Qt("if(",l(ln,function(Kn){return xn+"["+Kn+"]!=="+wn+"["+Kn+"]"}).join("||"),"){",ca,"}")):(xn=pr.def(ur,".",vn),wn=pr.def(Ir,".",vn),ca(xn,");",Ir,".",vn,"=",xn,";"),Qt("if(",xn,"!==",wn,"){",ca,"}")),Zt(ca)}),gt.compile()}(),compile:function(gt,Qt,Zt,pr,Mr){var Vr=Ce();return Vr.stats=Vr.link(Mr),Object.keys(Qt.static).forEach(function(kr){rn(Vr,Qt,kr)}),Mt.forEach(function(kr){rn(Vr,gt,kr)}),Zt=or(gt,Qt,Zt,pr),function(kr,ur){var Ir=kr.proc("draw",1);dr(kr,Ir),ar(kr,Ir,ur.context),Nt(kr,Ir,ur.framebuffer),nr(kr,Ir,ur),Lr(kr,Ir,ur.state),Kt(kr,Ir,ur,!1,!0);var mr=ur.shader.progVar.append(kr,Ir);if(Ir(kr.shared.gl,".useProgram(",mr,".program);"),ur.shader.program)zr(kr,Ir,ur,ur.shader.program);else{Ir(kr.shared.vao,".setVAO(null);");var _r=kr.global.def("{}"),Nr=Ir.def(mr,".id"),vn=Ir.def(_r,"[",Nr,"]");Ir(kr.cond(vn).then(vn,".call(this,a0);").else(vn,"=",_r,"[",Nr,"]=",kr.link(function(xn){return wr(zr,kr,ur,xn,1)}),"(",mr,");",vn,".call(this,a0);"))}0<Object.keys(ur.state).length&&Ir(kr.shared.current,".dirty=true;")}(Vr,Zt),gn(Vr,Zt),function(kr,ur){function Ir(ln){return ln.contextDep&&_r||ln.propDep}var mr=kr.proc("batch",2);kr.batchId="0",dr(kr,mr);var _r=!1,Nr=!0;Object.keys(ur.context).forEach(function(ln){_r=_r||ur.context[ln].propDep}),_r||(ar(kr,mr,ur.context),Nr=!1);var vn=!1;if((xn=ur.framebuffer)?(xn.propDep?_r=vn=!0:xn.contextDep&&_r&&(vn=!0),vn||Nt(kr,mr,xn)):Nt(kr,mr,null),ur.state.viewport&&ur.state.viewport.propDep&&(_r=!0),nr(kr,mr,ur),Lr(kr,mr,ur.state,function(ln){return!Ir(ln)}),ur.profile&&Ir(ur.profile)||Kt(kr,mr,ur,!1,"a1"),ur.contextDep=_r,ur.needsContext=Nr,ur.needsFramebuffer=vn,(Nr=ur.shader.progVar).contextDep&&_r||Nr.propDep)Wr(kr,mr,ur,null);else if(Nr=Nr.append(kr,mr),mr(kr.shared.gl,".useProgram(",Nr,".program);"),ur.shader.program)Wr(kr,mr,ur,ur.shader.program);else{mr(kr.shared.vao,".setVAO(null);");var xn=kr.global.def("{}"),wn=(vn=mr.def(Nr,".id"),mr.def(xn,"[",vn,"]"));mr(kr.cond(wn).then(wn,".call(this,a0,a1);").else(wn,"=",xn,"[",vn,"]=",kr.link(function(ln){return wr(Wr,kr,ur,ln,2)}),"(",Nr,");",wn,".call(this,a0,a1);"))}0<Object.keys(ur.state).length&&mr(kr.shared.current,".dirty=true;")}(Vr,Zt),Vr.compile()}}}function U(Ie,be){for(var Ae=0;Ae<Ie.length;++Ae)if(Ie[Ae]===be)return Ae;return-1}var G=function(Ie,be){for(var Ae=Object.keys(be),Pe=0;Pe<Ae.length;++Pe)Ie[Ae[Pe]]=be[Ae[Pe]];return Ie},$=0,K={DynamicVariable:t,define:function(Ie,be){return new t(Ie,h(be+""))},isDynamic:function(Ie){return typeof Ie=="function"&&!Ie._reglType||Ie instanceof t},unbox:function(Ie,be){return typeof Ie=="function"?new t(0,Ie):Ie},accessor:h},re={next:typeof requestAnimationFrame=="function"?function(Ie){return requestAnimationFrame(Ie)}:function(Ie){return setTimeout(Ie,16)},cancel:typeof cancelAnimationFrame=="function"?function(Ie){return cancelAnimationFrame(Ie)}:clearTimeout},ne=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},ae=a();ae.zero=a();var ie=function(Ie,be){var Ae=1;be.ext_texture_filter_anisotropic&&(Ae=Ie.getParameter(34047));var Pe=1,ze=1;be.webgl_draw_buffers&&(Pe=Ie.getParameter(34852),ze=Ie.getParameter(36063));var qe=!!be.oes_texture_float;if(qe){qe=Ie.createTexture(),Ie.bindTexture(3553,qe),Ie.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var ht=Ie.createFramebuffer();if(Ie.bindFramebuffer(36160,ht),Ie.framebufferTexture2D(36160,36064,3553,qe,0),Ie.bindTexture(3553,null),Ie.checkFramebufferStatus(36160)!==36053)qe=!1;else{Ie.viewport(0,0,1,1),Ie.clearColor(1,0,0,1),Ie.clear(16384);var at=ae.allocType(5126,4);Ie.readPixels(0,0,1,1,6408,5126,at),Ie.getError()?qe=!1:(Ie.deleteFramebuffer(ht),Ie.deleteTexture(qe),qe=at[0]===1),ae.freeType(at)}}return at=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(at=Ie.createTexture(),ht=ae.allocType(5121,36),Ie.activeTexture(33984),Ie.bindTexture(34067,at),Ie.texImage2D(34069,0,6408,3,3,0,6408,5121,ht),ae.freeType(ht),Ie.bindTexture(34067,null),Ie.deleteTexture(at),at=!Ie.getError()),{colorBits:[Ie.getParameter(3410),Ie.getParameter(3411),Ie.getParameter(3412),Ie.getParameter(3413)],depthBits:Ie.getParameter(3414),stencilBits:Ie.getParameter(3415),subpixelBits:Ie.getParameter(3408),extensions:Object.keys(be).filter(function(nt){return!!be[nt]}),maxAnisotropic:Ae,maxDrawbuffers:Pe,maxColorAttachments:ze,pointSizeDims:Ie.getParameter(33901),lineWidthDims:Ie.getParameter(33902),maxViewportDims:Ie.getParameter(3386),maxCombinedTextureUnits:Ie.getParameter(35661),maxCubeMapSize:Ie.getParameter(34076),maxRenderbufferSize:Ie.getParameter(34024),maxTextureUnits:Ie.getParameter(34930),maxTextureSize:Ie.getParameter(3379),maxAttributes:Ie.getParameter(34921),maxVertexUniforms:Ie.getParameter(36347),maxVertexTextureUnits:Ie.getParameter(35660),maxVaryingVectors:Ie.getParameter(36348),maxFragmentUniforms:Ie.getParameter(36349),glsl:Ie.getParameter(35724),renderer:Ie.getParameter(7937),vendor:Ie.getParameter(7936),version:Ie.getParameter(7938),readFloat:qe,npotTextureCube:at}},he=function(Ie){return Ie instanceof Uint8Array||Ie instanceof Uint16Array||Ie instanceof Uint32Array||Ie instanceof Int8Array||Ie instanceof Int16Array||Ie instanceof Int32Array||Ie instanceof Float32Array||Ie instanceof Float64Array||Ie instanceof Uint8ClampedArray},se=function(Ie){return Object.keys(Ie).map(function(be){return Ie[be]})},de={shape:function(Ie){for(var be=[];Ie.length;Ie=Ie[0])be.push(Ie.length);return be},flatten:function(Ie,be,Ae,Pe){var ze=1;if(be.length)for(var qe=0;qe<be.length;++qe)ze*=be[qe];else ze=0;switch(Ae=Pe||ae.allocType(Ae,ze),be.length){case 0:break;case 1:for(Pe=be[0],be=0;be<Pe;++be)Ae[be]=Ie[be];break;case 2:for(Pe=be[0],be=be[1],qe=ze=0;qe<Pe;++qe)for(var ht=Ie[qe],at=0;at<be;++at)Ae[ze++]=ht[at];break;case 3:s(Ie,be[0],be[1],be[2],Ae,0);break;default:(function nt(xt,Lt,bt,St,st){for(var It=1,jt=bt+1;jt<Lt.length;++jt)It*=Lt[jt];var Ut=Lt[bt];if(Lt.length-bt==4){var zt=Lt[bt+1],Ce=Lt[bt+2];for(Lt=Lt[bt+3],jt=0;jt<Ut;++jt)s(xt[jt],zt,Ce,Lt,St,st),st+=It}else for(jt=0;jt<Ut;++jt)nt(xt[jt],Lt,bt+1,St,st),st+=It})(Ie,be,0,Ae,0)}return Ae}},ce={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ve={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Ee={dynamic:35048,stream:35040,static:35044},Le=de.flatten,Te=de.shape,xe=[];xe[5120]=1,xe[5122]=2,xe[5124]=4,xe[5121]=1,xe[5123]=2,xe[5125]=4,xe[5126]=4;var fe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ge=new Float32Array(1),ke=new Uint32Array(ge.buffer),Me=[9984,9986,9985,9987],Se=[0,6409,6410,6407,6408],De={};De[6409]=De[6406]=De[6402]=1,De[34041]=De[6410]=2,De[6407]=De[35904]=3,De[6408]=De[35906]=4;var Be=v("HTMLCanvasElement"),We=v("OffscreenCanvas"),Qe=v("CanvasRenderingContext2D"),Oe=v("ImageBitmap"),Ue=v("HTMLImageElement"),Xe=v("HTMLVideoElement"),Ye=Object.keys(ce).concat([Be,We,Qe,Oe,Ue,Xe]),$e=[];$e[5121]=1,$e[5126]=4,$e[36193]=2,$e[5123]=2,$e[5125]=4;var it=[];it[32854]=2,it[32855]=2,it[36194]=2,it[34041]=4,it[33776]=.5,it[33777]=.5,it[33778]=1,it[33779]=1,it[35986]=.5,it[35987]=1,it[34798]=1,it[35840]=.5,it[35841]=.25,it[35842]=.5,it[35843]=.25,it[36196]=.5;var ot=[];ot[32854]=2,ot[32855]=2,ot[36194]=2,ot[33189]=2,ot[36168]=1,ot[34041]=4,ot[35907]=4,ot[34836]=16,ot[34842]=8,ot[34843]=6;var Et=function(Ie,be,Ae,Pe,ze){function qe(bt){this.id=xt++,this.refCount=1,this.renderbuffer=bt,this.format=32854,this.height=this.width=0,ze.profile&&(this.stats={size:0})}function ht(bt){var St=bt.renderbuffer;Ie.bindRenderbuffer(36161,null),Ie.deleteRenderbuffer(St),bt.renderbuffer=null,bt.refCount=0,delete Lt[bt.id],Pe.renderbufferCount--}var at={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};be.ext_srgb&&(at.srgba=35907),be.ext_color_buffer_half_float&&(at.rgba16f=34842,at.rgb16f=34843),be.webgl_color_buffer_float&&(at.rgba32f=34836);var nt=[];Object.keys(at).forEach(function(bt){nt[at[bt]]=bt});var xt=0,Lt={};return qe.prototype.decRef=function(){0>=--this.refCount&&ht(this)},ze.profile&&(Pe.getTotalRenderbufferSize=function(){var bt=0;return Object.keys(Lt).forEach(function(St){bt+=Lt[St].stats.size}),bt}),{create:function(bt,St){function st(jt,Ut){var zt=0,Ce=0,lt=32854;if(typeof jt=="object"&&jt?("shape"in jt?(zt=0|(Ce=jt.shape)[0],Ce=0|Ce[1]):("radius"in jt&&(zt=Ce=0|jt.radius),"width"in jt&&(zt=0|jt.width),"height"in jt&&(Ce=0|jt.height)),"format"in jt&&(lt=at[jt.format])):typeof jt=="number"?(zt=0|jt,Ce=typeof Ut=="number"?0|Ut:zt):jt||(zt=Ce=1),zt!==It.width||Ce!==It.height||lt!==It.format)return st.width=It.width=zt,st.height=It.height=Ce,It.format=lt,Ie.bindRenderbuffer(36161,It.renderbuffer),Ie.renderbufferStorage(36161,lt,zt,Ce),ze.profile&&(It.stats.size=ot[It.format]*It.width*It.height),st.format=nt[It.format],st}var It=new qe(Ie.createRenderbuffer());return Lt[It.id]=It,Pe.renderbufferCount++,st(bt,St),st.resize=function(jt,Ut){var zt=0|jt,Ce=0|Ut||zt;return zt===It.width&&Ce===It.height||(st.width=It.width=zt,st.height=It.height=Ce,Ie.bindRenderbuffer(36161,It.renderbuffer),Ie.renderbufferStorage(36161,It.format,zt,Ce),ze.profile&&(It.stats.size=ot[It.format]*It.width*It.height)),st},st._reglType="renderbuffer",st._renderbuffer=It,ze.profile&&(st.stats=It.stats),st.destroy=function(){It.decRef()},st},clear:function(){se(Lt).forEach(ht)},restore:function(){se(Lt).forEach(function(bt){bt.renderbuffer=Ie.createRenderbuffer(),Ie.bindRenderbuffer(36161,bt.renderbuffer),Ie.renderbufferStorage(36161,bt.format,bt.width,bt.height)}),Ie.bindRenderbuffer(36161,null)}}},mt=[];mt[6408]=4,mt[6407]=3;var tt=[];tt[5121]=1,tt[5126]=4,tt[36193]=2;var Ke=["x","y","z","w"],Mt="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Jt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},$t={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},je={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ge={cw:2304,ccw:2305},Ct=new Z(!1,!1,!1,function(){});return function(Ie){function be(){if(Rr.length===0)lt&&lt.update(),Zr=null;else{Zr=re.next(be),Lt();for(var Dr=Rr.length-1;0<=Dr;--Dr){var br=Rr[Dr];br&&br(or,null,0)}st.flush(),lt&&lt.update()}}function Ae(){!Zr&&0<Rr.length&&(Zr=re.next(be))}function Pe(){Zr&&(re.cancel(be),Zr=null)}function ze(Dr){Dr.preventDefault(),Pe(),Wr.forEach(function(br){br()})}function qe(Dr){st.getError(),jt.restore(),dr.restore(),Nt.restore(),Kt.restore(),yr.restore(),xr.restore(),nr.restore(),lt&&lt.restore(),gr.procs.refresh(),Ae(),gn.forEach(function(br){br()})}function ht(Dr){function br(gt){var Qt={},Zt={};return Object.keys(gt).forEach(function(pr){var Mr=gt[pr];K.isDynamic(Mr)?Zt[pr]=K.unbox(Mr,pr):Qt[pr]=Mr}),{dynamic:Zt,static:Qt}}var Xr=br(Dr.context||{}),fn=br(Dr.uniforms||{}),Qr=br(Dr.attributes||{}),un=br(function(gt){function Qt(pr){if(pr in Zt){var Mr=Zt[pr];delete Zt[pr],Object.keys(Mr).forEach(function(Vr){Zt[pr+"."+Vr]=Mr[Vr]})}}var Zt=G({},gt);return delete Zt.uniforms,delete Zt.attributes,delete Zt.context,delete Zt.vao,"stencil"in Zt&&Zt.stencil.op&&(Zt.stencil.opBack=Zt.stencil.opFront=Zt.stencil.op,delete Zt.stencil.op),Qt("blend"),Qt("depth"),Qt("cull"),Qt("stencil"),Qt("polygonOffset"),Qt("scissor"),Qt("sample"),"vao"in gt&&(Zt.vao=gt.vao),Zt}(Dr));Dr={gpuTime:0,cpuTime:0,count:0};var Pn=(Xr=gr.compile(un,Qr,fn,Xr,Dr)).draw,kn=Xr.batch,Hn=Xr.scope,aa=[];return G(function(gt,Qt){var Zt;if(typeof gt=="function")return Hn.call(this,null,gt,0);if(typeof Qt=="function")if(typeof gt=="number")for(Zt=0;Zt<gt;++Zt)Hn.call(this,null,Qt,Zt);else{if(!Array.isArray(gt))return Hn.call(this,gt,Qt,0);for(Zt=0;Zt<gt.length;++Zt)Hn.call(this,gt[Zt],Qt,Zt)}else if(typeof gt=="number"){if(0<gt)return kn.call(this,function(pr){for(;aa.length<pr;)aa.push(null);return aa}(0|gt),0|gt)}else{if(!Array.isArray(gt))return Pn.call(this,gt);if(gt.length)return kn.call(this,gt,gt.length)}},{stats:Dr})}function at(Dr,br){var Xr=0;gr.procs.poll();var fn=br.color;fn&&(st.clearColor(+fn[0]||0,+fn[1]||0,+fn[2]||0,+fn[3]||0),Xr|=16384),"depth"in br&&(st.clearDepth(+br.depth),Xr|=256),"stencil"in br&&(st.clearStencil(0|br.stencil),Xr|=1024),st.clear(Xr)}function nt(Dr){return Rr.push(Dr),Ae(),{cancel:function(){var br=U(Rr,Dr);Rr[br]=function Xr(){var fn=U(Rr,Xr);Rr[fn]=Rr[Rr.length-1],--Rr.length,0>=Rr.length&&Pe()}}}}function xt(){var Dr=wr.viewport,br=wr.scissor_box;Dr[0]=Dr[1]=br[0]=br[1]=0,or.viewportWidth=or.framebufferWidth=or.drawingBufferWidth=Dr[2]=br[2]=st.drawingBufferWidth,or.viewportHeight=or.framebufferHeight=or.drawingBufferHeight=Dr[3]=br[3]=st.drawingBufferHeight}function Lt(){or.tick+=1,or.time=St(),xt(),gr.procs.poll()}function bt(){xt(),gr.procs.refresh(),lt&&lt.update()}function St(){return(ne()-At)/1e3}if(!(Ie=e(Ie)))return null;var st=Ie.gl,It=st.getContextAttributes();st.isContextLost();var jt=function(Dr,br){function Xr(Pn){var kn;Pn=Pn.toLowerCase();try{kn=fn[Pn]=Dr.getExtension(Pn)}catch{}return!!kn}for(var fn={},Qr=0;Qr<br.extensions.length;++Qr){var un=br.extensions[Qr];if(!Xr(un))return br.onDestroy(),br.onDone('"'+un+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return br.optionalExtensions.forEach(Xr),{extensions:fn,restore:function(){Object.keys(fn).forEach(function(Pn){if(fn[Pn]&&!Xr(Pn))throw Error("(regl): error restoring extension "+Pn)})}}}(st,Ie);if(!jt)return null;var Ut=function(){var Dr={"":0},br=[""];return{id:function(Xr){var fn=Dr[Xr];return fn||(fn=Dr[Xr]=br.length,br.push(Xr),fn)},str:function(Xr){return br[Xr]}}}(),zt={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Ce=jt.extensions,lt=function(Dr,br){function Xr(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function fn(gt,Qt,Zt){var pr=Pn.pop()||new Xr;pr.startQueryIndex=gt,pr.endQueryIndex=Qt,pr.sum=0,pr.stats=Zt,kn.push(pr)}if(!br.ext_disjoint_timer_query)return null;var Qr=[],un=[],Pn=[],kn=[],Hn=[],aa=[];return{beginQuery:function(gt){var Qt=Qr.pop()||br.ext_disjoint_timer_query.createQueryEXT();br.ext_disjoint_timer_query.beginQueryEXT(35007,Qt),un.push(Qt),fn(un.length-1,un.length,gt)},endQuery:function(){br.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:fn,update:function(){var gt,Qt;if((gt=un.length)!==0){aa.length=Math.max(aa.length,gt+1),Hn.length=Math.max(Hn.length,gt+1),Hn[0]=0;var Zt=aa[0]=0;for(Qt=gt=0;Qt<un.length;++Qt){var pr=un[Qt];br.ext_disjoint_timer_query.getQueryObjectEXT(pr,34919)?(Zt+=br.ext_disjoint_timer_query.getQueryObjectEXT(pr,34918),Qr.push(pr)):un[gt++]=pr,Hn[Qt+1]=Zt,aa[Qt+1]=gt}for(un.length=gt,Qt=gt=0;Qt<kn.length;++Qt){var Mr=(Zt=kn[Qt]).startQueryIndex;pr=Zt.endQueryIndex,Zt.sum+=Hn[pr]-Hn[Mr],Mr=aa[Mr],(pr=aa[pr])===Mr?(Zt.stats.gpuTime+=Zt.sum/1e6,Pn.push(Zt)):(Zt.startQueryIndex=Mr,Zt.endQueryIndex=pr,kn[gt++]=Zt)}kn.length=gt}},getNumPendingQueries:function(){return un.length},clear:function(){Qr.push.apply(Qr,un);for(var gt=0;gt<Qr.length;gt++)br.ext_disjoint_timer_query.deleteQueryEXT(Qr[gt]);un.length=0,Qr.length=0},restore:function(){un.length=0,Qr.length=0}}}(0,Ce),At=ne(),Bt=st.drawingBufferWidth,Ht=st.drawingBufferHeight,or={tick:0,time:0,viewportWidth:Bt,viewportHeight:Ht,framebufferWidth:Bt,framebufferHeight:Ht,drawingBufferWidth:Bt,drawingBufferHeight:Ht,pixelRatio:Ie.pixelRatio},ar=ie(st,Ce),Nt=d(st,zt,Ie,function(Dr){return nr.destroyBuffer(Dr)}),nr=S(st,Ce,ar,zt,Nt),Lr=g(st,Ce,Nt,zt),dr=P(st,Ut,zt,Ie),Kt=L(st,Ce,ar,function(){gr.procs.poll()},or,zt,Ie),yr=Et(st,Ce,0,zt,Ie),xr=w(st,Ce,ar,Kt,yr,zt),gr=D(st,Ut,Ce,ar,Nt,Lr,0,xr,{},nr,dr,{elements:null,primitive:4,count:-1,offset:0,instances:-1},or,lt,Ie),wr=(Ut=z(st,xr,gr.procs.poll,or),gr.next),zr=st.canvas,Rr=[],Wr=[],gn=[],rn=[Ie.onDestroy],Zr=null;zr&&(zr.addEventListener("webglcontextlost",ze,!1),zr.addEventListener("webglcontextrestored",qe,!1));var bn=xr.setFBO=ht({framebuffer:K.define.call(null,1,"framebuffer")});return bt(),It=G(ht,{clear:function(Dr){if("framebuffer"in Dr)if(Dr.framebuffer&&Dr.framebuffer_reglType==="framebufferCube")for(var br=0;6>br;++br)bn(G({framebuffer:Dr.framebuffer.faces[br]},Dr),at);else bn(Dr,at);else at(0,Dr)},prop:K.define.bind(null,1),context:K.define.bind(null,2),this:K.define.bind(null,3),draw:ht({}),buffer:function(Dr){return Nt.create(Dr,34962,!1,!1)},elements:function(Dr){return Lr.create(Dr,!1)},texture:Kt.create2D,cube:Kt.createCube,renderbuffer:yr.create,framebuffer:xr.create,framebufferCube:xr.createCube,vao:nr.createVAO,attributes:It,frame:nt,on:function(Dr,br){var Xr;switch(Dr){case"frame":return nt(br);case"lost":Xr=Wr;break;case"restore":Xr=gn;break;case"destroy":Xr=rn}return Xr.push(br),{cancel:function(){for(var fn=0;fn<Xr.length;++fn)if(Xr[fn]===br){Xr[fn]=Xr[Xr.length-1],Xr.pop();break}}}},limits:ar,hasExtension:function(Dr){return 0<=ar.extensions.indexOf(Dr.toLowerCase())},read:Ut,destroy:function(){Rr.length=0,Pe(),zr&&(zr.removeEventListener("webglcontextlost",ze),zr.removeEventListener("webglcontextrestored",qe)),dr.clear(),xr.clear(),yr.clear(),Kt.clear(),Lr.clear(),Nt.clear(),nr.clear(),lt&&lt.clear(),rn.forEach(function(Dr){Dr()})},_gl:st,_refresh:bt,poll:function(){Lt(),lt&&lt.update()},now:St,stats:zt}),Ie.onDone(null,It),It}})},{}],541:[function(i,B,V){var t,h="";B.exports=function(p,u){if(typeof p!="string")throw new TypeError("expected a string");if(u===1)return p;if(u===2)return p+p;var e=p.length*u;if(t!==p||t===void 0)t=p,h="";else if(h.length>=e)return h.substr(0,e);for(;e>h.length&&u>1;)1&u&&(h+=p),u>>=1,p+=p;return h=(h+=p).substr(0,e)}},{}],542:[function(i,B,V){(function(t){(function(){B.exports=t.performance&&t.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{}],543:[function(i,B,V){B.exports=function(t){for(var h=t.length,p=t[t.length-1],u=h,e=h-2;e>=0;--e){var l=p,o=t[e];(n=o-((p=l+o)-l))&&(t[--u]=p,p=n)}var a=0;for(e=u;e<h;++e){var n;l=t[e],(n=(o=p)-((p=l+o)-l))&&(t[a++]=n)}return t[a++]=p,t.length=a,t}},{}],544:[function(i,B,V){var t=i("two-product"),h=i("robust-sum"),p=i("robust-scale"),u=i("robust-compress");function e(s,r){for(var c=new Array(s.length-1),f=1;f<s.length;++f)for(var d=c[f-1]=new Array(s.length-1),g=0,m=0;g<s.length;++g)g!==r&&(d[m++]=s[f][g]);return c}function l(s){for(var r=new Array(s),c=0;c<s;++c){r[c]=new Array(s);for(var f=0;f<s;++f)r[c][f]=["m[",c,"][",f,"]"].join("")}return r}function o(s){if(s.length===2)return["sum(prod(",s[0][0],",",s[1][1],"),prod(-",s[0][1],",",s[1][0],"))"].join("");for(var r=[],c=0;c<s.length;++c)r.push(["scale(",o(e(s,c)),",",(f=c,1&f?"-":""),s[0][c],")"].join(""));return function d(g){if(g.length===1)return g[0];if(g.length===2)return["sum(",g[0],",",g[1],")"].join("");var m=g.length>>1;return["sum(",d(g.slice(0,m)),",",d(g.slice(m)),")"].join("")}(r);var f}function a(s){return new Function("sum","scale","prod","compress",["function robustDeterminant",s,"(m){return compress(",o(l(s)),")};return robustDeterminant",s].join(""))(h,p,t,u)}var n=[function(){return[0]},function(s){return[s[0][0]]}];(function(){for(;n.length<6;)n.push(a(n.length));for(var s=[],r=["function robustDeterminant(m){switch(m.length){"],c=0;c<6;++c)s.push("det"+c),r.push("case ",c,":return det",c,"(m);");r.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant"),s.push("CACHE","gen",r.join(""));var f=Function.apply(void 0,s);for(B.exports=f.apply(void 0,n.concat([n,a])),c=0;c<n.length;++c)B.exports[c]=n[c]})()},{"robust-compress":543,"robust-scale":550,"robust-sum":553,"two-product":604}],545:[function(i,B,V){var t=i("two-product"),h=i("robust-sum");B.exports=function(p,u){for(var e=t(p[0],u[0]),l=1;l<p.length;++l)e=h(e,t(p[l],u[l]));return e}},{"robust-sum":553,"two-product":604}],546:[function(i,B,V){var t=i("two-product"),h=i("robust-sum"),p=i("robust-subtract"),u=i("robust-scale");function e(f,d){for(var g=new Array(f.length-1),m=1;m<f.length;++m)for(var y=g[m-1]=new Array(f.length-1),v=0,T=0;v<f.length;++v)v!==d&&(y[T++]=f[m][v]);return g}function l(f){if(f.length===1)return f[0];if(f.length===2)return["sum(",f[0],",",f[1],")"].join("");var d=f.length>>1;return["sum(",l(f.slice(0,d)),",",l(f.slice(d)),")"].join("")}function o(f,d){if(f.charAt(0)==="m"){if(d.charAt(0)==="w"){var g=f.split("[");return["w",d.substr(1),"m",g[0].substr(1)].join("")}return["prod(",f,",",d,")"].join("")}return o(d,f)}function a(f){if(f.length===2)return[["diff(",o(f[0][0],f[1][1]),",",o(f[1][0],f[0][1]),")"].join("")];for(var d=[],g=0;g<f.length;++g)d.push(["scale(",l(a(e(f,g))),",",(m=g,!0&m?"-":""),f[0][g],")"].join(""));return d;var m}function n(f,d){for(var g=[],m=0;m<d-2;++m)g.push(["prod(m",f,"[",m,"],m",f,"[",m,"])"].join(""));return l(g)}function s(f){for(var d=[],g=[],m=function(b){for(var L=new Array(b),w=0;w<b;++w){L[w]=new Array(b);for(var C=0;C<b;++C)L[w][C]=["m",C,"[",b-w-2,"]"].join("")}return L}(f),y=0;y<f;++y)m[0][y]="1",m[f-1][y]="w"+y;for(y=0;y<f;++y)1&y?g.push.apply(g,a(e(m,y))):d.push.apply(d,a(e(m,y)));var v=l(d),T=l(g),_="exactInSphere"+f,k=[];for(y=0;y<f;++y)k.push("m"+y);var E=["function ",_,"(",k.join(),"){"];for(y=0;y<f;++y){E.push("var w",y,"=",n(y,f),";");for(var A=0;A<f;++A)A!==y&&E.push("var w",y,"m",A,"=scale(w",y,",m",A,"[0]);")}return E.push("var p=",v,",n=",T,",d=diff(p,n);return d[d.length-1];}return ",_),new Function("sum","diff","prod","scale",E.join(""))(h,p,t,u)}var r=[function(){return 0},function(){return 0},function(){return 0}];function c(f){var d=r[f.length];return d||(d=r[f.length]=s(f.length)),d.apply(void 0,f)}(function(){for(;r.length<=6;)r.push(s(r.length));for(var f=[],d=["slow"],g=0;g<=6;++g)f.push("a"+g),d.push("o"+g);var m=["function testInSphere(",f.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(g=2;g<=6;++g)m.push("case ",g,":return o",g,"(",f.slice(0,g).join(),");");m.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere"),d.push(m.join(""));var y=Function.apply(void 0,d);for(B.exports=y.apply(void 0,[c].concat(r)),g=0;g<=6;++g)B.exports[g]=r[g]})()},{"robust-scale":550,"robust-subtract":552,"robust-sum":553,"two-product":604}],547:[function(i,B,V){var t=i("robust-determinant");function h(u){for(var e="robustLinearSolve"+u+"d",l=["function ",e,"(A,b){return ["],o=0;o<u;++o){l.push("det([");for(var a=0;a<u;++a){a>0&&l.push(","),l.push("[");for(var n=0;n<u;++n)n>0&&l.push(","),n===o?l.push("+b[",a,"]"):l.push("+A[",a,"][",n,"]");l.push("]")}l.push("]),")}l.push("det(A)]}return ",e);var s=new Function("det",l.join(""));return s(u<6?t[u]:t)}var p=[function(){return[0]},function(u,e){return[[e[0]],[u[0][0]]]}];(function(){for(;p.length<6;)p.push(h(p.length));for(var u=[],e=["function dispatchLinearSolve(A,b){switch(A.length){"],l=0;l<6;++l)u.push("s"+l),e.push("case ",l,":return s",l,"(A,b);");e.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve"),u.push("CACHE","g",e.join(""));var o=Function.apply(void 0,u);for(B.exports=o.apply(void 0,p.concat([p,h])),l=0;l<6;++l)B.exports[l]=p[l]})()},{"robust-determinant":544}],548:[function(i,B,V){var t=i("two-product"),h=i("robust-sum"),p=i("robust-scale"),u=i("robust-subtract");function e(f,d){for(var g=new Array(f.length-1),m=1;m<f.length;++m)for(var y=g[m-1]=new Array(f.length-1),v=0,T=0;v<f.length;++v)v!==d&&(y[T++]=f[m][v]);return g}function l(f){if(f.length===1)return f[0];if(f.length===2)return["sum(",f[0],",",f[1],")"].join("");var d=f.length>>1;return["sum(",l(f.slice(0,d)),",",l(f.slice(d)),")"].join("")}function o(f){if(f.length===2)return[["sum(prod(",f[0][0],",",f[1][1],"),prod(-",f[0][1],",",f[1][0],"))"].join("")];for(var d=[],g=0;g<f.length;++g)d.push(["scale(",l(o(e(f,g))),",",(m=g,1&m?"-":""),f[0][g],")"].join(""));return d;var m}function a(f){for(var d=[],g=[],m=function(A){for(var b=new Array(A),L=0;L<A;++L){b[L]=new Array(A);for(var w=0;w<A;++w)b[L][w]=["m",w,"[",A-L-1,"]"].join("")}return b}(f),y=[],v=0;v<f;++v)1&v?g.push.apply(g,o(e(m,v))):d.push.apply(d,o(e(m,v))),y.push("m"+v);var T=l(d),_=l(g),k="orientation"+f+"Exact",E=["function ",k,"(",y.join(),"){var p=",T,",n=",_,",d=sub(p,n);return d[d.length-1];};return ",k].join("");return new Function("sum","prod","scale","sub",E)(h,t,p,u)}var n=a(3),s=a(4),r=[function(){return 0},function(){return 0},function(f,d){return d[0]-f[0]},function(f,d,g){var m,y=(f[1]-g[1])*(d[0]-g[0]),v=(f[0]-g[0])*(d[1]-g[1]),T=y-v;if(y>0){if(v<=0)return T;m=y+v}else{if(!(y<0)||v>=0)return T;m=-(y+v)}var _=33306690738754716e-32*m;return T>=_||T<=-_?T:n(f,d,g)},function(f,d,g,m){var y=f[0]-m[0],v=d[0]-m[0],T=g[0]-m[0],_=f[1]-m[1],k=d[1]-m[1],E=g[1]-m[1],A=f[2]-m[2],b=d[2]-m[2],L=g[2]-m[2],w=v*E,C=T*k,S=T*_,P=y*E,z=y*k,F=v*_,q=A*(w-C)+b*(S-P)+L*(z-F),W=7771561172376103e-31*((Math.abs(w)+Math.abs(C))*Math.abs(A)+(Math.abs(S)+Math.abs(P))*Math.abs(b)+(Math.abs(z)+Math.abs(F))*Math.abs(L));return q>W||-q>W?q:s(f,d,g,m)}];function c(f){var d=r[f.length];return d||(d=r[f.length]=a(f.length)),d.apply(void 0,f)}(function(){for(;r.length<=5;)r.push(a(r.length));for(var f=[],d=["slow"],g=0;g<=5;++g)f.push("a"+g),d.push("o"+g);var m=["function getOrientation(",f.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(g=2;g<=5;++g)m.push("case ",g,":return o",g,"(",f.slice(0,g).join(),");");m.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),d.push(m.join(""));var y=Function.apply(void 0,d);for(B.exports=y.apply(void 0,[c].concat(r)),g=0;g<=5;++g)B.exports[g]=r[g]})()},{"robust-scale":550,"robust-subtract":552,"robust-sum":553,"two-product":604}],549:[function(i,B,V){var t=i("robust-sum"),h=i("robust-scale");B.exports=function(p,u){if(p.length===1)return h(u,p[0]);if(u.length===1)return h(p,u[0]);if(p.length===0||u.length===0)return[0];var e=[0];if(p.length<u.length)for(var l=0;l<p.length;++l)e=t(e,h(u,p[l]));else for(l=0;l<u.length;++l)e=t(e,h(p,u[l]));return e}},{"robust-scale":550,"robust-sum":553}],550:[function(i,B,V){var t=i("two-product"),h=i("two-sum");B.exports=function(p,u){var e=p.length;if(e===1){var l=t(p[0],u);return l[0]?l:[l[1]]}var o=new Array(2*e),a=[.1,.1],n=[.1,.1],s=0;t(p[0],u,a),a[0]&&(o[s++]=a[0]);for(var r=1;r<e;++r){t(p[r],u,n);var c=a[1];h(c,n[0],a),a[0]&&(o[s++]=a[0]);var f=n[1],d=a[1],g=f+d,m=d-(g-f);a[1]=g,m&&(o[s++]=m)}return a[1]&&(o[s++]=a[1]),s===0&&(o[s++]=0),o.length=s,o}},{"two-product":604,"two-sum":605}],551:[function(i,B,V){B.exports=function(h,p,u,e){var l=t(h,u,e),o=t(p,u,e);if(l>0&&o>0||l<0&&o<0)return!1;var a=t(u,h,p),n=t(e,h,p);return a>0&&n>0||a<0&&n<0?!1:l===0&&o===0&&a===0&&n===0?function(s,r,c,f){for(var d=0;d<2;++d){var g=s[d],m=r[d],y=Math.min(g,m),v=Math.max(g,m),T=c[d],_=f[d],k=Math.min(T,_);if(Math.max(T,_)<y||v<k)return!1}return!0}(h,p,u,e):!0};var t=i("robust-orientation")[3]},{"robust-orientation":548}],552:[function(i,B,V){B.exports=function(t,h){var p=0|t.length,u=0|h.length;if(p===1&&u===1)return function(A,b){var L=A+b,w=L-A,C=A-(L-w)+(b-w);return C?[C,L]:[L]}(t[0],-h[0]);var e,l,o=new Array(p+u),a=0,n=0,s=0,r=Math.abs,c=t[n],f=r(c),d=-h[s],g=r(d);f<g?(l=c,(n+=1)<p&&(c=t[n],f=r(c))):(l=d,(s+=1)<u&&(d=-h[s],g=r(d))),n<p&&f<g||s>=u?(e=c,(n+=1)<p&&(c=t[n],f=r(c))):(e=d,(s+=1)<u&&(d=-h[s],g=r(d)));for(var m,y,v=e+l,T=v-e,_=l-T,k=_,E=v;n<p&&s<u;)f<g?(e=c,(n+=1)<p&&(c=t[n],f=r(c))):(e=d,(s+=1)<u&&(d=-h[s],g=r(d))),(_=(l=k)-(T=(v=e+l)-e))&&(o[a++]=_),k=E-((m=E+v)-(y=m-E))+(v-y),E=m;for(;n<p;)(_=(l=k)-(T=(v=(e=c)+l)-e))&&(o[a++]=_),k=E-((m=E+v)-(y=m-E))+(v-y),E=m,(n+=1)<p&&(c=t[n]);for(;s<u;)(_=(l=k)-(T=(v=(e=d)+l)-e))&&(o[a++]=_),k=E-((m=E+v)-(y=m-E))+(v-y),E=m,(s+=1)<u&&(d=-h[s]);return k&&(o[a++]=k),E&&(o[a++]=E),a||(o[a++]=0),o.length=a,o}},{}],553:[function(i,B,V){B.exports=function(t,h){var p=0|t.length,u=0|h.length;if(p===1&&u===1)return function(A,b){var L=A+b,w=L-A,C=A-(L-w)+(b-w);return C?[C,L]:[L]}(t[0],h[0]);var e,l,o=new Array(p+u),a=0,n=0,s=0,r=Math.abs,c=t[n],f=r(c),d=h[s],g=r(d);f<g?(l=c,(n+=1)<p&&(c=t[n],f=r(c))):(l=d,(s+=1)<u&&(d=h[s],g=r(d))),n<p&&f<g||s>=u?(e=c,(n+=1)<p&&(c=t[n],f=r(c))):(e=d,(s+=1)<u&&(d=h[s],g=r(d)));for(var m,y,v=e+l,T=v-e,_=l-T,k=_,E=v;n<p&&s<u;)f<g?(e=c,(n+=1)<p&&(c=t[n],f=r(c))):(e=d,(s+=1)<u&&(d=h[s],g=r(d))),(_=(l=k)-(T=(v=e+l)-e))&&(o[a++]=_),k=E-((m=E+v)-(y=m-E))+(v-y),E=m;for(;n<p;)(_=(l=k)-(T=(v=(e=c)+l)-e))&&(o[a++]=_),k=E-((m=E+v)-(y=m-E))+(v-y),E=m,(n+=1)<p&&(c=t[n]);for(;s<u;)(_=(l=k)-(T=(v=(e=d)+l)-e))&&(o[a++]=_),k=E-((m=E+v)-(y=m-E))+(v-y),E=m,(s+=1)<u&&(d=h[s]);return k&&(o[a++]=k),E&&(o[a++]=E),a||(o[a++]=0),o.length=a,o}},{}],554:[function(i,B,V){var t=i("buffer"),h=t.Buffer;function p(e,l){for(var o in e)l[o]=e[o]}function u(e,l,o){return h(e,l,o)}h.from&&h.alloc&&h.allocUnsafe&&h.allocUnsafeSlow?B.exports=t:(p(t,V),V.Buffer=u),u.prototype=Object.create(h.prototype),p(h,u),u.from=function(e,l,o){if(typeof e=="number")throw new TypeError("Argument must not be a number");return h(e,l,o)},u.alloc=function(e,l,o){if(typeof e!="number")throw new TypeError("Argument must be a number");var a=h(e);return l!==void 0?typeof o=="string"?a.fill(l,o):a.fill(l):a.fill(0),a},u.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return h(e)},u.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(e)}},{buffer:117}],555:[function(i,B,V){B.exports=function(t){return t<0?-1:t>0?1:0}},{}],556:[function(i,B,V){B.exports=function(p){return h(t(p))};var t=i("boundary-cells"),h=i("reduce-simplicial-complex")},{"boundary-cells":107,"reduce-simplicial-complex":535}],557:[function(i,B,V){B.exports=function(e,l,o,a){if(o=o||0,a===void 0&&(a=function(m){for(var y=m.length,v=0,T=0;T<y;++T)v=0|Math.max(v,m[T].length);return v-1}(e)),e.length===0||a<1)return{cells:[],vertexIds:[],vertexWeights:[]};var n=function(m,y){for(var v=m.length,T=h.mallocUint8(v),_=0;_<v;++_)T[_]=m[_]<y|0;return T}(l,+o),s=function(m,y){for(var v=m.length,T=y*(y+1)/2*v|0,_=h.mallocUint32(2*T),k=0,E=0;E<v;++E)for(var A=m[E],b=(y=A.length,0);b<y;++b)for(var L=0;L<b;++L){var w=A[L],C=A[b];_[k++]=0|Math.min(w,C),_[k++]=0|Math.max(w,C)}p(t(_,[k/2|0,2]));var S=2;for(E=2;E<k;E+=2)_[E-2]===_[E]&&_[E-1]===_[E+1]||(_[S++]=_[E],_[S++]=_[E+1]);return t(_,[S/2|0,2])}(e,a),r=function(m,y,v,T){for(var _=m.data,k=m.shape[0],E=h.mallocDouble(k),A=0,b=0;b<k;++b){var L=_[2*b],w=_[2*b+1];if(v[L]!==v[w]){var C=y[L],S=y[w];_[2*A]=L,_[2*A+1]=w,E[A++]=(S-T)/(S-C)}}return m.shape[0]=A,t(E,[A])}(s,l,n,+o),c=function(m,y){var v=h.mallocInt32(2*y),T=m.shape[0],_=m.data;v[0]=0;for(var k=0,E=0;E<T;++E){var A=_[2*E];if(A!==k){for(v[2*k+1]=E;++k<A;)v[2*k]=E,v[2*k+1]=E;v[2*k]=E}}for(v[2*k+1]=T;++k<y;)v[2*k]=v[2*k+1]=T;return v}(s,0|l.length),f=u(a)(e,s.data,c,n),d=function(m){for(var y=0|m.shape[0],v=m.data,T=new Array(y),_=0;_<y;++_)T[_]=[v[2*_],v[2*_+1]];return T}(s),g=[].slice.call(r.data,0,r.shape[0]);return h.free(n),h.free(s.data),h.free(r.data),h.free(c),{cells:f,vertexIds:d,vertexWeights:g}};var t=i("ndarray"),h=i("typedarray-pool"),p=i("ndarray-sort"),u=i("./lib/codegen")},{"./lib/codegen":558,ndarray:483,"ndarray-sort":482,"typedarray-pool":617}],558:[function(i,B,V){B.exports=function(u){var e=p[u];return e||(e=p[u]=function(l){var o=0,a=new Array(l+1);a[0]=[[]];for(var n=1;n<=l;++n)for(var s=a[n]=h(n),r=0;r<s.length;++r)o=Math.max(o,s[n].length);var c=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",l,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"];function f(g){if(!(g.length<=0)){c.push("R.push(");for(var m=0;m<g.length;++m){var y=g[m];m>0&&c.push(","),c.push("[");for(var v=0;v<y.length;++v){var T=y[v];v>0&&c.push(","),c.push("B(C,E,c[",T[0],"],c[",T[1],"])")}c.push("]")}c.push(");")}}for(n=l+1;n>1;--n){n<l+1&&c.push("else "),c.push("if(l===",n,"){");var d=[];for(r=0;r<n;++r)d.push("(S[c["+r+"]]<<"+r+")");for(c.push("var M=",d.join("+"),";if(M===0||M===",(1<<n)-1,"){continue}switch(M){"),s=a[n-1],r=0;r<s.length;++r)c.push("case ",r,":"),f(s[r]),c.push("break;");c.push("}}")}return c.push("}return R;};return getContour",l,"d"),new Function("pool",c.join(""))(t)}(u)),e};var t=i("typedarray-pool"),h=i("marching-simplex-table"),p={}},{"marching-simplex-table":462,"typedarray-pool":617}],559:[function(i,B,V){var t=i("bit-twiddle"),h=i("union-find");function p(s,r){var c=s.length,f=s.length-r.length,d=Math.min;if(f)return f;switch(c){case 0:return 0;case 1:return s[0]-r[0];case 2:return(y=s[0]+s[1]-r[0]-r[1])||d(s[0],s[1])-d(r[0],r[1]);case 3:var g=s[0]+s[1],m=r[0]+r[1];if(y=g+s[2]-(m+r[2]))return y;var y,v=d(s[0],s[1]),T=d(r[0],r[1]);return(y=d(v,s[2])-d(T,r[2]))||d(v+s[2],g)-d(T+r[2],m);default:var _=s.slice(0);_.sort();var k=r.slice(0);k.sort();for(var E=0;E<c;++E)if(f=_[E]-k[E])return f;return 0}}function u(s,r){return p(s[0],r[0])}function e(s,r){if(r){for(var c=s.length,f=new Array(c),d=0;d<c;++d)f[d]=[s[d],r[d]];for(f.sort(u),d=0;d<c;++d)s[d]=f[d][0],r[d]=f[d][1];return s}return s.sort(p),s}function l(s){if(s.length===0)return[];for(var r=1,c=s.length,f=1;f<c;++f){var d=s[f];if(p(d,s[f-1])){if(f===r){r++;continue}s[r++]=d}}return s.length=r,s}function o(s,r){for(var c=0,f=s.length-1,d=-1;c<=f;){var g=c+f>>1,m=p(s[g],r);m<=0?(m===0&&(d=g),c=g+1):m>0&&(f=g-1)}return d}function a(s,r){for(var c=new Array(s.length),f=0,d=c.length;f<d;++f)c[f]=[];for(var g=[],m=(f=0,r.length);f<m;++f)for(var y=r[f],v=y.length,T=1,_=1<<v;T<_;++T){g.length=t.popCount(T);for(var k=0,E=0;E<v;++E)T&1<<E&&(g[k++]=y[E]);var A=o(s,g);if(!(A<0))for(;c[A++].push(f),!(A>=s.length||p(s[A],g)!==0););}return c}function n(s,r){if(r<0)return[];for(var c=[],f=(1<<r+1)-1,d=0;d<s.length;++d)for(var g=s[d],m=f;m<1<<g.length;m=t.nextCombination(m)){for(var y=new Array(r+1),v=0,T=0;T<g.length;++T)m&1<<T&&(y[v++]=g[T]);c.push(y)}return e(c)}V.dimension=function(s){for(var r=0,c=Math.max,f=0,d=s.length;f<d;++f)r=c(r,s[f].length);return r-1},V.countVertices=function(s){for(var r=-1,c=Math.max,f=0,d=s.length;f<d;++f)for(var g=s[f],m=0,y=g.length;m<y;++m)r=c(r,g[m]);return r+1},V.cloneCells=function(s){for(var r=new Array(s.length),c=0,f=s.length;c<f;++c)r[c]=s[c].slice(0);return r},V.compareCells=p,V.normalize=e,V.unique=l,V.findCell=o,V.incidence=a,V.dual=function(s,r){if(!r)return a(l(n(s,0)),s);for(var c=new Array(r),f=0;f<r;++f)c[f]=[];f=0;for(var d=s.length;f<d;++f)for(var g=s[f],m=0,y=g.length;m<y;++m)c[g[m]].push(f);return c},V.explode=function(s){for(var r=[],c=0,f=s.length;c<f;++c)for(var d=s[c],g=0|d.length,m=1,y=1<<g;m<y;++m){for(var v=[],T=0;T<g;++T)m>>>T&1&&v.push(d[T]);r.push(v)}return e(r)},V.skeleton=n,V.boundary=function(s){for(var r=[],c=0,f=s.length;c<f;++c)for(var d=s[c],g=0,m=d.length;g<m;++g){for(var y=new Array(d.length-1),v=0,T=0;v<m;++v)v!==g&&(y[T++]=d[v]);r.push(y)}return e(r)},V.connectedComponents=function(s,r){return r?function(c,f){for(var d=new h(f),g=0;g<c.length;++g)for(var m=c[g],y=0;y<m.length;++y)for(var v=y+1;v<m.length;++v)d.link(m[y],m[v]);var T=[],_=d.ranks;for(g=0;g<_.length;++g)_[g]=-1;for(g=0;g<c.length;++g){var k=d.find(c[g][0]);_[k]<0?(_[k]=T.length,T.push([c[g].slice(0)])):T[_[k]].push(c[g].slice(0))}return T}(s,r):function(c){for(var f=l(e(n(c,0))),d=new h(f.length),g=0;g<c.length;++g)for(var m=c[g],y=0;y<m.length;++y)for(var v=o(f,[m[y]]),T=y+1;T<m.length;++T)d.link(v,o(f,[m[T]]));var _=[],k=d.ranks;for(g=0;g<k.length;++g)k[g]=-1;for(g=0;g<c.length;++g){var E=d.find(o(f,[c[g][0]]));k[E]<0?(k[E]=_.length,_.push([c[g].slice(0)])):_[k[E]].push(c[g].slice(0))}return _}(s)}},{"bit-twiddle":104,"union-find":618}],560:[function(i,B,V){arguments[4][104][0].apply(V,arguments)},{dup:104}],561:[function(i,B,V){arguments[4][559][0].apply(V,arguments)},{"bit-twiddle":560,dup:559,"union-find":562}],562:[function(i,B,V){function t(h){this.roots=new Array(h),this.ranks=new Array(h);for(var p=0;p<h;++p)this.roots[p]=p,this.ranks[p]=0}B.exports=t,t.prototype.length=function(){return this.roots.length},t.prototype.makeSet=function(){var h=this.roots.length;return this.roots.push(h),this.ranks.push(0),h},t.prototype.find=function(h){for(var p=this.roots;p[h]!==h;){var u=p[h];p[h]=p[u],h=u}return h},t.prototype.link=function(h,p){var u=this.find(h),e=this.find(p);if(u!==e){var l=this.ranks,o=this.roots,a=l[u],n=l[e];a<n?o[u]=e:n<a?o[e]=u:(o[e]=u,++l[u])}}},{}],563:[function(i,B,V){B.exports=function(p,u,e){for(var l=u.length,o=p.length,a=new Array(l),n=new Array(l),s=new Array(l),r=new Array(l),c=0;c<l;++c)a[c]=n[c]=-1,s[c]=1/0,r[c]=!1;for(c=0;c<o;++c){var f=p[c];if(f.length!==2)throw new Error("Input must be a graph");var d=f[1],g=f[0];n[g]!==-1?n[g]=-2:n[g]=d,a[d]!==-1?a[d]=-2:a[d]=g}function m(q){if(r[q])return 1/0;var W,X,Q,Z,Y,N=a[q],J=n[q];return N<0||J<0?1/0:(W=u[q],X=u[N],Q=u[J],Z=Math.abs(t(W,X,Q)),Y=Math.sqrt(Math.pow(X[0]-Q[0],2)+Math.pow(X[1]-Q[1],2)),Z/Y)}function y(q,W){var X=L[q],Q=L[W];L[q]=Q,L[W]=X,w[X]=W,w[Q]=q}function v(q){return s[L[q]]}function T(q){return 1&q?q-1>>1:(q>>1)-1}function _(q){for(var W=v(q);;){var X=W,Q=2*q+1,Z=2*(q+1),Y=q;if(Q<C){var N=v(Q);N<X&&(Y=Q,X=N)}if(Z<C&&v(Z)<X&&(Y=Z),Y===q)return q;y(q,Y),q=Y}}function k(q){for(var W=v(q);q>0;){var X=T(q);if(X>=0&&W<v(X)){y(q,X),q=X;continue}return q}}function E(){if(C>0){var q=L[0];return y(0,C-1),C-=1,_(0),q}return-1}function A(q,W){var X=L[q];return s[X]===W?q:(s[X]=-1/0,k(q),E(),s[X]=W,k((C+=1)-1))}function b(q){if(!r[q]){r[q]=!0;var W=a[q],X=n[q];a[X]>=0&&(a[X]=W),n[W]>=0&&(n[W]=X),w[W]>=0&&A(w[W],m(W)),w[X]>=0&&A(w[X],m(X))}}var L=[],w=new Array(l);for(c=0;c<l;++c)(s[c]=m(c))<1/0?(w[c]=L.length,L.push(c)):w[c]=-1;var C=L.length;for(c=C>>1;c>=0;--c)_(c);for(;;){var S=E();if(S<0||s[S]>e)break;b(S)}var P=[];for(c=0;c<l;++c)r[c]||(w[c]=P.length,P.push(u[c].slice()));P.length;function z(q,W){if(q[W]<0)return W;var X=W,Q=W;do{var Z=q[Q];if(!r[Q]||Z<0||Z===Q||(Z=q[Q=Z],!r[Q]||Z<0||Z===Q))break;Q=Z,X=q[X]}while(X!==Q);for(var Y=W;Y!==Q;Y=q[Y])q[Y]=Q;return Q}var F=[];return p.forEach(function(q){var W=z(a,q[0]),X=z(n,q[1]);if(W>=0&&X>=0&&W!==X){var Q=w[W],Z=w[X];Q!==Z&&F.push([Q,Z])}}),h.unique(h.normalize(F)),{positions:P,edges:F}};var t=i("robust-orientation"),h=i("simplicial-complex")},{"robust-orientation":548,"simplicial-complex":561}],564:[function(i,B,V){B.exports=function(p,u){var e,l,o,a;if(u[0][0]<u[1][0])e=u[0],l=u[1];else{if(!(u[0][0]>u[1][0]))return h(u,p);e=u[1],l=u[0]}if(p[0][0]<p[1][0])o=p[0],a=p[1];else{if(!(p[0][0]>p[1][0]))return-h(p,u);o=p[1],a=p[0]}var n=t(e,l,a),s=t(e,l,o);if(n<0){if(s<=0)return n}else if(n>0){if(s>=0)return n}else if(s)return s;if(n=t(a,o,l),s=t(a,o,e),n<0){if(s<=0)return n}else if(n>0){if(s>=0)return n}else if(s)return s;return l[0]-a[0]};var t=i("robust-orientation");function h(p,u){var e,l,o,a;if(u[0][0]<u[1][0])e=u[0],l=u[1];else{if(!(u[0][0]>u[1][0])){var n=Math.min(p[0][1],p[1][1]),s=Math.max(p[0][1],p[1][1]),r=Math.min(u[0][1],u[1][1]),c=Math.max(u[0][1],u[1][1]);return s<r?s-r:n>c?n-c:s-c}e=u[1],l=u[0]}p[0][1]<p[1][1]?(o=p[0],a=p[1]):(o=p[1],a=p[0]);var f=t(l,e,o);return f||(f=t(l,e,a))||a-l}},{"robust-orientation":548}],565:[function(i,B,V){arguments[4][251][0].apply(V,arguments)},{dup:251}],566:[function(i,B,V){B.exports=function(s){for(var r=s.length,c=2*r,f=new Array(c),d=0;d<r;++d){var g=s[d],m=g[0][0]<g[1][0];f[2*d]=new n(g[0][0],g,m,d),f[2*d+1]=new n(g[1][0],g,!m,d)}f.sort(function(b,L){var w=b.x-L.x;return w||(w=b.create-L.create)||Math.min(b.segment[0][1],b.segment[1][1])-Math.min(L.segment[0][1],L.segment[1][1])});var y=h(u),v=[],T=[],_=[];for(d=0;d<c;){for(var k=f[d].x,E=[];d<c;){var A=f[d];if(A.x!==k)break;d+=1,A.segment[0][0]===A.x&&A.segment[1][0]===A.x?A.create&&(A.segment[0][1]<A.segment[1][1]?(E.push(new a(A.segment[0][1],A.index,!0,!0)),E.push(new a(A.segment[1][1],A.index,!1,!1))):(E.push(new a(A.segment[1][1],A.index,!0,!1)),E.push(new a(A.segment[0][1],A.index,!1,!0)))):y=A.create?y.insert(A.segment,A.index):y.remove(A.segment)}v.push(y.root),T.push(k),_.push(E)}return new e(v,T,_)};var t=i("binary-search-bounds"),h=i("functional-red-black-tree"),p=i("robust-orientation"),u=i("./lib/order-segments");function e(s,r,c){this.slabs=s,this.coordinates=r,this.horizontal=c}function l(s,r){return s.y-r}function o(s,r){for(var c=null;s;){var f,d,g=s.key;g[0][0]<g[1][0]?(f=g[0],d=g[1]):(f=g[1],d=g[0]);var m=p(f,d,r);if(m<0)s=s.left;else if(m>0)if(r[0]!==g[1][0])c=s,s=s.right;else{if(y=o(s.right,r))return y;s=s.left}else{if(r[0]!==g[1][0])return s;var y;if(y=o(s.right,r))return y;s=s.left}}return c}function a(s,r,c,f){this.y=s,this.index=r,this.start=c,this.closed=f}function n(s,r,c,f){this.x=s,this.segment=r,this.create=c,this.index=f}e.prototype.castUp=function(s){var r=t.le(this.coordinates,s[0]);if(r<0)return-1;this.slabs[r];var c=o(this.slabs[r],s),f=-1;if(c&&(f=c.value),this.coordinates[r]===s[0]){var d=null;if(c&&(d=c.key),r>0){var g=o(this.slabs[r-1],s);g&&(d?u(g.key,d)>0&&(d=g.key,f=g.value):(f=g.value,d=g.key))}var m=this.horizontal[r];if(m.length>0){var y=t.ge(m,s[1],l);if(y<m.length){var v=m[y];if(s[1]===v.y){if(v.closed)return v.index;for(;y<m.length-1&&m[y+1].y===s[1];)if((v=m[y+=1]).closed)return v.index;if(v.y===s[1]&&!v.start){if((y+=1)>=m.length)return f;v=m[y]}}if(v.start)if(d){var T=p(d[0],d[1],[s[0],v.y]);d[0][0]>d[1][0]&&(T=-T),T>0&&(f=v.index)}else f=v.index;else v.y!==s[1]&&(f=v.index)}}}return f}},{"./lib/order-segments":564,"binary-search-bounds":565,"functional-red-black-tree":255,"robust-orientation":548}],567:[function(i,B,V){var t=i("robust-dot-product"),h=i("robust-sum");function p(e,l){var o=h(t(e,l),[l[l.length-1]]);return o[o.length-1]}function u(e,l,o,a){var n=-l/(a-l);n<0?n=0:n>1&&(n=1);for(var s=1-n,r=e.length,c=new Array(r),f=0;f<r;++f)c[f]=n*e[f]+s*o[f];return c}B.exports=function(e,l){for(var o=[],a=[],n=p(e[e.length-1],l),s=e[e.length-1],r=e[0],c=0;c<e.length;++c,s=r){var f=p(r=e[c],l);if(n<0&&f>0||n>0&&f<0){var d=u(s,f,r,n);o.push(d),a.push(d.slice())}f<0?a.push(r.slice()):f>0?o.push(r.slice()):(o.push(r.slice()),a.push(r.slice())),n=f}return{positive:o,negative:a}},B.exports.positive=function(e,l){for(var o=[],a=p(e[e.length-1],l),n=e[e.length-1],s=e[0],r=0;r<e.length;++r,n=s){var c=p(s=e[r],l);(a<0&&c>0||a>0&&c<0)&&o.push(u(n,c,s,a)),c>=0&&o.push(s.slice()),a=c}return o},B.exports.negative=function(e,l){for(var o=[],a=p(e[e.length-1],l),n=e[e.length-1],s=e[0],r=0;r<e.length;++r,n=s){var c=p(s=e[r],l);(a<0&&c>0||a>0&&c<0)&&o.push(u(n,c,s,a)),c<=0&&o.push(s.slice()),a=c}return o}},{"robust-dot-product":545,"robust-sum":553}],568:[function(i,B,V){(function(){var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function h(o){return u(l(o),arguments)}function p(o,a){return h.apply(null,[o].concat(a||[]))}function u(o,a){var n,s,r,c,f,d,g,m,y,v=1,T=o.length,_="";for(s=0;s<T;s++)if(typeof o[s]=="string")_+=o[s];else if(typeof o[s]=="object"){if((c=o[s]).keys)for(n=a[v],r=0;r<c.keys.length;r++){if(n==null)throw new Error(h('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[r],c.keys[r-1]));n=n[c.keys[r]]}else n=c.param_no?a[c.param_no]:a[v++];if(t.not_type.test(c.type)&&t.not_primitive.test(c.type)&&n instanceof Function&&(n=n()),t.numeric_arg.test(c.type)&&typeof n!="number"&&isNaN(n))throw new TypeError(h("[sprintf] expecting number but found %T",n));switch(t.number.test(c.type)&&(m=n>=0),c.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,c.width?parseInt(c.width):0);break;case"e":n=c.precision?parseFloat(n).toExponential(c.precision):parseFloat(n).toExponential();break;case"f":n=c.precision?parseFloat(n).toFixed(c.precision):parseFloat(n);break;case"g":n=c.precision?String(Number(n.toPrecision(c.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=c.precision?n.substring(0,c.precision):n;break;case"t":n=String(!!n),n=c.precision?n.substring(0,c.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=c.precision?n.substring(0,c.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=c.precision?n.substring(0,c.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}t.json.test(c.type)?_+=n:(!t.number.test(c.type)||m&&!c.sign?y="":(y=m?"+":"-",n=n.toString().replace(t.sign,"")),d=c.pad_char?c.pad_char==="0"?"0":c.pad_char.charAt(1):" ",g=c.width-(y+n).length,f=c.width&&g>0?d.repeat(g):"",_+=c.align?y+n+f:d==="0"?y+f+n:f+y+n)}return _}var e=Object.create(null);function l(o){if(e[o])return e[o];for(var a,n=o,s=[],r=0;n;){if((a=t.text.exec(n))!==null)s.push(a[0]);else if((a=t.modulo.exec(n))!==null)s.push("%");else{if((a=t.placeholder.exec(n))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(a[2]){r|=1;var c=[],f=a[2],d=[];if((d=t.key.exec(f))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(c.push(d[1]);(f=f.substring(d[0].length))!=="";)if((d=t.key_access.exec(f))!==null)c.push(d[1]);else{if((d=t.index_access.exec(f))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");c.push(d[1])}a[2]=c}else r|=2;if(r===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");s.push({placeholder:a[0],param_no:a[1],keys:a[2],sign:a[3],pad_char:a[4],align:a[5],width:a[6],precision:a[7],type:a[8]})}n=n.substring(a[0].length)}return e[o]=s}V!==void 0&&(V.sprintf=h,V.vsprintf=p),typeof window<"u"&&(window.sprintf=h,window.vsprintf=p)})()},{}],569:[function(i,B,V){B.exports=h;var t=i("events").EventEmitter;function h(){t.call(this)}i("inherits")(h,t),h.Readable=i("readable-stream/lib/_stream_readable.js"),h.Writable=i("readable-stream/lib/_stream_writable.js"),h.Duplex=i("readable-stream/lib/_stream_duplex.js"),h.Transform=i("readable-stream/lib/_stream_transform.js"),h.PassThrough=i("readable-stream/lib/_stream_passthrough.js"),h.finished=i("readable-stream/lib/internal/streams/end-of-stream.js"),h.pipeline=i("readable-stream/lib/internal/streams/pipeline.js"),h.Stream=h,h.prototype.pipe=function(p,u){var e=this;function l(f){p.writable&&p.write(f)===!1&&e.pause&&e.pause()}function o(){e.readable&&e.resume&&e.resume()}e.on("data",l),p.on("drain",o),p._isStdio||u&&u.end===!1||(e.on("end",n),e.on("close",s));var a=!1;function n(){a||(a=!0,p.end())}function s(){a||(a=!0,typeof p.destroy=="function"&&p.destroy())}function r(f){if(c(),t.listenerCount(this,"error")===0)throw f}function c(){e.removeListener("data",l),p.removeListener("drain",o),e.removeListener("end",n),e.removeListener("close",s),e.removeListener("error",r),p.removeListener("error",r),e.removeListener("end",c),e.removeListener("close",c),p.removeListener("close",c)}return e.on("error",r),p.on("error",r),e.on("end",c),e.on("close",c),p.on("close",c),p.emit("pipe",e),p}},{events:116,inherits:447,"readable-stream/lib/_stream_duplex.js":571,"readable-stream/lib/_stream_passthrough.js":572,"readable-stream/lib/_stream_readable.js":573,"readable-stream/lib/_stream_transform.js":574,"readable-stream/lib/_stream_writable.js":575,"readable-stream/lib/internal/streams/end-of-stream.js":579,"readable-stream/lib/internal/streams/pipeline.js":581}],570:[function(i,B,V){var t={};function h(u,e,l){l||(l=Error);var o=function(a){var n,s;function r(c,f,d){return a.call(this,function(g,m,y){return typeof e=="string"?e:e(g,m,y)}(c,f,d))||this}return s=a,(n=r).prototype=Object.create(s.prototype),n.prototype.constructor=n,n.__proto__=s,r}(l);o.prototype.name=l.name,o.prototype.code=u,t[u]=o}function p(u,e){if(Array.isArray(u)){var l=u.length;return u=u.map(function(o){return String(o)}),l>2?"one of ".concat(e," ").concat(u.slice(0,l-1).join(", "),", or ")+u[l-1]:l===2?"one of ".concat(e," ").concat(u[0]," or ").concat(u[1]):"of ".concat(e," ").concat(u[0])}return"of ".concat(e," ").concat(String(u))}h("ERR_INVALID_OPT_VALUE",function(u,e){return'The value "'+e+'" is invalid for option "'+u+'"'},TypeError),h("ERR_INVALID_ARG_TYPE",function(u,e,l){var o,a,n;if(typeof e=="string"&&(a="not ",e.substr(0,a.length)===a)?(o="must not be",e=e.replace(/^not /,"")):o="must be",function(r,c,f){return(f===void 0||f>r.length)&&(f=r.length),r.substring(f-c.length,f)===c}(u," argument"))n="The ".concat(u," ").concat(o," ").concat(p(e,"type"));else{var s=function(r,c,f){return typeof f!="number"&&(f=0),!(f+c.length>r.length)&&r.indexOf(c,f)!==-1}(u,".")?"property":"argument";n='The "'.concat(u,'" ').concat(s," ").concat(o," ").concat(p(e,"type"))}return n+=". Received type ".concat(typeof l)},TypeError),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),h("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),h("ERR_STREAM_PREMATURE_CLOSE","Premature close"),h("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),h("ERR_STREAM_WRITE_AFTER_END","write after end"),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),B.exports.codes=t},{}],571:[function(i,B,V){(function(t){(function(){var h=Object.keys||function(r){var c=[];for(var f in r)c.push(f);return c};B.exports=a;var p=i("./_stream_readable"),u=i("./_stream_writable");i("inherits")(a,p);for(var e=h(u.prototype),l=0;l<e.length;l++){var o=e[l];a.prototype[o]||(a.prototype[o]=u.prototype[o])}function a(r){if(!(this instanceof a))return new a(r);p.call(this,r),u.call(this,r),this.allowHalfOpen=!0,r&&(r.readable===!1&&(this.readable=!1),r.writable===!1&&(this.writable=!1),r.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",n)))}function n(){this._writableState.ended||t.nextTick(s,this)}function s(r){r.end()}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(r){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=r,this._writableState.destroyed=r)}})}).call(this)}).call(this,i("_process"))},{"./_stream_readable":573,"./_stream_writable":575,_process:528,inherits:447}],572:[function(i,B,V){B.exports=h;var t=i("./_stream_transform");function h(p){if(!(this instanceof h))return new h(p);t.call(this,p)}i("inherits")(h,t),h.prototype._transform=function(p,u,e){e(null,p)}},{"./_stream_transform":574,inherits:447}],573:[function(i,B,V){(function(t,h){(function(){var p;B.exports=b,b.ReadableState=A,i("events").EventEmitter;var u=function(D,U){return D.listeners(U).length},e=i("./internal/streams/stream"),l=i("buffer").Buffer,o=h.Uint8Array||function(){},a,n=i("util");a=n&&n.debuglog?n.debuglog("stream"):function(){};var s,r,c,f=i("./internal/streams/buffer_list"),d=i("./internal/streams/destroy"),g=i("./internal/streams/state").getHighWaterMark,m=i("../errors").codes,y=m.ERR_INVALID_ARG_TYPE,v=m.ERR_STREAM_PUSH_AFTER_EOF,T=m.ERR_METHOD_NOT_IMPLEMENTED,_=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;i("inherits")(b,e);var k=d.errorOrDestroy,E=["error","close","destroy","pause","resume"];function A(D,U,G){p=p||i("./_stream_duplex"),D=D||{},typeof G!="boolean"&&(G=U instanceof p),this.objectMode=!!D.objectMode,G&&(this.objectMode=this.objectMode||!!D.readableObjectMode),this.highWaterMark=g(this,D,"readableHighWaterMark",G),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=D.emitClose!==!1,this.autoDestroy=!!D.autoDestroy,this.destroyed=!1,this.defaultEncoding=D.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,D.encoding&&(s||(s=i("string_decoder/").StringDecoder),this.decoder=new s(D.encoding),this.encoding=D.encoding)}function b(D){if(p=p||i("./_stream_duplex"),!(this instanceof b))return new b(D);var U=this instanceof p;this._readableState=new A(D,this,U),this.readable=!0,D&&(typeof D.read=="function"&&(this._read=D.read),typeof D.destroy=="function"&&(this._destroy=D.destroy)),e.call(this)}function L(D,U,G,$,K){a("readableAddChunk",U);var re,ne=D._readableState;if(U===null)ne.reading=!1,function(ae,ie){if(a("onEofChunk"),!ie.ended){if(ie.decoder){var he=ie.decoder.end();he&&he.length&&(ie.buffer.push(he),ie.length+=ie.objectMode?1:he.length)}ie.ended=!0,ie.sync?S(ae):(ie.needReadable=!1,ie.emittedReadable||(ie.emittedReadable=!0,P(ae)))}}(D,ne);else if(K||(re=function(ae,ie){var he;se=ie,l.isBuffer(se)||se instanceof o||typeof ie=="string"||ie===void 0||ae.objectMode||(he=new y("chunk",["string","Buffer","Uint8Array"],ie));var se;return he}(ne,U)),re)k(D,re);else if(ne.objectMode||U&&U.length>0)if(typeof U=="string"||ne.objectMode||Object.getPrototypeOf(U)===l.prototype||(U=function(ae){return l.from(ae)}(U)),$)ne.endEmitted?k(D,new _):w(D,ne,U,!0);else if(ne.ended)k(D,new v);else{if(ne.destroyed)return!1;ne.reading=!1,ne.decoder&&!G?(U=ne.decoder.write(U),ne.objectMode||U.length!==0?w(D,ne,U,!1):z(D,ne)):w(D,ne,U,!1)}else $||(ne.reading=!1,z(D,ne));return!ne.ended&&(ne.length<ne.highWaterMark||ne.length===0)}function w(D,U,G,$){U.flowing&&U.length===0&&!U.sync?(U.awaitDrain=0,D.emit("data",G)):(U.length+=U.objectMode?1:G.length,$?U.buffer.unshift(G):U.buffer.push(G),U.needReadable&&S(D)),z(D,U)}Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(D){this._readableState&&(this._readableState.destroyed=D)}}),b.prototype.destroy=d.destroy,b.prototype._undestroy=d.undestroy,b.prototype._destroy=function(D,U){U(D)},b.prototype.push=function(D,U){var G,$=this._readableState;return $.objectMode?G=!0:typeof D=="string"&&((U=U||$.defaultEncoding)!==$.encoding&&(D=l.from(D,U),U=""),G=!0),L(this,D,U,!1,G)},b.prototype.unshift=function(D){return L(this,D,null,!0,!1)},b.prototype.isPaused=function(){return this._readableState.flowing===!1},b.prototype.setEncoding=function(D){s||(s=i("string_decoder/").StringDecoder);var U=new s(D);this._readableState.decoder=U,this._readableState.encoding=this._readableState.decoder.encoding;for(var G=this._readableState.buffer.head,$="";G!==null;)$+=U.write(G.data),G=G.next;return this._readableState.buffer.clear(),$!==""&&this._readableState.buffer.push($),this._readableState.length=$.length,this};function C(D,U){return D<=0||U.length===0&&U.ended?0:U.objectMode?1:D!=D?U.flowing&&U.length?U.buffer.head.data.length:U.length:(D>U.highWaterMark&&(U.highWaterMark=function(G){return G>=1073741824?G=1073741824:(G--,G|=G>>>1,G|=G>>>2,G|=G>>>4,G|=G>>>8,G|=G>>>16,G++),G}(D)),D<=U.length?D:U.ended?U.length:(U.needReadable=!0,0))}function S(D){var U=D._readableState;a("emitReadable",U.needReadable,U.emittedReadable),U.needReadable=!1,U.emittedReadable||(a("emitReadable",U.flowing),U.emittedReadable=!0,t.nextTick(P,D))}function P(D){var U=D._readableState;a("emitReadable_",U.destroyed,U.length,U.ended),U.destroyed||!U.length&&!U.ended||(D.emit("readable"),U.emittedReadable=!1),U.needReadable=!U.flowing&&!U.ended&&U.length<=U.highWaterMark,Q(D)}function z(D,U){U.readingMore||(U.readingMore=!0,t.nextTick(F,D,U))}function F(D,U){for(;!U.reading&&!U.ended&&(U.length<U.highWaterMark||U.flowing&&U.length===0);){var G=U.length;if(a("maybeReadMore read 0"),D.read(0),G===U.length)break}U.readingMore=!1}function q(D){var U=D._readableState;U.readableListening=D.listenerCount("readable")>0,U.resumeScheduled&&!U.paused?U.flowing=!0:D.listenerCount("data")>0&&D.resume()}function W(D){a("readable nexttick read 0"),D.read(0)}function X(D,U){a("resume",U.reading),U.reading||D.read(0),U.resumeScheduled=!1,D.emit("resume"),Q(D),U.flowing&&!U.reading&&D.read(0)}function Q(D){var U=D._readableState;for(a("flow",U.flowing);U.flowing&&D.read()!==null;);}function Z(D,U){return U.length===0?null:(U.objectMode?G=U.buffer.shift():!D||D>=U.length?(G=U.decoder?U.buffer.join(""):U.buffer.length===1?U.buffer.first():U.buffer.concat(U.length),U.buffer.clear()):G=U.buffer.consume(D,U.decoder),G);var G}function Y(D){var U=D._readableState;a("endReadable",U.endEmitted),U.endEmitted||(U.ended=!0,t.nextTick(N,U,D))}function N(D,U){if(a("endReadableNT",D.endEmitted,D.length),!D.endEmitted&&D.length===0&&(D.endEmitted=!0,U.readable=!1,U.emit("end"),D.autoDestroy)){var G=U._writableState;(!G||G.autoDestroy&&G.finished)&&U.destroy()}}function J(D,U){for(var G=0,$=D.length;G<$;G++)if(D[G]===U)return G;return-1}b.prototype.read=function(D){a("read",D),D=parseInt(D,10);var U=this._readableState,G=D;if(D!==0&&(U.emittedReadable=!1),D===0&&U.needReadable&&((U.highWaterMark!==0?U.length>=U.highWaterMark:U.length>0)||U.ended))return a("read: emitReadable",U.length,U.ended),U.length===0&&U.ended?Y(this):S(this),null;if((D=C(D,U))===0&&U.ended)return U.length===0&&Y(this),null;var $,K=U.needReadable;return a("need readable",K),(U.length===0||U.length-D<U.highWaterMark)&&a("length less than watermark",K=!0),U.ended||U.reading?a("reading or ended",K=!1):K&&(a("do read"),U.reading=!0,U.sync=!0,U.length===0&&(U.needReadable=!0),this._read(U.highWaterMark),U.sync=!1,U.reading||(D=C(G,U))),($=D>0?Z(D,U):null)===null?(U.needReadable=U.length<=U.highWaterMark,D=0):(U.length-=D,U.awaitDrain=0),U.length===0&&(U.ended||(U.needReadable=!0),G!==D&&U.ended&&Y(this)),$!==null&&this.emit("data",$),$},b.prototype._read=function(D){k(this,new T("_read()"))},b.prototype.pipe=function(D,U){var G=this,$=this._readableState;switch($.pipesCount){case 0:$.pipes=D;break;case 1:$.pipes=[$.pipes,D];break;default:$.pipes.push(D)}$.pipesCount+=1,a("pipe count=%d opts=%j",$.pipesCount,U);var K=(!U||U.end!==!1)&&D!==t.stdout&&D!==t.stderr?ne:ve;function re(Ee,Le){a("onunpipe"),Ee===G&&Le&&Le.hasUnpiped===!1&&(Le.hasUnpiped=!0,a("cleanup"),D.removeListener("close",de),D.removeListener("finish",ce),D.removeListener("drain",ae),D.removeListener("error",se),D.removeListener("unpipe",re),G.removeListener("end",ne),G.removeListener("end",ve),G.removeListener("data",he),ie=!0,!$.awaitDrain||D._writableState&&!D._writableState.needDrain||ae())}function ne(){a("onend"),D.end()}$.endEmitted?t.nextTick(K):G.once("end",K),D.on("unpipe",re);var ae=function(Ee){return function(){var Le=Ee._readableState;a("pipeOnDrain",Le.awaitDrain),Le.awaitDrain&&Le.awaitDrain--,Le.awaitDrain===0&&u(Ee,"data")&&(Le.flowing=!0,Q(Ee))}}(G);D.on("drain",ae);var ie=!1;function he(Ee){a("ondata");var Le=D.write(Ee);a("dest.write",Le),Le===!1&&(($.pipesCount===1&&$.pipes===D||$.pipesCount>1&&J($.pipes,D)!==-1)&&!ie&&(a("false write response, pause",$.awaitDrain),$.awaitDrain++),G.pause())}function se(Ee){a("onerror",Ee),ve(),D.removeListener("error",se),u(D,"error")===0&&k(D,Ee)}function de(){D.removeListener("finish",ce),ve()}function ce(){a("onfinish"),D.removeListener("close",de),ve()}function ve(){a("unpipe"),G.unpipe(D)}return G.on("data",he),function(Ee,Le,Te){if(typeof Ee.prependListener=="function")return Ee.prependListener(Le,Te);Ee._events&&Ee._events[Le]?Array.isArray(Ee._events[Le])?Ee._events[Le].unshift(Te):Ee._events[Le]=[Te,Ee._events[Le]]:Ee.on(Le,Te)}(D,"error",se),D.once("close",de),D.once("finish",ce),D.emit("pipe",G),$.flowing||(a("pipe resume"),G.resume()),D},b.prototype.unpipe=function(D){var U=this._readableState,G={hasUnpiped:!1};if(U.pipesCount===0)return this;if(U.pipesCount===1)return D&&D!==U.pipes||(D||(D=U.pipes),U.pipes=null,U.pipesCount=0,U.flowing=!1,D&&D.emit("unpipe",this,G)),this;if(!D){var $=U.pipes,K=U.pipesCount;U.pipes=null,U.pipesCount=0,U.flowing=!1;for(var re=0;re<K;re++)$[re].emit("unpipe",this,{hasUnpiped:!1});return this}var ne=J(U.pipes,D);return ne===-1||(U.pipes.splice(ne,1),U.pipesCount-=1,U.pipesCount===1&&(U.pipes=U.pipes[0]),D.emit("unpipe",this,G)),this},b.prototype.on=function(D,U){var G=e.prototype.on.call(this,D,U),$=this._readableState;return D==="data"?($.readableListening=this.listenerCount("readable")>0,$.flowing!==!1&&this.resume()):D==="readable"&&($.endEmitted||$.readableListening||($.readableListening=$.needReadable=!0,$.flowing=!1,$.emittedReadable=!1,a("on readable",$.length,$.reading),$.length?S(this):$.reading||t.nextTick(W,this))),G},b.prototype.addListener=b.prototype.on,b.prototype.removeListener=function(D,U){var G=e.prototype.removeListener.call(this,D,U);return D==="readable"&&t.nextTick(q,this),G},b.prototype.removeAllListeners=function(D){var U=e.prototype.removeAllListeners.apply(this,arguments);return D!=="readable"&&D!==void 0||t.nextTick(q,this),U},b.prototype.resume=function(){var D=this._readableState;return D.flowing||(a("resume"),D.flowing=!D.readableListening,function(U,G){G.resumeScheduled||(G.resumeScheduled=!0,t.nextTick(X,U,G))}(this,D)),D.paused=!1,this},b.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},b.prototype.wrap=function(D){var U=this,G=this._readableState,$=!1;for(var K in D.on("end",function(){if(a("wrapped end"),G.decoder&&!G.ended){var ne=G.decoder.end();ne&&ne.length&&U.push(ne)}U.push(null)}),D.on("data",function(ne){a("wrapped data"),G.decoder&&(ne=G.decoder.write(ne)),G.objectMode&&ne==null||(G.objectMode||ne&&ne.length)&&(U.push(ne)||($=!0,D.pause()))}),D)this[K]===void 0&&typeof D[K]=="function"&&(this[K]=function(ne){return function(){return D[ne].apply(D,arguments)}}(K));for(var re=0;re<E.length;re++)D.on(E[re],this.emit.bind(this,E[re]));return this._read=function(ne){a("wrapped _read",ne),$&&($=!1,D.resume())},this},typeof Symbol=="function"&&(b.prototype[Symbol.asyncIterator]=function(){return r===void 0&&(r=i("./internal/streams/async_iterator")),r(this)}),Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(b.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(b.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(D){this._readableState&&(this._readableState.flowing=D)}}),b._fromList=Z,Object.defineProperty(b.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(b.from=function(D,U){return c===void 0&&(c=i("./internal/streams/from")),c(b,D,U)})}).call(this)}).call(this,i("_process"),typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":570,"./_stream_duplex":571,"./internal/streams/async_iterator":576,"./internal/streams/buffer_list":577,"./internal/streams/destroy":578,"./internal/streams/from":580,"./internal/streams/state":582,"./internal/streams/stream":583,_process:528,buffer:117,events:116,inherits:447,"string_decoder/":584,util:115}],574:[function(i,B,V){B.exports=a;var t=i("../errors").codes,h=t.ERR_METHOD_NOT_IMPLEMENTED,p=t.ERR_MULTIPLE_CALLBACK,u=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=t.ERR_TRANSFORM_WITH_LENGTH_0,l=i("./_stream_duplex");function o(r,c){var f=this._transformState;f.transforming=!1;var d=f.writecb;if(d===null)return this.emit("error",new p);f.writechunk=null,f.writecb=null,c!=null&&this.push(c),d(r);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function a(r){if(!(this instanceof a))return new a(r);l.call(this,r),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",n)}function n(){var r=this;typeof this._flush!="function"||this._readableState.destroyed?s(this,null,null):this._flush(function(c,f){s(r,c,f)})}function s(r,c,f){if(c)return r.emit("error",c);if(f!=null&&r.push(f),r._writableState.length)throw new e;if(r._transformState.transforming)throw new u;return r.push(null)}i("inherits")(a,l),a.prototype.push=function(r,c){return this._transformState.needTransform=!1,l.prototype.push.call(this,r,c)},a.prototype._transform=function(r,c,f){f(new h("_transform()"))},a.prototype._write=function(r,c,f){var d=this._transformState;if(d.writecb=f,d.writechunk=r,d.writeencoding=c,!d.transforming){var g=this._readableState;(d.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},a.prototype._read=function(r){var c=this._transformState;c.writechunk===null||c.transforming?c.needTransform=!0:(c.transforming=!0,this._transform(c.writechunk,c.writeencoding,c.afterTransform))},a.prototype._destroy=function(r,c){l.prototype._destroy.call(this,r,function(f){c(f)})}},{"../errors":570,"./_stream_duplex":571,inherits:447}],575:[function(i,B,V){(function(t,h){(function(){function p(F){var q=this;this.next=null,this.entry=null,this.finish=function(){(function(W,X,Q){var Z=W.entry;for(W.entry=null;Z;){var Y=Z.callback;X.pendingcb--,Y(Q),Z=Z.next}X.corkedRequestsFree.next=W})(q,F)}}var u;B.exports=b,b.WritableState=A;var e={deprecate:i("util-deprecate")},l=i("./internal/streams/stream"),o=i("buffer").Buffer,a=h.Uint8Array||function(){},n,s=i("./internal/streams/destroy"),r=i("./internal/streams/state").getHighWaterMark,c=i("../errors").codes,f=c.ERR_INVALID_ARG_TYPE,d=c.ERR_METHOD_NOT_IMPLEMENTED,g=c.ERR_MULTIPLE_CALLBACK,m=c.ERR_STREAM_CANNOT_PIPE,y=c.ERR_STREAM_DESTROYED,v=c.ERR_STREAM_NULL_VALUES,T=c.ERR_STREAM_WRITE_AFTER_END,_=c.ERR_UNKNOWN_ENCODING,k=s.errorOrDestroy;function E(){}function A(F,q,W){u=u||i("./_stream_duplex"),F=F||{},typeof W!="boolean"&&(W=q instanceof u),this.objectMode=!!F.objectMode,W&&(this.objectMode=this.objectMode||!!F.writableObjectMode),this.highWaterMark=r(this,F,"writableHighWaterMark",W),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var X=F.decodeStrings===!1;this.decodeStrings=!X,this.defaultEncoding=F.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Q){(function(Z,Y){var N=Z._writableState,J=N.sync,D=N.writecb;if(typeof D!="function")throw new g;if(function(G){G.writing=!1,G.writecb=null,G.length-=G.writelen,G.writelen=0}(N),Y)(function(G,$,K,re,ne){--$.pendingcb,K?(t.nextTick(ne,re),t.nextTick(z,G,$),G._writableState.errorEmitted=!0,k(G,re)):(ne(re),G._writableState.errorEmitted=!0,k(G,re),z(G,$))})(Z,N,J,Y,D);else{var U=S(N)||Z.destroyed;U||N.corked||N.bufferProcessing||!N.bufferedRequest||C(Z,N),J?t.nextTick(w,Z,N,U,D):w(Z,N,U,D)}})(q,Q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=F.emitClose!==!1,this.autoDestroy=!!F.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new p(this)}function b(F){var q=this instanceof(u=u||i("./_stream_duplex"));if(!q&&!n.call(b,this))return new b(F);this._writableState=new A(F,this,q),this.writable=!0,F&&(typeof F.write=="function"&&(this._write=F.write),typeof F.writev=="function"&&(this._writev=F.writev),typeof F.destroy=="function"&&(this._destroy=F.destroy),typeof F.final=="function"&&(this._final=F.final)),l.call(this)}function L(F,q,W,X,Q,Z,Y){q.writelen=X,q.writecb=Y,q.writing=!0,q.sync=!0,q.destroyed?q.onwrite(new y("write")):W?F._writev(Q,q.onwrite):F._write(Q,Z,q.onwrite),q.sync=!1}function w(F,q,W,X){W||function(Q,Z){Z.length===0&&Z.needDrain&&(Z.needDrain=!1,Q.emit("drain"))}(F,q),q.pendingcb--,X(),z(F,q)}function C(F,q){q.bufferProcessing=!0;var W=q.bufferedRequest;if(F._writev&&W&&W.next){var X=q.bufferedRequestCount,Q=new Array(X),Z=q.corkedRequestsFree;Z.entry=W;for(var Y=0,N=!0;W;)Q[Y]=W,W.isBuf||(N=!1),W=W.next,Y+=1;Q.allBuffers=N,L(F,q,!0,q.length,Q,"",Z.finish),q.pendingcb++,q.lastBufferedRequest=null,Z.next?(q.corkedRequestsFree=Z.next,Z.next=null):q.corkedRequestsFree=new p(q),q.bufferedRequestCount=0}else{for(;W;){var J=W.chunk,D=W.encoding,U=W.callback;if(L(F,q,!1,q.objectMode?1:J.length,J,D,U),W=W.next,q.bufferedRequestCount--,q.writing)break}W===null&&(q.lastBufferedRequest=null)}q.bufferedRequest=W,q.bufferProcessing=!1}function S(F){return F.ending&&F.length===0&&F.bufferedRequest===null&&!F.finished&&!F.writing}function P(F,q){F._final(function(W){q.pendingcb--,W&&k(F,W),q.prefinished=!0,F.emit("prefinish"),z(F,q)})}function z(F,q){var W=S(q);if(W&&(function(Q,Z){Z.prefinished||Z.finalCalled||(typeof Q._final!="function"||Z.destroyed?(Z.prefinished=!0,Q.emit("prefinish")):(Z.pendingcb++,Z.finalCalled=!0,t.nextTick(P,Q,Z)))}(F,q),q.pendingcb===0&&(q.finished=!0,F.emit("finish"),q.autoDestroy))){var X=F._readableState;(!X||X.autoDestroy&&X.endEmitted)&&F.destroy()}return W}i("inherits")(b,l),A.prototype.getBuffer=function(){for(var F=this.bufferedRequest,q=[];F;)q.push(F),F=F.next;return q},function(){try{Object.defineProperty(A.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(n=Function.prototype[Symbol.hasInstance],Object.defineProperty(b,Symbol.hasInstance,{value:function(F){return!!n.call(this,F)||this===b&&F&&F._writableState instanceof A}})):n=function(F){return F instanceof this},b.prototype.pipe=function(){k(this,new m)},b.prototype.write=function(F,q,W){var X,Q=this._writableState,Z=!1,Y=!Q.objectMode&&(X=F,o.isBuffer(X)||X instanceof a);return Y&&!o.isBuffer(F)&&(F=function(N){return o.from(N)}(F)),typeof q=="function"&&(W=q,q=null),Y?q="buffer":q||(q=Q.defaultEncoding),typeof W!="function"&&(W=E),Q.ending?function(N,J){var D=new T;k(N,D),t.nextTick(J,D)}(this,W):(Y||function(N,J,D,U){var G;return D===null?G=new v:typeof D=="string"||J.objectMode||(G=new f("chunk",["string","Buffer"],D)),!G||(k(N,G),t.nextTick(U,G),!1)}(this,Q,F,W))&&(Q.pendingcb++,Z=function(N,J,D,U,G,$){if(!D){var K=function(ie,he,se){return ie.objectMode||ie.decodeStrings===!1||typeof he!="string"||(he=o.from(he,se)),he}(J,U,G);U!==K&&(D=!0,G="buffer",U=K)}var re=J.objectMode?1:U.length;J.length+=re;var ne=J.length<J.highWaterMark;if(ne||(J.needDrain=!0),J.writing||J.corked){var ae=J.lastBufferedRequest;J.lastBufferedRequest={chunk:U,encoding:G,isBuf:D,callback:$,next:null},ae?ae.next=J.lastBufferedRequest:J.bufferedRequest=J.lastBufferedRequest,J.bufferedRequestCount+=1}else L(N,J,!1,re,U,G,$);return ne}(this,Q,Y,F,q,W)),Z},b.prototype.cork=function(){this._writableState.corked++},b.prototype.uncork=function(){var F=this._writableState;F.corked&&(F.corked--,F.writing||F.corked||F.bufferProcessing||!F.bufferedRequest||C(this,F))},b.prototype.setDefaultEncoding=function(F){if(typeof F=="string"&&(F=F.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((F+"").toLowerCase())>-1))throw new _(F);return this._writableState.defaultEncoding=F,this},Object.defineProperty(b.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),b.prototype._write=function(F,q,W){W(new d("_write()"))},b.prototype._writev=null,b.prototype.end=function(F,q,W){var X=this._writableState;return typeof F=="function"?(W=F,F=null,q=null):typeof q=="function"&&(W=q,q=null),F!=null&&this.write(F,q),X.corked&&(X.corked=1,this.uncork()),X.ending||function(Q,Z,Y){Z.ending=!0,z(Q,Z),Y&&(Z.finished?t.nextTick(Y):Q.once("finish",Y)),Z.ended=!0,Q.writable=!1}(this,X,W),this},Object.defineProperty(b.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(F){this._writableState&&(this._writableState.destroyed=F)}}),b.prototype.destroy=s.destroy,b.prototype._undestroy=s.undestroy,b.prototype._destroy=function(F,q){q(F)}}).call(this)}).call(this,i("_process"),typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":570,"./_stream_duplex":571,"./internal/streams/destroy":578,"./internal/streams/state":582,"./internal/streams/stream":583,_process:528,buffer:117,inherits:447,"util-deprecate":622}],576:[function(i,B,V){(function(t){(function(){var h;function p(y,v,T){return v in y?Object.defineProperty(y,v,{value:T,enumerable:!0,configurable:!0,writable:!0}):y[v]=T,y}var u=i("./end-of-stream"),e=Symbol("lastResolve"),l=Symbol("lastReject"),o=Symbol("error"),a=Symbol("ended"),n=Symbol("lastPromise"),s=Symbol("handlePromise"),r=Symbol("stream");function c(y,v){return{value:y,done:v}}function f(y){var v=y[e];if(v!==null){var T=y[r].read();T!==null&&(y[n]=null,y[e]=null,y[l]=null,v(c(T,!1)))}}function d(y){t.nextTick(f,y)}var g=Object.getPrototypeOf(function(){}),m=Object.setPrototypeOf((p(h={get stream(){return this[r]},next:function(){var y=this,v=this[o];if(v!==null)return Promise.reject(v);if(this[a])return Promise.resolve(c(void 0,!0));if(this[r].destroyed)return new Promise(function(E,A){t.nextTick(function(){y[o]?A(y[o]):E(c(void 0,!0))})});var T,_=this[n];if(_)T=new Promise(function(E,A){return function(b,L){E.then(function(){A[a]?b(c(void 0,!0)):A[s](b,L)},L)}}(_,this));else{var k=this[r].read();if(k!==null)return Promise.resolve(c(k,!1));T=new Promise(this[s])}return this[n]=T,T}},Symbol.asyncIterator,function(){return this}),p(h,"return",function(){var y=this;return new Promise(function(v,T){y[r].destroy(null,function(_){_?T(_):v(c(void 0,!0))})})}),h),g);B.exports=function(y){var v,T=Object.create(m,(p(v={},r,{value:y,writable:!0}),p(v,e,{value:null,writable:!0}),p(v,l,{value:null,writable:!0}),p(v,o,{value:null,writable:!0}),p(v,a,{value:y._readableState.endEmitted,writable:!0}),p(v,s,{value:function(_,k){var E=T[r].read();E?(T[n]=null,T[e]=null,T[l]=null,_(c(E,!1))):(T[e]=_,T[l]=k)},writable:!0}),v));return T[n]=null,u(y,function(_){if(_&&_.code!=="ERR_STREAM_PREMATURE_CLOSE"){var k=T[l];return k!==null&&(T[n]=null,T[e]=null,T[l]=null,k(_)),void(T[o]=_)}var E=T[e];E!==null&&(T[n]=null,T[e]=null,T[l]=null,E(c(void 0,!0))),T[a]=!0}),y.on("readable",d.bind(null,T)),T}}).call(this)}).call(this,i("_process"))},{"./end-of-stream":579,_process:528}],577:[function(i,B,V){function t(o,a){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);a&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(o,r).enumerable})),n.push.apply(n,s)}return n}function h(o,a,n){return a in o?Object.defineProperty(o,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[a]=n,o}function p(o,a){for(var n=0;n<a.length;n++){var s=a[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(o,s.key,s)}}var u=i("buffer").Buffer,e=i("util").inspect,l=e&&e.custom||"inspect";B.exports=function(){function o(){(function(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")})(this,o),this.head=null,this.tail=null,this.length=0}var a,n;return a=o,(n=[{key:"push",value:function(s){var r={data:s,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length}},{key:"unshift",value:function(s){var r={data:s,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length}},{key:"shift",value:function(){if(this.length!==0){var s=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,s}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(s){if(this.length===0)return"";for(var r=this.head,c=""+r.data;r=r.next;)c+=s+r.data;return c}},{key:"concat",value:function(s){if(this.length===0)return u.alloc(0);for(var r,c,f,d=u.allocUnsafe(s>>>0),g=this.head,m=0;g;)r=g.data,c=d,f=m,u.prototype.copy.call(r,c,f),m+=g.data.length,g=g.next;return d}},{key:"consume",value:function(s,r){var c;return s<this.head.data.length?(c=this.head.data.slice(0,s),this.head.data=this.head.data.slice(s)):c=s===this.head.data.length?this.shift():r?this._getString(s):this._getBuffer(s),c}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(s){var r=this.head,c=1,f=r.data;for(s-=f.length;r=r.next;){var d=r.data,g=s>d.length?d.length:s;if(g===d.length?f+=d:f+=d.slice(0,s),(s-=g)==0){g===d.length?(++c,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=d.slice(g));break}++c}return this.length-=c,f}},{key:"_getBuffer",value:function(s){var r=u.allocUnsafe(s),c=this.head,f=1;for(c.data.copy(r),s-=c.data.length;c=c.next;){var d=c.data,g=s>d.length?d.length:s;if(d.copy(r,r.length-s,0,g),(s-=g)==0){g===d.length?(++f,c.next?this.head=c.next:this.head=this.tail=null):(this.head=c,c.data=d.slice(g));break}++f}return this.length-=f,r}},{key:l,value:function(s,r){return e(this,function(c){for(var f=1;f<arguments.length;f++){var d=arguments[f]!=null?arguments[f]:{};f%2?t(Object(d),!0).forEach(function(g){h(c,g,d[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(d)):t(Object(d)).forEach(function(g){Object.defineProperty(c,g,Object.getOwnPropertyDescriptor(d,g))})}return c}({},r,{depth:0,customInspect:!1}))}}])&&p(a.prototype,n),o}()},{buffer:117,util:115}],578:[function(i,B,V){(function(t){(function(){function h(e,l){u(e,l),p(e)}function p(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function u(e,l){e.emit("error",l)}B.exports={destroy:function(e,l){var o=this,a=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return a||n?(l?l(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(u,this,e)):t.nextTick(u,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(s){!l&&s?o._writableState?o._writableState.errorEmitted?t.nextTick(p,o):(o._writableState.errorEmitted=!0,t.nextTick(h,o,s)):t.nextTick(h,o,s):l?(t.nextTick(p,o),l(s)):t.nextTick(p,o)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,l){var o=e._readableState,a=e._writableState;o&&o.autoDestroy||a&&a.autoDestroy?e.destroy(l):e.emit("error",l)}}}).call(this)}).call(this,i("_process"))},{_process:528}],579:[function(i,B,V){var t=i("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function h(){}B.exports=function p(u,e,l){if(typeof e=="function")return p(u,null,e);e||(e={}),l=function(y){var v=!1;return function(){if(!v){v=!0;for(var T=arguments.length,_=new Array(T),k=0;k<T;k++)_[k]=arguments[k];y.apply(this,_)}}}(l||h);var o=e.readable||e.readable!==!1&&u.readable,a=e.writable||e.writable!==!1&&u.writable,n=function(){u.writable||r()},s=u._writableState&&u._writableState.finished,r=function(){a=!1,s=!0,o||l.call(u)},c=u._readableState&&u._readableState.endEmitted,f=function(){o=!1,c=!0,a||l.call(u)},d=function(y){l.call(u,y)},g=function(){var y;return o&&!c?(u._readableState&&u._readableState.ended||(y=new t),l.call(u,y)):a&&!s?(u._writableState&&u._writableState.ended||(y=new t),l.call(u,y)):void 0},m=function(){u.req.on("finish",r)};return function(y){return y.setHeader&&typeof y.abort=="function"}(u)?(u.on("complete",r),u.on("abort",g),u.req?m():u.on("request",m)):a&&!u._writableState&&(u.on("end",n),u.on("close",n)),u.on("end",f),u.on("finish",r),e.error!==!1&&u.on("error",d),u.on("close",g),function(){u.removeListener("complete",r),u.removeListener("abort",g),u.removeListener("request",m),u.req&&u.req.removeListener("finish",r),u.removeListener("end",n),u.removeListener("close",n),u.removeListener("finish",r),u.removeListener("end",f),u.removeListener("error",d),u.removeListener("close",g)}}},{"../../../errors":570}],580:[function(i,B,V){B.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],581:[function(i,B,V){var t,h=i("../../../errors").codes,p=h.ERR_MISSING_ARGS,u=h.ERR_STREAM_DESTROYED;function e(s){if(s)throw s}function l(s,r,c,f){f=function(m){var y=!1;return function(){y||(y=!0,m.apply(void 0,arguments))}}(f);var d=!1;s.on("close",function(){d=!0}),t===void 0&&(t=i("./end-of-stream")),t(s,{readable:r,writable:c},function(m){if(m)return f(m);d=!0,f()});var g=!1;return function(m){if(!d&&!g)return g=!0,function(y){return y.setHeader&&typeof y.abort=="function"}(s)?s.abort():typeof s.destroy=="function"?s.destroy():void f(m||new u("pipe"))}}function o(s){s()}function a(s,r){return s.pipe(r)}function n(s){return s.length?typeof s[s.length-1]!="function"?e:s.pop():e}B.exports=function(){for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];var f,d=n(r);if(Array.isArray(r[0])&&(r=r[0]),r.length<2)throw new p("streams");var g=r.map(function(m,y){var v=y<r.length-1;return l(m,v,y>0,function(T){f||(f=T),T&&g.forEach(o),v||(g.forEach(o),d(f))})});return r.reduce(a)}},{"../../../errors":570,"./end-of-stream":579}],582:[function(i,B,V){var t=i("../../../errors").codes.ERR_INVALID_OPT_VALUE;B.exports={getHighWaterMark:function(h,p,u,e){var l=function(o,a,n){return o.highWaterMark!=null?o.highWaterMark:a?o[n]:null}(p,e,u);if(l!=null){if(!isFinite(l)||Math.floor(l)!==l||l<0)throw new t(e?u:"highWaterMark",l);return Math.floor(l)}return h.objectMode?16:16384}}},{"../../../errors":570}],583:[function(i,B,V){B.exports=i("events").EventEmitter},{events:116}],584:[function(i,B,V){var t=i("safe-buffer").Buffer,h=t.isEncoding||function(c){switch((c=""+c)&&c.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function p(c){var f;switch(this.encoding=function(d){var g=function(m){if(!m)return"utf8";for(var y;;)switch(m){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return m;default:if(y)return;m=(""+m).toLowerCase(),y=!0}}(d);if(typeof g!="string"&&(t.isEncoding===h||!h(d)))throw new Error("Unknown encoding: "+d);return g||d}(c),this.encoding){case"utf16le":this.text=l,this.end=o,f=4;break;case"utf8":this.fillLast=e,f=4;break;case"base64":this.text=a,this.end=n,f=3;break;default:return this.write=s,void(this.end=r)}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(f)}function u(c){return c<=127?0:c>>5==6?2:c>>4==14?3:c>>3==30?4:c>>6==2?-1:-2}function e(c){var f=this.lastTotal-this.lastNeed,d=function(g,m,y){if((192&m[0])!=128)return g.lastNeed=0,"�";if(g.lastNeed>1&&m.length>1){if((192&m[1])!=128)return g.lastNeed=1,"�";if(g.lastNeed>2&&m.length>2&&(192&m[2])!=128)return g.lastNeed=2,"�"}}(this,c);return d!==void 0?d:this.lastNeed<=c.length?(c.copy(this.lastChar,f,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(c.copy(this.lastChar,f,0,c.length),void(this.lastNeed-=c.length))}function l(c,f){if((c.length-f)%2==0){var d=c.toString("utf16le",f);if(d){var g=d.charCodeAt(d.length-1);if(g>=55296&&g<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1],d.slice(0,-1)}return d}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=c[c.length-1],c.toString("utf16le",f,c.length-1)}function o(c){var f=c&&c.length?this.write(c):"";if(this.lastNeed){var d=this.lastTotal-this.lastNeed;return f+this.lastChar.toString("utf16le",0,d)}return f}function a(c,f){var d=(c.length-f)%3;return d===0?c.toString("base64",f):(this.lastNeed=3-d,this.lastTotal=3,d===1?this.lastChar[0]=c[c.length-1]:(this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1]),c.toString("base64",f,c.length-d))}function n(c){var f=c&&c.length?this.write(c):"";return this.lastNeed?f+this.lastChar.toString("base64",0,3-this.lastNeed):f}function s(c){return c.toString(this.encoding)}function r(c){return c&&c.length?this.write(c):""}V.StringDecoder=p,p.prototype.write=function(c){if(c.length===0)return"";var f,d;if(this.lastNeed){if((f=this.fillLast(c))===void 0)return"";d=this.lastNeed,this.lastNeed=0}else d=0;return d<c.length?f?f+this.text(c,d):this.text(c,d):f||""},p.prototype.end=function(c){var f=c&&c.length?this.write(c):"";return this.lastNeed?f+"�":f},p.prototype.text=function(c,f){var d=function(m,y,v){var T=y.length-1;if(T<v)return 0;var _=u(y[T]);return _>=0?(_>0&&(m.lastNeed=_-1),_):--T<v||_===-2?0:(_=u(y[T]))>=0?(_>0&&(m.lastNeed=_-2),_):--T<v||_===-2?0:(_=u(y[T]))>=0?(_>0&&(_===2?_=0:m.lastNeed=_-3),_):0}(this,c,f);if(!this.lastNeed)return c.toString("utf8",f);this.lastTotal=d;var g=c.length-(d-this.lastNeed);return c.copy(this.lastChar,0,g),c.toString("utf8",f,g)},p.prototype.fillLast=function(c){if(this.lastNeed<=c.length)return c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,c.length),this.lastNeed-=c.length}},{"safe-buffer":554}],585:[function(i,B,V){(function(t,h){(function(){var p=i("assert"),u=i("debug")("stream-parser");B.exports=function(d){var g=d&&typeof d._transform=="function",m=d&&typeof d._write=="function";if(!g&&!m)throw new Error("must pass a Writable or Transform stream in");u("extending Parser into stream"),d._bytes=l,d._skipBytes=o,g&&(d._passthrough=a),g?d._transform=s:d._write=n};function e(d){u("initializing parser stream"),d._parserBytesLeft=0,d._parserBuffers=[],d._parserBuffered=0,d._parserState=-1,d._parserCallback=null,typeof d.push=="function"&&(d._parserOutput=d.push.bind(d)),d._parserInit=!0}function l(d,g){p(!this._parserCallback,'there is already a "callback" set!'),p(isFinite(d)&&d>0,'can only buffer a finite number of bytes > 0, got "'+d+'"'),this._parserInit||e(this),u("buffering %o bytes",d),this._parserBytesLeft=d,this._parserCallback=g,this._parserState=0}function o(d,g){p(!this._parserCallback,'there is already a "callback" set!'),p(d>0,'can only skip > 0 bytes, got "'+d+'"'),this._parserInit||e(this),u("skipping %o bytes",d),this._parserBytesLeft=d,this._parserCallback=g,this._parserState=1}function a(d,g){p(!this._parserCallback,'There is already a "callback" set!'),p(d>0,'can only pass through > 0 bytes, got "'+d+'"'),this._parserInit||e(this),u("passing through %o bytes",d),this._parserBytesLeft=d,this._parserCallback=g,this._parserState=2}function n(d,g,m){this._parserInit||e(this),u("write(%o bytes)",d.length),typeof g=="function"&&(m=g),c(this,d,null,m)}function s(d,g,m){this._parserInit||e(this),u("transform(%o bytes)",d.length),typeof g!="function"&&(g=this._parserOutput),c(this,d,g,m)}function r(d,g,m,y){if(d._parserBytesLeft-=g.length,u("%o bytes left for stream piece",d._parserBytesLeft),d._parserState===0?(d._parserBuffers.push(g),d._parserBuffered+=g.length):d._parserState===2&&m(g),d._parserBytesLeft!==0)return y;var v=d._parserCallback;if(v&&d._parserState===0&&d._parserBuffers.length>1&&(g=h.concat(d._parserBuffers,d._parserBuffered)),d._parserState!==0&&(g=null),d._parserCallback=null,d._parserBuffered=0,d._parserState=-1,d._parserBuffers.splice(0),v){var T=[];g&&T.push(g),m&&T.push(m);var _=v.length>T.length;_&&T.push(f(y));var k=v.apply(d,T);if(!_||y===k)return y}}var c=f(function d(g,m,y,v){return g._parserBytesLeft<=0?v(new Error("got data but not currently parsing anything")):m.length<=g._parserBytesLeft?function(){return r(g,m,y,v)}:function(){var T=m.slice(0,g._parserBytesLeft);return r(g,T,y,function(_){return _?v(_):m.length>T.length?function(){return d(g,m.slice(T.length),y,v)}:void 0})}});function f(d){return function(){for(var g=d.apply(this,arguments);typeof g=="function";)g=g();return g}}}).call(this)}).call(this,i("_process"),i("buffer").Buffer)},{_process:528,assert:80,buffer:117,debug:586}],586:[function(i,B,V){(function(t){(function(){function h(){var p;try{p=V.storage.debug}catch{}return!p&&t!==void 0&&"env"in t&&(p=t.env.DEBUG),p}(V=B.exports=i("./debug")).log=function(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},V.formatArgs=function(p){var u=this.useColors;if(p[0]=(u?"%c":"")+this.namespace+(u?" %c":" ")+p[0]+(u?"%c ":" ")+"+"+V.humanize(this.diff),!!u){var e="color: "+this.color;p.splice(1,0,e,"color: inherit");var l=0,o=0;p[0].replace(/%[a-zA-Z%]/g,function(a){a!=="%%"&&(l++,a==="%c"&&(o=l))}),p.splice(o,0,e)}},V.save=function(p){try{p==null?V.storage.removeItem("debug"):V.storage.debug=p}catch{}},V.load=h,V.useColors=function(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},V.storage=typeof chrome<"u"&&chrome.storage!==void 0?chrome.storage.local:function(){try{return window.localStorage}catch{}}(),V.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],V.formatters.j=function(p){try{return JSON.stringify(p)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}},V.enable(h())}).call(this)}).call(this,i("_process"))},{"./debug":587,_process:528}],587:[function(i,B,V){var t;function h(p){function u(){if(u.enabled){var e=u,l=+new Date,o=l-(t||l);e.diff=o,e.prev=t,e.curr=l,t=l;for(var a=new Array(arguments.length),n=0;n<a.length;n++)a[n]=arguments[n];a[0]=V.coerce(a[0]),typeof a[0]!="string"&&a.unshift("%O");var s=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(c,f){if(c==="%%")return c;s++;var d=V.formatters[f];if(typeof d=="function"){var g=a[s];c=d.call(e,g),a.splice(s,1),s--}return c}),V.formatArgs.call(e,a);var r=u.log||V.log||console.log.bind(console);r.apply(e,a)}}return u.namespace=p,u.enabled=V.enabled(p),u.useColors=V.useColors(),u.color=function(e){var l,o=0;for(l in e)o=(o<<5)-o+e.charCodeAt(l),o|=0;return V.colors[Math.abs(o)%V.colors.length]}(p),typeof V.init=="function"&&V.init(u),u}(V=B.exports=h.debug=h.default=h).coerce=function(p){return p instanceof Error?p.stack||p.message:p},V.disable=function(){V.enable("")},V.enable=function(p){V.save(p),V.names=[],V.skips=[];for(var u=(typeof p=="string"?p:"").split(/[\s,]+/),e=u.length,l=0;l<e;l++)u[l]&&((p=u[l].replace(/\*/g,".*?"))[0]==="-"?V.skips.push(new RegExp("^"+p.substr(1)+"$")):V.names.push(new RegExp("^"+p+"$")))},V.enabled=function(p){var u,e;for(u=0,e=V.skips.length;u<e;u++)if(V.skips[u].test(p))return!1;for(u=0,e=V.names.length;u<e;u++)if(V.names[u].test(p))return!0;return!1},V.humanize=i("ms"),V.names=[],V.skips=[],V.formatters={}},{ms:588}],588:[function(i,B,V){var t=1e3,h=6e4,p=60*h,u=24*p;function e(l,o,a){if(!(l<o))return l<1.5*o?Math.floor(l/o)+" "+a:Math.ceil(l/o)+" "+a+"s"}B.exports=function(l,o){o=o||{};var a,n=typeof l;if(n==="string"&&l.length>0)return function(s){if(!((s=String(s)).length>100)){var r=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(s);if(r){var c=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*c;case"days":case"day":case"d":return c*u;case"hours":case"hour":case"hrs":case"hr":case"h":return c*p;case"minutes":case"minute":case"mins":case"min":case"m":return c*h;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}(l);if(n==="number"&&isNaN(l)===!1)return o.long?e(a=l,u,"day")||e(a,p,"hour")||e(a,h,"minute")||e(a,t,"second")||a+" ms":function(s){return s>=u?Math.round(s/u)+"d":s>=p?Math.round(s/p)+"h":s>=h?Math.round(s/h)+"m":s>=t?Math.round(s/t)+"s":s+"ms"}(l);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(l))}},{}],589:[function(i,B,V){var t=i("parenthesis");B.exports=function(h,p,u){if(h==null)throw Error("First argument should be a string");if(p==null)throw Error("Separator should be a string or a RegExp");u?(typeof u=="string"||Array.isArray(u))&&(u={ignore:u}):u={},u.escape==null&&(u.escape=!0),u.ignore==null?u.ignore=["[]","()","{}","<>",'""',"''","``","“”","«»"]:(typeof u.ignore=="string"&&(u.ignore=[u.ignore]),u.ignore=u.ignore.map(function(r){return r.length===1&&(r+=r),r}));var e=t.parse(h,{flat:!0,brackets:u.ignore}),l=e[0].split(p);if(u.escape){for(var o=[],a=0;a<l.length;a++){var n=l[a],s=l[a+1];n[n.length-1]==="\\"&&n[n.length-2]!=="\\"?(o.push(n+p+s),a++):o.push(n)}l=o}for(a=0;a<l.length;a++)e[0]=l[a],l[a]=t.stringify(e,{flat:!0});return l}},{parenthesis:491}],590:[function(i,B,V){B.exports=function(t){for(var h=t.length,p=new Array(h),u=new Array(h),e=new Array(h),l=new Array(h),o=new Array(h),a=new Array(h),n=0;n<h;++n)p[n]=-1,u[n]=0,e[n]=!1,l[n]=0,o[n]=-1,a[n]=[];var s,r=0,c=[],f=[];function d(y){var v=[y],T=[y];for(p[y]=u[y]=r,e[y]=!0,r+=1;T.length>0;){y=T[T.length-1];var _=t[y];if(l[y]<_.length){for(var k=l[y];k<_.length;++k){var E=_[k];if(p[E]<0){p[E]=u[E]=r,e[E]=!0,r+=1,v.push(E),T.push(E);break}e[E]&&(u[y]=0|Math.min(u[y],u[E])),o[E]>=0&&a[y].push(o[E])}l[y]=k}else{if(u[y]===p[y]){var A=[],b=[],L=0;for(k=v.length-1;k>=0;--k){var w=v[k];if(e[w]=!1,A.push(w),b.push(a[w]),L+=a[w].length,o[w]=c.length,w===y){v.length=k;break}}c.push(A);var C=new Array(L);for(k=0;k<b.length;k++)for(var S=0;S<b[k].length;S++)C[--L]=b[k][S];f.push(C)}T.pop()}}}for(n=0;n<h;++n)p[n]<0&&d(n);for(n=0;n<f.length;n++){var g=f[n];if(g.length!==0){g.sort(function(y,v){return y-v}),s=[g[0]];for(var m=1;m<g.length;m++)g[m]!==g[m-1]&&s.push(g[m]);f[n]=s}}return{components:c,adjacencyList:f}}},{}],591:[function(i,B,V){B.exports=function(e,l){if(e.dimension<=0)return{positions:[],cells:[]};if(e.dimension===1)return function(n,s){for(var r=p(n,s),c=r.length,f=new Array(c),d=new Array(c),g=0;g<c;++g)f[g]=[r[g]],d[g]=[g];return{positions:f,cells:d}}(e,l);var o=e.order.join()+"-"+e.dtype,a=u[o];return l=+l||0,a||(a=u[o]=function(n,s){var r=n.length,c=["'use strict';"],f="surfaceNets"+n.join("_")+"d"+s;c.push("var contour=genContour({","order:[",n.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },"),s==="generic"&&c.push("getters:[0],");for(var d=[],g=[],m=0;m<r;++m)d.push("d"+m),g.push("d"+m);for(m=0;m<1<<r;++m)d.push("v"+m),g.push("v"+m);for(m=0;m<1<<r;++m)d.push("p"+m),g.push("p"+m);d.push("a","b","c"),g.push("a","c"),c.push("vertex:function vertexFunc(",d.join(),"){");var y=[];for(m=0;m<1<<r;++m)y.push("(p"+m+"<<"+m+")");c.push("var m=(",y.join("+"),")|0;if(m===0||m===",(1<<(1<<r))-1,"){return}");var v=[],T=[];for(1<<(1<<r)<=128?(c.push("switch(m){"),T=c):c.push("switch(m>>>7){"),m=0;m<1<<(1<<r);++m){if(1<<(1<<r)>128&&m%128==0){v.length>0&&T.push("}}");var _="vExtra"+v.length;c.push("case ",m>>>7,":",_,"(m&0x7f,",g.join(),");break;"),T=["function ",_,"(m,",g.join(),"){switch(m){"],v.push(T)}T.push("case ",127&m,":");for(var k=new Array(r),E=new Array(r),A=new Array(r),b=new Array(r),L=0,w=0;w<r;++w)k[w]=[],E[w]=[],A[w]=0,b[w]=0;for(w=0;w<1<<r;++w)for(var C=0;C<r;++C){var S=w^1<<C;if(!(S>w)&&!(m&1<<S)!=!(m&1<<w)){var P=1;m&1<<S?E[C].push("v"+S+"-v"+w):(E[C].push("v"+w+"-v"+S),P=-P),P<0?(k[C].push("-v"+w+"-v"+S),A[C]+=2):(k[C].push("v"+w+"+v"+S),A[C]-=2),L+=1;for(var z=0;z<r;++z)z!==C&&(S&1<<z?b[z]+=1:b[z]-=1)}}var F=[];for(C=0;C<r;++C)if(k[C].length===0)F.push("d"+C+"-0.5");else{var q="";A[C]<0?q=A[C]+"*c":A[C]>0&&(q="+"+A[C]+"*c");var W=k[C].length/L*.5,X=.5+b[C]/L*.5;F.push("d"+C+"-"+X+"-"+W+"*("+k[C].join("+")+q+")/("+E[C].join("+")+")")}T.push("a.push([",F.join(),"]);","break;")}c.push("}},"),v.length>0&&T.push("}}");var Q=[];for(m=0;m<1<<r-1;++m)Q.push("v"+m);Q.push("c0","c1","p0","p1","a","b","c"),c.push("cell:function cellFunc(",Q.join(),"){");var Z=h(r-1);for(c.push("if(p0){b.push(",Z.map(function(Y){return"["+Y.map(function(N){return"v"+N})+"]"}).join(),")}else{b.push(",Z.map(function(Y){var N=Y.slice();return N.reverse(),"["+N.map(function(J){return"v"+J})+"]"}).join(),")}}});function ",f,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",f,";"),m=0;m<v.length;++m)c.push(v[m].join(""));return new Function("genContour",c.join(""))(t)}(e.order,e.dtype)),a(e,l)};var t=i("ndarray-extract-contour"),h=i("triangulate-hypercube"),p=i("zero-crossings"),u={}},{"ndarray-extract-contour":475,"triangulate-hypercube":602,"zero-crossings":647}],592:[function(i,B,V){Object.defineProperty(V,"__esModule",{value:!0});var t=function(l,o){if(Array.isArray(l))return l;if(Symbol.iterator in Object(l))return function(a,n){var s=[],r=!0,c=!1,f=void 0;try{for(var d,g=a[Symbol.iterator]();!(r=(d=g.next()).done)&&(s.push(d.value),!n||s.length!==n);r=!0);}catch(m){c=!0,f=m}finally{try{!r&&g.return&&g.return()}finally{if(c)throw f}}return s}(l,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")},h=2*Math.PI,p=function(l,o,a,n,s,r,c){var f=l.x,d=l.y;return{x:n*(f*=o)-s*(d*=a)+r,y:s*f+n*d+c}},u=function(l,o){var a=o===1.5707963267948966?.551915024494:o===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(o/4),n=Math.cos(l),s=Math.sin(l),r=Math.cos(l+o),c=Math.sin(l+o);return[{x:n-s*a,y:s+n*a},{x:r+c*a,y:c-r*a},{x:r,y:c}]},e=function(l,o,a,n){var s=l*a+o*n;return s>1&&(s=1),s<-1&&(s=-1),(l*n-o*a<0?-1:1)*Math.acos(s)};V.default=function(l){var o=l.px,a=l.py,n=l.cx,s=l.cy,r=l.rx,c=l.ry,f=l.xAxisRotation,d=f===void 0?0:f,g=l.largeArcFlag,m=g===void 0?0:g,y=l.sweepFlag,v=y===void 0?0:y,T=[];if(r===0||c===0)return[];var _=Math.sin(d*h/360),k=Math.cos(d*h/360),E=k*(o-n)/2+_*(a-s)/2,A=-_*(o-n)/2+k*(a-s)/2;if(E===0&&A===0)return[];r=Math.abs(r),c=Math.abs(c);var b=Math.pow(E,2)/Math.pow(r,2)+Math.pow(A,2)/Math.pow(c,2);b>1&&(r*=Math.sqrt(b),c*=Math.sqrt(b));var L=function(X,Q,Z,Y,N,J,D,U,G,$,K,re){var ne=Math.pow(N,2),ae=Math.pow(J,2),ie=Math.pow(K,2),he=Math.pow(re,2),se=ne*ae-ne*he-ae*ie;se<0&&(se=0),se/=ne*he+ae*ie;var de=(se=Math.sqrt(se)*(D===U?-1:1))*N/J*re,ce=se*-J/N*K,ve=$*de-G*ce+(X+Z)/2,Ee=G*de+$*ce+(Q+Y)/2,Le=(K-de)/N,Te=(re-ce)/J,xe=(-K-de)/N,fe=(-re-ce)/J,ge=e(1,0,Le,Te),ke=e(Le,Te,xe,fe);return U===0&&ke>0&&(ke-=h),U===1&&ke<0&&(ke+=h),[ve,Ee,ge,ke]}(o,a,n,s,r,c,m,v,_,k,E,A),w=t(L,4),C=w[0],S=w[1],P=w[2],z=w[3],F=Math.abs(z)/(h/4);Math.abs(1-F)<1e-7&&(F=1);var q=Math.max(Math.ceil(F),1);z/=q;for(var W=0;W<q;W++)T.push(u(P,z)),P+=z;return T.map(function(X){var Q=p(X[0],r,c,k,_,C,S),Z=Q.x,Y=Q.y,N=p(X[1],r,c,k,_,C,S),J=N.x,D=N.y,U=p(X[2],r,c,k,_,C,S);return{x1:Z,y1:Y,x2:J,y2:D,x:U.x,y:U.y}})},B.exports=V.default},{}],593:[function(i,B,V){var t=i("parse-svg-path"),h=i("abs-svg-path"),p=i("normalize-svg-path"),u=i("is-svg-path"),e=i("assert");B.exports=function(l){if(Array.isArray(l)&&l.length===1&&typeof l[0]=="string"&&(l=l[0]),typeof l=="string"&&(e(u(l),"String is not an SVG path."),l=t(l)),e(Array.isArray(l),"Argument should be a string or an array of path segments."),l=h(l),!(l=p(l)).length)return[0,0,0,0];for(var o=[1/0,1/0,-1/0,-1/0],a=0,n=l.length;a<n;a++)for(var s=l[a].slice(1),r=0;r<s.length;r+=2)s[r+0]<o[0]&&(o[0]=s[r+0]),s[r+1]<o[1]&&(o[1]=s[r+1]),s[r+0]>o[2]&&(o[2]=s[r+0]),s[r+1]>o[3]&&(o[3]=s[r+1]);return o}},{"abs-svg-path":71,assert:80,"is-svg-path":459,"normalize-svg-path":594,"parse-svg-path":493}],594:[function(i,B,V){B.exports=function(u){for(var e,l=[],o=0,a=0,n=0,s=0,r=null,c=null,f=0,d=0,g=0,m=u.length;g<m;g++){var y=u[g],v=y[0];switch(v){case"M":n=y[1],s=y[2];break;case"A":var T=t({px:f,py:d,cx:y[6],cy:y[7],rx:y[1],ry:y[2],xAxisRotation:y[3],largeArcFlag:y[4],sweepFlag:y[5]});if(!T.length)continue;for(var _,k=0;k<T.length;k++)_=T[k],y=["C",_.x1,_.y1,_.x2,_.y2,_.x,_.y],k<T.length-1&&l.push(y);break;case"S":var E=f,A=d;e!="C"&&e!="S"||(E+=E-o,A+=A-a),y=["C",E,A,y[1],y[2],y[3],y[4]];break;case"T":e=="Q"||e=="T"?(r=2*f-r,c=2*d-c):(r=f,c=d),y=p(f,d,r,c,y[1],y[2]);break;case"Q":r=y[1],c=y[2],y=p(f,d,y[1],y[2],y[3],y[4]);break;case"L":y=h(f,d,y[1],y[2]);break;case"H":y=h(f,d,y[1],d);break;case"V":y=h(f,d,f,y[1]);break;case"Z":y=h(f,d,n,s)}e=v,f=y[y.length-2],d=y[y.length-1],y.length>4?(o=y[y.length-4],a=y[y.length-3]):(o=f,a=d),l.push(y)}return l};var t=i("svg-arc-to-cubic-bezier");function h(u,e,l,o){return["C",u,e,l,o,l,o]}function p(u,e,l,o,a,n){return["C",u/3+2/3*l,e/3+2/3*o,a/3+2/3*l,n/3+2/3*o,a,n]}},{"svg-arc-to-cubic-bezier":592}],595:[function(i,B,V){var t,h=i("svg-path-bounds"),p=i("parse-svg-path"),u=i("draw-svg-path"),e=i("is-svg-path"),l=i("bitmap-sdf"),o=document.createElement("canvas"),a=o.getContext("2d");B.exports=function(n,s){if(!e(n))throw Error("Argument should be valid svg path string");s||(s={});var r,c;s.shape?(r=s.shape[0],c=s.shape[1]):(r=o.width=s.w||s.width||200,c=o.height=s.h||s.height||200);var f=Math.min(r,c),d=s.stroke||0,g=s.viewbox||s.viewBox||h(n),m=[r/(g[2]-g[0]),c/(g[3]-g[1])],y=Math.min(m[0]||0,m[1]||0)/2;if(a.fillStyle="black",a.fillRect(0,0,r,c),a.fillStyle="white",d&&(typeof d!="number"&&(d=1),a.strokeStyle=d>0?"white":"black",a.lineWidth=Math.abs(d)),a.translate(.5*r,.5*c),a.scale(y,y),function(){if(t!=null)return t;var _=document.createElement("canvas").getContext("2d");if(_.canvas.width=_.canvas.height=1,!window.Path2D)return t=!1;var k=new Path2D("M0,0h1v1h-1v-1Z");_.fillStyle="black",_.fill(k);var E=_.getImageData(0,0,1,1);return t=E&&E.data&&E.data[3]===255}()){var v=new Path2D(n);a.fill(v),d&&a.stroke(v)}else{var T=p(n);u(a,T),a.fill(),d&&a.stroke()}return a.setTransform(1,0,0,1,0,0),l(a,{cutoff:s.cutoff!=null?s.cutoff:.5,radius:s.radius!=null?s.radius:.5*f})}},{"bitmap-sdf":105,"draw-svg-path":183,"is-svg-path":459,"parse-svg-path":493,"svg-path-bounds":593}],596:[function(i,B,V){(function(t){(function(){B.exports=function e(l,o,a){a=a||{};var n=u[l];n||(n=u[l]={" ":{data:new Float32Array(0),shape:.2}});var s=n[o];if(!s)if(o.length<=1||!/\d/.test(o))s=n[o]=function(k){for(var E=k.cells,A=k.positions,b=new Float32Array(6*E.length),L=0,w=0,C=0;C<E.length;++C)for(var S=E[C],P=0;P<3;++P){var z=A[S[P]];b[L++]=z[0],b[L++]=z[1]+1.4,w=Math.max(z[0],w)}return{data:b,shape:w}}(h(o,{triangles:!0,font:l,textAlign:a.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var r=o.split(/(\d|\s)/),c=new Array(r.length),f=0,d=0,g=0;g<r.length;++g)c[g]=e(l,r[g]),f+=c[g].data.length,d+=c[g].shape,g>0&&(d+=.02);var m=new Float32Array(f),y=0,v=-.5*d;for(g=0;g<c.length;++g){for(var T=c[g].data,_=0;_<T.length;_+=2)m[y++]=T[_]+v,m[y++]=T[_+1];v+=c[g].shape+.02}s=n[o]={data:m,shape:d}}return s};var h=i("vectorize-text"),p=window||t.global||{},u=p.__TEXT_CACHE||{};p.__TEXT_CACHE={}}).call(this)}).call(this,i("_process"))},{_process:528,"vectorize-text":623}],597:[function(i,B,V){(function(t,h){(function(){var p=i("process/browser.js").nextTick,u=Function.prototype.apply,e=Array.prototype.slice,l={},o=0;function a(n,s){this._id=n,this._clearFn=s}V.setTimeout=function(){return new a(u.call(setTimeout,window,arguments),clearTimeout)},V.setInterval=function(){return new a(u.call(setInterval,window,arguments),clearInterval)},V.clearTimeout=V.clearInterval=function(n){n.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},V.enroll=function(n,s){clearTimeout(n._idleTimeoutId),n._idleTimeout=s},V.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},V._unrefActive=V.active=function(n){clearTimeout(n._idleTimeoutId);var s=n._idleTimeout;s>=0&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},s))},V.setImmediate=typeof t=="function"?t:function(n){var s=o++,r=!(arguments.length<2)&&e.call(arguments,1);return l[s]=!0,p(function(){l[s]&&(r?n.apply(null,r):n.call(null),V.clearImmediate(s))}),s},V.clearImmediate=typeof h=="function"?h:function(n){delete l[n]}}).call(this)}).call(this,i("timers").setImmediate,i("timers").clearImmediate)},{"process/browser.js":528,timers:597}],598:[function(i,B,V){(function(t){var h=/^\s+/,p=/\s+$/,u=0,e=t.round,l=t.min,o=t.max,a=t.random;function n(G,$){if($=$||{},(G=G||"")instanceof n)return G;if(!(this instanceof n))return new n(G,$);var K=function(re){var ne={r:0,g:0,b:0},ae=1,ie=null,he=null,se=null,de=!1,ce=!1;typeof re=="string"&&(re=function(Te){Te=Te.replace(h,"").replace(p,"").toLowerCase();var xe,fe=!1;if(C[Te])Te=C[Te],fe=!0;else if(Te=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(xe=D.rgb.exec(Te))?{r:xe[1],g:xe[2],b:xe[3]}:(xe=D.rgba.exec(Te))?{r:xe[1],g:xe[2],b:xe[3],a:xe[4]}:(xe=D.hsl.exec(Te))?{h:xe[1],s:xe[2],l:xe[3]}:(xe=D.hsla.exec(Te))?{h:xe[1],s:xe[2],l:xe[3],a:xe[4]}:(xe=D.hsv.exec(Te))?{h:xe[1],s:xe[2],v:xe[3]}:(xe=D.hsva.exec(Te))?{h:xe[1],s:xe[2],v:xe[3],a:xe[4]}:(xe=D.hex8.exec(Te))?{r:q(xe[1]),g:q(xe[2]),b:q(xe[3]),a:Z(xe[4]),format:fe?"name":"hex8"}:(xe=D.hex6.exec(Te))?{r:q(xe[1]),g:q(xe[2]),b:q(xe[3]),format:fe?"name":"hex"}:(xe=D.hex4.exec(Te))?{r:q(xe[1]+""+xe[1]),g:q(xe[2]+""+xe[2]),b:q(xe[3]+""+xe[3]),a:Z(xe[4]+""+xe[4]),format:fe?"name":"hex8"}:(xe=D.hex3.exec(Te))?{r:q(xe[1]+""+xe[1]),g:q(xe[2]+""+xe[2]),b:q(xe[3]+""+xe[3]),format:fe?"name":"hex"}:!1}(re)),typeof re=="object"&&(U(re.r)&&U(re.g)&&U(re.b)?(ve=re.r,Ee=re.g,Le=re.b,ne={r:255*z(ve,255),g:255*z(Ee,255),b:255*z(Le,255)},de=!0,ce=String(re.r).substr(-1)==="%"?"prgb":"rgb"):U(re.h)&&U(re.s)&&U(re.v)?(ie=X(re.s),he=X(re.v),ne=function(Te,xe,fe){Te=6*z(Te,360),xe=z(xe,100),fe=z(fe,100);var ge=t.floor(Te),ke=Te-ge,Me=fe*(1-xe),Se=fe*(1-ke*xe),De=fe*(1-(1-ke)*xe),Be=ge%6;return{r:255*[fe,Se,Me,Me,De,fe][Be],g:255*[De,fe,fe,Se,Me,Me][Be],b:255*[Me,Me,De,fe,fe,Se][Be]}}(re.h,ie,he),de=!0,ce="hsv"):U(re.h)&&U(re.s)&&U(re.l)&&(ie=X(re.s),se=X(re.l),ne=function(Te,xe,fe){var ge,ke,Me;function Se(We,Qe,Oe){return Oe<0&&(Oe+=1),Oe>1&&(Oe-=1),Oe<1/6?We+6*(Qe-We)*Oe:Oe<.5?Qe:Oe<2/3?We+(Qe-We)*(2/3-Oe)*6:We}if(Te=z(Te,360),xe=z(xe,100),fe=z(fe,100),xe===0)ge=ke=Me=fe;else{var De=fe<.5?fe*(1+xe):fe+xe-fe*xe,Be=2*fe-De;ge=Se(Be,De,Te+1/3),ke=Se(Be,De,Te),Me=Se(Be,De,Te-1/3)}return{r:255*ge,g:255*ke,b:255*Me}}(re.h,ie,se),de=!0,ce="hsl"),re.hasOwnProperty("a")&&(ae=re.a));var ve,Ee,Le;return ae=P(ae),{ok:de,format:re.format||ce,r:l(255,o(ne.r,0)),g:l(255,o(ne.g,0)),b:l(255,o(ne.b,0)),a:ae}}(G);this._originalInput=G,this._r=K.r,this._g=K.g,this._b=K.b,this._a=K.a,this._roundA=e(100*this._a)/100,this._format=$.format||K.format,this._gradientType=$.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=K.ok,this._tc_id=u++}function s(G,$,K){G=z(G,255),$=z($,255),K=z(K,255);var re,ne,ae=o(G,$,K),ie=l(G,$,K),he=(ae+ie)/2;if(ae==ie)re=ne=0;else{var se=ae-ie;switch(ne=he>.5?se/(2-ae-ie):se/(ae+ie),ae){case G:re=($-K)/se+($<K?6:0);break;case $:re=(K-G)/se+2;break;case K:re=(G-$)/se+4}re/=6}return{h:re,s:ne,l:he}}function r(G,$,K){G=z(G,255),$=z($,255),K=z(K,255);var re,ne,ae=o(G,$,K),ie=l(G,$,K),he=ae,se=ae-ie;if(ne=ae===0?0:se/ae,ae==ie)re=0;else{switch(ae){case G:re=($-K)/se+($<K?6:0);break;case $:re=(K-G)/se+2;break;case K:re=(G-$)/se+4}re/=6}return{h:re,s:ne,v:he}}function c(G,$,K,re){var ne=[W(e(G).toString(16)),W(e($).toString(16)),W(e(K).toString(16))];return re&&ne[0].charAt(0)==ne[0].charAt(1)&&ne[1].charAt(0)==ne[1].charAt(1)&&ne[2].charAt(0)==ne[2].charAt(1)?ne[0].charAt(0)+ne[1].charAt(0)+ne[2].charAt(0):ne.join("")}function f(G,$,K,re){return[W(Q(re)),W(e(G).toString(16)),W(e($).toString(16)),W(e(K).toString(16))].join("")}function d(G,$){$=$===0?0:$||10;var K=n(G).toHsl();return K.s-=$/100,K.s=F(K.s),n(K)}function g(G,$){$=$===0?0:$||10;var K=n(G).toHsl();return K.s+=$/100,K.s=F(K.s),n(K)}function m(G){return n(G).desaturate(100)}function y(G,$){$=$===0?0:$||10;var K=n(G).toHsl();return K.l+=$/100,K.l=F(K.l),n(K)}function v(G,$){$=$===0?0:$||10;var K=n(G).toRgb();return K.r=o(0,l(255,K.r-e(-$/100*255))),K.g=o(0,l(255,K.g-e(-$/100*255))),K.b=o(0,l(255,K.b-e(-$/100*255))),n(K)}function T(G,$){$=$===0?0:$||10;var K=n(G).toHsl();return K.l-=$/100,K.l=F(K.l),n(K)}function _(G,$){var K=n(G).toHsl(),re=(K.h+$)%360;return K.h=re<0?360+re:re,n(K)}function k(G){var $=n(G).toHsl();return $.h=($.h+180)%360,n($)}function E(G){var $=n(G).toHsl(),K=$.h;return[n(G),n({h:(K+120)%360,s:$.s,l:$.l}),n({h:(K+240)%360,s:$.s,l:$.l})]}function A(G){var $=n(G).toHsl(),K=$.h;return[n(G),n({h:(K+90)%360,s:$.s,l:$.l}),n({h:(K+180)%360,s:$.s,l:$.l}),n({h:(K+270)%360,s:$.s,l:$.l})]}function b(G){var $=n(G).toHsl(),K=$.h;return[n(G),n({h:(K+72)%360,s:$.s,l:$.l}),n({h:(K+216)%360,s:$.s,l:$.l})]}function L(G,$,K){$=$||6,K=K||30;var re=n(G).toHsl(),ne=360/K,ae=[n(G)];for(re.h=(re.h-(ne*$>>1)+720)%360;--$;)re.h=(re.h+ne)%360,ae.push(n(re));return ae}function w(G,$){$=$||6;for(var K=n(G).toHsv(),re=K.h,ne=K.s,ae=K.v,ie=[],he=1/$;$--;)ie.push(n({h:re,s:ne,v:ae})),ae=(ae+he)%1;return ie}n.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var G=this.toRgb();return(299*G.r+587*G.g+114*G.b)/1e3},getLuminance:function(){var G,$,K,re=this.toRgb();return G=re.r/255,$=re.g/255,K=re.b/255,.2126*(G<=.03928?G/12.92:t.pow((G+.055)/1.055,2.4))+.7152*($<=.03928?$/12.92:t.pow(($+.055)/1.055,2.4))+.0722*(K<=.03928?K/12.92:t.pow((K+.055)/1.055,2.4))},setAlpha:function(G){return this._a=P(G),this._roundA=e(100*this._a)/100,this},toHsv:function(){var G=r(this._r,this._g,this._b);return{h:360*G.h,s:G.s,v:G.v,a:this._a}},toHsvString:function(){var G=r(this._r,this._g,this._b),$=e(360*G.h),K=e(100*G.s),re=e(100*G.v);return this._a==1?"hsv("+$+", "+K+"%, "+re+"%)":"hsva("+$+", "+K+"%, "+re+"%, "+this._roundA+")"},toHsl:function(){var G=s(this._r,this._g,this._b);return{h:360*G.h,s:G.s,l:G.l,a:this._a}},toHslString:function(){var G=s(this._r,this._g,this._b),$=e(360*G.h),K=e(100*G.s),re=e(100*G.l);return this._a==1?"hsl("+$+", "+K+"%, "+re+"%)":"hsla("+$+", "+K+"%, "+re+"%, "+this._roundA+")"},toHex:function(G){return c(this._r,this._g,this._b,G)},toHexString:function(G){return"#"+this.toHex(G)},toHex8:function(G){return function($,K,re,ne,ae){var ie=[W(e($).toString(16)),W(e(K).toString(16)),W(e(re).toString(16)),W(Q(ne))];return ae&&ie[0].charAt(0)==ie[0].charAt(1)&&ie[1].charAt(0)==ie[1].charAt(1)&&ie[2].charAt(0)==ie[2].charAt(1)&&ie[3].charAt(0)==ie[3].charAt(1)?ie[0].charAt(0)+ie[1].charAt(0)+ie[2].charAt(0)+ie[3].charAt(0):ie.join("")}(this._r,this._g,this._b,this._a,G)},toHex8String:function(G){return"#"+this.toHex8(G)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*z(this._r,255))+"%",g:e(100*z(this._g,255))+"%",b:e(100*z(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(100*z(this._r,255))+"%, "+e(100*z(this._g,255))+"%, "+e(100*z(this._b,255))+"%)":"rgba("+e(100*z(this._r,255))+"%, "+e(100*z(this._g,255))+"%, "+e(100*z(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(S[c(this._r,this._g,this._b,!0)]||!1)},toFilter:function(G){var $="#"+f(this._r,this._g,this._b,this._a),K=$,re=this._gradientType?"GradientType = 1, ":"";if(G){var ne=n(G);K="#"+f(ne._r,ne._g,ne._b,ne._a)}return"progid:DXImageTransform.Microsoft.gradient("+re+"startColorstr="+$+",endColorstr="+K+")"},toString:function(G){var $=!!G;G=G||this._format;var K=!1,re=this._a<1&&this._a>=0;return $||!re||G!=="hex"&&G!=="hex6"&&G!=="hex3"&&G!=="hex4"&&G!=="hex8"&&G!=="name"?(G==="rgb"&&(K=this.toRgbString()),G==="prgb"&&(K=this.toPercentageRgbString()),G!=="hex"&&G!=="hex6"||(K=this.toHexString()),G==="hex3"&&(K=this.toHexString(!0)),G==="hex4"&&(K=this.toHex8String(!0)),G==="hex8"&&(K=this.toHex8String()),G==="name"&&(K=this.toName()),G==="hsl"&&(K=this.toHslString()),G==="hsv"&&(K=this.toHsvString()),K||this.toHexString()):G==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return n(this.toString())},_applyModification:function(G,$){var K=G.apply(null,[this].concat([].slice.call($)));return this._r=K._r,this._g=K._g,this._b=K._b,this.setAlpha(K._a),this},lighten:function(){return this._applyModification(y,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(T,arguments)},desaturate:function(){return this._applyModification(d,arguments)},saturate:function(){return this._applyModification(g,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(_,arguments)},_applyCombination:function(G,$){return G.apply(null,[this].concat([].slice.call($)))},analogous:function(){return this._applyCombination(L,arguments)},complement:function(){return this._applyCombination(k,arguments)},monochromatic:function(){return this._applyCombination(w,arguments)},splitcomplement:function(){return this._applyCombination(b,arguments)},triad:function(){return this._applyCombination(E,arguments)},tetrad:function(){return this._applyCombination(A,arguments)}},n.fromRatio=function(G,$){if(typeof G=="object"){var K={};for(var re in G)G.hasOwnProperty(re)&&(K[re]=re==="a"?G[re]:X(G[re]));G=K}return n(G,$)},n.equals=function(G,$){return!(!G||!$)&&n(G).toRgbString()==n($).toRgbString()},n.random=function(){return n.fromRatio({r:a(),g:a(),b:a()})},n.mix=function(G,$,K){K=K===0?0:K||50;var re=n(G).toRgb(),ne=n($).toRgb(),ae=K/100;return n({r:(ne.r-re.r)*ae+re.r,g:(ne.g-re.g)*ae+re.g,b:(ne.b-re.b)*ae+re.b,a:(ne.a-re.a)*ae+re.a})},n.readability=function(G,$){var K=n(G),re=n($);return(t.max(K.getLuminance(),re.getLuminance())+.05)/(t.min(K.getLuminance(),re.getLuminance())+.05)},n.isReadable=function(G,$,K){var re,ne,ae=n.readability(G,$);switch(ne=!1,(re=function(ie){var he,se;return he=((ie=ie||{level:"AA",size:"small"}).level||"AA").toUpperCase(),se=(ie.size||"small").toLowerCase(),he!=="AA"&&he!=="AAA"&&(he="AA"),se!=="small"&&se!=="large"&&(se="small"),{level:he,size:se}}(K)).level+re.size){case"AAsmall":case"AAAlarge":ne=ae>=4.5;break;case"AAlarge":ne=ae>=3;break;case"AAAsmall":ne=ae>=7}return ne},n.mostReadable=function(G,$,K){var re,ne,ae,ie,he=null,se=0;ne=(K=K||{}).includeFallbackColors,ae=K.level,ie=K.size;for(var de=0;de<$.length;de++)(re=n.readability(G,$[de]))>se&&(se=re,he=n($[de]));return n.isReadable(G,he,{level:ae,size:ie})||!ne?he:(K.includeFallbackColors=!1,n.mostReadable(G,["#fff","#000"],K))};var C=n.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},S=n.hexNames=function(G){var $={};for(var K in G)G.hasOwnProperty(K)&&($[G[K]]=K);return $}(C);function P(G){return G=parseFloat(G),(isNaN(G)||G<0||G>1)&&(G=1),G}function z(G,$){(function(re){return typeof re=="string"&&re.indexOf(".")!=-1&&parseFloat(re)===1})(G)&&(G="100%");var K=function(re){return typeof re=="string"&&re.indexOf("%")!=-1}(G);return G=l($,o(0,parseFloat(G))),K&&(G=parseInt(G*$,10)/100),t.abs(G-$)<1e-6?1:G%$/parseFloat($)}function F(G){return l(1,o(0,G))}function q(G){return parseInt(G,16)}function W(G){return G.length==1?"0"+G:""+G}function X(G){return G<=1&&(G=100*G+"%"),G}function Q(G){return t.round(255*parseFloat(G)).toString(16)}function Z(G){return q(G)/255}var Y,N,J,D=(N="[\\s|\\(]+("+(Y="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+Y+")[,|\\s]+("+Y+")\\s*\\)?",J="[\\s|\\(]+("+Y+")[,|\\s]+("+Y+")[,|\\s]+("+Y+")[,|\\s]+("+Y+")\\s*\\)?",{CSS_UNIT:new RegExp(Y),rgb:new RegExp("rgb"+N),rgba:new RegExp("rgba"+J),hsl:new RegExp("hsl"+N),hsla:new RegExp("hsla"+J),hsv:new RegExp("hsv"+N),hsva:new RegExp("hsva"+J),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function U(G){return!!D.CSS_UNIT.exec(G)}B!==void 0&&B.exports?B.exports=n:window.tinycolor=n})(Math)},{}],599:[function(i,B,V){B.exports=h,B.exports.float32=B.exports.float=h,B.exports.fract32=B.exports.fract=function(p,u){if(p.length){if(p instanceof Float32Array)return new Float32Array(p.length);u instanceof Float32Array||(u=h(p));for(var e=0,l=u.length;e<l;e++)u[e]=p[e]-u[e];return u}return h(p-h(p))};var t=new Float32Array(1);function h(p){return p.length?p instanceof Float32Array?p:new Float32Array(p):(t[0]=p,t[0])}},{}],600:[function(i,B,V){var t=i("parse-unit");B.exports=p;function h(u,e){var l=t(getComputedStyle(u).getPropertyValue(e));return l[0]*p(l[1],u)}function p(u,e){switch(e=e||document.body,u=(u||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),u){case"%":return e.clientHeight/100;case"ch":case"ex":return function(l,o){var a=document.createElement("div");a.style["font-size"]="128"+l,o.appendChild(a);var n=h(a,"font-size")/128;return o.removeChild(a),n}(u,e);case"em":return h(e,"font-size");case"rem":return h(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":494}],601:[function(i,B,V){(function(t,h){h(typeof V=="object"&&B!==void 0?V:(t=t||self).topojson=t.topojson||{})})(this,function(t){function h(f){return f}function p(f){if(f==null)return h;var d,g,m=f.scale[0],y=f.scale[1],v=f.translate[0],T=f.translate[1];return function(_,k){k||(d=g=0);var E=2,A=_.length,b=new Array(A);for(b[0]=(d+=_[0])*m+v,b[1]=(g+=_[1])*y+T;E<A;)b[E]=_[E],++E;return b}}function u(f){var d,g=p(f.transform),m=1/0,y=m,v=-m,T=-m;function _(E){(E=g(E))[0]<m&&(m=E[0]),E[0]>v&&(v=E[0]),E[1]<y&&(y=E[1]),E[1]>T&&(T=E[1])}function k(E){switch(E.type){case"GeometryCollection":E.geometries.forEach(k);break;case"Point":_(E.coordinates);break;case"MultiPoint":E.coordinates.forEach(_)}}for(d in f.arcs.forEach(function(E){for(var A,b=-1,L=E.length;++b<L;)(A=g(E[b],b))[0]<m&&(m=A[0]),A[0]>v&&(v=A[0]),A[1]<y&&(y=A[1]),A[1]>T&&(T=A[1])}),f.objects)k(f.objects[d]);return[m,y,v,T]}function e(f,d){var g=d.id,m=d.bbox,y=d.properties==null?{}:d.properties,v=l(f,d);return g==null&&m==null?{type:"Feature",properties:y,geometry:v}:m==null?{type:"Feature",id:g,properties:y,geometry:v}:{type:"Feature",id:g,bbox:m,properties:y,geometry:v}}function l(f,d){var g=p(f.transform),m=f.arcs;function y(E,A){A.length&&A.pop();for(var b=m[E<0?~E:E],L=0,w=b.length;L<w;++L)A.push(g(b[L],L));E<0&&function(C,S){for(var P,z=C.length,F=z-S;F<--z;)P=C[F],C[F++]=C[z],C[z]=P}(A,w)}function v(E){return g(E)}function T(E){for(var A=[],b=0,L=E.length;b<L;++b)y(E[b],A);return A.length<2&&A.push(A[0]),A}function _(E){for(var A=T(E);A.length<4;)A.push(A[0]);return A}function k(E){return E.map(_)}return function E(A){var b,L=A.type;switch(L){case"GeometryCollection":return{type:L,geometries:A.geometries.map(E)};case"Point":b=v(A.coordinates);break;case"MultiPoint":b=A.coordinates.map(v);break;case"LineString":b=T(A.arcs);break;case"MultiLineString":b=A.arcs.map(T);break;case"Polygon":b=k(A.arcs);break;case"MultiPolygon":b=A.arcs.map(k);break;default:return null}return{type:L,coordinates:b}}(d)}function o(f,d){var g={},m={},y={},v=[],T=-1;function _(k,E){for(var A in k){var b=k[A];delete E[b.start],delete b.start,delete b.end,b.forEach(function(L){g[L<0?~L:L]=1}),v.push(b)}}return d.forEach(function(k,E){var A,b=f.arcs[k<0?~k:k];b.length<3&&!b[1][0]&&!b[1][1]&&(A=d[++T],d[T]=k,d[E]=A)}),d.forEach(function(k){var E,A,b=function(P){var z,F=f.arcs[P<0?~P:P],q=F[0];return f.transform?(z=[0,0],F.forEach(function(W){z[0]+=W[0],z[1]+=W[1]})):z=F[F.length-1],P<0?[z,q]:[q,z]}(k),L=b[0],w=b[1];if(E=y[L])if(delete y[E.end],E.push(k),E.end=w,A=m[w]){delete m[A.start];var C=A===E?E:E.concat(A);m[C.start=E.start]=y[C.end=A.end]=C}else m[E.start]=y[E.end]=E;else if(E=m[w])if(delete m[E.start],E.unshift(k),E.start=L,A=y[L]){delete y[A.end];var S=A===E?E:A.concat(E);m[S.start=A.start]=y[S.end=E.end]=S}else m[E.start]=y[E.end]=E;else m[(E=[k]).start=L]=y[E.end=w]=E}),_(y,m),_(m,y),d.forEach(function(k){g[k<0?~k:k]||v.push([k])}),v}function a(f,d,g){var m,y,v;if(arguments.length>1)m=n(f,d,g);else for(y=0,m=new Array(v=f.arcs.length);y<v;++y)m[y]=y;return{type:"MultiLineString",arcs:o(f,m)}}function n(f,d,g){var m,y=[],v=[];function T(E){var A=E<0?~E:E;(v[A]||(v[A]=[])).push({i:E,g:m})}function _(E){E.forEach(T)}function k(E){E.forEach(_)}return function E(A){switch(m=A,A.type){case"GeometryCollection":A.geometries.forEach(E);break;case"LineString":_(A.arcs);break;case"MultiLineString":case"Polygon":k(A.arcs);break;case"MultiPolygon":(function(b){b.forEach(k)})(A.arcs)}}(d),v.forEach(g==null?function(E){y.push(E[0].i)}:function(E){g(E[0].g,E[E.length-1].g)&&y.push(E[0].i)}),y}function s(f,d){var g={},m=[],y=[];function v(_){_.forEach(function(k){k.forEach(function(E){(g[E=E<0?~E:E]||(g[E]=[])).push(_)})}),m.push(_)}function T(_){return function(k){for(var E,A=-1,b=k.length,L=k[b-1],w=0;++A<b;)E=L,L=k[A],w+=E[0]*L[1]-E[1]*L[0];return Math.abs(w)}(l(f,{type:"Polygon",arcs:[_]}).coordinates[0])}return d.forEach(function _(k){switch(k.type){case"GeometryCollection":k.geometries.forEach(_);break;case"Polygon":v(k.arcs);break;case"MultiPolygon":k.arcs.forEach(v)}}),m.forEach(function(_){if(!_._){var k=[],E=[_];for(_._=1,y.push(k);_=E.pop();)k.push(_),_.forEach(function(A){A.forEach(function(b){g[b<0?~b:b].forEach(function(L){L._||(L._=1,E.push(L))})})})}}),m.forEach(function(_){delete _._}),{type:"MultiPolygon",arcs:y.map(function(_){var k,E=[];if(_.forEach(function(C){C.forEach(function(S){S.forEach(function(P){g[P<0?~P:P].length<2&&E.push(P)})})}),(k=(E=o(f,E)).length)>1)for(var A,b,L=1,w=T(E[0]);L<k;++L)(A=T(E[L]))>w&&(b=E[0],E[0]=E[L],E[L]=b,w=A);return E}).filter(function(_){return _.length>0})}}function r(f,d){for(var g=0,m=f.length;g<m;){var y=g+m>>>1;f[y]<d?g=y+1:m=y}return g}function c(f){if(f==null)return h;var d,g,m=f.scale[0],y=f.scale[1],v=f.translate[0],T=f.translate[1];return function(_,k){k||(d=g=0);var E=2,A=_.length,b=new Array(A),L=Math.round((_[0]-v)/m),w=Math.round((_[1]-T)/y);for(b[0]=L-d,d=L,b[1]=w-g,g=w;E<A;)b[E]=_[E],++E;return b}}t.bbox=u,t.feature=function(f,d){return typeof d=="string"&&(d=f.objects[d]),d.type==="GeometryCollection"?{type:"FeatureCollection",features:d.geometries.map(function(g){return e(f,g)})}:e(f,d)},t.merge=function(f){return l(f,s.apply(this,arguments))},t.mergeArcs=s,t.mesh=function(f){return l(f,a.apply(this,arguments))},t.meshArcs=a,t.neighbors=function(f){var d={},g=f.map(function(){return[]});function m(C,S){C.forEach(function(P){P<0&&(P=~P);var z=d[P];z?z.push(S):d[P]=[S]})}function y(C,S){C.forEach(function(P){m(P,S)})}var v={LineString:m,MultiLineString:y,Polygon:y,MultiPolygon:function(C,S){C.forEach(function(P){y(P,S)})}};for(var T in f.forEach(function C(S,P){S.type==="GeometryCollection"?S.geometries.forEach(function(z){C(z,P)}):S.type in v&&v[S.type](S.arcs,P)}),d)for(var _=d[T],k=_.length,E=0;E<k;++E)for(var A=E+1;A<k;++A){var b,L=_[E],w=_[A];(b=g[L])[T=r(b,w)]!==w&&b.splice(T,0,w),(b=g[w])[T=r(b,L)]!==L&&b.splice(T,0,L)}return g},t.quantize=function(f,d){if(f.transform)throw new Error("already quantized");if(d&&d.scale)_=f.bbox;else{if(!((g=Math.floor(d))>=2))throw new Error("n must be ≥2");var g,m=(_=f.bbox||u(f))[0],y=_[1],v=_[2],T=_[3];d={scale:[v-m?(v-m)/(g-1):1,T-y?(T-y)/(g-1):1],translate:[m,y]}}var _,k,E=c(d),A=f.objects,b={};function L(C){return E(C)}function w(C){var S;switch(C.type){case"GeometryCollection":S={type:"GeometryCollection",geometries:C.geometries.map(w)};break;case"Point":S={type:"Point",coordinates:L(C.coordinates)};break;case"MultiPoint":S={type:"MultiPoint",coordinates:C.coordinates.map(L)};break;default:return C}return C.id!=null&&(S.id=C.id),C.bbox!=null&&(S.bbox=C.bbox),C.properties!=null&&(S.properties=C.properties),S}for(k in A)b[k]=w(A[k]);return{type:"Topology",bbox:_,transform:d,objects:b,arcs:f.arcs.map(function(C){var S,P=0,z=1,F=C.length,q=new Array(F);for(q[0]=E(C[0],0);++P<F;)((S=E(C[P],P))[0]||S[1])&&(q[z++]=S);return z===1&&(q[z++]=[0,0]),q.length=z,q})}},t.transform=p,t.untransform=c,Object.defineProperty(t,"__esModule",{value:!0})})},{}],602:[function(i,B,V){B.exports=function(u){if(u<0)return[];if(u===0)return[[0]];for(var e=0|Math.round(p(u+1)),l=[],o=0;o<e;++o){for(var a=t.unrank(u,o),n=[0],s=0,r=0;r<a.length;++r)s+=1<<a[r],n.push(s);h(a)<1&&(n[0]=s,n[u]=0),l.push(n)}return l};var t=i("permutation-rank"),h=i("permutation-parity"),p=i("gamma")},{gamma:256,"permutation-parity":496,"permutation-rank":497}],603:[function(i,B,V){B.exports=function(f){var d=(f=f||{}).center||[0,0,0],g=f.up||[0,1,0],m=f.right||n(g),y=f.radius||1,v=f.theta||0,T=f.phi||0;if(d=[].slice.call(d,0,3),g=[].slice.call(g,0,3),e(g,g),m=[].slice.call(m,0,3),e(m,m),"eye"in f){var _=f.eye,k=[_[0]-d[0],_[1]-d[1],_[2]-d[2]];u(m,k,g),o(m[0],m[1],m[2])<1e-6?m=n(g):e(m,m),y=o(k[0],k[1],k[2]);var E=l(g,k)/y,A=l(m,k)/y;T=Math.acos(E),v=Math.acos(A)}return y=Math.log(y),new s(f.zoomMin,f.zoomMax,d,g,m,y,v,T)};var t=i("filtered-vector"),h=i("gl-mat4/invert"),p=i("gl-mat4/rotate"),u=i("gl-vec3/cross"),e=i("gl-vec3/normalize"),l=i("gl-vec3/dot");function o(f,d,g){return Math.sqrt(Math.pow(f,2)+Math.pow(d,2)+Math.pow(g,2))}function a(f){return Math.min(1,Math.max(-1,f))}function n(f){var d=Math.abs(f[0]),g=Math.abs(f[1]),m=Math.abs(f[2]),y=[0,0,0];d>Math.max(g,m)?y[2]=1:g>Math.max(d,m)?y[0]=1:y[1]=1;for(var v=0,T=0,_=0;_<3;++_)v+=f[_]*f[_],T+=y[_]*f[_];for(_=0;_<3;++_)y[_]-=T/v*f[_];return e(y,y),y}function s(f,d,g,m,y,v,T,_){this.center=t(g),this.up=t(m),this.right=t(y),this.radius=t([v]),this.angle=t([T,_]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(f,d),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var k=0;k<16;++k)this.computedMatrix[k]=.5;this.recalcMatrix(0)}var r=s.prototype;r.setDistanceLimits=function(f,d){f=f>0?Math.log(f):-1/0,d=d>0?Math.log(d):1/0,d=Math.max(d,f),this.radius.bounds[0][0]=f,this.radius.bounds[1][0]=d},r.getDistanceLimits=function(f){var d=this.radius.bounds[0];return f?(f[0]=Math.exp(d[0][0]),f[1]=Math.exp(d[1][0]),f):[Math.exp(d[0][0]),Math.exp(d[1][0])]},r.recalcMatrix=function(f){this.center.curve(f),this.up.curve(f),this.right.curve(f),this.radius.curve(f),this.angle.curve(f);for(var d=this.computedUp,g=this.computedRight,m=0,y=0,v=0;v<3;++v)y+=d[v]*g[v],m+=d[v]*d[v];var T=Math.sqrt(m),_=0;for(v=0;v<3;++v)g[v]-=d[v]*y/m,_+=g[v]*g[v],d[v]/=T;var k=Math.sqrt(_);for(v=0;v<3;++v)g[v]/=k;var E=this.computedToward;u(E,d,g),e(E,E);var A=Math.exp(this.computedRadius[0]),b=this.computedAngle[0],L=this.computedAngle[1],w=Math.cos(b),C=Math.sin(b),S=Math.cos(L),P=Math.sin(L),z=this.computedCenter,F=w*S,q=C*S,W=P,X=-w*P,Q=-C*P,Z=S,Y=this.computedEye,N=this.computedMatrix;for(v=0;v<3;++v){var J=F*g[v]+q*E[v]+W*d[v];N[4*v+1]=X*g[v]+Q*E[v]+Z*d[v],N[4*v+2]=J,N[4*v+3]=0}var D=N[1],U=N[5],G=N[9],$=N[2],K=N[6],re=N[10],ne=U*re-G*K,ae=G*$-D*re,ie=D*K-U*$,he=o(ne,ae,ie);for(ne/=he,ae/=he,ie/=he,N[0]=ne,N[4]=ae,N[8]=ie,v=0;v<3;++v)Y[v]=z[v]+N[2+4*v]*A;for(v=0;v<3;++v){_=0;for(var se=0;se<3;++se)_+=N[v+4*se]*Y[se];N[12+v]=-_}N[15]=1},r.getMatrix=function(f,d){this.recalcMatrix(f);var g=this.computedMatrix;if(d){for(var m=0;m<16;++m)d[m]=g[m];return d}return g};var c=[0,0,0];r.rotate=function(f,d,g,m){if(this.angle.move(f,d,g),m){this.recalcMatrix(f);var y=this.computedMatrix;c[0]=y[2],c[1]=y[6],c[2]=y[10];for(var v=this.computedUp,T=this.computedRight,_=this.computedToward,k=0;k<3;++k)y[4*k]=v[k],y[4*k+1]=T[k],y[4*k+2]=_[k];for(p(y,y,m,c),k=0;k<3;++k)v[k]=y[4*k],T[k]=y[4*k+1];this.up.set(f,v[0],v[1],v[2]),this.right.set(f,T[0],T[1],T[2])}},r.pan=function(f,d,g,m){d=d||0,g=g||0,m=m||0,this.recalcMatrix(f);var y=this.computedMatrix,v=(Math.exp(this.computedRadius[0]),y[1]),T=y[5],_=y[9],k=o(v,T,_);v/=k,T/=k,_/=k;var E=y[0],A=y[4],b=y[8],L=E*v+A*T+b*_,w=o(E-=v*L,A-=T*L,b-=_*L),C=(E/=w)*d+v*g,S=(A/=w)*d+T*g,P=(b/=w)*d+_*g;this.center.move(f,C,S,P);var z=Math.exp(this.computedRadius[0]);z=Math.max(1e-4,z+m),this.radius.set(f,Math.log(z))},r.translate=function(f,d,g,m){this.center.move(f,d||0,g||0,m||0)},r.setMatrix=function(f,d,g,m){var y=1;typeof g=="number"&&(y=0|g),(y<0||y>3)&&(y=1);var v=(y+2)%3;d||(this.recalcMatrix(f),d=this.computedMatrix);var T=d[y],_=d[y+4],k=d[y+8];if(m){var E=Math.abs(T),A=Math.abs(_),b=Math.abs(k),L=Math.max(E,A,b);E===L?(T=T<0?-1:1,_=k=0):b===L?(k=k<0?-1:1,T=_=0):(_=_<0?-1:1,T=k=0)}else{var w=o(T,_,k);T/=w,_/=w,k/=w}var C,S,P=d[v],z=d[v+4],F=d[v+8],q=P*T+z*_+F*k,W=o(P-=T*q,z-=_*q,F-=k*q),X=_*(F/=W)-k*(z/=W),Q=k*(P/=W)-T*F,Z=T*z-_*P,Y=o(X,Q,Z);if(X/=Y,Q/=Y,Z/=Y,this.center.jump(f,Ee,Le,Te),this.radius.idle(f),this.up.jump(f,T,_,k),this.right.jump(f,P,z,F),y===2){var N=d[1],J=d[5],D=d[9],U=N*P+J*z+D*F,G=N*X+J*Q+D*Z;C=ne<0?-Math.PI/2:Math.PI/2,S=Math.atan2(G,U)}else{var $=d[2],K=d[6],re=d[10],ne=$*T+K*_+re*k,ae=$*P+K*z+re*F,ie=$*X+K*Q+re*Z;C=Math.asin(a(ne)),S=Math.atan2(ie,ae)}this.angle.jump(f,S,C),this.recalcMatrix(f);var he=d[2],se=d[6],de=d[10],ce=this.computedMatrix;h(ce,d);var ve=ce[15],Ee=ce[12]/ve,Le=ce[13]/ve,Te=ce[14]/ve,xe=Math.exp(this.computedRadius[0]);this.center.jump(f,Ee-he*xe,Le-se*xe,Te-de*xe)},r.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},r.idle=function(f){this.center.idle(f),this.up.idle(f),this.right.idle(f),this.radius.idle(f),this.angle.idle(f)},r.flush=function(f){this.center.flush(f),this.up.flush(f),this.right.flush(f),this.radius.flush(f),this.angle.flush(f)},r.setDistance=function(f,d){d>0&&this.radius.set(f,Math.log(d))},r.lookAt=function(f,d,g,m){this.recalcMatrix(f),d=d||this.computedEye,g=g||this.computedCenter;var y=(m=m||this.computedUp)[0],v=m[1],T=m[2],_=o(y,v,T);if(!(_<1e-6)){y/=_,v/=_,T/=_;var k=d[0]-g[0],E=d[1]-g[1],A=d[2]-g[2],b=o(k,E,A);if(!(b<1e-6)){k/=b,E/=b,A/=b;var L=this.computedRight,w=L[0],C=L[1],S=L[2],P=y*w+v*C+T*S,z=o(w-=P*y,C-=P*v,S-=P*T);if(!(z<.01&&(z=o(w=v*A-T*E,C=T*k-y*A,S=y*E-v*k))<1e-6)){w/=z,C/=z,S/=z,this.up.set(f,y,v,T),this.right.set(f,w,C,S),this.center.set(f,g[0],g[1],g[2]),this.radius.set(f,Math.log(b));var F=v*S-T*C,q=T*w-y*S,W=y*C-v*w,X=o(F,q,W),Q=y*k+v*E+T*A,Z=w*k+C*E+S*A,Y=(F/=X)*k+(q/=X)*E+(W/=X)*A,N=Math.asin(a(Q)),J=Math.atan2(Y,Z),D=this.angle._state,U=D[D.length-1],G=D[D.length-2];U%=2*Math.PI;var $=Math.abs(U+2*Math.PI-J),K=Math.abs(U-J),re=Math.abs(U-2*Math.PI-J);$<K&&(U+=2*Math.PI),re<K&&(U-=2*Math.PI),this.angle.jump(this.angle.lastT(),U,G),this.angle.set(f,J,N)}}}}},{"filtered-vector":250,"gl-mat4/invert":299,"gl-mat4/rotate":305,"gl-vec3/cross":368,"gl-vec3/dot":373,"gl-vec3/normalize":390}],604:[function(i,B,V){B.exports=function(h,p,u){var e=h*p,l=t*h,o=l-(l-h),a=h-o,n=t*p,s=n-(n-p),r=p-s,c=a*r-(e-o*s-a*s-o*r);return u?(u[0]=c,u[1]=e,u):[c,e]};var t=+(Math.pow(2,27)+1)},{}],605:[function(i,B,V){B.exports=function(t,h,p){var u=t+h,e=u-t,l=h-e,o=t-(u-e);return p?(p[0]=o+l,p[1]=u,p):[o+l,u]}},{}],606:[function(i,B,V){var t=i("../prototype/is");B.exports=function(h){if(typeof h!="function"||!hasOwnProperty.call(h,"length"))return!1;try{if(typeof h.length!="number"||typeof h.call!="function"||typeof h.apply!="function")return!1}catch{return!1}return!t(h)}},{"../prototype/is":613}],607:[function(i,B,V){var t=i("../value/is"),h=i("../object/is"),p=i("../string/coerce"),u=i("./to-short-string"),e=function(l,o){return l.replace("%v",u(o))};B.exports=function(l,o,a){if(!h(a))throw new TypeError(e(o,l));if(!t(l)){if("default"in a)return a.default;if(a.isOptional)return null}var n=p(a.errorMessage);throw t(n)||(n=o),new TypeError(e(n,l))}},{"../object/is":610,"../string/coerce":614,"../value/is":616,"./to-short-string":609}],608:[function(i,B,V){B.exports=function(t){try{return t.toString()}catch{try{return String(t)}catch{return null}}}},{}],609:[function(i,B,V){var t=i("./safe-to-string"),h=/[\n\r\u2028\u2029]/g;B.exports=function(p){var u=t(p);return u===null?"<Non-coercible to string value>":(u.length>100&&(u=u.slice(0,99)+"…"),u=u.replace(h,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":608}],610:[function(i,B,V){var t=i("../value/is"),h={object:!0,function:!0,undefined:!0};B.exports=function(p){return!!t(p)&&hasOwnProperty.call(h,typeof p)}},{"../value/is":616}],611:[function(i,B,V){var t=i("../lib/resolve-exception"),h=i("./is");B.exports=function(p){return h(p)?p:t(p,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":607,"./is":612}],612:[function(i,B,V){var t=i("../function/is"),h=/^\s*class[\s{/}]/,p=Function.prototype.toString;B.exports=function(u){return!!t(u)&&!h.test(p.call(u))}},{"../function/is":606}],613:[function(i,B,V){var t=i("../object/is");B.exports=function(h){if(!t(h))return!1;try{return!!h.constructor&&h.constructor.prototype===h}catch{return!1}}},{"../object/is":610}],614:[function(i,B,V){var t=i("../value/is"),h=i("../object/is"),p=Object.prototype.toString;B.exports=function(u){if(!t(u))return null;if(h(u)){var e=u.toString;if(typeof e!="function"||e===p)return null}try{return""+u}catch{return null}}},{"../object/is":610,"../value/is":616}],615:[function(i,B,V){var t=i("../lib/resolve-exception"),h=i("./is");B.exports=function(p){return h(p)?p:t(p,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":607,"./is":616}],616:[function(i,B,V){B.exports=function(t){return t!=null}},{}],617:[function(i,B,V){(function(t){(function(){var h=i("bit-twiddle"),p=i("dup"),u=i("buffer").Buffer;t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:p([32,0]),UINT16:p([32,0]),UINT32:p([32,0]),BIGUINT64:p([32,0]),INT8:p([32,0]),INT16:p([32,0]),INT32:p([32,0]),BIGINT64:p([32,0]),FLOAT:p([32,0]),DOUBLE:p([32,0]),DATA:p([32,0]),UINT8C:p([32,0]),BUFFER:p([32,0])});var e=typeof Uint8ClampedArray<"u",l=typeof BigUint64Array<"u",o=typeof BigInt64Array<"u",a=t.__TYPEDARRAY_POOL;a.UINT8C||(a.UINT8C=p([32,0])),a.BIGUINT64||(a.BIGUINT64=p([32,0])),a.BIGINT64||(a.BIGINT64=p([32,0])),a.BUFFER||(a.BUFFER=p([32,0]));var n=a.DATA,s=a.BUFFER;function r(w){if(w){var C=w.length||w.byteLength,S=h.log2(C);n[S].push(w)}}function c(w){w=h.nextPow2(w);var C=h.log2(w),S=n[C];return S.length>0?S.pop():new ArrayBuffer(w)}function f(w){return new Uint8Array(c(w),0,w)}function d(w){return new Uint16Array(c(2*w),0,w)}function g(w){return new Uint32Array(c(4*w),0,w)}function m(w){return new Int8Array(c(w),0,w)}function y(w){return new Int16Array(c(2*w),0,w)}function v(w){return new Int32Array(c(4*w),0,w)}function T(w){return new Float32Array(c(4*w),0,w)}function _(w){return new Float64Array(c(8*w),0,w)}function k(w){return e?new Uint8ClampedArray(c(w),0,w):f(w)}function E(w){return l?new BigUint64Array(c(8*w),0,w):null}function A(w){return o?new BigInt64Array(c(8*w),0,w):null}function b(w){return new DataView(c(w),0,w)}function L(w){w=h.nextPow2(w);var C=h.log2(w),S=s[C];return S.length>0?S.pop():new u(w)}V.free=function(w){if(u.isBuffer(w))s[h.log2(w.length)].push(w);else{if(Object.prototype.toString.call(w)!=="[object ArrayBuffer]"&&(w=w.buffer),!w)return;var C=w.length||w.byteLength,S=0|h.log2(C);n[S].push(w)}},V.freeUint8=V.freeUint16=V.freeUint32=V.freeBigUint64=V.freeInt8=V.freeInt16=V.freeInt32=V.freeBigInt64=V.freeFloat32=V.freeFloat=V.freeFloat64=V.freeDouble=V.freeUint8Clamped=V.freeDataView=function(w){r(w.buffer)},V.freeArrayBuffer=r,V.freeBuffer=function(w){s[h.log2(w.length)].push(w)},V.malloc=function(w,C){if(C===void 0||C==="arraybuffer")return c(w);switch(C){case"uint8":return f(w);case"uint16":return d(w);case"uint32":return g(w);case"int8":return m(w);case"int16":return y(w);case"int32":return v(w);case"float":case"float32":return T(w);case"double":case"float64":return _(w);case"uint8_clamped":return k(w);case"bigint64":return A(w);case"biguint64":return E(w);case"buffer":return L(w);case"data":case"dataview":return b(w);default:return null}return null},V.mallocArrayBuffer=c,V.mallocUint8=f,V.mallocUint16=d,V.mallocUint32=g,V.mallocInt8=m,V.mallocInt16=y,V.mallocInt32=v,V.mallocFloat32=V.mallocFloat=T,V.mallocFloat64=V.mallocDouble=_,V.mallocUint8Clamped=k,V.mallocBigUint64=E,V.mallocBigInt64=A,V.mallocDataView=b,V.mallocBuffer=L,V.clearCache=function(){for(var w=0;w<32;++w)a.UINT8[w].length=0,a.UINT16[w].length=0,a.UINT32[w].length=0,a.INT8[w].length=0,a.INT16[w].length=0,a.INT32[w].length=0,a.FLOAT[w].length=0,a.DOUBLE[w].length=0,a.BIGUINT64[w].length=0,a.BIGINT64[w].length=0,a.UINT8C[w].length=0,n[w].length=0,s[w].length=0}}).call(this)}).call(this,typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":104,buffer:117,dup:185}],618:[function(i,B,V){function t(p){this.roots=new Array(p),this.ranks=new Array(p);for(var u=0;u<p;++u)this.roots[u]=u,this.ranks[u]=0}B.exports=t;var h=t.prototype;Object.defineProperty(h,"length",{get:function(){return this.roots.length}}),h.makeSet=function(){var p=this.roots.length;return this.roots.push(p),this.ranks.push(0),p},h.find=function(p){for(var u=p,e=this.roots;e[p]!==p;)p=e[p];for(;e[u]!==p;){var l=e[u];e[u]=p,u=l}return p},h.link=function(p,u){var e=this.find(p),l=this.find(u);if(e!==l){var o=this.ranks,a=this.roots,n=o[e],s=o[l];n<s?a[e]=l:s<n?a[l]=e:(a[l]=e,++o[e])}}},{}],619:[function(i,B,V){B.exports=function(t,h,p){return t.length===0?t:h?(p||t.sort(h),function(u,e){for(var l=1,o=u.length,a=u[0],n=u[0],s=1;s<o;++s)if(n=a,e(a=u[s],n)){if(s===l){l++;continue}u[l++]=a}return u.length=l,u}(t,h)):(p||t.sort(),function(u){for(var e=1,l=u.length,o=u[0],a=u[0],n=1;n<l;++n,a=o)if(a=o,(o=u[n])!==a){if(n===e){e++;continue}u[e++]=o}return u.length=e,u}(t))}},{}],620:[function(i,B,V){var t=/[\'\"]/;B.exports=function(h){return h?(t.test(h.charAt(0))&&(h=h.substr(1)),t.test(h.charAt(h.length-1))&&(h=h.substr(0,h.length-1)),h):""}},{}],621:[function(i,B,V){B.exports=function(t,h,p){Array.isArray(p)||(p=[].slice.call(arguments,2));for(var u=0,e=p.length;u<e;u++){var l=p[u];for(var o in l)if((h[o]===void 0||Array.isArray(h[o])||t[o]!==h[o])&&o in h){var a;if(l[o]===!0)a=h[o];else if(l[o]===!1||typeof l[o]=="function"&&(a=l[o](h[o],t,h))===void 0)continue;t[o]=a}}return t}},{}],622:[function(i,B,V){(function(t){(function(){function h(p){try{if(!t.localStorage)return!1}catch{return!1}var u=t.localStorage[p];return u!=null&&String(u).toLowerCase()==="true"}B.exports=function(p,u){if(h("noDeprecation"))return p;var e=!1;return function(){if(!e){if(h("throwDeprecation"))throw new Error(u);h("traceDeprecation")?console.trace(u):console.warn(u),e=!0}return p.apply(this,arguments)}}}).call(this)}).call(this,typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{}],623:[function(i,B,V){B.exports=function(u,e){return typeof e=="object"&&e!==null||(e={}),t(u,e.canvas||h,e.context||p,e)};var t=i("./lib/vtext"),h=null,p=null;typeof document<"u"&&((h=document.createElement("canvas")).width=8192,h.height=1024,p=h.getContext("2d"))},{"./lib/vtext":624}],624:[function(i,B,V){B.exports=function(r,c,f,d){var g=64,m=1.25,y={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return d&&(d.size&&d.size>0&&(g=d.size),d.lineSpacing&&d.lineSpacing>0&&(m=d.lineSpacing),d.styletags&&d.styletags.breaklines&&(y.breaklines=!!d.styletags.breaklines),d.styletags&&d.styletags.bolds&&(y.bolds=!!d.styletags.bolds),d.styletags&&d.styletags.italics&&(y.italics=!!d.styletags.italics),d.styletags&&d.styletags.subscripts&&(y.subscripts=!!d.styletags.subscripts),d.styletags&&d.styletags.superscripts&&(y.superscripts=!!d.styletags.superscripts)),f.font=[d.fontStyle,d.fontVariant,d.fontWeight,g+"px",d.font].filter(function(v){return v}).join(" "),f.textAlign="start",f.textBaseline="alphabetic",f.direction="ltr",s(function(v,T,_,k,E,A){_=_.replace(/\n/g,""),_=A.breaklines===!0?_.replace(/\<br\>/g,`
`):_.replace(/\<br\>/g," ");var b="",L=[];for(P=0;P<_.length;++P)L[P]=b;A.bolds===!0&&(L=o("b","b|",_,L)),A.italics===!0&&(L=o("i","i|",_,L)),A.superscripts===!0&&(L=o("sup","+1",_,L)),A.subscripts===!0&&(L=o("sub","-1",_,L));var w=[],C="";for(P=0;P<_.length;++P)L[P]!==null&&(C+=_[P],w.push(L[P]));var S,P,z,F,q,W=C.split(`
`),X=W.length,Q=Math.round(E*k),Z=k,Y=2*k,N=0,J=X*Q+Y;v.height<J&&(v.height=J),T.fillStyle="#000",T.fillRect(0,0,v.width,v.height),T.fillStyle="#fff";var D=0,U="";function G(){if(U!==""){var se=T.measureText(U).width;T.fillText(U,Z+z,Y+F),z+=se}}function $(){return Math.round(q)+"px "}function K(se,de){var ce=""+T.font;if(A.subscripts===!0){var ve=se.indexOf("-"),Ee=de.indexOf("-"),Le=ve>-1?parseInt(se[1+ve]):0,Te=Ee>-1?parseInt(de[1+Ee]):0;Le!==Te&&(ce=ce.replace($(),"?px "),q*=Math.pow(.75,Te-Le),ce=ce.replace("?px ",$())),F+=.25*Q*(Te-Le)}if(A.superscripts===!0){var xe=se.indexOf("+"),fe=de.indexOf("+"),ge=xe>-1?parseInt(se[1+xe]):0,ke=fe>-1?parseInt(de[1+fe]):0;ge!==ke&&(ce=ce.replace($(),"?px "),q*=Math.pow(.75,ke-ge),ce=ce.replace("?px ",$())),F-=.25*Q*(ke-ge)}if(A.bolds===!0){var Me=se.indexOf("b|")>-1,Se=de.indexOf("b|")>-1;!Me&&Se&&(ce=De?ce.replace("italic ","italic bold "):"bold "+ce),Me&&!Se&&(ce=ce.replace("bold ",""))}if(A.italics===!0){var De=se.indexOf("i|")>-1,Be=de.indexOf("i|")>-1;!De&&Be&&(ce="italic "+ce),De&&!Be&&(ce=ce.replace("italic ",""))}T.font=ce}for(S=0;S<X;++S){var re=W[S]+`
`;for(z=0,F=S*Q,q=k,U="",P=0;P<re.length;++P){var ne=P+D<w.length?w[P+D]:w[w.length-1];b===ne?U+=re[P]:(G(),U=re[P],ne!==void 0&&(K(b,ne),b=ne))}G(),D+=re.length;var ae=0|Math.round(z+2*Z);N<ae&&(N=ae)}var ie=N,he=Y+Q*X;return h(T.getImageData(0,0,ie,he).data,[he,ie,4]).pick(-1,-1,0).transpose(1,0)}(c,f,r,g,m,y),d,g)},B.exports.processPixels=s;var t=i("surface-nets"),h=i("ndarray"),p=i("simplify-planar-graph"),u=i("clean-pslg"),e=i("cdt2d"),l=i("planar-graph-to-polyline");function o(r,c,f,d){for(var g="<"+r+">",m="</"+r+">",y=g.length,v=m.length,T=c[0]==="+"||c[0]==="-",_=0,k=-v;_>-1&&(_=f.indexOf(g,_))!==-1&&(k=f.indexOf(m,_+y))!==-1&&!(k<=_);){for(var E=_;E<k+v;++E)if(E<_+y||E>=k)d[E]=null,f=f.substr(0,E)+" "+f.substr(E+1);else if(d[E]!==null){var A=d[E].indexOf(c[0]);A===-1?d[E]+=c:T&&(d[E]=d[E].substr(0,A+1)+(1+parseInt(d[E][A+1]))+d[E].substr(A+2))}var b=_+y,L=f.substr(b,k-b).indexOf(g);_=L!==-1?L:k+v}return d}function a(r,c){var f=t(r,128);return c?p(f.cells,f.positions,.25):{edges:f.cells,positions:f.positions}}function n(r,c,f,d){var g=a(r,d),m=function(S,P,z){for(var F=P.textAlign||"start",q=P.textBaseline||"alphabetic",W=[1<<30,1<<30],X=[0,0],Q=S.length,Z=0;Z<Q;++Z)for(var Y=S[Z],N=0;N<2;++N)W[N]=0|Math.min(W[N],Y[N]),X[N]=0|Math.max(X[N],Y[N]);var J=0;switch(F){case"center":J=-.5*(W[0]+X[0]);break;case"right":case"end":J=-X[0];break;case"left":case"start":J=-W[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+F+"'")}var D=0;switch(q){case"hanging":case"top":D=-W[1];break;case"middle":D=-.5*(W[1]+X[1]);break;case"alphabetic":case"ideographic":D=-3*z;break;case"bottom":D=-X[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+q+"'")}var U=1/z;return"lineHeight"in P?U*=+P.lineHeight:"width"in P?U=P.width/(X[0]-W[0]):"height"in P&&(U=P.height/(X[1]-W[1])),S.map(function(G){return[U*(G[0]+J),U*(G[1]+D)]})}(g.positions,c,f),y=g.edges,v=c.orientation==="ccw";if(u(m,y),c.polygons||c.polygon||c.polyline){for(var T=l(y,m),_=new Array(T.length),k=0;k<T.length;++k){for(var E=T[k],A=new Array(E.length),b=0;b<E.length;++b){for(var L=E[b],w=new Array(L.length),C=0;C<L.length;++C)w[C]=m[L[C]].slice();v&&w.reverse(),A[b]=w}_[k]=A}return _}return c.triangles||c.triangulate||c.triangle?{cells:e(m,y,{delaunay:!1,exterior:!1,interior:!0}),positions:m}:{edges:y,positions:m}}function s(r,c,f){try{return n(r,c,f,!0)}catch{}try{return n(r,c,f,!1)}catch{}return c.polygons||c.polyline||c.polygon?[]:c.triangles||c.triangulate||c.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:118,"clean-pslg":127,ndarray:483,"planar-graph-to-polyline":501,"simplify-planar-graph":563,"surface-nets":591}],625:[function(i,B,V){(function(){if(typeof ses>"u"||!ses.ok||ses.ok()){typeof ses<"u"&&(ses.weakMapPermitHostObjects=g);var t=!1;if(typeof WeakMap=="function"){var h=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var p=new h,u=Object.freeze({});if(p.set(u,1),p.get(u)===1)return void(B.exports=WeakMap);t=!0}}var e=Object.getOwnPropertyNames,l=Object.defineProperty,o=Object.isExtensible,a="weakmap:ident:"+Math.random()+"___";if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var n=new ArrayBuffer(25),s=new Uint8Array(n);crypto.getRandomValues(s),a="weakmap:rand:"+Array.prototype.map.call(s,function(_){return(_%36).toString(36)}).join("")+"___"}if(l(Object,"getOwnPropertyNames",{value:function(_){return e(_).filter(m)}}),"getPropertyNames"in Object){var r=Object.getPropertyNames;l(Object,"getPropertyNames",{value:function(_){return r(_).filter(m)}})}(function(){var _=Object.freeze;l(Object,"freeze",{value:function(A){return y(A),_(A)}});var k=Object.seal;l(Object,"seal",{value:function(A){return y(A),k(A)}});var E=Object.preventExtensions;l(Object,"preventExtensions",{value:function(A){return y(A),E(A)}})})();var c=!1,f=0,d=function(){this instanceof d||T();var _=[],k=[],E=f++;return Object.create(d.prototype,{get___:{value:v(function(A,b){var L,w=y(A);return w?E in w?w[E]:b:(L=_.indexOf(A))>=0?k[L]:b})},has___:{value:v(function(A){var b=y(A);return b?E in b:_.indexOf(A)>=0})},set___:{value:v(function(A,b){var L,w=y(A);return w?w[E]=b:(L=_.indexOf(A))>=0?k[L]=b:(L=_.length,k[L]=b,_[L]=A),this})},delete___:{value:v(function(A){var b,L,w=y(A);return w?E in w&&delete w[E]:!((b=_.indexOf(A))<0)&&(L=_.length-1,_[b]=void 0,k[b]=k[L],_[b]=_[L],_.length=L,k.length=L,!0)})}})};d.prototype=Object.create(Object.prototype,{get:{value:function(_,k){return this.get___(_,k)},writable:!0,configurable:!0},has:{value:function(_){return this.has___(_)},writable:!0,configurable:!0},set:{value:function(_,k){return this.set___(_,k)},writable:!0,configurable:!0},delete:{value:function(_){return this.delete___(_)},writable:!0,configurable:!0}}),typeof h=="function"?function(){function _(){this instanceof d||T();var k,E=new h,A=void 0,b=!1;return k=t?function(L,w){return E.set(L,w),E.has(L)||(A||(A=new d),A.set(L,w)),this}:function(L,w){if(b)try{E.set(L,w)}catch{A||(A=new d),A.set___(L,w)}else E.set(L,w);return this},Object.create(d.prototype,{get___:{value:v(function(L,w){return A?E.has(L)?E.get(L):A.get___(L,w):E.get(L,w)})},has___:{value:v(function(L){return E.has(L)||!!A&&A.has___(L)})},set___:{value:v(k)},delete___:{value:v(function(L){var w=!!E.delete(L);return A&&A.delete___(L)||w})},permitHostObjects___:{value:v(function(L){if(L!==g)throw new Error("bogus call to permitHostObjects___");b=!0})}})}t&&typeof Proxy<"u"&&(Proxy=void 0),_.prototype=d.prototype,B.exports=_,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),B.exports=d)}function g(_){_.permitHostObjects___&&_.permitHostObjects___(g)}function m(_){return!(_.substr(0,8)=="weakmap:"&&_.substr(_.length-3)==="___")}function y(_){if(_!==Object(_))throw new TypeError("Not an object: "+_);var k=_[a];if(k&&k.key===_)return k;if(o(_)){k={key:_};try{return l(_,a,{value:k,writable:!1,enumerable:!1,configurable:!1}),k}catch{return}}}function v(_){return _.prototype=null,Object.freeze(_)}function T(){c||typeof console>"u"||(c=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}})()},{}],626:[function(i,B,V){var t=i("./hidden-store.js");B.exports=function(){var h={};return function(p){if((typeof p!="object"||p===null)&&typeof p!="function")throw new Error("Weakmap-shim: Key must be object");var u=p.valueOf(h);return u&&u.identity===h?u:t(p,h)}}},{"./hidden-store.js":627}],627:[function(i,B,V){B.exports=function(t,h){var p={identity:h},u=t.valueOf;return Object.defineProperty(t,"valueOf",{value:function(e){return e!==h?u.apply(this,arguments):p},writable:!0}),p}},{}],628:[function(i,B,V){var t=i("./create-store.js");B.exports=function(){var h=t();return{get:function(p,u){var e=h(p);return e.hasOwnProperty("value")?e.value:u},set:function(p,u){return h(p).value=u,this},has:function(p){return"value"in h(p)},delete:function(p){return delete h(p).value}}}},{"./create-store.js":626}],629:[function(i,B,V){var t=i("get-canvas-context");B.exports=function(h){return t("webgl",h)}},{"get-canvas-context":257}],630:[function(i,B,V){var t=i("../main"),h=i("object-assign"),p=t.instance();function u(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}u.prototype=new t.baseCalendar,h(u.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(r,c){if(typeof r=="string"){var f=r.match(l);return f?f[0]:""}var d=this._validateYear(r),g=r.month(),m=""+this.toChineseMonth(d,g);return c&&m.length<2&&(m="0"+m),this.isIntercalaryMonth(d,g)&&(m+="i"),m},monthNames:function(r){if(typeof r=="string"){var c=r.match(o);return c?c[0]:""}var f=this._validateYear(r),d=r.month(),g=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"][this.toChineseMonth(f,d)-1];return this.isIntercalaryMonth(f,d)&&(g="闰"+g),g},monthNamesShort:function(r){if(typeof r=="string"){var c=r.match(a);return c?c[0]:""}var f=this._validateYear(r),d=r.month(),g=["一","二","三","四","五","六","七","八","九","十","十一","十二"][this.toChineseMonth(f,d)-1];return this.isIntercalaryMonth(f,d)&&(g="闰"+g),g},parseMonth:function(r,c){r=this._validateYear(r);var f,d=parseInt(c);if(isNaN(d))c[0]==="闰"&&(f=!0,c=c.substring(1)),c[c.length-1]==="月"&&(c=c.substring(0,c.length-1)),d=1+["一","二","三","四","五","六","七","八","九","十","十一","十二"].indexOf(c);else{var g=c[c.length-1];f=g==="i"||g==="I"}return this.toMonthIndex(r,d,f)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(r,c){if(r.year&&(r=r.year()),typeof r!="number"||r<1888||r>2111)throw c.replace(/\{0\}/,this.local.name);return r},toMonthIndex:function(r,c,f){var d=this.intercalaryMonth(r);if(f&&c!==d||c<1||c>12)throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return d?!f&&c<=d?c-1:c:c-1},toChineseMonth:function(r,c){r.year&&(c=(r=r.year()).month());var f=this.intercalaryMonth(r);if(c<0||c>(f?12:11))throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return f?c<f?c+1:c:c+1},intercalaryMonth:function(r){return r=this._validateYear(r),n[r-n[0]]>>13},isIntercalaryMonth:function(r,c){r.year&&(c=(r=r.year()).month());var f=this.intercalaryMonth(r);return!!f&&f===c},leapYear:function(r){return this.intercalaryMonth(r)!==0},weekOfYear:function(r,c,f){var d,g=this._validateYear(r,t.local.invalidyear),m=s[g-s[0]],y=m>>9&4095,v=m>>5&15,T=31&m;(d=p.newDate(y,v,T)).add(4-(d.dayOfWeek()||7),"d");var _=this.toJD(r,c,f)-d.toJD();return 1+Math.floor(_/7)},monthsInYear:function(r){return this.leapYear(r)?13:12},daysInMonth:function(r,c){r.year&&(c=r.month(),r=r.year()),r=this._validateYear(r);var f=n[r-n[0]];if(c>(f>>13?12:11))throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return f&1<<12-c?30:29},weekDay:function(r,c,f){return(this.dayOfWeek(r,c,f)||7)<6},toJD:function(r,c,f){var d=this._validate(r,m,f,t.local.invalidDate);r=this._validateYear(d.year()),c=d.month(),f=d.day();var g=this.isIntercalaryMonth(r,c),m=this.toChineseMonth(r,c),y=function(v,T,_,k,E){var A,b,L;if(typeof v=="object")b=v,A=T||{};else{var w;if(!(typeof v=="number"&&v>=1888&&v<=2111))throw new Error("Lunar year outside range 1888-2111");if(!(typeof T=="number"&&T>=1&&T<=12))throw new Error("Lunar month outside range 1 - 12");if(!(typeof _=="number"&&_>=1&&_<=30))throw new Error("Lunar day outside range 1 - 30");typeof k=="object"?(w=!1,A=k):(w=!!k,A=E||{}),b={year:v,month:T,day:_,isIntercalary:w}}L=b.day-1;var C,S=n[b.year-n[0]],P=S>>13;C=P&&(b.month>P||b.isIntercalary)?b.month:b.month-1;for(var z=0;z<C;z++)L+=S&1<<12-z?30:29;var F=s[b.year-s[0]],q=new Date(F>>9&4095,(F>>5&15)-1,(31&F)+L);return A.year=q.getFullYear(),A.month=1+q.getMonth(),A.day=q.getDate(),A}(r,m,f,g);return p.toJD(y.year,y.month,y.day)},fromJD:function(r){var c=p.fromJD(r),f=function(g,m,y,v){var T,_;if(typeof g=="object")T=g,_=m||{};else{if(!(typeof g=="number"&&g>=1888&&g<=2111))throw new Error("Solar year outside range 1888-2111");if(!(typeof m=="number"&&m>=1&&m<=12))throw new Error("Solar month outside range 1 - 12");if(!(typeof y=="number"&&y>=1&&y<=31))throw new Error("Solar day outside range 1 - 31");T={year:g,month:m,day:y},_=v||{}}var k=s[T.year-s[0]],E=T.year<<9|T.month<<5|T.day;_.year=E>=k?T.year:T.year-1,k=s[_.year-s[0]];var A,b=new Date(k>>9&4095,(k>>5&15)-1,31&k),L=new Date(T.year,T.month-1,T.day);A=Math.round((L-b)/864e5);var w,C=n[_.year-n[0]];for(w=0;w<13;w++){var S=C&1<<12-w?30:29;if(A<S)break;A-=S}var P=C>>13;return!P||w<P?(_.isIntercalary=!1,_.month=1+w):w===P?(_.isIntercalary=!0,_.month=w):(_.isIntercalary=!1,_.month=w),_.day=1+A,_}(c.year(),c.month(),c.day()),d=this.toMonthIndex(f.year,f.month,f.isIntercalary);return this.newDate(f.year,d,f.day)},fromString:function(r){var c=r.match(e),f=this._validateYear(+c[1]),d=+c[2],g=!!c[3],m=this.toMonthIndex(f,d,g),y=+c[4];return this.newDate(f,m,y)},add:function(r,c,f){var d=r.year(),g=r.month(),m=this.isIntercalaryMonth(d,g),y=this.toChineseMonth(d,g),v=Object.getPrototypeOf(u.prototype).add.call(this,r,c,f);if(f==="y"){var T=v.year(),_=v.month(),k=this.isIntercalaryMonth(T,y),E=m&&k?this.toMonthIndex(T,y,!0):this.toMonthIndex(T,y,!1);E!==_&&v.month(E)}return v}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,l=/^\d?\d[iI]?/m,o=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,a=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;t.calendars.chinese=u;var n=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],s=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":644,"object-assign":487}],631:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(u){this.local=this.regionalOptions[u||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(u){var e=this._validate(u,this.minMonth,this.minDay,t.local.invalidYear);return(u=e.year()+(e.year()<0?1:0))%4==3||u%4==-1},monthsInYear:function(u){return this._validate(u,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),13},weekOfYear:function(u,e,l){var o=this.newDate(u,e,l);return o.add(-o.dayOfWeek(),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(u,e){var l=this._validate(u,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[l.month()-1]+(l.month()===13&&this.leapYear(l.year())?1:0)},weekDay:function(u,e,l){return(this.dayOfWeek(u,e,l)||7)<6},toJD:function(u,e,l){var o=this._validate(u,e,l,t.local.invalidDate);return(u=o.year())<0&&u++,o.day()+30*(o.month()-1)+365*(u-1)+Math.floor(u/4)+this.jdEpoch-1},fromJD:function(u){var e=Math.floor(u)+.5-this.jdEpoch,l=Math.floor((e-Math.floor((e+366)/1461))/365)+1;l<=0&&l--,e=Math.floor(u)+.5-this.newDate(l,1,1).toJD();var o=Math.floor(e/30)+1,a=e-30*(o-1)+1;return this.newDate(l,o,a)}}),t.calendars.coptic=p},{"../main":644,"object-assign":487}],632:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),400},weekOfYear:function(e,l,o){var a=this.newDate(e,l,o);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/8)+1},daysInMonth:function(e,l){var o=this._validate(e,l,this.minDay,t.local.invalidMonth);return this.daysPerMonth[o.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,l,o){return(this._validate(e,l,o,t.local.invalidDate).day()+1)%8},weekDay:function(e,l,o){var a=this.dayOfWeek(e,l,o);return a>=2&&a<=6},extraInfo:function(e,l,o){var a=this._validate(e,l,o,t.local.invalidDate);return{century:u[Math.floor((a.year()-1)/100)+1]||""}},toJD:function(e,l,o){var a=this._validate(e,l,o,t.local.invalidDate);return e=a.year()+(a.year()<0?1:0),l=a.month(),(o=a.day())+(l>1?16:0)+(l>2?32*(l-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var l=Math.floor(e/400)+1;e-=400*(l-1),e+=e>15?16:0;var o=Math.floor(e/32)+1,a=e-32*(o-1)+1;return this.newDate(l<=0?l-1:l,o,a)}});var u={20:"Fruitbat",21:"Anchovy"};t.calendars.discworld=p},{"../main":644,"object-assign":487}],633:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(u){this.local=this.regionalOptions[u||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(u){var e=this._validate(u,this.minMonth,this.minDay,t.local.invalidYear);return(u=e.year()+(e.year()<0?1:0))%4==3||u%4==-1},monthsInYear:function(u){return this._validate(u,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),13},weekOfYear:function(u,e,l){var o=this.newDate(u,e,l);return o.add(-o.dayOfWeek(),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(u,e){var l=this._validate(u,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[l.month()-1]+(l.month()===13&&this.leapYear(l.year())?1:0)},weekDay:function(u,e,l){return(this.dayOfWeek(u,e,l)||7)<6},toJD:function(u,e,l){var o=this._validate(u,e,l,t.local.invalidDate);return(u=o.year())<0&&u++,o.day()+30*(o.month()-1)+365*(u-1)+Math.floor(u/4)+this.jdEpoch-1},fromJD:function(u){var e=Math.floor(u)+.5-this.jdEpoch,l=Math.floor((e-Math.floor((e+366)/1461))/365)+1;l<=0&&l--,e=Math.floor(u)+.5-this.newDate(l,1,1).toJD();var o=Math.floor(e/30)+1,a=e-30*(o-1)+1;return this.newDate(l,o,a)}}),t.calendars.ethiopian=p},{"../main":644,"object-assign":487}],634:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function u(e,l){return e-l*Math.floor(e/l)}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var l=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return this._leapYear(l.year())},_leapYear:function(e){return u(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,l,o){var a=this.newDate(e,l,o);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear).year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,l){return e.year&&(l=e.month(),e=e.year()),this._validate(e,l,this.minDay,t.local.invalidMonth),l===12&&this.leapYear(e)||l===8&&u(this.daysInYear(e),10)===5?30:l===9&&u(this.daysInYear(e),10)===3?29:this.daysPerMonth[l-1]},weekDay:function(e,l,o){return this.dayOfWeek(e,l,o)!==6},extraInfo:function(e,l,o){var a=this._validate(e,l,o,t.local.invalidDate);return{yearType:(this.leapYear(a)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(a)%10-3]}},toJD:function(e,l,o){var a=this._validate(e,l,o,t.local.invalidDate);e=a.year(),l=a.month(),o=a.day();var n=e<=0?e+1:e,s=this.jdEpoch+this._delay1(n)+this._delay2(n)+o+1;if(l<7){for(var r=7;r<=this.monthsInYear(e);r++)s+=this.daysInMonth(e,r);for(r=1;r<l;r++)s+=this.daysInMonth(e,r)}else for(r=7;r<l;r++)s+=this.daysInMonth(e,r);return s},_delay1:function(e){var l=Math.floor((235*e-234)/19),o=12084+13753*l,a=29*l+Math.floor(o/25920);return u(3*(a+1),7)<3&&a++,a},_delay2:function(e){var l=this._delay1(e-1),o=this._delay1(e);return this._delay1(e+1)-o==356?2:o-l==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var l=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(l===-1?1:l+1,7,1);)l++;for(var o=e<this.toJD(l,1,1)?7:1;e>this.toJD(l,o,this.daysInMonth(l,o));)o++;var a=e-this.toJD(l,o,1)+1;return this.newDate(l,o,a)}}),t.calendars.hebrew=p},{"../main":644,"object-assign":487}],635:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(u){this.local=this.regionalOptions[u||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-khamīs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(u){return(11*this._validate(u,this.minMonth,this.minDay,t.local.invalidYear).year()+14)%30<11},weekOfYear:function(u,e,l){var o=this.newDate(u,e,l);return o.add(-o.dayOfWeek(),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInYear:function(u){return this.leapYear(u)?355:354},daysInMonth:function(u,e){var l=this._validate(u,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[l.month()-1]+(l.month()===12&&this.leapYear(l.year())?1:0)},weekDay:function(u,e,l){return this.dayOfWeek(u,e,l)!==5},toJD:function(u,e,l){var o=this._validate(u,e,l,t.local.invalidDate);return u=o.year(),e=o.month(),u=u<=0?u+1:u,(l=o.day())+Math.ceil(29.5*(e-1))+354*(u-1)+Math.floor((3+11*u)/30)+this.jdEpoch-1},fromJD:function(u){u=Math.floor(u)+.5;var e=Math.floor((30*(u-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var l=Math.min(12,Math.ceil((u-29-this.toJD(e,1,1))/29.5)+1),o=u-this.toJD(e,l,1)+1;return this.newDate(e,l,o)}}),t.calendars.islamic=p},{"../main":644,"object-assign":487}],636:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(u){this.local=this.regionalOptions[u||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(u){var e=this._validate(u,this.minMonth,this.minDay,t.local.invalidYear);return(u=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(u,e,l){var o=this.newDate(u,e,l);return o.add(4-(o.dayOfWeek()||7),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(u,e){var l=this._validate(u,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[l.month()-1]+(l.month()===2&&this.leapYear(l.year())?1:0)},weekDay:function(u,e,l){return(this.dayOfWeek(u,e,l)||7)<6},toJD:function(u,e,l){var o=this._validate(u,e,l,t.local.invalidDate);return u=o.year(),e=o.month(),l=o.day(),u<0&&u++,e<=2&&(u--,e+=12),Math.floor(365.25*(u+4716))+Math.floor(30.6001*(e+1))+l-1524.5},fromJD:function(u){var e=Math.floor(u+.5)+1524,l=Math.floor((e-122.1)/365.25),o=Math.floor(365.25*l),a=Math.floor((e-o)/30.6001),n=a-Math.floor(a<14?1:13),s=l-Math.floor(n>2?4716:4715),r=e-o-Math.floor(30.6001*a);return s<=0&&s--,this.newDate(s,n,r)}}),t.calendars.julian=p},{"../main":644,"object-assign":487}],637:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(l){this.local=this.regionalOptions[l||""]||this.regionalOptions[""]}function u(l,o){return l-o*Math.floor(l/o)}function e(l,o){return u(l-1,o)+1}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(l){return this._validate(l,this.minMonth,this.minDay,t.local.invalidYear),!1},formatYear:function(l){l=this._validate(l,this.minMonth,this.minDay,t.local.invalidYear).year();var o=Math.floor(l/400);return l%=400,l+=l<0?400:0,o+"."+Math.floor(l/20)+"."+l%20},forYear:function(l){if((l=l.split(".")).length<3)throw"Invalid Mayan year";for(var o=0,a=0;a<l.length;a++){var n=parseInt(l[a],10);if(Math.abs(n)>19||a>0&&n<0)throw"Invalid Mayan year";o=20*o+n}return o},monthsInYear:function(l){return this._validate(l,this.minMonth,this.minDay,t.local.invalidYear),18},weekOfYear:function(l,o,a){return this._validate(l,o,a,t.local.invalidDate),0},daysInYear:function(l){return this._validate(l,this.minMonth,this.minDay,t.local.invalidYear),360},daysInMonth:function(l,o){return this._validate(l,o,this.minDay,t.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(l,o,a){return this._validate(l,o,a,t.local.invalidDate).day()},weekDay:function(l,o,a){return this._validate(l,o,a,t.local.invalidDate),!0},extraInfo:function(l,o,a){var n=this._validate(l,o,a,t.local.invalidDate).toJD(),s=this._toHaab(n),r=this._toTzolkin(n);return{haabMonthName:this.local.haabMonths[s[0]-1],haabMonth:s[0],haabDay:s[1],tzolkinDayName:this.local.tzolkinMonths[r[0]-1],tzolkinDay:r[0],tzolkinTrecena:r[1]}},_toHaab:function(l){var o=u((l-=this.jdEpoch)+8+340,365);return[Math.floor(o/20)+1,u(o,20)]},_toTzolkin:function(l){return[e((l-=this.jdEpoch)+20,20),e(l+4,13)]},toJD:function(l,o,a){var n=this._validate(l,o,a,t.local.invalidDate);return n.day()+20*n.month()+360*n.year()+this.jdEpoch},fromJD:function(l){l=Math.floor(l)+.5-this.jdEpoch;var o=Math.floor(l/360);l%=360,l+=l<0?360:0;var a=Math.floor(l/20),n=l%20;return this.newDate(o,a,n)}}),t.calendars.mayan=p},{"../main":644,"object-assign":487}],638:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar;var u=t.instance("gregorian");h(p.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var l=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return u.leapYear(l.year()+(l.year()<1?1:0)+1469)},weekOfYear:function(e,l,o){var a=this.newDate(e,l,o);return a.add(1-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,l){var o=this._validate(e,l,this.minDay,t.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(o.month()===12&&this.leapYear(o.year())?1:0)},weekDay:function(e,l,o){return(this.dayOfWeek(e,l,o)||7)<6},toJD:function(e,l,o){var a=this._validate(e,l,o,t.local.invalidMonth);(e=a.year())<0&&e++;for(var n=a.day(),s=1;s<a.month();s++)n+=this.daysPerMonth[s-1];return n+u.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var l=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(l+1,1,1);)l++;for(var o=e-Math.floor(this.toJD(l,1,1)+.5)+1,a=1;o>this.daysInMonth(l,a);)o-=this.daysInMonth(l,a),a++;return this.newDate(l,a,o)}}),t.calendars.nanakshahi=p},{"../main":644,"object-assign":487}],639:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(u){this.local=this.regionalOptions[u||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(u){return this.daysInYear(u)!==this.daysPerYear},weekOfYear:function(u,e,l){var o=this.newDate(u,e,l);return o.add(-o.dayOfWeek(),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInYear:function(u){if(u=this._validate(u,this.minMonth,this.minDay,t.local.invalidYear).year(),this.NEPALI_CALENDAR_DATA[u]===void 0)return this.daysPerYear;for(var e=0,l=this.minMonth;l<=12;l++)e+=this.NEPALI_CALENDAR_DATA[u][l];return e},daysInMonth:function(u,e){return u.year&&(e=u.month(),u=u.year()),this._validate(u,e,this.minDay,t.local.invalidMonth),this.NEPALI_CALENDAR_DATA[u]===void 0?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[u][e]},weekDay:function(u,e,l){return this.dayOfWeek(u,e,l)!==6},toJD:function(u,e,l){var o=this._validate(u,e,l,t.local.invalidDate);u=o.year(),e=o.month(),l=o.day();var a=t.instance(),n=0,s=e,r=u;this._createMissingCalendarData(u);var c=u-(s>9||s===9&&l>=this.NEPALI_CALENDAR_DATA[r][0]?56:57);for(e!==9&&(n=l,s--);s!==9;)s<=0&&(s=12,r--),n+=this.NEPALI_CALENDAR_DATA[r][s],s--;return e===9?(n+=l-this.NEPALI_CALENDAR_DATA[r][0])<0&&(n+=a.daysInYear(c)):n+=this.NEPALI_CALENDAR_DATA[r][9]-this.NEPALI_CALENDAR_DATA[r][0],a.newDate(c,1,1).add(n,"d").toJD()},fromJD:function(u){var e=t.instance().fromJD(u),l=e.year(),o=e.dayOfYear(),a=l+56;this._createMissingCalendarData(a);for(var n=9,s=this.NEPALI_CALENDAR_DATA[a][0],r=this.NEPALI_CALENDAR_DATA[a][n]-s+1;o>r;)++n>12&&(n=1,a++),r+=this.NEPALI_CALENDAR_DATA[a][n];var c=this.NEPALI_CALENDAR_DATA[a][n]-(r-o);return this.newDate(a,n,c)},_createMissingCalendarData:function(u){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var l=u-1;l<u+2;l++)this.NEPALI_CALENDAR_DATA[l]===void 0&&(this.NEPALI_CALENDAR_DATA[l]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),t.calendars.nepali=p},{"../main":644,"object-assign":487}],640:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function u(e,l){return e-l*Math.floor(e/l)}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Chæharshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Chæ","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var l=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return 682*((l.year()-(l.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,l,o){var a=this.newDate(e,l,o);return a.add(-(a.dayOfWeek()+1)%7,"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,l){var o=this._validate(e,l,this.minDay,t.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(o.month()===12&&this.leapYear(o.year())?1:0)},weekDay:function(e,l,o){return this.dayOfWeek(e,l,o)!==5},toJD:function(e,l,o){var a=this._validate(e,l,o,t.local.invalidDate);e=a.year(),l=a.month(),o=a.day();var n=e-(e>=0?474:473),s=474+u(n,2820);return o+(l<=7?31*(l-1):30*(l-1)+6)+Math.floor((682*s-110)/2816)+365*(s-1)+1029983*Math.floor(n/2820)+this.jdEpoch-1},fromJD:function(e){var l=(e=Math.floor(e)+.5)-this.toJD(475,1,1),o=Math.floor(l/1029983),a=u(l,1029983),n=2820;if(a!==1029982){var s=Math.floor(a/366),r=u(a,366);n=Math.floor((2134*s+2816*r+2815)/1028522)+s+1}var c=n+2820*o+474;c=c<=0?c-1:c;var f=e-this.toJD(c,1,1)+1,d=f<=186?Math.ceil(f/31):Math.ceil((f-6)/30),g=e-this.toJD(c,d,1)+1;return this.newDate(c,d,g)}}),t.calendars.persian=p,t.calendars.jalali=p},{"../main":644,"object-assign":487}],641:[function(i,B,V){var t=i("../main"),h=i("object-assign"),p=t.instance();function u(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}u.prototype=new t.baseCalendar,h(u.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var l=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(l.year()),p.leapYear(e)},weekOfYear:function(e,l,o){var a=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(a.year()),p.weekOfYear(e,a.month(),a.day())},daysInMonth:function(e,l){var o=this._validate(e,l,this.minDay,t.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(o.month()===2&&this.leapYear(o.year())?1:0)},weekDay:function(e,l,o){return(this.dayOfWeek(e,l,o)||7)<6},toJD:function(e,l,o){var a=this._validate(e,l,o,t.local.invalidDate);return e=this._t2gYear(a.year()),p.toJD(e,a.month(),a.day())},fromJD:function(e){var l=p.fromJD(e),o=this._g2tYear(l.year());return this.newDate(o,l.month(),l.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),t.calendars.taiwan=u},{"../main":644,"object-assign":487}],642:[function(i,B,V){var t=i("../main"),h=i("object-assign"),p=t.instance();function u(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}u.prototype=new t.baseCalendar,h(u.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var l=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(l.year()),p.leapYear(e)},weekOfYear:function(e,l,o){var a=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(a.year()),p.weekOfYear(e,a.month(),a.day())},daysInMonth:function(e,l){var o=this._validate(e,l,this.minDay,t.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(o.month()===2&&this.leapYear(o.year())?1:0)},weekDay:function(e,l,o){return(this.dayOfWeek(e,l,o)||7)<6},toJD:function(e,l,o){var a=this._validate(e,l,o,t.local.invalidDate);return e=this._t2gYear(a.year()),p.toJD(e,a.month(),a.day())},fromJD:function(e){var l=p.fromJD(e),o=this._g2tYear(l.year());return this.newDate(o,l.month(),l.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),t.calendars.thai=u},{"../main":644,"object-assign":487}],643:[function(i,B,V){var t=i("../main"),h=i("object-assign");function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thalāthā’","Yawm al-Arba‘ā’","Yawm al-Khamīs","Yawm al-Jum‘a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var l=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return this.daysInYear(l.year())===355},weekOfYear:function(e,l,o){var a=this.newDate(e,l,o);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var l=0,o=1;o<=12;o++)l+=this.daysInMonth(e,o);return l},daysInMonth:function(e,l){for(var o=this._validate(e,l,this.minDay,t.local.invalidMonth).toJD()-24e5+.5,a=0,n=0;n<u.length;n++){if(u[n]>o)return u[a]-u[a-1];a++}return 30},weekDay:function(e,l,o){return this.dayOfWeek(e,l,o)!==5},toJD:function(e,l,o){var a=this._validate(e,l,o,t.local.invalidDate),n=12*(a.year()-1)+a.month()-15292;return a.day()+u[n-1]-1+24e5-.5},fromJD:function(e){for(var l=e-24e5+.5,o=0,a=0;a<u.length&&!(u[a]>l);a++)o++;var n=o+15292,s=Math.floor((n-1)/12),r=s+1,c=n-12*s,f=l-u[o-1]+1;return this.newDate(r,c,f)},isValid:function(e,l,o){var a=t.baseCalendar.prototype.isValid.apply(this,arguments);return a&&(a=(e=e.year!=null?e.year:e)>=1276&&e<=1500),a},_validate:function(e,l,o,a){var n=t.baseCalendar.prototype._validate.apply(this,arguments);if(n.year<1276||n.year>1500)throw a.replace(/\{0\}/,this.local.name);return n}}),t.calendars.ummalqura=p;var u=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":644,"object-assign":487}],644:[function(i,B,V){var t=i("object-assign");function h(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function p(a,n,s,r){if(this._calendar=a,this._year=n,this._month=s,this._day=r,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(o.local.invalidDate||o.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function u(a,n){return"000000".substring(0,n-(a=""+a).length)+a}function e(){this.shortYearCutoff="+10"}function l(a){this.local=this.regionalOptions[a]||this.regionalOptions[""]}t(h.prototype,{instance:function(a,n){a=(a||"gregorian").toLowerCase(),n=n||"";var s=this._localCals[a+"-"+n];if(!s&&this.calendars[a]&&(s=new this.calendars[a](n),this._localCals[a+"-"+n]=s),!s)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,a);return s},newDate:function(a,n,s,r,c){return(r=(a!=null&&a.year?a.calendar():typeof r=="string"?this.instance(r,c):r)||this.instance()).newDate(a,n,s)},substituteDigits:function(a){return function(n){return(n+"").replace(/[0-9]/g,function(s){return a[s]})}},substituteChineseDigits:function(a,n){return function(s){for(var r="",c=0;s>0;){var f=s%10;r=(f===0?"":a[f]+n[c])+r,c++,s=Math.floor(s/10)}return r.indexOf(a[1]+n[1])===0&&(r=r.substr(1)),r||a[0]}}}),t(p.prototype,{newDate:function(a,n,s){return this._calendar.newDate(a??this,n,s)},year:function(a){return arguments.length===0?this._year:this.set(a,"y")},month:function(a){return arguments.length===0?this._month:this.set(a,"m")},day:function(a){return arguments.length===0?this._day:this.set(a,"d")},date:function(a,n,s){if(!this._calendar.isValid(a,n,s))throw(o.local.invalidDate||o.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=a,this._month=n,this._day=s,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(a,n){return this._calendar.add(this,a,n)},set:function(a,n){return this._calendar.set(this,a,n)},compareTo:function(a){if(this._calendar.name!==a._calendar.name)throw(o.local.differentCalendars||o.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,a._calendar.local.name);var n=this._year!==a._year?this._year-a._year:this._month!==a._month?this.monthOfYear()-a.monthOfYear():this._day-a._day;return n===0?0:n<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(a){return this._calendar.fromJD(a)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(a){return this._calendar.fromJSDate(a)},toString:function(){return(this.year()<0?"-":"")+u(Math.abs(this.year()),4)+"-"+u(this.month(),2)+"-"+u(this.day(),2)}}),t(e.prototype,{_validateLevel:0,newDate:function(a,n,s){return a==null?this.today():(a.year&&(this._validate(a,n,s,o.local.invalidDate||o.regionalOptions[""].invalidDate),s=a.day(),n=a.month(),a=a.year()),new p(this,a,n,s))},today:function(){return this.fromJSDate(new Date)},epoch:function(a){return this._validate(a,this.minMonth,this.minDay,o.local.invalidYear||o.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(a){var n=this._validate(a,this.minMonth,this.minDay,o.local.invalidYear||o.regionalOptions[""].invalidYear);return(n.year()<0?"-":"")+u(Math.abs(n.year()),4)},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,o.local.invalidYear||o.regionalOptions[""].invalidYear),12},monthOfYear:function(a,n){var s=this._validate(a,n,this.minDay,o.local.invalidMonth||o.regionalOptions[""].invalidMonth);return(s.month()+this.monthsInYear(s)-this.firstMonth)%this.monthsInYear(s)+this.minMonth},fromMonthOfYear:function(a,n){var s=(n+this.firstMonth-2*this.minMonth)%this.monthsInYear(a)+this.minMonth;return this._validate(a,s,this.minDay,o.local.invalidMonth||o.regionalOptions[""].invalidMonth),s},daysInYear:function(a){var n=this._validate(a,this.minMonth,this.minDay,o.local.invalidYear||o.regionalOptions[""].invalidYear);return this.leapYear(n)?366:365},dayOfYear:function(a,n,s){var r=this._validate(a,n,s,o.local.invalidDate||o.regionalOptions[""].invalidDate);return r.toJD()-this.newDate(r.year(),this.fromMonthOfYear(r.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(a,n,s){var r=this._validate(a,n,s,o.local.invalidDate||o.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(r))+2)%this.daysInWeek()},extraInfo:function(a,n,s){return this._validate(a,n,s,o.local.invalidDate||o.regionalOptions[""].invalidDate),{}},add:function(a,n,s){return this._validate(a,this.minMonth,this.minDay,o.local.invalidDate||o.regionalOptions[""].invalidDate),this._correctAdd(a,this._add(a,n,s),n,s)},_add:function(a,n,s){if(this._validateLevel++,s==="d"||s==="w"){var r=a.toJD()+n*(s==="w"?this.daysInWeek():1),c=a.calendar().fromJD(r);return this._validateLevel--,[c.year(),c.month(),c.day()]}try{var f=a.year()+(s==="y"?n:0),d=a.monthOfYear()+(s==="m"?n:0);c=a.day(),s==="y"?(a.month()!==this.fromMonthOfYear(f,d)&&(d=this.newDate(f,a.month(),this.minDay).monthOfYear()),d=Math.min(d,this.monthsInYear(f)),c=Math.min(c,this.daysInMonth(f,this.fromMonthOfYear(f,d)))):s==="m"&&(function(m){for(;d<m.minMonth;)f--,d+=m.monthsInYear(f);for(var y=m.monthsInYear(f);d>y-1+m.minMonth;)f++,d-=y,y=m.monthsInYear(f)}(this),c=Math.min(c,this.daysInMonth(f,this.fromMonthOfYear(f,d))));var g=[f,this.fromMonthOfYear(f,d),c];return this._validateLevel--,g}catch(m){throw this._validateLevel--,m}},_correctAdd:function(a,n,s,r){if(!(this.hasYearZero||r!=="y"&&r!=="m"||n[0]!==0&&a.year()>0==n[0]>0)){var c={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[r],f=s<0?-1:1;n=this._add(a,s*c[0]+f*c[1],c[2])}return a.date(n[0],n[1],n[2])},set:function(a,n,s){this._validate(a,this.minMonth,this.minDay,o.local.invalidDate||o.regionalOptions[""].invalidDate);var r=s==="y"?n:a.year(),c=s==="m"?n:a.month(),f=s==="d"?n:a.day();return s!=="y"&&s!=="m"||(f=Math.min(f,this.daysInMonth(r,c))),a.date(r,c,f)},isValid:function(a,n,s){this._validateLevel++;var r=this.hasYearZero||a!==0;if(r){var c=this.newDate(a,n,this.minDay);r=n>=this.minMonth&&n-this.minMonth<this.monthsInYear(c)&&s>=this.minDay&&s-this.minDay<this.daysInMonth(c)}return this._validateLevel--,r},toJSDate:function(a,n,s){var r=this._validate(a,n,s,o.local.invalidDate||o.regionalOptions[""].invalidDate);return o.instance().fromJD(this.toJD(r)).toJSDate()},fromJSDate:function(a){return this.fromJD(o.instance().fromJSDate(a).toJD())},_validate:function(a,n,s,r){if(a.year){if(this._validateLevel===0&&this.name!==a.calendar().name)throw(o.local.differentCalendars||o.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,a.calendar().local.name);return a}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(a,n,s))throw r.replace(/\{0\}/,this.local.name);var c=this.newDate(a,n,s);return this._validateLevel--,c}catch(f){throw this._validateLevel--,f}}}),l.prototype=new e,t(l.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var n=this._validate(a,this.minMonth,this.minDay,o.local.invalidYear||o.regionalOptions[""].invalidYear);return(a=n.year()+(n.year()<0?1:0))%4==0&&(a%100!=0||a%400==0)},weekOfYear:function(a,n,s){var r=this.newDate(a,n,s);return r.add(4-(r.dayOfWeek()||7),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(a,n){var s=this._validate(a,n,this.minDay,o.local.invalidMonth||o.regionalOptions[""].invalidMonth);return this.daysPerMonth[s.month()-1]+(s.month()===2&&this.leapYear(s.year())?1:0)},weekDay:function(a,n,s){return(this.dayOfWeek(a,n,s)||7)<6},toJD:function(a,n,s){var r=this._validate(a,n,s,o.local.invalidDate||o.regionalOptions[""].invalidDate);a=r.year(),n=r.month(),s=r.day(),a<0&&a++,n<3&&(n+=12,a--);var c=Math.floor(a/100),f=2-c+Math.floor(c/4);return Math.floor(365.25*(a+4716))+Math.floor(30.6001*(n+1))+s+f-1524.5},fromJD:function(a){var n=Math.floor(a+.5),s=Math.floor((n-186721625e-2)/36524.25),r=(s=n+1+s-Math.floor(s/4))+1524,c=Math.floor((r-122.1)/365.25),f=Math.floor(365.25*c),d=Math.floor((r-f)/30.6001),g=r-f-Math.floor(30.6001*d),m=d-(d>13.5?13:1),y=c-(m>2.5?4716:4715);return y<=0&&y--,this.newDate(y,m,g)},toJSDate:function(a,n,s){var r=this._validate(a,n,s,o.local.invalidDate||o.regionalOptions[""].invalidDate),c=new Date(r.year(),r.month()-1,r.day());return c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0),c.setHours(c.getHours()>12?c.getHours()+2:0),c},fromJSDate:function(a){return this.newDate(a.getFullYear(),a.getMonth()+1,a.getDate())}});var o=B.exports=new h;o.cdate=p,o.baseCalendar=e,o.calendars.gregorian=l},{"object-assign":487}],645:[function(i,B,V){var t=i("object-assign"),h=i("./main");t(h.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),h.local=h.regionalOptions[""],t(h.cdate.prototype,{formatDate:function(p,u){return typeof p!="string"&&(u=p,p=""),this._calendar.formatDate(p||"",this,u)}}),t(h.baseCalendar.prototype,{UNIX_EPOCH:h.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:h.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(p,u,e){if(typeof p!="string"&&(e=u,u=p,p=""),!u)return"";if(u.calendar()!==this)throw h.local.invalidFormat||h.regionalOptions[""].invalidFormat;p=p||this.local.dateFormat;for(var l,o,a,n,s=(e=e||{}).dayNamesShort||this.local.dayNamesShort,r=e.dayNames||this.local.dayNames,c=e.monthNumbers||this.local.monthNumbers,f=e.monthNamesShort||this.local.monthNamesShort,d=e.monthNames||this.local.monthNames,g=(e.calculateWeek||this.local.calculateWeek,function(L,w){for(var C=1;b+C<p.length&&p.charAt(b+C)===L;)C++;return b+=C-1,Math.floor(C/(w||1))>1}),m=function(L,w,C,S){var P=""+w;if(g(L,S))for(;P.length<C;)P="0"+P;return P},y=this,v=function(L){return typeof c=="function"?c.call(y,L,g("m")):k(m("m",L.month(),2))},T=function(L,w){return w?typeof d=="function"?d.call(y,L):d[L.month()-y.minMonth]:typeof f=="function"?f.call(y,L):f[L.month()-y.minMonth]},_=this.local.digits,k=function(L){return e.localNumbers&&_?_(L):L},E="",A=!1,b=0;b<p.length;b++)if(A)p.charAt(b)!=="'"||g("'")?E+=p.charAt(b):A=!1;else switch(p.charAt(b)){case"d":E+=k(m("d",u.day(),2));break;case"D":E+=(l="D",o=u.dayOfWeek(),a=s,n=r,g(l)?n[o]:a[o]);break;case"o":E+=m("o",u.dayOfYear(),3);break;case"w":E+=m("w",u.weekOfYear(),2);break;case"m":E+=v(u);break;case"M":E+=T(u,g("M"));break;case"y":E+=g("y",2)?u.year():(u.year()%100<10?"0":"")+u.year()%100;break;case"Y":g("Y",2),E+=u.formatYear();break;case"J":E+=u.toJD();break;case"@":E+=(u.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":E+=(u.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":g("'")?E+="'":A=!0;break;default:E+=p.charAt(b)}return E},parseDate:function(p,u,e){if(u==null)throw h.local.invalidArguments||h.regionalOptions[""].invalidArguments;if((u=typeof u=="object"?u.toString():u+"")==="")return null;p=p||this.local.dateFormat;var l=(e=e||{}).shortYearCutoff||this.shortYearCutoff;l=typeof l!="string"?l:this.today().year()%100+parseInt(l,10);for(var o=e.dayNamesShort||this.local.dayNamesShort,a=e.dayNames||this.local.dayNames,n=e.parseMonth||this.local.parseMonth,s=e.monthNumbers||this.local.monthNumbers,r=e.monthNamesShort||this.local.monthNamesShort,c=e.monthNames||this.local.monthNames,f=-1,d=-1,g=-1,m=-1,y=-1,v=!1,T=!1,_=function(F,q){for(var W=1;S+W<p.length&&p.charAt(S+W)===F;)W++;return S+=W-1,Math.floor(W/(q||1))>1},k=function(F,q){var W=_(F,q),X=[2,3,W?4:2,W?4:2,10,11,20]["oyYJ@!".indexOf(F)+1],Q=new RegExp("^-?\\d{1,"+X+"}"),Z=u.substring(C).match(Q);if(!Z)throw(h.local.missingNumberAt||h.regionalOptions[""].missingNumberAt).replace(/\{0\}/,C);return C+=Z[0].length,parseInt(Z[0],10)},E=this,A=function(){if(typeof s=="function"){_("m");var F=s.call(E,u.substring(C));return C+=F.length,F}return k("m")},b=function(F,q,W,X){for(var Q=_(F,X)?W:q,Z=0;Z<Q.length;Z++)if(u.substr(C,Q[Z].length).toLowerCase()===Q[Z].toLowerCase())return C+=Q[Z].length,Z+E.minMonth;throw(h.local.unknownNameAt||h.regionalOptions[""].unknownNameAt).replace(/\{0\}/,C)},L=function(){if(typeof c=="function"){var F=_("M")?c.call(E,u.substring(C)):r.call(E,u.substring(C));return C+=F.length,F}return b("M",r,c)},w=function(){if(u.charAt(C)!==p.charAt(S))throw(h.local.unexpectedLiteralAt||h.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,C);C++},C=0,S=0;S<p.length;S++)if(T)p.charAt(S)!=="'"||_("'")?w():T=!1;else switch(p.charAt(S)){case"d":m=k("d");break;case"D":b("D",o,a);break;case"o":y=k("o");break;case"w":k("w");break;case"m":g=A();break;case"M":g=L();break;case"y":var P=S;v=!_("y",2),S=P,d=k("y",2);break;case"Y":d=k("Y",2);break;case"J":f=k("J")+.5,u.charAt(C)==="."&&(C++,k("J"));break;case"@":f=k("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":f=k("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":C=u.length;break;case"'":_("'")?w():T=!0;break;default:w()}if(C<u.length)throw h.local.unexpectedText||h.regionalOptions[""].unexpectedText;if(d===-1?d=this.today().year():d<100&&v&&(d+=l===-1?1900:this.today().year()-this.today().year()%100-(d<=l?0:100)),typeof g=="string"&&(g=n.call(this,d,g)),y>-1){g=1,m=y;for(var z=this.daysInMonth(d,g);m>z;z=this.daysInMonth(d,g))g++,m-=z}return f>-1?this.fromJD(f):this.newDate(d,g,m)},determineDate:function(p,u,e,l,o){e&&typeof e!="object"&&(o=l,l=e,e=null),typeof l!="string"&&(o=l,l="");var a=this;return u=u?u.newDate():null,p=p==null?u:typeof p=="string"?function(n){try{return a.parseDate(l,n,o)}catch{}for(var s=((n=n.toLowerCase()).match(/^c/)&&e?e.newDate():null)||a.today(),r=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,c=r.exec(n);c;)s.add(parseInt(c[1],10),c[2]||"d"),c=r.exec(n);return s}(p):typeof p=="number"?isNaN(p)||p===1/0||p===-1/0?u:a.today().add(p,"d"):a.newDate(p)}})},{"./main":644,"object-assign":487}],646:[function(i,B,V){B.exports=i("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:`{
        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_
        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_
        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {
          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))
        }
      }`,args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":157}],647:[function(i,B,V){B.exports=function(h,p){var u=[];return p=+p||0,t(h.hi(h.shape[0]-1),u,p),u};var t=i("./lib/zc-core")},{"./lib/zc-core":646}],648:[function(i,B,V){B.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],649:[function(i,B,V){var t=i("./arrow_paths"),h=i("../../plots/font_attributes"),p=i("../../plots/cartesian/constants"),u=i("../../plot_api/plot_template").templatedArray;i("../../constants/axis_placeable_objects"),B.exports=u("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:h({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:t.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:t.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",p.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",p.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",p.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",p.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:h({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":772,"../../plot_api/plot_template":843,"../../plots/cartesian/constants":861,"../../plots/font_attributes":883,"./arrow_paths":648}],650:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes"),p=i("./draw").draw;function u(l){var o=l._fullLayout;t.filterVisible(o.annotations).forEach(function(a){var n=h.getFromId(l,a.xref),s=h.getFromId(l,a.yref),r=h.getRefType(a.xref),c=h.getRefType(a.yref);a._extremes={},r==="range"&&e(a,n),c==="range"&&e(a,s)})}function e(l,o){var a,n=o._id,s=n.charAt(0),r=l[s],c=l["a"+s],f=l[s+"ref"],d=l["a"+s+"ref"],g=l["_"+s+"padplus"],m=l["_"+s+"padminus"],y={x:1,y:-1}[s]*l[s+"shift"],v=3*l.arrowsize*l.arrowwidth||0,T=v+y,_=v-y,k=3*l.startarrowsize*l.arrowwidth||0,E=k+y,A=k-y;if(d===f){var b=h.findExtremes(o,[o.r2c(r)],{ppadplus:T,ppadminus:_}),L=h.findExtremes(o,[o.r2c(c)],{ppadplus:Math.max(g,E),ppadminus:Math.max(m,A)});a={min:[b.min[0],L.min[0]],max:[b.max[0],L.max[0]]}}else E=c?E+c:E,A=c?A-c:A,a=h.findExtremes(o,[o.r2c(r)],{ppadplus:Math.max(g,T,E),ppadminus:Math.max(m,_,A)});l._extremes[n]=a}B.exports=function(l){var o=l._fullLayout;if(t.filterVisible(o.annotations).length&&l._fullData.length)return t.syncOrAsync([p,u],l)}},{"../../lib":803,"../../plots/cartesian/axes":854,"./draw":655}],651:[function(i,B,V){var t=i("../../lib"),h=i("../../registry"),p=i("../../plot_api/plot_template").arrayEditor;function u(l,o){var a,n,s,r,c,f,d,g=l._fullLayout.annotations,m=[],y=[],v=[],T=(o||[]).length;for(a=0;a<g.length;a++)if(r=(s=g[a]).clicktoshow){for(n=0;n<T;n++)if(f=(c=o[n]).xaxis,d=c.yaxis,f._id===s.xref&&d._id===s.yref&&f.d2r(c.x)===e(s._xclick,f)&&d.d2r(c.y)===e(s._yclick,d)){(s.visible?r==="onout"?y:v:m).push(a);break}n===T&&s.visible&&r==="onout"&&y.push(a)}return{on:m,off:y,explicitOff:v}}function e(l,o){return o.type==="log"?o.l2r(l):o.d2r(l)}B.exports={hasClickToShow:function(l,o){var a=u(l,o);return a.on.length>0||a.explicitOff.length>0},onClick:function(l,o){var a,n,s=u(l,o),r=s.on,c=s.off.concat(s.explicitOff),f={},d=l._fullLayout.annotations;if(!(!r.length&&!c.length)){for(a=0;a<r.length;a++)(n=p(l.layout,"annotations",d[r[a]])).modifyItem("visible",!0),t.extendFlat(f,n.getUpdateObj());for(a=0;a<c.length;a++)(n=p(l.layout,"annotations",d[c[a]])).modifyItem("visible",!1),t.extendFlat(f,n.getUpdateObj());return h.call("update",l,{},f)}}}},{"../../lib":803,"../../plot_api/plot_template":843,"../../registry":931}],652:[function(i,B,V){var t=i("../../lib"),h=i("../color");B.exports=function(p,u,e,l){l("opacity");var o=l("bgcolor"),a=l("bordercolor"),n=h.opacity(a);l("borderpad");var s=l("borderwidth"),r=l("showarrow");if(l("text",r?" ":e._dfltTitle.annotation),l("textangle"),t.coerceFont(l,"font",e.font),l("width"),l("align"),l("height")&&l("valign"),r){var c,f,d=l("arrowside");d.indexOf("end")!==-1&&(c=l("arrowhead"),f=l("arrowsize")),d.indexOf("start")!==-1&&(l("startarrowhead",c),l("startarrowsize",f)),l("arrowcolor",n?u.bordercolor:h.defaultLine),l("arrowwidth",2*(n&&s||1)),l("standoff"),l("startstandoff")}var g=l("hovertext"),m=e.hoverlabel||{};if(g){var y=l("hoverlabel.bgcolor",m.bgcolor||(h.opacity(o)?h.rgb(o):h.defaultLine)),v=l("hoverlabel.bordercolor",m.bordercolor||h.contrast(y));t.coerceFont(l,"hoverlabel.font",{family:m.font.family,size:m.font.size,color:m.font.color||v})}l("captureevents",!!g)}},{"../../lib":803,"../color":666}],653:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib/to_log_range");B.exports=function(p,u,e,l){u=u||{};var o=e==="log"&&u.type==="linear",a=e==="linear"&&u.type==="log";if(o||a)for(var n,s,r=p._fullLayout.annotations,c=u._id.charAt(0),f=0;f<r.length;f++)n=r[f],s="annotations["+f+"].",n[c+"ref"]===u._id&&d(c),n["a"+c+"ref"]===u._id&&d("a"+c);function d(g){var m=n[g],y=null;y=o?h(m,u.range):Math.pow(10,m),t(y)||(y=null),l(s+g,y)}}},{"../../lib/to_log_range":831,"fast-isnumeric":249}],654:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes"),p=i("../../plots/array_container_defaults"),u=i("./common_defaults"),e=i("./attributes");function l(o,a,n){function s(L,w){return t.coerce(o,a,e,L,w)}var r=s("visible"),c=s("clicktoshow");if(r||c){u(o,a,n,s);for(var f=a.showarrow,d=["x","y"],g=[-10,-30],m={_fullLayout:n},y=0;y<2;y++){var v=d[y],T=h.coerceRef(o,a,m,v,"","paper");if(T!=="paper"&&h.getFromId(m,T)._annIndices.push(a._index),h.coercePosition(a,m,s,T,v,.5),f){var _="a"+v,k=h.coerceRef(o,a,m,_,"pixel",["pixel","paper"]);k!=="pixel"&&k!==T&&(k=a[_]="pixel");var E=k==="pixel"?g[y]:.4;h.coercePosition(a,m,s,k,_,E)}s(v+"anchor"),s(v+"shift")}if(t.noneOrAll(o,a,["x","y"]),f&&t.noneOrAll(o,a,["ax","ay"]),c){var A=s("xclick"),b=s("yclick");a._xclick=A===void 0?a.x:h.cleanPosition(A,m,a.xref),a._yclick=b===void 0?a.y:h.cleanPosition(b,m,a.yref)}}}B.exports=function(o,a){p(o,a,{name:"annotations",handleItemDefaults:l})}},{"../../lib":803,"../../plots/array_container_defaults":849,"../../plots/cartesian/axes":854,"./attributes":649,"./common_defaults":652}],655:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../registry"),p=i("../../plots/plots"),u=i("../../lib"),e=u.strTranslate,l=i("../../plots/cartesian/axes"),o=i("../color"),a=i("../drawing"),n=i("../fx"),s=i("../../lib/svg_text_utils"),r=i("../../lib/setcursor"),c=i("../dragelement"),f=i("../../plot_api/plot_template").arrayEditor,d=i("./draw_arrow_head");function g(v,T){var _=v._fullLayout.annotations[T]||{},k=l.getFromId(v,_.xref),E=l.getFromId(v,_.yref);k&&k.setScale(),E&&E.setScale(),y(v,_,T,!1,k,E)}function m(v,T,_,k,E){var A=E[_],b=E[_+"ref"],L=_.indexOf("y")!==-1,w=l.getRefType(b)==="domain",C=L?k.h:k.w;return v?w?A+(L?-T:T)/v._length:v.p2r(v.r2p(A)+T):A+(L?-T:T)/C}function y(v,T,_,k,E,A){var b,L,w=v._fullLayout,C=v._fullLayout._size,S=v._context.edits;k?(b="annotation-"+k,L=k+".annotations"):(b="annotation",L="annotations");var P=f(v.layout,L,T),z=P.modifyBase,F=P.modifyItem,q=P.getUpdateObj;w._infolayer.selectAll("."+b+'[data-index="'+_+'"]').remove();var W="clip"+w._uid+"_ann"+_;if(T._input&&T.visible!==!1){var X={x:{},y:{}},Q=+T.textangle||0,Z=w._infolayer.append("g").classed(b,!0).attr("data-index",String(_)).style("opacity",T.opacity),Y=Z.append("g").classed("annotation-text-g",!0),N=S[T.showarrow?"annotationTail":"annotationPosition"],J=T.captureevents||S.annotationText||N,D=Y.append("g").style("pointer-events",J?"all":null).call(r,"pointer").on("click",function(){v._dragging=!1,v.emit("plotly_clickannotation",se(t.event))});T.hovertext&&D.on("mouseover",function(){var ve=T.hoverlabel,Ee=ve.font,Le=this.getBoundingClientRect(),Te=v.getBoundingClientRect();n.loneHover({x0:Le.left-Te.left,x1:Le.right-Te.left,y:(Le.top+Le.bottom)/2-Te.top,text:T.hovertext,color:ve.bgcolor,borderColor:ve.bordercolor,fontFamily:Ee.family,fontSize:Ee.size,fontColor:Ee.color},{container:w._hoverlayer.node(),outerContainer:w._paper.node(),gd:v})}).on("mouseout",function(){n.loneUnhover(w._hoverlayer.node())});var U=T.borderwidth,G=T.borderpad,$=U+G,K=D.append("rect").attr("class","bg").style("stroke-width",U+"px").call(o.stroke,T.bordercolor).call(o.fill,T.bgcolor),re=T.width||T.height,ne=w._topclips.selectAll("#"+W).data(re?[0]:[]);ne.enter().append("clipPath").classed("annclip",!0).attr("id",W).append("rect"),ne.exit().remove();var ae=T.font,ie=w._meta?u.templateString(T.text,w._meta):T.text,he=D.append("text").classed("annotation-text",!0).text(ie);S.annotationText?he.call(s.makeEditable,{delegate:D,gd:v}).call(de).on("edit",function(ve){T.text=ve,this.call(de),F("text",ve),E&&E.autorange&&z(E._name+".autorange",!0),A&&A.autorange&&z(A._name+".autorange",!0),h.call("_guiRelayout",v,q())}):he.call(de)}else t.selectAll("#"+W).remove();function se(ve){var Ee={index:_,annotation:T._input,fullAnnotation:T,event:ve};return k&&(Ee.subplotId=k),Ee}function de(ve){return ve.call(a.font,ae).attr({"text-anchor":{left:"start",right:"end"}[T.align]||"middle"}),s.convertToTspans(ve,v,ce),ve}function ce(){var ve=he.selectAll("a");ve.size()===1&&ve.text()===he.text()&&D.insert("a",":first-child").attr({"xlink:xlink:href":ve.attr("xlink:href"),"xlink:xlink:show":ve.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(K.node());var Ee=D.select(".annotation-text-math-group"),Le=!Ee.empty(),Te=a.bBox((Le?Ee:he).node()),xe=Te.width,fe=Te.height,ge=T.width||xe,ke=T.height||fe,Me=Math.round(ge+2*$),Se=Math.round(ke+2*$);function De(st,It){return It==="auto"&&(It=st<1/3?"left":st>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[It]}for(var Be=!1,We=["x","y"],Qe=0;Qe<We.length;Qe++){var Oe,Ue,Xe,Ye,$e,it=We[Qe],ot=T[it+"ref"]||it,Et=T["a"+it+"ref"],mt={x:E,y:A}[it],tt=(Q+(it==="x"?0:-90))*Math.PI/180,Ke=Me*Math.cos(tt),Mt=Se*Math.sin(tt),Jt=Math.abs(Ke)+Math.abs(Mt),$t=T[it+"anchor"],je=T[it+"shift"]*(it==="x"?1:-1),Ge=X[it],Ct=l.getRefType(ot);if(mt&&Ct!=="domain"){var Ie=mt.r2fraction(T[it]);(Ie<0||Ie>1)&&(Et===ot?((Ie=mt.r2fraction(T["a"+it]))<0||Ie>1)&&(Be=!0):Be=!0),Oe=mt._offset+mt.r2p(T[it]),Ye=.5}else{var be=Ct==="domain";it==="x"?(Xe=T[it],Oe=be?mt._offset+mt._length*Xe:Oe=C.l+C.w*Xe):(Xe=1-T[it],Oe=be?mt._offset+mt._length*Xe:Oe=C.t+C.h*Xe),Ye=T.showarrow?.5:Xe}if(T.showarrow){Ge.head=Oe;var Ae=T["a"+it];if($e=Ke*De(.5,T.xanchor)-Mt*De(.5,T.yanchor),Et===ot){var Pe=l.getRefType(Et);Pe==="domain"?(it==="y"&&(Ae=1-Ae),Ge.tail=mt._offset+mt._length*Ae):Pe==="paper"?it==="y"?(Ae=1-Ae,Ge.tail=C.t+C.h*Ae):Ge.tail=C.l+C.w*Ae:Ge.tail=mt._offset+mt.r2p(Ae),Ue=$e}else Ge.tail=Oe+Ae,Ue=$e+Ae;Ge.text=Ge.tail+$e;var ze=w[it==="x"?"width":"height"];if(ot==="paper"&&(Ge.head=u.constrain(Ge.head,1,ze-1)),Et==="pixel"){var qe=-Math.max(Ge.tail-3,Ge.text),ht=Math.min(Ge.tail+3,Ge.text)-ze;qe>0?(Ge.tail+=qe,Ge.text+=qe):ht>0&&(Ge.tail-=ht,Ge.text-=ht)}Ge.tail+=je,Ge.head+=je}else Ue=$e=Jt*De(Ye,$t),Ge.text=Oe+$e;Ge.text+=je,$e+=je,Ue+=je,T["_"+it+"padplus"]=Jt/2+Ue,T["_"+it+"padminus"]=Jt/2-Ue,T["_"+it+"size"]=Jt,T["_"+it+"shift"]=$e}if(Be)D.remove();else{var at=0,nt=0;if(T.align!=="left"&&(at=(ge-xe)*(T.align==="center"?.5:1)),T.valign!=="top"&&(nt=(ke-fe)*(T.valign==="middle"?.5:1)),Le)Ee.select("svg").attr({x:$+at-1,y:$+nt}).call(a.setClipUrl,re?W:null,v);else{var xt=$+nt-Te.top,Lt=$+at-Te.left;he.call(s.positionText,Lt,xt).call(a.setClipUrl,re?W:null,v)}ne.select("rect").call(a.setRect,$,$,ge,ke),K.call(a.setRect,U/2,U/2,Me-U,Se-U),D.call(a.setTranslate,Math.round(X.x.text-Me/2),Math.round(X.y.text-Se/2)),Y.attr({transform:"rotate("+Q+","+X.x.text+","+X.y.text+")"});var bt,St=function(st,It){Z.selectAll(".annotation-arrow-g").remove();var jt=X.x.head,Ut=X.y.head,zt=X.x.tail+st,Ce=X.y.tail+It,lt=X.x.text+st,At=X.y.text+It,Bt=u.rotationXYMatrix(Q,lt,At),Ht=u.apply2DTransform(Bt),or=u.apply2DTransform2(Bt),ar=+K.attr("width"),Nt=+K.attr("height"),nr=lt-.5*ar,Lr=nr+ar,dr=At-.5*Nt,Kt=dr+Nt,yr=[[nr,dr,nr,Kt],[nr,Kt,Lr,Kt],[Lr,Kt,Lr,dr],[Lr,dr,nr,dr]].map(or);if(!yr.reduce(function(br,Xr){return br^!!u.segmentsIntersect(jt,Ut,jt+1e6,Ut+1e6,Xr[0],Xr[1],Xr[2],Xr[3])},!1)){yr.forEach(function(br){var Xr=u.segmentsIntersect(zt,Ce,jt,Ut,br[0],br[1],br[2],br[3]);Xr&&(zt=Xr.x,Ce=Xr.y)});var xr=T.arrowwidth,gr=T.arrowcolor,wr=T.arrowside,zr=Z.append("g").style({opacity:o.opacity(gr)}).classed("annotation-arrow-g",!0),Rr=zr.append("path").attr("d","M"+zt+","+Ce+"L"+jt+","+Ut).style("stroke-width",xr+"px").call(o.stroke,o.rgb(gr));if(d(Rr,wr,T),S.annotationPosition&&Rr.node().parentNode&&!k){var Wr=jt,gn=Ut;if(T.standoff){var rn=Math.sqrt(Math.pow(jt-zt,2)+Math.pow(Ut-Ce,2));Wr+=T.standoff*(zt-jt)/rn,gn+=T.standoff*(Ce-Ut)/rn}var Zr,bn,Dr=zr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(zt-Wr)+","+(Ce-gn),transform:e(Wr,gn)}).style("stroke-width",xr+6+"px").call(o.stroke,"rgba(0,0,0,0)").call(o.fill,"rgba(0,0,0,0)");c.init({element:Dr.node(),gd:v,prepFn:function(){var br=a.getTranslate(D);Zr=br.x,bn=br.y,E&&E.autorange&&z(E._name+".autorange",!0),A&&A.autorange&&z(A._name+".autorange",!0)},moveFn:function(br,Xr){var fn=Ht(Zr,bn),Qr=fn[0]+br,un=fn[1]+Xr;D.call(a.setTranslate,Qr,un),F("x",m(E,br,"x",C,T)),F("y",m(A,Xr,"y",C,T)),T.axref===T.xref&&F("ax",m(E,br,"ax",C,T)),T.ayref===T.yref&&F("ay",m(A,Xr,"ay",C,T)),zr.attr("transform",e(br,Xr)),Y.attr({transform:"rotate("+Q+","+Qr+","+un+")"})},doneFn:function(){h.call("_guiRelayout",v,q());var br=document.querySelector(".js-notes-box-panel");br&&br.redraw(br.selectedObj)}})}}};T.showarrow&&St(0,0),N&&c.init({element:D.node(),gd:v,prepFn:function(){bt=Y.attr("transform")},moveFn:function(st,It){var jt="pointer";if(T.showarrow)T.axref===T.xref?F("ax",m(E,st,"ax",C,T)):F("ax",T.ax+st),T.ayref===T.yref?F("ay",m(A,It,"ay",C.w,T)):F("ay",T.ay+It),St(st,It);else{if(k)return;var Ut,zt;if(E)Ut=m(E,st,"x",C,T);else{var Ce=T._xsize/C.w,lt=T.x+(T._xshift-T.xshift)/C.w-Ce/2;Ut=c.align(lt+st/C.w,Ce,0,1,T.xanchor)}if(A)zt=m(A,It,"y",C,T);else{var At=T._ysize/C.h,Bt=T.y-(T._yshift+T.yshift)/C.h-At/2;zt=c.align(Bt-It/C.h,At,0,1,T.yanchor)}F("x",Ut),F("y",zt),E&&A||(jt=c.getCursor(E?.5:Ut,A?.5:zt,T.xanchor,T.yanchor))}Y.attr({transform:e(st,It)+bt}),r(D,jt)},clickFn:function(st,It){T.captureevents&&v.emit("plotly_clickannotation",se(It))},doneFn:function(){r(D),h.call("_guiRelayout",v,q());var st=document.querySelector(".js-notes-box-panel");st&&st.redraw(st.selectedObj)}})}}}B.exports={draw:function(v){var T=v._fullLayout;T._infolayer.selectAll(".annotation").remove();for(var _=0;_<T.annotations.length;_++)T.annotations[_].visible&&g(v,_);return p.previousPromises(v)},drawOne:g,drawRaw:y}},{"../../lib":803,"../../lib/setcursor":824,"../../lib/svg_text_utils":829,"../../plot_api/plot_template":843,"../../plots/cartesian/axes":854,"../../plots/plots":917,"../../registry":931,"../color":666,"../dragelement":685,"../drawing":688,"../fx":706,"./draw_arrow_head":656,"@plotly/d3":58}],656:[function(i,B,V){var t=i("@plotly/d3"),h=i("../color"),p=i("./arrow_paths"),u=i("../../lib"),e=u.strScale,l=u.strRotate,o=u.strTranslate;B.exports=function(a,n,s){var r,c,f,d,g=a.node(),m=p[s.arrowhead||0],y=p[s.startarrowhead||0],v=(s.arrowwidth||1)*(s.arrowsize||1),T=(s.arrowwidth||1)*(s.startarrowsize||1),_=n.indexOf("start")>=0,k=n.indexOf("end")>=0,E=m.backoff*v+s.standoff,A=y.backoff*T+s.startstandoff;if(g.nodeName==="line"){r={x:+a.attr("x1"),y:+a.attr("y1")},c={x:+a.attr("x2"),y:+a.attr("y2")};var b=r.x-c.x,L=r.y-c.y;if(d=(f=Math.atan2(L,b))+Math.PI,E&&A&&E+A>Math.sqrt(b*b+L*L))return void Z();if(E){if(E*E>b*b+L*L)return void Z();var w=E*Math.cos(f),C=E*Math.sin(f);c.x+=w,c.y+=C,a.attr({x2:c.x,y2:c.y})}if(A){if(A*A>b*b+L*L)return void Z();var S=A*Math.cos(f),P=A*Math.sin(f);r.x-=S,r.y-=P,a.attr({x1:r.x,y1:r.y})}}else if(g.nodeName==="path"){var z=g.getTotalLength(),F="";if(z<E+A)return void Z();var q=g.getPointAtLength(0),W=g.getPointAtLength(.1);f=Math.atan2(q.y-W.y,q.x-W.x),r=g.getPointAtLength(Math.min(A,z)),F="0px,"+A+"px,";var X=g.getPointAtLength(z),Q=g.getPointAtLength(z-.1);d=Math.atan2(X.y-Q.y,X.x-Q.x),c=g.getPointAtLength(Math.max(0,z-E)),F+=z-(F?A+E:E)+"px,"+z+"px",a.style("stroke-dasharray",F)}function Z(){a.style("stroke-dasharray","0px,100px")}function Y(N,J,D,U){N.path&&(N.noRotate&&(D=0),t.select(g.parentNode).append("path").attr({class:a.attr("class"),d:N.path,transform:o(J.x,J.y)+l(180*D/Math.PI)+e(U)}).style({fill:h.rgb(s.arrowcolor),"stroke-width":0}))}_&&Y(y,r,f,T),k&&Y(m,c,d,v)}},{"../../lib":803,"../color":666,"./arrow_paths":648,"@plotly/d3":58}],657:[function(i,B,V){var t=i("./draw"),h=i("./click");B.exports={moduleType:"component",name:"annotations",layoutAttributes:i("./attributes"),supplyLayoutDefaults:i("./defaults"),includeBasePlot:i("../../plots/cartesian/include_components")("annotations"),calcAutorange:i("./calc_autorange"),draw:t.draw,drawOne:t.drawOne,drawRaw:t.drawRaw,hasClickToShow:h.hasClickToShow,onClick:h.onClick,convertCoords:i("./convert_coords")}},{"../../plots/cartesian/include_components":867,"./attributes":649,"./calc_autorange":650,"./click":651,"./convert_coords":653,"./defaults":654,"./draw":655}],658:[function(i,B,V){var t=i("../annotations/attributes"),h=i("../../plot_api/edit_types").overrideAll,p=i("../../plot_api/plot_template").templatedArray;B.exports=h(p("annotation",{visible:t.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:t.xanchor,xshift:t.xshift,yanchor:t.yanchor,yshift:t.yshift,text:t.text,textangle:t.textangle,font:t.font,width:t.width,height:t.height,opacity:t.opacity,align:t.align,valign:t.valign,bgcolor:t.bgcolor,bordercolor:t.bordercolor,borderpad:t.borderpad,borderwidth:t.borderwidth,showarrow:t.showarrow,arrowcolor:t.arrowcolor,arrowhead:t.arrowhead,startarrowhead:t.startarrowhead,arrowside:t.arrowside,arrowsize:t.arrowsize,startarrowsize:t.startarrowsize,arrowwidth:t.arrowwidth,standoff:t.standoff,startstandoff:t.startstandoff,hovertext:t.hovertext,hoverlabel:t.hoverlabel,captureevents:t.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":836,"../../plot_api/plot_template":843,"../annotations/attributes":649}],659:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes");function p(u,e){var l=e.fullSceneLayout.domain,o=e.fullLayout._size,a={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};u._xa={},t.extendFlat(u._xa,a),h.setConvert(u._xa),u._xa._offset=o.l+l.x[0]*o.w,u._xa.l2p=function(){return .5*(1+u._pdata[0]/u._pdata[3])*o.w*(l.x[1]-l.x[0])},u._ya={},t.extendFlat(u._ya,a),h.setConvert(u._ya),u._ya._offset=o.t+(1-l.y[1])*o.h,u._ya.l2p=function(){return .5*(1-u._pdata[1]/u._pdata[3])*o.h*(l.y[1]-l.y[0])}}B.exports=function(u){for(var e=u.fullSceneLayout.annotations,l=0;l<e.length;l++)p(e[l],u);u.fullLayout._infolayer.selectAll(".annotation-"+u.id).remove()}},{"../../lib":803,"../../plots/cartesian/axes":854}],660:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes"),p=i("../../plots/array_container_defaults"),u=i("../annotations/common_defaults"),e=i("./attributes");function l(o,a,n,s){function r(f,d){return t.coerce(o,a,e,f,d)}function c(f){var d=f+"axis",g={_fullLayout:{}};return g._fullLayout[d]=n[d],h.coercePosition(a,g,r,f,f,.5)}r("visible")&&(u(o,a,s.fullLayout,r),c("x"),c("y"),c("z"),t.noneOrAll(o,a,["x","y","z"]),a.xref="x",a.yref="y",a.zref="z",r("xanchor"),r("yanchor"),r("xshift"),r("yshift"),a.showarrow&&(a.axref="pixel",a.ayref="pixel",r("ax",-10),r("ay",-30),t.noneOrAll(o,a,["ax","ay"])))}B.exports=function(o,a,n){p(o,a,{name:"annotations",handleItemDefaults:l,fullLayout:n.fullLayout})}},{"../../lib":803,"../../plots/array_container_defaults":849,"../../plots/cartesian/axes":854,"../annotations/common_defaults":652,"./attributes":658}],661:[function(i,B,V){var t=i("../annotations/draw").drawRaw,h=i("../../plots/gl3d/project"),p=["x","y","z"];B.exports=function(u){for(var e=u.fullSceneLayout,l=u.dataScale,o=e.annotations,a=0;a<o.length;a++){for(var n=o[a],s=!1,r=0;r<3;r++){var c=p[r],f=n[c],d=e[c+"axis"].r2fraction(f);if(d<0||d>1){s=!0;break}}s?u.fullLayout._infolayer.select(".annotation-"+u.id+'[data-index="'+a+'"]').remove():(n._pdata=h(u.glplot.cameraParams,[e.xaxis.r2l(n.x)*l[0],e.yaxis.r2l(n.y)*l[1],e.zaxis.r2l(n.z)*l[2]]),t(u.graphDiv,n,a,u.id,n._xa,n._ya))}}},{"../../plots/gl3d/project":905,"../annotations/draw":655}],662:[function(i,B,V){var t=i("../../registry"),h=i("../../lib");B.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:i("./attributes")}}},layoutAttributes:i("./attributes"),handleDefaults:i("./defaults"),includeBasePlot:function(p,u){var e=t.subplotsRegistry.gl3d;if(e)for(var l=e.attrRegex,o=Object.keys(p),a=0;a<o.length;a++){var n=o[a];l.test(n)&&(p[n].annotations||[]).length&&(h.pushUnique(u._basePlotModules,e),h.pushUnique(u._subplots.gl3d,n))}},convert:i("./convert"),draw:i("./draw")}},{"../../lib":803,"../../registry":931,"./attributes":658,"./convert":659,"./defaults":660,"./draw":661}],663:[function(i,B,V){B.exports=i("world-calendars/dist/main"),i("world-calendars/dist/plus"),i("world-calendars/dist/calendars/chinese"),i("world-calendars/dist/calendars/coptic"),i("world-calendars/dist/calendars/discworld"),i("world-calendars/dist/calendars/ethiopian"),i("world-calendars/dist/calendars/hebrew"),i("world-calendars/dist/calendars/islamic"),i("world-calendars/dist/calendars/julian"),i("world-calendars/dist/calendars/mayan"),i("world-calendars/dist/calendars/nanakshahi"),i("world-calendars/dist/calendars/nepali"),i("world-calendars/dist/calendars/persian"),i("world-calendars/dist/calendars/taiwan"),i("world-calendars/dist/calendars/thai"),i("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":630,"world-calendars/dist/calendars/coptic":631,"world-calendars/dist/calendars/discworld":632,"world-calendars/dist/calendars/ethiopian":633,"world-calendars/dist/calendars/hebrew":634,"world-calendars/dist/calendars/islamic":635,"world-calendars/dist/calendars/julian":636,"world-calendars/dist/calendars/mayan":637,"world-calendars/dist/calendars/nanakshahi":638,"world-calendars/dist/calendars/nepali":639,"world-calendars/dist/calendars/persian":640,"world-calendars/dist/calendars/taiwan":641,"world-calendars/dist/calendars/thai":642,"world-calendars/dist/calendars/ummalqura":643,"world-calendars/dist/main":644,"world-calendars/dist/plus":645}],664:[function(i,B,V){var t=i("./calendars"),h=i("../../lib"),p=i("../../constants/numerical"),u=p.EPOCHJD,e=p.ONEDAY,l={valType:"enumerated",values:h.sortObjectKeys(t.calendars),editType:"calc",dflt:"gregorian"},o=function(y,v,T,_){var k={};return k[T]=l,h.coerce(y,v,k,T,_)},a={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},n={};function s(y){var v=n[y];return v||(v=n[y]=t.instance(y))}function r(y){return h.extendFlat({},l,{description:y})}function c(y){return"Sets the calendar system to use with `"+y+"` date data."}var f={xcalendar:r(c("x"))},d=h.extendFlat({},f,{ycalendar:r(c("y"))}),g=h.extendFlat({},d,{zcalendar:r(c("z"))}),m=r(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));B.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:d,bar:d,box:d,heatmap:d,contour:d,histogram:d,histogram2d:d,histogram2dcontour:d,scatter3d:g,surface:g,mesh3d:g,scattergl:d,ohlc:f,candlestick:f},layout:{calendar:r(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:m},yaxis:{calendar:m},scene:{xaxis:{calendar:m},yaxis:{calendar:m},zaxis:{calendar:m}},polar:{radialaxis:{calendar:m}}},transforms:{filter:{valuecalendar:r(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:r(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:l,handleDefaults:o,handleTraceDefaults:function(y,v,T,_){for(var k=0;k<T.length;k++)o(y,v,T[k]+"calendar",_.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:s,worldCalFmt:function(y,v,T){for(var _,k,E,A,b,L=Math.floor((v+.05)/e)+u,w=s(T).fromJD(L),C=0;(C=y.indexOf("%",C))!==-1;)(_=y.charAt(C+1))==="0"||_==="-"||_==="_"?(E=3,k=y.charAt(C+2),_==="_"&&(_="-")):(k=_,_="0",E=2),(A=a[k])?(b=A==="##"?"##":w.formatDate(A[_]),y=y.substr(0,C)+b+y.substr(C+E),C+=b.length):C+=E;return y}}},{"../../constants/numerical":779,"../../lib":803,"./calendars":663}],665:[function(i,B,V){V.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],V.defaultLine="#444",V.lightLine="#eee",V.background="#fff",V.borderLine="#BEC8D9",V.lightFraction=1e3/11},{}],666:[function(i,B,V){var t=i("tinycolor2"),h=i("fast-isnumeric"),p=i("../../lib/array").isTypedArray,u=B.exports={},e=i("./attributes");u.defaults=e.defaults;var l=u.defaultLine=e.defaultLine;u.lightLine=e.lightLine;var o=u.background=e.background;function a(n){if(h(n)||typeof n!="string")return n;var s=n.trim();if(s.substr(0,3)!=="rgb")return n;var r=s.match(/^rgba?\s*\(([^()]*)\)$/);if(!r)return n;var c=r[1].trim().split(/\s*[\s,]\s*/),f=s.charAt(3)==="a"&&c.length===4;if(!f&&c.length!==3)return n;for(var d=0;d<c.length;d++){if(!c[d].length||(c[d]=Number(c[d]),!(c[d]>=0)))return n;if(d===3)c[d]>1&&(c[d]=1);else if(c[d]>=1)return n}var g=Math.round(255*c[0])+", "+Math.round(255*c[1])+", "+Math.round(255*c[2]);return f?"rgba("+g+", "+c[3]+")":"rgb("+g+")"}u.tinyRGB=function(n){var s=n.toRgb();return"rgb("+Math.round(s.r)+", "+Math.round(s.g)+", "+Math.round(s.b)+")"},u.rgb=function(n){return u.tinyRGB(t(n))},u.opacity=function(n){return n?t(n).getAlpha():0},u.addOpacity=function(n,s){var r=t(n).toRgb();return"rgba("+Math.round(r.r)+", "+Math.round(r.g)+", "+Math.round(r.b)+", "+s+")"},u.combine=function(n,s){var r=t(n).toRgb();if(r.a===1)return t(n).toRgbString();var c=t(s||o).toRgb(),f=c.a===1?c:{r:255*(1-c.a)+c.r*c.a,g:255*(1-c.a)+c.g*c.a,b:255*(1-c.a)+c.b*c.a},d={r:f.r*(1-r.a)+r.r*r.a,g:f.g*(1-r.a)+r.g*r.a,b:f.b*(1-r.a)+r.b*r.a};return t(d).toRgbString()},u.contrast=function(n,s,r){var c=t(n);return c.getAlpha()!==1&&(c=t(u.combine(n,o))),(c.isDark()?s?c.lighten(s):o:r?c.darken(r):l).toString()},u.stroke=function(n,s){var r=t(s);n.style({stroke:u.tinyRGB(r),"stroke-opacity":r.getAlpha()})},u.fill=function(n,s){var r=t(s);n.style({fill:u.tinyRGB(r),"fill-opacity":r.getAlpha()})},u.clean=function(n){if(n&&typeof n=="object"){var s,r,c,f,d=Object.keys(n);for(s=0;s<d.length;s++)if(f=n[c=d[s]],c.substr(c.length-5)==="color")if(Array.isArray(f))for(r=0;r<f.length;r++)f[r]=a(f[r]);else n[c]=a(f);else if(c.substr(c.length-10)==="colorscale"&&Array.isArray(f))for(r=0;r<f.length;r++)Array.isArray(f[r])&&(f[r][1]=a(f[r][1]));else if(Array.isArray(f)){var g=f[0];if(!Array.isArray(g)&&g&&typeof g=="object")for(r=0;r<f.length;r++)u.clean(f[r])}else f&&typeof f=="object"&&!p(f)&&u.clean(f)}}},{"../../lib/array":785,"./attributes":665,"fast-isnumeric":249,tinycolor2:598}],667:[function(i,B,V){var t=i("../../plots/cartesian/layout_attributes"),h=i("../../plots/font_attributes"),p=i("../../lib/extend").extendFlat,u=i("../../plot_api/edit_types").overrideAll;B.exports=u({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:t.linecolor,outlinewidth:t.linewidth,bordercolor:t.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:p({},t.ticks,{dflt:""}),ticklabeloverflow:p({},t.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside bottom","inside bottom"],dflt:"outside"},ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,showticklabels:t.showticklabels,tickfont:h({}),tickangle:t.tickangle,tickformat:t.tickformat,tickformatstops:t.tickformatstops,tickprefix:t.tickprefix,showtickprefix:t.showtickprefix,ticksuffix:t.ticksuffix,showticksuffix:t.showticksuffix,separatethousands:t.separatethousands,exponentformat:t.exponentformat,minexponent:t.minexponent,showexponent:t.showexponent,title:{text:{valType:"string"},font:h({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:h({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plots/cartesian/layout_attributes":869,"../../plots/font_attributes":883}],668:[function(i,B,V){B.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],669:[function(i,B,V){var t=i("../../lib"),h=i("../../plot_api/plot_template"),p=i("../../plots/cartesian/tick_value_defaults"),u=i("../../plots/cartesian/tick_mark_defaults"),e=i("../../plots/cartesian/tick_label_defaults"),l=i("./attributes");B.exports=function(o,a,n){var s=h.newContainer(a,"colorbar"),r=o.colorbar||{};function c(_,k){return t.coerce(r,s,l,_,k)}var f=c("thicknessmode");c("thickness",f==="fraction"?30/(n.width-n.margin.l-n.margin.r):30);var d=c("lenmode");c("len",d==="fraction"?1:n.height-n.margin.t-n.margin.b),c("x"),c("xanchor"),c("xpad"),c("y"),c("yanchor"),c("ypad"),t.noneOrAll(r,s,["x","y"]),c("outlinecolor"),c("outlinewidth"),c("bordercolor"),c("borderwidth"),c("bgcolor");var g=c("ticklabelposition");c("ticklabeloverflow",g.indexOf("inside")!==-1?"hide past domain":"hide past div"),p(r,s,c,"linear");var m=n.font,y={outerTicks:!1,font:m};g.indexOf("inside")!==-1&&(y.bgColor="black"),e(r,s,c,"linear",y),u(r,s,c,"linear",y),c("title.text",n._dfltTitle.colorbar);var v=s.tickfont,T=t.extendFlat({},v,{color:m.color,size:t.bigFont(v.size)});t.coerceFont(c,"title.font",T),c("title.side")}},{"../../lib":803,"../../plot_api/plot_template":843,"../../plots/cartesian/tick_label_defaults":876,"../../plots/cartesian/tick_mark_defaults":877,"../../plots/cartesian/tick_value_defaults":878,"./attributes":667}],670:[function(i,B,V){var t=i("@plotly/d3"),h=i("tinycolor2"),p=i("../../plots/plots"),u=i("../../registry"),e=i("../../plots/cartesian/axes"),l=i("../dragelement"),o=i("../../lib"),a=o.strTranslate,n=i("../../lib/extend").extendFlat,s=i("../../lib/setcursor"),r=i("../drawing"),c=i("../color"),f=i("../titles"),d=i("../../lib/svg_text_utils"),g=i("../colorscale/helpers").flipScale,m=i("../../plots/cartesian/axis_defaults"),y=i("../../plots/cartesian/position_defaults"),v=i("../../plots/cartesian/layout_attributes"),T=i("../../constants/alignment"),_=T.LINE_SPACING,k=T.FROM_TL,E=T.FROM_BR,A=i("./constants").cn;B.exports={draw:function(b){var L=b._fullLayout._infolayer.selectAll("g."+A.colorbar).data(function(w){var C,S,P,z,F=w._fullLayout,q=w.calcdata,W=[];function X(re){return n(re,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function Q(){typeof z.calc=="function"?z.calc(w,P,C):(C._fillgradient=S.reversescale?g(S.colorscale):S.colorscale,C._zrange=[S[z.min],S[z.max]])}for(var Z=0;Z<q.length;Z++){var Y=q[Z],N=(P=Y[0].trace)._module.colorbar;if(P.visible===!0&&N)for(var J=Array.isArray(N),D=J?N:[N],U=0;U<D.length;U++){var G=(z=D[U]).container;(S=G?P[G]:P)&&S.showscale&&((C=X(S.colorbar))._id="cb"+P.uid+(J&&G?"-"+G:""),C._traceIndex=P.index,C._propPrefix=(G?G+".":"")+"colorbar.",C._meta=P._meta,Q(),W.push(C))}}for(var $ in F._colorAxes)if((S=F[$]).showscale){var K=F._colorAxes[$];(C=X(S.colorbar))._id="cb"+$,C._propPrefix=$+".colorbar.",C._meta=F._meta,z={min:"cmin",max:"cmax"},K[0]!=="heatmap"&&(P=K[1],z.calc=P._module.colorbar.calc),Q(),W.push(C)}return W}(b),function(w){return w._id});L.enter().append("g").attr("class",function(w){return w._id}).classed(A.colorbar,!0),L.each(function(w){var C=t.select(this);o.ensureSingle(C,"rect",A.cbbg),o.ensureSingle(C,"g",A.cbfills),o.ensureSingle(C,"g",A.cblines),o.ensureSingle(C,"g",A.cbaxis,function(P){P.classed(A.crisp,!0)}),o.ensureSingle(C,"g",A.cbtitleunshift,function(P){P.append("g").classed(A.cbtitle,!0)}),o.ensureSingle(C,"rect",A.cboutline);var S=function(P,z,F){var q=F._fullLayout,W=q._size,X=z._fillcolor,Q=z._line,Z=z.title,Y=Z.side,N=z._zrange||t.extent((typeof X=="function"?X:Q.color).domain()),J=typeof Q.color=="function"?Q.color:function(){return Q.color},D=typeof X=="function"?X:function(){return X},U=z._levels,G=function(Oe,Ue,Xe){var Ye,$e,it=Ue._levels,ot=[],Et=[],mt=it.end+it.size/100,tt=it.size,Ke=1.001*Xe[0]-.001*Xe[1],Mt=1.001*Xe[1]-.001*Xe[0];for($e=0;$e<1e5&&(Ye=it.start+$e*tt,!(tt>0?Ye>=mt:Ye<=mt));$e++)Ye>Ke&&Ye<Mt&&ot.push(Ye);if(Ue._fillgradient)Et=[0];else if(typeof Ue._fillcolor=="function"){var Jt=Ue._filllevels;if(Jt)for(mt=Jt.end+Jt.size/100,tt=Jt.size,$e=0;$e<1e5&&(Ye=Jt.start+$e*tt,!(tt>0?Ye>=mt:Ye<=mt));$e++)Ye>Xe[0]&&Ye<Xe[1]&&Et.push(Ye);else(Et=ot.map(function($t){return $t-it.size/2})).push(Et[Et.length-1]+it.size)}else Ue._fillcolor&&typeof Ue._fillcolor=="string"&&(Et=[0]);return it.size<0&&(ot.reverse(),Et.reverse()),{line:ot,fill:Et}}(0,z,N),$=G.fill,K=G.line,re=Math.round(z.thickness*(z.thicknessmode==="fraction"?W.w:1)),ne=re/W.w,ae=Math.round(z.len*(z.lenmode==="fraction"?W.h:1)),ie=ae/W.h,he=z.xpad/W.w,se=(z.borderwidth+z.outlinewidth)/2,de=z.ypad/W.h,ce=Math.round(z.x*W.w+z.xpad),ve=z.x-ne*({middle:.5,right:1}[z.xanchor]||0),Ee=z.y+ie*(({top:-.5,bottom:.5}[z.yanchor]||0)-.5),Le=Math.round(W.h*(1-Ee)),Te=Le-ae;z._lenFrac=ie,z._thickFrac=ne,z._xLeftFrac=ve,z._yBottomFrac=Ee;var xe=z._axis=function(Oe,Ue,Xe){var Ye=Oe._fullLayout,$e={type:"linear",range:Xe,tickmode:Ue.tickmode,nticks:Ue.nticks,tick0:Ue.tick0,dtick:Ue.dtick,tickvals:Ue.tickvals,ticktext:Ue.ticktext,ticks:Ue.ticks,ticklen:Ue.ticklen,tickwidth:Ue.tickwidth,tickcolor:Ue.tickcolor,showticklabels:Ue.showticklabels,ticklabelposition:Ue.ticklabelposition,ticklabeloverflow:Ue.ticklabeloverflow,tickfont:Ue.tickfont,tickangle:Ue.tickangle,tickformat:Ue.tickformat,exponentformat:Ue.exponentformat,minexponent:Ue.minexponent,separatethousands:Ue.separatethousands,showexponent:Ue.showexponent,showtickprefix:Ue.showtickprefix,tickprefix:Ue.tickprefix,showticksuffix:Ue.showticksuffix,ticksuffix:Ue.ticksuffix,title:Ue.title,showline:!0,anchor:"free",side:"right",position:1},it={type:"linear",_id:"y"+Ue._id},ot={letter:"y",font:Ye.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:Ye.calendar};function Et(mt,tt){return o.coerce($e,it,v,mt,tt)}return m($e,it,Et,ot,Ye),y($e,it,Et,ot),it}(F,z,N);if(xe.position=z.x+he+ne,["top","bottom"].indexOf(Y)!==-1&&(xe.title.side=Y,xe.titlex=z.x+he,xe.titley=Ee+(Z.side==="top"?ie-de:de)),Q.color&&z.tickmode==="auto"){xe.tickmode="linear",xe.tick0=U.start;var fe=U.size,ge=o.constrain((Le-Te)/50,4,15)+1,ke=(N[1]-N[0])/((z.nticks||ge)*fe);if(ke>1){var Me=Math.pow(10,Math.floor(Math.log(ke)/Math.LN10));fe*=Me*o.roundUp(ke/Me,[2,5,10]),(Math.abs(U.start)/U.size+1e-6)%1<2e-6&&(xe.tick0=0)}xe.dtick=fe}xe.domain=[Ee+de,Ee+ie-de],xe.setScale(),P.attr("transform",a(Math.round(W.l),Math.round(W.t)));var Se,De=P.select("."+A.cbtitleunshift).attr("transform",a(-Math.round(W.l),-Math.round(W.t))),Be=P.select("."+A.cbaxis),We=0;function Qe(Oe,Ue){var Xe={propContainer:xe,propName:z._propPrefix+"title",traceIndex:z._traceIndex,_meta:z._meta,placeholder:q._dfltTitle.colorbar,containerGroup:P.select("."+A.cbtitle)},Ye=Oe.charAt(0)==="h"?Oe.substr(1):"h"+Oe;P.selectAll("."+Ye+",."+Ye+"-math-group").remove(),f.draw(F,Oe,n(Xe,Ue||{}))}return o.syncOrAsync([p.previousPromises,function(){if(["top","bottom"].indexOf(Y)!==-1){var Oe,Ue=W.l+(z.x+he)*W.w,Xe=xe.title.font.size;Oe=Y==="top"?(1-(Ee+ie-de))*W.h+W.t+3+.75*Xe:(1-(Ee+de))*W.h+W.t-3-.25*Xe,Qe(xe._id+"title",{attributes:{x:Ue,y:Oe,"text-anchor":"start"}})}},function(){if(["top","bottom"].indexOf(Y)!==-1){var Oe=P.select("."+A.cbtitle),Ue=Oe.select("text"),Xe=[-z.outlinewidth/2,z.outlinewidth/2],Ye=Oe.select(".h"+xe._id+"title-math-group").node(),$e=15.6;if(Ue.node()&&($e=parseInt(Ue.node().style.fontSize,10)*_),Ye?(We=r.bBox(Ye).height)>$e&&(Xe[1]-=(We-$e)/2):Ue.node()&&!Ue.classed(A.jsPlaceholder)&&(We=r.bBox(Ue.node()).height),We){if(We+=5,Y==="top")xe.domain[1]-=We/W.h,Xe[1]*=-1;else{xe.domain[0]+=We/W.h;var it=d.lineCount(Ue);Xe[1]+=(1-it)*$e}Oe.attr("transform",a(Xe[0],Xe[1])),xe.setScale()}}P.selectAll("."+A.cbfills+",."+A.cblines).attr("transform",a(0,Math.round(W.h*(1-xe.domain[1])))),Be.attr("transform",a(0,Math.round(-W.t)));var ot=P.select("."+A.cbfills).selectAll("rect."+A.cbfill).attr("style","").data($);ot.enter().append("rect").classed(A.cbfill,!0).style("stroke","none"),ot.exit().remove();var Et=N.map(xe.c2p).map(Math.round).sort(function(Jt,$t){return Jt-$t});ot.each(function(Jt,$t){var je=[$t===0?N[0]:($[$t]+$[$t-1])/2,$t===$.length-1?N[1]:($[$t]+$[$t+1])/2].map(xe.c2p).map(Math.round);je[1]=o.constrain(je[1]+(je[1]>je[0])?1:-1,Et[0],Et[1]);var Ge=t.select(this).attr({x:ce,width:Math.max(re,2),y:t.min(je),height:Math.max(t.max(je)-t.min(je),2)});if(z._fillgradient)r.gradient(Ge,F,z._id,"vertical",z._fillgradient,"fill");else{var Ct=D(Jt).replace("e-","");Ge.attr("fill",h(Ct).toHexString())}});var mt=P.select("."+A.cblines).selectAll("path."+A.cbline).data(Q.color&&Q.width?K:[]);mt.enter().append("path").classed(A.cbline,!0),mt.exit().remove(),mt.each(function(Jt){t.select(this).attr("d","M"+ce+","+(Math.round(xe.c2p(Jt))+Q.width/2%1)+"h"+re).call(r.lineGroupStyle,Q.width,J(Jt),Q.dash)}),Be.selectAll("g."+xe._id+"tick,path").remove();var tt=ce+re+(z.outlinewidth||0)/2-(z.ticks==="outside"?1:0),Ke=e.calcTicks(xe),Mt=e.getTickSigns(xe)[2];return e.drawTicks(F,xe,{vals:xe.ticks==="inside"?e.clipEnds(xe,Ke):Ke,layer:Be,path:e.makeTickPath(xe,tt,Mt),transFn:e.makeTransTickFn(xe)}),e.drawLabels(F,xe,{vals:Ke,layer:Be,transFn:e.makeTransTickLabelFn(xe),labelFns:e.makeLabelFns(xe,tt)})},function(){if(["top","bottom"].indexOf(Y)===-1){var Oe=xe.title.font.size,Ue=xe._offset+xe._length/2,Xe=W.l+(xe.position||0)*W.w+(xe.side==="right"?10+Oe*(xe.showticklabels?1:.5):-10-Oe*(xe.showticklabels?.5:0));Qe("h"+xe._id+"title",{avoid:{selection:t.select(F).selectAll("g."+xe._id+"tick"),side:Y,offsetLeft:W.l,offsetTop:0,maxShift:q.width},attributes:{x:Xe,y:Ue,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}},p.previousPromises,function(){var Oe=re+z.outlinewidth/2;if(xe.ticklabelposition.indexOf("inside")===-1&&(Oe+=r.bBox(Be.node()).width),(Se=De.select("text")).node()&&!Se.classed(A.jsPlaceholder)){var Ue,Xe=De.select(".h"+xe._id+"title-math-group").node();Ue=Xe&&["top","bottom"].indexOf(Y)!==-1?r.bBox(Xe).width:r.bBox(De.node()).right-ce-W.l,Oe=Math.max(Oe,Ue)}var Ye=2*z.xpad+Oe+z.borderwidth+z.outlinewidth/2,$e=Le-Te;P.select("."+A.cbbg).attr({x:ce-z.xpad-(z.borderwidth+z.outlinewidth)/2,y:Te-se,width:Math.max(Ye,2),height:Math.max($e+2*se,2)}).call(c.fill,z.bgcolor).call(c.stroke,z.bordercolor).style("stroke-width",z.borderwidth),P.selectAll("."+A.cboutline).attr({x:ce,y:Te+z.ypad+(Y==="top"?We:0),width:Math.max(re,2),height:Math.max($e-2*z.ypad-We,2)}).call(c.stroke,z.outlinecolor).style({fill:"none","stroke-width":z.outlinewidth});var it=({center:.5,right:1}[z.xanchor]||0)*Ye;P.attr("transform",a(W.l-it,W.t));var ot={},Et=k[z.yanchor],mt=E[z.yanchor];z.lenmode==="pixels"?(ot.y=z.y,ot.t=$e*Et,ot.b=$e*mt):(ot.t=ot.b=0,ot.yt=z.y+z.len*Et,ot.yb=z.y-z.len*mt);var tt=k[z.xanchor],Ke=E[z.xanchor];if(z.thicknessmode==="pixels")ot.x=z.x,ot.l=Ye*tt,ot.r=Ye*Ke;else{var Mt=Ye-re;ot.l=Mt*tt,ot.r=Mt*Ke,ot.xl=z.x-z.thickness*tt,ot.xr=z.x+z.thickness*Ke}p.autoMargin(F,z._id,ot)}],F)}(C,w,b);S&&S.then&&(b._promises||[]).push(S),b._context.edits.colorbarPosition&&function(P,z,F){var q,W,X,Q=F._fullLayout._size;l.init({element:P.node(),gd:F,prepFn:function(){q=P.attr("transform"),s(P)},moveFn:function(Z,Y){P.attr("transform",q+a(Z,Y)),W=l.align(z._xLeftFrac+Z/Q.w,z._thickFrac,0,1,z.xanchor),X=l.align(z._yBottomFrac-Y/Q.h,z._lenFrac,0,1,z.yanchor);var N=l.getCursor(W,X,z.xanchor,z.yanchor);s(P,N)},doneFn:function(){if(s(P),W!==void 0&&X!==void 0){var Z={};Z[z._propPrefix+"x"]=W,Z[z._propPrefix+"y"]=X,z._traceIndex!==void 0?u.call("_guiRestyle",F,Z,z._traceIndex):u.call("_guiRelayout",F,Z)}}})}(C,w,b)}),L.exit().each(function(w){p.autoMargin(b,w._id)}).remove(),L.order()}}},{"../../constants/alignment":771,"../../lib":803,"../../lib/extend":793,"../../lib/setcursor":824,"../../lib/svg_text_utils":829,"../../plots/cartesian/axes":854,"../../plots/cartesian/axis_defaults":856,"../../plots/cartesian/layout_attributes":869,"../../plots/cartesian/position_defaults":872,"../../plots/plots":917,"../../registry":931,"../color":666,"../colorscale/helpers":677,"../dragelement":685,"../drawing":688,"../titles":764,"./constants":668,"@plotly/d3":58,tinycolor2:598}],671:[function(i,B,V){var t=i("../../lib");B.exports=function(h){return t.isPlainObject(h.colorbar)}},{"../../lib":803}],672:[function(i,B,V){B.exports={moduleType:"component",name:"colorbar",attributes:i("./attributes"),supplyDefaults:i("./defaults"),draw:i("./draw").draw,hasColorbar:i("./has_colorbar")}},{"./attributes":667,"./defaults":669,"./draw":670,"./has_colorbar":671}],673:[function(i,B,V){var t=i("../colorbar/attributes"),h=i("../../lib/regex").counter,p=i("../../lib/sort_object_keys"),u=i("./scales.js").scales;p(u);function e(l){return"`"+l+"`"}B.exports=function(l,o){l=l||"";var a,n=(o=o||{}).cLetter||"c",s=("onlyIfNumerical"in o&&o.onlyIfNumerical,"noScale"in o?o.noScale:l==="marker.line"),r="showScaleDflt"in o?o.showScaleDflt:n==="z",c=typeof o.colorscaleDflt=="string"?u[o.colorscaleDflt]:null,f=o.editTypeOverride||"",d=l?l+".":"";"colorAttr"in o?(a=o.colorAttr,o.colorAttr):e(d+(a={z:"z",c:"color"}[n]));var g=n+"auto",m=n+"min",y=n+"max",v=n+"mid",T={};T[m]=T[y]=void 0;var _={};_[g]=!1;var k={};return a==="color"&&(k.color={valType:"color",arrayOk:!0,editType:f||"style"},o.anim&&(k.color.anim=!0)),k[g]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:T},k[m]={valType:"number",dflt:null,editType:f||"plot",impliedEdits:_},k[y]={valType:"number",dflt:null,editType:f||"plot",impliedEdits:_},k[v]={valType:"number",dflt:null,editType:"calc",impliedEdits:T},k.colorscale={valType:"colorscale",editType:"calc",dflt:c,impliedEdits:{autocolorscale:!1}},k.autocolorscale={valType:"boolean",dflt:o.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},k.reversescale={valType:"boolean",dflt:!1,editType:"plot"},s||(k.showscale={valType:"boolean",dflt:r,editType:"calc"},k.colorbar=t),o.noColorAxis||(k.coloraxis={valType:"subplotid",regex:h("coloraxis"),dflt:null,editType:"calc"}),k}},{"../../lib/regex":820,"../../lib/sort_object_keys":826,"../colorbar/attributes":667,"./scales.js":681}],674:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("./helpers").extractOpts;B.exports=function(u,e,l){var o,a=u._fullLayout,n=l.vals,s=l.containerStr,r=s?h.nestedProperty(e,s).get():e,c=p(r),f=c.auto!==!1,d=c.min,g=c.max,m=c.mid,y=function(){return h.aggNums(Math.min,null,n)},v=function(){return h.aggNums(Math.max,null,n)};d===void 0?d=y():f&&(d=r._colorAx&&t(d)?Math.min(d,y()):y()),g===void 0?g=v():f&&(g=r._colorAx&&t(g)?Math.max(g,v()):v()),f&&m!==void 0&&(g-m>m-d?d=m-(g-m):g-m<m-d&&(g=m+(m-d))),d===g&&(d-=.5,g+=.5),c._sync("min",d),c._sync("max",g),c.autocolorscale&&(o=d*g<0?a.colorscale.diverging:d>=0?a.colorscale.sequential:a.colorscale.sequentialminus,c._sync("colorscale",o))}},{"../../lib":803,"./helpers":677,"fast-isnumeric":249}],675:[function(i,B,V){var t=i("../../lib"),h=i("./helpers").hasColorscale,p=i("./helpers").extractOpts;B.exports=function(u,e){function l(f,d){var g=f["_"+d];g!==void 0&&(f[d]=g)}function o(f,d){var g=d.container?t.nestedProperty(f,d.container).get():f;if(g)if(g.coloraxis)g._colorAx=e[g.coloraxis];else{var m=p(g),y=m.auto;(y||m.min===void 0)&&l(g,d.min),(y||m.max===void 0)&&l(g,d.max),m.autocolorscale&&l(g,"colorscale")}}for(var a=0;a<u.length;a++){var n=u[a],s=n._module.colorbar;if(s)if(Array.isArray(s))for(var r=0;r<s.length;r++)o(n,s[r]);else o(n,s);h(n,"marker.line")&&o(n,{container:"marker.line",min:"cmin",max:"cmax"})}for(var c in e._colorAxes)o(e[c],{min:"cmin",max:"cmax"})}},{"../../lib":803,"./helpers":677}],676:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("../colorbar/has_colorbar"),u=i("../colorbar/defaults"),e=i("./scales").isValid,l=i("../../registry").traceIs;function o(a,n){var s=n.slice(0,n.length-1);return n?h.nestedProperty(a,s).get()||{}:a}B.exports=function a(n,s,r,c,f){var d=f.prefix,g=f.cLetter,m="_module"in s,y=o(n,d),v=o(s,d),T=o(s._template||{},d)||{},_=function(){return delete n.coloraxis,delete s.coloraxis,a(n,s,r,c,f)};if(m){var k=r._colorAxes||{},E=c(d+"coloraxis");if(E){var A=l(s,"contour")&&h.nestedProperty(s,"contours.coloring").get()||"heatmap",b=k[E];return void(b?(b[2].push(_),b[0]!==A&&(b[0]=!1,h.warn(["Ignoring coloraxis:",E,"setting","as it is linked to incompatible colorscales."].join(" ")))):k[E]=[A,s,[_]])}}var L=y[g+"min"],w=y[g+"max"],C=t(L)&&t(w)&&L<w;c(d+g+"auto",!C)?c(d+g+"mid"):(c(d+g+"min"),c(d+g+"max"));var S,P,z=y.colorscale,F=T.colorscale;z!==void 0&&(S=!e(z)),F!==void 0&&(S=!e(F)),c(d+"autocolorscale",S),c(d+"colorscale"),c(d+"reversescale"),d!=="marker.line."&&(d&&m&&(P=p(y)),c(d+"showscale",P)&&(d&&T&&(v._template=T),u(y,v,r)))}},{"../../lib":803,"../../registry":931,"../colorbar/defaults":669,"../colorbar/has_colorbar":671,"./scales":681,"fast-isnumeric":249}],677:[function(i,B,V){var t=i("@plotly/d3"),h=i("tinycolor2"),p=i("fast-isnumeric"),u=i("../../lib"),e=i("../color"),l=i("./scales").isValid,o=["showscale","autocolorscale","colorscale","reversescale","colorbar"],a=["min","max","mid","auto"];function n(d){var g,m,y,v=d._colorAx,T=v||d,_={};for(m=0;m<o.length;m++)_[y=o[m]]=T[y];if(v)for(g="c",m=0;m<a.length;m++)_[y=a[m]]=T["c"+y];else{var k;for(m=0;m<a.length;m++)((k="c"+(y=a[m]))in T||(k="z"+y)in T)&&(_[y]=T[k]);g=k.charAt(0)}return _._sync=function(E,A){var b=a.indexOf(E)!==-1?g+E:E;T[b]=T["_"+b]=A},_}function s(d){for(var g=n(d),m=g.min,y=g.max,v=g.reversescale?r(g.colorscale):g.colorscale,T=v.length,_=new Array(T),k=new Array(T),E=0;E<T;E++){var A=v[E];_[E]=m+A[0]*(y-m),k[E]=A[1]}return{domain:_,range:k}}function r(d){for(var g=d.length,m=new Array(g),y=g-1,v=0;y>=0;y--,v++){var T=d[y];m[v]=[1-T[0],T[1]]}return m}function c(d,g){g=g||{};for(var m=d.domain,y=d.range,v=y.length,T=new Array(v),_=0;_<v;_++){var k=h(y[_]).toRgb();T[_]=[k.r,k.g,k.b,k.a]}var E,A=t.scale.linear().domain(m).range(T).clamp(!0),b=g.noNumericCheck,L=g.returnArray;return(E=b&&L?A:b?function(w){return f(A(w))}:L?function(w){return p(w)?A(w):h(w).isValid()?w:e.defaultLine}:function(w){return p(w)?f(A(w)):h(w).isValid()?w:e.defaultLine}).domain=A.domain,E.range=function(){return y},E}function f(d){var g={r:d[0],g:d[1],b:d[2],a:d[3]};return h(g).toRgbString()}B.exports={hasColorscale:function(d,g,m){var y=g?u.nestedProperty(d,g).get()||{}:d,v=y[m||"color"],T=!1;if(u.isArrayOrTypedArray(v)){for(var _=0;_<v.length;_++)if(p(v[_])){T=!0;break}}return u.isPlainObject(y)&&(T||y.showscale===!0||p(y.cmin)&&p(y.cmax)||l(y.colorscale)||u.isPlainObject(y.colorbar))},extractOpts:n,extractScale:s,flipScale:r,makeColorScaleFunc:c,makeColorScaleFuncFromTrace:function(d,g){return c(s(d),g)}}},{"../../lib":803,"../color":666,"./scales":681,"@plotly/d3":58,"fast-isnumeric":249,tinycolor2:598}],678:[function(i,B,V){var t=i("./scales"),h=i("./helpers");B.exports={moduleType:"component",name:"colorscale",attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyLayoutDefaults:i("./layout_defaults"),handleDefaults:i("./defaults"),crossTraceDefaults:i("./cross_trace_defaults"),calc:i("./calc"),scales:t.scales,defaultScale:t.defaultScale,getScale:t.get,isValidScale:t.isValid,hasColorscale:h.hasColorscale,extractOpts:h.extractOpts,extractScale:h.extractScale,flipScale:h.flipScale,makeColorScaleFunc:h.makeColorScaleFunc,makeColorScaleFuncFromTrace:h.makeColorScaleFuncFromTrace}},{"./attributes":673,"./calc":674,"./cross_trace_defaults":675,"./defaults":676,"./helpers":677,"./layout_attributes":679,"./layout_defaults":680,"./scales":681}],679:[function(i,B,V){var t=i("../../lib/extend").extendFlat,h=i("./attributes"),p=i("./scales").scales;B.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:p.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:p.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:p.RdBu,editType:"calc"}},coloraxis:t({_isSubplotObj:!0,editType:"calc"},h("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":793,"./attributes":673,"./scales":681}],680:[function(i,B,V){var t=i("../../lib"),h=i("../../plot_api/plot_template"),p=i("./layout_attributes"),u=i("./defaults");B.exports=function(e,l){function o(g,m){return t.coerce(e,l,p,g,m)}o("colorscale.sequential"),o("colorscale.sequentialminus"),o("colorscale.diverging");var a,n,s=l._colorAxes;function r(g,m){return t.coerce(a,n,p.coloraxis,g,m)}for(var c in s){var f=s[c];if(f[0])a=e[c]||{},(n=h.newContainer(l,c,"coloraxis"))._name=c,u(a,n,l,r,{prefix:"",cLetter:"c"});else{for(var d=0;d<f[2].length;d++)f[2][d]();delete l._colorAxes[c]}}}},{"../../lib":803,"../../plot_api/plot_template":843,"./defaults":676,"./layout_attributes":679}],681:[function(i,B,V){var t=i("tinycolor2"),h={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},p=h.RdBu;function u(e){var l=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||+e[0][0]!=0||+e[e.length-1][0]!=1)return!1;for(var o=0;o<e.length;o++){var a=e[o];if(a.length!==2||+a[0]<l||!t(a[1]).isValid())return!1;l=+a[0]}return!0}B.exports={scales:h,defaultScale:p,get:function(e,l){if(l||(l=p),!e)return l;function o(){try{e=h[e]||JSON.parse(e)}catch{e=l}}return typeof e=="string"&&(o(),typeof e=="string"&&o()),u(e)?e:l},isValid:function(e){return h[e]!==void 0||u(e)}}},{tinycolor2:598}],682:[function(i,B,V){B.exports=function(t,h,p,u,e){var l=(t-p)/(u-p),o=l+h/(u-p),a=(l+o)/2;return e==="left"||e==="bottom"?l:e==="center"||e==="middle"?a:e==="right"||e==="top"?o:l<2/3-a?l:o>4/3-a?o:a}},{}],683:[function(i,B,V){var t=i("../../lib"),h=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];B.exports=function(p,u,e,l){return p=e==="left"?0:e==="center"?1:e==="right"?2:t.constrain(Math.floor(3*p),0,2),u=l==="bottom"?0:l==="middle"?1:l==="top"?2:t.constrain(Math.floor(3*u),0,2),h[u][p]}},{"../../lib":803}],684:[function(i,B,V){V.selectMode=function(t){return t==="lasso"||t==="select"},V.drawMode=function(t){return t==="drawclosedpath"||t==="drawopenpath"||t==="drawline"||t==="drawrect"||t==="drawcircle"},V.openMode=function(t){return t==="drawline"||t==="drawopenpath"},V.rectMode=function(t){return t==="select"||t==="drawline"||t==="drawrect"||t==="drawcircle"},V.freeMode=function(t){return t==="lasso"||t==="drawclosedpath"||t==="drawopenpath"},V.selectingOrDrawing=function(t){return V.freeMode(t)||V.rectMode(t)}},{}],685:[function(i,B,V){var t=i("mouse-event-offset"),h=i("has-hover"),p=i("has-passive-events"),u=i("../../lib").removeElement,e=i("../../plots/cartesian/constants"),l=B.exports={};l.align=i("./align"),l.getCursor=i("./cursor");var o=i("./unhover");function a(){var s=document.createElement("div");s.className="dragcover";var r=s.style;return r.position="fixed",r.left=0,r.right=0,r.top=0,r.bottom=0,r.zIndex=999999999,r.background="none",document.body.appendChild(s),s}function n(s){return t(s.changedTouches?s.changedTouches[0]:s,document.body)}l.unhover=o.wrapped,l.unhoverRaw=o.raw,l.init=function(s){var r,c,f,d,g,m,y,v,T=s.gd,_=1,k=T._context.doubleClickDelay,E=s.element;T._mouseDownTime||(T._mouseDownTime=0),E.style.pointerEvents="all",E.onmousedown=b,p?(E._ontouchstart&&E.removeEventListener("touchstart",E._ontouchstart),E._ontouchstart=b,E.addEventListener("touchstart",b,{passive:!1})):E.ontouchstart=b;var A=s.clampFn||function(C,S,P){return Math.abs(C)<P&&(C=0),Math.abs(S)<P&&(S=0),[C,S]};function b(C){T._dragged=!1,T._dragging=!0;var S=n(C);r=S[0],c=S[1],y=C.target,m=C,v=C.buttons===2||C.ctrlKey,C.clientX===void 0&&C.clientY===void 0&&(C.clientX=r,C.clientY=c),(f=new Date().getTime())-T._mouseDownTime<k?_+=1:(_=1,T._mouseDownTime=f),s.prepFn&&s.prepFn(C,r,c),h&&!v?(g=a()).style.cursor=window.getComputedStyle(E).cursor:h||(g=document,d=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(E).cursor),document.addEventListener("mouseup",w),document.addEventListener("touchend",w),s.dragmode!==!1&&(C.preventDefault(),document.addEventListener("mousemove",L),document.addEventListener("touchmove",L,{passive:!1}))}function L(C){C.preventDefault();var S=n(C),P=s.minDrag||e.MINDRAG,z=A(S[0]-r,S[1]-c,P),F=z[0],q=z[1];(F||q)&&(T._dragged=!0,l.unhover(T,C)),T._dragged&&s.moveFn&&!v&&(T._dragdata={element:E,dx:F,dy:q},s.moveFn(F,q))}function w(C){if(delete T._dragdata,s.dragmode!==!1&&(C.preventDefault(),document.removeEventListener("mousemove",L),document.removeEventListener("touchmove",L)),document.removeEventListener("mouseup",w),document.removeEventListener("touchend",w),h?u(g):d&&(g.documentElement.style.cursor=d,d=null),T._dragging){if(T._dragging=!1,new Date().getTime()-T._mouseDownTime>k&&(_=Math.max(_-1,1)),T._dragged)s.doneFn&&s.doneFn();else if(s.clickFn&&s.clickFn(_,m),!v){var S;try{S=new MouseEvent("click",C)}catch{var P=n(C);(S=document.createEvent("MouseEvents")).initMouseEvent("click",C.bubbles,C.cancelable,C.view,C.detail,C.screenX,C.screenY,P[0],P[1],C.ctrlKey,C.altKey,C.shiftKey,C.metaKey,C.button,C.relatedTarget)}y.dispatchEvent(S)}T._dragging=!1,T._dragged=!1}else T._dragged=!1}},l.coverSlip=a},{"../../lib":803,"../../plots/cartesian/constants":861,"./align":682,"./cursor":683,"./unhover":686,"has-hover":443,"has-passive-events":444,"mouse-event-offset":471}],686:[function(i,B,V){var t=i("../../lib/events"),h=i("../../lib/throttle"),p=i("../../lib/dom").getGraphDiv,u=i("../fx/constants"),e=B.exports={};e.wrapped=function(l,o,a){(l=p(l))._fullLayout&&h.clear(l._fullLayout._uid+u.HOVERID),e.raw(l,o,a)},e.raw=function(l,o){var a=l._fullLayout,n=l._hoverdata;o||(o={}),o.target&&!l._dragged&&t.triggerHandler(l,"plotly_beforehover",o)===!1||(a._hoverlayer.selectAll("g").remove(),a._hoverlayer.selectAll("line").remove(),a._hoverlayer.selectAll("circle").remove(),l._hoverdata=void 0,o.target&&n&&l.emit("plotly_unhover",{event:o,points:n}))}},{"../../lib/dom":791,"../../lib/events":792,"../../lib/throttle":830,"../fx/constants":700}],687:[function(i,B,V){V.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},V.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],688:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=h.numberFormat,u=i("fast-isnumeric"),e=i("tinycolor2"),l=i("../../registry"),o=i("../color"),a=i("../colorscale"),n=h.strTranslate,s=i("../../lib/svg_text_utils"),r=i("../../constants/xmlns_namespaces"),c=i("../../constants/alignment").LINE_SPACING,f=i("../../constants/interactions").DESELECTDIM,d=i("../../traces/scatter/subtypes"),g=i("../../traces/scatter/make_bubble_size_func"),m=i("../../components/fx/helpers").appendArrayPointValue,y=B.exports={};y.font=function(Z,Y,N,J){h.isPlainObject(Y)&&(J=Y.color,N=Y.size,Y=Y.family),Y&&Z.style("font-family",Y),N+1&&Z.style("font-size",N+"px"),J&&Z.call(o.fill,J)},y.setPosition=function(Z,Y,N){Z.attr("x",Y).attr("y",N)},y.setSize=function(Z,Y,N){Z.attr("width",Y).attr("height",N)},y.setRect=function(Z,Y,N,J,D){Z.call(y.setPosition,Y,N).call(y.setSize,J,D)},y.translatePoint=function(Z,Y,N,J){var D=N.c2p(Z.x),U=J.c2p(Z.y);return!!(u(D)&&u(U)&&Y.node())&&(Y.node().nodeName==="text"?Y.attr("x",D).attr("y",U):Y.attr("transform",n(D,U)),!0)},y.translatePoints=function(Z,Y,N){Z.each(function(J){var D=t.select(this);y.translatePoint(J,D,Y,N)})},y.hideOutsideRangePoint=function(Z,Y,N,J,D,U){Y.attr("display",N.isPtWithinRange(Z,D)&&J.isPtWithinRange(Z,U)?null:"none")},y.hideOutsideRangePoints=function(Z,Y){if(Y._hasClipOnAxisFalse){var N=Y.xaxis,J=Y.yaxis;Z.each(function(D){var U=D[0].trace,G=U.xcalendar,$=U.ycalendar,K=l.traceIs(U,"bar-like")?".bartext":".point,.textpoint";Z.selectAll(K).each(function(re){y.hideOutsideRangePoint(re,t.select(this),N,J,G,$)})})}},y.crispRound=function(Z,Y,N){return Y&&u(Y)?Z._context.staticPlot?Y:Y<1?1:Math.round(Y):N||0},y.singleLineStyle=function(Z,Y,N,J,D){Y.style("fill","none");var U=(((Z||[])[0]||{}).trace||{}).line||{},G=N||U.width||0,$=D||U.dash||"";o.stroke(Y,J||U.color),y.dashLine(Y,$,G)},y.lineGroupStyle=function(Z,Y,N,J){Z.style("fill","none").each(function(D){var U=(((D||[])[0]||{}).trace||{}).line||{},G=Y||U.width||0,$=J||U.dash||"";t.select(this).call(o.stroke,N||U.color).call(y.dashLine,$,G)})},y.dashLine=function(Z,Y,N){N=+N||0,Y=y.dashStyle(Y,N),Z.style({"stroke-dasharray":Y,"stroke-width":N+"px"})},y.dashStyle=function(Z,Y){Y=+Y||1;var N=Math.max(Y,3);return Z==="solid"?Z="":Z==="dot"?Z=N+"px,"+N+"px":Z==="dash"?Z=3*N+"px,"+3*N+"px":Z==="longdash"?Z=5*N+"px,"+5*N+"px":Z==="dashdot"?Z=3*N+"px,"+N+"px,"+N+"px,"+N+"px":Z==="longdashdot"&&(Z=5*N+"px,"+2*N+"px,"+N+"px,"+2*N+"px"),Z},y.singleFillStyle=function(Z){var Y=(((t.select(Z.node()).data()[0]||[])[0]||{}).trace||{}).fillcolor;Y&&Z.call(o.fill,Y)},y.fillGroupStyle=function(Z){Z.style("stroke-width",0).each(function(Y){var N=t.select(this);Y[0].trace&&N.call(o.fill,Y[0].trace.fillcolor)})};var v=i("./symbol_defs");y.symbolNames=[],y.symbolFuncs=[],y.symbolNeedLines={},y.symbolNoDot={},y.symbolNoFill={},y.symbolList=[],Object.keys(v).forEach(function(Z){var Y=v[Z],N=Y.n;y.symbolList.push(N,String(N),Z,N+100,String(N+100),Z+"-open"),y.symbolNames[N]=Z,y.symbolFuncs[N]=Y.f,Y.needLine&&(y.symbolNeedLines[N]=!0),Y.noDot?y.symbolNoDot[N]=!0:y.symbolList.push(N+200,String(N+200),Z+"-dot",N+300,String(N+300),Z+"-open-dot"),Y.noFill&&(y.symbolNoFill[N]=!0)});var T=y.symbolNames.length;function _(Z,Y){var N=Z%100;return y.symbolFuncs[N](Y)+(Z>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}y.symbolNumber=function(Z){if(u(Z))Z=+Z;else if(typeof Z=="string"){var Y=0;Z.indexOf("-open")>0&&(Y=100,Z=Z.replace("-open","")),Z.indexOf("-dot")>0&&(Y+=200,Z=Z.replace("-dot","")),(Z=y.symbolNames.indexOf(Z))>=0&&(Z+=Y)}return Z%100>=T||Z>=400?0:Math.floor(Math.max(Z,0))};var k={x1:1,x2:0,y1:0,y2:0},E={x1:0,x2:0,y1:1,y2:0},A=p("~f"),b={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:k},horizontalreversed:{node:"linearGradient",attrs:k,reversed:!0},vertical:{node:"linearGradient",attrs:E},verticalreversed:{node:"linearGradient",attrs:E,reversed:!0}};y.gradient=function(Z,Y,N,J,D,U){for(var G=D.length,$=b[J],K=new Array(G),re=0;re<G;re++)$.reversed?K[G-1-re]=[A(100*(1-D[re][0])),D[re][1]]:K[re]=[A(100*D[re][0]),D[re][1]];var ne=Y._fullLayout,ae="g"+ne._uid+"-"+N,ie=ne._defs.select(".gradients").selectAll("#"+ae).data([J+K.join(";")],h.identity);ie.exit().remove(),ie.enter().append($.node).each(function(){var de=t.select(this);$.attrs&&de.attr($.attrs),de.attr("id",ae);var ce=de.selectAll("stop").data(K);ce.exit().remove(),ce.enter().append("stop"),ce.each(function(ve){var Ee=e(ve[1]);t.select(this).attr({offset:ve[0]+"%","stop-color":o.tinyRGB(Ee),"stop-opacity":Ee.getAlpha()})})}),Z.style(U,W(ae,Y)).style(U+"-opacity",null);var he=function(de){return"."+de.attr("class").replace(/\s/g,".")},se=he(t.select(Z.node().parentNode))+">"+he(Z);ne._gradientUrlQueryParts[se]=1},y.pattern=function(Z,Y,N,J,D,U,G,$,K,re,ne,ae){var ie=Y==="legend";$&&(K==="overlay"?(re=$,ne=o.contrast(re)):(re=void 0,ne=$));var he,se,de,ce,ve,Ee,Le,Te,xe,fe,ge,ke=N._fullLayout,Me="p"+ke._uid+"-"+J,Se={};switch(D){case"/":he=U*Math.sqrt(2),se=U*Math.sqrt(2),Ee="path",Se={d:de="M-"+he/4+","+se/4+"l"+he/2+",-"+se/2+"M0,"+se+"L"+he+",0M"+he/4*3+","+se/4*5+"l"+he/2+",-"+se/2,opacity:ae,stroke:ne,"stroke-width":(ce=G*U)+"px"};break;case"\\":he=U*Math.sqrt(2),se=U*Math.sqrt(2),Ee="path",Se={d:de="M"+he/4*3+",-"+se/4+"l"+he/2+","+se/2+"M0,0L"+he+","+se+"M-"+he/4+","+se/4*3+"l"+he/2+","+se/2,opacity:ae,stroke:ne,"stroke-width":(ce=G*U)+"px"};break;case"x":he=U*Math.sqrt(2),se=U*Math.sqrt(2),de="M-"+he/4+","+se/4+"l"+he/2+",-"+se/2+"M0,"+se+"L"+he+",0M"+he/4*3+","+se/4*5+"l"+he/2+",-"+se/2+"M"+he/4*3+",-"+se/4+"l"+he/2+","+se/2+"M0,0L"+he+","+se+"M-"+he/4+","+se/4*3+"l"+he/2+","+se/2,ce=U-U*Math.sqrt(1-G),Ee="path",Se={d:de,opacity:ae,stroke:ne,"stroke-width":ce+"px"};break;case"|":Ee="path",Ee="path",Se={d:de="M"+(he=U)/2+",0L"+he/2+","+(se=U),opacity:ae,stroke:ne,"stroke-width":(ce=G*U)+"px"};break;case"-":Ee="path",Ee="path",Se={d:de="M0,"+(se=U)/2+"L"+(he=U)+","+se/2,opacity:ae,stroke:ne,"stroke-width":(ce=G*U)+"px"};break;case"+":Ee="path",de="M"+(he=U)/2+",0L"+he/2+","+(se=U)+"M0,"+se/2+"L"+he+","+se/2,ce=U-U*Math.sqrt(1-G),Ee="path",Se={d:de,opacity:ae,stroke:ne,"stroke-width":ce+"px"};break;case".":he=U,se=U,G<Math.PI/4?ve=Math.sqrt(G*U*U/Math.PI):(Le=G,Te=Math.PI/4,xe=1,fe=U/2,ge=U/Math.sqrt(2),ve=fe+(ge-fe)*(Le-Te)/(xe-Te)),Ee="circle",Se={cx:he/2,cy:se/2,r:ve,opacity:ae,fill:ne}}var De=[D||"noSh",re||"noBg",ne||"noFg",U,G].join(";"),Be=ke._defs.select(".patterns").selectAll("#"+Me).data([De],h.identity);Be.exit().remove(),Be.enter().append("pattern").each(function(){var Qe=t.select(this);if(Qe.attr({id:Me,width:he+"px",height:se+"px",patternUnits:"userSpaceOnUse",patternTransform:ie?"scale(0.8)":""}),re){var Oe=Qe.selectAll("rect").data([0]);Oe.exit().remove(),Oe.enter().append("rect").attr({width:he+"px",height:se+"px",fill:re})}var Ue=Qe.selectAll(Ee).data([0]);Ue.exit().remove(),Ue.enter().append(Ee).attr(Se)}),Z.style("fill",W(Me,N)).style("fill-opacity",null),Z.classed("pattern_filled",!0);var We="."+t.select(Z.node().parentNode).attr("class").replace(/\s/g,".")+">.pattern_filled";ke._patternUrlQueryParts[We]=1},y.initGradients=function(Z){var Y=Z._fullLayout;h.ensureSingle(Y._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),Y._gradientUrlQueryParts={}},y.initPatterns=function(Z){var Y=Z._fullLayout;h.ensureSingle(Y._defs,"g","patterns").selectAll("pattern").remove(),Y._patternUrlQueryParts={}},y.getPatternAttr=function(Z,Y,N){return Z&&h.isArrayOrTypedArray(Z)?Y<Z.length?Z[Y]:N:Z},y.pointStyle=function(Z,Y,N){if(Z.size()){var J=y.makePointStyleFns(Y);Z.each(function(D){y.singlePointStyle(D,t.select(this),Y,J,N)})}},y.singlePointStyle=function(Z,Y,N,J,D){var U=N.marker,G=U.line;if(Y.style("opacity",J.selectedOpacityFn?J.selectedOpacityFn(Z):Z.mo===void 0?U.opacity:Z.mo),J.ms2mrc){var $;$=Z.ms==="various"||U.size==="various"?3:J.ms2mrc(Z.ms),Z.mrc=$,J.selectedSizeFn&&($=Z.mrc=J.selectedSizeFn(Z));var K=y.symbolNumber(Z.mx||U.symbol)||0;Z.om=K%200>=100,Y.attr("d",_(K,$))}var re,ne,ae,ie=!1;if(Z.so)ae=G.outlierwidth,ne=G.outliercolor,re=U.outliercolor;else{var he=(G||{}).width;ae=(Z.mlw+1||he+1||(Z.trace?(Z.trace.marker.line||{}).width:0)+1)-1||0,ne="mlc"in Z?Z.mlcc=J.lineScale(Z.mlc):h.isArrayOrTypedArray(G.color)?o.defaultLine:G.color,h.isArrayOrTypedArray(U.color)&&(re=o.defaultLine,ie=!0),re="mc"in Z?Z.mcc=J.markerScale(Z.mc):U.color||"rgba(0,0,0,0)",J.selectedColorFn&&(re=J.selectedColorFn(Z))}if(Z.om)Y.call(o.stroke,re).style({"stroke-width":(ae||1)+"px",fill:"none"});else{Y.style("stroke-width",(Z.isBlank?0:ae)+"px");var se=U.gradient,de=Z.mgt;de?ie=!0:de=se&&se.type,h.isArrayOrTypedArray(de)&&(de=de[0],b[de]||(de=0));var ce=U.pattern,ve=ce&&y.getPatternAttr(ce.shape,Z.i,"");if(de&&de!=="none"){var Ee=Z.mgc;Ee?ie=!0:Ee=se.color;var Le=N.uid;ie&&(Le+="-"+Z.i),y.gradient(Y,D,Le,de,[[0,Ee],[1,re]],"fill")}else if(ve){var Te=y.getPatternAttr(ce.bgcolor,Z.i,null),xe=y.getPatternAttr(ce.fgcolor,Z.i,null),fe=ce.fgopacity,ge=y.getPatternAttr(ce.size,Z.i,8),ke=y.getPatternAttr(ce.solidity,Z.i,.3),Me=Z.mcc||h.isArrayOrTypedArray(ce.shape)||h.isArrayOrTypedArray(ce.bgcolor)||h.isArrayOrTypedArray(ce.size)||h.isArrayOrTypedArray(ce.solidity),Se=N.uid;Me&&(Se+="-"+Z.i),y.pattern(Y,"point",D,Se,ve,ge,ke,Z.mcc,ce.fillmode,Te,xe,fe)}else o.fill(Y,re);ae&&o.stroke(Y,ne)}},y.makePointStyleFns=function(Z){var Y={},N=Z.marker;return Y.markerScale=y.tryColorscale(N,""),Y.lineScale=y.tryColorscale(N,"line"),l.traceIs(Z,"symbols")&&(Y.ms2mrc=d.isBubble(Z)?g(Z):function(){return(N.size||6)/2}),Z.selectedpoints&&h.extendFlat(Y,y.makeSelectedPointStyleFns(Z)),Y},y.makeSelectedPointStyleFns=function(Z){var Y={},N=Z.selected||{},J=Z.unselected||{},D=Z.marker||{},U=N.marker||{},G=J.marker||{},$=D.opacity,K=U.opacity,re=G.opacity,ne=K!==void 0,ae=re!==void 0;(h.isArrayOrTypedArray($)||ne||ae)&&(Y.selectedOpacityFn=function(Te){var xe=Te.mo===void 0?D.opacity:Te.mo;return Te.selected?ne?K:xe:ae?re:f*xe});var ie=D.color,he=U.color,se=G.color;(he||se)&&(Y.selectedColorFn=function(Te){var xe=Te.mcc||ie;return Te.selected?he||xe:se||xe});var de=D.size,ce=U.size,ve=G.size,Ee=ce!==void 0,Le=ve!==void 0;return l.traceIs(Z,"symbols")&&(Ee||Le)&&(Y.selectedSizeFn=function(Te){var xe=Te.mrc||de/2;return Te.selected?Ee?ce/2:xe:Le?ve/2:xe}),Y},y.makeSelectedTextStyleFns=function(Z){var Y={},N=Z.selected||{},J=Z.unselected||{},D=Z.textfont||{},U=N.textfont||{},G=J.textfont||{},$=D.color,K=U.color,re=G.color;return Y.selectedTextColorFn=function(ne){var ae=ne.tc||$;return ne.selected?K||ae:re||(K?ae:o.addOpacity(ae,f))},Y},y.selectedPointStyle=function(Z,Y){if(Z.size()&&Y.selectedpoints){var N=y.makeSelectedPointStyleFns(Y),J=Y.marker||{},D=[];N.selectedOpacityFn&&D.push(function(U,G){U.style("opacity",N.selectedOpacityFn(G))}),N.selectedColorFn&&D.push(function(U,G){o.fill(U,N.selectedColorFn(G))}),N.selectedSizeFn&&D.push(function(U,G){var $=G.mx||J.symbol||0,K=N.selectedSizeFn(G);U.attr("d",_(y.symbolNumber($),K)),G.mrc2=K}),D.length&&Z.each(function(U){for(var G=t.select(this),$=0;$<D.length;$++)D[$](G,U)})}},y.tryColorscale=function(Z,Y){var N=Y?h.nestedProperty(Z,Y).get():Z;if(N){var J=N.color;if((N.colorscale||N._colorAx)&&h.isArrayOrTypedArray(J))return a.makeColorScaleFuncFromTrace(N)}return h.identity};var L={start:1,end:-1,middle:0,bottom:1,top:-1};function w(Z,Y,N,J){var D=t.select(Z.node().parentNode),U=Y.indexOf("top")!==-1?"top":Y.indexOf("bottom")!==-1?"bottom":"middle",G=Y.indexOf("left")!==-1?"end":Y.indexOf("right")!==-1?"start":"middle",$=J?J/.8+1:0,K=(s.lineCount(Z)-1)*c+1,re=L[G]*$,ne=.75*N+L[U]*$+(L[U]-1)*K*N/2;Z.attr("text-anchor",G),D.attr("transform",n(re,ne))}function C(Z,Y){var N=Z.ts||Y.textfont.size;return u(N)&&N>0?N:0}y.textPointStyle=function(Z,Y,N){if(Z.size()){var J;if(Y.selectedpoints){var D=y.makeSelectedTextStyleFns(Y);J=D.selectedTextColorFn}var U=Y.texttemplate,G=N._fullLayout;Z.each(function($){var K=t.select(this),re=U?h.extractOption($,Y,"txt","texttemplate"):h.extractOption($,Y,"tx","text");if(re||re===0){if(U){var ne=Y._module.formatLabels,ae=ne?ne($,Y,G):{},ie={};m(ie,Y,$.i);var he=Y._meta||{};re=h.texttemplateString(re,ae,G._d3locale,ie,$,he)}var se=$.tp||Y.textposition,de=C($,Y),ce=J?J($):$.tc||Y.textfont.color;K.call(y.font,$.tf||Y.textfont.family,de,ce).text(re).call(s.convertToTspans,N).call(w,se,de,$.mrc)}else K.remove()})}},y.selectedTextStyle=function(Z,Y){if(Z.size()&&Y.selectedpoints){var N=y.makeSelectedTextStyleFns(Y);Z.each(function(J){var D=t.select(this),U=N.selectedTextColorFn(J),G=J.tp||Y.textposition,$=C(J,Y);o.fill(D,U),w(D,G,$,J.mrc2||J.mrc)})}};function S(Z,Y,N,J){var D=Z[0]-Y[0],U=Z[1]-Y[1],G=N[0]-Y[0],$=N[1]-Y[1],K=Math.pow(D*D+U*U,.25),re=Math.pow(G*G+$*$,.25),ne=(re*re*D-K*K*G)*J,ae=(re*re*U-K*K*$)*J,ie=3*re*(K+re),he=3*K*(K+re);return[[t.round(Y[0]+(ie&&ne/ie),2),t.round(Y[1]+(ie&&ae/ie),2)],[t.round(Y[0]-(he&&ne/he),2),t.round(Y[1]-(he&&ae/he),2)]]}y.smoothopen=function(Z,Y){if(Z.length<3)return"M"+Z.join("L");var N,J="M"+Z[0],D=[];for(N=1;N<Z.length-1;N++)D.push(S(Z[N-1],Z[N],Z[N+1],Y));for(J+="Q"+D[0][0]+" "+Z[1],N=2;N<Z.length-1;N++)J+="C"+D[N-2][1]+" "+D[N-1][0]+" "+Z[N];return J+="Q"+D[Z.length-3][1]+" "+Z[Z.length-1]},y.smoothclosed=function(Z,Y){if(Z.length<3)return"M"+Z.join("L")+"Z";var N,J="M"+Z[0],D=Z.length-1,U=[S(Z[D],Z[0],Z[1],Y)];for(N=1;N<D;N++)U.push(S(Z[N-1],Z[N],Z[N+1],Y));for(U.push(S(Z[D-1],Z[D],Z[0],Y)),N=1;N<=D;N++)J+="C"+U[N-1][1]+" "+U[N][0]+" "+Z[N];return J+="C"+U[D][1]+" "+U[0][0]+" "+Z[0]+"Z"};var P={hv:function(Z,Y){return"H"+t.round(Y[0],2)+"V"+t.round(Y[1],2)},vh:function(Z,Y){return"V"+t.round(Y[1],2)+"H"+t.round(Y[0],2)},hvh:function(Z,Y){return"H"+t.round((Z[0]+Y[0])/2,2)+"V"+t.round(Y[1],2)+"H"+t.round(Y[0],2)},vhv:function(Z,Y){return"V"+t.round((Z[1]+Y[1])/2,2)+"H"+t.round(Y[0],2)+"V"+t.round(Y[1],2)}},z=function(Z,Y){return"L"+t.round(Y[0],2)+","+t.round(Y[1],2)};y.steps=function(Z){var Y=P[Z]||z;return function(N){for(var J="M"+t.round(N[0][0],2)+","+t.round(N[0][1],2),D=1;D<N.length;D++)J+=Y(N[D-1],N[D]);return J}},y.makeTester=function(){var Z=h.ensureSingleById(t.select("body"),"svg","js-plotly-tester",function(N){N.attr(r.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),Y=h.ensureSingle(Z,"path","js-reference-point",function(N){N.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});y.tester=Z,y.testref=Y},y.savedBBoxes={};var F=0;function q(Z){var Y=Z.getAttribute("data-unformatted");if(Y!==null)return Y+Z.getAttribute("data-math")+Z.getAttribute("text-anchor")+Z.getAttribute("style")}function W(Z,Y){if(!Z)return null;var N=Y._context,J=N._exportedPlot?"":N._baseUrl||"";return J?"url('"+J+"#"+Z+"')":"url(#"+Z+")"}y.bBox=function(Z,Y,N){var J,D,U;if(N||(N=q(Z)),N){if(J=y.savedBBoxes[N])return h.extendFlat({},J)}else if(Z.childNodes.length===1){var G=Z.childNodes[0];if(N=q(G)){var $=+G.getAttribute("x")||0,K=+G.getAttribute("y")||0,re=G.getAttribute("transform");if(!re){var ne=y.bBox(G,!1,N);return $&&(ne.left+=$,ne.right+=$),K&&(ne.top+=K,ne.bottom+=K),ne}if(N+="~"+$+"~"+K+"~"+re,J=y.savedBBoxes[N])return h.extendFlat({},J)}}Y?D=Z:(U=y.tester.node(),D=Z.cloneNode(!0),U.appendChild(D)),t.select(D).attr("transform",null).call(s.positionText,0,0);var ae=D.getBoundingClientRect(),ie=y.testref.node().getBoundingClientRect();Y||U.removeChild(D);var he={height:ae.height,width:ae.width,left:ae.left-ie.left,top:ae.top-ie.top,right:ae.right-ie.left,bottom:ae.bottom-ie.top};return F>=1e4&&(y.savedBBoxes={},F=0),N&&(y.savedBBoxes[N]=he),F++,h.extendFlat({},he)},y.setClipUrl=function(Z,Y,N){Z.attr("clip-path",W(Y,N))},y.getTranslate=function(Z){var Y=(Z[Z.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(N,J,D){return[J,D].join(" ")}).split(" ");return{x:+Y[0]||0,y:+Y[1]||0}},y.setTranslate=function(Z,Y,N){var J=Z.attr?"attr":"getAttribute",D=Z.attr?"attr":"setAttribute",U=Z[J]("transform")||"";return Y=Y||0,N=N||0,U=U.replace(/(\btranslate\(.*?\);?)/,"").trim(),U=(U+=n(Y,N)).trim(),Z[D]("transform",U),U},y.getScale=function(Z){var Y=(Z[Z.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(N,J,D){return[J,D].join(" ")}).split(" ");return{x:+Y[0]||1,y:+Y[1]||1}},y.setScale=function(Z,Y,N){var J=Z.attr?"attr":"getAttribute",D=Z.attr?"attr":"setAttribute",U=Z[J]("transform")||"";return Y=Y||1,N=N||1,U=U.replace(/(\bscale\(.*?\);?)/,"").trim(),U=(U+="scale("+Y+","+N+")").trim(),Z[D]("transform",U),U};var X=/\s*sc.*/;y.setPointGroupScale=function(Z,Y,N){if(Y=Y||1,N=N||1,Z){var J=Y===1&&N===1?"":"scale("+Y+","+N+")";Z.each(function(){var D=(this.getAttribute("transform")||"").replace(X,"");D=(D+=J).trim(),this.setAttribute("transform",D)})}};var Q=/translate\([^)]*\)\s*$/;y.setTextPointsScale=function(Z,Y,N){Z&&Z.each(function(){var J,D=t.select(this),U=D.select("text");if(U.node()){var G=parseFloat(U.attr("x")||0),$=parseFloat(U.attr("y")||0),K=(D.attr("transform")||"").match(Q);J=Y===1&&N===1?[]:[n(G,$),"scale("+Y+","+N+")",n(-G,-$)],K&&J.push(K),D.attr("transform",J.join(""))}})}},{"../../components/fx/helpers":702,"../../constants/alignment":771,"../../constants/interactions":778,"../../constants/xmlns_namespaces":780,"../../lib":803,"../../lib/svg_text_utils":829,"../../registry":931,"../../traces/scatter/make_bubble_size_func":1235,"../../traces/scatter/subtypes":1243,"../color":666,"../colorscale":678,"./symbol_defs":689,"@plotly/d3":58,"fast-isnumeric":249,tinycolor2:598}],689:[function(i,B,V){var t=i("@plotly/d3");B.exports={circle:{n:0,f:function(h){var p=t.round(h,2);return"M"+p+",0A"+p+","+p+" 0 1,1 0,-"+p+"A"+p+","+p+" 0 0,1 "+p+",0Z"}},square:{n:1,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"H-"+p+"V-"+p+"H"+p+"Z"}},diamond:{n:2,f:function(h){var p=t.round(1.3*h,2);return"M"+p+",0L0,"+p+"L-"+p+",0L0,-"+p+"Z"}},cross:{n:3,f:function(h){var p=t.round(.4*h,2),u=t.round(1.2*h,2);return"M"+u+","+p+"H"+p+"V"+u+"H-"+p+"V"+p+"H-"+u+"V-"+p+"H-"+p+"V-"+u+"H"+p+"V-"+p+"H"+u+"Z"}},x:{n:4,f:function(h){var p=t.round(.8*h/Math.sqrt(2),2),u="l"+p+","+p,e="l"+p+",-"+p,l="l-"+p+",-"+p,o="l-"+p+","+p;return"M0,"+p+u+e+l+e+l+o+l+o+u+o+u+"Z"}},"triangle-up":{n:5,f:function(h){var p=t.round(2*h/Math.sqrt(3),2);return"M-"+p+","+t.round(h/2,2)+"H"+p+"L0,-"+t.round(h,2)+"Z"}},"triangle-down":{n:6,f:function(h){var p=t.round(2*h/Math.sqrt(3),2);return"M-"+p+",-"+t.round(h/2,2)+"H"+p+"L0,"+t.round(h,2)+"Z"}},"triangle-left":{n:7,f:function(h){var p=t.round(2*h/Math.sqrt(3),2);return"M"+t.round(h/2,2)+",-"+p+"V"+p+"L-"+t.round(h,2)+",0Z"}},"triangle-right":{n:8,f:function(h){var p=t.round(2*h/Math.sqrt(3),2);return"M-"+t.round(h/2,2)+",-"+p+"V"+p+"L"+t.round(h,2)+",0Z"}},"triangle-ne":{n:9,f:function(h){var p=t.round(.6*h,2),u=t.round(1.2*h,2);return"M-"+u+",-"+p+"H"+p+"V"+u+"Z"}},"triangle-se":{n:10,f:function(h){var p=t.round(.6*h,2),u=t.round(1.2*h,2);return"M"+p+",-"+u+"V"+p+"H-"+u+"Z"}},"triangle-sw":{n:11,f:function(h){var p=t.round(.6*h,2),u=t.round(1.2*h,2);return"M"+u+","+p+"H-"+p+"V-"+u+"Z"}},"triangle-nw":{n:12,f:function(h){var p=t.round(.6*h,2),u=t.round(1.2*h,2);return"M-"+p+","+u+"V-"+p+"H"+u+"Z"}},pentagon:{n:13,f:function(h){var p=t.round(.951*h,2),u=t.round(.588*h,2),e=t.round(-h,2),l=t.round(-.309*h,2);return"M"+p+","+l+"L"+u+","+t.round(.809*h,2)+"H-"+u+"L-"+p+","+l+"L0,"+e+"Z"}},hexagon:{n:14,f:function(h){var p=t.round(h,2),u=t.round(h/2,2),e=t.round(h*Math.sqrt(3)/2,2);return"M"+e+",-"+u+"V"+u+"L0,"+p+"L-"+e+","+u+"V-"+u+"L0,-"+p+"Z"}},hexagon2:{n:15,f:function(h){var p=t.round(h,2),u=t.round(h/2,2),e=t.round(h*Math.sqrt(3)/2,2);return"M-"+u+","+e+"H"+u+"L"+p+",0L"+u+",-"+e+"H-"+u+"L-"+p+",0Z"}},octagon:{n:16,f:function(h){var p=t.round(.924*h,2),u=t.round(.383*h,2);return"M-"+u+",-"+p+"H"+u+"L"+p+",-"+u+"V"+u+"L"+u+","+p+"H-"+u+"L-"+p+","+u+"V-"+u+"Z"}},star:{n:17,f:function(h){var p=1.4*h,u=t.round(.225*p,2),e=t.round(.951*p,2),l=t.round(.363*p,2),o=t.round(.588*p,2),a=t.round(-p,2),n=t.round(-.309*p,2),s=t.round(.118*p,2),r=t.round(.809*p,2);return"M"+u+","+n+"H"+e+"L"+l+","+s+"L"+o+","+r+"L0,"+t.round(.382*p,2)+"L-"+o+","+r+"L-"+l+","+s+"L-"+e+","+n+"H-"+u+"L0,"+a+"Z"}},hexagram:{n:18,f:function(h){var p=t.round(.66*h,2),u=t.round(.38*h,2),e=t.round(.76*h,2);return"M-"+e+",0l-"+u+",-"+p+"h"+e+"l"+u+",-"+p+"l"+u+","+p+"h"+e+"l-"+u+","+p+"l"+u+","+p+"h-"+e+"l-"+u+","+p+"l-"+u+",-"+p+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(h){var p=t.round(h*Math.sqrt(3)*.8,2),u=t.round(.8*h,2),e=t.round(1.6*h,2),l=t.round(4*h,2),o="A "+l+","+l+" 0 0 1 ";return"M-"+p+","+u+o+p+","+u+o+"0,-"+e+o+"-"+p+","+u+"Z"}},"star-triangle-down":{n:20,f:function(h){var p=t.round(h*Math.sqrt(3)*.8,2),u=t.round(.8*h,2),e=t.round(1.6*h,2),l=t.round(4*h,2),o="A "+l+","+l+" 0 0 1 ";return"M"+p+",-"+u+o+"-"+p+",-"+u+o+"0,"+e+o+p+",-"+u+"Z"}},"star-square":{n:21,f:function(h){var p=t.round(1.1*h,2),u=t.round(2*h,2),e="A "+u+","+u+" 0 0 1 ";return"M-"+p+",-"+p+e+"-"+p+","+p+e+p+","+p+e+p+",-"+p+e+"-"+p+",-"+p+"Z"}},"star-diamond":{n:22,f:function(h){var p=t.round(1.4*h,2),u=t.round(1.9*h,2),e="A "+u+","+u+" 0 0 1 ";return"M-"+p+",0"+e+"0,"+p+e+p+",0"+e+"0,-"+p+e+"-"+p+",0Z"}},"diamond-tall":{n:23,f:function(h){var p=t.round(.7*h,2),u=t.round(1.4*h,2);return"M0,"+u+"L"+p+",0L0,-"+u+"L-"+p+",0Z"}},"diamond-wide":{n:24,f:function(h){var p=t.round(1.4*h,2),u=t.round(.7*h,2);return"M0,"+u+"L"+p+",0L0,-"+u+"L-"+p+",0Z"}},hourglass:{n:25,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"H-"+p+"L"+p+",-"+p+"H-"+p+"Z"},noDot:!0},bowtie:{n:26,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"V-"+p+"L-"+p+","+p+"V-"+p+"Z"},noDot:!0},"circle-cross":{n:27,f:function(h){var p=t.round(h,2);return"M0,"+p+"V-"+p+"M"+p+",0H-"+p+"M"+p+",0A"+p+","+p+" 0 1,1 0,-"+p+"A"+p+","+p+" 0 0,1 "+p+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(h){var p=t.round(h,2),u=t.round(h/Math.sqrt(2),2);return"M"+u+","+u+"L-"+u+",-"+u+"M"+u+",-"+u+"L-"+u+","+u+"M"+p+",0A"+p+","+p+" 0 1,1 0,-"+p+"A"+p+","+p+" 0 0,1 "+p+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(h){var p=t.round(h,2);return"M0,"+p+"V-"+p+"M"+p+",0H-"+p+"M"+p+","+p+"H-"+p+"V-"+p+"H"+p+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"L-"+p+",-"+p+"M"+p+",-"+p+"L-"+p+","+p+"M"+p+","+p+"H-"+p+"V-"+p+"H"+p+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(h){var p=t.round(1.3*h,2);return"M"+p+",0L0,"+p+"L-"+p+",0L0,-"+p+"ZM0,-"+p+"V"+p+"M-"+p+",0H"+p},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(h){var p=t.round(1.3*h,2),u=t.round(.65*h,2);return"M"+p+",0L0,"+p+"L-"+p+",0L0,-"+p+"ZM-"+u+",-"+u+"L"+u+","+u+"M-"+u+","+u+"L"+u+",-"+u},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(h){var p=t.round(1.4*h,2);return"M0,"+p+"V-"+p+"M"+p+",0H-"+p},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"L-"+p+",-"+p+"M"+p+",-"+p+"L-"+p+","+p},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(h){var p=t.round(1.2*h,2),u=t.round(.85*h,2);return"M0,"+p+"V-"+p+"M"+p+",0H-"+p+"M"+u+","+u+"L-"+u+",-"+u+"M"+u+",-"+u+"L-"+u+","+u},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(h){var p=t.round(h/2,2),u=t.round(h,2);return"M"+p+","+u+"V-"+u+"m-"+u+",0V"+u+"M"+u+","+p+"H-"+u+"m0,-"+u+"H"+u},needLine:!0,noFill:!0},"y-up":{n:37,f:function(h){var p=t.round(1.2*h,2),u=t.round(1.6*h,2),e=t.round(.8*h,2);return"M-"+p+","+e+"L0,0M"+p+","+e+"L0,0M0,-"+u+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(h){var p=t.round(1.2*h,2),u=t.round(1.6*h,2),e=t.round(.8*h,2);return"M-"+p+",-"+e+"L0,0M"+p+",-"+e+"L0,0M0,"+u+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(h){var p=t.round(1.2*h,2),u=t.round(1.6*h,2),e=t.round(.8*h,2);return"M"+e+","+p+"L0,0M"+e+",-"+p+"L0,0M-"+u+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(h){var p=t.round(1.2*h,2),u=t.round(1.6*h,2),e=t.round(.8*h,2);return"M-"+e+","+p+"L0,0M-"+e+",-"+p+"L0,0M"+u+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(h){var p=t.round(1.4*h,2);return"M"+p+",0H-"+p},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(h){var p=t.round(1.4*h,2);return"M0,"+p+"V-"+p},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(h){var p=t.round(h,2);return"M"+p+",-"+p+"L-"+p+","+p},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"L-"+p+",-"+p},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(h){var p=t.round(h,2);return"M0,0L-"+p+","+t.round(2*h,2)+"H"+p+"Z"},noDot:!0},"arrow-down":{n:46,f:function(h){var p=t.round(h,2);return"M0,0L-"+p+",-"+t.round(2*h,2)+"H"+p+"Z"},noDot:!0},"arrow-left":{n:47,f:function(h){var p=t.round(2*h,2),u=t.round(h,2);return"M0,0L"+p+",-"+u+"V"+u+"Z"},noDot:!0},"arrow-right":{n:48,f:function(h){var p=t.round(2*h,2),u=t.round(h,2);return"M0,0L-"+p+",-"+u+"V"+u+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(h){var p=t.round(h,2);return"M-"+p+",0H"+p+"M0,0L-"+p+","+t.round(2*h,2)+"H"+p+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(h){var p=t.round(h,2);return"M-"+p+",0H"+p+"M0,0L-"+p+",-"+t.round(2*h,2)+"H"+p+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(h){var p=t.round(2*h,2),u=t.round(h,2);return"M0,-"+u+"V"+u+"M0,0L"+p+",-"+u+"V"+u+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(h){var p=t.round(2*h,2),u=t.round(h,2);return"M0,-"+u+"V"+u+"M0,0L-"+p+",-"+u+"V"+u+"Z"},needLine:!0,noDot:!0}}},{"@plotly/d3":58}],690:[function(i,B,V){B.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],691:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../registry"),p=i("../../plots/cartesian/axes"),u=i("../../lib"),e=i("./compute_error");function l(o,a,n,s){var r=a["error_"+s]||{},c=[];if(r.visible&&["linear","log"].indexOf(n.type)!==-1){for(var f=e(r),d=0;d<o.length;d++){var g=o[d],m=g.i;if(m===void 0)m=d;else if(m===null)continue;var y=g[s];if(t(n.c2l(y))){var v=f(y,m);if(t(v[0])&&t(v[1])){var T=g[s+"s"]=y-v[0],_=g[s+"h"]=y+v[1];c.push(T,_)}}}var k=n._id,E=a._extremes[k],A=p.findExtremes(n,c,u.extendFlat({tozero:E.opts.tozero},{padded:!0}));E.min=E.min.concat(A.min),E.max=E.max.concat(A.max)}}B.exports=function(o){for(var a=o.calcdata,n=0;n<a.length;n++){var s=a[n],r=s[0].trace;if(r.visible===!0&&h.traceIs(r,"errorBarsOK")){var c=p.getFromId(o,r.xaxis),f=p.getFromId(o,r.yaxis);l(s,r,c,"x"),l(s,r,f,"y")}}}},{"../../lib":803,"../../plots/cartesian/axes":854,"../../registry":931,"./compute_error":692,"fast-isnumeric":249}],692:[function(i,B,V){function t(h,p){return h==="percent"?function(u){return Math.abs(u*p/100)}:h==="constant"?function(){return Math.abs(p)}:h==="sqrt"?function(u){return Math.sqrt(Math.abs(u))}:void 0}B.exports=function(h){var p=h.type,u=h.symmetric;if(p==="data"){var e=h.array||[];if(u)return function(n,s){var r=+e[s];return[r,r]};var l=h.arrayminus||[];return function(n,s){var r=+e[s],c=+l[s];return isNaN(r)&&isNaN(c)?[NaN,NaN]:[c||0,r||0]}}var o=t(p,h.value),a=t(p,h.valueminus);return u||h.valueminus===void 0?function(n){var s=o(n);return[s,s]}:function(n){return[a(n),o(n)]}}},{}],693:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../registry"),p=i("../../lib"),u=i("../../plot_api/plot_template"),e=i("./attributes");B.exports=function(l,o,a,n){var s="error_"+n.axis,r=u.newContainer(o,s),c=l[s]||{};function f(y,v){return p.coerce(c,r,e,y,v)}if(f("visible",c.array!==void 0||c.value!==void 0||c.type==="sqrt")!==!1){var d=f("type","array"in c?"data":"percent"),g=!0;d!=="sqrt"&&(g=f("symmetric",!((d==="data"?"arrayminus":"valueminus")in c))),d==="data"?(f("array"),f("traceref"),g||(f("arrayminus"),f("tracerefminus"))):d!=="percent"&&d!=="constant"||(f("value"),g||f("valueminus"));var m="copy_"+n.inherit+"style";n.inherit&&(o["error_"+n.inherit]||{}).visible&&f(m,!(c.color||t(c.thickness)||t(c.width))),n.inherit&&r[m]||(f("color",a),f("thickness"),f("width",h.traceIs(o,"gl3d")?0:4))}}},{"../../lib":803,"../../plot_api/plot_template":843,"../../registry":931,"./attributes":690,"fast-isnumeric":249}],694:[function(i,B,V){var t=i("../../lib"),h=i("../../plot_api/edit_types").overrideAll,p=i("./attributes"),u={error_x:t.extendFlat({},p),error_y:t.extendFlat({},p)};delete u.error_x.copy_zstyle,delete u.error_y.copy_zstyle,delete u.error_y.copy_ystyle;var e={error_x:t.extendFlat({},p),error_y:t.extendFlat({},p),error_z:t.extendFlat({},p)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,B.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:u,bar:u,histogram:u,scatter3d:h(e,"calc","nested"),scattergl:h(u,"calc","nested")}},supplyDefaults:i("./defaults"),calc:i("./calc"),makeComputeError:i("./compute_error"),plot:i("./plot"),style:i("./style"),hoverInfo:function(l,o,a){(o.error_y||{}).visible&&(a.yerr=l.yh-l.y,o.error_y.symmetric||(a.yerrneg=l.y-l.ys)),(o.error_x||{}).visible&&(a.xerr=l.xh-l.x,o.error_x.symmetric||(a.xerrneg=l.x-l.xs))}}},{"../../lib":803,"../../plot_api/edit_types":836,"./attributes":690,"./calc":691,"./compute_error":692,"./defaults":693,"./plot":695,"./style":696}],695:[function(i,B,V){var t=i("@plotly/d3"),h=i("fast-isnumeric"),p=i("../drawing"),u=i("../../traces/scatter/subtypes");B.exports=function(e,l,o,a){var n=o.xaxis,s=o.yaxis,r=a&&a.duration>0;l.each(function(c){var f,d=c[0].trace,g=d.error_x||{},m=d.error_y||{};d.ids&&(f=function(_){return _.id});var y=u.hasMarkers(d)&&d.marker.maxdisplayed>0;m.visible||g.visible||(c=[]);var v=t.select(this).selectAll("g.errorbar").data(c,f);if(v.exit().remove(),c.length){g.visible||v.selectAll("path.xerror").remove(),m.visible||v.selectAll("path.yerror").remove(),v.style("opacity",1);var T=v.enter().append("g").classed("errorbar",!0);r&&T.style("opacity",0).transition().duration(a.duration).style("opacity",1),p.setClipUrl(v,o.layerClipId,e),v.each(function(_){var k=t.select(this),E=function(S,P,z){var F={x:P.c2p(S.x),y:z.c2p(S.y)};return S.yh!==void 0&&(F.yh=z.c2p(S.yh),F.ys=z.c2p(S.ys),h(F.ys)||(F.noYS=!0,F.ys=z.c2p(S.ys,!0))),S.xh!==void 0&&(F.xh=P.c2p(S.xh),F.xs=P.c2p(S.xs),h(F.xs)||(F.noXS=!0,F.xs=P.c2p(S.xs,!0))),F}(_,n,s);if(!y||_.vis){var A,b=k.select("path.yerror");if(m.visible&&h(E.x)&&h(E.yh)&&h(E.ys)){var L=m.width;A="M"+(E.x-L)+","+E.yh+"h"+2*L+"m-"+L+",0V"+E.ys,E.noYS||(A+="m-"+L+",0h"+2*L),b.size()?r&&(b=b.transition().duration(a.duration).ease(a.easing)):b=k.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),b.attr("d",A)}else b.remove();var w=k.select("path.xerror");if(g.visible&&h(E.y)&&h(E.xh)&&h(E.xs)){var C=(g.copy_ystyle?m:g).width;A="M"+E.xh+","+(E.y-C)+"v"+2*C+"m0,-"+C+"H"+E.xs,E.noXS||(A+="m0,-"+C+"v"+2*C),w.size()?r&&(w=w.transition().duration(a.duration).ease(a.easing)):w=k.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),w.attr("d",A)}else w.remove()}})}})}},{"../../traces/scatter/subtypes":1243,"../drawing":688,"@plotly/d3":58,"fast-isnumeric":249}],696:[function(i,B,V){var t=i("@plotly/d3"),h=i("../color");B.exports=function(p){p.each(function(u){var e=u[0].trace,l=e.error_y||{},o=e.error_x||{},a=t.select(this);a.selectAll("path.yerror").style("stroke-width",l.thickness+"px").call(h.stroke,l.color),o.copy_ystyle&&(o=l),a.selectAll("path.xerror").style("stroke-width",o.thickness+"px").call(h.stroke,o.color)})}},{"../color":666,"@plotly/d3":58}],697:[function(i,B,V){var t=i("../../plots/font_attributes"),h=i("./layout_attributes").hoverlabel,p=i("../../lib/extend").extendFlat;B.exports={hoverlabel:{bgcolor:p({},h.bgcolor,{arrayOk:!0}),bordercolor:p({},h.bordercolor,{arrayOk:!0}),font:t({arrayOk:!0,editType:"none"}),align:p({},h.align,{arrayOk:!0}),namelength:p({},h.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":793,"../../plots/font_attributes":883,"./layout_attributes":707}],698:[function(i,B,V){var t=i("../../lib"),h=i("../../registry");function p(u,e,l,o){o=o||t.identity,Array.isArray(u)&&(e[0][l]=o(u))}B.exports=function(u){var e=u.calcdata,l=u._fullLayout;function o(c){return function(f){return t.coerceHoverinfo({hoverinfo:f},{_module:c._module},l)}}for(var a=0;a<e.length;a++){var n=e[a],s=n[0].trace;if(!h.traceIs(s,"pie-like")){var r=h.traceIs(s,"2dMap")?p:t.fillArray;r(s.hoverinfo,n,"hi",o(s)),s.hovertemplate&&r(s.hovertemplate,n,"ht"),s.hoverlabel&&(r(s.hoverlabel.bgcolor,n,"hbg"),r(s.hoverlabel.bordercolor,n,"hbc"),r(s.hoverlabel.font.size,n,"hts"),r(s.hoverlabel.font.color,n,"htc"),r(s.hoverlabel.font.family,n,"htf"),r(s.hoverlabel.namelength,n,"hnl"),r(s.hoverlabel.align,n,"hta"))}}}},{"../../lib":803,"../../registry":931}],699:[function(i,B,V){var t=i("../../registry"),h=i("./hover").hover;B.exports=function(p,u,e){var l=t.getComponentMethod("annotations","onClick")(p,p._hoverdata);function o(){p.emit("plotly_click",{points:p._hoverdata,event:u})}e!==void 0&&h(p,u,e,!0),p._hoverdata&&u&&u.target&&(l&&l.then?l.then(o):o(),u.stopImmediatePropagation&&u.stopImmediatePropagation())}},{"../../registry":931,"./hover":703}],700:[function(i,B,V){B.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],701:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("./hoverlabel_defaults");B.exports=function(u,e,l,o){var a=t.extendFlat({},o.hoverlabel);e.hovertemplate&&(a.namelength=-1),p(u,e,function(n,s){return t.coerce(u,e,h,n,s)},a)}},{"../../lib":803,"./attributes":697,"./hoverlabel_defaults":704}],702:[function(i,B,V){var t=i("../../lib");V.getSubplot=function(o){return o.subplot||o.xaxis+o.yaxis||o.geo},V.isTraceInSubplots=function(o,a){if(o.type==="splom"){for(var n=o.xaxes||[],s=o.yaxes||[],r=0;r<n.length;r++)for(var c=0;c<s.length;c++)if(a.indexOf(n[r]+s[c])!==-1)return!0;return!1}return a.indexOf(V.getSubplot(o))!==-1},V.flat=function(o,a){for(var n=new Array(o.length),s=0;s<o.length;s++)n[s]=a;return n},V.p2c=function(o,a){for(var n=new Array(o.length),s=0;s<o.length;s++)n[s]=o[s].p2c(a);return n},V.getDistanceFunction=function(o,a,n,s){return o==="closest"?s||V.quadrature(a,n):o.charAt(0)==="x"?a:n},V.getClosest=function(o,a,n){if(n.index!==!1)n.index>=0&&n.index<o.length?n.distance=0:n.index=!1;else for(var s=0;s<o.length;s++){var r=a(o[s]);r<=n.distance&&(n.index=s,n.distance=r)}return n},V.inbox=function(o,a,n){return o*a<0||o===0?n:1/0},V.quadrature=function(o,a){return function(n){var s=o(n),r=a(n);return Math.sqrt(s*s+r*r)}},V.makeEventData=function(o,a,n){var s="index"in o?o.index:o.pointNumber,r={data:a._input,fullData:a,curveNumber:a.index,pointNumber:s};if(a._indexToPoints){var c=a._indexToPoints[s];c.length===1?r.pointIndex=c[0]:r.pointIndices=c}else r.pointIndex=s;return a._module.eventData?r=a._module.eventData(r,o,a,n,s):("xVal"in o?r.x=o.xVal:"x"in o&&(r.x=o.x),"yVal"in o?r.y=o.yVal:"y"in o&&(r.y=o.y),o.xa&&(r.xaxis=o.xa),o.ya&&(r.yaxis=o.ya),o.zLabelVal!==void 0&&(r.z=o.zLabelVal)),V.appendArrayPointValue(r,a,s),r},V.appendArrayPointValue=function(o,a,n){var s=a._arrayAttrs;if(s)for(var r=0;r<s.length;r++){var c=s[r],f=p(c);if(o[f]===void 0){var d=u(t.nestedProperty(a,c).get(),n);d!==void 0&&(o[f]=d)}}},V.appendArrayMultiPointValues=function(o,a,n){var s=a._arrayAttrs;if(s)for(var r=0;r<s.length;r++){var c=s[r],f=p(c);if(o[f]===void 0){for(var d=t.nestedProperty(a,c).get(),g=new Array(n.length),m=0;m<n.length;m++)g[m]=u(d,n[m]);o[f]=g}}};var h={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function p(o){return h[o]||o}function u(o,a){return Array.isArray(a)?Array.isArray(o)&&Array.isArray(o[a[0]])?o[a[0]][a[1]]:void 0:o[a]}var e={x:!0,y:!0},l={"x unified":!0,"y unified":!0};V.isUnifiedHover=function(o){return typeof o=="string"&&!!l[o]},V.isXYhover=function(o){return typeof o=="string"&&!!e[o]}},{"../../lib":803}],703:[function(i,B,V){var t=i("@plotly/d3"),h=i("fast-isnumeric"),p=i("tinycolor2"),u=i("../../lib"),e=u.strTranslate,l=u.strRotate,o=i("../../lib/events"),a=i("../../lib/svg_text_utils"),n=i("../../lib/override_cursor"),s=i("../drawing"),r=i("../color"),c=i("../dragelement"),f=i("../../plots/cartesian/axes"),d=i("../../registry"),g=i("./helpers"),m=i("./constants"),y=i("../legend/defaults"),v=i("../legend/draw"),T=m.YANGLE,_=Math.PI*T/180,k=1/Math.sin(_),E=Math.cos(_),A=Math.sin(_),b=m.HOVERARROWSIZE,L=m.HOVERTEXTPAD,w={box:!0,ohlc:!0,violin:!0,candlestick:!0},C={scatter:!0,scattergl:!0,splom:!0};function S(N){return[N.trace.index,N.index,N.x0,N.y0,N.name,N.attr,N.xa?N.xa._id:"",N.ya?N.ya._id:""].join(",")}V.hover=function(N,J,D,U){N=u.getGraphDiv(N),u.throttle(N._fullLayout._uid+m.HOVERID,m.HOVERMINTIME,function(){(function(G,$,K,re){K||(K="xy");var ne=Array.isArray(K)?K:[K],ae=G._fullLayout,ie=ae._plots||[],he=ie[K],se=ae._has("cartesian");if(he){var de=he.overlays.map(function(gr){return gr.id});ne=ne.concat(de)}for(var ce=ne.length,ve=new Array(ce),Ee=new Array(ce),Le=!1,Te=0;Te<ce;Te++){var xe=ne[Te];if(ie[xe])Le=!0,ve[Te]=ie[xe].xaxis,Ee[Te]=ie[xe].yaxis;else{if(!ae[xe]||!ae[xe]._subplot)return void u.warn("Unrecognized subplot: "+xe);var fe=ae[xe]._subplot;ve[Te]=fe.xaxis,Ee[Te]=fe.yaxis}}var ge=$.hovermode||ae.hovermode;if(ge&&!Le&&(ge="closest"),["x","y","closest","x unified","y unified"].indexOf(ge)===-1||!G.calcdata||G.querySelector(".zoombox")||G._dragging)return c.unhoverRaw(G,$);var ke=ae.hoverdistance;ke===-1&&(ke=1/0);var Me=ae.spikedistance;Me===-1&&(Me=1/0);var Se,De,Be,We,Qe,Oe,Ue,Xe,Ye,$e,it,ot,Et,mt=[],tt=[],Ke={hLinePoint:null,vLinePoint:null},Mt=!1;if(Array.isArray($))for(ge="array",Be=0;Be<$.length;Be++)(Qe=G.calcdata[$[Be].curveNumber||0])&&(Oe=Qe[0].trace,Qe[0].trace.hoverinfo!=="skip"&&(tt.push(Qe),Oe.orientation==="h"&&(Mt=!0)));else{for(We=0;We<G.calcdata.length;We++)Qe=G.calcdata[We],(Oe=Qe[0].trace).hoverinfo!=="skip"&&g.isTraceInSubplots(Oe,ne)&&(tt.push(Qe),Oe.orientation==="h"&&(Mt=!0));var Jt,$t;if(!$.target)Jt="xpx"in $?$.xpx:ve[0]._length/2,$t="ypx"in $?$.ypx:Ee[0]._length/2;else{if(o.triggerHandler(G,"plotly_beforehover",$)===!1)return;var je=$.composedPath&&$.composedPath()[0];je||(je=$.target);var Ge=je.getBoundingClientRect();Jt=$.clientX-Ge.left,$t=$.clientY-Ge.top,ae._calcInverseTransform(G);var Ct=u.apply3DTransform(ae._invTransform)(Jt,$t);if(Jt=Ct[0],$t=Ct[1],Jt<0||Jt>ve[0]._length||$t<0||$t>Ee[0]._length)return c.unhoverRaw(G,$)}if($.pointerX=Jt+ve[0]._offset,$.pointerY=$t+Ee[0]._offset,Se="xval"in $?g.flat(ne,$.xval):g.p2c(ve,Jt),De="yval"in $?g.flat(ne,$.yval):g.p2c(Ee,$t),!h(Se[0])||!h(De[0]))return u.warn("Fx.hover failed",$,G),c.unhoverRaw(G,$)}var Ie=1/0;function be(gr,wr){for(We=0;We<tt.length;We++)if((Qe=tt[We])&&Qe[0]&&Qe[0].trace&&(Oe=Qe[0].trace).visible===!0&&Oe._length!==0&&["carpet","contourcarpet"].indexOf(Oe._module.name)===-1){if(Oe.type==="splom"?Ue=ne[Xe=0]:(Ue=g.getSubplot(Oe),Xe=ne.indexOf(Ue)),Ye=ge,g.isUnifiedHover(Ye)&&(Ye=Ye.charAt(0)),ot={cd:Qe,trace:Oe,xa:ve[Xe],ya:Ee[Xe],maxHoverDistance:ke,maxSpikeDistance:Me,index:!1,distance:Math.min(Ie,ke),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:r.defaultLine,name:Oe.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},ae[Ue]&&(ot.subplot=ae[Ue]._subplot),ae._splomScenes&&ae._splomScenes[Oe.uid]&&(ot.scene=ae._splomScenes[Oe.uid]),Et=mt.length,Ye==="array"){var zr=$[We];"pointNumber"in zr?(ot.index=zr.pointNumber,Ye="closest"):(Ye="","xval"in zr&&($e=zr.xval,Ye="x"),"yval"in zr&&(it=zr.yval,Ye=Ye?"closest":"y"))}else gr!==void 0&&wr!==void 0?($e=gr,it=wr):($e=Se[Xe],it=De[Xe]);if(ke!==0)if(Oe._module&&Oe._module.hoverPoints){var Rr=Oe._module.hoverPoints(ot,$e,it,Ye,{finiteRange:!0,hoverLayer:ae._hoverlayer});if(Rr)for(var Wr,gn=0;gn<Rr.length;gn++)Wr=Rr[gn],h(Wr.x0)&&h(Wr.y0)&&mt.push(W(Wr,ge))}else u.log("Unrecognized trace type in hover:",Oe);if(ge==="closest"&&mt.length>Et&&(mt.splice(0,Et),Ie=mt[0].distance),se&&Me!==0&&mt.length===0){ot.distance=Me,ot.index=!1;var rn=Oe._module.hoverPoints(ot,$e,it,"closest",{hoverLayer:ae._hoverlayer});if(rn&&(rn=rn.filter(function(fn){return fn.spikeDistance<=Me})),rn&&rn.length){var Zr,bn=rn.filter(function(fn){return fn.xa.showspikes&&fn.xa.spikesnap!=="hovered data"});if(bn.length){var Dr=bn[0];h(Dr.x0)&&h(Dr.y0)&&(Zr=Pe(Dr),(!Ke.vLinePoint||Ke.vLinePoint.spikeDistance>Zr.spikeDistance)&&(Ke.vLinePoint=Zr))}var br=rn.filter(function(fn){return fn.ya.showspikes&&fn.ya.spikesnap!=="hovered data"});if(br.length){var Xr=br[0];h(Xr.x0)&&h(Xr.y0)&&(Zr=Pe(Xr),(!Ke.hLinePoint||Ke.hLinePoint.spikeDistance>Zr.spikeDistance)&&(Ke.hLinePoint=Zr))}}}}}function Ae(gr,wr,zr){for(var Rr,Wr=null,gn=1/0,rn=0;rn<gr.length;rn++)Rr=gr[rn].spikeDistance,zr&&rn===0&&(Rr=-1/0),Rr<=gn&&Rr<=wr&&(Wr=gr[rn],gn=Rr);return Wr}function Pe(gr){return gr?{xa:gr.xa,ya:gr.ya,x:gr.xSpike!==void 0?gr.xSpike:(gr.x0+gr.x1)/2,y:gr.ySpike!==void 0?gr.ySpike:(gr.y0+gr.y1)/2,distance:gr.distance,spikeDistance:gr.spikeDistance,curveNumber:gr.trace.index,color:gr.color,pointNumber:gr.index}:null}be();var ze={fullLayout:ae,container:ae._hoverlayer,outerContainer:ae._paperdiv,event:$},qe=G._spikepoints,ht={vLinePoint:Ke.vLinePoint,hLinePoint:Ke.hLinePoint};G._spikepoints=ht;var at=function(){mt.sort(function(gr,wr){return gr.distance-wr.distance}),mt=function(gr,wr){for(var zr=wr.charAt(0),Rr=[],Wr=[],gn=[],rn=0;rn<gr.length;rn++){var Zr=gr[rn];d.traceIs(Zr.trace,"bar-like")||d.traceIs(Zr.trace,"box-violin")?gn.push(Zr):Zr.trace[zr+"period"]?Wr.push(Zr):Rr.push(Zr)}return Rr.concat(Wr).concat(gn)}(mt,ge)};at();var nt=ge.charAt(0),xt=(nt==="x"||nt==="y")&&mt[0]&&C[mt[0].trace.type];if(se&&Me!==0&&mt.length!==0){var Lt=Ae(mt.filter(function(gr){return gr.ya.showspikes}),Me,xt);Ke.hLinePoint=Pe(Lt);var bt=Ae(mt.filter(function(gr){return gr.xa.showspikes}),Me,xt);Ke.vLinePoint=Pe(bt)}if(mt.length===0){var St=c.unhoverRaw(G,$);return!se||Ke.hLinePoint===null&&Ke.vLinePoint===null||Q(qe)&&X(G,Ke,ze),St}if(se&&Q(qe)&&X(G,Ke,ze),g.isXYhover(Ye)&&mt[0].length!==0&&mt[0].trace.type!=="splom"){var st=mt[0],It=(mt=w[st.trace.type]?mt.filter(function(gr){return gr.trace.index===st.trace.index}):[st]).length,jt=Y("x",st,ae),Ut=Y("y",st,ae);be(jt,Ut);var zt,Ce=[],lt={},At=0,Bt=function(gr){var wr=w[gr.trace.type]?S(gr):gr.trace.index;if(lt[wr]){var zr=lt[wr]-1,Rr=Ce[zr];zr>0&&Math.abs(gr.distance)<Math.abs(Rr.distance)&&(Ce[zr]=gr)}else At++,lt[wr]=At,Ce.push(gr)};for(zt=0;zt<It;zt++)Bt(mt[zt]);for(zt=mt.length-1;zt>It-1;zt--)Bt(mt[zt]);mt=Ce,at()}var Ht=G._hoverdata,or=[];for(Be=0;Be<mt.length;Be++){var ar=mt[Be],Nt=g.makeEventData(ar,ar.trace,ar.cd);if(ar.hovertemplate!==!1){var nr=!1;ar.cd[ar.index]&&ar.cd[ar.index].ht&&(nr=ar.cd[ar.index].ht),ar.hovertemplate=nr||ar.trace.hovertemplate||!1}ar.eventData=[Nt],or.push(Nt)}G._hoverdata=or;var Lr=ge==="y"&&(tt.length>1||mt.length>1)||ge==="closest"&&Mt&&mt.length>1,dr=r.combine(ae.plot_bgcolor||r.background,ae.paper_bgcolor),Kt={hovermode:ge,rotateLabels:Lr,bgColor:dr,container:ae._hoverlayer,outerContainer:ae._paperdiv,commonLabelOpts:ae.hoverlabel,hoverdistance:ae.hoverdistance},yr=z(mt,Kt,G);if(g.isUnifiedHover(ge)||(function(gr,wr,zr){var Rr,Wr,gn,rn,Zr,bn,Dr,br=0,Xr=1,fn=gr.size(),Qr=new Array(fn),un=0;function Pn(Mr){var Vr=Mr[0],kr=Mr[Mr.length-1];if(Wr=Vr.pmin-Vr.pos-Vr.dp+Vr.size,gn=kr.pos+kr.dp+kr.size-Vr.pmax,Wr>.01){for(Zr=Mr.length-1;Zr>=0;Zr--)Mr[Zr].dp+=Wr;Rr=!1}if(!(gn<.01)){if(Wr<-.01){for(Zr=Mr.length-1;Zr>=0;Zr--)Mr[Zr].dp-=gn;Rr=!1}if(Rr){var ur=0;for(rn=0;rn<Mr.length;rn++)(bn=Mr[rn]).pos+bn.dp+bn.size>Vr.pmax&&ur++;for(rn=Mr.length-1;rn>=0&&!(ur<=0);rn--)(bn=Mr[rn]).pos>Vr.pmax-1&&(bn.del=!0,ur--);for(rn=0;rn<Mr.length&&!(ur<=0);rn++)if((bn=Mr[rn]).pos<Vr.pmin+1)for(bn.del=!0,ur--,gn=2*bn.size,Zr=Mr.length-1;Zr>=0;Zr--)Mr[Zr].dp-=gn;for(rn=Mr.length-1;rn>=0&&!(ur<=0);rn--)(bn=Mr[rn]).pos+bn.dp+bn.size>Vr.pmax&&(bn.del=!0,ur--)}}}for(gr.each(function(Mr){var Vr=Mr[wr],kr=Vr._id.charAt(0)==="x",ur=Vr.range;un===0&&ur&&ur[0]>ur[1]!==kr&&(Xr=-1),Qr[un++]=[{datum:Mr,traceIndex:Mr.trace.index,dp:0,pos:Mr.pos,posref:Mr.posref,size:Mr.by*(kr?k:1)/2,pmin:0,pmax:kr?zr.width:zr.height}]}),Qr.sort(function(Mr,Vr){return Mr[0].posref-Vr[0].posref||Xr*(Vr[0].traceIndex-Mr[0].traceIndex)});!Rr&&br<=fn;){for(br++,Rr=!0,rn=0;rn<Qr.length-1;){var kn=Qr[rn],Hn=Qr[rn+1],aa=kn[kn.length-1],gt=Hn[0];if((Wr=aa.pos+aa.dp+aa.size-gt.pos-gt.dp+gt.size)>.01&&aa.pmin===gt.pmin&&aa.pmax===gt.pmax){for(Zr=Hn.length-1;Zr>=0;Zr--)Hn[Zr].dp+=Wr;for(kn.push.apply(kn,Hn),Qr.splice(rn+1,1),Dr=0,Zr=kn.length-1;Zr>=0;Zr--)Dr+=kn[Zr].dp;for(gn=Dr/kn.length,Zr=kn.length-1;Zr>=0;Zr--)kn[Zr].dp-=gn;Rr=!1}else rn++}Qr.forEach(Pn)}for(rn=Qr.length-1;rn>=0;rn--){var Qt=Qr[rn];for(Zr=Qt.length-1;Zr>=0;Zr--){var Zt=Qt[Zr],pr=Zt.datum;pr.offset=Zt.dp,pr.del=Zt.del}}}(yr,Lr?"xa":"ya",ae),q(yr,Lr,ae._invScaleX,ae._invScaleY)),$.target&&$.target.tagName){var xr=d.getComponentMethod("annotations","hasClickToShow")(G,or);n(t.select($.target),xr?"pointer":"")}!$.target||re||!function(gr,wr,zr){if(!zr||zr.length!==gr._hoverdata.length)return!0;for(var Rr=zr.length-1;Rr>=0;Rr--){var Wr=zr[Rr],gn=gr._hoverdata[Rr];if(Wr.curveNumber!==gn.curveNumber||String(Wr.pointNumber)!==String(gn.pointNumber)||String(Wr.pointNumbers)!==String(gn.pointNumbers))return!0}return!1}(G,0,Ht)||(Ht&&G.emit("plotly_unhover",{event:$,points:Ht}),G.emit("plotly_hover",{event:$,points:G._hoverdata,xaxes:ve,yaxes:Ee,xvals:Se,yvals:De}))})(N,J,D,U)})},V.loneHover=function(N,J){var D=!0;Array.isArray(N)||(D=!1,N=[N]);var U=N.map(function(se){return{color:se.color||r.defaultLine,x0:se.x0||se.x||0,x1:se.x1||se.x||0,y0:se.y0||se.y||0,y1:se.y1||se.y||0,xLabel:se.xLabel,yLabel:se.yLabel,zLabel:se.zLabel,text:se.text,name:se.name,idealAlign:se.idealAlign,borderColor:se.borderColor,fontFamily:se.fontFamily,fontSize:se.fontSize,fontColor:se.fontColor,nameLength:se.nameLength,textAlign:se.textAlign,trace:se.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:se.hovertemplate||!1,eventData:se.eventData||!1,hovertemplateLabels:se.hovertemplateLabels||!1}}),G=t.select(J.container),$=J.outerContainer?t.select(J.outerContainer):G,K={hovermode:"closest",rotateLabels:!1,bgColor:J.bgColor||r.background,container:G,outerContainer:$},re=z(U,K,J.gd),ne=0,ae=0;re.sort(function(se,de){return se.y0-de.y0}).each(function(se,de){var ce=se.y0-se.by/2;se.offset=ce-5<ne?ne-ce+5:0,ne=ce+se.by+se.offset,de===J.anchorIndex&&(ae=se.offset)}).each(function(se){se.offset-=ae});var ie=J.gd._fullLayout._invScaleX,he=J.gd._fullLayout._invScaleY;return q(re,K.rotateLabels,ie,he),D?re:re.node()};var P=/<extra>([\s\S]*)<\/extra>/;function z(N,J,D){var U=D._fullLayout,G=J.hovermode,$=J.rotateLabels,K=J.bgColor,re=J.container,ne=J.outerContainer,ae=J.commonLabelOpts||{},ie=J.fontFamily||m.HOVERFONT,he=J.fontSize||m.HOVERFONTSIZE,se=N[0],de=se.xa,ce=se.ya,ve=G.charAt(0),Ee=se[ve+"Label"],Le=ne.node().getBoundingClientRect(),Te=Le.top,xe=Le.width,fe=Le.height,ge=Ee!==void 0&&se.distance<=J.hoverdistance&&(G==="x"||G==="y");if(ge){var ke,Me,Se=!0;for(ke=0;ke<N.length;ke++)if(Se&&N[ke].zLabel===void 0&&(Se=!1),Me=N[ke].hoverinfo||N[ke].trace.hoverinfo){var De=Array.isArray(Me)?Me:Me.split("+");if(De.indexOf("all")===-1&&De.indexOf(G)===-1){ge=!1;break}}Se&&(ge=!1)}var Be=re.selectAll("g.axistext").data(ge?[0]:[]);if(Be.enter().append("g").classed("axistext",!0),Be.exit().remove(),Be.each(function(){var at=t.select(this),nt=u.ensureSingle(at,"path","",function(dr){dr.style({"stroke-width":"1px"})}),xt=u.ensureSingle(at,"text","",function(dr){dr.attr("data-notex",1)}),Lt=ae.bgcolor||r.defaultLine,bt=ae.bordercolor||r.contrast(Lt),St=r.contrast(Lt),st={family:ae.font.family||ie,size:ae.font.size||he,color:ae.font.color||St};nt.style({fill:Lt,stroke:bt}),xt.text(Ee).call(s.font,st).call(a.positionText,0,0).call(a.convertToTspans,D),at.attr("transform","");var It,jt,Ut=xt.node().getBoundingClientRect();if(G==="x"){var zt=de.side==="top"?"-":"";xt.attr("text-anchor","middle").call(a.positionText,0,de.side==="top"?Te-Ut.bottom-b-L:Te-Ut.top+b+L),It=de._offset+(se.x0+se.x1)/2,jt=ce._offset+(de.side==="top"?0:ce._length);var Ce=Ut.width/2+L;It<Ce?(It=Ce,nt.attr("d","M-"+(Ce-b)+",0L-"+(Ce-2*b)+","+zt+b+"H"+(L+Ut.width/2)+"v"+zt+(2*L+Ut.height)+"H-"+Ce+"V"+zt+b+"Z")):It>U.width-Ce?(It=U.width-Ce,nt.attr("d","M"+(Ce-b)+",0L"+Ce+","+zt+b+"v"+zt+(2*L+Ut.height)+"H-"+Ce+"V"+zt+b+"H"+(Ce-2*b)+"Z")):nt.attr("d","M0,0L"+b+","+zt+b+"H"+(L+Ut.width/2)+"v"+zt+(2*L+Ut.height)+"H-"+(L+Ut.width/2)+"V"+zt+b+"H-"+b+"Z")}else{var lt,At,Bt;ce.side==="right"?(lt="start",At=1,Bt="",It=de._offset+de._length):(lt="end",At=-1,Bt="-",It=de._offset),jt=ce._offset+(se.y0+se.y1)/2,xt.attr("text-anchor",lt),nt.attr("d","M0,0L"+Bt+b+","+b+"V"+(L+Ut.height/2)+"h"+Bt+(2*L+Ut.width)+"V-"+(L+Ut.height/2)+"H"+Bt+b+"V-"+b+"Z");var Ht,or=Ut.height/2,ar=Te-Ut.top-or,Nt="clip"+U._uid+"commonlabel"+ce._id;if(It<Ut.width+2*L+b){Ht="M-"+(b+L)+"-"+or+"h-"+(Ut.width-L)+"V"+or+"h"+(Ut.width-L)+"Z";var nr=Ut.width-It+L;a.positionText(xt,nr,ar),lt==="end"&&xt.selectAll("tspan").each(function(){var dr=t.select(this),Kt=s.tester.append("text").text(dr.text()).call(s.font,st),yr=Kt.node().getBoundingClientRect();Math.round(yr.width)<Math.round(Ut.width)&&dr.attr("x",nr-yr.width),Kt.remove()})}else a.positionText(xt,At*(L+b),ar),Ht=null;var Lr=U._topclips.selectAll("#"+Nt).data(Ht?[0]:[]);Lr.enter().append("clipPath").attr("id",Nt).append("path"),Lr.exit().remove(),Lr.select("path").attr("d",Ht),s.setClipUrl(xt,Ht?Nt:null,D)}at.attr("transform",e(It,jt))}),g.isUnifiedHover(G)){if(re.selectAll("g.hovertext").remove(),N.length===0)return;var We={showlegend:!0,legend:{title:{text:Ee,font:U.hoverlabel.font},font:U.hoverlabel.font,bgcolor:U.hoverlabel.bgcolor,bordercolor:U.hoverlabel.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:U.legend?U.legend.traceorder:void 0,orientation:"v"}},Qe={};y(We,Qe,D._fullData);var Oe=Qe.legend;Oe.entries=[];for(var Ue=0;Ue<N.length;Ue++){var Xe=F(N[Ue],!0,G,U,Ee),Ye=Xe[0],$e=Xe[1],it=N[Ue];it.name=$e,it.text=$e!==""?$e+" : "+Ye:Ye;var ot=it.cd[it.index];ot&&(ot.mc&&(it.mc=ot.mc),ot.mcc&&(it.mc=ot.mcc),ot.mlc&&(it.mlc=ot.mlc),ot.mlcc&&(it.mlc=ot.mlcc),ot.mlw&&(it.mlw=ot.mlw),ot.mrc&&(it.mrc=ot.mrc),ot.dir&&(it.dir=ot.dir)),it._distinct=!0,Oe.entries.push([it])}Oe.entries.sort(function(at,nt){return at[0].trace.index-nt[0].trace.index}),Oe.layer=re,Oe._inHover=!0,v(D,Oe);var Et,mt,tt,Ke,Mt=re.select("g.legend"),Jt=Mt.node().getBoundingClientRect(),$t=Jt.width+2*L,je=Jt.height+2*L,Ge=N[0],Ct=(Ge.x0+Ge.x1)/2,Ie=(Ge.y0+Ge.y1)/2,be=!(d.traceIs(Ge.trace,"bar-like")||d.traceIs(Ge.trace,"box-violin"));ve==="y"?be?(mt=Ie-L,Et=Ie+L):(mt=Math.min.apply(null,N.map(function(at){return Math.min(at.y0,at.y1)})),Et=Math.max.apply(null,N.map(function(at){return Math.max(at.y0,at.y1)}))):mt=Et=u.mean(N.map(function(at){return(at.y0+at.y1)/2}))-je/2,ve==="x"?be?(tt=Ct+L,Ke=Ct-L):(tt=Math.max.apply(null,N.map(function(at){return Math.max(at.x0,at.x1)})),Ke=Math.min.apply(null,N.map(function(at){return Math.min(at.x0,at.x1)}))):tt=Ke=u.mean(N.map(function(at){return(at.x0+at.x1)/2}))-$t/2;var Ae,Pe,ze=de._offset,qe=ce._offset;return Ke+=ze-$t,mt+=qe-je,Ae=(tt+=ze)+$t<xe&&tt>=0?tt:Ke+$t<xe&&Ke>=0?Ke:ze+$t<xe?ze:tt-Ct<Ct-Ke+$t?xe-$t:0,Ae+=L,Pe=(Et+=qe)+je<fe&&Et>=0?Et:mt+je<fe&&mt>=0?mt:qe+je<fe?qe:Et-Ie<Ie-mt+je?fe-je:0,Pe+=L,Mt.attr("transform",e(Ae-1,Pe-1)),Mt}var ht=re.selectAll("g.hovertext").data(N,function(at){return S(at)});return ht.enter().append("g").classed("hovertext",!0).each(function(){var at=t.select(this);at.append("rect").call(r.fill,r.addOpacity(K,.8)),at.append("text").classed("name",!0),at.append("path").style("stroke-width","1px"),at.append("text").classed("nums",!0).call(s.font,ie,he)}),ht.exit().remove(),ht.each(function(at){var nt=t.select(this).attr("transform",""),xt=at.color;Array.isArray(xt)&&(xt=xt[at.eventData[0].pointNumber]);var Lt=at.bgcolor||xt,bt=r.combine(r.opacity(Lt)?Lt:r.defaultLine,K),St=r.combine(r.opacity(xt)?xt:r.defaultLine,K),st=at.borderColor||r.contrast(bt),It=F(at,ge,G,U,Ee,nt),jt=It[0],Ut=It[1],zt=nt.select("text.nums").call(s.font,at.fontFamily||ie,at.fontSize||he,at.fontColor||st).text(jt).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,D),Ce=nt.select("text.name"),lt=0,At=0;if(Ut&&Ut!==jt){Ce.call(s.font,at.fontFamily||ie,at.fontSize||he,St).text(Ut).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,D);var Bt=Ce.node().getBoundingClientRect();lt=Bt.width+2*L,At=Bt.height+2*L}else Ce.remove(),nt.select("rect").remove();nt.select("path").style({fill:bt,stroke:st});var Ht,or,ar=zt.node().getBoundingClientRect(),Nt=at.xa._offset+(at.x0+at.x1)/2,nr=at.ya._offset+(at.y0+at.y1)/2,Lr=Math.abs(at.x1-at.x0),dr=Math.abs(at.y1-at.y0),Kt=ar.width+b+L+lt;if(at.ty0=Te-ar.top,at.bx=ar.width+2*L,at.by=Math.max(ar.height+2*L,At),at.anchor="start",at.txwidth=ar.width,at.tx2width=lt,at.offset=0,$)at.pos=Nt,Ht=nr+dr/2+Kt<=fe,or=nr-dr/2-Kt>=0,at.idealAlign!=="top"&&Ht||!or?Ht?(nr+=dr/2,at.anchor="start"):at.anchor="middle":(nr-=dr/2,at.anchor="end");else if(at.pos=nr,Ht=Nt+Lr/2+Kt<=xe,or=Nt-Lr/2-Kt>=0,at.idealAlign!=="left"&&Ht||!or)if(Ht)Nt+=Lr/2,at.anchor="start";else{at.anchor="middle";var yr=Kt/2,xr=Nt+yr-xe,gr=Nt-yr;xr>0&&(Nt-=xr),gr<0&&(Nt+=-gr)}else Nt-=Lr/2,at.anchor="end";zt.attr("text-anchor",at.anchor),lt&&Ce.attr("text-anchor",at.anchor),nt.attr("transform",e(Nt,nr)+($?l(T):""))}),ht}function F(N,J,D,U,G,$){var K="",re="";N.nameOverride!==void 0&&(N.name=N.nameOverride),N.name&&(N.trace._meta&&(N.name=u.templateString(N.name,N.trace._meta)),K=Z(N.name,N.nameLength));var ne=D.charAt(0),ae=ne==="x"?"y":"x";N.zLabel!==void 0?(N.xLabel!==void 0&&(re+="x: "+N.xLabel+"<br>"),N.yLabel!==void 0&&(re+="y: "+N.yLabel+"<br>"),N.trace.type!=="choropleth"&&N.trace.type!=="choroplethmapbox"&&(re+=(re?"z: ":"")+N.zLabel)):J&&N[ne+"Label"]===G?re=N[ae+"Label"]||"":N.xLabel===void 0?N.yLabel!==void 0&&N.trace.type!=="scattercarpet"&&(re=N.yLabel):re=N.yLabel===void 0?N.xLabel:"("+N.xLabel+", "+N.yLabel+")",!N.text&&N.text!==0||Array.isArray(N.text)||(re+=(re?"<br>":"")+N.text),N.extraText!==void 0&&(re+=(re?"<br>":"")+N.extraText),$&&re===""&&!N.hovertemplate&&(K===""&&$.remove(),re=K);var ie=N.hovertemplate||!1;if(ie){var he=N.hovertemplateLabels||N;N[ne+"Label"]!==G&&(he[ne+"other"]=he[ne+"Val"],he[ne+"otherLabel"]=he[ne+"Label"]),re=(re=u.hovertemplateString(ie,he,U._d3locale,N.eventData[0]||{},N.trace._meta)).replace(P,function(se,de){return K=Z(de,N.nameLength),""})}return[re,K]}function q(N,J,D,U){var G=function(K){return K*D},$=function(K){return K*U};N.each(function(K){var re=t.select(this);if(K.del)return re.remove();var ne=re.select("text.nums"),ae=K.anchor,ie=ae==="end"?-1:1,he={start:1,end:-1,middle:0}[ae],se=he*(b+L),de=se+he*(K.txwidth+L),ce=0,ve=K.offset,Ee=ae==="middle";Ee&&(se-=K.tx2width/2,de+=K.txwidth/2+L),J&&(ve*=-A,ce=K.offset*E),re.select("path").attr("d",Ee?"M-"+G(K.bx/2+K.tx2width/2)+","+$(ve-K.by/2)+"h"+G(K.bx)+"v"+$(K.by)+"h-"+G(K.bx)+"Z":"M0,0L"+G(ie*b+ce)+","+$(b+ve)+"v"+$(K.by/2-b)+"h"+G(ie*K.bx)+"v-"+$(K.by)+"H"+G(ie*b+ce)+"V"+$(ve-b)+"Z");var Le=ce+se,Te=ve+K.ty0-K.by/2+L,xe=K.textAlign||"auto";xe!=="auto"&&(xe==="left"&&ae!=="start"?(ne.attr("text-anchor","start"),Le=Ee?-K.bx/2-K.tx2width/2+L:-K.bx-L):xe==="right"&&ae!=="end"&&(ne.attr("text-anchor","end"),Le=Ee?K.bx/2-K.tx2width/2-L:K.bx+L)),ne.call(a.positionText,G(Le),$(Te)),K.tx2width&&(re.select("text.name").call(a.positionText,G(de+he*L+ce),$(ve+K.ty0-K.by/2+L)),re.select("rect").call(s.setRect,G(de+(he-1)*K.tx2width/2+ce),$(ve-K.by/2-1),G(K.tx2width),$(K.by+2)))})}function W(N,J){var D=N.index,U=N.trace||{},G=N.cd[0],$=N.cd[D]||{};function K(se){return se||h(se)&&se===0}var re=Array.isArray(D)?function(se,de){var ce=u.castOption(G,D,se);return K(ce)?ce:u.extractOption({},U,"",de)}:function(se,de){return u.extractOption($,U,se,de)};function ne(se,de,ce){var ve=re(de,ce);K(ve)&&(N[se]=ve)}if(ne("hoverinfo","hi","hoverinfo"),ne("bgcolor","hbg","hoverlabel.bgcolor"),ne("borderColor","hbc","hoverlabel.bordercolor"),ne("fontFamily","htf","hoverlabel.font.family"),ne("fontSize","hts","hoverlabel.font.size"),ne("fontColor","htc","hoverlabel.font.color"),ne("nameLength","hnl","hoverlabel.namelength"),ne("textAlign","hta","hoverlabel.align"),N.posref=J==="y"||J==="closest"&&U.orientation==="h"?N.xa._offset+(N.x0+N.x1)/2:N.ya._offset+(N.y0+N.y1)/2,N.x0=u.constrain(N.x0,0,N.xa._length),N.x1=u.constrain(N.x1,0,N.xa._length),N.y0=u.constrain(N.y0,0,N.ya._length),N.y1=u.constrain(N.y1,0,N.ya._length),N.xLabelVal!==void 0&&(N.xLabel="xLabel"in N?N.xLabel:f.hoverLabelText(N.xa,N.xLabelVal,U.xhoverformat),N.xVal=N.xa.c2d(N.xLabelVal)),N.yLabelVal!==void 0&&(N.yLabel="yLabel"in N?N.yLabel:f.hoverLabelText(N.ya,N.yLabelVal,U.yhoverformat),N.yVal=N.ya.c2d(N.yLabelVal)),N.zLabelVal!==void 0&&N.zLabel===void 0&&(N.zLabel=String(N.zLabelVal)),!(isNaN(N.xerr)||N.xa.type==="log"&&N.xerr<=0)){var ae=f.tickText(N.xa,N.xa.c2l(N.xerr),"hover").text;N.xerrneg!==void 0?N.xLabel+=" +"+ae+" / -"+f.tickText(N.xa,N.xa.c2l(N.xerrneg),"hover").text:N.xLabel+=" ± "+ae,J==="x"&&(N.distance+=1)}if(!(isNaN(N.yerr)||N.ya.type==="log"&&N.yerr<=0)){var ie=f.tickText(N.ya,N.ya.c2l(N.yerr),"hover").text;N.yerrneg!==void 0?N.yLabel+=" +"+ie+" / -"+f.tickText(N.ya,N.ya.c2l(N.yerrneg),"hover").text:N.yLabel+=" ± "+ie,J==="y"&&(N.distance+=1)}var he=N.hoverinfo||N.trace.hoverinfo;return he&&he!=="all"&&((he=Array.isArray(he)?he:he.split("+")).indexOf("x")===-1&&(N.xLabel=void 0),he.indexOf("y")===-1&&(N.yLabel=void 0),he.indexOf("z")===-1&&(N.zLabel=void 0),he.indexOf("text")===-1&&(N.text=void 0),he.indexOf("name")===-1&&(N.name=void 0)),N}function X(N,J,D){var U,G,$=D.container,K=D.fullLayout,re=K._size,ne=D.event,ae=!!J.hLinePoint,ie=!!J.vLinePoint;if($.selectAll(".spikeline").remove(),ie||ae){var he=r.combine(K.plot_bgcolor,K.paper_bgcolor);if(ae){var se,de,ce=J.hLinePoint;U=ce&&ce.xa,(G=ce&&ce.ya).spikesnap==="cursor"?(se=ne.pointerX,de=ne.pointerY):(se=U._offset+ce.x,de=G._offset+ce.y);var ve,Ee,Le=p.readability(ce.color,he)<1.5?r.contrast(he):ce.color,Te=G.spikemode,xe=G.spikethickness,fe=G.spikecolor||Le,ge=f.getPxPosition(N,G);if(Te.indexOf("toaxis")!==-1||Te.indexOf("across")!==-1){if(Te.indexOf("toaxis")!==-1&&(ve=ge,Ee=se),Te.indexOf("across")!==-1){var ke=G._counterDomainMin,Me=G._counterDomainMax;G.anchor==="free"&&(ke=Math.min(ke,G.position),Me=Math.max(Me,G.position)),ve=re.l+ke*re.w,Ee=re.l+Me*re.w}$.insert("line",":first-child").attr({x1:ve,x2:Ee,y1:de,y2:de,"stroke-width":xe,stroke:fe,"stroke-dasharray":s.dashStyle(G.spikedash,xe)}).classed("spikeline",!0).classed("crisp",!0),$.insert("line",":first-child").attr({x1:ve,x2:Ee,y1:de,y2:de,"stroke-width":xe+2,stroke:he}).classed("spikeline",!0).classed("crisp",!0)}Te.indexOf("marker")!==-1&&$.insert("circle",":first-child").attr({cx:ge+(G.side!=="right"?xe:-xe),cy:de,r:xe,fill:fe}).classed("spikeline",!0)}if(ie){var Se,De,Be=J.vLinePoint;U=Be&&Be.xa,G=Be&&Be.ya,U.spikesnap==="cursor"?(Se=ne.pointerX,De=ne.pointerY):(Se=U._offset+Be.x,De=G._offset+Be.y);var We,Qe,Oe=p.readability(Be.color,he)<1.5?r.contrast(he):Be.color,Ue=U.spikemode,Xe=U.spikethickness,Ye=U.spikecolor||Oe,$e=f.getPxPosition(N,U);if(Ue.indexOf("toaxis")!==-1||Ue.indexOf("across")!==-1){if(Ue.indexOf("toaxis")!==-1&&(We=$e,Qe=De),Ue.indexOf("across")!==-1){var it=U._counterDomainMin,ot=U._counterDomainMax;U.anchor==="free"&&(it=Math.min(it,U.position),ot=Math.max(ot,U.position)),We=re.t+(1-ot)*re.h,Qe=re.t+(1-it)*re.h}$.insert("line",":first-child").attr({x1:Se,x2:Se,y1:We,y2:Qe,"stroke-width":Xe,stroke:Ye,"stroke-dasharray":s.dashStyle(U.spikedash,Xe)}).classed("spikeline",!0).classed("crisp",!0),$.insert("line",":first-child").attr({x1:Se,x2:Se,y1:We,y2:Qe,"stroke-width":Xe+2,stroke:he}).classed("spikeline",!0).classed("crisp",!0)}Ue.indexOf("marker")!==-1&&$.insert("circle",":first-child").attr({cx:Se,cy:$e-(U.side!=="top"?Xe:-Xe),r:Xe,fill:Ye}).classed("spikeline",!0)}}}function Q(N,J){return!J||J.vLinePoint!==N._spikepoints.vLinePoint||J.hLinePoint!==N._spikepoints.hLinePoint}function Z(N,J){return a.plainText(N||"",{len:J,allowedTags:["br","sub","sup","b","i","em"]})}function Y(N,J,D){var U=J[N+"a"],G=J[N+"Val"],$=J.cd[0];if(U.type==="category")G=U._categoriesMap[G];else if(U.type==="date"){var K=J.trace[N+"periodalignment"];if(K){var re=J.cd[J.index],ne=re[N+"Start"];ne===void 0&&(ne=re[N]);var ae=re[N+"End"];ae===void 0&&(ae=re[N]);var ie=ae-ne;K==="end"?G+=ie:K==="middle"&&(G+=ie/2)}G=U.d2c(G)}return $&&$.t&&$.t.posLetter===U._id&&(D.boxmode!=="group"&&D.violinmode!=="group"||(G+=$.t.dPos)),G}},{"../../lib":803,"../../lib/events":792,"../../lib/override_cursor":814,"../../lib/svg_text_utils":829,"../../plots/cartesian/axes":854,"../../registry":931,"../color":666,"../dragelement":685,"../drawing":688,"../legend/defaults":718,"../legend/draw":719,"./constants":700,"./helpers":702,"@plotly/d3":58,"fast-isnumeric":249,tinycolor2:598}],704:[function(i,B,V){var t=i("../../lib"),h=i("../color"),p=i("./helpers").isUnifiedHover;B.exports=function(u,e,l,o){function a(n){o.font[n]||(o.font[n]=e.legend?e.legend.font[n]:e.font[n])}o=o||{},e&&p(e.hovermode)&&(o.font||(o.font={}),a("size"),a("family"),a("color"),e.legend?(o.bgcolor||(o.bgcolor=h.combine(e.legend.bgcolor,e.paper_bgcolor)),o.bordercolor||(o.bordercolor=e.legend.bordercolor)):o.bgcolor||(o.bgcolor=e.paper_bgcolor)),l("hoverlabel.bgcolor",o.bgcolor),l("hoverlabel.bordercolor",o.bordercolor),l("hoverlabel.namelength",o.namelength),t.coerceFont(l,"hoverlabel.font",o.font),l("hoverlabel.align",o.align)}},{"../../lib":803,"../color":666,"./helpers":702}],705:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes");B.exports=function(p,u){function e(l,o){return u[l]!==void 0?u[l]:t.coerce(p,u,h,l,o)}return e("clickmode"),e("hovermode")}},{"../../lib":803,"./layout_attributes":707}],706:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../dragelement"),u=i("./helpers"),e=i("./layout_attributes"),l=i("./hover");B.exports={moduleType:"component",name:"fx",constants:i("./constants"),schema:{layout:e},attributes:i("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:i("./layout_global_defaults"),supplyDefaults:i("./defaults"),supplyLayoutDefaults:i("./layout_defaults"),calc:i("./calc"),getDistanceFunction:u.getDistanceFunction,getClosest:u.getClosest,inbox:u.inbox,quadrature:u.quadrature,appendArrayPointValue:u.appendArrayPointValue,castHoverOption:function(o,a,n){return h.castOption(o,a,"hoverlabel."+n)},castHoverinfo:function(o,a,n){return h.castOption(o,n,"hoverinfo",function(s){return h.coerceHoverinfo({hoverinfo:s},{_module:o._module},a)})},hover:l.hover,unhover:p.unhover,loneHover:l.loneHover,loneUnhover:function(o){var a=h.isD3Selection(o)?o:t.select(o);a.selectAll("g.hovertext").remove(),a.selectAll(".spikeline").remove()},click:i("./click")}},{"../../lib":803,"../dragelement":685,"./attributes":697,"./calc":698,"./click":699,"./constants":700,"./defaults":701,"./helpers":702,"./hover":703,"./layout_attributes":707,"./layout_defaults":708,"./layout_global_defaults":709,"@plotly/d3":58}],707:[function(i,B,V){var t=i("./constants"),h=i("../../plots/font_attributes")({editType:"none"});h.family.dflt=t.HOVERFONT,h.size.dflt=t.HOVERFONTSIZE,B.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:h,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":883,"./constants":700}],708:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes"),p=i("./hovermode_defaults"),u=i("./hoverlabel_defaults");B.exports=function(e,l){function o(r,c){return t.coerce(e,l,h,r,c)}p(e,l)&&(o("hoverdistance"),o("spikedistance")),o("dragmode")==="select"&&o("selectdirection");var a=l._has("mapbox"),n=l._has("geo"),s=l._basePlotModules.length;l.dragmode==="zoom"&&((a||n)&&s===1||a&&n&&s===2)&&(l.dragmode="pan"),u(e,l,o)}},{"../../lib":803,"./hoverlabel_defaults":704,"./hovermode_defaults":705,"./layout_attributes":707}],709:[function(i,B,V){var t=i("../../lib"),h=i("./hoverlabel_defaults"),p=i("./layout_attributes");B.exports=function(u,e){h(u,e,function(l,o){return t.coerce(u,e,p,l,o)})}},{"../../lib":803,"./hoverlabel_defaults":704,"./layout_attributes":707}],710:[function(i,B,V){var t=i("../../lib"),h=i("../../lib/regex").counter,p=i("../../plots/domain").attributes,u=i("../../plots/cartesian/constants").idRegex,e=i("../../plot_api/plot_template"),l={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[h("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[u.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[u.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:p({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function o(s,r,c){var f=r[c+"axes"],d=Object.keys((s._splomAxes||{})[c]||{});return Array.isArray(f)?f:d.length?d:void 0}function a(s,r,c,f,d,g){var m=r(s+"gap",c),y=r("domain."+s);r(s+"side",f);for(var v=new Array(d),T=y[0],_=(y[1]-T)/(d-m),k=_*(1-m),E=0;E<d;E++){var A=T+_*E;v[g?d-1-E:E]=[A,A+k]}return v}function n(s,r,c,f,d){var g,m=new Array(c);function y(v,T){r.indexOf(T)!==-1&&f[T]===void 0?(m[v]=T,f[T]=v):m[v]=""}if(Array.isArray(s))for(g=0;g<c;g++)y(g,s[g]);else for(y(0,d),g=1;g<c;g++)y(g,d+(g+1));return m}B.exports={moduleType:"component",name:"grid",schema:{layout:{grid:l}},layoutAttributes:l,sizeDefaults:function(s,r){var c=s.grid||{},f=o(r,c,"x"),d=o(r,c,"y");if(s.grid||f||d){var g,m,y=Array.isArray(c.subplots)&&Array.isArray(c.subplots[0]),v=Array.isArray(f),T=Array.isArray(d),_=v&&f!==c.xaxes&&T&&d!==c.yaxes;y?(g=c.subplots.length,m=c.subplots[0].length):(T&&(g=d.length),v&&(m=f.length));var k=e.newContainer(r,"grid"),E=P("rows",g),A=P("columns",m);if(E*A>1){!y&&!v&&!T&&P("pattern")==="independent"&&(y=!0),k._hasSubplotGrid=y;var b,L,w=P("roworder")==="top to bottom",C=y?.2:.1,S=y?.3:.1;_&&r._splomGridDflt&&(b=r._splomGridDflt.xside,L=r._splomGridDflt.yside),k._domains={x:a("x",P,C,b,A),y:a("y",P,S,L,E,w)}}else delete r.grid}function P(z,F){return t.coerce(c,k,l,z,F)}},contentDefaults:function(s,r){var c=r.grid;if(c&&c._domains){var f,d,g,m,y,v,T,_=s.grid||{},k=r._subplots,E=c._hasSubplotGrid,A=c.rows,b=c.columns,L=c.pattern==="independent",w=c._axisMap={};if(E){var C=_.subplots||[];v=c.subplots=new Array(A);var S=1;for(f=0;f<A;f++){var P=v[f]=new Array(b),z=C[f]||[];for(d=0;d<b;d++)if(L?(y=S===1?"xy":"x"+S+"y"+S,S++):y=z[d],P[d]="",k.cartesian.indexOf(y)!==-1){if(T=y.indexOf("y"),g=y.slice(0,T),m=y.slice(T),w[g]!==void 0&&w[g]!==d||w[m]!==void 0&&w[m]!==f)continue;P[d]=y,w[g]=d,w[m]=f}}}else{var F=o(r,_,"x"),q=o(r,_,"y");c.xaxes=n(F,k.xaxis,b,w,"x"),c.yaxes=n(q,k.yaxis,A,w,"y")}var W=c._anchors={},X=c.roworder==="top to bottom";for(var Q in w){var Z,Y,N,J=Q.charAt(0),D=c[J+"side"];if(D.length<8)W[Q]="free";else if(J==="x"){if(D.charAt(0)==="t"===X?(Z=0,Y=1,N=A):(Z=A-1,Y=-1,N=-1),E){var U=w[Q];for(f=Z;f!==N;f+=Y)if((y=v[f][U])&&(T=y.indexOf("y"),y.slice(0,T)===Q)){W[Q]=y.slice(T);break}}else for(f=Z;f!==N;f+=Y)if(m=c.yaxes[f],k.cartesian.indexOf(Q+m)!==-1){W[Q]=m;break}}else if(D.charAt(0)==="l"?(Z=0,Y=1,N=b):(Z=b-1,Y=-1,N=-1),E){var G=w[Q];for(f=Z;f!==N;f+=Y)if((y=v[G][f])&&(T=y.indexOf("y"),y.slice(T)===Q)){W[Q]=y.slice(0,T);break}}else for(f=Z;f!==N;f+=Y)if(g=c.xaxes[f],k.cartesian.indexOf(g+Q)!==-1){W[Q]=g;break}}}}}},{"../../lib":803,"../../lib/regex":820,"../../plot_api/plot_template":843,"../../plots/cartesian/constants":861,"../../plots/domain":882}],711:[function(i,B,V){var t=i("../../plots/cartesian/constants"),h=i("../../plot_api/plot_template").templatedArray;i("../../constants/axis_placeable_objects"),B.exports=h("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",t.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",t.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":772,"../../plot_api/plot_template":843,"../../plots/cartesian/constants":861}],712:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib/to_log_range");B.exports=function(p,u,e,l){u=u||{};var o=e==="log"&&u.type==="linear",a=e==="linear"&&u.type==="log";if(o||a){for(var n,s,r=p._fullLayout.images,c=u._id.charAt(0),f=0;f<r.length;f++)if(s="images["+f+"].",(n=r[f])[c+"ref"]===u._id){var d=n[c],g=n["size"+c],m=null,y=null;if(o){m=h(d,u.range);var v=g/Math.pow(10,m)/2;y=2*Math.log(v+Math.sqrt(1+v*v))/Math.LN10}else y=(m=Math.pow(10,d))*(Math.pow(10,g/2)-Math.pow(10,-g/2));t(m)?t(y)||(y=null):(m=null,y=null),l(s+c,m),l(s+"size"+c,y)}}}},{"../../lib/to_log_range":831,"fast-isnumeric":249}],713:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes"),p=i("../../plots/array_container_defaults"),u=i("./attributes");function e(l,o,a){function n(m,y){return t.coerce(l,o,u,m,y)}var s=n("source");if(!n("visible",!!s))return o;n("layer"),n("xanchor"),n("yanchor"),n("sizex"),n("sizey"),n("sizing"),n("opacity");for(var r={_fullLayout:a},c=["x","y"],f=0;f<2;f++){var d=c[f],g=h.coerceRef(l,o,r,d,"paper",void 0);g!=="paper"&&h.getFromId(r,g)._imgIndices.push(o._index),h.coercePosition(o,r,n,g,d,0)}return o}B.exports=function(l,o){p(l,o,{name:"images",handleItemDefaults:e})}},{"../../lib":803,"../../plots/array_container_defaults":849,"../../plots/cartesian/axes":854,"./attributes":711}],714:[function(i,B,V){var t=i("@plotly/d3"),h=i("../drawing"),p=i("../../plots/cartesian/axes"),u=i("../../plots/cartesian/axis_ids"),e=i("../../constants/xmlns_namespaces");B.exports=function(l){var o,a,n=l._fullLayout,s=[],r={},c=[];for(a=0;a<n.images.length;a++){var f=n.images[a];if(f.visible)if(f.layer==="below"&&f.xref!=="paper"&&f.yref!=="paper"){o=u.ref2id(f.xref)+u.ref2id(f.yref);var d=n._plots[o];if(!d){c.push(f);continue}d.mainplot&&(o=d.mainplot.id),r[o]||(r[o]=[]),r[o].push(f)}else f.layer==="above"?s.push(f):c.push(f)}var g={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},m={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function y(b){var L=t.select(this);if(this._imgSrc!==b.source)if(L.attr("xmlns",e.svg),b.source&&b.source.slice(0,5)==="data:")L.attr("xlink:href",b.source),this._imgSrc=b.source;else{var w=new Promise((function(C){var S=new Image;function P(){L.remove(),C()}this.img=S,S.setAttribute("crossOrigin","anonymous"),S.onerror=P,S.onload=function(){var z=document.createElement("canvas");z.width=this.width,z.height=this.height,z.getContext("2d").drawImage(this,0,0);var F=z.toDataURL("image/png");L.attr("xlink:href",F),C()},L.on("error",P),S.src=b.source,this._imgSrc=b.source}).bind(this));l._promises.push(w)}}function v(b){var L,w,C=t.select(this),S=p.getFromId(l,b.xref),P=p.getFromId(l,b.yref),z=p.getRefType(b.xref)==="domain",F=p.getRefType(b.yref)==="domain",q=n._size;L=S!==void 0?typeof b.xref=="string"&&z?S._length*b.sizex:Math.abs(S.l2p(b.sizex)-S.l2p(0)):b.sizex*q.w,w=P!==void 0?typeof b.yref=="string"&&F?P._length*b.sizey:Math.abs(P.l2p(b.sizey)-P.l2p(0)):b.sizey*q.h;var W,X,Q=L*g[b.xanchor].offset,Z=w*m[b.yanchor].offset,Y=g[b.xanchor].sizing+m[b.yanchor].sizing;switch(W=S!==void 0?typeof b.xref=="string"&&z?S._length*b.x+S._offset:S.r2p(b.x)+S._offset:b.x*q.w+q.l,W+=Q,X=P!==void 0?typeof b.yref=="string"&&F?P._length*(1-b.y)+P._offset:P.r2p(b.y)+P._offset:q.h-b.y*q.h+q.t,X+=Z,b.sizing){case"fill":Y+=" slice";break;case"stretch":Y="none"}C.attr({x:W,y:X,width:L,height:w,preserveAspectRatio:Y,opacity:b.opacity});var N=(S&&p.getRefType(b.xref)!=="domain"?S._id:"")+(P&&p.getRefType(b.yref)!=="domain"?P._id:"");h.setClipUrl(C,N?"clip"+n._uid+N:null,l)}var T=n._imageLowerLayer.selectAll("image").data(c),_=n._imageUpperLayer.selectAll("image").data(s);T.enter().append("image"),_.enter().append("image"),T.exit().remove(),_.exit().remove(),T.each(function(b){y.bind(this)(b),v.bind(this)(b)}),_.each(function(b){y.bind(this)(b),v.bind(this)(b)});var k=Object.keys(n._plots);for(a=0;a<k.length;a++){o=k[a];var E=n._plots[o];if(E.imagelayer){var A=E.imagelayer.selectAll("image").data(r[o]||[]);A.enter().append("image"),A.exit().remove(),A.each(function(b){y.bind(this)(b),v.bind(this)(b)})}}}},{"../../constants/xmlns_namespaces":780,"../../plots/cartesian/axes":854,"../../plots/cartesian/axis_ids":858,"../drawing":688,"@plotly/d3":58}],715:[function(i,B,V){B.exports={moduleType:"component",name:"images",layoutAttributes:i("./attributes"),supplyLayoutDefaults:i("./defaults"),includeBasePlot:i("../../plots/cartesian/include_components")("images"),draw:i("./draw"),convertCoords:i("./convert_coords")}},{"../../plots/cartesian/include_components":867,"./attributes":711,"./convert_coords":712,"./defaults":713,"./draw":714}],716:[function(i,B,V){var t=i("../../plots/font_attributes"),h=i("../color/attributes");B.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:h.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:t({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:t({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":883,"../color/attributes":665}],717:[function(i,B,V){B.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],718:[function(i,B,V){var t=i("../../registry"),h=i("../../lib"),p=i("../../plot_api/plot_template"),u=i("./attributes"),e=i("../../plots/layout_attributes"),l=i("./helpers");B.exports=function(o,a,n){for(var s=o.legend||{},r=0,c=!1,f="normal",d=0;d<n.length;d++){var g=n[d];g.visible&&((g.showlegend||g._dfltShowLegend&&!(g._module&&g._module.attributes&&g._module.attributes.showlegend&&g._module.attributes.showlegend.dflt===!1))&&(r++,g.showlegend&&(c=!0,(t.traceIs(g,"pie-like")||g._input.showlegend===!0)&&r++)),(t.traceIs(g,"bar")&&a.barmode==="stack"||["tonextx","tonexty"].indexOf(g.fill)!==-1)&&(f=l.isGrouped({traceorder:f})?"grouped+reversed":"reversed"),g.legendgroup!==void 0&&g.legendgroup!==""&&(f=l.isReversed({traceorder:f})?"reversed+grouped":"grouped"))}var m=h.coerce(o,a,e,"showlegend",c&&r>1);if(m!==!1||s.uirevision){var y=p.newContainer(a,"legend");if(b("uirevision",a.uirevision),m!==!1){b("bgcolor",a.paper_bgcolor),b("bordercolor"),b("borderwidth");var v,T,_,k=h.coerceFont(b,"font",a.font),E=b("orientation")==="h";if(E?(v=0,t.getComponentMethod("rangeslider","isVisible")(o.xaxis)?(T=1.1,_="bottom"):(T=-.1,_="top")):(v=1.02,T=1,_="auto"),b("traceorder",f),l.isGrouped(a.legend)&&b("tracegroupgap"),b("itemsizing"),b("itemwidth"),b("itemclick"),b("itemdoubleclick"),b("x",v),b("xanchor"),b("y",T),b("yanchor",_),b("valign"),h.noneOrAll(s,y,["x","y"]),b("title.text")){b("title.side",E?"left":"top");var A=h.extendFlat({},k,{size:h.bigFont(k.size)});h.coerceFont(b,"title.font",A)}}}function b(L,w){return h.coerce(s,y,u,L,w)}}},{"../../lib":803,"../../plot_api/plot_template":843,"../../plots/layout_attributes":908,"../../registry":931,"./attributes":716,"./helpers":722}],719:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../plots/plots"),u=i("../../registry"),e=i("../../lib/events"),l=i("../dragelement"),o=i("../drawing"),a=i("../color"),n=i("../../lib/svg_text_utils"),s=i("./handle_click"),r=i("./constants"),c=i("../../constants/alignment"),f=c.LINE_SPACING,d=c.FROM_TL,g=c.FROM_BR,m=i("./get_legend_data"),y=i("./style"),v=i("./helpers");function T(w,C,S,P,z){var F=S.data()[0][0].trace,q={event:z,node:S.node(),curveNumber:F.index,expandedIndex:F._expandedIndex,data:w.data,layout:w.layout,frames:w._transitionData._frames,config:w._context,fullData:w._fullData,fullLayout:w._fullLayout};F._group&&(q.group=F._group),u.traceIs(F,"pie-like")&&(q.label=S.datum()[0].label),e.triggerHandler(w,"plotly_legendclick",q)!==!1&&(P===1?C._clickTimeout=setTimeout(function(){w._fullLayout&&s(S,w,P)},w._context.doubleClickDelay):P===2&&(C._clickTimeout&&clearTimeout(C._clickTimeout),w._legendMouseDownTime=0,e.triggerHandler(w,"plotly_legenddoubleclick",q)!==!1&&s(S,w,P)))}function _(w,C,S){var P,z,F=w.data()[0][0],q=F.trace,W=u.traceIs(q,"pie-like"),X=!S._inHover&&C._context.edits.legendText&&!W,Q=S._maxNameLength;F.groupTitle?(P=F.groupTitle.text,z=F.groupTitle.font):(z=S.font,S.entries?P=F.text:(P=W?F.label:q.name,q._meta&&(P=h.templateString(P,q._meta))));var Z=h.ensureSingle(w,"text","legendtext");Z.attr("text-anchor","start").call(o.font,z).text(X?k(P,Q):P);var Y=S.itemwidth+2*r.itemGap;n.positionText(Z,Y,0),X?Z.call(n.makeEditable,{gd:C,text:P}).call(A,w,C,S).on("edit",function(N){this.text(k(N,Q)).call(A,w,C,S);var J=F.trace._fullInput||{},D={};if(u.hasTransform(J,"groupby")){var U=u.getTransformIndices(J,"groupby"),G=U[U.length-1],$=h.keyedContainer(J,"transforms["+G+"].styles","target","value.name");$.set(F.trace._group,N),D=$.constructUpdate()}else D.name=N;return u.call("_guiRestyle",C,D,q.index)}):A(Z,w,C,S)}function k(w,C){var S=Math.max(4,C);if(w&&w.trim().length>=S/2)return w;for(var P=S-(w=w||"").length;P>0;P--)w+=" ";return w}function E(w,C){var S,P=C._context.doubleClickDelay,z=1,F=h.ensureSingle(w,"rect","legendtoggle",function(q){C._context.staticPlot||q.style("cursor","pointer").attr("pointer-events","all"),q.call(a.fill,"rgba(0,0,0,0)")});C._context.staticPlot||(F.on("mousedown",function(){(S=new Date().getTime())-C._legendMouseDownTime<P?z+=1:(z=1,C._legendMouseDownTime=S)}),F.on("mouseup",function(){if(!C._dragged&&!C._editing){var q=C._fullLayout.legend;new Date().getTime()-C._legendMouseDownTime>P&&(z=Math.max(z-1,1)),T(C,q,w,z,t.event)}}))}function A(w,C,S,P,z){P._inHover&&w.attr("data-notex",!0),n.convertToTspans(w,S,function(){(function(F,q,W,X){var Q=F.data()[0][0];if(!W._inHover&&Q&&!Q.trace.showlegend)return void F.remove();var Z=F.select("g[class*=math-group]"),Y=Z.node();W||(W=q._fullLayout.legend);var N,J=W.borderwidth;N=X===1?W.title.font:Q.groupTitle?Q.groupTitle.font:W.font;var D,U,G=N.size*f;if(Y){var $=o.bBox(Y);D=$.height,U=$.width,X===1?o.setTranslate(Z,J,J+.75*D):o.setTranslate(Z,0,.25*D)}else{var K=F.select(X===1?".legendtitletext":".legendtext"),re=n.lineCount(K),ne=K.node();if(D=G*re,U=ne?o.bBox(ne).width:0,X===1)W.title.side==="left"&&(U+=2*r.itemGap),n.positionText(K,J+r.titlePad,J+G);else{var ae=2*r.itemGap+W.itemwidth;Q.groupTitle&&(ae=r.itemGap,U-=W.itemwidth),n.positionText(K,ae,-G*((re-1)/2-.3))}}X===1?(W._titleWidth=U,W._titleHeight=D):(Q.lineHeight=G,Q.height=Math.max(D,16)+3,Q.width=U)})(C,S,P,z)})}function b(w){return h.isRightAnchor(w)?"right":h.isCenterAnchor(w)?"center":"left"}function L(w){return h.isBottomAnchor(w)?"bottom":h.isMiddleAnchor(w)?"middle":"top"}B.exports=function(w,C){return C||(C=w._fullLayout.legend||{}),function(S,P){var z,F,q=S._fullLayout,W="legend"+q._uid,X=P._inHover;if(X?(z=P.layer,W+="-hover"):z=q._infolayer,!!z){if(S._legendMouseDownTime||(S._legendMouseDownTime=0),X){if(!P.entries)return;F=m(P.entries,P)}else{if(!S.calcdata)return;F=q.showlegend&&m(S.calcdata,P)}var Q=q.hiddenlabels||[];if(!(X||q.showlegend&&F.length))return z.selectAll(".legend").remove(),q._topdefs.select("#"+W).remove(),p.autoMargin(S,"legend");var Z=h.ensureSingle(z,"g","legend",function(re){X||re.attr("pointer-events","all")}),Y=h.ensureSingleById(q._topdefs,"clipPath",W,function(re){re.append("rect")}),N=h.ensureSingle(Z,"rect","bg",function(re){re.attr("shape-rendering","crispEdges")});N.call(a.stroke,P.bordercolor).call(a.fill,P.bgcolor).style("stroke-width",P.borderwidth+"px");var J=h.ensureSingle(Z,"g","scrollbox"),D=P.title;if(P._titleWidth=0,P._titleHeight=0,D.text){var U=h.ensureSingle(J,"text","legendtitletext");U.attr("text-anchor","start").call(o.font,D.font).text(D.text),A(U,J,S,P,1)}else J.selectAll(".legendtitletext").remove();var G=h.ensureSingle(Z,"rect","scrollbar",function(re){re.attr(r.scrollBarEnterAttrs).call(a.fill,r.scrollBarColor)}),$=J.selectAll("g.groups").data(F);$.enter().append("g").attr("class","groups"),$.exit().remove();var K=$.selectAll("g.traces").data(h.identity);K.enter().append("g").attr("class","traces"),K.exit().remove(),K.style("opacity",function(re){var ne=re[0].trace;return u.traceIs(ne,"pie-like")?Q.indexOf(re[0].label)!==-1?.5:1:ne.visible==="legendonly"?.5:1}).each(function(){t.select(this).call(_,S,P)}).call(y,S,P).each(function(){X||t.select(this).call(E,S)}),h.syncOrAsync([p.previousPromises,function(){return function(re,ne,ae,ie){var he=re._fullLayout;ie||(ie=he.legend);var se=he._size,de=v.isVertical(ie),ce=v.isGrouped(ie),ve=ie.borderwidth,Ee=2*ve,Le=r.itemGap,Te=ie.itemwidth+2*Le,xe=2*(ve+Le),fe=L(ie),ge=ie.y<0||ie.y===0&&fe==="top",ke=ie.y>1||ie.y===1&&fe==="bottom",Me=ie.tracegroupgap;ie._maxHeight=Math.max(ge||ke?he.height/2:se.h,30);var Se=0;ie._width=0,ie._height=0;var De=function(Ct){var Ie=0,be=0,Ae=Ct.title.side;return Ae&&(Ae.indexOf("left")!==-1&&(Ie=Ct._titleWidth),Ae.indexOf("top")!==-1&&(be=Ct._titleHeight)),[Ie,be]}(ie);if(de)ae.each(function(Ct){var Ie=Ct[0].height;o.setTranslate(this,ve+De[0],ve+De[1]+ie._height+Ie/2+Le),ie._height+=Ie,ie._width=Math.max(ie._width,Ct[0].width)}),Se=Te+ie._width,ie._width+=Le+Te+Ee,ie._height+=xe,ce&&(ne.each(function(Ct,Ie){o.setTranslate(this,0,Ie*ie.tracegroupgap)}),ie._height+=(ie._lgroupsLength-1)*ie.tracegroupgap);else{var Be=b(ie),We=ie.x<0||ie.x===0&&Be==="right",Qe=ie.x>1||ie.x===1&&Be==="left",Oe=ke||ge,Ue=he.width/2;ie._maxWidth=Math.max(We?Oe&&Be==="left"?se.l+se.w:Ue:Qe?Oe&&Be==="right"?se.r+se.w:Ue:se.w,2*Te);var Xe=0,Ye=0;ae.each(function(Ct){var Ie=Ct[0].width+Te;Xe=Math.max(Xe,Ie),Ye+=Ie}),Se=null;var $e=0;if(ce){var it=0,ot=0,Et=0;ne.each(function(){var Ct=0,Ie=0;t.select(this).selectAll("g.traces").each(function(Ae){var Pe=Ae[0].height;o.setTranslate(this,De[0],De[1]+ve+Le+Pe/2+Ie),Ie+=Pe,Ct=Math.max(Ct,Te+Ae[0].width)}),it=Math.max(it,Ie);var be=Ct+Le;be+ve+ot>ie._maxWidth&&($e=Math.max($e,ot),ot=0,Et+=it+Me,it=Ie),o.setTranslate(this,ot,Et),ot+=be}),ie._width=Math.max($e,ot)+ve,ie._height=Et+it+xe}else{var mt=ae.size(),tt=Ye+Ee+(mt-1)*Le<ie._maxWidth,Ke=0,Mt=0,Jt=0,$t=0;ae.each(function(Ct){var Ie=Ct[0].height,be=Te+Ct[0].width,Ae=(tt?be:Xe)+Le;Ae+ve+Mt-Le>=ie._maxWidth&&($e=Math.max($e,$t),Mt=0,Jt+=Ke,ie._height+=Ke,Ke=0),o.setTranslate(this,De[0]+ve+Mt,De[1]+ve+Jt+Ie/2+Le),$t=Mt+be+Le,Mt+=Ae,Ke=Math.max(Ke,Ie)}),tt?(ie._width=Mt+Ee,ie._height=Ke+xe):(ie._width=Math.max($e,$t)+Ee,ie._height+=Ke+xe)}}ie._width=Math.ceil(Math.max(ie._width+De[0],ie._titleWidth+2*(ve+r.titlePad))),ie._height=Math.ceil(Math.max(ie._height+De[1],ie._titleHeight+2*(ve+r.itemGap))),ie._effHeight=Math.min(ie._height,ie._maxHeight);var je=re._context.edits,Ge=je.legendText||je.legendPosition;ae.each(function(Ct){var Ie=t.select(this).select(".legendtoggle"),be=Ct[0].height,Ae=Ge?Te:Se||Te+Ct[0].width;de||(Ae+=Le/2),o.setRect(Ie,0,-be/2,Ae,be)})}(S,$,K,P)},function(){if(X||!function(Oe){var Ue=Oe._fullLayout.legend,Xe=b(Ue),Ye=L(Ue);return p.autoMargin(Oe,"legend",{x:Ue.x,y:Ue.y,l:Ue._width*d[Xe],r:Ue._width*g[Xe],b:Ue._effHeight*g[Ye],t:Ue._effHeight*d[Ye]})}(S)){var re,ne,ae,ie,he=q._size,se=P.borderwidth,de=he.l+he.w*P.x-d[b(P)]*P._width,ce=he.t+he.h*(1-P.y)-d[L(P)]*P._effHeight;if(!X&&q.margin.autoexpand){var ve=de,Ee=ce;de=h.constrain(de,0,q.width-P._width),ce=h.constrain(ce,0,q.height-P._effHeight),de!==ve&&h.log("Constrain legend.x to make legend fit inside graph"),ce!==Ee&&h.log("Constrain legend.y to make legend fit inside graph")}if(X||o.setTranslate(Z,de,ce),G.on(".drag",null),Z.on("wheel",null),X||P._height<=P._maxHeight||S._context.staticPlot){var Le=P._effHeight;X&&(Le=P._height),N.attr({width:P._width-se,height:Le-se,x:se/2,y:se/2}),o.setTranslate(J,0,0),Y.select("rect").attr({width:P._width-2*se,height:Le-2*se,x:se,y:se}),o.setClipUrl(J,W,S),o.setRect(G,0,0,0,0),delete P._scrollY}else{var Te,xe,fe,ge=Math.max(r.scrollBarMinHeight,P._effHeight*P._effHeight/P._height),ke=P._effHeight-ge-2*r.scrollBarMargin,Me=P._height-P._effHeight,Se=ke/Me,De=Math.min(P._scrollY||0,Me);N.attr({width:P._width-2*se+r.scrollBarWidth+r.scrollBarMargin,height:P._effHeight-se,x:se/2,y:se/2}),Y.select("rect").attr({width:P._width-2*se+r.scrollBarWidth+r.scrollBarMargin,height:P._effHeight-2*se,x:se,y:se+De}),o.setClipUrl(J,W,S),Qe(De,ge,Se),Z.on("wheel",function(){Qe(De=h.constrain(P._scrollY+t.event.deltaY/ke*Me,0,Me),ge,Se),De!==0&&De!==Me&&t.event.preventDefault()});var Be=t.behavior.drag().on("dragstart",function(){var Oe=t.event.sourceEvent;Te=Oe.type==="touchstart"?Oe.changedTouches[0].clientY:Oe.clientY,fe=De}).on("drag",function(){var Oe=t.event.sourceEvent;Oe.buttons===2||Oe.ctrlKey||(xe=Oe.type==="touchmove"?Oe.changedTouches[0].clientY:Oe.clientY,Qe(De=function(Ue,Xe,Ye){var $e=(Ye-Xe)/Se+Ue;return h.constrain($e,0,Me)}(fe,Te,xe),ge,Se))});G.call(Be);var We=t.behavior.drag().on("dragstart",function(){var Oe=t.event.sourceEvent;Oe.type==="touchstart"&&(Te=Oe.changedTouches[0].clientY,fe=De)}).on("drag",function(){var Oe=t.event.sourceEvent;Oe.type==="touchmove"&&(xe=Oe.changedTouches[0].clientY,Qe(De=function(Ue,Xe,Ye){var $e=(Xe-Ye)/Se+Ue;return h.constrain($e,0,Me)}(fe,Te,xe),ge,Se))});J.call(We)}S._context.edits.legendPosition&&(Z.classed("cursor-move",!0),l.init({element:Z.node(),gd:S,prepFn:function(){var Oe=o.getTranslate(Z);ae=Oe.x,ie=Oe.y},moveFn:function(Oe,Ue){var Xe=ae+Oe,Ye=ie+Ue;o.setTranslate(Z,Xe,Ye),re=l.align(Xe,0,he.l,he.l+he.w,P.xanchor),ne=l.align(Ye,0,he.t+he.h,he.t,P.yanchor)},doneFn:function(){re!==void 0&&ne!==void 0&&u.call("_guiRelayout",S,{"legend.x":re,"legend.y":ne})},clickFn:function(Oe,Ue){var Xe=z.selectAll("g.traces").filter(function(){var Ye=this.getBoundingClientRect();return Ue.clientX>=Ye.left&&Ue.clientX<=Ye.right&&Ue.clientY>=Ye.top&&Ue.clientY<=Ye.bottom});Xe.size()>0&&T(S,Z,Xe,Oe,Ue)}}))}function Qe(Oe,Ue,Xe){P._scrollY=S._fullLayout.legend._scrollY=Oe,o.setTranslate(J,0,-Oe),o.setRect(G,P._width,r.scrollBarMargin+Oe*Xe,r.scrollBarWidth,Ue),Y.select("rect").attr("y",se+Oe)}}],S)}}(w,C)}},{"../../constants/alignment":771,"../../lib":803,"../../lib/events":792,"../../lib/svg_text_utils":829,"../../plots/plots":917,"../../registry":931,"../color":666,"../dragelement":685,"../drawing":688,"./constants":717,"./get_legend_data":720,"./handle_click":721,"./helpers":722,"./style":724,"@plotly/d3":58}],720:[function(i,B,V){var t=i("../../registry"),h=i("./helpers");B.exports=function(p,u){var e,l,o=h.isGrouped(u),a=h.isReversed(u),n={},s=[],r=!1,c={},f=0,d=0;function g(F,q){if(F!==""&&h.isGrouped(u))s.indexOf(F)===-1?(s.push(F),r=!0,n[F]=[q]):n[F].push(q);else{var W="~~i"+f;s.push(W),n[W]=[q],f++}}for(e=0;e<p.length;e++){var m=p[e],y=m[0],v=y.trace,T=v.legendgroup;if(u._inHover||v.visible&&v.showlegend)if(t.traceIs(v,"pie-like"))for(c[T]||(c[T]={}),l=0;l<m.length;l++){var _=m[l].label;c[T][_]||(g(T,{label:_,color:m[l].color,i:m[l].i,trace:v,pts:m[l].pts}),c[T][_]=!0,d=Math.max(d,(_||"").length))}else g(T,y),d=Math.max(d,(v.name||"").length)}if(!s.length)return[];var k=!r||!o,E=[];for(e=0;e<s.length;e++){var A=n[s[e]];k?E.push(A[0]):E.push(A)}for(k&&(E=[E]),e=0;e<E.length;e++){var b=1/0;for(l=0;l<E[e].length;l++){var L=E[e][l].trace.legendrank;b>L&&(b=L)}E[e][0]._groupMinRank=b,E[e][0]._preGroupSort=e}var w=function(F,q){return F.trace.legendrank-q.trace.legendrank||F._preSort-q._preSort};for(E.forEach(function(F,q){F[0]._preGroupSort=q}),E.sort(function(F,q){return F[0]._groupMinRank-q[0]._groupMinRank||F[0]._preGroupSort-q[0]._preGroupSort}),e=0;e<E.length;e++){E[e].forEach(function(F,q){F._preSort=q}),E[e].sort(w);var C=E[e][0].trace,S=null;for(l=0;l<E[e].length;l++){var P=E[e][l].trace.legendgrouptitle;if(P&&P.text){S=P;break}}if(a&&E[e].reverse(),S){var z=!1;for(l=0;l<E[e].length;l++)if(t.traceIs(E[e][l].trace,"pie-like")){z=!0;break}E[e].unshift({i:-1,groupTitle:S,noClick:z,trace:{showlegend:C.showlegend,legendgroup:C.legendgroup,visible:C.visible}})}for(l=0;l<E[e].length;l++)E[e][l]=[E[e][l]]}return u._lgroupsLength=E.length,u._maxNameLength=d,E}},{"../../registry":931,"./helpers":722}],721:[function(i,B,V){var t=i("../../lib"),h=i("../../registry"),p=!0;B.exports=function(u,e,l){var o=e._fullLayout;if(!e._dragged&&!e._editing){var a,n=o.legend.itemclick,s=o.legend.itemdoubleclick;if(l===1&&n==="toggle"&&s==="toggleothers"&&p&&e.data&&e._context.showTips&&t.notifier(t._(e,"Double-click on legend to isolate one trace"),"long"),p=!1,l===1?a=n:l===2&&(a=s),a){var r=o.hiddenlabels?o.hiddenlabels.slice():[],c=u.data()[0][0];if(!c.groupTitle||!c.noClick){var f,d,g,m,y,v=e._fullData,T=c.trace,_=T.legendgroup,k={},E=[],A=[],b=[];if(h.traceIs(T,"pie-like")){var L=c.label,w=r.indexOf(L);a==="toggle"?w===-1?r.push(L):r.splice(w,1):a==="toggleothers"&&(r=[],e.calcdata[0].forEach(function(D){L!==D.label&&r.push(D.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===r.length&&w===-1&&(r=[])),h.call("_guiRelayout",e,"hiddenlabels",r)}else{var C,S=_&&_.length,P=[];if(S)for(f=0;f<v.length;f++)(C=v[f]).visible&&C.legendgroup===_&&P.push(f);if(a==="toggle"){var z;switch(T.visible){case!0:z="legendonly";break;case!1:z=!1;break;case"legendonly":z=!0}if(S)for(f=0;f<v.length;f++)v[f].visible!==!1&&v[f].legendgroup===_&&J(v[f],z);else J(T,z)}else if(a==="toggleothers"){var F,q,W,X,Q=!0;for(f=0;f<v.length;f++)if(F=v[f]===T,W=v[f].showlegend!==!0,!(F||W||(q=S&&v[f].legendgroup===_)||v[f].visible!==!0||h.traceIs(v[f],"notLegendIsolatable"))){Q=!1;break}for(f=0;f<v.length;f++)if(v[f].visible!==!1&&!h.traceIs(v[f],"notLegendIsolatable"))switch(T.visible){case"legendonly":J(v[f],!0);break;case!0:X=!!Q||"legendonly",F=v[f]===T,W=v[f].showlegend!==!0&&!v[f].legendgroup,q=F||S&&v[f].legendgroup===_,J(v[f],!(!q&&!W)||X)}}for(f=0;f<A.length;f++)if(g=A[f]){var Z=g.constructUpdate(),Y=Object.keys(Z);for(d=0;d<Y.length;d++)m=Y[d],(k[m]=k[m]||[])[b[f]]=Z[m]}for(y=Object.keys(k),f=0;f<y.length;f++)for(m=y[f],d=0;d<E.length;d++)k[m].hasOwnProperty(d)||(k[m][d]=void 0);h.call("_guiRestyle",e,k,E)}}}}function N(D,U,G){var $=E.indexOf(D),K=k[U];return K||(K=k[U]=[]),E.indexOf(D)===-1&&(E.push(D),$=E.length-1),K[$]=G,$}function J(D,U){var G=D._fullInput;if(h.hasTransform(G,"groupby")){var $=A[G.index];if(!$){var K=h.getTransformIndices(G,"groupby"),re=K[K.length-1];$=t.keyedContainer(G,"transforms["+re+"].styles","target","value.visible"),A[G.index]=$}var ne=$.get(D._group);ne===void 0&&(ne=!0),ne!==!1&&$.set(D._group,U),b[G.index]=N(G.index,"visible",G.visible!==!1)}else{var ae=G.visible!==!1&&U;N(G.index,"visible",ae)}}}},{"../../lib":803,"../../registry":931}],722:[function(i,B,V){V.isGrouped=function(t){return(t.traceorder||"").indexOf("grouped")!==-1},V.isVertical=function(t){return t.orientation!=="h"},V.isReversed=function(t){return(t.traceorder||"").indexOf("reversed")!==-1}},{}],723:[function(i,B,V){B.exports={moduleType:"component",name:"legend",layoutAttributes:i("./attributes"),supplyLayoutDefaults:i("./defaults"),draw:i("./draw"),style:i("./style")}},{"./attributes":716,"./defaults":718,"./draw":719,"./style":724}],724:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../registry"),p=i("../../lib"),u=p.strTranslate,e=i("../drawing"),l=i("../color"),o=i("../colorscale/helpers").extractOpts,a=i("../../traces/scatter/subtypes"),n=i("../../traces/pie/style_one"),s=i("../../traces/pie/helpers").castOption,r=i("./constants");function c(g,m){return(m?"radial":"horizontal")+(g?"":"reversed")}function f(g){var m=g[0].trace,y=m.contours,v=a.hasLines(m),T=a.hasMarkers(m),_=m.visible&&m.fill&&m.fill!=="none",k=!1,E=!1;if(y){var A=y.coloring;A==="lines"?k=!0:v=A==="none"||A==="heatmap"||y.showlines,y.type==="constraint"?_=y._operation!=="=":A!=="fill"&&A!=="heatmap"||(E=!0)}return{showMarker:T,showLine:v,showFill:_,showGradientLine:k,showGradientFill:E,anyLine:v||k,anyFill:_||E}}function d(g,m,y){return g&&p.isArrayOrTypedArray(g)?m:g>y?y:g}B.exports=function(g,m,y){var v=m._fullLayout;y||(y=v.legend);var T=y.itemsizing==="constant",_=y.itemwidth,k=(_+2*r.itemGap)/2,E=u(k,0),A=function(w,C,S,P){var z;if(w+1)z=w;else{if(!(C&&C.width>0))return 0;z=C.width}return T?P:Math.min(z,S)};function b(w,C,S){var P=w[0].trace,z=P.marker||{},F=z.line||{},q=S?P.visible&&P.type===S:h.traceIs(P,"bar"),W=t.select(C).select("g.legendpoints").selectAll("path.legend"+S).data(q?[w]:[]);W.enter().append("path").classed("legend"+S,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",E),W.exit().remove(),W.each(function(X){var Q=t.select(this),Z=X[0],Y=A(Z.mlw,z.line,5,2);Q.style("stroke-width",Y+"px");var N=Z.mcc;if(!y._inHover&&"mc"in Z){var J=o(z),D=J.mid;D===void 0&&(D=(J.max+J.min)/2),N=e.tryColorscale(z,"")(D)}var U=N||Z.mc||z.color,G=z.pattern,$=G&&e.getPatternAttr(G.shape,0,"");if($){var K=e.getPatternAttr(G.bgcolor,0,null),re=e.getPatternAttr(G.fgcolor,0,null),ne=G.fgopacity,ae=d(G.size,8,10),ie=d(G.solidity,.5,1),he="legend-"+P.uid;Q.call(e.pattern,"legend",m,he,$,ae,ie,N,G.fillmode,K,re,ne)}else Q.call(l.fill,U);Y&&l.stroke(Q,Z.mlc||F.color)})}function L(w,C,S){var P=w[0],z=P.trace,F=S?z.visible&&z.type===S:h.traceIs(z,S),q=t.select(C).select("g.legendpoints").selectAll("path.legend"+S).data(F?[w]:[]);if(q.enter().append("path").classed("legend"+S,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",E),q.exit().remove(),q.size()){var W=(z.marker||{}).line,X=A(s(W.width,P.pts),W,5,2),Q=p.minExtend(z,{marker:{line:{width:X}}});Q.marker.line.color=W.color;var Z=p.minExtend(P,{trace:Q});n(q,Z,Q)}}g.each(function(w){var C=t.select(this),S=p.ensureSingle(C,"g","layers");S.style("opacity",w[0].trace.opacity);var P=y.valign,z=w[0].lineHeight,F=w[0].height;if(P!=="middle"&&z&&F){var q={top:1,bottom:-1}[P]*(.5*(z-F+3));S.attr("transform",u(0,q))}else S.attr("transform",null);S.selectAll("g.legendfill").data([w]).enter().append("g").classed("legendfill",!0),S.selectAll("g.legendlines").data([w]).enter().append("g").classed("legendlines",!0);var W=S.selectAll("g.legendsymbols").data([w]);W.enter().append("g").classed("legendsymbols",!0),W.selectAll("g.legendpoints").data([w]).enter().append("g").classed("legendpoints",!0)}).each(function(w){var C,S=w[0].trace,P=[];if(S.visible)switch(S.type){case"histogram2d":case"heatmap":P=[["M-15,-2V4H15V-2Z"]],C=!0;break;case"choropleth":case"choroplethmapbox":P=[["M-6,-6V6H6V-6Z"]],C=!0;break;case"densitymapbox":P=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],C="radial";break;case"cone":P=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],C=!1;break;case"streamtube":P=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],C=!1;break;case"surface":P=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],C=!0;break;case"mesh3d":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],C=!1;break;case"volume":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],C=!0;break;case"isosurface":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],C=!1}var z=t.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(P);z.enter().append("path").classed("legend3dandfriends",!0).attr("transform",E).style("stroke-miterlimit",1),z.exit().remove(),z.each(function(F,q){var W,X=t.select(this),Q=o(S),Z=Q.colorscale,Y=Q.reversescale;if(Z){if(!C){var N=Z.length;W=q===0?Z[Y?N-1:0][1]:q===1?Z[Y?0:N-1][1]:Z[Math.floor((N-1)/2)][1]}}else{var J=S.vertexcolor||S.facecolor||S.color;W=p.isArrayOrTypedArray(J)?J[q]||J[0]:J}X.attr("d",F[0]),W?X.call(l.fill,W):X.call(function(D){if(D.size()){var U="legendfill-"+S.uid;e.gradient(D,m,U,c(Y,C==="radial"),Z,"fill")}})})}).each(function(w){var C=w[0].trace,S=C.type==="waterfall";if(w[0]._distinct&&S){var P=w[0].trace[w[0].dir].marker;return w[0].mc=P.color,w[0].mlw=P.line.width,w[0].mlc=P.line.color,b(w,this,"waterfall")}var z=[];C.visible&&S&&(z=w[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var F=t.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(z);F.enter().append("path").classed("legendwaterfall",!0).attr("transform",E).style("stroke-miterlimit",1),F.exit().remove(),F.each(function(q){var W=t.select(this),X=C[q[0]].marker,Q=A(void 0,X.line,5,2);W.attr("d",q[1]).style("stroke-width",Q+"px").call(l.fill,X.color),Q&&W.call(l.stroke,X.line.color)})}).each(function(w){b(w,this,"funnel")}).each(function(w){b(w,this)}).each(function(w){var C=w[0].trace,S=t.select(this).select("g.legendpoints").selectAll("path.legendbox").data(C.visible&&h.traceIs(C,"box-violin")?[w]:[]);S.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",E),S.exit().remove(),S.each(function(){var P=t.select(this);if(C.boxpoints!=="all"&&C.points!=="all"||l.opacity(C.fillcolor)!==0||l.opacity((C.line||{}).color)!==0){var z=A(void 0,C.line,5,2);P.style("stroke-width",z+"px").call(l.fill,C.fillcolor),z&&l.stroke(P,C.line.color)}else{var F=p.minExtend(C,{marker:{size:T?12:p.constrain(C.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});S.call(e.pointStyle,F,m)}})}).each(function(w){L(w,this,"funnelarea")}).each(function(w){L(w,this,"pie")}).each(function(w){var C,S,P=f(w),z=P.showFill,F=P.showLine,q=P.showGradientLine,W=P.showGradientFill,X=P.anyFill,Q=P.anyLine,Z=w[0],Y=Z.trace,N=o(Y),J=N.colorscale,D=N.reversescale,U=a.hasMarkers(Y)||!X?"M5,0":Q?"M5,-2":"M5,-3",G=t.select(this),$=G.select(".legendfill").selectAll("path").data(z||W?[w]:[]);if($.enter().append("path").classed("js-fill",!0),$.exit().remove(),$.attr("d",U+"h"+_+"v6h-"+_+"z").call(z?e.fillGroupStyle:function(ne){if(ne.size()){var ae="legendfill-"+Y.uid;e.gradient(ne,m,ae,c(D),J,"fill")}}),F||q){var K=A(void 0,Y.line,10,5);S=p.minExtend(Y,{line:{width:K}}),C=[p.minExtend(Z,{trace:S})]}var re=G.select(".legendlines").selectAll("path").data(F||q?[C]:[]);re.enter().append("path").classed("js-line",!0),re.exit().remove(),re.attr("d",U+(q?"l"+_+",0.0001":"h"+_)).call(F?e.lineGroupStyle:function(ne){if(ne.size()){var ae="legendline-"+Y.uid;e.lineGroupStyle(ne),e.gradient(ne,m,ae,c(D),J,"stroke")}})}).each(function(w){var C,S,P=f(w),z=P.anyFill,F=P.anyLine,q=P.showLine,W=P.showMarker,X=w[0],Q=X.trace,Z=!W&&!F&&!z&&a.hasText(Q);function Y(re,ne,ae,ie){var he=p.nestedProperty(Q,re).get(),se=p.isArrayOrTypedArray(he)&&ne?ne(he):he;if(T&&se&&ie!==void 0&&(se=ie),ae){if(se<ae[0])return ae[0];if(se>ae[1])return ae[1]}return se}function N(re){return X._distinct&&X.index&&re[X.index]?re[X.index]:re[0]}if(W||Z||q){var J={},D={};if(W){J.mc=Y("marker.color",N),J.mx=Y("marker.symbol",N),J.mo=Y("marker.opacity",p.mean,[.2,1]),J.mlc=Y("marker.line.color",N),J.mlw=Y("marker.line.width",p.mean,[0,5],2),D.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var U=Y("marker.size",p.mean,[2,16],12);J.ms=U,D.marker.size=U}q&&(D.line={width:Y("line.width",N,[0,10],5)}),Z&&(J.tx="Aa",J.tp=Y("textposition",N),J.ts=10,J.tc=Y("textfont.color",N),J.tf=Y("textfont.family",N)),C=[p.minExtend(X,J)],(S=p.minExtend(Q,D)).selectedpoints=null,S.texttemplate=null}var G=t.select(this).select("g.legendpoints"),$=G.selectAll("path.scatterpts").data(W?C:[]);$.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",E),$.exit().remove(),$.call(e.pointStyle,S,m),W&&(C[0].mrc=3);var K=G.selectAll("g.pointtext").data(Z?C:[]);K.enter().append("g").classed("pointtext",!0).append("text").attr("transform",E),K.exit().remove(),K.selectAll("text").call(e.textPointStyle,S,m)}).each(function(w){var C=w[0].trace,S=t.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(C.visible&&C.type==="candlestick"?[w,w]:[]);S.enter().append("path").classed("legendcandle",!0).attr("d",function(P,z){return z?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",E).style("stroke-miterlimit",1),S.exit().remove(),S.each(function(P,z){var F=t.select(this),q=C[z?"increasing":"decreasing"],W=A(void 0,q.line,5,2);F.style("stroke-width",W+"px").call(l.fill,q.fillcolor),W&&l.stroke(F,q.line.color)})}).each(function(w){var C=w[0].trace,S=t.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(C.visible&&C.type==="ohlc"?[w,w]:[]);S.enter().append("path").classed("legendohlc",!0).attr("d",function(P,z){return z?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",E).style("stroke-miterlimit",1),S.exit().remove(),S.each(function(P,z){var F=t.select(this),q=C[z?"increasing":"decreasing"],W=A(void 0,q.line,5,2);F.style("fill","none").call(e.dashLine,q.line.dash,W),W&&l.stroke(F,q.line.color)})})}},{"../../lib":803,"../../registry":931,"../../traces/pie/helpers":1197,"../../traces/pie/style_one":1203,"../../traces/scatter/subtypes":1243,"../color":666,"../colorscale/helpers":677,"../drawing":688,"./constants":717,"@plotly/d3":58}],725:[function(i,B,V){i("./constants"),B.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":727}],726:[function(i,B,V){var t=i("../../registry"),h=i("../../plots/plots"),p=i("../../plots/cartesian/axis_ids"),u=i("../../fonts/ploticon"),e=i("../shapes/draw").eraseActiveShape,l=i("../../lib"),o=l._,a=B.exports={};function n(v,T){var _,k,E=T.currentTarget,A=E.getAttribute("data-attr"),b=E.getAttribute("data-val")||!0,L=v._fullLayout,w={},C=p.list(v,null,!0),S=L._cartesianSpikesEnabled;if(A==="zoom"){var P,z=b==="in"?.5:2,F=(1+z)/2,q=(1-z)/2;for(k=0;k<C.length;k++)if(!(_=C[k]).fixedrange)if(P=_._name,b==="auto")w[P+".autorange"]=!0;else if(b==="reset"){if(_._rangeInitial===void 0)w[P+".autorange"]=!0;else{var W=_._rangeInitial.slice();w[P+".range[0]"]=W[0],w[P+".range[1]"]=W[1]}_._showSpikeInitial!==void 0&&(w[P+".showspikes"]=_._showSpikeInitial,S!=="on"||_._showSpikeInitial||(S="off"))}else{var X=[_.r2l(_.range[0]),_.r2l(_.range[1])],Q=[F*X[0]+q*X[1],F*X[1]+q*X[0]];w[P+".range[0]"]=_.l2r(Q[0]),w[P+".range[1]"]=_.l2r(Q[1])}}else A!=="hovermode"||b!=="x"&&b!=="y"||(b=L._isHoriz?"y":"x",E.setAttribute("data-val",b)),w[A]=b;L._cartesianSpikesEnabled=S,t.call("_guiRelayout",v,w)}function s(v,T){for(var _=T.currentTarget,k=_.getAttribute("data-attr"),E=_.getAttribute("data-val")||!0,A=v._fullLayout._subplots.gl3d||[],b={},L=k.split("."),w=0;w<A.length;w++)b[A[w]+"."+L[1]]=E;var C=E==="pan"?E:"zoom";b.dragmode=C,t.call("_guiRelayout",v,b)}function r(v,T){for(var _=T.currentTarget.getAttribute("data-attr"),k=_==="resetLastSave",E=_==="resetDefault",A=v._fullLayout,b=A._subplots.gl3d||[],L={},w=0;w<b.length;w++){var C,S=b[w],P=S+".camera",z=S+".aspectratio",F=S+".aspectmode",q=A[S]._scene;k?(L[P+".up"]=q.viewInitial.up,L[P+".eye"]=q.viewInitial.eye,L[P+".center"]=q.viewInitial.center,C=!0):E&&(L[P+".up"]=null,L[P+".eye"]=null,L[P+".center"]=null,C=!0),C&&(L[z+".x"]=q.viewInitial.aspectratio.x,L[z+".y"]=q.viewInitial.aspectratio.y,L[z+".z"]=q.viewInitial.aspectratio.z,L[F]=q.viewInitial.aspectmode)}t.call("_guiRelayout",v,L)}function c(v,T){var _=T.currentTarget,k=_._previousVal,E=v._fullLayout,A=E._subplots.gl3d||[],b=["xaxis","yaxis","zaxis"],L={},w={};if(k)w=k,_._previousVal=null;else{for(var C=0;C<A.length;C++){var S=A[C],P=E[S],z=S+".hovermode";L[z]=P.hovermode,w[z]=!1;for(var F=0;F<3;F++){var q=b[F],W=S+"."+q+".showspikes";w[W]=!1,L[W]=P[q].showspikes}}_._previousVal=L}return w}function f(v,T){for(var _=T.currentTarget,k=_.getAttribute("data-attr"),E=_.getAttribute("data-val")||!0,A=v._fullLayout,b=A._subplots.geo||[],L=0;L<b.length;L++){var w=b[L],C=A[w];if(k==="zoom"){var S=C.projection.scale,P=E==="in"?2*S:.5*S;t.call("_guiRelayout",v,w+".projection.scale",P)}}k==="reset"&&y(v,"geo")}function d(v){var T=v._fullLayout;return!T.hovermode&&(T._has("cartesian")?T._isHoriz?"y":"x":"closest")}function g(v){var T=d(v);t.call("_guiRelayout",v,"hovermode",T)}function m(v,T){for(var _=T.currentTarget.getAttribute("data-val"),k=v._fullLayout,E=k._subplots.mapbox||[],A={},b=0;b<E.length;b++){var L=E[b],w=k[L].zoom,C=_==="in"?1.05*w:w/1.05;A[L+".zoom"]=C}t.call("_guiRelayout",v,A)}function y(v,T){for(var _=v._fullLayout,k=_._subplots[T]||[],E={},A=0;A<k.length;A++)for(var b=k[A],L=_[b]._subplot.viewInitial,w=Object.keys(L),C=0;C<w.length;C++){var S=w[C];E[b+"."+S]=L[S]}t.call("_guiRelayout",v,E)}a.toImage={name:"toImage",title:function(v){var T=(v._context.toImageButtonOptions||{}).format||"png";return o(v,T==="png"?"Download plot as a png":"Download plot")},icon:u.camera,click:function(v){var T=v._context.toImageButtonOptions,_={format:T.format||"png"};l.notifier(o(v,"Taking snapshot - this may take a few seconds"),"long"),_.format!=="svg"&&l.isIE()&&(l.notifier(o(v,"IE only supports svg.  Changing format to svg."),"long"),_.format="svg"),["filename","width","height","scale"].forEach(function(k){k in T&&(_[k]=T[k])}),t.call("downloadImage",v,_).then(function(k){l.notifier(o(v,"Snapshot succeeded")+" - "+k,"long")}).catch(function(){l.notifier(o(v,"Sorry, there was a problem downloading your snapshot!"),"long")})}},a.sendDataToCloud={name:"sendDataToCloud",title:function(v){return o(v,"Edit in Chart Studio")},icon:u.disk,click:function(v){h.sendDataToCloud(v)}},a.editInChartStudio={name:"editInChartStudio",title:function(v){return o(v,"Edit in Chart Studio")},icon:u.pencil,click:function(v){h.sendDataToCloud(v)}},a.zoom2d={name:"zoom2d",_cat:"zoom",title:function(v){return o(v,"Zoom")},attr:"dragmode",val:"zoom",icon:u.zoombox,click:n},a.pan2d={name:"pan2d",_cat:"pan",title:function(v){return o(v,"Pan")},attr:"dragmode",val:"pan",icon:u.pan,click:n},a.select2d={name:"select2d",_cat:"select",title:function(v){return o(v,"Box Select")},attr:"dragmode",val:"select",icon:u.selectbox,click:n},a.lasso2d={name:"lasso2d",_cat:"lasso",title:function(v){return o(v,"Lasso Select")},attr:"dragmode",val:"lasso",icon:u.lasso,click:n},a.drawclosedpath={name:"drawclosedpath",title:function(v){return o(v,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:u.drawclosedpath,click:n},a.drawopenpath={name:"drawopenpath",title:function(v){return o(v,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:u.drawopenpath,click:n},a.drawline={name:"drawline",title:function(v){return o(v,"Draw line")},attr:"dragmode",val:"drawline",icon:u.drawline,click:n},a.drawrect={name:"drawrect",title:function(v){return o(v,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:u.drawrect,click:n},a.drawcircle={name:"drawcircle",title:function(v){return o(v,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:u.drawcircle,click:n},a.eraseshape={name:"eraseshape",title:function(v){return o(v,"Erase active shape")},icon:u.eraseshape,click:e},a.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(v){return o(v,"Zoom in")},attr:"zoom",val:"in",icon:u.zoom_plus,click:n},a.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(v){return o(v,"Zoom out")},attr:"zoom",val:"out",icon:u.zoom_minus,click:n},a.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(v){return o(v,"Autoscale")},attr:"zoom",val:"auto",icon:u.autoscale,click:n},a.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(v){return o(v,"Reset axes")},attr:"zoom",val:"reset",icon:u.home,click:n},a.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(v){return o(v,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:u.tooltip_basic,gravity:"ne",click:n},a.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(v){return o(v,"Compare data on hover")},attr:"hovermode",val:function(v){return v._fullLayout._isHoriz?"y":"x"},icon:u.tooltip_compare,gravity:"ne",click:n},a.zoom3d={name:"zoom3d",_cat:"zoom",title:function(v){return o(v,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:u.zoombox,click:s},a.pan3d={name:"pan3d",_cat:"pan",title:function(v){return o(v,"Pan")},attr:"scene.dragmode",val:"pan",icon:u.pan,click:s},a.orbitRotation={name:"orbitRotation",title:function(v){return o(v,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:u["3d_rotate"],click:s},a.tableRotation={name:"tableRotation",title:function(v){return o(v,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:u["z-axis"],click:s},a.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(v){return o(v,"Reset camera to default")},attr:"resetDefault",icon:u.home,click:r},a.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(v){return o(v,"Reset camera to last save")},attr:"resetLastSave",icon:u.movie,click:r},a.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(v){return o(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:u.tooltip_basic,gravity:"ne",click:function(v,T){var _=c(v,T);t.call("_guiRelayout",v,_)}},a.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(v){return o(v,"Zoom in")},attr:"zoom",val:"in",icon:u.zoom_plus,click:f},a.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(v){return o(v,"Zoom out")},attr:"zoom",val:"out",icon:u.zoom_minus,click:f},a.resetGeo={name:"resetGeo",_cat:"reset",title:function(v){return o(v,"Reset")},attr:"reset",val:null,icon:u.autoscale,click:f},a.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(v){return o(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:u.tooltip_basic,gravity:"ne",click:g},a.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(v){return o(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:u.tooltip_basic,gravity:"ne",click:g},a.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(v){return o(v,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:u.tooltip_basic,gravity:"ne",click:g},a.resetViewSankey={name:"resetSankeyGroup",title:function(v){return o(v,"Reset view")},icon:u.home,click:function(v){for(var T={"node.groups":[],"node.x":[],"node.y":[]},_=0;_<v._fullData.length;_++){var k=v._fullData[_]._viewInitial;T["node.groups"].push(k.node.groups.slice()),T["node.x"].push(k.node.x.slice()),T["node.y"].push(k.node.y.slice())}t.call("restyle",v,T)}},a.toggleHover={name:"toggleHover",title:function(v){return o(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:u.tooltip_basic,gravity:"ne",click:function(v,T){var _=c(v,T);_.hovermode=d(v),t.call("_guiRelayout",v,_)}},a.resetViews={name:"resetViews",title:function(v){return o(v,"Reset views")},icon:u.home,click:function(v,T){var _=T.currentTarget;_.setAttribute("data-attr","zoom"),_.setAttribute("data-val","reset"),n(v,T),_.setAttribute("data-attr","resetLastSave"),r(v,T),y(v,"geo"),y(v,"mapbox")}},a.toggleSpikelines={name:"toggleSpikelines",title:function(v){return o(v,"Toggle Spike Lines")},icon:u.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(v){var T=v._fullLayout,_=T._cartesianSpikesEnabled;T._cartesianSpikesEnabled=_==="on"?"off":"on",t.call("_guiRelayout",v,function(k){for(var E=k._fullLayout._cartesianSpikesEnabled==="on",A=p.list(k,null,!0),b={},L=0;L<A.length;L++){var w=A[L];b[w._name+".showspikes"]=!!E||w._showSpikeInitial}return b}(v))}},a.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(v){return o(v,"Reset view")},attr:"reset",icon:u.home,click:function(v){y(v,"mapbox")}},a.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(v){return o(v,"Zoom in")},attr:"zoom",val:"in",icon:u.zoom_plus,click:m},a.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(v){return o(v,"Zoom out")},attr:"zoom",val:"out",icon:u.zoom_minus,click:m}},{"../../fonts/ploticon":782,"../../lib":803,"../../plots/cartesian/axis_ids":858,"../../plots/plots":917,"../../registry":931,"../shapes/draw":750}],727:[function(i,B,V){var t=i("./buttons"),h=Object.keys(t),p=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],u=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(p),e=[];h.forEach(function(l){(function(o){if(u.indexOf(o._cat||o.name)===-1){var a=o.name,n=(o._cat||o.name).toLowerCase();e.indexOf(a)===-1&&e.push(a),e.indexOf(n)===-1&&e.push(n)}})(t[l])}),e.sort(),B.exports={DRAW_MODES:p,backButtons:u,foreButtons:e}},{"./buttons":726}],728:[function(i,B,V){var t=i("../../lib"),h=i("../color"),p=i("../../plot_api/plot_template"),u=i("./attributes");B.exports=function(e,l){var o=e.modebar||{},a=p.newContainer(l,"modebar");function n(r,c){return t.coerce(o,a,u,r,c)}n("orientation"),n("bgcolor",h.addOpacity(l.paper_bgcolor,.5));var s=h.contrast(h.rgb(l.modebar.bgcolor));n("color",h.addOpacity(s,.3)),n("activecolor",h.addOpacity(s,.7)),n("uirevision",l.uirevision),n("add"),n("remove")}},{"../../lib":803,"../../plot_api/plot_template":843,"../color":666,"./attributes":725}],729:[function(i,B,V){B.exports={moduleType:"component",name:"modebar",layoutAttributes:i("./attributes"),supplyLayoutDefaults:i("./defaults"),manage:i("./manage")}},{"./attributes":725,"./defaults":728,"./manage":730}],730:[function(i,B,V){var t=i("../../plots/cartesian/axis_ids"),h=i("../../traces/scatter/subtypes"),p=i("../../registry"),u=i("../fx/helpers").isUnifiedHover,e=i("./modebar"),l=i("./buttons"),o=i("./constants").DRAW_MODES;B.exports=function(a){var n=a._fullLayout,s=a._context,r=n._modeBar;if(s.displayModeBar||s.watermark){if(!Array.isArray(s.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(s.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var c,f=s.modeBarButtons;c=Array.isArray(f)&&f.length?function(d){for(var g=0;g<d.length;g++)for(var m=d[g],y=0;y<m.length;y++){var v=m[y];if(typeof v=="string"){if(l[v]===void 0)throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));d[g][y]=l[v]}}return d}(f):!s.displayModeBar&&s.watermark?[]:function(d){var g=d._fullLayout,m=d._fullData,y=d._context;function v(ae,ie){if(typeof ie=="string"){if(ie.toLowerCase()===ae.toLowerCase())return!0}else{var he=ie.name,se=ie._cat||ie.name;if(he===ae||se===ae.toLowerCase())return!0}return!1}var T=g.modebar.add;typeof T=="string"&&(T=[T]);var _=g.modebar.remove;typeof _=="string"&&(_=[_]);var k=y.modeBarButtonsToAdd.concat(T.filter(function(ae){for(var ie=0;ie<y.modeBarButtonsToRemove.length;ie++)if(v(ae,y.modeBarButtonsToRemove[ie]))return!1;return!0})),E=y.modeBarButtonsToRemove.concat(_.filter(function(ae){for(var ie=0;ie<y.modeBarButtonsToAdd.length;ie++)if(v(ae,y.modeBarButtonsToAdd[ie]))return!1;return!0})),A=g._has("cartesian"),b=g._has("gl3d"),L=g._has("geo"),w=g._has("pie"),C=g._has("funnelarea"),S=g._has("gl2d"),P=g._has("ternary"),z=g._has("mapbox"),F=g._has("polar"),q=g._has("sankey"),W=function(ae){for(var ie=t.list({_fullLayout:ae},null,!0),he=0;he<ie.length;he++)if(!ie[he].fixedrange)return!1;return!0}(g),X=u(g.hovermode),Q=[];function Z(ae){if(ae.length){for(var ie=[],he=0;he<ae.length;he++){for(var se=ae[he],de=l[se],ce=de.name.toLowerCase(),ve=(de._cat||de.name).toLowerCase(),Ee=!1,Le=0;Le<E.length;Le++){var Te=E[Le].toLowerCase();if(Te===ce||Te===ve){Ee=!0;break}}Ee||ie.push(l[se])}Q.push(ie)}}var Y=["toImage"];y.showEditInChartStudio?Y.push("editInChartStudio"):y.showSendToCloud&&Y.push("sendDataToCloud"),Z(Y);var N=[],J=[],D=[],U=[];(A||S||w||C||P)+L+b+z+F>1?(J=["toggleHover"],D=["resetViews"]):L?(N=["zoomInGeo","zoomOutGeo"],J=["hoverClosestGeo"],D=["resetGeo"]):b?(J=["hoverClosest3d"],D=["resetCameraDefault3d","resetCameraLastSave3d"]):z?(N=["zoomInMapbox","zoomOutMapbox"],J=["toggleHover"],D=["resetViewMapbox"]):S?J=["hoverClosestGl2d"]:w?J=["hoverClosestPie"]:q?(J=["hoverClosestCartesian","hoverCompareCartesian"],D=["resetViewSankey"]):J=["toggleHover"],A&&(J=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(ae){for(var ie=0;ie<ae.length;ie++)if(!p.traceIs(ae[ie],"noHover"))return!1;return!0}(m)||X)&&(J=[]),!A&&!S||W||(N=["zoomIn2d","zoomOut2d","autoScale2d"],D[0]!=="resetViews"&&(D=["resetScale2d"])),b?U=["zoom3d","pan3d","orbitRotation","tableRotation"]:(A||S)&&!W||P?U=["zoom2d","pan2d"]:z||L?U=["pan2d"]:F&&(U=["zoom2d"]),function(ae){for(var ie=!1,he=0;he<ae.length&&!ie;he++){var se=ae[he];se._module&&se._module.selectPoints&&(p.traceIs(se,"scatter-like")?(h.hasMarkers(se)||h.hasText(se))&&(ie=!0):p.traceIs(se,"box-violin")&&se.boxpoints!=="all"&&se.points!=="all"||(ie=!0))}return ie}(m)&&U.push("select2d","lasso2d");var G=[],$=function(ae){G.indexOf(ae)===-1&&J.indexOf(ae)!==-1&&G.push(ae)};if(Array.isArray(k)){for(var K=[],re=0;re<k.length;re++){var ne=k[re];typeof ne=="string"?(ne=ne.toLowerCase(),o.indexOf(ne)!==-1?(g._has("mapbox")||g._has("cartesian"))&&U.push(ne):ne==="togglespikelines"?$("toggleSpikelines"):ne==="togglehover"?$("toggleHover"):ne==="hovercompare"?$("hoverCompareCartesian"):ne==="hoverclosest"?($("hoverClosestCartesian"),$("hoverClosestGeo"),$("hoverClosest3d"),$("hoverClosestGl2d"),$("hoverClosestPie")):ne==="v1hovermode"&&($("toggleHover"),$("hoverClosestCartesian"),$("hoverCompareCartesian"),$("hoverClosestGeo"),$("hoverClosest3d"),$("hoverClosestGl2d"),$("hoverClosestPie"))):K.push(ne)}k=K}return Z(U),Z(N.concat(D)),Z(G),function(ae,ie){if(ie.length)if(Array.isArray(ie[0]))for(var he=0;he<ie.length;he++)ae.push(ie[he]);else ae.push(ie);return ae}(Q,k)}(a),r?r.update(a,c):n._modeBar=e(a,c)}else r&&(r.destroy(),delete n._modeBar)}},{"../../plots/cartesian/axis_ids":858,"../../registry":931,"../../traces/scatter/subtypes":1243,"../fx/helpers":702,"./buttons":726,"./constants":727,"./modebar":731}],731:[function(i,B,V){var t=i("@plotly/d3"),h=i("fast-isnumeric"),p=i("../../lib"),u=i("../../fonts/ploticon"),e=new DOMParser;function l(a){this.container=a.container,this.element=document.createElement("div"),this.update(a.graphInfo,a.buttons),this.container.appendChild(this.element)}var o=l.prototype;o.update=function(a,n){this.graphInfo=a;var s=this.graphInfo._context,r=this.graphInfo._fullLayout,c="modebar-"+r._uid;this.element.setAttribute("id",c),this._uid=c,this.element.className="modebar",s.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),r.modebar.orientation==="v"&&(this.element.className+=" vertical",n=n.reverse());var f=r.modebar,d=s.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";p.deleteRelatedStyleRule(c),p.addRelatedStyleRule(c,d+"#"+c+" .modebar-group","background-color: "+f.bgcolor),p.addRelatedStyleRule(c,"#"+c+" .modebar-btn .icon path","fill: "+f.color),p.addRelatedStyleRule(c,"#"+c+" .modebar-btn:hover .icon path","fill: "+f.activecolor),p.addRelatedStyleRule(c,"#"+c+" .modebar-btn.active .icon path","fill: "+f.activecolor);var g=!this.hasButtons(n),m=this.hasLogo!==s.displaylogo,y=this.locale!==s.locale;if(this.locale=s.locale,(g||m||y)&&(this.removeAllButtons(),this.updateButtons(n),s.watermark||s.displaylogo)){var v=this.getLogo();s.watermark&&(v.className=v.className+" watermark"),r.modebar.orientation==="v"?this.element.insertBefore(v,this.element.childNodes[0]):this.element.appendChild(v),this.hasLogo=!0}this.updateActiveButton()},o.updateButtons=function(a){var n=this;this.buttons=a,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(s){var r=n.createGroup();s.forEach(function(c){var f=c.name;if(!f)throw new Error("must provide button 'name' in button config");if(n.buttonsNames.indexOf(f)!==-1)throw new Error("button name '"+f+"' is taken");n.buttonsNames.push(f);var d=n.createButton(c);n.buttonElements.push(d),r.appendChild(d)}),n.element.appendChild(r)})},o.createGroup=function(){var a=document.createElement("div");return a.className="modebar-group",a},o.createButton=function(a){var n=this,s=document.createElement("a");s.setAttribute("rel","tooltip"),s.className="modebar-btn";var r=a.title;r===void 0?r=a.name:typeof r=="function"&&(r=r(this.graphInfo)),(r||r===0)&&s.setAttribute("data-title",r),a.attr!==void 0&&s.setAttribute("data-attr",a.attr);var c=a.val;if(c!==void 0&&(typeof c=="function"&&(c=c(this.graphInfo)),s.setAttribute("data-val",c)),typeof a.click!="function")throw new Error("must provide button 'click' function in button config");s.addEventListener("click",function(d){a.click(n.graphInfo,d),n.updateActiveButton(d.currentTarget)}),s.setAttribute("data-toggle",a.toggle||!1),a.toggle&&t.select(s).classed("active",!0);var f=a.icon;return typeof f=="function"?s.appendChild(f()):s.appendChild(this.createIcon(f||u.question)),s.setAttribute("data-gravity",a.gravity||"n"),s},o.createIcon=function(a){var n,s=h(a.height)?Number(a.height):a.ascent-a.descent,r="http://www.w3.org/2000/svg";if(a.path){(n=document.createElementNS(r,"svg")).setAttribute("viewBox",[0,0,a.width,s].join(" ")),n.setAttribute("class","icon");var c=document.createElementNS(r,"path");c.setAttribute("d",a.path),a.transform?c.setAttribute("transform",a.transform):a.ascent!==void 0&&c.setAttribute("transform","matrix(1 0 0 -1 0 "+a.ascent+")"),n.appendChild(c)}return a.svg&&(n=e.parseFromString(a.svg,"application/xml").childNodes[0]),n.setAttribute("height","1em"),n.setAttribute("width","1em"),n},o.updateActiveButton=function(a){var n=this.graphInfo._fullLayout,s=a!==void 0?a.getAttribute("data-attr"):null;this.buttonElements.forEach(function(r){var c=r.getAttribute("data-val")||!0,f=r.getAttribute("data-attr"),d=r.getAttribute("data-toggle")==="true",g=t.select(r);if(d)f===s&&g.classed("active",!g.classed("active"));else{var m=f===null?f:p.nestedProperty(n,f).get();g.classed("active",m===c)}})},o.hasButtons=function(a){var n=this.buttons;if(!n||a.length!==n.length)return!1;for(var s=0;s<a.length;++s){if(a[s].length!==n[s].length)return!1;for(var r=0;r<a[s].length;r++)if(a[s][r].name!==n[s][r].name)return!1}return!0},o.getLogo=function(){var a=this.createGroup(),n=document.createElement("a");return n.href="https://plotly.com/",n.target="_blank",n.setAttribute("data-title",p._(this.graphInfo,"Produced with Plotly")),n.className="modebar-btn plotlyjsicon modebar-btn--logo",n.appendChild(this.createIcon(u.newplotlylogo)),a.appendChild(n),a},o.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},o.destroy=function(){p.removeElement(this.container.querySelector(".modebar")),p.deleteRelatedStyleRule(this._uid)},B.exports=function(a,n){var s=a._fullLayout,r=new l({graphInfo:a,container:s._modebardiv.node(),buttons:n});return s._privateplot&&t.select(r.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),r}},{"../../fonts/ploticon":782,"../../lib":803,"@plotly/d3":58,"fast-isnumeric":249}],732:[function(i,B,V){var t=i("../../plots/font_attributes"),h=i("../color/attributes"),p=(0,i("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});B.exports={visible:{valType:"boolean",editType:"plot"},buttons:p,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:t({editType:"plot"}),bgcolor:{valType:"color",dflt:h.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:h.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":843,"../../plots/font_attributes":883,"../color/attributes":665}],733:[function(i,B,V){B.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],734:[function(i,B,V){var t=i("../../lib"),h=i("../color"),p=i("../../plot_api/plot_template"),u=i("../../plots/array_container_defaults"),e=i("./attributes"),l=i("./constants");function o(a,n,s,r){var c=r.calendar;function f(g,m){return t.coerce(a,n,e.buttons,g,m)}if(f("visible")){var d=f("step");d!=="all"&&(!c||c==="gregorian"||d!=="month"&&d!=="year"?f("stepmode"):n.stepmode="backward",f("count")),f("label")}}B.exports=function(a,n,s,r,c){var f=a.rangeselector||{},d=p.newContainer(n,"rangeselector");function g(v,T){return t.coerce(f,d,e,v,T)}if(g("visible",u(f,d,{name:"buttons",handleItemDefaults:o,calendar:c}).length>0)){var m=function(v,T,_){for(var k=_.filter(function(L){return T[L].anchor===v._id}),E=0,A=0;A<k.length;A++){var b=T[k[A]].domain;b&&(E=Math.max(b[1],E))}return[v.domain[0],E+l.yPad]}(n,s,r);g("x",m[0]),g("y",m[1]),t.noneOrAll(a,n,["x","y"]),g("xanchor"),g("yanchor"),t.coerceFont(g,"font",s.font);var y=g("bgcolor");g("activecolor",h.contrast(y,l.lightAmount,l.darkAmount)),g("bordercolor"),g("borderwidth")}}},{"../../lib":803,"../../plot_api/plot_template":843,"../../plots/array_container_defaults":849,"../color":666,"./attributes":732,"./constants":733}],735:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../registry"),p=i("../../plots/plots"),u=i("../color"),e=i("../drawing"),l=i("../../lib"),o=l.strTranslate,a=i("../../lib/svg_text_utils"),n=i("../../plots/cartesian/axis_ids"),s=i("../../constants/alignment"),r=s.LINE_SPACING,c=s.FROM_TL,f=s.FROM_BR,d=i("./constants"),g=i("./get_update_object");function m(T){return T._id}function y(T,_,k){var E=l.ensureSingle(T,"rect","selector-rect",function(A){A.attr("shape-rendering","crispEdges")});E.attr({rx:d.rx,ry:d.ry}),E.call(u.stroke,_.bordercolor).call(u.fill,function(A,b){return b._isActive||b._isHovered?A.activecolor:A.bgcolor}(_,k)).style("stroke-width",_.borderwidth+"px")}function v(T,_,k,E){l.ensureSingle(T,"text","selector-text",function(A){A.attr("text-anchor","middle")}).call(e.font,_.font).text(function(A,b){return A.label?b?l.templateString(A.label,b):A.label:A.step==="all"?"all":A.count+A.step.charAt(0)}(k,E._fullLayout._meta)).call(function(A){a.convertToTspans(A,E)})}B.exports=function(T){var _=T._fullLayout._infolayer.selectAll(".rangeselector").data(function(k){for(var E=n.list(k,"x",!0),A=[],b=0;b<E.length;b++){var L=E[b];L.rangeselector&&L.rangeselector.visible&&A.push(L)}return A}(T),m);_.enter().append("g").classed("rangeselector",!0),_.exit().remove(),_.style({cursor:"pointer","pointer-events":"all"}),_.each(function(k){var E=t.select(this),A=k,b=A.rangeselector,L=E.selectAll("g.button").data(l.filterVisible(b.buttons));L.enter().append("g").classed("button",!0),L.exit().remove(),L.each(function(w){var C=t.select(this),S=g(A,w);w._isActive=function(P,z,F){if(z.step==="all")return P.autorange===!0;var q=Object.keys(F);return P.range[0]===F[q[0]]&&P.range[1]===F[q[1]]}(A,w,S),C.call(y,b,w),C.call(v,b,w,T),C.on("click",function(){T._dragged||h.call("_guiRelayout",T,S)}),C.on("mouseover",function(){w._isHovered=!0,C.call(y,b,w)}),C.on("mouseout",function(){w._isHovered=!1,C.call(y,b,w)})}),function(w,C,S,P,z){var F=0,q=0,W=S.borderwidth;C.each(function(){var J=t.select(this).select(".selector-text"),D=S.font.size*r,U=Math.max(D*a.lineCount(J),16)+3;q=Math.max(q,U)}),C.each(function(){var J=t.select(this),D=J.select(".selector-rect"),U=J.select(".selector-text"),G=U.node()&&e.bBox(U.node()).width,$=S.font.size*r,K=a.lineCount(U),re=Math.max(G+10,d.minButtonWidth);J.attr("transform",o(W+F,W)),D.attr({x:0,y:0,width:re,height:q}),a.positionText(U,re/2,q/2-(K-1)*$/2+3),F+=re+5});var X=w._fullLayout._size,Q=X.l+X.w*S.x,Z=X.t+X.h*(1-S.y),Y="left";l.isRightAnchor(S)&&(Q-=F,Y="right"),l.isCenterAnchor(S)&&(Q-=F/2,Y="center");var N="top";l.isBottomAnchor(S)&&(Z-=q,N="bottom"),l.isMiddleAnchor(S)&&(Z-=q/2,N="middle"),F=Math.ceil(F),q=Math.ceil(q),Q=Math.round(Q),Z=Math.round(Z),p.autoMargin(w,P+"-range-selector",{x:S.x,y:S.y,l:F*c[Y],r:F*f[Y],b:q*f[N],t:q*c[N]}),z.attr("transform",o(Q,Z))}(T,L,b,A._name,E)})}},{"../../constants/alignment":771,"../../lib":803,"../../lib/svg_text_utils":829,"../../plots/cartesian/axis_ids":858,"../../plots/plots":917,"../../registry":931,"../color":666,"../drawing":688,"./constants":733,"./get_update_object":736,"@plotly/d3":58}],736:[function(i,B,V){var t=i("d3-time"),h=i("../../lib").titleCase;B.exports=function(p,u){var e=p._name,l={};if(u.step==="all")l[e+".autorange"]=!0;else{var o=function(a,n){var s,r=a.range,c=new Date(a.r2l(r[1])),f=n.step,d=t["utc"+h(f)],g=n.count;switch(n.stepmode){case"backward":s=a.l2r(+d.offset(c,-g));break;case"todate":var m=d.offset(c,-g);s=a.l2r(+d.ceil(m))}var y=r[1];return[s,y]}(p,u);l[e+".range[0]"]=o[0],l[e+".range[1]"]=o[1]}return l}},{"../../lib":803,"d3-time":177}],737:[function(i,B,V){B.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:i("./attributes")}}},layoutAttributes:i("./attributes"),handleDefaults:i("./defaults"),draw:i("./draw")}},{"./attributes":732,"./defaults":734,"./draw":735}],738:[function(i,B,V){var t=i("../color/attributes");B.exports={bgcolor:{valType:"color",dflt:t.background,editType:"plot"},bordercolor:{valType:"color",dflt:t.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":665}],739:[function(i,B,V){var t=i("../../plots/cartesian/axis_ids").list,h=i("../../plots/cartesian/autorange").getAutoRange,p=i("./constants");B.exports=function(u){for(var e=t(u,"x",!0),l=0;l<e.length;l++){var o=e[l],a=o[p.name];a&&a.visible&&a.autorange&&(a._input.autorange=!0,a._input.range=a.range=h(u,o))}}},{"../../plots/cartesian/autorange":853,"../../plots/cartesian/axis_ids":858,"./constants":740}],740:[function(i,B,V){B.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],741:[function(i,B,V){var t=i("../../lib"),h=i("../../plot_api/plot_template"),p=i("../../plots/cartesian/axis_ids"),u=i("./attributes"),e=i("./oppaxis_attributes");B.exports=function(l,o,a){var n=l[a],s=o[a];if(n.rangeslider||o._requestRangeslider[s._id]){t.isPlainObject(n.rangeslider)||(n.rangeslider={});var r,c,f=n.rangeslider,d=h.newContainer(s,"rangeslider");if(E("visible")){E("bgcolor",o.plot_bgcolor),E("bordercolor"),E("borderwidth"),E("thickness"),E("autorange",!s.isValidRange(f.range)),E("range");var g=o._subplots;if(g)for(var m=g.cartesian.filter(function(b){return b.substr(0,b.indexOf("y"))===p.name2id(a)}).map(function(b){return b.substr(b.indexOf("y"),b.length)}),y=t.simpleMap(m,p.id2name),v=0;v<y.length;v++){var T=y[v];r=f[T]||{},c=h.newContainer(d,T,"yaxis");var _,k=o[T];r.range&&k.isValidRange(r.range)&&(_="fixed"),A("rangemode",_)!=="match"&&A("range",k.range.slice())}d._input=f}}function E(b,L){return t.coerce(f,d,u,b,L)}function A(b,L){return t.coerce(r,c,e,b,L)}}},{"../../lib":803,"../../plot_api/plot_template":843,"../../plots/cartesian/axis_ids":858,"./attributes":738,"./oppaxis_attributes":745}],742:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../registry"),p=i("../../plots/plots"),u=i("../../lib"),e=u.strTranslate,l=i("../drawing"),o=i("../color"),a=i("../titles"),n=i("../../plots/cartesian"),s=i("../../plots/cartesian/axis_ids"),r=i("../dragelement"),c=i("../../lib/setcursor"),f=i("./constants");function d(_,k,E,A){var b=u.ensureSingle(_,"rect",f.bgClassName,function(S){S.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),L=A.borderwidth%2==0?A.borderwidth:A.borderwidth-1,w=-A._offsetShift,C=l.crispRound(k,A.borderwidth);b.attr({width:A._width+L,height:A._height+L,transform:e(w,w),fill:A.bgcolor,stroke:A.bordercolor,"stroke-width":C})}function g(_,k,E,A){var b=k._fullLayout;u.ensureSingleById(b._topdefs,"clipPath",A._clipId,function(L){L.append("rect").attr({x:0,y:0})}).select("rect").attr({width:A._width,height:A._height})}function m(_,k,E,A){var b,L=k.calcdata,w=_.selectAll("g."+f.rangePlotClassName).data(E._subplotsWith,u.identity);w.enter().append("g").attr("class",function(C){return f.rangePlotClassName+" "+C}).call(l.setClipUrl,A._clipId,k),w.order(),w.exit().remove(),w.each(function(C,S){var P=t.select(this),z=S===0,F=s.getFromId(k,C,"y"),q=F._name,W=A[q],X={data:[],layout:{xaxis:{type:E.type,domain:[0,1],range:A.range.slice(),calendar:E.calendar},width:A._width,height:A._height,margin:{t:0,b:0,l:0,r:0}},_context:k._context};E.rangebreaks&&(X.layout.xaxis.rangebreaks=E.rangebreaks),X.layout[q]={type:F.type,domain:[0,1],range:W.rangemode!=="match"?W.range.slice():F.range.slice(),calendar:F.calendar},F.rangebreaks&&(X.layout[q].rangebreaks=F.rangebreaks),p.supplyDefaults(X);var Q=X._fullLayout.xaxis,Z=X._fullLayout[q];Q.clearCalc(),Q.setScale(),Z.clearCalc(),Z.setScale();var Y={id:C,plotgroup:P,xaxis:Q,yaxis:Z,isRangePlot:!0};z?b=Y:(Y.mainplot="xy",Y.mainplotinfo=b),n.rangePlot(k,Y,function(N,J){for(var D=[],U=0;U<N.length;U++){var G=N[U],$=G[0].trace;$.xaxis+$.yaxis===J&&D.push(G)}return D}(L,C))})}function y(_,k,E,A,b){u.ensureSingle(_,"rect",f.maskMinClassName,function(L){L.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",A._height).call(o.fill,f.maskColor),u.ensureSingle(_,"rect",f.maskMaxClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",A._height).call(o.fill,f.maskColor),b.rangemode!=="match"&&(u.ensureSingle(_,"rect",f.maskMinOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",A._width).call(o.fill,f.maskOppAxisColor),u.ensureSingle(_,"rect",f.maskMaxOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",A._width).style("border-top",f.maskOppBorder).call(o.fill,f.maskOppAxisColor))}function v(_,k,E,A){k._context.staticPlot||u.ensureSingle(_,"rect",f.slideBoxClassName,function(b){b.attr({y:0,cursor:f.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:A._height,fill:f.slideBoxFill})}function T(_,k,E,A){var b=u.ensureSingle(_,"g",f.grabberMinClassName),L=u.ensureSingle(_,"g",f.grabberMaxClassName),w={x:0,width:f.handleWidth,rx:f.handleRadius,fill:o.background,stroke:o.defaultLine,"stroke-width":f.handleStrokeWidth,"shape-rendering":"crispEdges"},C={y:Math.round(A._height/4),height:Math.round(A._height/2)};u.ensureSingle(b,"rect",f.handleMinClassName,function(P){P.attr(w)}).attr(C),u.ensureSingle(L,"rect",f.handleMaxClassName,function(P){P.attr(w)}).attr(C);var S={width:f.grabAreaWidth,x:0,y:0,fill:f.grabAreaFill,cursor:k._context.staticPlot?void 0:f.grabAreaCursor};u.ensureSingle(b,"rect",f.grabAreaMinClassName,function(P){P.attr(S)}).attr("height",A._height),u.ensureSingle(L,"rect",f.grabAreaMaxClassName,function(P){P.attr(S)}).attr("height",A._height)}B.exports=function(_){for(var k=_._fullLayout,E=k._rangeSliderData,A=0;A<E.length;A++){var b=E[A][f.name];b._clipId=b._id+"-"+k._uid}var L=k._infolayer.selectAll("g."+f.containerClassName).data(E,function(w){return w._name});L.exit().each(function(w){var C=w[f.name];k._topdefs.select("#"+C._clipId).remove()}).remove(),E.length!==0&&(L.enter().append("g").classed(f.containerClassName,!0).attr("pointer-events","all"),L.each(function(w){var C=t.select(this),S=w[f.name],P=k[s.id2name(w.anchor)],z=S[s.id2name(w.anchor)];if(S.range){var F,q=u.simpleMap(S.range,w.r2l),W=u.simpleMap(w.range,w.r2l);F=W[0]<W[1]?[Math.min(q[0],W[0]),Math.max(q[1],W[1])]:[Math.max(q[0],W[0]),Math.min(q[1],W[1])],S.range=S._input.range=u.simpleMap(F,w.l2r)}w.cleanRange("rangeslider.range");var X=k._size,Q=w.domain;S._width=X.w*(Q[1]-Q[0]);var Z=Math.round(X.l+X.w*Q[0]),Y=Math.round(X.t+X.h*(1-w._counterDomainMin)+(w.side==="bottom"?w._depth:0)+S._offsetShift+f.extraPad);C.attr("transform",e(Z,Y)),S._rl=u.simpleMap(S.range,w.r2l);var N=S._rl[0],J=S._rl[1],D=J-N;if(S.p2d=function(he){return he/S._width*D+N},S.d2p=function(he){return(he-N)/D*S._width},w.rangebreaks){var U=w.locateBreaks(N,J);if(U.length){var G,$,K=0;for(G=0;G<U.length;G++)K+=($=U[G]).max-$.min;var re=S._width/(J-N-K),ne=[-re*N];for(G=0;G<U.length;G++)$=U[G],ne.push(ne[ne.length-1]-re*($.max-$.min));for(S.d2p=function(he){for(var se=ne[0],de=0;de<U.length;de++){var ce=U[de];if(he>=ce.max)se=ne[de+1];else if(he<ce.min)break}return se+re*he},G=0;G<U.length;G++)($=U[G]).pmin=S.d2p($.min),$.pmax=S.d2p($.max);S.p2d=function(he){for(var se=ne[0],de=0;de<U.length;de++){var ce=U[de];if(he>=ce.pmax)se=ne[de+1];else if(he<ce.pmin)break}return(he-se)/re}}}if(z.rangemode!=="match"){var ae=P.r2l(z.range[0]),ie=P.r2l(z.range[1])-ae;S.d2pOppAxis=function(he){return(he-ae)/ie*S._height}}C.call(d,_,w,S).call(g,_,w,S).call(m,_,w,S).call(y,_,w,S,z).call(v,_,w,S).call(T,_,w,S),function(he,se,de,ce){if(se._context.staticPlot)return;var ve=he.select("rect."+f.slideBoxClassName).node(),Ee=he.select("rect."+f.grabAreaMinClassName).node(),Le=he.select("rect."+f.grabAreaMaxClassName).node();function Te(){var xe=t.event,fe=xe.target,ge=xe.clientX||xe.touches[0].clientX,ke=ge-he.node().getBoundingClientRect().left,Me=ce.d2p(de._rl[0]),Se=ce.d2p(de._rl[1]),De=r.coverSlip();function Be(Qe){var Oe,Ue,Xe,Ye=+(Qe.clientX||Qe.touches[0].clientX)-ge;switch(fe){case ve:Xe="ew-resize",Oe=Me+Ye,Ue=Se+Ye;break;case Ee:Xe="col-resize",Oe=Me+Ye,Ue=Se;break;case Le:Xe="col-resize",Oe=Me,Ue=Se+Ye;break;default:Xe="ew-resize",Oe=ke,Ue=ke+Ye}if(Ue<Oe){var $e=Ue;Ue=Oe,Oe=$e}ce._pixelMin=Oe,ce._pixelMax=Ue,c(t.select(De),Xe),function(it,ot,Et,mt){function tt(Jt){return Et.l2r(u.constrain(Jt,mt._rl[0],mt._rl[1]))}var Ke=tt(mt.p2d(mt._pixelMin)),Mt=tt(mt.p2d(mt._pixelMax));window.requestAnimationFrame(function(){h.call("_guiRelayout",ot,Et._name+".range",[Ke,Mt])})}(0,se,de,ce)}function We(){De.removeEventListener("mousemove",Be),De.removeEventListener("mouseup",We),this.removeEventListener("touchmove",Be),this.removeEventListener("touchend",We),u.removeElement(De)}this.addEventListener("touchmove",Be),this.addEventListener("touchend",We),De.addEventListener("mousemove",Be),De.addEventListener("mouseup",We)}he.on("mousedown",Te),he.on("touchstart",Te)}(C,_,w,S),function(he,se,de,ce,ve,Ee){var Le=f.handleWidth/2;function Te(We){return u.constrain(We,0,ce._width)}function xe(We){return u.constrain(We,0,ce._height)}function fe(We){return u.constrain(We,-Le,ce._width+Le)}var ge=Te(ce.d2p(de._rl[0])),ke=Te(ce.d2p(de._rl[1]));if(he.select("rect."+f.slideBoxClassName).attr("x",ge).attr("width",ke-ge),he.select("rect."+f.maskMinClassName).attr("width",ge),he.select("rect."+f.maskMaxClassName).attr("x",ke).attr("width",ce._width-ke),Ee.rangemode!=="match"){var Me=ce._height-xe(ce.d2pOppAxis(ve._rl[1])),Se=ce._height-xe(ce.d2pOppAxis(ve._rl[0]));he.select("rect."+f.maskMinOppAxisClassName).attr("x",ge).attr("height",Me).attr("width",ke-ge),he.select("rect."+f.maskMaxOppAxisClassName).attr("x",ge).attr("y",Se).attr("height",ce._height-Se).attr("width",ke-ge),he.select("rect."+f.slideBoxClassName).attr("y",Me).attr("height",Se-Me)}var De=Math.round(fe(ge-Le))-.5,Be=Math.round(fe(ke-Le))+.5;he.select("g."+f.grabberMinClassName).attr("transform",e(De,.5)),he.select("g."+f.grabberMaxClassName).attr("transform",e(Be,.5))}(C,0,w,S,P,z),w.side==="bottom"&&a.draw(_,w._id+"title",{propContainer:w,propName:w._name+".title",placeholder:k._dfltTitle.x,attributes:{x:w._offset+w._length/2,y:Y+S._height+S._offsetShift+10+1.5*w.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":803,"../../lib/setcursor":824,"../../plots/cartesian":868,"../../plots/cartesian/axis_ids":858,"../../plots/plots":917,"../../registry":931,"../color":666,"../dragelement":685,"../drawing":688,"../titles":764,"./constants":740,"@plotly/d3":58}],743:[function(i,B,V){var t=i("../../plots/cartesian/axis_ids"),h=i("../../lib/svg_text_utils"),p=i("./constants"),u=i("../../constants/alignment").LINE_SPACING,e=p.name;function l(o){var a=o&&o[e];return a&&a.visible}V.isVisible=l,V.makeData=function(o){var a=t.list({_fullLayout:o},"x",!0),n=o.margin,s=[];if(!o._has("gl2d"))for(var r=0;r<a.length;r++){var c=a[r];if(l(c)){s.push(c);var f=c[e];f._id=e+c._id,f._height=(o.height-n.b-n.t)*f.thickness,f._offsetShift=Math.floor(f.borderwidth/2)}}o._rangeSliderData=s},V.autoMarginOpts=function(o,a){var n=o._fullLayout,s=a[e],r=a._id.charAt(0),c=0,f=0;return a.side==="bottom"&&(c=a._depth,a.title.text!==n._dfltTitle[r]&&(f=1.5*a.title.font.size+10+s._offsetShift,f+=(a.title.text.match(h.BR_TAG_ALL)||[]).length*a.title.font.size*u)),{x:0,y:a._counterDomainMin,l:0,r:0,t:0,b:s._height+c+Math.max(n.margin.b,f),pad:p.extraPad+2*s._offsetShift}}},{"../../constants/alignment":771,"../../lib/svg_text_utils":829,"../../plots/cartesian/axis_ids":858,"./constants":740}],744:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("./oppaxis_attributes"),u=i("./helpers");B.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:t.extendFlat({},h,{yaxis:p})}}},layoutAttributes:i("./attributes"),handleDefaults:i("./defaults"),calcAutorange:i("./calc_autorange"),draw:i("./draw"),isVisible:u.isVisible,makeData:u.makeData,autoMarginOpts:u.autoMarginOpts}},{"../../lib":803,"./attributes":738,"./calc_autorange":739,"./defaults":741,"./draw":742,"./helpers":743,"./oppaxis_attributes":745}],745:[function(i,B,V){B.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],746:[function(i,B,V){var t=i("../annotations/attributes"),h=i("../../traces/scatter/attributes").line,p=i("../drawing/attributes").dash,u=i("../../lib/extend").extendFlat,e=i("../../plot_api/plot_template").templatedArray;i("../../constants/axis_placeable_objects"),B.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:u({},t.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:u({},t.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:u({},h.color,{editType:"arraydraw"}),width:u({},h.width,{editType:"calc+arraydraw"}),dash:u({},p,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":772,"../../lib/extend":793,"../../plot_api/plot_template":843,"../../traces/scatter/attributes":1218,"../annotations/attributes":649,"../drawing/attributes":687}],747:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes"),p=i("./constants"),u=i("./helpers");function e(n){return o(n.line.width,n.xsizemode,n.x0,n.x1,n.path,!1)}function l(n){return o(n.line.width,n.ysizemode,n.y0,n.y1,n.path,!0)}function o(n,s,r,c,f,d){var g=n/2,m=d;if(s==="pixel"){var y=f?u.extractPathCoords(f,d?p.paramIsY:p.paramIsX):[r,c],v=t.aggNums(Math.max,null,y),T=t.aggNums(Math.min,null,y),_=T<0?Math.abs(T)+g:g,k=v>0?v+g:g;return{ppad:g,ppadplus:m?_:k,ppadminus:m?k:_}}return{ppad:g}}function a(n,s,r,c,f){var d=n.type==="category"||n.type==="multicategory"?n.r2c:n.d2c;if(s!==void 0)return[d(s),d(r)];if(c){var g,m,y,v,T=1/0,_=-1/0,k=c.match(p.segmentRE);for(n.type==="date"&&(d=u.decodeDate(d)),g=0;g<k.length;g++)(m=f[k[g].charAt(0)].drawn)!==void 0&&(!(y=k[g].substr(1).match(p.paramRE))||y.length<m||((v=d(y[m]))<T&&(T=v),v>_&&(_=v)));return _>=T?[T,_]:void 0}}B.exports=function(n){var s=n._fullLayout,r=t.filterVisible(s.shapes);if(r.length&&n._fullData.length)for(var c=0;c<r.length;c++){var f,d,g=r[c];g._extremes={};var m=h.getRefType(g.xref),y=h.getRefType(g.yref);if(g.xref!=="paper"&&m!=="domain"){var v=g.xsizemode==="pixel"?g.xanchor:g.x0,T=g.xsizemode==="pixel"?g.xanchor:g.x1;(d=a(f=h.getFromId(n,g.xref),v,T,g.path,p.paramIsX))&&(g._extremes[f._id]=h.findExtremes(f,d,e(g)))}if(g.yref!=="paper"&&y!=="domain"){var _=g.ysizemode==="pixel"?g.yanchor:g.y0,k=g.ysizemode==="pixel"?g.yanchor:g.y1;(d=a(f=h.getFromId(n,g.yref),_,k,g.path,p.paramIsY))&&(g._extremes[f._id]=h.findExtremes(f,d,l(g)))}}}},{"../../lib":803,"../../plots/cartesian/axes":854,"./constants":748,"./helpers":757}],748:[function(i,B,V){B.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],749:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes"),p=i("../../plots/array_container_defaults"),u=i("./attributes"),e=i("./helpers");function l(o,a,n){function s(z,F){return t.coerce(o,a,u,z,F)}if(s("visible")){var r=s("path"),c=s("type",r?"path":"rect");a.type!=="path"&&delete a.path,s("editable"),s("layer"),s("opacity"),s("fillcolor"),s("fillrule"),s("line.width")&&(s("line.color"),s("line.dash"));for(var f=s("xsizemode"),d=s("ysizemode"),g=["x","y"],m=0;m<2;m++){var y,v,T,_=g[m],k=_+"anchor",E=_==="x"?f:d,A={_fullLayout:n},b=h.coerceRef(o,a,A,_,void 0,"paper");if(h.getRefType(b)==="range"?((y=h.getFromId(A,b))._shapeIndices.push(a._index),T=e.rangeToShapePosition(y),v=e.shapePositionToRange(y)):v=T=t.identity,c!=="path"){var L=_+"0",w=_+"1",C=o[L],S=o[w];o[L]=v(o[L],!0),o[w]=v(o[w],!0),E==="pixel"?(s(L,0),s(w,10)):(h.coercePosition(a,A,s,b,L,.25),h.coercePosition(a,A,s,b,w,.75)),a[L]=T(a[L]),a[w]=T(a[w]),o[L]=C,o[w]=S}if(E==="pixel"){var P=o[k];o[k]=v(o[k],!0),h.coercePosition(a,A,s,b,k,.25),a[k]=T(a[k]),o[k]=P}}c==="path"?s("path"):t.noneOrAll(o,a,["x0","x1","y0","y1"])}}B.exports=function(o,a){p(o,a,{name:"shapes",handleItemDefaults:l})}},{"../../lib":803,"../../plots/array_container_defaults":849,"../../plots/cartesian/axes":854,"./attributes":746,"./helpers":757}],750:[function(i,B,V){var t=i("../../registry"),h=i("../../lib"),p=i("../../plots/cartesian/axes"),u=i("./draw_newshape/helpers").readPaths,e=i("./draw_newshape/display_outlines"),l=i("../../plots/cartesian/handle_outline").clearOutlineControllers,o=i("../color"),a=i("../drawing"),n=i("../../plot_api/plot_template").arrayEditor,s=i("../dragelement"),r=i("../../lib/setcursor"),c=i("./constants"),f=i("./helpers");function d(E){var A=E._fullLayout;for(var b in A._shapeUpperLayer.selectAll("path").remove(),A._shapeLowerLayer.selectAll("path").remove(),A._plots){var L=A._plots[b].shapelayer;L&&L.selectAll("path").remove()}for(var w=0;w<A.shapes.length;w++)A.shapes[w].visible&&y(E,w)}function g(E){return!!E._fullLayout._drawing}function m(E){return!E._context.edits.shapePosition}function y(E,A){E._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+A+'"]').remove();var b=f.makeOptionsAndPlotinfo(E,A),L=b.options,w=b.plotinfo;L._input&&L.visible!==!1&&(L.layer!=="below"?C(E._fullLayout._shapeUpperLayer):L.xref==="paper"||L.yref==="paper"?C(E._fullLayout._shapeLowerLayer):w._hadPlotinfo?C((w.mainplotinfo||w).shapelayer):C(E._fullLayout._shapeLowerLayer));function C(S){var P=T(E,L),z={"data-index":A,"fill-rule":L.fillrule,d:P},F=L.opacity,q=L.fillcolor,W=L.line.width?L.line.color:"rgba(0,0,0,0)",X=L.line.width,Q=L.line.dash;X||L.editable!==!0||(X=5,Q="solid");var Z=P[P.length-1]!=="Z",Y=m(E)&&L.editable&&E._fullLayout._activeShapeIndex===A;Y&&(q=Z?"rgba(0,0,0,0)":E._fullLayout.activeshape.fillcolor,F=E._fullLayout.activeshape.opacity);var N,J=S.append("path").attr(z).style("opacity",F).call(o.stroke,W).call(o.fill,q).call(a.dashLine,Q,X);if(v(J,E,L),(Y||E._context.edits.shapePosition)&&(N=n(E.layout,"shapes",L)),Y){J.style({cursor:"move"});var D={element:J.node(),plotinfo:w,gd:E,editHelpers:N,isActiveShape:!0},U=u(P,E);e(U,J,D)}else E._context.edits.shapePosition?function(G,$,K,re,ne,ae){var ie,he,se,de,ce,ve,Ee,Le,Te,xe,fe,ge,ke,Me,Se,De,Be=K.xsizemode==="pixel",We=K.ysizemode==="pixel",Qe=K.type==="line",Oe=K.type==="path",Ue=ae.modifyItem,Xe=p.getFromId(G,K.xref),Ye=p.getRefType(K.xref),$e=p.getFromId(G,K.yref),it=p.getRefType(K.yref),ot=f.getDataToPixel(G,Xe,!1,Ye),Et=f.getDataToPixel(G,$e,!0,it),mt=f.getPixelToData(G,Xe,!1,Ye),tt=f.getPixelToData(G,$e,!0,it),Ke=Qe?function(){var Ie=Math.max(K.line.width,10),be=ne.append("g").attr("data-index",re);be.append("path").attr("d",$.attr("d")).style({cursor:"move","stroke-width":Ie,"stroke-opacity":"0"});var Ae={"fill-opacity":"0"},Pe=Math.max(Ie/2,10);return be.append("circle").attr({"data-line-point":"start-point",cx:Be?ot(K.xanchor)+K.x0:ot(K.x0),cy:We?Et(K.yanchor)-K.y0:Et(K.y0),r:Pe}).style(Ae).classed("cursor-grab",!0),be.append("circle").attr({"data-line-point":"end-point",cx:Be?ot(K.xanchor)+K.x1:ot(K.x1),cy:We?Et(K.yanchor)-K.y1:Et(K.y1),r:Pe}).style(Ae).classed("cursor-grab",!0),be}():$,Mt={element:Ke.node(),gd:G,prepFn:function(Ie){g(G)||(Be&&(ce=ot(K.xanchor)),We&&(ve=Et(K.yanchor)),K.type==="path"?Se=K.path:(ie=Be?K.x0:ot(K.x0),he=We?K.y0:Et(K.y0),se=Be?K.x1:ot(K.x1),de=We?K.y1:Et(K.y1)),ie<se?(Te=ie,ke="x0",xe=se,Me="x1"):(Te=se,ke="x1",xe=ie,Me="x0"),!We&&he<de||We&&he>de?(Ee=he,fe="y0",Le=de,ge="y1"):(Ee=de,fe="y1",Le=he,ge="y0"),Jt(Ie),Ge(ne,K),function(be,Ae,Pe){var ze=Ae.xref,qe=Ae.yref,ht=p.getFromId(Pe,ze),at=p.getFromId(Pe,qe),nt="";ze==="paper"||ht.autorange||(nt+=ze),qe==="paper"||at.autorange||(nt+=qe),a.setClipUrl(be,nt?"clip"+Pe._fullLayout._uid+nt:null,Pe)}($,K,G),Mt.moveFn=De==="move"?$t:je,Mt.altKey=Ie.altKey)},doneFn:function(){g(G)||(r($),Ct(ne),v($,G,K),t.call("_guiRelayout",G,ae.getUpdateObj()))},clickFn:function(){g(G)||Ct(ne)}};function Jt(Ie){if(g(G))De=null;else if(Qe)De=Ie.target.tagName==="path"?"move":Ie.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var be=Mt.element.getBoundingClientRect(),Ae=be.right-be.left,Pe=be.bottom-be.top,ze=Ie.clientX-be.left,qe=Ie.clientY-be.top,ht=!Oe&&Ae>10&&Pe>10&&!Ie.shiftKey?s.getCursor(ze/Ae,1-qe/Pe):"move";r($,ht),De=ht.split("-")[0]}}function $t(Ie,be){if(K.type==="path"){var Ae=function(qe){return qe},Pe=Ae,ze=Ae;Be?Ue("xanchor",K.xanchor=mt(ce+Ie)):(Pe=function(qe){return mt(ot(qe)+Ie)},Xe&&Xe.type==="date"&&(Pe=f.encodeDate(Pe))),We?Ue("yanchor",K.yanchor=tt(ve+be)):(ze=function(qe){return tt(Et(qe)+be)},$e&&$e.type==="date"&&(ze=f.encodeDate(ze))),Ue("path",K.path=_(Se,Pe,ze))}else Be?Ue("xanchor",K.xanchor=mt(ce+Ie)):(Ue("x0",K.x0=mt(ie+Ie)),Ue("x1",K.x1=mt(se+Ie))),We?Ue("yanchor",K.yanchor=tt(ve+be)):(Ue("y0",K.y0=tt(he+be)),Ue("y1",K.y1=tt(de+be)));$.attr("d",T(G,K)),Ge(ne,K)}function je(Ie,be){if(Oe){var Ae=function(Ce){return Ce},Pe=Ae,ze=Ae;Be?Ue("xanchor",K.xanchor=mt(ce+Ie)):(Pe=function(Ce){return mt(ot(Ce)+Ie)},Xe&&Xe.type==="date"&&(Pe=f.encodeDate(Pe))),We?Ue("yanchor",K.yanchor=tt(ve+be)):(ze=function(Ce){return tt(Et(Ce)+be)},$e&&$e.type==="date"&&(ze=f.encodeDate(ze))),Ue("path",K.path=_(Se,Pe,ze))}else if(Qe){if(De==="resize-over-start-point"){var qe=ie+Ie,ht=We?he-be:he+be;Ue("x0",K.x0=Be?qe:mt(qe)),Ue("y0",K.y0=We?ht:tt(ht))}else if(De==="resize-over-end-point"){var at=se+Ie,nt=We?de-be:de+be;Ue("x1",K.x1=Be?at:mt(at)),Ue("y1",K.y1=We?nt:tt(nt))}}else{var xt=function(Ce){return De.indexOf(Ce)!==-1},Lt=xt("n"),bt=xt("s"),St=xt("w"),st=xt("e"),It=Lt?Ee+be:Ee,jt=bt?Le+be:Le,Ut=St?Te+Ie:Te,zt=st?xe+Ie:xe;We&&(Lt&&(It=Ee-be),bt&&(jt=Le-be)),(!We&&jt-It>10||We&&It-jt>10)&&(Ue(fe,K[fe]=We?It:tt(It)),Ue(ge,K[ge]=We?jt:tt(jt))),zt-Ut>10&&(Ue(ke,K[ke]=Be?Ut:mt(Ut)),Ue(Me,K[Me]=Be?zt:mt(zt)))}$.attr("d",T(G,K)),Ge(ne,K)}function Ge(Ie,be){(Be||We)&&function(){var Ae=be.type!=="path",Pe=Ie.selectAll(".visual-cue").data([0]);Pe.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var ze=ot(Be?be.xanchor:h.midRange(Ae?[be.x0,be.x1]:f.extractPathCoords(be.path,c.paramIsX))),qe=Et(We?be.yanchor:h.midRange(Ae?[be.y0,be.y1]:f.extractPathCoords(be.path,c.paramIsY)));if(ze=f.roundPositionForSharpStrokeRendering(ze,1),qe=f.roundPositionForSharpStrokeRendering(qe,1),Be&&We){var ht="M"+(ze-1-1)+","+(qe-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";Pe.attr("d",ht)}else if(Be){var at="M"+(ze-1-1)+","+(qe-9-1)+"v18 h2 v-18 Z";Pe.attr("d",at)}else{var nt="M"+(ze-9-1)+","+(qe-1-1)+"h18 v2 h-18 Z";Pe.attr("d",nt)}}()}function Ct(Ie){Ie.selectAll(".visual-cue").remove()}s.init(Mt),Ke.node().onmousemove=Jt}(E,J,L,A,S,N):L.editable===!0&&J.style("pointer-events",Z||o.opacity(q)*F<=.5?"stroke":"all");J.node().addEventListener("click",function(){return function(G,$){if(m(G)){var K=+$.node().getAttribute("data-index");if(K>=0){if(K===G._fullLayout._activeShapeIndex)return void k(G);G._fullLayout._activeShapeIndex=K,G._fullLayout._deactivateShape=k,d(G)}}}(E,J)})}}function v(E,A,b){var L=(b.xref+b.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");a.setClipUrl(E,L?"clip"+A._fullLayout._uid+L:null,A)}function T(E,A){var b,L,w,C,S,P,z,F,q=A.type,W=p.getRefType(A.xref),X=p.getRefType(A.yref),Q=p.getFromId(E,A.xref),Z=p.getFromId(E,A.yref),Y=E._fullLayout._size;if(Q?W==="domain"?L=function(ne){return Q._offset+Q._length*ne}:(b=f.shapePositionToRange(Q),L=function(ne){return Q._offset+Q.r2p(b(ne,!0))}):L=function(ne){return Y.l+Y.w*ne},Z?X==="domain"?C=function(ne){return Z._offset+Z._length*(1-ne)}:(w=f.shapePositionToRange(Z),C=function(ne){return Z._offset+Z.r2p(w(ne,!0))}):C=function(ne){return Y.t+Y.h*(1-ne)},q==="path")return Q&&Q.type==="date"&&(L=f.decodeDate(L)),Z&&Z.type==="date"&&(C=f.decodeDate(C)),function(ne,ae,ie){var he=ne.path,se=ne.xsizemode,de=ne.ysizemode,ce=ne.xanchor,ve=ne.yanchor;return he.replace(c.segmentRE,function(Ee){var Le=0,Te=Ee.charAt(0),xe=c.paramIsX[Te],fe=c.paramIsY[Te],ge=c.numParams[Te],ke=Ee.substr(1).replace(c.paramRE,function(Me){return xe[Le]?Me=se==="pixel"?ae(ce)+Number(Me):ae(Me):fe[Le]&&(Me=de==="pixel"?ie(ve)-Number(Me):ie(Me)),++Le>ge&&(Me="X"),Me});return Le>ge&&(ke=ke.replace(/[\s,]*X.*/,""),h.log("Ignoring extra params in segment "+Ee)),Te+ke})}(A,L,C);if(A.xsizemode==="pixel"){var N=L(A.xanchor);S=N+A.x0,P=N+A.x1}else S=L(A.x0),P=L(A.x1);if(A.ysizemode==="pixel"){var J=C(A.yanchor);z=J-A.y0,F=J-A.y1}else z=C(A.y0),F=C(A.y1);if(q==="line")return"M"+S+","+z+"L"+P+","+F;if(q==="rect")return"M"+S+","+z+"H"+P+"V"+F+"H"+S+"Z";var D=(S+P)/2,U=(z+F)/2,G=Math.abs(D-S),$=Math.abs(U-z),K="A"+G+","+$,re=D+G+","+U;return"M"+re+K+" 0 1,1 "+(D+","+(U-$))+K+" 0 0,1 "+re+"Z"}function _(E,A,b){return E.replace(c.segmentRE,function(L){var w=0,C=L.charAt(0),S=c.paramIsX[C],P=c.paramIsY[C],z=c.numParams[C];return C+L.substr(1).replace(c.paramRE,function(F){return w>=z||(S[w]?F=A(F):P[w]&&(F=b(F)),w++),F})})}function k(E){m(E)&&E._fullLayout._activeShapeIndex>=0&&(l(E),delete E._fullLayout._activeShapeIndex,d(E))}B.exports={draw:d,drawOne:y,eraseActiveShape:function(E){if(m(E)){l(E);var A=E._fullLayout._activeShapeIndex,b=(E.layout||{}).shapes||[];if(A<b.length){for(var L=[],w=0;w<b.length;w++)w!==A&&L.push(b[w]);delete E._fullLayout._activeShapeIndex,t.call("_guiRelayout",E,{shapes:L})}}}}},{"../../lib":803,"../../lib/setcursor":824,"../../plot_api/plot_template":843,"../../plots/cartesian/axes":854,"../../plots/cartesian/handle_outline":865,"../../registry":931,"../color":666,"../dragelement":685,"../drawing":688,"./constants":748,"./draw_newshape/display_outlines":754,"./draw_newshape/helpers":755,"./helpers":757}],751:[function(i,B,V){var t=i("../../drawing/attributes").dash,h=i("../../../lib/extend").extendFlat;B.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:h({},t,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":793,"../../drawing/attributes":687}],752:[function(i,B,V){B.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],753:[function(i,B,V){var t=i("../../color");B.exports=function(h,p,u){if(u("newshape.drawdirection"),u("newshape.layer"),u("newshape.fillcolor"),u("newshape.fillrule"),u("newshape.opacity"),u("newshape.line.width")){var e=(h||{}).plot_bgcolor||"#FFF";u("newshape.line.color",t.contrast(e)),u("newshape.line.dash")}u("activeshape.fillcolor"),u("activeshape.opacity")}},{"../../color":666}],754:[function(i,B,V){var t=i("../../dragelement"),h=i("../../dragelement/helpers").drawMode,p=i("../../../registry"),u=i("./constants"),e=u.i000,l=u.i090,o=u.i180,a=u.i270,n=i("../../../plots/cartesian/handle_outline").clearOutlineControllers,s=i("./helpers"),r=s.pointsShapeRectangle,c=s.pointsShapeEllipse,f=s.writePaths,d=i("./newshapes");B.exports=function g(m,y,v,T){T||(T=0);var _=v.gd;function k(){g(m,y,v,T++),c(m[0])&&E({redrawing:!0})}function E(N){v.isActiveShape=!1;var J=d(y,v);Object.keys(J).length&&p.call((N||{}).redrawing?"relayout":"_guiRelayout",_,J)}var A,b,L,w,C,S=v.isActiveShape,P=_._fullLayout._zoomlayer,z=v.dragmode;h(z)?_._fullLayout._drawing=!0:_._fullLayout._activeShapeIndex>=0&&n(_),y.attr("d",f(m)),S&&!T&&(C=function(N,J){for(var D=0;D<J.length;D++){var U=J[D];N[D]=[];for(var G=0;G<U.length;G++){N[D][G]=[];for(var $=0;$<U[G].length;$++)N[D][G][$]=U[G][$]}}return N}([],m),function(N){A=[];for(var J=0;J<m.length;J++){var D=m[J],U=!r(D)&&c(D);A[J]=[];for(var G=0;G<D.length;G++)if(D[G][0]!=="Z"&&(!U||G===e||G===l||G===o||G===a)){var $=D[G][1],K=D[G][2],re=N.append("circle").classed("cursor-grab",!0).attr("data-i",J).attr("data-j",G).attr("cx",$).attr("cy",K).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});A[J][G]={element:re.node(),gd:_,prepFn:F,doneFn:W,clickFn:X},t.init(A[J][G])}}}(P.append("g").attr("class","outline-controllers")),function(){b=[],m.length&&(b[0]={element:y[0][0],gd:_,prepFn:Z,doneFn:Y},t.init(b[0]))}());function F(N){L=+N.srcElement.getAttribute("data-i"),w=+N.srcElement.getAttribute("data-j"),A[L][w].moveFn=q}function q(N,J){if(m.length){var D=C[L][w][1],U=C[L][w][2],G=m[L],$=G.length;if(r(G)){for(var K=0;K<$;K++)if(K!==w){var re=G[K];re[1]===G[w][1]&&(re[1]=D+N),re[2]===G[w][2]&&(re[2]=U+J)}if(G[w][1]=D+N,G[w][2]=U+J,!r(G))for(var ne=0;ne<$;ne++)for(var ae=0;ae<G[ne].length;ae++)G[ne][ae]=C[L][ne][ae]}else G[w][1]=D+N,G[w][2]=U+J;k()}}function W(){E()}function X(N,J){if(N===2){L=+J.srcElement.getAttribute("data-i"),w=+J.srcElement.getAttribute("data-j");var D=m[L];r(D)||c(D)||function(){if(m.length&&m[L]&&m[L].length){for(var U=[],G=0;G<m[L].length;G++)G!==w&&U.push(m[L][G]);U.length>1&&(U.length!==2||U[1][0]!=="Z")&&(w===0&&(U[0][0]="M"),m[L]=U,k(),E())}}()}}function Q(N,J){(function(D,U){if(m.length)for(var G=0;G<m.length;G++)for(var $=0;$<m[G].length;$++)for(var K=0;K+2<m[G][$].length;K+=2)m[G][$][K+1]=C[G][$][K+1]+D,m[G][$][K+2]=C[G][$][K+2]+U})(N,J),k()}function Z(N){(L=+N.srcElement.getAttribute("data-i"))||(L=0),b[L].moveFn=Q}function Y(){E()}}},{"../../../plots/cartesian/handle_outline":865,"../../../registry":931,"../../dragelement":685,"../../dragelement/helpers":684,"./constants":752,"./helpers":755,"./newshapes":756}],755:[function(i,B,V){var t=i("parse-svg-path"),h=i("./constants"),p=h.CIRCLE_SIDES,u=h.SQRT2,e=i("../../../plots/cartesian/helpers"),l=e.p2r,o=e.r2p,a=[0,3,4,5,6,1,2],n=[0,3,4,1,2];function s(c,f){return Math.abs(c-f)<=1e-6}function r(c,f){var d=f[1]-c[1],g=f[2]-c[2];return Math.sqrt(d*d+g*g)}V.writePaths=function(c){var f=c.length;if(!f)return"M0,0Z";for(var d="",g=0;g<f;g++)for(var m=c[g].length,y=0;y<m;y++){var v=c[g][y][0];if(v==="Z")d+="Z";else for(var T=c[g][y].length,_=0;_<T;_++){var k=_;v==="Q"||v==="S"?k=n[_]:v==="C"&&(k=a[_]),d+=c[g][y][k],_>0&&_<T-1&&(d+=",")}}return d},V.readPaths=function(c,f,d,g){var m,y,v,T=t(c),_=[],k=-1,E=0,A=0,b=function(){y=E,v=A};b();for(var L=0;L<T.length;L++){var w,C,S,P,z=[],F=T[L][0],q=F;switch(F){case"M":k++,_[k]=[],E=+T[L][1],A=+T[L][2],z.push([q,E,A]),b();break;case"Q":case"S":w=+T[L][1],S=+T[L][2],E=+T[L][3],A=+T[L][4],z.push([q,E,A,w,S]);break;case"C":w=+T[L][1],S=+T[L][2],C=+T[L][3],P=+T[L][4],E=+T[L][5],A=+T[L][6],z.push([q,E,A,w,S,C,P]);break;case"T":case"L":E=+T[L][1],A=+T[L][2],z.push([q,E,A]);break;case"H":q="L",E=+T[L][1],z.push([q,E,A]);break;case"V":q="L",A=+T[L][1],z.push([q,E,A]);break;case"A":q="L";var W=+T[L][1],X=+T[L][2];+T[L][4]||(W=-W,X=-X);var Q=E-W,Z=A;for(m=1;m<=p/2;m++){var Y=2*Math.PI*m/p;z.push([q,Q+W*Math.cos(Y),Z+X*Math.sin(Y)])}break;case"Z":E===y&&A===v||(E=y,A=v,z.push([q,E,A]))}for(var N=(d||{}).domain,J=f._fullLayout._size,D=d&&d.xsizemode==="pixel",U=d&&d.ysizemode==="pixel",G=g===!1,$=0;$<z.length;$++){for(m=0;m+2<7;m+=2){var K=z[$][m+1],re=z[$][m+2];K!==void 0&&re!==void 0&&(E=K,A=re,d&&(d.xaxis&&d.xaxis.p2r?(G&&(K-=d.xaxis._offset),K=D?o(d.xaxis,d.xanchor)+K:l(d.xaxis,K)):(G&&(K-=J.l),N?K=N.x[0]+K/J.w:K/=J.w),d.yaxis&&d.yaxis.p2r?(G&&(re-=d.yaxis._offset),re=U?o(d.yaxis,d.yanchor)-re:l(d.yaxis,re)):(G&&(re-=J.t),re=N?N.y[1]-re/J.h:1-re/J.h)),z[$][m+1]=K,z[$][m+2]=re)}_[k].push(z[$].slice())}}return _},V.pointsShapeRectangle=function(c){if(c.length!==5)return!1;for(var f=1;f<3;f++)if(!s(c[0][f]-c[1][f],c[3][f]-c[2][f])||!s(c[0][f]-c[3][f],c[1][f]-c[2][f]))return!1;return!(!s(c[0][1],c[1][1])&&!s(c[0][1],c[3][1]))&&!!(r(c[0],c[1])*r(c[0],c[3]))},V.pointsShapeEllipse=function(c){var f=c.length;if(f!==p+1)return!1;f=p;for(var d=0;d<f;d++){var g=(2*f-d)%f,m=(f/2+g)%f,y=(f/2+d)%f;if(!s(r(c[d],c[y]),r(c[g],c[m])))return!1}return!0},V.handleEllipse=function(c,f,d){if(!c)return[f,d];var g=V.ellipseOver({x0:f[0],y0:f[1],x1:d[0],y1:d[1]}),m=(g.x1+g.x0)/2,y=(g.y1+g.y0)/2,v=(g.x1-g.x0)/2,T=(g.y1-g.y0)/2;v||(v=T/=u),T||(T=v/=u);for(var _=[],k=0;k<p;k++){var E=2*k*Math.PI/p;_.push([m+v*Math.cos(E),y+T*Math.sin(E)])}return _},V.ellipseOver=function(c){var f=c.x0,d=c.y0,g=c.x1,m=c.y1,y=g-f,v=m-d,T=((f-=y)+g)/2,_=((d-=v)+m)/2;return{x0:T-(y*=u),y0:_-(v*=u),x1:T+y,y1:_+v}}},{"../../../plots/cartesian/helpers":866,"./constants":752,"parse-svg-path":493}],756:[function(i,B,V){var t=i("../../dragelement/helpers"),h=t.drawMode,p=t.openMode,u=i("./constants"),e=u.i000,l=u.i090,o=u.i180,a=u.i270,n=u.cos45,s=u.sin45,r=i("../../../plots/cartesian/helpers"),c=r.p2r,f=r.r2p,d=i("../../../plots/cartesian/handle_outline").clearSelect,g=i("./helpers"),m=g.readPaths,y=g.writePaths,v=g.ellipseOver;B.exports=function(T,_){if(T.length){var k=T[0][0];if(k){var E=k.getAttribute("d"),A=_.gd,b=A._fullLayout.newshape,L=_.plotinfo,w=L.xaxis,C=L.yaxis,S=!!L.domain||!L.xaxis,P=!!L.domain||!L.yaxis,z=_.isActiveShape,F=_.dragmode,q=(A.layout||{}).shapes||[];if(!h(F)&&z!==void 0){var W=A._fullLayout._activeShapeIndex;if(W<q.length)switch(A._fullLayout.shapes[W].type){case"rect":F="drawrect";break;case"circle":F="drawcircle";break;case"line":F="drawline";break;case"path":var X=q[W].path||"";F=X[X.length-1]==="Z"?"drawclosedpath":"drawopenpath"}}var Q,Z=p(F),Y=m(E,A,L,z),N={editable:!0,xref:S?"paper":w._id,yref:P?"paper":C._id,layer:b.layer,opacity:b.opacity,line:{color:b.line.color,width:b.line.width,dash:b.line.dash}};if(Z||(N.fillcolor=b.fillcolor,N.fillrule=b.fillrule),Y.length===1&&(Q=Y[0]),Q&&F==="drawrect")N.type="rect",N.x0=Q[0][1],N.y0=Q[0][2],N.x1=Q[2][1],N.y1=Q[2][2];else if(Q&&F==="drawline")N.type="line",N.x0=Q[0][1],N.y0=Q[0][2],N.x1=Q[1][1],N.y1=Q[1][2];else if(Q&&F==="drawcircle"){N.type="circle";var J=Q[e][1],D=Q[l][1],U=Q[o][1],G=Q[a][1],$=Q[e][2],K=Q[l][2],re=Q[o][2],ne=Q[a][2],ae=L.xaxis&&(L.xaxis.type==="date"||L.xaxis.type==="log"),ie=L.yaxis&&(L.yaxis.type==="date"||L.yaxis.type==="log");ae&&(J=f(L.xaxis,J),D=f(L.xaxis,D),U=f(L.xaxis,U),G=f(L.xaxis,G)),ie&&($=f(L.yaxis,$),K=f(L.yaxis,K),re=f(L.yaxis,re),ne=f(L.yaxis,ne));var he=(D+G)/2,se=($+re)/2,de=v({x0:he,y0:se,x1:he+(G-D+U-J)/2*n,y1:se+(ne-K+re-$)/2*s});ae&&(de.x0=c(L.xaxis,de.x0),de.x1=c(L.xaxis,de.x1)),ie&&(de.y0=c(L.yaxis,de.y0),de.y1=c(L.yaxis,de.y1)),N.x0=de.x0,N.y0=de.y0,N.x1=de.x1,N.y1=de.y1}else N.type="path",w&&C&&function(fe,ge,ke){var Me=ge.type==="date",Se=ke.type==="date";if(!Me&&!Se)return fe;for(var De=0;De<fe.length;De++)for(var Be=0;Be<fe[De].length;Be++)for(var We=0;We+2<fe[De][Be].length;We+=2)Me&&(fe[De][Be][We+1]=fe[De][Be][We+1].replace(" ","_")),Se&&(fe[De][Be][We+2]=fe[De][Be][We+2].replace(" ","_"))}(Y,w,C),N.path=y(Y),Q=null;d(A);for(var ce=_.editHelpers,ve=(ce||{}).modifyItem,Ee=[],Le=0;Le<q.length;Le++){var Te=A._fullLayout.shapes[Le];if(Ee[Le]=Te._input,z!==void 0&&Le===A._fullLayout._activeShapeIndex){var xe=N;switch(Te.type){case"line":case"rect":case"circle":ve("x0",xe.x0),ve("x1",xe.x1),ve("y0",xe.y0),ve("y1",xe.y1);break;case"path":ve("path",xe.path)}}}return z===void 0?(Ee.push(N),Ee):ce?ce.getUpdateObj():{}}}}},{"../../../plots/cartesian/handle_outline":865,"../../../plots/cartesian/helpers":866,"../../dragelement/helpers":684,"./constants":752,"./helpers":755}],757:[function(i,B,V){var t=i("./constants"),h=i("../../lib");V.rangeToShapePosition=function(p){return p.type==="log"?p.r2d:function(u){return u}},V.shapePositionToRange=function(p){return p.type==="log"?p.d2r:function(u){return u}},V.decodeDate=function(p){return function(u){return u.replace&&(u=u.replace("_"," ")),p(u)}},V.encodeDate=function(p){return function(u){return p(u).replace(" ","_")}},V.extractPathCoords=function(p,u){var e=[];return p.match(t.segmentRE).forEach(function(l){var o=u[l.charAt(0)].drawn;if(o!==void 0){var a=l.substr(1).match(t.paramRE);!a||a.length<o||e.push(h.cleanNumber(a[o]))}}),e},V.getDataToPixel=function(p,u,e,l){var o,a=p._fullLayout._size;if(u)if(l==="domain")o=function(s){return u._length*(e?1-s:s)+u._offset};else{var n=V.shapePositionToRange(u);o=function(s){return u._offset+u.r2p(n(s,!0))},u.type==="date"&&(o=V.decodeDate(o))}else o=e?function(s){return a.t+a.h*(1-s)}:function(s){return a.l+a.w*s};return o},V.getPixelToData=function(p,u,e,l){var o,a=p._fullLayout._size;if(u)if(l==="domain")o=function(s){var r=(s-u._offset)/u._length;return e?1-r:r};else{var n=V.rangeToShapePosition(u);o=function(s){return n(u.p2r(s-u._offset))}}else o=e?function(s){return 1-(s-a.t)/a.h}:function(s){return(s-a.l)/a.w};return o},V.roundPositionForSharpStrokeRendering=function(p,u){var e=Math.round(u%2)===1,l=Math.round(p);return e?l+.5:l},V.makeOptionsAndPlotinfo=function(p,u){var e=p._fullLayout.shapes[u]||{},l=p._fullLayout._plots[e.xref+e.yref];return l?l._hadPlotinfo=!0:(l={},e.xref&&e.xref!=="paper"&&(l.xaxis=p._fullLayout[e.xref+"axis"]),e.yref&&e.yref!=="paper"&&(l.yaxis=p._fullLayout[e.yref+"axis"])),l.xsizemode=e.xsizemode,l.ysizemode=e.ysizemode,l.xanchor=e.xanchor,l.yanchor=e.yanchor,{options:e,plotinfo:l}}},{"../../lib":803,"./constants":748}],758:[function(i,B,V){var t=i("./draw");B.exports={moduleType:"component",name:"shapes",layoutAttributes:i("./attributes"),supplyLayoutDefaults:i("./defaults"),supplyDrawNewShapeDefaults:i("./draw_newshape/defaults"),includeBasePlot:i("../../plots/cartesian/include_components")("shapes"),calcAutorange:i("./calc_autorange"),draw:t.draw,drawOne:t.drawOne}},{"../../plots/cartesian/include_components":867,"./attributes":746,"./calc_autorange":747,"./defaults":749,"./draw":750,"./draw_newshape/defaults":753}],759:[function(i,B,V){var t=i("../../plots/font_attributes"),h=i("../../plots/pad_attributes"),p=i("../../lib/extend").extendDeepAll,u=i("../../plot_api/edit_types").overrideAll,e=i("../../plots/animation_attributes"),l=i("../../plot_api/plot_template").templatedArray,o=i("./constants"),a=l("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});B.exports=u(l("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:a,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:p(h({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:t({})},font:t({}),activebgcolor:{valType:"color",dflt:o.gripBgActiveColor},bgcolor:{valType:"color",dflt:o.railBgColor},bordercolor:{valType:"color",dflt:o.railBorderColor},borderwidth:{valType:"number",min:0,dflt:o.railBorderWidth},ticklen:{valType:"number",min:0,dflt:o.tickLength},tickcolor:{valType:"color",dflt:o.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:o.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plot_api/plot_template":843,"../../plots/animation_attributes":848,"../../plots/font_attributes":883,"../../plots/pad_attributes":916,"./constants":760}],760:[function(i,B,V){B.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],761:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/array_container_defaults"),p=i("./attributes"),u=i("./constants").name,e=p.steps;function l(a,n,s){function r(m,y){return t.coerce(a,n,p,m,y)}for(var c=h(a,n,{name:"steps",handleItemDefaults:o}),f=0,d=0;d<c.length;d++)c[d].visible&&f++;if(f<2?n.visible=!1:r("visible")){n._stepCount=f;var g=n._visibleSteps=t.filterVisible(c);(c[r("active")]||{}).visible||(n.active=g[0]._index),r("x"),r("y"),t.noneOrAll(a,n,["x","y"]),r("xanchor"),r("yanchor"),r("len"),r("lenmode"),r("pad.t"),r("pad.r"),r("pad.b"),r("pad.l"),t.coerceFont(r,"font",s.font),r("currentvalue.visible")&&(r("currentvalue.xanchor"),r("currentvalue.prefix"),r("currentvalue.suffix"),r("currentvalue.offset"),t.coerceFont(r,"currentvalue.font",n.font)),r("transition.duration"),r("transition.easing"),r("bgcolor"),r("activebgcolor"),r("bordercolor"),r("borderwidth"),r("ticklen"),r("tickwidth"),r("tickcolor"),r("minorticklen")}}function o(a,n){function s(c,f){return t.coerce(a,n,e,c,f)}if(a.method==="skip"||Array.isArray(a.args)?s("visible"):n.visible=!1){s("method"),s("args");var r=s("label","step-"+n._index);s("value",r),s("execute")}}B.exports=function(a,n){h(a,n,{name:u,handleItemDefaults:l})}},{"../../lib":803,"../../plots/array_container_defaults":849,"./attributes":759,"./constants":760}],762:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../plots/plots"),p=i("../color"),u=i("../drawing"),e=i("../../lib"),l=e.strTranslate,o=i("../../lib/svg_text_utils"),a=i("../../plot_api/plot_template").arrayEditor,n=i("./constants"),s=i("../../constants/alignment"),r=s.LINE_SPACING,c=s.FROM_TL,f=s.FROM_BR;function d(z){return n.autoMarginIdRoot+z._index}function g(z){return z._index}function m(z,F){var q=u.tester.selectAll("g."+n.labelGroupClass).data(F._visibleSteps);q.enter().append("g").classed(n.labelGroupClass,!0);var W=0,X=0;q.each(function($){var K=T(t.select(this),{step:$},F).node();if(K){var re=u.bBox(K);X=Math.max(X,re.height),W=Math.max(W,re.width)}}),q.remove();var Q=F._dims={};Q.inputAreaWidth=Math.max(n.railWidth,n.gripHeight);var Z=z._fullLayout._size;Q.lx=Z.l+Z.w*F.x,Q.ly=Z.t+Z.h*(1-F.y),F.lenmode==="fraction"?Q.outerLength=Math.round(Z.w*F.len):Q.outerLength=F.len,Q.inputAreaStart=0,Q.inputAreaLength=Math.round(Q.outerLength-F.pad.l-F.pad.r);var Y=(Q.inputAreaLength-2*n.stepInset)/(F._stepCount-1),N=W+n.labelPadding;if(Q.labelStride=Math.max(1,Math.ceil(N/Y)),Q.labelHeight=X,Q.currentValueMaxWidth=0,Q.currentValueHeight=0,Q.currentValueTotalHeight=0,Q.currentValueMaxLines=1,F.currentvalue.visible){var J=u.tester.append("g");q.each(function($){var K=y(J,F,$.label),re=K.node()&&u.bBox(K.node())||{width:0,height:0},ne=o.lineCount(K);Q.currentValueMaxWidth=Math.max(Q.currentValueMaxWidth,Math.ceil(re.width)),Q.currentValueHeight=Math.max(Q.currentValueHeight,Math.ceil(re.height)),Q.currentValueMaxLines=Math.max(Q.currentValueMaxLines,ne)}),Q.currentValueTotalHeight=Q.currentValueHeight+F.currentvalue.offset,J.remove()}Q.height=Q.currentValueTotalHeight+n.tickOffset+F.ticklen+n.labelOffset+Q.labelHeight+F.pad.t+F.pad.b;var D="left";e.isRightAnchor(F)&&(Q.lx-=Q.outerLength,D="right"),e.isCenterAnchor(F)&&(Q.lx-=Q.outerLength/2,D="center");var U="top";e.isBottomAnchor(F)&&(Q.ly-=Q.height,U="bottom"),e.isMiddleAnchor(F)&&(Q.ly-=Q.height/2,U="middle"),Q.outerLength=Math.ceil(Q.outerLength),Q.height=Math.ceil(Q.height),Q.lx=Math.round(Q.lx),Q.ly=Math.round(Q.ly);var G={y:F.y,b:Q.height*f[U],t:Q.height*c[U]};F.lenmode==="fraction"?(G.l=0,G.xl=F.x-F.len*c[D],G.r=0,G.xr=F.x+F.len*f[D]):(G.x=F.x,G.l=Q.outerLength*c[D],G.r=Q.outerLength*f[D]),h.autoMargin(z,d(F),G)}function y(z,F,q){if(F.currentvalue.visible){var W,X,Q=F._dims;switch(F.currentvalue.xanchor){case"right":W=Q.inputAreaLength-n.currentValueInset-Q.currentValueMaxWidth,X="left";break;case"center":W=.5*Q.inputAreaLength,X="middle";break;default:W=n.currentValueInset,X="left"}var Z=e.ensureSingle(z,"text",n.labelClass,function(G){G.attr({"text-anchor":X,"data-notex":1})}),Y=F.currentvalue.prefix?F.currentvalue.prefix:"";if(typeof q=="string")Y+=q;else{var N=F.steps[F.active].label,J=F._gd._fullLayout._meta;J&&(N=e.templateString(N,J)),Y+=N}F.currentvalue.suffix&&(Y+=F.currentvalue.suffix),Z.call(u.font,F.currentvalue.font).text(Y).call(o.convertToTspans,F._gd);var D=o.lineCount(Z),U=(Q.currentValueMaxLines+1-D)*F.currentvalue.font.size*r;return o.positionText(Z,W,U),Z}}function v(z,F,q){e.ensureSingle(z,"rect",n.gripRectClass,function(W){W.call(A,F,z,q).style("pointer-events","all")}).attr({width:n.gripWidth,height:n.gripHeight,rx:n.gripRadius,ry:n.gripRadius}).call(p.stroke,q.bordercolor).call(p.fill,q.bgcolor).style("stroke-width",q.borderwidth+"px")}function T(z,F,q){var W=e.ensureSingle(z,"text",n.labelClass,function(Z){Z.attr({"text-anchor":"middle","data-notex":1})}),X=F.step.label,Q=q._gd._fullLayout._meta;return Q&&(X=e.templateString(X,Q)),W.call(u.font,q.font).text(X).call(o.convertToTspans,q._gd),W}function _(z,F){var q=e.ensureSingle(z,"g",n.labelsClass),W=F._dims,X=q.selectAll("g."+n.labelGroupClass).data(W.labelSteps);X.enter().append("g").classed(n.labelGroupClass,!0),X.exit().remove(),X.each(function(Q){var Z=t.select(this);Z.call(T,Q,F),u.setTranslate(Z,w(F,Q.fraction),n.tickOffset+F.ticklen+F.font.size*r+n.labelOffset+W.currentValueTotalHeight)})}function k(z,F,q,W,X){var Q=Math.round(W*(q._stepCount-1)),Z=q._visibleSteps[Q]._index;Z!==q.active&&E(z,F,q,Z,!0,X)}function E(z,F,q,W,X,Q){var Z=q.active;q.active=W,a(z.layout,n.name,q).applyUpdate("active",W);var Y=q.steps[q.active];F.call(L,q,Q),F.call(y,q),z.emit("plotly_sliderchange",{slider:q,step:q.steps[q.active],interaction:X,previousActive:Z}),Y&&Y.method&&X&&(F._nextMethod?(F._nextMethod.step=Y,F._nextMethod.doCallback=X,F._nextMethod.doTransition=Q):(F._nextMethod={step:Y,doCallback:X,doTransition:Q},F._nextMethodRaf=window.requestAnimationFrame(function(){var N=F._nextMethod.step;N.method&&(N.execute&&h.executeAPICommand(z,N.method,N.args),F._nextMethod=null,F._nextMethodRaf=null)})))}function A(z,F,q){var W=q.node(),X=t.select(F);function Q(){return q.data()[0]}z.on("mousedown",function(){var Z=Q();F.emit("plotly_sliderstart",{slider:Z});var Y=q.select("."+n.gripRectClass);t.event.stopPropagation(),t.event.preventDefault(),Y.call(p.fill,Z.activebgcolor);var N=C(Z,t.mouse(W)[0]);k(F,q,Z,N,!0),Z._dragging=!0,X.on("mousemove",function(){var J=Q(),D=C(J,t.mouse(W)[0]);k(F,q,J,D,!1)}),X.on("mouseup",function(){var J=Q();J._dragging=!1,Y.call(p.fill,J.bgcolor),X.on("mouseup",null),X.on("mousemove",null),F.emit("plotly_sliderend",{slider:J,step:J.steps[J.active]})})})}function b(z,F){var q=z.selectAll("rect."+n.tickRectClass).data(F._visibleSteps),W=F._dims;q.enter().append("rect").classed(n.tickRectClass,!0),q.exit().remove(),q.attr({width:F.tickwidth+"px","shape-rendering":"crispEdges"}),q.each(function(X,Q){var Z=Q%W.labelStride==0,Y=t.select(this);Y.attr({height:Z?F.ticklen:F.minorticklen}).call(p.fill,F.tickcolor),u.setTranslate(Y,w(F,Q/(F._stepCount-1))-.5*F.tickwidth,(Z?n.tickOffset:n.minorTickOffset)+W.currentValueTotalHeight)})}function L(z,F,q){for(var W=z.select("rect."+n.gripRectClass),X=0,Q=0;Q<F._stepCount;Q++)if(F._visibleSteps[Q]._index===F.active){X=Q;break}var Z=w(F,X/(F._stepCount-1));if(!F._invokingCommand){var Y=W;q&&F.transition.duration>0&&(Y=Y.transition().duration(F.transition.duration).ease(F.transition.easing)),Y.attr("transform",l(Z-.5*n.gripWidth,F._dims.currentValueTotalHeight))}}function w(z,F){var q=z._dims;return q.inputAreaStart+n.stepInset+(q.inputAreaLength-2*n.stepInset)*Math.min(1,Math.max(0,F))}function C(z,F){var q=z._dims;return Math.min(1,Math.max(0,(F-n.stepInset-q.inputAreaStart)/(q.inputAreaLength-2*n.stepInset-2*q.inputAreaStart)))}function S(z,F,q){var W=q._dims,X=e.ensureSingle(z,"rect",n.railTouchRectClass,function(Q){Q.call(A,F,z,q).style("pointer-events","all")});X.attr({width:W.inputAreaLength,height:Math.max(W.inputAreaWidth,n.tickOffset+q.ticklen+W.labelHeight)}).call(p.fill,q.bgcolor).attr("opacity",0),u.setTranslate(X,0,W.currentValueTotalHeight)}function P(z,F){var q=F._dims,W=q.inputAreaLength-2*n.railInset,X=e.ensureSingle(z,"rect",n.railRectClass);X.attr({width:W,height:n.railWidth,rx:n.railRadius,ry:n.railRadius,"shape-rendering":"crispEdges"}).call(p.stroke,F.bordercolor).call(p.fill,F.bgcolor).style("stroke-width",F.borderwidth+"px"),u.setTranslate(X,n.railInset,.5*(q.inputAreaWidth-n.railWidth)+q.currentValueTotalHeight)}B.exports=function(z){var F=z._fullLayout,q=function(N,J){for(var D=N[n.name],U=[],G=0;G<D.length;G++){var $=D[G];$.visible&&($._gd=J,U.push($))}return U}(F,z),W=F._infolayer.selectAll("g."+n.containerClassName).data(q.length>0?[0]:[]);function X(N){N._commandObserver&&(N._commandObserver.remove(),delete N._commandObserver),h.autoMargin(z,d(N))}if(W.enter().append("g").classed(n.containerClassName,!0).style("cursor","ew-resize"),W.exit().each(function(){t.select(this).selectAll("g."+n.groupClassName).each(X)}).remove(),q.length!==0){var Q=W.selectAll("g."+n.groupClassName).data(q,g);Q.enter().append("g").classed(n.groupClassName,!0),Q.exit().each(X).remove();for(var Z=0;Z<q.length;Z++){var Y=q[Z];m(z,Y)}Q.each(function(N){var J=t.select(this);(function(D){var U=D._dims;U.labelSteps=[];for(var G=D._stepCount,$=0;$<G;$+=U.labelStride)U.labelSteps.push({fraction:$/(G-1),step:D._visibleSteps[$]})})(N),h.manageCommandObserver(z,N,N._visibleSteps,function(D){var U=J.data()[0];U.active!==D.index&&(U._dragging||E(z,J,U,D.index,!1,!0))}),function(D,U,G){(G.steps[G.active]||{}).visible||(G.active=G._visibleSteps[0]._index),U.call(y,G).call(P,G).call(_,G).call(b,G).call(S,D,G).call(v,D,G);var $=G._dims;u.setTranslate(U,$.lx+G.pad.l,$.ly+G.pad.t),U.call(L,G,!1),U.call(y,G)}(z,t.select(this),N)})}}},{"../../constants/alignment":771,"../../lib":803,"../../lib/svg_text_utils":829,"../../plot_api/plot_template":843,"../../plots/plots":917,"../color":666,"../drawing":688,"./constants":760,"@plotly/d3":58}],763:[function(i,B,V){var t=i("./constants");B.exports={moduleType:"component",name:t.name,layoutAttributes:i("./attributes"),supplyLayoutDefaults:i("./defaults"),draw:i("./draw")}},{"./attributes":759,"./constants":760,"./defaults":761,"./draw":762}],764:[function(i,B,V){var t=i("@plotly/d3"),h=i("fast-isnumeric"),p=i("../../plots/plots"),u=i("../../registry"),e=i("../../lib"),l=e.strTranslate,o=i("../drawing"),a=i("../color"),n=i("../../lib/svg_text_utils"),s=i("../../constants/interactions"),r=i("../../constants/alignment").OPPOSITE_SIDE,c=/ [XY][0-9]* /;B.exports={draw:function(f,d,g){var m,y=g.propContainer,v=g.propName,T=g.placeholder,_=g.traceIndex,k=g.avoid||{},E=g.attributes,A=g.transform,b=g.containerGroup,L=f._fullLayout,w=1,C=!1,S=y.title,P=(S&&S.text?S.text:"").trim(),z=S&&S.font?S.font:{},F=z.family,q=z.size,W=z.color;v==="title.text"?m="titleText":v.indexOf("axis")!==-1?m="axisTitleText":v.indexOf(!0)&&(m="colorbarTitleText");var X=f._context.edits[m];P===""?w=0:P.replace(c," % ")===T.replace(c," % ")&&(w=.2,C=!0,X||(P="")),g._meta?P=e.templateString(P,g._meta):L._meta&&(P=e.templateString(P,L._meta));var Q=P||X;b||(b=e.ensureSingle(L._infolayer,"g","g-"+d));var Z=b.selectAll("text").data(Q?[0]:[]);if(Z.enter().append("text"),Z.text(P).attr("class",d),Z.exit().remove(),!Q)return b;function Y(D){e.syncOrAsync([N,J],D)}function N(D){var U;return A?(U="",A.rotate&&(U+="rotate("+[A.rotate,E.x,E.y]+")"),A.offset&&(U+=l(0,A.offset))):U=null,D.attr("transform",U),D.style({"font-family":F,"font-size":t.round(q,2)+"px",fill:a.rgb(W),opacity:w*a.opacity(W),"font-weight":p.fontWeight}).attr(E).call(n.convertToTspans,f),p.previousPromises(f)}function J(D){var U=t.select(D.node().parentNode);if(k&&k.selection&&k.side&&P){U.attr("transform",null);var G=r[k.side],$=k.side==="left"||k.side==="top"?-1:1,K=h(k.pad)?k.pad:2,re=o.bBox(U.node()),ne={left:0,top:0,right:L.width,bottom:L.height},ae=k.maxShift||$*(ne[k.side]-re[k.side]),ie=0;if(ae<0)ie=ae;else{var he=k.offsetLeft||0,se=k.offsetTop||0;re.left-=he,re.right-=he,re.top-=se,re.bottom-=se,k.selection.each(function(){var ce=o.bBox(this);e.bBoxIntersect(re,ce,K)&&(ie=Math.max(ie,$*(ce[k.side]-re[G])+K))}),ie=Math.min(ae,ie)}if(ie>0||ae<0){var de={left:[-ie,0],right:[ie,0],top:[0,-ie],bottom:[0,ie]}[k.side];U.attr("transform",l(de[0],de[1]))}}}return Z.call(Y),X&&(P?Z.on(".opacity",null):(w=0,C=!0,Z.text(T).on("mouseover.opacity",function(){t.select(this).transition().duration(s.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){t.select(this).transition().duration(s.HIDE_PLACEHOLDER).style("opacity",0)})),Z.call(n.makeEditable,{gd:f}).on("edit",function(D){_!==void 0?u.call("_guiRestyle",f,v,D,_):u.call("_guiRelayout",f,v,D)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(Y)}).on("input",function(D){this.text(D||" ").call(n.positionText,E.x,E.y)})),Z.classed("js-placeholder",C),b}}},{"../../constants/alignment":771,"../../constants/interactions":778,"../../lib":803,"../../lib/svg_text_utils":829,"../../plots/plots":917,"../../registry":931,"../color":666,"../drawing":688,"@plotly/d3":58,"fast-isnumeric":249}],765:[function(i,B,V){var t=i("../../plots/font_attributes"),h=i("../color/attributes"),p=i("../../lib/extend").extendFlat,u=i("../../plot_api/edit_types").overrideAll,e=i("../../plots/pad_attributes"),l=i("../../plot_api/plot_template").templatedArray,o=l("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});B.exports=u(l("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:o,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:p(e({editType:"arraydraw"}),{}),font:t({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:h.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plot_api/plot_template":843,"../../plots/font_attributes":883,"../../plots/pad_attributes":916,"../color/attributes":665}],766:[function(i,B,V){B.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"◄",right:"►",up:"▲",down:"▼"}}},{}],767:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/array_container_defaults"),p=i("./attributes"),u=i("./constants").name,e=p.buttons;function l(a,n,s){function r(c,f){return t.coerce(a,n,p,c,f)}r("visible",h(a,n,{name:"buttons",handleItemDefaults:o}).length>0)&&(r("active"),r("direction"),r("type"),r("showactive"),r("x"),r("y"),t.noneOrAll(a,n,["x","y"]),r("xanchor"),r("yanchor"),r("pad.t"),r("pad.r"),r("pad.b"),r("pad.l"),t.coerceFont(r,"font",s.font),r("bgcolor",s.paper_bgcolor),r("bordercolor"),r("borderwidth"))}function o(a,n){function s(r,c){return t.coerce(a,n,e,r,c)}s("visible",a.method==="skip"||Array.isArray(a.args))&&(s("method"),s("args"),s("args2"),s("label"),s("execute"))}B.exports=function(a,n){h(a,n,{name:u,handleItemDefaults:l})}},{"../../lib":803,"../../plots/array_container_defaults":849,"./attributes":765,"./constants":766}],768:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../plots/plots"),p=i("../color"),u=i("../drawing"),e=i("../../lib"),l=i("../../lib/svg_text_utils"),o=i("../../plot_api/plot_template").arrayEditor,a=i("../../constants/alignment").LINE_SPACING,n=i("./constants"),s=i("./scrollbox");function r(w){return w._index}function c(w,C){return+w.attr(n.menuIndexAttrName)===C._index}function f(w,C,S,P,z,F,q,W){C.active=q,o(w.layout,n.name,C).applyUpdate("active",q),C.type==="buttons"?g(w,P,null,null,C):C.type==="dropdown"&&(z.attr(n.menuIndexAttrName,"-1"),d(w,P,z,F,C),W||g(w,P,z,F,C))}function d(w,C,S,P,z){var F=e.ensureSingle(C,"g",n.headerClassName,function(Y){Y.style("pointer-events","all")}),q=z._dims,W=z.active,X=z.buttons[W]||n.blankHeaderOpts,Q={y:z.pad.t,yPad:0,x:z.pad.l,xPad:0,index:0},Z={width:q.headerWidth,height:q.headerHeight};F.call(m,z,X,w).call(b,z,Q,Z),e.ensureSingle(C,"text",n.headerArrowClassName,function(Y){Y.attr("text-anchor","end").call(u.font,z.font).text(n.arrowSymbol[z.direction])}).attr({x:q.headerWidth-n.arrowOffsetX+z.pad.l,y:q.headerHeight/2+n.textOffsetY+z.pad.t}),F.on("click",function(){S.call(L,String(c(S,z)?-1:z._index)),g(w,C,S,P,z)}),F.on("mouseover",function(){F.call(_)}),F.on("mouseout",function(){F.call(k,z)}),u.setTranslate(C,q.lx,q.ly)}function g(w,C,S,P,z){S||(S=C).attr("pointer-events","all");var F=function(G){return+G.attr(n.menuIndexAttrName)==-1}(S)&&z.type!=="buttons"?[]:z.buttons,q=z.type==="dropdown"?n.dropdownButtonClassName:n.buttonClassName,W=S.selectAll("g."+q).data(e.filterVisible(F)),X=W.enter().append("g").classed(q,!0),Q=W.exit();z.type==="dropdown"?(X.attr("opacity","0").transition().attr("opacity","1"),Q.transition().attr("opacity","0").remove()):Q.remove();var Z=0,Y=0,N=z._dims,J=["up","down"].indexOf(z.direction)!==-1;z.type==="dropdown"&&(J?Y=N.headerHeight+n.gapButtonHeader:Z=N.headerWidth+n.gapButtonHeader),z.type==="dropdown"&&z.direction==="up"&&(Y=-n.gapButtonHeader+n.gapButton-N.openHeight),z.type==="dropdown"&&z.direction==="left"&&(Z=-n.gapButtonHeader+n.gapButton-N.openWidth);var D={x:N.lx+Z+z.pad.l,y:N.ly+Y+z.pad.t,yPad:n.gapButton,xPad:n.gapButton,index:0},U={l:D.x+z.borderwidth,t:D.y+z.borderwidth};W.each(function(G,$){var K=t.select(this);K.call(m,z,G,w).call(b,z,D),K.on("click",function(){t.event.defaultPrevented||(G.execute&&(G.args2&&z.active===$?(f(w,z,0,C,S,P,-1),h.executeAPICommand(w,G.method,G.args2)):(f(w,z,0,C,S,P,$),h.executeAPICommand(w,G.method,G.args))),w.emit("plotly_buttonclicked",{menu:z,button:G,active:z.active}))}),K.on("mouseover",function(){K.call(_)}),K.on("mouseout",function(){K.call(k,z),W.call(T,z)})}),W.call(T,z),J?(U.w=Math.max(N.openWidth,N.headerWidth),U.h=D.y-U.t):(U.w=D.x-U.l,U.h=Math.max(N.openHeight,N.headerHeight)),U.direction=z.direction,P&&(W.size()?function(G,$,K,re,ne,ae){var ie,he,se,de=ne.direction,ce=de==="up"||de==="down",ve=ne._dims,Ee=ne.active;if(ce)for(he=0,se=0;se<Ee;se++)he+=ve.heights[se]+n.gapButton;else for(ie=0,se=0;se<Ee;se++)ie+=ve.widths[se]+n.gapButton;re.enable(ae,ie,he),re.hbar&&re.hbar.attr("opacity","0").transition().attr("opacity","1"),re.vbar&&re.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,P,z,U):function(G){var $=!!G.hbar,K=!!G.vbar;$&&G.hbar.transition().attr("opacity","0").each("end",function(){$=!1,K||G.disable()}),K&&G.vbar.transition().attr("opacity","0").each("end",function(){K=!1,$||G.disable()})}(P))}function m(w,C,S,P){w.call(y,C).call(v,C,S,P)}function y(w,C){e.ensureSingle(w,"rect",n.itemRectClassName,function(S){S.attr({rx:n.rx,ry:n.ry,"shape-rendering":"crispEdges"})}).call(p.stroke,C.bordercolor).call(p.fill,C.bgcolor).style("stroke-width",C.borderwidth+"px")}function v(w,C,S,P){var z=e.ensureSingle(w,"text",n.itemTextClassName,function(W){W.attr({"text-anchor":"start","data-notex":1})}),F=S.label,q=P._fullLayout._meta;q&&(F=e.templateString(F,q)),z.call(u.font,C.font).text(F).call(l.convertToTspans,P)}function T(w,C){var S=C.active;w.each(function(P,z){var F=t.select(this);z===S&&C.showactive&&F.select("rect."+n.itemRectClassName).call(p.fill,n.activeColor)})}function _(w){w.select("rect."+n.itemRectClassName).call(p.fill,n.hoverColor)}function k(w,C){w.select("rect."+n.itemRectClassName).call(p.fill,C.bgcolor)}function E(w,C){var S=C._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},P=u.tester.selectAll("g."+n.dropdownButtonClassName).data(e.filterVisible(C.buttons));P.enter().append("g").classed(n.dropdownButtonClassName,!0);var z=["up","down"].indexOf(C.direction)!==-1;P.each(function(Z,Y){var N=t.select(this);N.call(m,C,Z,w);var J=N.select("."+n.itemTextClassName),D=J.node()&&u.bBox(J.node()).width,U=Math.max(D+n.textPadX,n.minWidth),G=C.font.size*a,$=l.lineCount(J),K=Math.max(G*$,n.minHeight)+n.textOffsetY;K=Math.ceil(K),U=Math.ceil(U),S.widths[Y]=U,S.heights[Y]=K,S.height1=Math.max(S.height1,K),S.width1=Math.max(S.width1,U),z?(S.totalWidth=Math.max(S.totalWidth,U),S.openWidth=S.totalWidth,S.totalHeight+=K+n.gapButton,S.openHeight+=K+n.gapButton):(S.totalWidth+=U+n.gapButton,S.openWidth+=U+n.gapButton,S.totalHeight=Math.max(S.totalHeight,K),S.openHeight=S.totalHeight)}),z?S.totalHeight-=n.gapButton:S.totalWidth-=n.gapButton,S.headerWidth=S.width1+n.arrowPadX,S.headerHeight=S.height1,C.type==="dropdown"&&(z?(S.width1+=n.arrowPadX,S.totalHeight=S.height1):S.totalWidth=S.width1,S.totalWidth+=n.arrowPadX),P.remove();var F=S.totalWidth+C.pad.l+C.pad.r,q=S.totalHeight+C.pad.t+C.pad.b,W=w._fullLayout._size;S.lx=W.l+W.w*C.x,S.ly=W.t+W.h*(1-C.y);var X="left";e.isRightAnchor(C)&&(S.lx-=F,X="right"),e.isCenterAnchor(C)&&(S.lx-=F/2,X="center");var Q="top";e.isBottomAnchor(C)&&(S.ly-=q,Q="bottom"),e.isMiddleAnchor(C)&&(S.ly-=q/2,Q="middle"),S.totalWidth=Math.ceil(S.totalWidth),S.totalHeight=Math.ceil(S.totalHeight),S.lx=Math.round(S.lx),S.ly=Math.round(S.ly),h.autoMargin(w,A(C),{x:C.x,y:C.y,l:F*({right:1,center:.5}[X]||0),r:F*({left:1,center:.5}[X]||0),b:q*({top:1,middle:.5}[Q]||0),t:q*({bottom:1,middle:.5}[Q]||0)})}function A(w){return n.autoMarginIdRoot+w._index}function b(w,C,S,P){P=P||{};var z=w.select("."+n.itemRectClassName),F=w.select("."+n.itemTextClassName),q=C.borderwidth,W=S.index,X=C._dims;u.setTranslate(w,q+S.x,q+S.y);var Q=["up","down"].indexOf(C.direction)!==-1,Z=P.height||(Q?X.heights[W]:X.height1);z.attr({x:0,y:0,width:P.width||(Q?X.width1:X.widths[W]),height:Z});var Y=C.font.size*a,N=(l.lineCount(F)-1)*Y/2;l.positionText(F,n.textOffsetX,Z/2-N+n.textOffsetY),Q?S.y+=X.heights[W]+S.yPad:S.x+=X.widths[W]+S.xPad,S.index++}function L(w,C){w.attr(n.menuIndexAttrName,C||"-1").selectAll("g."+n.dropdownButtonClassName).remove()}B.exports=function(w){var C=w._fullLayout,S=e.filterVisible(C[n.name]);function P(Y){h.autoMargin(w,A(Y))}var z=C._menulayer.selectAll("g."+n.containerClassName).data(S.length>0?[0]:[]);if(z.enter().append("g").classed(n.containerClassName,!0).style("cursor","pointer"),z.exit().each(function(){t.select(this).selectAll("g."+n.headerGroupClassName).each(P)}).remove(),S.length!==0){var F=z.selectAll("g."+n.headerGroupClassName).data(S,r);F.enter().append("g").classed(n.headerGroupClassName,!0);for(var q=e.ensureSingle(z,"g",n.dropdownButtonGroupClassName,function(Y){Y.style("pointer-events","all")}),W=0;W<S.length;W++){var X=S[W];E(w,X)}var Q="updatemenus"+C._uid,Z=new s(w,q,Q);F.enter().size()&&(q.node().parentNode.appendChild(q.node()),q.call(L)),F.exit().each(function(Y){q.call(L),P(Y)}).remove(),F.each(function(Y){var N=t.select(this),J=Y.type==="dropdown"?q:null;h.manageCommandObserver(w,Y,Y.buttons,function(D){f(w,Y,Y.buttons[D.index],N,J,Z,D.index,!0)}),Y.type==="dropdown"?(d(w,N,q,Z,Y),c(q,Y)&&g(w,N,q,Z,Y)):g(w,N,null,null,Y)})}}},{"../../constants/alignment":771,"../../lib":803,"../../lib/svg_text_utils":829,"../../plot_api/plot_template":843,"../../plots/plots":917,"../color":666,"../drawing":688,"./constants":766,"./scrollbox":770,"@plotly/d3":58}],769:[function(i,B,V){arguments[4][763][0].apply(V,arguments)},{"./attributes":765,"./constants":766,"./defaults":767,"./draw":768,dup:763}],770:[function(i,B,V){B.exports=e;var t=i("@plotly/d3"),h=i("../color"),p=i("../drawing"),u=i("../../lib");function e(l,o,a){this.gd=l,this.container=o,this.id=a,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(l,o,a){var n=this.gd._fullLayout,s=n.width,r=n.height;this.position=l;var c,f,d,g,m=this.position.l,y=this.position.w,v=this.position.t,T=this.position.h,_=this.position.direction,k=_==="down",E=_==="left",A=_==="up",b=y,L=T;k||E||_==="right"||A||(this.position.direction="down",k=!0),k||A?(f=(c=m)+b,k?(d=v,L=(g=Math.min(d+L,r))-d):L=(g=v+L)-(d=Math.max(g-L,0))):(g=(d=v)+L,E?b=(f=m+b)-(c=Math.max(f-b,0)):(c=m,b=(f=Math.min(c+b,s))-c)),this._box={l:c,t:d,w:b,h:L};var w=y>b,C=e.barLength+2*e.barPad,S=e.barWidth+2*e.barPad,P=m,z=v+T;z+S>r&&(z=r-S);var F=this.container.selectAll("rect.scrollbar-horizontal").data(w?[0]:[]);F.exit().on(".drag",null).remove(),F.enter().append("rect").classed("scrollbar-horizontal",!0).call(h.fill,e.barColor),w?(this.hbar=F.attr({rx:e.barRadius,ry:e.barRadius,x:P,y:z,width:C,height:S}),this._hbarXMin=P+C/2,this._hbarTranslateMax=b-C):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var q=T>L,W=e.barWidth+2*e.barPad,X=e.barLength+2*e.barPad,Q=m+y,Z=v;Q+W>s&&(Q=s-W);var Y=this.container.selectAll("rect.scrollbar-vertical").data(q?[0]:[]);Y.exit().on(".drag",null).remove(),Y.enter().append("rect").classed("scrollbar-vertical",!0).call(h.fill,e.barColor),q?(this.vbar=Y.attr({rx:e.barRadius,ry:e.barRadius,x:Q,y:Z,width:W,height:X}),this._vbarYMin=Z+X/2,this._vbarTranslateMax=L-X):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var N=this.id,J=c-.5,D=q?f+W+.5:f+.5,U=d-.5,G=w?g+S+.5:g+.5,$=n._topdefs.selectAll("#"+N).data(w||q?[0]:[]);if($.exit().remove(),$.enter().append("clipPath").attr("id",N).append("rect"),w||q?(this._clipRect=$.select("rect").attr({x:Math.floor(J),y:Math.floor(U),width:Math.ceil(D)-Math.floor(J),height:Math.ceil(G)-Math.floor(U)}),this.container.call(p.setClipUrl,N,this.gd),this.bg.attr({x:m,y:v,width:y,height:T})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(p.setClipUrl,null),delete this._clipRect),w||q){var K=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(K);var re=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.preventDefault(),t.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));w&&this.hbar.on(".drag",null).call(re),q&&this.vbar.on(".drag",null).call(re)}this.setTranslate(o,a)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(p.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var l=this.translateX,o=this.translateY;this.hbar&&(l-=t.event.dx),this.vbar&&(o-=t.event.dy),this.setTranslate(l,o)},e.prototype._onBoxWheel=function(){var l=this.translateX,o=this.translateY;this.hbar&&(l+=t.event.deltaY),this.vbar&&(o+=t.event.deltaY),this.setTranslate(l,o)},e.prototype._onBarDrag=function(){var l=this.translateX,o=this.translateY;if(this.hbar){var a=l+this._hbarXMin,n=a+this._hbarTranslateMax;l=(u.constrain(t.event.x,a,n)-a)/(n-a)*(this.position.w-this._box.w)}if(this.vbar){var s=o+this._vbarYMin,r=s+this._vbarTranslateMax;o=(u.constrain(t.event.y,s,r)-s)/(r-s)*(this.position.h-this._box.h)}this.setTranslate(l,o)},e.prototype.setTranslate=function(l,o){var a=this.position.w-this._box.w,n=this.position.h-this._box.h;if(l=u.constrain(l||0,0,a),o=u.constrain(o||0,0,n),this.translateX=l,this.translateY=o,this.container.call(p.setTranslate,this._box.l-this.position.l-l,this._box.t-this.position.t-o),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+l-.5),y:Math.floor(this.position.t+o-.5)}),this.hbar){var s=l/a;this.hbar.call(p.setTranslate,l+s*this._hbarTranslateMax,o)}if(this.vbar){var r=o/n;this.vbar.call(p.setTranslate,l,o+r*this._vbarTranslateMax)}}},{"../../lib":803,"../color":666,"../drawing":688,"@plotly/d3":58}],771:[function(i,B,V){B.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],772:[function(i,B,V){B.exports={axisRefDescription:function(t,h,p){return["If set to a",t,"axis id (e.g. *"+t+"* or","*"+t+"2*), the `"+t+"` position refers to a",t,"coordinate. If set to *paper*, the `"+t+"`","position refers to the distance from the",h,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",h,"("+p+"). If set to a",t,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",h,"of the domain of that axis: e.g.,","*"+t+"2 domain* refers to the domain of the second",t," axis and a",t,"position of 0.5 refers to the","point between the",h,"and the",p,"of the domain of the","second",t,"axis."].join(" ")}}},{}],773:[function(i,B,V){B.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"▲"},DECREASING:{COLOR:"#FF4136",SYMBOL:"▼"}}},{}],774:[function(i,B,V){B.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],775:[function(i,B,V){B.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],776:[function(i,B,V){B.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],777:[function(i,B,V){B.exports={circle:"●","circle-open":"○",square:"■","square-open":"□",diamond:"◆","diamond-open":"◇",cross:"+",x:"❌"}},{}],778:[function(i,B,V){B.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],779:[function(i,B,V){B.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"−"}},{}],780:[function(i,B,V){V.xmlns="http://www.w3.org/2000/xmlns/",V.svg="http://www.w3.org/2000/svg",V.xlink="http://www.w3.org/1999/xlink",V.svgAttrs={xmlns:V.svg,"xmlns:xlink":V.xlink}},{}],781:[function(i,B,V){V.version=i("./version").version,i("native-promise-only"),i("../build/plotcss");for(var t=i("./registry"),h=V.register=t.register,p=i("./plot_api"),u=Object.keys(p),e=0;e<u.length;e++){var l=u[e];l.charAt(0)!=="_"&&(V[l]=p[l]),h({moduleType:"apiMethod",name:l,fn:p[l]})}h(i("./traces/scatter")),h([i("./components/legend"),i("./components/fx"),i("./components/annotations"),i("./components/annotations3d"),i("./components/shapes"),i("./components/images"),i("./components/updatemenus"),i("./components/sliders"),i("./components/rangeslider"),i("./components/rangeselector"),i("./components/grid"),i("./components/errorbars"),i("./components/colorscale"),i("./components/colorbar"),i("./components/modebar")]),h([i("./locale-en"),i("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(h(window.PlotlyLocales),delete window.PlotlyLocales),V.Icons=i("./fonts/ploticon");var o=i("./components/fx"),a=i("./plots/plots");V.Plots={resize:a.resize,graphJson:a.graphJson,sendDataToCloud:a.sendDataToCloud},V.Fx={hover:o.hover,unhover:o.unhover,loneHover:o.loneHover,loneUnhover:o.loneUnhover},V.Snapshot=i("./snapshot"),V.PlotSchema=i("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":657,"./components/annotations3d":662,"./components/colorbar":672,"./components/colorscale":678,"./components/errorbars":694,"./components/fx":706,"./components/grid":710,"./components/images":715,"./components/legend":723,"./components/modebar":729,"./components/rangeselector":737,"./components/rangeslider":744,"./components/shapes":758,"./components/sliders":763,"./components/updatemenus":769,"./fonts/ploticon":782,"./locale-en":834,"./locale-en-us":833,"./plot_api":838,"./plot_api/plot_schema":842,"./plots/plots":917,"./registry":931,"./snapshot":936,"./traces/scatter":1230,"./version":1404,"native-promise-only":474}],782:[function(i,B,V){B.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],783:[function(i,B,V){V.isLeftAnchor=function(t){return t.xanchor==="left"||t.xanchor==="auto"&&t.x<=1/3},V.isCenterAnchor=function(t){return t.xanchor==="center"||t.xanchor==="auto"&&t.x>1/3&&t.x<2/3},V.isRightAnchor=function(t){return t.xanchor==="right"||t.xanchor==="auto"&&t.x>=2/3},V.isTopAnchor=function(t){return t.yanchor==="top"||t.yanchor==="auto"&&t.y>=2/3},V.isMiddleAnchor=function(t){return t.yanchor==="middle"||t.yanchor==="auto"&&t.y>1/3&&t.y<2/3},V.isBottomAnchor=function(t){return t.yanchor==="bottom"||t.yanchor==="auto"&&t.y<=1/3}},{}],784:[function(i,B,V){var t=i("./mod"),h=t.mod,p=t.modHalf,u=Math.PI,e=2*u;function l(s){return Math.abs(s[1]-s[0])>e-1e-14}function o(s,r){return p(r-s,e)}function a(s,r){if(l(r))return!0;var c,f;r[0]<r[1]?(c=r[0],f=r[1]):(c=r[1],f=r[0]),(c=h(c,e))>(f=h(f,e))&&(f+=e);var d=h(s,e),g=d+e;return d>=c&&d<=f||g>=c&&g<=f}function n(s,r,c,f,d,g,m){d=d||0,g=g||0;var y,v,T,_,k,E=l([c,f]);function A(C,S){return[C*Math.cos(S)+d,g-C*Math.sin(S)]}E?(y=0,v=u,T=e):c<f?(y=c,T=f):(y=f,T=c),s<r?(_=s,k=r):(_=r,k=s);var b,L=Math.abs(T-y)<=u?0:1;function w(C,S,P){return"A"+[C,C]+" "+[0,L,P]+" "+A(C,S)}return E?b=_===null?"M"+A(k,y)+w(k,v,0)+w(k,T,0)+"Z":"M"+A(_,y)+w(_,v,0)+w(_,T,0)+"ZM"+A(k,y)+w(k,v,1)+w(k,T,1)+"Z":_===null?(b="M"+A(k,y)+w(k,T,0),m&&(b+="L0,0Z")):b="M"+A(_,y)+"L"+A(k,y)+w(k,T,0)+"L"+A(_,T)+w(_,y,1)+"Z",b}B.exports={deg2rad:function(s){return s/180*u},rad2deg:function(s){return s/u*180},angleDelta:o,angleDist:function(s,r){return Math.abs(o(s,r))},isFullCircle:l,isAngleInsideSector:a,isPtInsideSector:function(s,r,c,f){return!!a(r,f)&&(c[0]<c[1]?(d=c[0],g=c[1]):(d=c[1],g=c[0]),s>=d&&s<=g);var d,g},pathArc:function(s,r,c,f,d){return n(null,s,r,c,f,d,0)},pathSector:function(s,r,c,f,d){return n(null,s,r,c,f,d,1)},pathAnnulus:function(s,r,c,f,d,g){return n(s,r,c,f,d,g,1)}}},{"./mod":810}],785:[function(i,B,V){var t=Array.isArray,h=ArrayBuffer,p=DataView;function u(o){return h.isView(o)&&!(o instanceof p)}function e(o){return t(o)||u(o)}function l(o,a,n){if(e(o)){if(e(o[0])){for(var s=n,r=0;r<o.length;r++)s=a(s,o[r].length);return s}return o.length}return 0}V.isTypedArray=u,V.isArrayOrTypedArray=e,V.isArray1D=function(o){return!e(o[0])},V.ensureArray=function(o,a){return t(o)||(o=[]),o.length=a,o},V.concat=function(){var o,a,n,s,r,c,f,d,g=[],m=!0,y=0;for(n=0;n<arguments.length;n++)(c=(s=arguments[n]).length)&&(a?g.push(s):(a=s,r=c),t(s)?o=!1:(m=!1,y?o!==s.constructor&&(o=!1):o=s.constructor),y+=c);if(!y)return[];if(!g.length)return a;if(m)return a.concat.apply(a,g);if(o){for((f=new o(y)).set(a),n=0;n<g.length;n++)s=g[n],f.set(s,r),r+=s.length;return f}for(f=new Array(y),d=0;d<a.length;d++)f[d]=a[d];for(n=0;n<g.length;n++){for(s=g[n],d=0;d<s.length;d++)f[r+d]=s[d];r+=d}return f},V.maxRowLength=function(o){return l(o,Math.max,0)},V.minRowLength=function(o){return l(o,Math.min,1/0)}},{}],786:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../constants/numerical").BADNUM,p=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;B.exports=function(u){return typeof u=="string"&&(u=u.replace(p,"")),t(u)?Number(u):h}},{"../constants/numerical":779,"fast-isnumeric":249}],787:[function(i,B,V){B.exports=function(t){var h=t._fullLayout;h._glcanvas&&h._glcanvas.size()&&h._glcanvas.each(function(p){p.regl&&p.regl.clear({color:!0,depth:!0})})}},{}],788:[function(i,B,V){B.exports=function(t){t._responsiveChartHandler&&(window.removeEventListener("resize",t._responsiveChartHandler),delete t._responsiveChartHandler)}},{}],789:[function(i,B,V){var t=i("fast-isnumeric"),h=i("tinycolor2"),p=i("../plots/attributes"),u=i("../components/colorscale/scales"),e=i("../components/color"),l=i("../constants/interactions").DESELECTDIM,o=i("./nested_property"),a=i("./regex").counter,n=i("./mod").modHalf,s=i("./array").isArrayOrTypedArray;function r(c,f){var d=V.valObjectMeta[f.valType];if(f.arrayOk&&s(c))return!0;if(d.validateFunction)return d.validateFunction(c,f);var g={},m=g,y={set:function(v){m=v}};return d.coerceFunction(c,y,g,f),m!==g}V.valObjectMeta={data_array:{coerceFunction:function(c,f,d){s(c)?f.set(c):d!==void 0&&f.set(d)}},enumerated:{coerceFunction:function(c,f,d,g){g.coerceNumber&&(c=+c),g.values.indexOf(c)===-1?f.set(d):f.set(c)},validateFunction:function(c,f){f.coerceNumber&&(c=+c);for(var d=f.values,g=0;g<d.length;g++){var m=String(d[g]);if(m.charAt(0)==="/"&&m.charAt(m.length-1)==="/"){if(new RegExp(m.substr(1,m.length-2)).test(c))return!0}else if(c===d[g])return!0}return!1}},boolean:{coerceFunction:function(c,f,d){c===!0||c===!1?f.set(c):f.set(d)}},number:{coerceFunction:function(c,f,d,g){!t(c)||g.min!==void 0&&c<g.min||g.max!==void 0&&c>g.max?f.set(d):f.set(+c)}},integer:{coerceFunction:function(c,f,d,g){c%1||!t(c)||g.min!==void 0&&c<g.min||g.max!==void 0&&c>g.max?f.set(d):f.set(+c)}},string:{coerceFunction:function(c,f,d,g){if(typeof c!="string"){var m=typeof c=="number";g.strict!==!0&&m?f.set(String(c)):f.set(d)}else g.noBlank&&!c?f.set(d):f.set(c)}},color:{coerceFunction:function(c,f,d){h(c).isValid()?f.set(c):f.set(d)}},colorlist:{coerceFunction:function(c,f,d){Array.isArray(c)&&c.length&&c.every(function(g){return h(g).isValid()})?f.set(c):f.set(d)}},colorscale:{coerceFunction:function(c,f,d){f.set(u.get(c,d))}},angle:{coerceFunction:function(c,f,d){c==="auto"?f.set("auto"):t(c)?f.set(n(+c,360)):f.set(d)}},subplotid:{coerceFunction:function(c,f,d,g){var m=g.regex||a(d);typeof c=="string"&&m.test(c)?f.set(c):f.set(d)},validateFunction:function(c,f){var d=f.dflt;return c===d||typeof c=="string"&&!!a(d).test(c)}},flaglist:{coerceFunction:function(c,f,d,g){if(typeof c=="string")if((g.extras||[]).indexOf(c)===-1){for(var m=c.split("+"),y=0;y<m.length;){var v=m[y];g.flags.indexOf(v)===-1||m.indexOf(v)<y?m.splice(y,1):y++}m.length?f.set(m.join("+")):f.set(d)}else f.set(c);else f.set(d)}},any:{coerceFunction:function(c,f,d){c===void 0?f.set(d):f.set(c)}},info_array:{coerceFunction:function(c,f,d,g){function m(z,F,q){var W,X={set:function(Q){W=Q}};return q===void 0&&(q=F.dflt),V.valObjectMeta[F.valType].coerceFunction(z,X,q,F),W}var y=g.dimensions===2||g.dimensions==="1-2"&&Array.isArray(c)&&Array.isArray(c[0]);if(Array.isArray(c)){var v,T,_,k,E,A,b=g.items,L=[],w=Array.isArray(b),C=w&&y&&Array.isArray(b[0]),S=y&&w&&!C,P=w&&!S?b.length:c.length;if(d=Array.isArray(d)?d:[],y)for(v=0;v<P;v++)for(L[v]=[],_=Array.isArray(c[v])?c[v]:[],E=S?b.length:w?b[v].length:_.length,T=0;T<E;T++)k=S?b[T]:w?b[v][T]:b,(A=m(_[T],k,(d[v]||[])[T]))!==void 0&&(L[v][T]=A);else for(v=0;v<P;v++)(A=m(c[v],w?b[v]:b,d[v]))!==void 0&&(L[v]=A);f.set(L)}else f.set(d)},validateFunction:function(c,f){if(!Array.isArray(c))return!1;var d=f.items,g=Array.isArray(d),m=f.dimensions===2;if(!f.freeLength&&c.length!==d.length)return!1;for(var y=0;y<c.length;y++)if(m){if(!Array.isArray(c[y])||!f.freeLength&&c[y].length!==d[y].length)return!1;for(var v=0;v<c[y].length;v++)if(!r(c[y][v],g?d[y][v]:d))return!1}else if(!r(c[y],g?d[y]:d))return!1;return!0}}},V.coerce=function(c,f,d,g,m){var y=o(d,g).get(),v=o(c,g),T=o(f,g),_=v.get(),k=f._template;if(_===void 0&&k&&(_=o(k,g).get(),k=0),m===void 0&&(m=y.dflt),y.arrayOk&&s(_))return T.set(_),_;var E=V.valObjectMeta[y.valType].coerceFunction;E(_,T,m,y);var A=T.get();return k&&A===m&&!r(_,y)&&(E(_=o(k,g).get(),T,m,y),A=T.get()),A},V.coerce2=function(c,f,d,g,m){var y=o(c,g),v=V.coerce(c,f,d,g,m),T=y.get();return T!=null&&v},V.coerceFont=function(c,f,d){var g={};return d=d||{},g.family=c(f+".family",d.family),g.size=c(f+".size",d.size),g.color=c(f+".color",d.color),g},V.coercePattern=function(c,f,d,g){if(c(f+".shape")){c(f+".solidity"),c(f+".size");var m=c(f+".fillmode")==="overlay";if(!g){var y=c(f+".bgcolor",m?d:void 0);c(f+".fgcolor",m?e.contrast(y):d)}c(f+".fgopacity",m?.5:1)}},V.coerceHoverinfo=function(c,f,d){var g,m=f._module.attributes,y=m.hoverinfo?m:p,v=y.hoverinfo;if(d._dataLength===1){var T=v.dflt==="all"?v.flags.slice():v.dflt.split("+");T.splice(T.indexOf("name"),1),g=T.join("+")}return V.coerce(c,f,y,"hoverinfo",g)},V.coerceSelectionMarkerOpacity=function(c,f){if(c.marker){var d,g,m=c.marker.opacity;m!==void 0&&(s(m)||c.selected||c.unselected||(d=m,g=l*m),f("selected.marker.opacity",d),f("unselected.marker.opacity",g))}},V.validate=r},{"../components/color":666,"../components/colorscale/scales":681,"../constants/interactions":778,"../plots/attributes":850,"./array":785,"./mod":810,"./nested_property":811,"./regex":820,"fast-isnumeric":249,tinycolor2:598}],790:[function(i,B,V){var t,h,p=i("d3-time-format").timeFormat,u=i("fast-isnumeric"),e=i("./loggers"),l=i("./mod").mod,o=i("../constants/numerical"),a=o.BADNUM,n=o.ONEDAY,s=o.ONEHOUR,r=o.ONEMIN,c=o.ONESEC,f=o.EPOCHJD,d=i("../registry"),g=i("d3-time-format").utcFormat,m=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,y=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,v=new Date().getFullYear()-70;function T(F){return F&&d.componentsRegistry.calendars&&typeof F=="string"&&F!=="gregorian"}function _(F,q){return String(F+Math.pow(10,q)).substr(1)}V.dateTick0=function(F,q){var W=function(Q,Z){return T(Q)?Z?d.getComponentMethod("calendars","CANONICAL_SUNDAY")[Q]:d.getComponentMethod("calendars","CANONICAL_TICK")[Q]:Z?"2000-01-02":"2000-01-01"}(F,!!q);if(q<2)return W;var X=V.dateTime2ms(W,F);return X+=n*(q-1),V.ms2DateTime(X,0,F)},V.dfltRange=function(F){return T(F)?d.getComponentMethod("calendars","DFLTRANGE")[F]:["2000-01-01","2001-01-01"]},V.isJSDate=function(F){return typeof F=="object"&&F!==null&&typeof F.getTime=="function"},V.dateTime2ms=function(F,q){if(V.isJSDate(F)){var W=F.getTimezoneOffset()*r,X=(F.getUTCMinutes()-F.getMinutes())*r+(F.getUTCSeconds()-F.getSeconds())*c+(F.getUTCMilliseconds()-F.getMilliseconds());if(X){var Q=3*r;W=W-Q/2+l(X-W+Q/2,Q)}return(F=Number(F)-W)>=t&&F<=h?F:a}if(typeof F!="string"&&typeof F!="number")return a;F=String(F);var Z=T(q),Y=F.charAt(0);!Z||Y!=="G"&&Y!=="g"||(F=F.substr(1),q="");var N=Z&&q.substr(0,7)==="chinese",J=F.match(N?y:m);if(!J)return a;var D=J[1],U=J[3]||"1",G=Number(J[5]||1),$=Number(J[7]||0),K=Number(J[9]||0),re=Number(J[11]||0);if(Z){if(D.length===2)return a;var ne;D=Number(D);try{var ae=d.getComponentMethod("calendars","getCal")(q);if(N){var ie=U.charAt(U.length-1)==="i";U=parseInt(U,10),ne=ae.newDate(D,ae.toMonthIndex(D,U,ie),G)}else ne=ae.newDate(D,Number(U),G)}catch{return a}return ne?(ne.toJD()-f)*n+$*s+K*r+re*c:a}D=D.length===2?(Number(D)+2e3-v)%100+v:Number(D),U-=1;var he=new Date(Date.UTC(2e3,U,G,$,K));return he.setUTCFullYear(D),he.getUTCMonth()!==U||he.getUTCDate()!==G?a:he.getTime()+re*c},t=V.MIN_MS=V.dateTime2ms("-9999"),h=V.MAX_MS=V.dateTime2ms("9999-12-31 23:59:59.9999"),V.isDateTime=function(F,q){return V.dateTime2ms(F,q)!==a};var k=90*n,E=3*s,A=5*r;function b(F,q,W,X,Q){if((q||W||X||Q)&&(F+=" "+_(q,2)+":"+_(W,2),(X||Q)&&(F+=":"+_(X,2),Q))){for(var Z=4;Q%10==0;)Z-=1,Q/=10;F+="."+_(Q,Z)}return F}V.ms2DateTime=function(F,q,W){if(typeof F!="number"||!(F>=t&&F<=h))return a;q||(q=0);var X,Q,Z,Y,N,J,D=Math.floor(10*l(F+.05,1)),U=Math.round(F-D/10);if(T(W)){var G=Math.floor(U/n)+f,$=Math.floor(l(F,n));try{X=d.getComponentMethod("calendars","getCal")(W).fromJD(G).formatDate("yyyy-mm-dd")}catch{X=g("G%Y-%m-%d")(new Date(U))}if(X.charAt(0)==="-")for(;X.length<11;)X="-0"+X.substr(1);else for(;X.length<10;)X="0"+X;Q=q<k?Math.floor($/s):0,Z=q<k?Math.floor($%s/r):0,Y=q<E?Math.floor($%r/c):0,N=q<A?$%c*10+D:0}else J=new Date(U),X=g("%Y-%m-%d")(J),Q=q<k?J.getUTCHours():0,Z=q<k?J.getUTCMinutes():0,Y=q<E?J.getUTCSeconds():0,N=q<A?10*J.getUTCMilliseconds()+D:0;return b(X,Q,Z,Y,N)},V.ms2DateTimeLocal=function(F){if(!(F>=t+n&&F<=h-n))return a;var q=Math.floor(10*l(F+.05,1)),W=new Date(Math.round(F-q/10));return b(p("%Y-%m-%d")(W),W.getHours(),W.getMinutes(),W.getSeconds(),10*W.getUTCMilliseconds()+q)},V.cleanDate=function(F,q,W){if(F===a)return q;if(V.isJSDate(F)||typeof F=="number"&&isFinite(F)){if(T(W))return e.error("JS Dates and milliseconds are incompatible with world calendars",F),q;if(!(F=V.ms2DateTimeLocal(+F))&&q!==void 0)return q}else if(!V.isDateTime(F,W))return e.error("unrecognized date",F),q;return F};var L=/%\d?f/g,w=/%h/g,C={1:"1",2:"1",3:"2",4:"2"};function S(F,q,W,X){F=F.replace(L,function(Z){var Y=Math.min(+Z.charAt(1)||6,6);return(q/1e3%1+2).toFixed(Y).substr(2).replace(/0+$/,"")||"0"});var Q=new Date(Math.floor(q+.05));if(F=F.replace(w,function(){return C[W("%q")(Q)]}),T(X))try{F=d.getComponentMethod("calendars","worldCalFmt")(F,q,X)}catch{return"Invalid"}return W(F)(Q)}var P=[59,59.9,59.99,59.999,59.9999];V.formatDate=function(F,q,W,X,Q,Z){if(Q=T(Q)&&Q,!q)if(W==="y")q=Z.year;else if(W==="m")q=Z.month;else{if(W!=="d")return function(Y,N){var J=l(Y+.05,n),D=_(Math.floor(J/s),2)+":"+_(l(Math.floor(J/r),60),2);if(N!=="M"){u(N)||(N=0);var U=(100+Math.min(l(Y/c,60),P[N])).toFixed(N).substr(1);N>0&&(U=U.replace(/0+$/,"").replace(/[\.]$/,"")),D+=":"+U}return D}(F,W)+`
`+S(Z.dayMonthYear,F,X,Q);q=Z.dayMonth+`
`+Z.year}return S(q,F,X,Q)};var z=3*n;V.incrementMonth=function(F,q,W){W=T(W)&&W;var X=l(F,n);if(F=Math.round(F-X),W)try{var Q=Math.round(F/n)+f,Z=d.getComponentMethod("calendars","getCal")(W),Y=Z.fromJD(Q);return q%12?Z.add(Y,q,"m"):Z.add(Y,q/12,"y"),(Y.toJD()-f)*n+X}catch{e.error("invalid ms "+F+" in calendar "+W)}var N=new Date(F+z);return N.setUTCMonth(N.getUTCMonth()+q)+X-z},V.findExactDates=function(F,q){for(var W,X,Q=0,Z=0,Y=0,N=0,J=T(q)&&d.getComponentMethod("calendars","getCal")(q),D=0;D<F.length;D++)if(X=F[D],u(X)){if(!(X%n))if(J)try{(W=J.fromJD(X/n+f)).day()===1?W.month()===1?Q++:Z++:Y++}catch{}else(W=new Date(X)).getUTCDate()===1?W.getUTCMonth()===0?Q++:Z++:Y++}else N++;Y+=Z+=Q;var U=F.length-N;return{exactYears:Q/U,exactMonths:Z/U,exactDays:Y/U}}},{"../constants/numerical":779,"../registry":931,"./loggers":807,"./mod":810,"d3-time-format":175,"fast-isnumeric":249}],791:[function(i,B,V){var t=i("@plotly/d3"),h=i("./loggers"),p=i("./matrix"),u=i("gl-mat4");function e(s){var r=s&&s.parentNode;r&&r.removeChild(s)}function l(s,r,c){var f="plotly.js-style-"+s,d=document.getElementById(f);d||((d=document.createElement("style")).setAttribute("id",f),d.appendChild(document.createTextNode("")),document.head.appendChild(d));var g=d.sheet;g.insertRule?g.insertRule(r+"{"+c+"}",0):g.addRule?g.addRule(r,c,0):h.warn("addStyleRule failed")}function o(s){var r=window.getComputedStyle(s,null),c=r.getPropertyValue("-webkit-transform")||r.getPropertyValue("-moz-transform")||r.getPropertyValue("-ms-transform")||r.getPropertyValue("-o-transform")||r.getPropertyValue("transform");return c==="none"?null:c.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(f){return+f})}function a(s){for(var r=[];n(s);)r.push(s),s=s.parentNode;return r}function n(s){return s&&(s instanceof Element||s instanceof HTMLElement)}B.exports={getGraphDiv:function(s){var r;if(typeof s=="string"){if((r=document.getElementById(s))===null)throw new Error("No DOM element with id '"+s+"' exists on the page.");return r}if(s==null)throw new Error("DOM element provided is null or undefined");return s},isPlotDiv:function(s){var r=t.select(s);return r.node()instanceof HTMLElement&&r.size()&&r.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(s,r){l("global",s,r)},addRelatedStyleRule:l,deleteRelatedStyleRule:function(s){var r="plotly.js-style-"+s,c=document.getElementById(r);c&&e(c)},getFullTransformMatrix:function(s){var r=a(s),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return r.forEach(function(f){var d=o(f);if(d){var g=p.convertCssMatrix(d);c=u.multiply(c,c,g)}}),c},getElementTransformMatrix:o,getElementAndAncestors:a,equalDomRects:function(s,r){return s&&r&&s.x===r.x&&s.y===r.y&&s.top===r.top&&s.left===r.left&&s.right===r.right&&s.bottom===r.bottom}}},{"./loggers":807,"./matrix":809,"@plotly/d3":58,"gl-mat4":298}],792:[function(i,B,V){var t=i("events").EventEmitter,h={init:function(p){if(p._ev instanceof t)return p;var u=new t,e=new t;return p._ev=u,p._internalEv=e,p.on=u.on.bind(u),p.once=u.once.bind(u),p.removeListener=u.removeListener.bind(u),p.removeAllListeners=u.removeAllListeners.bind(u),p._internalOn=e.on.bind(e),p._internalOnce=e.once.bind(e),p._removeInternalListener=e.removeListener.bind(e),p._removeAllInternalListeners=e.removeAllListeners.bind(e),p.emit=function(l,o){typeof jQuery<"u"&&jQuery(p).trigger(l,o),u.emit(l,o),e.emit(l,o)},p},triggerHandler:function(p,u,e){var l,o;typeof jQuery<"u"&&(l=jQuery(p).triggerHandler(u,e));var a=p._ev;if(!a)return l;var n,s=a._events[u];if(!s)return l;function r(c){return c.listener?(a.removeListener(u,c.listener),c.fired?void 0:(c.fired=!0,c.listener.apply(a,[e]))):c.apply(a,[e])}for(s=Array.isArray(s)?s:[s],n=0;n<s.length-1;n++)r(s[n]);return o=r(s[n]),l!==void 0?l:o},purge:function(p){return delete p._ev,delete p.on,delete p.once,delete p.removeListener,delete p.removeAllListeners,delete p.emit,delete p._ev,delete p._internalEv,delete p._internalOn,delete p._internalOnce,delete p._removeInternalListener,delete p._removeAllInternalListeners,p}};B.exports=h},{events:116}],793:[function(i,B,V){var t=i("./is_plain_object.js"),h=Array.isArray;function p(u,e,l,o){var a,n,s,r,c,f,d=u[0],g=u.length;if(g===2&&h(d)&&h(u[1])&&d.length===0){if(function(y,v){var T,_;for(T=0;T<y.length;T++){if((_=y[T])!==null&&typeof _=="object")return!1;_!==void 0&&(v[T]=_)}return!0}(u[1],d))return d;d.splice(0,d.length)}for(var m=1;m<g;m++)for(n in a=u[m])s=d[n],r=a[n],o&&h(r)?d[n]=r:e&&r&&(t(r)||(c=h(r)))?(c?(c=!1,f=s&&h(s)?s:[]):f=s&&t(s)?s:{},d[n]=p([f,r],e,l,o)):(r!==void 0||l)&&(d[n]=r);return d}V.extendFlat=function(){return p(arguments,!1,!1,!1)},V.extendDeep=function(){return p(arguments,!0,!1,!1)},V.extendDeepAll=function(){return p(arguments,!0,!0,!1)},V.extendDeepNoArrays=function(){return p(arguments,!0,!1,!0)}},{"./is_plain_object.js":804}],794:[function(i,B,V){B.exports=function(t){for(var h={},p=[],u=0,e=0;e<t.length;e++){var l=t[e];h[l]!==1&&(h[l]=1,p[u++]=l)}return p}},{}],795:[function(i,B,V){function t(p){return p.visible===!0}function h(p){var u=p[0].trace;return u.visible===!0&&u._length!==0}B.exports=function(p){for(var u,e=(u=p,Array.isArray(u)&&Array.isArray(u[0])&&u[0][0]&&u[0][0].trace?h:t),l=[],o=0;o<p.length;o++){var a=p[o];e(a)&&l.push(a)}return l}},{}],796:[function(i,B,V){var t=i("@plotly/d3"),h=i("country-regex"),p=i("@turf/area"),u=i("@turf/centroid"),e=i("@turf/bbox"),l=i("./identity"),o=i("./loggers"),a=i("./is_plain_object"),n=i("./nested_property"),s=i("./polygon"),r=Object.keys(h),c={"ISO-3":l,"USA-states":l,"country names":function(d){for(var g=0;g<r.length;g++){var m=r[g];if(new RegExp(h[m]).test(d.trim().toLowerCase()))return m}return o.log("Unrecognized country name: "+d+"."),!1}};function f(d){var g=d.geojson,m=window.PlotlyGeoAssets||{},y=typeof g=="string"?m[g]:g;return a(y)?y:(o.error("Oops ... something went wrong when fetching "+g),!1)}B.exports={locationToFeature:function(d,g,m){if(!g||typeof g!="string")return!1;var y,v,T,_=c[d](g);if(_){if(d==="USA-states")for(y=[],T=0;T<m.length;T++)(v=m[T]).properties&&v.properties.gu&&v.properties.gu==="USA"&&y.push(v);else y=m;for(T=0;T<y.length;T++)if((v=y[T]).id===_)return v;o.log(["Location with id",_,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(d){var g,m,y,v,T=d.geometry,_=T.coordinates,k=d.id,E=[];function A(b){for(var L=0;L<b.length-1;L++)if(b[L][0]>0&&b[L+1][0]<0)return L;return null}switch(g=k==="RUS"||k==="FJI"?function(b){var L;if(A(b)===null)L=b;else for(L=new Array(b.length),v=0;v<b.length;v++)L[v]=[b[v][0]<0?b[v][0]+360:b[v][0],b[v][1]];E.push(s.tester(L))}:k==="ATA"?function(b){var L=A(b);if(L===null)return E.push(s.tester(b));var w=new Array(b.length+1),C=0;for(v=0;v<b.length;v++)v>L?w[C++]=[b[v][0]+360,b[v][1]]:v===L?(w[C++]=b[v],w[C++]=[b[v][0],-90]):w[C++]=b[v];var S=s.tester(w);S.pts.pop(),E.push(S)}:function(b){E.push(s.tester(b))},T.type){case"MultiPolygon":for(m=0;m<_.length;m++)for(y=0;y<_[m].length;y++)g(_[m][y]);break;case"Polygon":for(m=0;m<_.length;m++)g(_[m])}return E},getTraceGeojson:f,extractTraceFeature:function(d){var g=d[0].trace,m=f(g);if(!m)return!1;var y,v={},T=[];for(y=0;y<g._length;y++){var _=d[y];(_.loc||_.loc===0)&&(v[_.loc]=_)}function k(b){var L=n(b,g.featureidkey||"id").get(),w=v[L];if(w){var C=b.geometry;if(C.type==="Polygon"||C.type==="MultiPolygon"){var S={type:"Feature",id:L,geometry:C,properties:{}};S.properties.ct=function(P){var z,F=P.geometry;if(F.type==="MultiPolygon")for(var q=F.coordinates,W=0,X=0;X<q.length;X++){var Q={type:"Polygon",coordinates:q[X]},Z=p.default(Q);Z>W&&(W=Z,z=Q)}else z=F;return u.default(z).geometry.coordinates}(S),w.fIn=b,w.fOut=S,T.push(S)}else o.log(["Location",w.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete v[L]}switch(m.type){case"FeatureCollection":var E=m.features;for(y=0;y<E.length;y++)k(E[y]);break;case"Feature":k(m);break;default:return o.warn(["Invalid GeoJSON type",(m.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var A in v)o.log(["Location *"+A+"*","does not have a matching feature with id-key","*"+g.featureidkey+"*."].join(" "));return T},fetchTraceGeoData:function(d){var g=window.PlotlyGeoAssets||{},m=[];function y(k){return new Promise(function(E,A){t.json(k,function(b,L){if(b){delete g[k];var w=b.status===404?'GeoJSON at URL "'+k+'" does not exist.':"Unexpected error while fetching from "+k;return A(new Error(w))}return g[k]=L,E(L)})})}function v(k){return new Promise(function(E,A){var b=0,L=setInterval(function(){return g[k]&&g[k]!=="pending"?(clearInterval(L),E(g[k])):b>100?(clearInterval(L),A("Unexpected error while fetching from "+k)):void b++},50)})}for(var T=0;T<d.length;T++){var _=d[T][0].trace.geojson;typeof _=="string"&&(g[_]?g[_]==="pending"&&m.push(v(_)):(g[_]="pending",m.push(y(_))))}return m},computeBbox:function(d){return e.default(d)}}},{"./identity":801,"./is_plain_object":804,"./loggers":807,"./nested_property":811,"./polygon":815,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":145}],797:[function(i,B,V){var t=i("../constants/numerical").BADNUM;V.calcTraceToLineCoords=function(h){for(var p=h[0].trace.connectgaps,u=[],e=[],l=0;l<h.length;l++){var o=h[l].lonlat;o[0]!==t?e.push(o):!p&&e.length>0&&(u.push(e),e=[])}return e.length>0&&u.push(e),u},V.makeLine=function(h){return h.length===1?{type:"LineString",coordinates:h[0]}:{type:"MultiLineString",coordinates:h}},V.makePolygon=function(h){if(h.length===1)return{type:"Polygon",coordinates:h};for(var p=new Array(h.length),u=0;u<h.length;u++)p[u]=[h[u]];return{type:"MultiPolygon",coordinates:p}},V.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":779}],798:[function(i,B,V){var t,h,p,u=i("./mod").mod;function e(o,a,n,s,r,c,f,d){var g=n-o,m=r-o,y=f-r,v=s-a,T=c-a,_=d-c,k=g*_-y*v;if(k===0)return null;var E=(m*_-y*T)/k,A=(m*v-g*T)/k;return A<0||A>1||E<0||E>1?null:{x:o+g*E,y:a+v*E}}function l(o,a,n,s,r){var c=s*o+r*a;if(c<0)return s*s+r*r;if(c>n){var f=s-o,d=r-a;return f*f+d*d}var g=s*a-r*o;return g*g/n}V.segmentsIntersect=e,V.segmentDistance=function(o,a,n,s,r,c,f,d){if(e(o,a,n,s,r,c,f,d))return 0;var g=n-o,m=s-a,y=f-r,v=d-c,T=g*g+m*m,_=y*y+v*v,k=Math.min(l(g,m,T,r-o,c-a),l(g,m,T,f-o,d-a),l(y,v,_,o-r,a-c),l(y,v,_,n-r,s-c));return Math.sqrt(k)},V.getTextLocation=function(o,a,n,s){if(o===h&&s===p||(t={},h=o,p=s),t[n])return t[n];var r=o.getPointAtLength(u(n-s/2,a)),c=o.getPointAtLength(u(n+s/2,a)),f=Math.atan((c.y-r.y)/(c.x-r.x)),d=o.getPointAtLength(u(n,a)),g={x:(4*d.x+r.x+c.x)/6,y:(4*d.y+r.y+c.y)/6,theta:f};return t[n]=g,g},V.clearLocationCache=function(){h=null},V.getVisibleSegment=function(o,a,n){var s,r,c=a.left,f=a.right,d=a.top,g=a.bottom,m=0,y=o.getTotalLength(),v=y;function T(k){var E=o.getPointAtLength(k);k===0?s=E:k===y&&(r=E);var A=E.x<c?c-E.x:E.x>f?E.x-f:0,b=E.y<d?d-E.y:E.y>g?E.y-g:0;return Math.sqrt(A*A+b*b)}for(var _=T(m);_;){if((m+=_+n)>v)return;_=T(m)}for(_=T(v);_;){if(m>(v-=_+n))return;_=T(v)}return{min:m,max:v,len:v-m,total:y,isClosed:m===0&&v===y&&Math.abs(s.x-r.x)<.1&&Math.abs(s.y-r.y)<.1}},V.findPointOnPath=function(o,a,n,s){for(var r,c,f,d=(s=s||{}).pathLength||o.getTotalLength(),g=s.tolerance||.001,m=s.iterationLimit||30,y=o.getPointAtLength(0)[n]>o.getPointAtLength(d)[n]?-1:1,v=0,T=0,_=d;v<m;){if(r=(T+_)/2,f=(c=o.getPointAtLength(r))[n]-a,Math.abs(f)<g)return c;y*f>0?_=r:T=r,v++}return c}},{"./mod":810}],799:[function(i,B,V){var t=i("fast-isnumeric"),h=i("tinycolor2"),p=i("color-normalize"),u=i("../components/colorscale"),e=i("../components/color/attributes").defaultLine,l=i("./array").isArrayOrTypedArray,o=p(e);function a(r,c){var f=r;return f[3]*=c,f}function n(r){if(t(r))return o;var c=p(r);return c.length?c:o}function s(r){return t(r)?r:1}B.exports={formatColor:function(r,c,f){var d,g,m,y,v,T=r.color,_=l(T),k=l(c),E=u.extractOpts(r),A=[];if(d=E.colorscale!==void 0?u.makeColorScaleFuncFromTrace(r):n,g=_?function(L,w){return L[w]===void 0?o:p(d(L[w]))}:n,m=k?function(L,w){return L[w]===void 0?1:s(L[w])}:s,_||k)for(var b=0;b<f;b++)y=g(T,b),v=m(c,b),A[b]=a(y,v);else A=a(p(T),c);return A},parseColorScale:function(r){var c=u.extractOpts(r),f=c.colorscale;return c.reversescale&&(f=u.flipScale(c.colorscale)),f.map(function(d){var g=d[0],m=h(d[1]).toRgb();return{index:g,rgb:[m.r,m.g,m.b,m.a]}})}}},{"../components/color/attributes":665,"../components/colorscale":678,"./array":785,"color-normalize":131,"fast-isnumeric":249,tinycolor2:598}],800:[function(i,B,V){var t=i("./identity");function h(p){return[p]}B.exports={keyFun:function(p){return p.key},repeat:h,descend:t,wrap:h,unwrap:function(p){return p[0]}}},{"./identity":801}],801:[function(i,B,V){B.exports=function(t){return t}},{}],802:[function(i,B,V){B.exports=function(t,h){if(!h)return t;var p=1/Math.abs(h),u=p>1?(p*t+p*h)/p:t+h,e=String(u).length;if(e>16){var l=String(h).length;if(e>=String(t).length+l){var o=parseFloat(u).toPrecision(12);o.indexOf("e+")===-1&&(u=+o)}}return u}},{}],803:[function(i,B,V){var t=i("@plotly/d3"),h=i("d3-time-format").utcFormat,p=i("d3-format").format,u=i("fast-isnumeric"),e=i("../constants/numerical"),l=e.FP_SAFE,o=-l,a=e.BADNUM,n=B.exports={};n.adjustFormat=function(D){return!D||/^\d[.]\df/.test(D)||/[.]\d%/.test(D)?D:D==="0.f"?"~f":/^\d%/.test(D)?"~%":/^\ds/.test(D)?"~s":!/^[~,.0$]/.test(D)&&/[&fps]/.test(D)?"~"+D:D};var s={};n.warnBadFormat=function(D){var U=String(D);s[U]||(s[U]=1,n.warn('encountered bad format: "'+U+'"'))},n.noFormat=function(D){return String(D)},n.numberFormat=function(D){var U;try{U=p(n.adjustFormat(D))}catch{return n.warnBadFormat(D),n.noFormat}return U},n.nestedProperty=i("./nested_property"),n.keyedContainer=i("./keyed_container"),n.relativeAttr=i("./relative_attr"),n.isPlainObject=i("./is_plain_object"),n.toLogRange=i("./to_log_range"),n.relinkPrivateKeys=i("./relink_private");var r=i("./array");n.isTypedArray=r.isTypedArray,n.isArrayOrTypedArray=r.isArrayOrTypedArray,n.isArray1D=r.isArray1D,n.ensureArray=r.ensureArray,n.concat=r.concat,n.maxRowLength=r.maxRowLength,n.minRowLength=r.minRowLength;var c=i("./mod");n.mod=c.mod,n.modHalf=c.modHalf;var f=i("./coerce");n.valObjectMeta=f.valObjectMeta,n.coerce=f.coerce,n.coerce2=f.coerce2,n.coerceFont=f.coerceFont,n.coercePattern=f.coercePattern,n.coerceHoverinfo=f.coerceHoverinfo,n.coerceSelectionMarkerOpacity=f.coerceSelectionMarkerOpacity,n.validate=f.validate;var d=i("./dates");n.dateTime2ms=d.dateTime2ms,n.isDateTime=d.isDateTime,n.ms2DateTime=d.ms2DateTime,n.ms2DateTimeLocal=d.ms2DateTimeLocal,n.cleanDate=d.cleanDate,n.isJSDate=d.isJSDate,n.formatDate=d.formatDate,n.incrementMonth=d.incrementMonth,n.dateTick0=d.dateTick0,n.dfltRange=d.dfltRange,n.findExactDates=d.findExactDates,n.MIN_MS=d.MIN_MS,n.MAX_MS=d.MAX_MS;var g=i("./search");n.findBin=g.findBin,n.sorterAsc=g.sorterAsc,n.sorterDes=g.sorterDes,n.distinctVals=g.distinctVals,n.roundUp=g.roundUp,n.sort=g.sort,n.findIndexOfMin=g.findIndexOfMin,n.sortObjectKeys=i("./sort_object_keys");var m=i("./stats");n.aggNums=m.aggNums,n.len=m.len,n.mean=m.mean,n.median=m.median,n.midRange=m.midRange,n.variance=m.variance,n.stdev=m.stdev,n.interp=m.interp;var y=i("./matrix");n.init2dArray=y.init2dArray,n.transposeRagged=y.transposeRagged,n.dot=y.dot,n.translationMatrix=y.translationMatrix,n.rotationMatrix=y.rotationMatrix,n.rotationXYMatrix=y.rotationXYMatrix,n.apply3DTransform=y.apply3DTransform,n.apply2DTransform=y.apply2DTransform,n.apply2DTransform2=y.apply2DTransform2,n.convertCssMatrix=y.convertCssMatrix,n.inverseTransformMatrix=y.inverseTransformMatrix;var v=i("./angles");n.deg2rad=v.deg2rad,n.rad2deg=v.rad2deg,n.angleDelta=v.angleDelta,n.angleDist=v.angleDist,n.isFullCircle=v.isFullCircle,n.isAngleInsideSector=v.isAngleInsideSector,n.isPtInsideSector=v.isPtInsideSector,n.pathArc=v.pathArc,n.pathSector=v.pathSector,n.pathAnnulus=v.pathAnnulus;var T=i("./anchor_utils");n.isLeftAnchor=T.isLeftAnchor,n.isCenterAnchor=T.isCenterAnchor,n.isRightAnchor=T.isRightAnchor,n.isTopAnchor=T.isTopAnchor,n.isMiddleAnchor=T.isMiddleAnchor,n.isBottomAnchor=T.isBottomAnchor;var _=i("./geometry2d");n.segmentsIntersect=_.segmentsIntersect,n.segmentDistance=_.segmentDistance,n.getTextLocation=_.getTextLocation,n.clearLocationCache=_.clearLocationCache,n.getVisibleSegment=_.getVisibleSegment,n.findPointOnPath=_.findPointOnPath;var k=i("./extend");n.extendFlat=k.extendFlat,n.extendDeep=k.extendDeep,n.extendDeepAll=k.extendDeepAll,n.extendDeepNoArrays=k.extendDeepNoArrays;var E=i("./loggers");n.log=E.log,n.warn=E.warn,n.error=E.error;var A=i("./regex");n.counterRegex=A.counter;var b=i("./throttle");n.throttle=b.throttle,n.throttleDone=b.done,n.clearThrottle=b.clear;var L=i("./dom");function w(D){var U={};for(var G in D)for(var $=D[G],K=0;K<$.length;K++)U[$[K]]=+G;return U}n.getGraphDiv=L.getGraphDiv,n.isPlotDiv=L.isPlotDiv,n.removeElement=L.removeElement,n.addStyleRule=L.addStyleRule,n.addRelatedStyleRule=L.addRelatedStyleRule,n.deleteRelatedStyleRule=L.deleteRelatedStyleRule,n.getFullTransformMatrix=L.getFullTransformMatrix,n.getElementTransformMatrix=L.getElementTransformMatrix,n.getElementAndAncestors=L.getElementAndAncestors,n.equalDomRects=L.equalDomRects,n.clearResponsive=i("./clear_responsive"),n.preserveDrawingBuffer=i("./preserve_drawing_buffer"),n.makeTraceGroups=i("./make_trace_groups"),n._=i("./localize"),n.notifier=i("./notifier"),n.filterUnique=i("./filter_unique"),n.filterVisible=i("./filter_visible"),n.pushUnique=i("./push_unique"),n.increment=i("./increment"),n.cleanNumber=i("./clean_number"),n.ensureNumber=function(D){return u(D)?(D=Number(D))>l||D<o?a:D:a},n.isIndex=function(D,U){return!(U!==void 0&&D>=U)&&u(D)&&D>=0&&D%1==0},n.noop=i("./noop"),n.identity=i("./identity"),n.repeat=function(D,U){for(var G=new Array(U),$=0;$<U;$++)G[$]=D;return G},n.swapAttrs=function(D,U,G,$){G||(G="x"),$||($="y");for(var K=0;K<U.length;K++){var re=U[K],ne=n.nestedProperty(D,re.replace("?",G)),ae=n.nestedProperty(D,re.replace("?",$)),ie=ne.get();ne.set(ae.get()),ae.set(ie)}},n.raiseToTop=function(D){D.parentNode.appendChild(D)},n.cancelTransition=function(D){return D.transition().duration(0)},n.constrain=function(D,U,G){return U>G?Math.max(G,Math.min(U,D)):Math.max(U,Math.min(G,D))},n.bBoxIntersect=function(D,U,G){return G=G||0,D.left<=U.right+G&&U.left<=D.right+G&&D.top<=U.bottom+G&&U.top<=D.bottom+G},n.simpleMap=function(D,U,G,$,K){for(var re=D.length,ne=new Array(re),ae=0;ae<re;ae++)ne[ae]=U(D[ae],G,$,K);return ne},n.randstr=function D(U,G,$,K){if($||($=16),G===void 0&&(G=24),G<=0)return"0";var re,ne,ae=Math.log(Math.pow(2,G))/Math.log($),ie="";for(re=2;ae===1/0;re*=2)ae=Math.log(Math.pow(2,G/re))/Math.log($)*re;var he=ae-Math.floor(ae);for(re=0;re<Math.floor(ae);re++)ie=Math.floor(Math.random()*$).toString($)+ie;he&&(ne=Math.pow($,he),ie=Math.floor(Math.random()*ne).toString($)+ie);var se=parseInt(ie,$);return U&&U[ie]||se!==1/0&&se>=Math.pow(2,G)?K>10?(n.warn("randstr failed uniqueness"),ie):D(U,G,$,(K||0)+1):ie},n.OptionControl=function(D,U){D||(D={}),U||(U="opt");var G={optionList:[],_newoption:function($){$[U]=D,G[$.name]=$,G.optionList.push($)}};return G["_"+U]=D,G},n.smooth=function(D,U){if((U=Math.round(U)||0)<2)return D;var G,$,K,re,ne=D.length,ae=2*ne,ie=2*U-1,he=new Array(ie),se=new Array(ne);for(G=0;G<ie;G++)he[G]=(1-Math.cos(Math.PI*(G+1)/U))/(2*U);for(G=0;G<ne;G++){for(re=0,$=0;$<ie;$++)(K=G+$+1-U)<-ne?K-=ae*Math.round(K/ae):K>=ae&&(K-=ae*Math.floor(K/ae)),K<0?K=-1-K:K>=ne&&(K=ae-1-K),re+=D[K]*he[$];se[G]=re}return se},n.syncOrAsync=function(D,U,G){var $;function K(){return n.syncOrAsync(D,U,G)}for(;D.length;)if(($=(0,D.splice(0,1)[0])(U))&&$.then)return $.then(K).then(void 0,n.promiseError);return G&&G(U)},n.stripTrailingSlash=function(D){return D.substr(-1)==="/"?D.substr(0,D.length-1):D},n.noneOrAll=function(D,U,G){if(D){var $,K=!1,re=!0;for($=0;$<G.length;$++)D[G[$]]!=null?K=!0:re=!1;if(K&&!re)for($=0;$<G.length;$++)D[G[$]]=U[G[$]]}},n.mergeArray=function(D,U,G,$){var K=typeof $=="function";if(n.isArrayOrTypedArray(D))for(var re=Math.min(D.length,U.length),ne=0;ne<re;ne++){var ae=D[ne];U[ne][G]=K?$(ae):ae}},n.mergeArrayCastPositive=function(D,U,G){return n.mergeArray(D,U,G,function($){var K=+$;return isFinite(K)&&K>0?K:0})},n.fillArray=function(D,U,G,$){if($=$||n.identity,n.isArrayOrTypedArray(D))for(var K=0;K<U.length;K++)U[K][G]=$(D[K])},n.castOption=function(D,U,G,$){$=$||n.identity;var K=n.nestedProperty(D,G).get();return n.isArrayOrTypedArray(K)?Array.isArray(U)&&n.isArrayOrTypedArray(K[U[0]])?$(K[U[0]][U[1]]):$(K[U]):K},n.extractOption=function(D,U,G,$){if(G in D)return D[G];var K=n.nestedProperty(U,$).get();return Array.isArray(K)?void 0:K},n.tagSelected=function(D,U,G){var $,K,re=U.selectedpoints,ne=U._indexToPoints;ne&&($=w(ne));for(var ae=0;ae<re.length;ae++){var ie=re[ae];if(n.isIndex(ie)||n.isArrayOrTypedArray(ie)&&n.isIndex(ie[0])&&n.isIndex(ie[1])){var he=$?$[ie]:ie,se=G?G[he]:he;(K=se)!==void 0&&K<D.length&&(D[se].selected=1)}}},n.selIndices2selPoints=function(D){var U=D.selectedpoints,G=D._indexToPoints;if(G){for(var $=w(G),K=[],re=0;re<U.length;re++){var ne=U[re];if(n.isIndex(ne)){var ae=$[ne];n.isIndex(ae)&&K.push(ae)}}return K}return U},n.getTargetArray=function(D,U){var G=U.target;if(typeof G=="string"&&G){var $=n.nestedProperty(D,G).get();return!!Array.isArray($)&&$}return!!Array.isArray(G)&&G},n.minExtend=function(D,U){var G={};typeof U!="object"&&(U={});var $,K,re,ne=Object.keys(D);for($=0;$<ne.length;$++)re=D[K=ne[$]],K.charAt(0)!=="_"&&typeof re!="function"&&(K==="module"?G[K]=re:Array.isArray(re)?G[K]=K==="colorscale"?re.slice():re.slice(0,3):n.isTypedArray(re)?G[K]=re.subarray(0,3):G[K]=re&&typeof re=="object"?n.minExtend(D[K],U[K]):re);for(ne=Object.keys(U),$=0;$<ne.length;$++)typeof(re=U[K=ne[$]])=="object"&&K in G&&typeof G[K]=="object"||(G[K]=re);return G},n.titleCase=function(D){return D.charAt(0).toUpperCase()+D.substr(1)},n.containsAny=function(D,U){for(var G=0;G<U.length;G++)if(D.indexOf(U[G])!==-1)return!0;return!1},n.isIE=function(){return window.navigator.msSaveBlob!==void 0};var C=/Version\/[\d\.]+.*Safari/;n.isSafari=function(){return C.test(window.navigator.userAgent)};var S=/iPad|iPhone|iPod/;n.isIOS=function(){return S.test(window.navigator.userAgent)};var P=/Firefox\/(\d+)\.\d+/;n.getFirefoxVersion=function(){var D=P.exec(window.navigator.userAgent);if(D&&D.length===2){var U=parseInt(D[1]);if(!isNaN(U))return U}return null},n.isD3Selection=function(D){return D instanceof t.selection},n.ensureSingle=function(D,U,G,$){var K=D.select(U+(G?"."+G:""));if(K.size())return K;var re=D.append(U);return G&&re.classed(G,!0),$&&re.call($),re},n.ensureSingleById=function(D,U,G,$){var K=D.select(U+"#"+G);if(K.size())return K;var re=D.append(U).attr("id",G);return $&&re.call($),re},n.objectFromPath=function(D,U){for(var G,$=D.split("."),K=G={},re=0;re<$.length;re++){var ne=$[re],ae=null,ie=$[re].match(/(.*)\[([0-9]+)\]/);ie?(ne=ie[1],ae=ie[2],G=G[ne]=[],re===$.length-1?G[ae]=U:G[ae]={},G=G[ae]):(re===$.length-1?G[ne]=U:G[ne]={},G=G[ne])}return K};var z=/^([^\[\.]+)\.(.+)?/,F=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;n.expandObjectPaths=function(D){var U,G,$,K,re,ne,ae;if(typeof D=="object"&&!Array.isArray(D))for(G in D)D.hasOwnProperty(G)&&((U=G.match(z))?(K=D[G],$=U[1],delete D[G],D[$]=n.extendDeepNoArrays(D[$]||{},n.objectFromPath(G,n.expandObjectPaths(K))[$])):(U=G.match(F))?(K=D[G],$=U[1],re=parseInt(U[2]),delete D[G],D[$]=D[$]||[],U[3]==="."?(ae=U[4],ne=D[$][re]=D[$][re]||{},n.extendDeepNoArrays(ne,n.objectFromPath(ae,n.expandObjectPaths(K)))):D[$][re]=n.expandObjectPaths(K)):D[G]=n.expandObjectPaths(D[G]));return D},n.numSeparate=function(D,U,G){if(G||(G=!1),typeof U!="string"||U.length===0)throw new Error("Separator string required for formatting!");typeof D=="number"&&(D=String(D));var $=/(\d+)(\d{3})/,K=U.charAt(0),re=U.charAt(1),ne=D.split("."),ae=ne[0],ie=ne.length>1?K+ne[1]:"";if(re&&(ne.length>1||ae.length>4||G))for(;$.test(ae);)ae=ae.replace($,"$1"+re+"$2");return ae+ie},n.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var q=/^\w*$/;n.templateString=function(D,U){var G={};return D.replace(n.TEMPLATE_STRING_REGEX,function($,K){var re;return q.test(K)?re=U[K]:(G[K]=G[K]||n.nestedProperty(U,K).get,re=G[K]()),n.isValidTextValue(re)?re:""})};var W={max:10,count:0,name:"hovertemplate"};n.hovertemplateString=function(){return Z.apply(W,arguments)};var X={max:10,count:0,name:"texttemplate"};n.texttemplateString=function(){return Z.apply(X,arguments)};var Q=/^[:|\|]/;function Z(D,U,G){var $=this,K=arguments;U||(U={});var re={};return D.replace(n.TEMPLATE_STRING_REGEX,function(ne,ae,ie){var he,se,de,ce=ae==="_xother"||ae==="_yother",ve=ae==="_xother_"||ae==="_yother_",Ee=ae==="xother_"||ae==="yother_",Le=ae==="xother"||ae==="yother"||ce||Ee||ve,Te=ae;if((ce||ve)&&(Te=Te.substring(1)),(Ee||ve)&&(Te=Te.substring(0,Te.length-1)),Le){if((he=U[Te])===void 0)return""}else for(de=3;de<K.length;de++)if(se=K[de]){if(se.hasOwnProperty(Te)){he=se[Te];break}if(q.test(Te)||(he=n.nestedProperty(se,Te).get(),(he=re[Te]||n.nestedProperty(se,Te).get())&&(re[Te]=he)),he!==void 0)break}if(he===void 0&&$)return $.count<$.max&&(n.warn("Variable '"+Te+"' in "+$.name+" could not be found!"),he=ne),$.count===$.max&&n.warn("Too many "+$.name+" warnings - additional warnings will be suppressed"),$.count++,ne;if(ie){var xe;if(ie[0]===":"&&(he=(xe=G?G.numberFormat:n.numberFormat)(ie.replace(Q,""))(he)),ie[0]==="|"){xe=G?G.timeFormat:h;var fe=n.dateTime2ms(he);he=n.formatDate(fe,ie.replace(Q,""),!1,xe)}}else{var ge=Te+"Label";U.hasOwnProperty(ge)&&(he=U[ge])}return Le&&(he="("+he+")",(ce||ve)&&(he=" "+he),(Ee||ve)&&(he+=" ")),he})}n.subplotSort=function(D,U){for(var G=Math.min(D.length,U.length)+1,$=0,K=0,re=0;re<G;re++){var ne=D.charCodeAt(re)||0,ae=U.charCodeAt(re)||0,ie=ne>=48&&ne<=57,he=ae>=48&&ae<=57;if(ie&&($=10*$+ne-48),he&&(K=10*K+ae-48),!ie||!he){if($!==K)return $-K;if(ne!==ae)return ne-ae}}return K-$};var Y=2e9;n.seedPseudoRandom=function(){Y=2e9},n.pseudoRandom=function(){var D=Y;return Y=(69069*Y+1)%4294967296,Math.abs(Y-D)<429496729?n.pseudoRandom():Y/4294967296},n.fillText=function(D,U,G){var $=Array.isArray(G)?function(ne){G.push(ne)}:function(ne){G.text=ne},K=n.extractOption(D,U,"htx","hovertext");if(n.isValidTextValue(K))return $(K);var re=n.extractOption(D,U,"tx","text");return n.isValidTextValue(re)?$(re):void 0},n.isValidTextValue=function(D){return D||D===0},n.formatPercent=function(D,U){U=U||0;for(var G=(Math.round(100*D*Math.pow(10,U))*Math.pow(.1,U)).toFixed(U)+"%",$=0;$<U;$++)G.indexOf(".")!==-1&&(G=(G=G.replace("0%","%")).replace(".%","%"));return G},n.isHidden=function(D){var U=window.getComputedStyle(D).display;return!U||U==="none"},n.strTranslate=function(D,U){return D||U?"translate("+D+","+U+")":""},n.strRotate=function(D){return D?"rotate("+D+")":""},n.strScale=function(D){return D!==1?"scale("+D+")":""},n.getTextTransform=function(D){var U=D.noCenter,G=D.textX,$=D.textY,K=D.targetX,re=D.targetY,ne=D.anchorX||0,ae=D.anchorY||0,ie=D.rotate,he=D.scale;return he?he>1&&(he=1):he=0,n.strTranslate(K-he*(G+ne),re-he*($+ae))+n.strScale(he)+(ie?"rotate("+ie+(U?"":" "+G+" "+$)+")":"")},n.ensureUniformFontSize=function(D,U){var G=n.extendFlat({},U);return G.size=Math.max(U.size,D._fullLayout.uniformtext.minsize||0),G},n.join2=function(D,U,G){var $=D.length;return $>1?D.slice(0,-1).join(U)+G+D[$-1]:D.join(U)},n.bigFont=function(D){return Math.round(1.2*D)};var N=n.getFirefoxVersion(),J=N!==null&&N<86;n.getPositionFromD3Event=function(){return J?[t.event.layerX,t.event.layerY]:[t.event.offsetX,t.event.offsetY]}},{"../constants/numerical":779,"./anchor_utils":783,"./angles":784,"./array":785,"./clean_number":786,"./clear_responsive":788,"./coerce":789,"./dates":790,"./dom":791,"./extend":793,"./filter_unique":794,"./filter_visible":795,"./geometry2d":798,"./identity":801,"./increment":802,"./is_plain_object":804,"./keyed_container":805,"./localize":806,"./loggers":807,"./make_trace_groups":808,"./matrix":809,"./mod":810,"./nested_property":811,"./noop":812,"./notifier":813,"./preserve_drawing_buffer":817,"./push_unique":818,"./regex":820,"./relative_attr":821,"./relink_private":822,"./search":823,"./sort_object_keys":826,"./stats":827,"./throttle":830,"./to_log_range":831,"@plotly/d3":58,"d3-format":167,"d3-time-format":175,"fast-isnumeric":249}],804:[function(i,B,V){B.exports=function(t){return window&&window.process&&window.process.versions?Object.prototype.toString.call(t)==="[object Object]":Object.prototype.toString.call(t)==="[object Object]"&&Object.getPrototypeOf(t).hasOwnProperty("hasOwnProperty")}},{}],805:[function(i,B,V){var t=i("./nested_property"),h=/^\w*$/;B.exports=function(p,u,e,l){var o,a,n;e=e||"name",l=l||"value";var s={};u&&u.length?(n=t(p,u),a=n.get()):a=p,u=u||"";var r={};if(a)for(o=0;o<a.length;o++)r[a[o][e]]=o;var c=h.test(l),f={set:function(d,g){var m=g===null?4:0;if(!a){if(!n||m===4)return;a=[],n.set(a)}var y=r[d];if(y===void 0){if(m===4)return;m|=3,y=a.length,r[d]=y}else g!==(c?a[y][l]:t(a[y],l).get())&&(m|=2);var v=a[y]=a[y]||{};return v[e]=d,c?v[l]=g:t(v,l).set(g),g!==null&&(m&=-5),s[y]=s[y]|m,f},get:function(d){if(a){var g=r[d];return g===void 0?void 0:c?a[g][l]:t(a[g],l).get()}},rename:function(d,g){var m=r[d];return m===void 0||(s[m]=1|s[m],r[g]=m,delete r[d],a[m][e]=g),f},remove:function(d){var g=r[d];if(g===void 0)return f;var m=a[g];if(Object.keys(m).length>2)return s[g]=2|s[g],f.set(d,null);if(c){for(o=g;o<a.length;o++)s[o]=3|s[o];for(o=g;o<a.length;o++)r[a[o][e]]--;a.splice(g,1),delete r[d]}else t(m,l).set(null),s[g]=6|s[g];return f},constructUpdate:function(){for(var d,g,m={},y=Object.keys(s),v=0;v<y.length;v++)g=y[v],d=u+"["+g+"]",a[g]?(1&s[g]&&(m[d+"."+e]=a[g][e]),2&s[g]&&(m[d+"."+l]=c?4&s[g]?null:a[g][l]:4&s[g]?null:t(a[g],l).get())):m[d]=null;return m}};return f}},{"./nested_property":811}],806:[function(i,B,V){var t=i("../registry");B.exports=function(h,p){for(var u=h._context.locale,e=0;e<2;e++){for(var l=h._context.locales,o=0;o<2;o++){var a=(l[u]||{}).dictionary;if(a){var n=a[p];if(n)return n}l=t.localeRegistry}var s=u.split("-")[0];if(s===u)break;u=s}return p}},{"../registry":931}],807:[function(i,B,V){var t=i("../plot_api/plot_config").dfltConfig,h=i("./notifier"),p=B.exports={};p.log=function(){var u;if(t.logging>1){var e=["LOG:"];for(u=0;u<arguments.length;u++)e.push(arguments[u]);console.trace.apply(console,e)}if(t.notifyOnLogging>1){var l=[];for(u=0;u<arguments.length;u++)l.push(arguments[u]);h(l.join("<br>"),"long")}},p.warn=function(){var u;if(t.logging>0){var e=["WARN:"];for(u=0;u<arguments.length;u++)e.push(arguments[u]);console.trace.apply(console,e)}if(t.notifyOnLogging>0){var l=[];for(u=0;u<arguments.length;u++)l.push(arguments[u]);h(l.join("<br>"),"stick")}},p.error=function(){var u;if(t.logging>0){var e=["ERROR:"];for(u=0;u<arguments.length;u++)e.push(arguments[u]);console.error.apply(console,e)}if(t.notifyOnLogging>0){var l=[];for(u=0;u<arguments.length;u++)l.push(arguments[u]);h(l.join("<br>"),"stick")}}},{"../plot_api/plot_config":841,"./notifier":813}],808:[function(i,B,V){var t=i("@plotly/d3");B.exports=function(h,p,u){var e=h.selectAll("g."+u.replace(/\s/g,".")).data(p,function(o){return o[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",u),e.order();var l=h.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(o){o[0][l]=t.select(this)}),e}},{"@plotly/d3":58}],809:[function(i,B,V){var t=i("gl-mat4");V.init2dArray=function(h,p){for(var u=new Array(h),e=0;e<h;e++)u[e]=new Array(p);return u},V.transposeRagged=function(h){var p,u,e=0,l=h.length;for(p=0;p<l;p++)e=Math.max(e,h[p].length);var o=new Array(e);for(p=0;p<e;p++)for(o[p]=new Array(l),u=0;u<l;u++)o[p][u]=h[u][p];return o},V.dot=function(h,p){if(!h.length||!p.length||h.length!==p.length)return null;var u,e,l=h.length;if(h[0].length)for(u=new Array(l),e=0;e<l;e++)u[e]=V.dot(h[e],p);else if(p[0].length){var o=V.transposeRagged(p);for(u=new Array(o.length),e=0;e<o.length;e++)u[e]=V.dot(h,o[e])}else for(u=0,e=0;e<l;e++)u+=h[e]*p[e];return u},V.translationMatrix=function(h,p){return[[1,0,h],[0,1,p],[0,0,1]]},V.rotationMatrix=function(h){var p=h*Math.PI/180;return[[Math.cos(p),-Math.sin(p),0],[Math.sin(p),Math.cos(p),0],[0,0,1]]},V.rotationXYMatrix=function(h,p,u){return V.dot(V.dot(V.translationMatrix(p,u),V.rotationMatrix(h)),V.translationMatrix(-p,-u))},V.apply3DTransform=function(h){return function(){var p=arguments,u=arguments.length===1?p[0]:[p[0],p[1],p[2]||0];return V.dot(h,[u[0],u[1],u[2],1]).slice(0,3)}},V.apply2DTransform=function(h){return function(){var p=arguments;p.length===3&&(p=p[0]);var u=arguments.length===1?p[0]:[p[0],p[1]];return V.dot(h,[u[0],u[1],1]).slice(0,2)}},V.apply2DTransform2=function(h){var p=V.apply2DTransform(h);return function(u){return p(u.slice(0,2)).concat(p(u.slice(2,4)))}},V.convertCssMatrix=function(h){if(h){var p=h.length;if(p===16)return h;if(p===6)return[h[0],h[1],0,0,h[2],h[3],0,0,0,0,1,0,h[4],h[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},V.inverseTransformMatrix=function(h){var p=[];return t.invert(p,h),[[p[0],p[1],p[2],p[3]],[p[4],p[5],p[6],p[7]],[p[8],p[9],p[10],p[11]],[p[12],p[13],p[14],p[15]]]}},{"gl-mat4":298}],810:[function(i,B,V){B.exports={mod:function(t,h){var p=t%h;return p<0?p+h:p},modHalf:function(t,h){return Math.abs(t)>h/2?t-Math.round(t/h)*h:t}}},{}],811:[function(i,B,V){var t=i("fast-isnumeric"),h=i("./array").isArrayOrTypedArray;function p(s,r){return function(){var c,f,d,g,m,y=s;for(g=0;g<r.length-1;g++){if((c=r[g])===-1){for(f=!0,d=[],m=0;m<y.length;m++)d[m]=p(y[m],r.slice(g+1))(),d[m]!==d[0]&&(f=!1);return f?d[0]:d}if(typeof c=="number"&&!h(y)||typeof(y=y[c])!="object"||y===null)return}if(typeof y=="object"&&y!==null&&(d=y[r[g]])!==null)return d}}B.exports=function(s,r){if(t(r))r=String(r);else if(typeof r!="string"||r.substr(r.length-4)==="[-1]")throw"bad property string";for(var c,f,d,g=0,m=r.split(".");g<m.length;){if(c=String(m[g]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(c[1])m[g]=c[1];else{if(g!==0)throw"bad property string";m.splice(0,1)}for(f=c[2].substr(1,c[2].length-2).split("]["),d=0;d<f.length;d++)g++,m.splice(g,0,Number(f[d]))}g++}return typeof s!="object"?function(y,v,T){return{set:function(){throw"bad container"},get:function(){},astr:v,parts:T,obj:y}}(s,r,m):{set:l(s,m,r),get:p(s,m),astr:r,parts:m,obj:s}};var u=/(^|\.)args\[/;function e(s,r){return s===void 0||s===null&&!r.match(u)}function l(s,r,c){return function(f){var d,g,m=s,y="",v=e(f,c);for(g=0;g<r.length-1;g++){if(typeof(d=r[g])=="number"&&!h(m))throw"array index but container is not an array";if(d===-1){if(v=!a(m,r.slice(g+1),f,c))break;return}if(!n(m,d,r[g+1],v))break;if(typeof(m=m[d])!="object"||m===null)throw"container is not an object";y=o(y,d)}if(v){if(g===r.length-1&&(delete m[r[g]],Array.isArray(m)&&+r[g]==m.length-1))for(;m.length&&m[m.length-1]===void 0;)m.pop()}else m[r[g]]=f}}function o(s,r){var c=r;return t(r)?c="["+r+"]":s&&(c="."+r),s+c}function a(s,r,c,f){var d,g=h(c),m=!0,y=c,v=f.replace("-1",0),T=!g&&e(c,v),_=r[0];for(d=0;d<s.length;d++)v=f.replace("-1",d),g&&(T=e(y=c[d%c.length],v)),T&&(m=!1),n(s,d,_,T)&&l(s[d],r,f.replace("-1",d))(y);return m}function n(s,r,c,f){if(s[r]===void 0){if(f)return!1;s[r]=typeof c=="number"?[]:{}}return!0}},{"./array":785,"fast-isnumeric":249}],812:[function(i,B,V){B.exports=function(){}},{}],813:[function(i,B,V){var t=i("@plotly/d3"),h=i("fast-isnumeric"),p=[];B.exports=function(u,e){if(p.indexOf(u)===-1){p.push(u);var l=1e3;h(e)?l=e:e==="long"&&(l=3e3);var o=t.select("body").selectAll(".plotly-notifier").data([0]);o.enter().append("div").classed("plotly-notifier",!0),o.selectAll(".notifier-note").data(p).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(n){var s=t.select(this);s.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){s.transition().call(a)});for(var r=s.append("p"),c=n.split(/<br\s*\/?>/g),f=0;f<c.length;f++)f&&r.append("br"),r.append("span").text(c[f]);e==="stick"?s.transition().duration(350).style("opacity",1):s.transition().duration(700).style("opacity",1).transition().delay(l).call(a)})}function a(n){n.duration(700).style("opacity",0).each("end",function(s){var r=p.indexOf(s);r!==-1&&p.splice(r,1),t.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":249}],814:[function(i,B,V){var t=i("./setcursor"),h="data-savedcursor";B.exports=function(p,u){var e=p.attr(h);if(u){if(!e){for(var l=(p.attr("class")||"").split(" "),o=0;o<l.length;o++){var a=l[o];a.indexOf("cursor-")===0&&p.attr(h,a.substr(7)).classed(a,!1)}p.attr(h)||p.attr(h,"!!")}t(p,u)}else e&&(p.attr(h,null),e==="!!"?t(p):t(p,e))}},{"./setcursor":824}],815:[function(i,B,V){var t=i("./matrix").dot,h=i("../constants/numerical").BADNUM,p=B.exports={};p.tester=function(u){var e,l=u.slice(),o=l[0][0],a=o,n=l[0][1],s=n;for(l.push(l[0]),e=1;e<l.length;e++)o=Math.min(o,l[e][0]),a=Math.max(a,l[e][0]),n=Math.min(n,l[e][1]),s=Math.max(s,l[e][1]);var r,c=!1;l.length===5&&(l[0][0]===l[1][0]?l[2][0]===l[3][0]&&l[0][1]===l[3][1]&&l[1][1]===l[2][1]&&(c=!0,r=function(g){return g[0]===l[0][0]}):l[0][1]===l[1][1]&&l[2][1]===l[3][1]&&l[0][0]===l[3][0]&&l[1][0]===l[2][0]&&(c=!0,r=function(g){return g[1]===l[0][1]}));var f=!0,d=l[0];for(e=1;e<l.length;e++)if(d[0]!==l[e][0]||d[1]!==l[e][1]){f=!1;break}return{xmin:o,xmax:a,ymin:n,ymax:s,pts:l,contains:c?function(g,m){var y=g[0],v=g[1];return!(y===h||y<o||y>a||v===h||v<n||v>s)&&(!m||!r(g))}:function(g,m){var y=g[0],v=g[1];if(y===h||y<o||y>a||v===h||v<n||v>s)return!1;var T,_,k,E,A,b=l.length,L=l[0][0],w=l[0][1],C=0;for(T=1;T<b;T++)if(_=L,k=w,L=l[T][0],w=l[T][1],!(y<(E=Math.min(_,L))||y>Math.max(_,L)||v>Math.max(k,w)))if(v<Math.min(k,w))y!==E&&C++;else{if(v===(A=L===_?v:k+(y-_)*(w-k)/(L-_)))return T!==1||!m;v<=A&&y!==E&&C++}return C%2==1},isRect:c,degenerate:f}},p.isSegmentBent=function(u,e,l,o){var a,n,s,r=u[e],c=[u[l][0]-r[0],u[l][1]-r[1]],f=t(c,c),d=Math.sqrt(f),g=[-c[1]/d,c[0]/d];for(a=e+1;a<l;a++)if(n=[u[a][0]-r[0],u[a][1]-r[1]],(s=t(n,c))<0||s>f||Math.abs(t(n,g))>o)return!0;return!1},p.filter=function(u,e){var l=[u[0]],o=0,a=0;function n(s){u.push(s);var r=l.length,c=o;l.splice(a+1);for(var f=c+1;f<u.length;f++)(f===u.length-1||p.isSegmentBent(u,c,f+1,e))&&(l.push(u[f]),l.length<r-2&&(o=f,a=l.length-1),c=f)}return u.length>1&&n(u.pop()),{addPt:n,raw:u,filtered:l}}},{"../constants/numerical":779,"./matrix":809}],816:[function(i,B,V){(function(t){(function(){var h=i("./show_no_webgl_msg"),p=i("regl");B.exports=function(u,e){var l=u._fullLayout,o=!0;return l._glcanvas.each(function(a){if(!a.regl&&(!a.pick||l._has("parcoords"))){try{a.regl=p({canvas:this,attributes:{antialias:!a.pick,preserveDrawingBuffer:!0},pixelRatio:u._context.plotGlPixelRatio||t.devicePixelRatio,extensions:e||[]})}catch{o=!1}a.regl||(o=!1),o&&this.addEventListener("webglcontextlost",function(n){u&&u.emit&&u.emit("plotly_webglcontextlost",{event:n,layer:a.key})},!1)}}),o||h({container:l._glcontainer.node()}),o}}).call(this)}).call(this,typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":825,regl:540}],817:[function(i,B,V){var t=i("fast-isnumeric"),h=i("is-mobile");B.exports=function(p){var u;if(typeof(u=p&&p.hasOwnProperty("userAgent")?p.userAgent:function(){var r;return typeof navigator<"u"&&(r=navigator.userAgent),r&&r.headers&&typeof r.headers["user-agent"]=="string"&&(r=r.headers["user-agent"]),r}())!="string")return!0;var e=h({ua:{headers:{"user-agent":u}},tablet:!0,featureDetect:!1});if(!e){for(var l=u.split(" "),o=1;o<l.length;o++)if(l[o].indexOf("Safari")!==-1)for(var a=o-1;a>-1;a--){var n=l[a];if(n.substr(0,8)==="Version/"){var s=n.substr(8).split(".")[0];if(t(s)&&(s=+s),s>=13)return!0}}}return e}},{"fast-isnumeric":249,"is-mobile":455}],818:[function(i,B,V){B.exports=function(t,h){if(h instanceof RegExp){for(var p=h.toString(),u=0;u<t.length;u++)if(t[u]instanceof RegExp&&t[u].toString()===p)return t;t.push(h)}else!h&&h!==0||t.indexOf(h)!==-1||t.push(h);return t}},{}],819:[function(i,B,V){var t=i("../lib"),h=i("../plot_api/plot_config").dfltConfig,p={add:function(u,e,l,o,a){var n,s;u.undoQueue=u.undoQueue||{index:0,queue:[],sequence:!1},s=u.undoQueue.index,u.autoplay?u.undoQueue.inSequence||(u.autoplay=!1):(!u.undoQueue.sequence||u.undoQueue.beginSequence?(n={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},u.undoQueue.queue.splice(s,u.undoQueue.queue.length-s,n),u.undoQueue.index+=1):n=u.undoQueue.queue[s-1],u.undoQueue.beginSequence=!1,n&&(n.undo.calls.unshift(e),n.undo.args.unshift(l),n.redo.calls.push(o),n.redo.args.push(a)),u.undoQueue.queue.length>h.queueLength&&(u.undoQueue.queue.shift(),u.undoQueue.index--))},startSequence:function(u){u.undoQueue=u.undoQueue||{index:0,queue:[],sequence:!1},u.undoQueue.sequence=!0,u.undoQueue.beginSequence=!0},stopSequence:function(u){u.undoQueue=u.undoQueue||{index:0,queue:[],sequence:!1},u.undoQueue.sequence=!1,u.undoQueue.beginSequence=!1},undo:function(u){var e,l;if(!(u.undoQueue===void 0||isNaN(u.undoQueue.index)||u.undoQueue.index<=0)){for(u.undoQueue.index--,e=u.undoQueue.queue[u.undoQueue.index],u.undoQueue.inSequence=!0,l=0;l<e.undo.calls.length;l++)p.plotDo(u,e.undo.calls[l],e.undo.args[l]);u.undoQueue.inSequence=!1,u.autoplay=!1}},redo:function(u){var e,l;if(!(u.undoQueue===void 0||isNaN(u.undoQueue.index)||u.undoQueue.index>=u.undoQueue.queue.length)){for(e=u.undoQueue.queue[u.undoQueue.index],u.undoQueue.inSequence=!0,l=0;l<e.redo.calls.length;l++)p.plotDo(u,e.redo.calls[l],e.redo.args[l]);u.undoQueue.inSequence=!1,u.autoplay=!1,u.undoQueue.index++}}};p.plotDo=function(u,e,l){u.autoplay=!0,l=function(o,a){for(var n,s=[],r=0;r<a.length;r++)n=a[r],s[r]=n===o?n:typeof n=="object"?Array.isArray(n)?t.extendDeep([],n):t.extendDeepAll({},n):n;return s}(u,l),e.apply(null,l)},B.exports=p},{"../lib":803,"../plot_api/plot_config":841}],820:[function(i,B,V){V.counter=function(t,h,p,u){var e=(h||"")+(p?"":"$"),l=u===!1?"":"^";return t==="xy"?new RegExp(l+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(l+t+"([2-9]|[1-9][0-9]+)?"+e)}},{}],821:[function(i,B,V){var t=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,h=/^[^\.\[\]]+$/;B.exports=function(p,u){for(;u;){var e=p.match(t);if(e)p=e[1];else{if(!p.match(h))throw new Error("bad relativeAttr call:"+[p,u]);p=""}if(u.charAt(0)!=="^")break;u=u.slice(1)}return p&&u.charAt(0)!=="["?p+"."+u:p+u}},{}],822:[function(i,B,V){var t=i("./array").isArrayOrTypedArray,h=i("./is_plain_object");B.exports=function p(u,e){for(var l in e){var o=e[l],a=u[l];if(a!==o)if(l.charAt(0)==="_"||typeof o=="function"){if(l in u)continue;u[l]=o}else if(t(o)&&t(a)&&h(o[0])){if(l==="customdata"||l==="ids")continue;for(var n=Math.min(o.length,a.length),s=0;s<n;s++)a[s]!==o[s]&&h(o[s])&&h(a[s])&&p(a[s],o[s])}else h(o)&&h(a)&&(p(a,o),Object.keys(a).length||delete u[l])}}},{"./array":785,"./is_plain_object":804}],823:[function(i,B,V){var t=i("fast-isnumeric"),h=i("./loggers"),p=i("./identity"),u=i("../constants/numerical").BADNUM;function e(n,s){return n<s}function l(n,s){return n<=s}function o(n,s){return n>s}function a(n,s){return n>=s}V.findBin=function(n,s,r){if(t(s.start))return r?Math.ceil((n-s.start)/s.size-1e-9)-1:Math.floor((n-s.start)/s.size+1e-9);var c,f,d=0,g=s.length,m=0,y=g>1?(s[g-1]-s[0])/(g-1):1;for(f=y>=0?r?e:l:r?a:o,n+=1e-9*y*(r?-1:1)*(y>=0?1:-1);d<g&&m++<100;)f(s[c=Math.floor((d+g)/2)],n)?d=c+1:g=c;return m>90&&h.log("Long binary search..."),d-1},V.sorterAsc=function(n,s){return n-s},V.sorterDes=function(n,s){return s-n},V.distinctVals=function(n){var s,r=n.slice();for(r.sort(V.sorterAsc),s=r.length-1;s>-1&&r[s]===u;s--);for(var c,f=r[s]-r[0]||1,d=f/(s||1)/1e4,g=[],m=0;m<=s;m++){var y=r[m],v=y-c;c===void 0?(g.push(y),c=y):v>d&&(f=Math.min(f,v),g.push(y),c=y)}return{vals:g,minDiff:f}},V.roundUp=function(n,s,r){for(var c,f=0,d=s.length-1,g=0,m=r?0:1,y=r?1:0,v=r?Math.ceil:Math.floor;f<d&&g++<100;)s[c=v((f+d)/2)]<=n?f=c+m:d=c-y;return s[f]},V.sort=function(n,s){for(var r=0,c=0,f=1;f<n.length;f++){var d=s(n[f],n[f-1]);if(d<0?r=1:d>0&&(c=1),r&&c)return n.sort(s)}return c?n:n.reverse()},V.findIndexOfMin=function(n,s){s=s||p;for(var r,c=1/0,f=0;f<n.length;f++){var d=s(n[f]);d<c&&(c=d,r=f)}return r}},{"../constants/numerical":779,"./identity":801,"./loggers":807,"fast-isnumeric":249}],824:[function(i,B,V){B.exports=function(t,h){(t.attr("class")||"").split(" ").forEach(function(p){p.indexOf("cursor-")===0&&t.classed(p,!1)}),h&&t.classed("cursor-"+h,!0)}},{}],825:[function(i,B,V){var t=i("../components/color"),h=function(){};B.exports=function(p){for(var u in p)typeof p[u]=="function"&&(p[u]=h);p.destroy=function(){p.container.parentNode.removeChild(p.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=t.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=t.lightLine,e.style["z-index"]=30;var l=document.createElement("p");return l.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",l.style.position="relative",l.style.top="50%",l.style.left="50%",l.style.height="30%",l.style.width="50%",l.style.margin="-15% 0 0 -25%",e.appendChild(l),p.container.appendChild(e),p.container.style.background="#FFFFFF",p.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":666}],826:[function(i,B,V){B.exports=function(t){return Object.keys(t).sort()}},{}],827:[function(i,B,V){var t=i("fast-isnumeric"),h=i("./array").isArrayOrTypedArray;V.aggNums=function(p,u,e,l){var o,a;if((!l||l>e.length)&&(l=e.length),t(u)||(u=!1),h(e[0])){for(a=new Array(l),o=0;o<l;o++)a[o]=V.aggNums(p,u,e[o]);e=a}for(o=0;o<l;o++)t(u)?t(e[o])&&(u=p(+u,+e[o])):u=e[o];return u},V.len=function(p){return V.aggNums(function(u){return u+1},0,p)},V.mean=function(p,u){return u||(u=V.len(p)),V.aggNums(function(e,l){return e+l},0,p)/u},V.midRange=function(p){if(p!==void 0&&p.length!==0)return(V.aggNums(Math.max,null,p)+V.aggNums(Math.min,null,p))/2},V.variance=function(p,u,e){return u||(u=V.len(p)),t(e)||(e=V.mean(p,u)),V.aggNums(function(l,o){return l+Math.pow(o-e,2)},0,p)/u},V.stdev=function(p,u,e){return Math.sqrt(V.variance(p,u,e))},V.median=function(p){var u=p.slice().sort();return V.interp(u,.5)},V.interp=function(p,u){if(!t(u))throw"n should be a finite number";if((u=u*p.length-.5)<0)return p[0];if(u>p.length-1)return p[p.length-1];var e=u%1;return e*p[Math.ceil(u)]+(1-e)*p[Math.floor(u)]}},{"./array":785,"fast-isnumeric":249}],828:[function(i,B,V){var t=i("color-normalize");B.exports=function(h){return h?t(h):[0,0,0,1]}},{"color-normalize":131}],829:[function(i,B,V){var t=i("@plotly/d3"),h=i("../lib"),p=h.strTranslate,u=i("../constants/xmlns_namespaces"),e=i("../constants/alignment").LINE_SPACING;function l(P,z){return P.node().getBoundingClientRect()[z]}var o=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;V.convertToTspans=function(P,z,F){var q=P.text(),W=!P.attr("data-notex")&&typeof MathJax<"u"&&q.match(o),X=t.select(P.node().parentNode);if(!X.empty()){var Q=P.attr("class")?P.attr("class").split(" ")[0]:"text";return Q+="-math",X.selectAll("svg."+Q).remove(),X.selectAll("g."+Q+"-group").remove(),P.style("display",null).attr({"data-unformatted":q,"data-math":"N"}),W?(z&&z._promises||[]).push(new Promise(function(Y){P.style("display","none");var N=parseInt(P.node().style.fontSize,10),J={fontSize:N};(function(D,U,G){var $,K,re,ne;MathJax.Hub.Queue(function(){return K=h.extendDeepAll({},MathJax.Hub.config),re=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){if(($=MathJax.Hub.config.menuSettings.renderer)!=="SVG")return MathJax.Hub.setRenderer("SVG")},function(){var ae="math-output-"+h.randstr({},64);return ne=t.select("body").append("div").attr({id:ae}).style({visibility:"hidden",position:"absolute"}).style({"font-size":U.fontSize+"px"}).text(D.replace(a,"\\lt ").replace(n,"\\gt ")),MathJax.Hub.Typeset(ne.node())},function(){var ae=t.select("body").select("#MathJax_SVG_glyphs");if(ne.select(".MathJax_SVG").empty()||!ne.select("svg").node())h.log("There was an error in the tex syntax.",D),G();else{var ie=ne.select("svg").node().getBoundingClientRect();G(ne.select(".MathJax_SVG"),ae,ie)}if(ne.remove(),$!=="SVG")return MathJax.Hub.setRenderer($)},function(){return re!==void 0&&(MathJax.Hub.processSectionDelay=re),MathJax.Hub.Config(K)})})(W[2],J,function(D,U,G){X.selectAll("svg."+Q).remove(),X.selectAll("g."+Q+"-group").remove();var $=D&&D.select("svg");if(!$||!$.node())return Z(),void Y();var K=X.append("g").classed(Q+"-group",!0).attr({"pointer-events":"none","data-unformatted":q,"data-math":"Y"});K.node().appendChild($.node()),U&&U.node()&&$.node().insertBefore(U.node().cloneNode(!0),$.node().firstChild),$.attr({class:Q,height:G.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var re=P.node().style.fill||"black",ne=$.select("g");ne.attr({fill:re,stroke:re});var ae=l(ne,"width"),ie=l(ne,"height"),he=+P.attr("x")-ae*{start:0,middle:.5,end:1}[P.attr("text-anchor")||"start"],se=-(N||l(P,"height"))/4;Q[0]==="y"?(K.attr({transform:"rotate("+[-90,+P.attr("x"),+P.attr("y")]+")"+p(-ae/2,se-ie/2)}),$.attr({x:+P.attr("x"),y:+P.attr("y")})):Q[0]==="l"?$.attr({x:P.attr("x"),y:se-ie/2}):Q[0]==="a"&&Q.indexOf("atitle")!==0?$.attr({x:0,y:se}):$.attr({x:he,y:+P.attr("y")+se-ie/2}),F&&F.call(P,K),Y(K)})})):Z(),P}function Z(){X.empty()||(Q=P.attr("class")+"-math",X.select("svg."+Q).remove()),P.text("").style("white-space","pre"),function(Y,N){N=N.replace(d," ");var J,D=!1,U=[],G=-1;function $(){G++;var fe=document.createElementNS(u.svg,"tspan");t.select(fe).attr({class:"line",dy:G*e+"em"}),Y.appendChild(fe),J=fe;var ge=U;if(U=[{node:fe}],ge.length>1)for(var ke=1;ke<ge.length;ke++)K(ge[ke])}function K(fe){var ge,ke=fe.type,Me={};if(ke==="a"){ge="a";var Se=fe.target,De=fe.href,Be=fe.popup;De&&(Me={"xlink:xlink:show":Se==="_blank"||Se.charAt(0)!=="_"?"new":"replace",target:Se,"xlink:xlink:href":De},Be&&(Me.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Be+'");return false;'))}else ge="tspan";fe.style&&(Me.style=fe.style);var We=document.createElementNS(u.svg,ge);if(ke==="sup"||ke==="sub"){re(J,"​"),J.appendChild(We);var Qe=document.createElementNS(u.svg,"tspan");re(Qe,"​"),t.select(Qe).attr("dy",c[ke]),Me.dy=r[ke],J.appendChild(We),J.appendChild(Qe)}else J.appendChild(We);t.select(We).attr(Me),J=fe.node=We,U.push(fe)}function re(fe,ge){fe.appendChild(document.createTextNode(ge))}function ne(fe){if(U.length!==1){var ge=U.pop();fe!==ge.type&&h.log("Start tag <"+ge.type+"> doesnt match end tag <"+fe+">. Pretending it did match.",N),J=U[U.length-1].node}else h.log("Ignoring unexpected end tag </"+fe+">.",N)}y.test(N)?$():(J=Y,U=[{node:Y}]);for(var ae=N.split(g),ie=0;ie<ae.length;ie++){var he=ae[ie],se=he.match(m),de=se&&se[2].toLowerCase(),ce=s[de];if(de==="br")$();else if(ce===void 0)re(J,w(he));else if(se[1])ne(de);else{var ve=se[4],Ee={type:de},Le=E(ve,v);if(Le?(Le=Le.replace(A,"$1 fill:"),ce&&(Le+=";"+ce)):ce&&(Le=ce),Le&&(Ee.style=Le),de==="a"){D=!0;var Te=E(ve,T);if(Te){var xe=C(Te);xe&&(Ee.href=xe,Ee.target=E(ve,_)||"_blank",Ee.popup=E(ve,k))}}K(Ee)}}return D}(P.node(),q)&&P.style("pointer-events","all"),V.positionText(P),F&&F.call(P)}};var a=/(<|&lt;|&#60;)/g,n=/(>|&gt;|&#62;)/g,s={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},r={sub:"0.3em",sup:"-0.6em"},c={sub:"-0.21em",sup:"0.42em"},f=["http:","https:","mailto:","",void 0,":"],d=V.NEWLINES=/(\r\n?|\n)/g,g=/(<[^<>]*>)/,m=/<(\/?)([^ >]*)(\s+(.*))?>/i,y=/<br(\s+.*)?>/i;V.BR_TAG_ALL=/<br(\s+.*)?>/gi;var v=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,T=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,_=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,k=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function E(P,z){if(!P)return null;var F=P.match(z),q=F&&(F[3]||F[4]);return q&&w(q)}var A=/(^|;)\s*color:/;V.plainText=function(P,z){for(var F=(z=z||{}).len!==void 0&&z.len!==-1?z.len:1/0,q=z.allowedTags!==void 0?z.allowedTags:["br"],W=3,X=P.split(g),Q=[],Z="",Y=0,N=0;N<X.length;N++){var J=X[N],D=J.match(m),U=D&&D[2].toLowerCase();if(U)q.indexOf(U)!==-1&&(Q.push(J),Z=U);else{var G=J.length;if(Y+G<F)Q.push(J),Y+=G;else if(Y<F){var $=F-Y;Z&&(Z!=="br"||$<=W||G<=W)&&Q.pop(),F>W?Q.push(J.substr(0,$-W)+"..."):Q.push(J.substr(0,$));break}Z=""}}return Q.join("")};var b={mu:"μ",amp:"&",lt:"<",gt:">",nbsp:" ",times:"×",plusmn:"±",deg:"°"},L=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function w(P){return P.replace(L,function(z,F){return(F.charAt(0)==="#"?function(q){if(!(q>1114111)){var W=String.fromCodePoint;if(W)return W(q);var X=String.fromCharCode;return q<=65535?X(q):X(55232+(q>>10),q%1024+56320)}}(F.charAt(1)==="x"?parseInt(F.substr(2),16):parseInt(F.substr(1),10)):b[F])||z})}function C(P){var z=encodeURI(decodeURI(P)),F=document.createElement("a"),q=document.createElement("a");F.href=P,q.href=z;var W=F.protocol,X=q.protocol;return f.indexOf(W)!==-1&&f.indexOf(X)!==-1?z:""}function S(P,z,F){var q,W,X,Q=F.horizontalAlign,Z=F.verticalAlign||"top",Y=P.node().getBoundingClientRect(),N=z.node().getBoundingClientRect();return W=Z==="bottom"?function(){return Y.bottom-q.height}:Z==="middle"?function(){return Y.top+(Y.height-q.height)/2}:function(){return Y.top},X=Q==="right"?function(){return Y.right-q.width}:Q==="center"?function(){return Y.left+(Y.width-q.width)/2}:function(){return Y.left},function(){q=this.node().getBoundingClientRect();var J=X()-N.left,D=W()-N.top,U=F.gd||{};if(F.gd){U._fullLayout._calcInverseTransform(U);var G=h.apply3DTransform(U._fullLayout._invTransform)(J,D);J=G[0],D=G[1]}return this.style({top:D+"px",left:J+"px","z-index":1e3}),this}}V.convertEntities=w,V.sanitizeHTML=function(P){P=P.replace(d," ");for(var z=document.createElement("p"),F=z,q=[],W=P.split(g),X=0;X<W.length;X++){var Q=W[X],Z=Q.match(m),Y=Z&&Z[2].toLowerCase();if(Y in s)if(Z[1])q.length&&(F=q.pop());else{var N=Z[4],J=E(N,v),D=J?{style:J}:{};if(Y==="a"){var U=E(N,T);if(U){var G=C(U);if(G){D.href=G;var $=E(N,_);$&&(D.target=$)}}}var K=document.createElement(Y);F.appendChild(K),t.select(K).attr(D),F=K,q.push(K)}else F.appendChild(document.createTextNode(w(Q)))}return z.innerHTML},V.lineCount=function(P){return P.selectAll("tspan.line").size()||1},V.positionText=function(P,z,F){return P.each(function(){var q=t.select(this);function W(Z,Y){return Y===void 0?(Y=q.attr(Z))===null&&(q.attr(Z,0),Y=0):q.attr(Z,Y),Y}var X=W("x",z),Q=W("y",F);this.nodeName==="text"&&q.selectAll("tspan.line").attr({x:X,y:Q})})},V.makeTextShadow=function(P){var z="1px ",F="1px ",q="1px ";return z+F+q+P+", -"+z+"-"+F+q+P+", "+z+"-"+F+q+P+", -"+z+F+q+P},V.makeEditable=function(P,z){var F=z.gd,q=z.delegate,W=t.dispatch("edit","input","cancel"),X=q||P;if(P.style({"pointer-events":q?"none":"all"}),P.size()!==1)throw new Error("boo");function Q(){(function(){var J=t.select(F).select(".svg-container"),D=J.append("div"),U=P.node().style,G=parseFloat(U.fontSize||12),$=z.text;$===void 0&&($=P.attr("data-unformatted")),D.classed("plugin-editable editable",!0).style({position:"absolute","font-family":U.fontFamily||"Arial","font-size":G,color:z.fill||U.fill||"black",opacity:1,"background-color":z.background||"transparent",outline:"#ffffff33 1px solid",margin:[-G/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text($).call(S(P,J,z)).on("blur",function(){F._editing=!1,P.text(this.textContent).style({opacity:1});var K,re=t.select(this).attr("class");(K=re?"."+re.split(" ")[0]+"-math-group":"[class*=-math-group]")&&t.select(P.node().parentNode).select(K).style({opacity:0});var ne=this.textContent;t.select(this).transition().duration(0).remove(),t.select(document).on("mouseup",null),W.edit.call(P,ne)}).on("focus",function(){var K=this;F._editing=!0,t.select(document).on("mouseup",function(){if(t.event.target===K)return!1;document.activeElement===D.node()&&D.node().blur()})}).on("keyup",function(){t.event.which===27?(F._editing=!1,P.style({opacity:1}),t.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),W.cancel.call(P,this.textContent)):(W.input.call(P,this.textContent),t.select(this).call(S(P,J,z)))}).on("keydown",function(){t.event.which===13&&this.blur()}).call(Z)})(),P.style({opacity:0});var Y,N=X.attr("class");(Y=N?"."+N.split(" ")[0]+"-math-group":"[class*=-math-group]")&&t.select(P.node().parentNode).select(Y).style({opacity:0})}function Z(Y){var N=Y.node(),J=document.createRange();J.selectNodeContents(N);var D=window.getSelection();D.removeAllRanges(),D.addRange(J),N.focus()}return z.immediate?Q():X.on("click",Q),t.rebind(P,W,"on")}},{"../constants/alignment":771,"../constants/xmlns_namespaces":780,"../lib":803,"@plotly/d3":58}],830:[function(i,B,V){var t={};function h(p){p&&p.timer!==null&&(clearTimeout(p.timer),p.timer=null)}V.throttle=function(p,u,e){var l=t[p],o=Date.now();if(!l){for(var a in t)t[a].ts<o-6e4&&delete t[a];l=t[p]={ts:0,timer:null}}function n(){e(),l.ts=Date.now(),l.onDone&&(l.onDone(),l.onDone=null)}h(l),o>l.ts+u?n():l.timer=setTimeout(function(){n(),l.timer=null},u)},V.done=function(p){var u=t[p];return u&&u.timer?new Promise(function(e){var l=u.onDone;u.onDone=function(){l&&l(),e(),u.onDone=null}}):Promise.resolve()},V.clear=function(p){if(p)h(t[p]),delete t[p];else for(var u in t)V.clear(u)}},{}],831:[function(i,B,V){var t=i("fast-isnumeric");B.exports=function(h,p){if(h>0)return Math.log(h)/Math.LN10;var u=Math.log(Math.min(p[0],p[1]))/Math.LN10;return t(u)||(u=Math.log(Math.max(p[0],p[1]))/Math.LN10-6),u}},{"fast-isnumeric":249}],832:[function(i,B,V){var t=B.exports={},h=i("../plots/geo/constants").locationmodeToLayer,p=i("topojson-client").feature;t.getTopojsonName=function(u){return[u.scope.replace(/ /g,"-"),"_",u.resolution.toString(),"m"].join("")},t.getTopojsonPath=function(u,e){return u+e+".json"},t.getTopojsonFeatures=function(u,e){var l=h[u.locationmode],o=e.objects[l];return p(e,o).features}},{"../plots/geo/constants":885,"topojson-client":601}],833:[function(i,B,V){B.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],834:[function(i,B,V){B.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],835:[function(i,B,V){var t=i("../registry");B.exports=function(h){for(var p,u,e=t.layoutArrayContainers,l=t.layoutArrayRegexes,o=h.split("[")[0],a=0;a<l.length;a++)if((u=h.match(l[a]))&&u.index===0){p=u[0];break}if(p||(p=e[e.indexOf(o)]),!p)return!1;var n=h.substr(p.length);return n?!!(u=n.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:p,index:Number(u[1]),property:u[3]||""}:{array:p,index:"",property:""}}},{"../registry":931}],836:[function(i,B,V){var t=i("../lib"),h=t.extendFlat,p=t.isPlainObject,u={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},l=u.flags.slice().concat(["fullReplot"]),o=e.flags.slice().concat("layoutReplot");function a(r){for(var c={},f=0;f<r.length;f++)c[r[f]]=!1;return c}function n(r,c,f){var d=h({},r);for(var g in d){var m=d[g];p(m)&&(d[g]=s(m,c,f,g))}return f==="from-root"&&(d.editType=c),d}function s(r,c,f,d){if(r.valType){var g=h({},r);if(g.editType=c,Array.isArray(r.items)){g.items=new Array(r.items.length);for(var m=0;m<r.items.length;m++)g.items[m]=s(r.items[m],c)}return g}return n(r,c,d.charAt(0)==="_"?"nested":"from-root")}B.exports={traces:u,layout:e,traceFlags:function(){return a(l)},layoutFlags:function(){return a(o)},update:function(r,c){var f=c.editType;if(f&&f!=="none")for(var d=f.split("+"),g=0;g<d.length;g++)r[d[g]]=!0},overrideAll:n}},{"../lib":803}],837:[function(i,B,V){var t=i("fast-isnumeric"),h=i("gl-mat4/fromQuat"),p=i("../registry"),u=i("../lib"),e=i("../plots/plots"),l=i("../plots/cartesian/axis_ids"),o=i("../components/color"),a=l.cleanId,n=l.getFromTrace,s=p.traceIs;function r(_,k){var E=_[k],A=k.charAt(0);E&&E!=="paper"&&(_[k]=a(E,A,!0))}function c(_){function k(E,A){var b=_[E],L=_.title&&_.title[A];b&&!L&&(_.title||(_.title={}),_.title[A]=_[E],delete _[E])}_&&(typeof _.title!="string"&&typeof _.title!="number"||(_.title={text:_.title}),k("titlefont","font"),k("titleposition","position"),k("titleside","side"),k("titleoffset","offset"))}function f(_){if(!u.isPlainObject(_))return!1;var k=_.name;return delete _.name,delete _.showlegend,(typeof k=="string"||typeof k=="number")&&String(k)}function d(_,k,E,A){if(E&&!A)return _;if(A&&!E||!_.trim())return k;if(!k.trim())return _;var b,L=Math.min(_.length,k.length);for(b=0;b<L&&_.charAt(b)===k.charAt(b);b++);return _.substr(0,b).trim()}function g(_){var k="middle",E="center";return typeof _=="string"&&(_.indexOf("top")!==-1?k="top":_.indexOf("bottom")!==-1&&(k="bottom"),_.indexOf("left")!==-1?E="left":_.indexOf("right")!==-1&&(E="right")),k+" "+E}function m(_,k){return k in _&&typeof _[k]=="object"&&Object.keys(_[k]).length===0}V.clearPromiseQueue=function(_){Array.isArray(_._promises)&&_._promises.length>0&&u.log("Clearing previous rejected promises from queue."),_._promises=[]},V.cleanLayout=function(_){var k,E;_||(_={}),_.xaxis1&&(_.xaxis||(_.xaxis=_.xaxis1),delete _.xaxis1),_.yaxis1&&(_.yaxis||(_.yaxis=_.yaxis1),delete _.yaxis1),_.scene1&&(_.scene||(_.scene=_.scene1),delete _.scene1);var A=(e.subplotsRegistry.cartesian||{}).attrRegex,b=(e.subplotsRegistry.polar||{}).attrRegex,L=(e.subplotsRegistry.ternary||{}).attrRegex,w=(e.subplotsRegistry.gl3d||{}).attrRegex,C=Object.keys(_);for(k=0;k<C.length;k++){var S=C[k];if(A&&A.test(S)){var P=_[S];P.anchor&&P.anchor!=="free"&&(P.anchor=a(P.anchor)),P.overlaying&&(P.overlaying=a(P.overlaying)),P.type||(P.isdate?P.type="date":P.islog?P.type="log":P.isdate===!1&&P.islog===!1&&(P.type="linear")),P.autorange!=="withzero"&&P.autorange!=="tozero"||(P.autorange=!0,P.rangemode="tozero"),delete P.islog,delete P.isdate,delete P.categories,m(P,"domain")&&delete P.domain,P.autotick!==void 0&&(P.tickmode===void 0&&(P.tickmode=P.autotick?"auto":"linear"),delete P.autotick),c(P)}else if(b&&b.test(S))c(_[S].radialaxis);else if(L&&L.test(S)){var z=_[S];c(z.aaxis),c(z.baxis),c(z.caxis)}else if(w&&w.test(S)){var F=_[S],q=F.cameraposition;if(Array.isArray(q)&&q[0].length===4){var W=q[0],X=q[1],Q=q[2],Z=h([],W),Y=[];for(E=0;E<3;++E)Y[E]=X[E]+Q*Z[2+4*E];F.camera={eye:{x:Y[0],y:Y[1],z:Y[2]},center:{x:X[0],y:X[1],z:X[2]},up:{x:0,y:0,z:1}},delete F.cameraposition}c(F.xaxis),c(F.yaxis),c(F.zaxis)}}var N=Array.isArray(_.annotations)?_.annotations.length:0;for(k=0;k<N;k++){var J=_.annotations[k];u.isPlainObject(J)&&(J.ref&&(J.ref==="paper"?(J.xref="paper",J.yref="paper"):J.ref==="data"&&(J.xref="x",J.yref="y"),delete J.ref),r(J,"xref"),r(J,"yref"))}var D=Array.isArray(_.shapes)?_.shapes.length:0;for(k=0;k<D;k++){var U=_.shapes[k];u.isPlainObject(U)&&(r(U,"xref"),r(U,"yref"))}var G=Array.isArray(_.images)?_.images.length:0;for(k=0;k<G;k++){var $=_.images[k];u.isPlainObject($)&&(r($,"xref"),r($,"yref"))}var K=_.legend;return K&&(K.x>3?(K.x=1.02,K.xanchor="left"):K.x<-2&&(K.x=-.02,K.xanchor="right"),K.y>3?(K.y=1.02,K.yanchor="bottom"):K.y<-2&&(K.y=-.02,K.yanchor="top")),c(_),_.dragmode==="rotate"&&(_.dragmode="orbit"),o.clean(_),_.template&&_.template.layout&&V.cleanLayout(_.template.layout),_},V.cleanData=function(_){for(var k=0;k<_.length;k++){var E,A=_[k];if(A.type==="histogramy"&&"xbins"in A&&!("ybins"in A)&&(A.ybins=A.xbins,delete A.xbins),A.error_y&&"opacity"in A.error_y){var b=o.defaults,L=A.error_y.color||(s(A,"bar")?o.defaultLine:b[k%b.length]);A.error_y.color=o.addOpacity(o.rgb(L),o.opacity(L)*A.error_y.opacity),delete A.error_y.opacity}if("bardir"in A&&(A.bardir!=="h"||!s(A,"bar")&&A.type.substr(0,9)!=="histogram"||(A.orientation="h",V.swapXYData(A)),delete A.bardir),A.type==="histogramy"&&V.swapXYData(A),A.type!=="histogramx"&&A.type!=="histogramy"||(A.type="histogram"),"scl"in A&&!("colorscale"in A)&&(A.colorscale=A.scl,delete A.scl),"reversescl"in A&&!("reversescale"in A)&&(A.reversescale=A.reversescl,delete A.reversescl),A.xaxis&&(A.xaxis=a(A.xaxis,"x")),A.yaxis&&(A.yaxis=a(A.yaxis,"y")),s(A,"gl3d")&&A.scene&&(A.scene=e.subplotsRegistry.gl3d.cleanId(A.scene)),!s(A,"pie-like")&&!s(A,"bar-like"))if(Array.isArray(A.textposition))for(E=0;E<A.textposition.length;E++)A.textposition[E]=g(A.textposition[E]);else A.textposition&&(A.textposition=g(A.textposition));var w=p.getModule(A);if(w&&w.colorbar){var C=w.colorbar.container,S=C?A[C]:A;S&&S.colorscale&&(S.colorscale==="YIGnBu"&&(S.colorscale="YlGnBu"),S.colorscale==="YIOrRd"&&(S.colorscale="YlOrRd"))}if(A.type==="surface"&&u.isPlainObject(A.contours)){var P=["x","y","z"];for(E=0;E<P.length;E++){var z=A.contours[P[E]];u.isPlainObject(z)&&(z.highlightColor&&(z.highlightcolor=z.highlightColor,delete z.highlightColor),z.highlightWidth&&(z.highlightwidth=z.highlightWidth,delete z.highlightWidth))}}if(A.type==="candlestick"||A.type==="ohlc"){var F=(A.increasing||{}).showlegend!==!1,q=(A.decreasing||{}).showlegend!==!1,W=f(A.increasing),X=f(A.decreasing);if(W!==!1&&X!==!1){var Q=d(W,X,F,q);Q&&(A.name=Q)}else!W&&!X||A.name||(A.name=W||X)}if(Array.isArray(A.transforms)){var Z=A.transforms;for(E=0;E<Z.length;E++){var Y=Z[E];if(u.isPlainObject(Y))switch(Y.type){case"filter":Y.filtersrc&&(Y.target=Y.filtersrc,delete Y.filtersrc),Y.calendar&&(Y.valuecalendar||(Y.valuecalendar=Y.calendar),delete Y.calendar);break;case"groupby":if(Y.styles=Y.styles||Y.style,Y.styles&&!Array.isArray(Y.styles)){var N=Y.styles,J=Object.keys(N);Y.styles=[];for(var D=0;D<J.length;D++)Y.styles.push({target:J[D],value:N[J[D]]})}}}}m(A,"line")&&delete A.line,"marker"in A&&(m(A.marker,"line")&&delete A.marker.line,m(A,"marker")&&delete A.marker),o.clean(A),A.autobinx&&(delete A.autobinx,delete A.xbins),A.autobiny&&(delete A.autobiny,delete A.ybins),c(A),A.colorbar&&c(A.colorbar),A.marker&&A.marker.colorbar&&c(A.marker.colorbar),A.line&&A.line.colorbar&&c(A.line.colorbar),A.aaxis&&c(A.aaxis),A.baxis&&c(A.baxis)}},V.swapXYData=function(_){var k;if(u.swapAttrs(_,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(_.z)&&Array.isArray(_.z[0])&&(_.transpose?delete _.transpose:_.transpose=!0),_.error_x&&_.error_y){var E=_.error_y,A="copy_ystyle"in E?E.copy_ystyle:!(E.color||E.thickness||E.width);u.swapAttrs(_,["error_?.copy_ystyle"]),A&&u.swapAttrs(_,["error_?.color","error_?.thickness","error_?.width"])}if(typeof _.hoverinfo=="string"){var b=_.hoverinfo.split("+");for(k=0;k<b.length;k++)b[k]==="x"?b[k]="y":b[k]==="y"&&(b[k]="x");_.hoverinfo=b.join("+")}},V.coerceTraceIndices=function(_,k){if(t(k))return[k];if(!Array.isArray(k)||!k.length)return _.data.map(function(b,L){return L});if(Array.isArray(k)){for(var E=[],A=0;A<k.length;A++)u.isIndex(k[A],_.data.length)?E.push(k[A]):u.warn("trace index (",k[A],") is not a number or is out of bounds");return E}return k},V.manageArrayContainers=function(_,k,E){var A=_.obj,b=_.parts,L=b.length,w=b[L-1],C=t(w);if(C&&k===null){var S=b.slice(0,L-1).join(".");u.nestedProperty(A,S).get().splice(w,1)}else C&&_.get()===void 0&&_.get()===void 0&&(E[_.astr]=null),_.set(k)};var y=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function v(_){var k=_.search(y);if(k>0)return _.substr(0,k)}V.hasParent=function(_,k){for(var E=v(k);E;){if(E in _)return!0;E=v(E)}return!1};var T=["x","y","z"];V.clearAxisTypes=function(_,k,E){for(var A=0;A<k.length;A++)for(var b=_._fullData[A],L=0;L<3;L++){var w=n(_,b,T[L]);if(w&&w.type!=="log"){var C=w._name,S=w._id.substr(1);if(S.substr(0,5)==="scene"){if(E[S]!==void 0)continue;C=S+"."+C}var P=C+".type";E[C]===void 0&&E[P]===void 0&&u.nestedProperty(_.layout,P).set(null)}}}},{"../components/color":666,"../lib":803,"../plots/cartesian/axis_ids":858,"../plots/plots":917,"../registry":931,"fast-isnumeric":249,"gl-mat4/fromQuat":288}],838:[function(i,B,V){var t=i("./plot_api");V._doPlot=t._doPlot,V.newPlot=t.newPlot,V.restyle=t.restyle,V.relayout=t.relayout,V.redraw=t.redraw,V.update=t.update,V._guiRestyle=t._guiRestyle,V._guiRelayout=t._guiRelayout,V._guiUpdate=t._guiUpdate,V._storeDirectGUIEdit=t._storeDirectGUIEdit,V.react=t.react,V.extendTraces=t.extendTraces,V.prependTraces=t.prependTraces,V.addTraces=t.addTraces,V.deleteTraces=t.deleteTraces,V.moveTraces=t.moveTraces,V.purge=t.purge,V.addFrames=t.addFrames,V.deleteFrames=t.deleteFrames,V.animate=t.animate,V.setPlotConfig=t.setPlotConfig,V.toImage=i("./to_image"),V.validate=i("./validate"),V.downloadImage=i("../snapshot/download");var h=i("./template_api");V.makeTemplate=h.makeTemplate,V.validateTemplate=h.validateTemplate},{"../snapshot/download":933,"./plot_api":840,"./template_api":845,"./to_image":846,"./validate":847}],839:[function(i,B,V){var t=i("../lib/is_plain_object"),h=i("../lib/noop"),p=i("../lib/loggers"),u=i("../lib/search").sorterAsc,e=i("../registry");V.containerArrayMatch=i("./container_array_match");var l=V.isAddVal=function(a){return a==="add"||t(a)},o=V.isRemoveVal=function(a){return a===null||a==="remove"};V.applyContainerArrayChanges=function(a,n,s,r,c){var f=n.astr,d=e.getComponentMethod(f,"supplyLayoutDefaults"),g=e.getComponentMethod(f,"draw"),m=e.getComponentMethod(f,"drawOne"),y=r.replot||r.recalc||d===h||g===h,v=a.layout,T=a._fullLayout;if(s[""]){Object.keys(s).length>1&&p.warn("Full array edits are incompatible with other edits",f);var _=s[""][""];if(o(_))n.set(null);else{if(!Array.isArray(_))return p.warn("Unrecognized full array edit value",f,_),!0;n.set(_)}return!y&&(d(v,T),g(a),!0)}var k,E,A,b,L,w,C,S,P=Object.keys(s).map(Number).sort(u),z=n.get(),F=z||[],q=c(T,f).get(),W=[],X=-1,Q=F.length;for(k=0;k<P.length;k++)if(b=s[A=P[k]],L=Object.keys(b),w=b[""],C=l(w),A<0||A>F.length-(C?0:1))p.warn("index out of range",f,A);else if(w!==void 0)L.length>1&&p.warn("Insertion & removal are incompatible with edits to the same index.",f,A),o(w)?W.push(A):C?(w==="add"&&(w={}),F.splice(A,0,w),q&&q.splice(A,0,{})):p.warn("Unrecognized full object edit value",f,A,w),X===-1&&(X=A);else for(E=0;E<L.length;E++)S=f+"["+A+"].",c(F[A],L[E],S).set(b[L[E]]);for(k=W.length-1;k>=0;k--)F.splice(W[k],1),q&&q.splice(W[k],1);if(F.length?z||n.set(F):n.set(null),y)return!1;if(d(v,T),m!==h){var Z;if(X===-1)Z=P;else{for(Q=Math.max(F.length,Q),Z=[],k=0;k<P.length&&!((A=P[k])>=X);k++)Z.push(A);for(k=X;k<Q;k++)Z.push(k)}for(k=0;k<Z.length;k++)m(a,Z[k])}else g(a);return!0}},{"../lib/is_plain_object":804,"../lib/loggers":807,"../lib/noop":812,"../lib/search":823,"../registry":931,"./container_array_match":835}],840:[function(i,B,V){var t=i("@plotly/d3"),h=i("fast-isnumeric"),p=i("has-hover"),u=i("../lib"),e=u.nestedProperty,l=i("../lib/events"),o=i("../lib/queue"),a=i("../registry"),n=i("./plot_schema"),s=i("../plots/plots"),r=i("../plots/cartesian/axes"),c=i("../components/drawing"),f=i("../components/color"),d=i("../plots/cartesian/graph_interact").initInteractions,g=i("../constants/xmlns_namespaces"),m=i("../plots/cartesian/select").clearSelect,y=i("./plot_config").dfltConfig,v=i("./manage_arrays"),T=i("./helpers"),_=i("./subroutines"),k=i("./edit_types"),E=i("../plots/cartesian/constants").AX_NAME_PATTERN,A=0;function b(fe){var ge=fe._fullLayout;ge._redrawFromAutoMarginCount?ge._redrawFromAutoMarginCount--:fe.emit("plotly_afterplot")}function L(fe,ge){try{fe._fullLayout._paper.style("background",ge)}catch(ke){u.error(ke)}}function w(fe,ge){L(fe,f.combine(ge,"white"))}function C(fe,ge){if(!fe._context){fe._context=u.extendDeep({},y);var ke=t.select("base");fe._context._baseUrl=ke.size()&&ke.attr("href")?window.location.href.split("#")[0]:""}var Me,Se,De,Be=fe._context;if(ge){for(Se=Object.keys(ge),Me=0;Me<Se.length;Me++)(De=Se[Me])!=="editable"&&De!=="edits"&&De in Be&&(De==="setBackground"&&ge[De]==="opaque"?Be[De]=w:Be[De]=ge[De]);ge.plot3dPixelRatio&&!Be.plotGlPixelRatio&&(Be.plotGlPixelRatio=Be.plot3dPixelRatio);var We=ge.editable;if(We!==void 0)for(Be.editable=We,Se=Object.keys(Be.edits),Me=0;Me<Se.length;Me++)Be.edits[Se[Me]]=We;if(ge.edits)for(Se=Object.keys(ge.edits),Me=0;Me<Se.length;Me++)(De=Se[Me])in Be.edits&&(Be.edits[De]=ge.edits[De]);Be._exportedPlot=ge._exportedPlot}Be.staticPlot&&(Be.editable=!1,Be.edits={},Be.autosizable=!1,Be.scrollZoom=!1,Be.doubleClick=!1,Be.showTips=!1,Be.showLink=!1,Be.displayModeBar=!1),Be.displayModeBar!=="hover"||p||(Be.displayModeBar=!0),Be.setBackground!=="transparent"&&typeof Be.setBackground=="function"||(Be.setBackground=L),Be._hasZeroHeight=Be._hasZeroHeight||fe.clientHeight===0,Be._hasZeroWidth=Be._hasZeroWidth||fe.clientWidth===0;var Qe=Be.scrollZoom,Oe=Be._scrollZoom={};if(Qe===!0)Oe.cartesian=1,Oe.gl3d=1,Oe.geo=1,Oe.mapbox=1;else if(typeof Qe=="string"){var Ue=Qe.split("+");for(Me=0;Me<Ue.length;Me++)Oe[Ue[Me]]=1}else Qe!==!1&&(Oe.gl3d=1,Oe.geo=1,Oe.mapbox=1)}function S(fe,ge){var ke,Me,Se=ge+1,De=[];for(ke=0;ke<fe.length;ke++)(Me=fe[ke])<0?De.push(Se+Me):De.push(Me);return De}function P(fe,ge,ke){var Me,Se;for(Me=0;Me<ge.length;Me++){if((Se=ge[Me])!==parseInt(Se,10))throw new Error("all values in "+ke+" must be integers");if(Se>=fe.data.length||Se<-fe.data.length)throw new Error(ke+" must be valid indices for gd.data.");if(ge.indexOf(Se,Me+1)>-1||Se>=0&&ge.indexOf(-fe.data.length+Se)>-1||Se<0&&ge.indexOf(fe.data.length+Se)>-1)throw new Error("each index in "+ke+" must be unique.")}}function z(fe,ge,ke){if(!Array.isArray(fe.data))throw new Error("gd.data must be an array.");if(ge===void 0)throw new Error("currentIndices is a required argument.");if(Array.isArray(ge)||(ge=[ge]),P(fe,ge,"currentIndices"),ke===void 0||Array.isArray(ke)||(ke=[ke]),ke!==void 0&&P(fe,ke,"newIndices"),ke!==void 0&&ge.length!==ke.length)throw new Error("current and new indices must be of equal length.")}function F(fe,ge,ke,Me,Se){(function(Ye,$e,it,ot){var Et=u.isPlainObject(ot);if(!Array.isArray(Ye.data))throw new Error("gd.data must be an array");if(!u.isPlainObject($e))throw new Error("update must be a key:value object");if(it===void 0)throw new Error("indices must be an integer or array of integers");for(var mt in P(Ye,it,"indices"),$e){if(!Array.isArray($e[mt])||$e[mt].length!==it.length)throw new Error("attribute "+mt+" must be an array of length equal to indices array length");if(Et&&(!(mt in ot)||!Array.isArray(ot[mt])||ot[mt].length!==$e[mt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}})(fe,ge,ke,Me);for(var De=function(Ye,$e,it,ot){var Et,mt,tt,Ke,Mt,Jt=u.isPlainObject(ot),$t=[];for(var je in Array.isArray(it)||(it=[it]),it=S(it,Ye.data.length-1),$e)for(var Ge=0;Ge<it.length;Ge++){if(Et=Ye.data[it[Ge]],mt=(tt=e(Et,je)).get(),Ke=$e[je][Ge],!u.isArrayOrTypedArray(Ke))throw new Error("attribute: "+je+" index: "+Ge+" must be an array");if(!u.isArrayOrTypedArray(mt))throw new Error("cannot extend missing or non-array attribute: "+je);if(mt.constructor!==Ke.constructor)throw new Error("cannot extend array with an array of a different type: "+je);Mt=Jt?ot[je][Ge]:ot,h(Mt)||(Mt=-1),$t.push({prop:tt,target:mt,insert:Ke,maxp:Math.floor(Mt)})}return $t}(fe,ge,ke,Me),Be={},We={},Qe=0;Qe<De.length;Qe++){var Oe=De[Qe].prop,Ue=De[Qe].maxp,Xe=Se(De[Qe].target,De[Qe].insert,Ue);Oe.set(Xe[0]),Array.isArray(Be[Oe.astr])||(Be[Oe.astr]=[]),Be[Oe.astr].push(Xe[1]),Array.isArray(We[Oe.astr])||(We[Oe.astr]=[]),We[Oe.astr].push(De[Qe].target.length)}return{update:Be,maxPoints:We}}function q(fe,ge){var ke=new fe.constructor(fe.length+ge.length);return ke.set(fe),ke.set(ge,fe.length),ke}function W(fe,ge,ke,Me){fe=u.getGraphDiv(fe),T.clearPromiseQueue(fe);var Se={};if(typeof ge=="string")Se[ge]=ke;else{if(!u.isPlainObject(ge))return u.warn("Restyle fail.",ge,ke,Me),Promise.reject();Se=u.extendFlat({},ge),Me===void 0&&(Me=ke)}Object.keys(Se).length&&(fe.changed=!0);var De=T.coerceTraceIndices(fe,Me),Be=Y(fe,Se,De),We=Be.flags;We.calc&&(fe.calcdata=void 0),We.clearAxisTypes&&T.clearAxisTypes(fe,De,{});var Qe=[];We.fullReplot?Qe.push(V._doPlot):(Qe.push(s.previousPromises),s.supplyDefaults(fe),We.markerSize&&(s.doCalcdata(fe),U(Qe)),We.style&&Qe.push(_.doTraceStyle),We.colorbars&&Qe.push(_.doColorBars),Qe.push(b)),Qe.push(s.rehover,s.redrag),o.add(fe,W,[fe,Be.undoit,Be.traces],W,[fe,Be.redoit,Be.traces]);var Oe=u.syncOrAsync(Qe,fe);return Oe&&Oe.then||(Oe=Promise.resolve()),Oe.then(function(){return fe.emit("plotly_restyle",Be.eventData),fe})}function X(fe){return fe===void 0?null:fe}function Q(fe,ge){return ge?function(ke,Me,Se){var De=e(ke,Me),Be=De.set;return De.set=function(We){Z((Se||"")+Me,De.get(),We,fe),Be(We)},De}:e}function Z(fe,ge,ke,Me){if(Array.isArray(ge)||Array.isArray(ke))for(var Se=Array.isArray(ge)?ge:[],De=Array.isArray(ke)?ke:[],Be=Math.max(Se.length,De.length),We=0;We<Be;We++)Z(fe+"["+We+"]",Se[We],De[We],Me);else if(u.isPlainObject(ge)||u.isPlainObject(ke)){var Qe=u.isPlainObject(ge)?ge:{},Oe=u.isPlainObject(ke)?ke:{},Ue=u.extendFlat({},Qe,Oe);for(var Xe in Ue)Z(fe+"."+Xe,Qe[Xe],Oe[Xe],Me)}else Me[fe]===void 0&&(Me[fe]=X(ge))}function Y(fe,ge,ke){var Me,Se=fe._fullLayout,De=fe._fullData,Be=fe.data,We=Se._guiEditing,Qe=Q(Se._preGUI,We),Oe=u.extendDeepAll({},ge);N(ge);var Ue,Xe=k.traceFlags(),Ye={},$e={};function it(){return ke.map(function(){})}function ot(At){var Bt=r.id2name(At);Ue.indexOf(Bt)===-1&&Ue.push(Bt)}function Et(At){return"LAYOUT"+At+".autorange"}function mt(At){return"LAYOUT"+At+".range"}function tt(At){for(var Bt=At;Bt<De.length;Bt++)if(De[Bt]._input===Be[At])return De[Bt]}function Ke(At,Bt,Ht){if(Array.isArray(At))At.forEach(function(Nt){Ke(Nt,Bt,Ht)});else if(!(At in ge)&&!T.hasParent(ge,At)){var or;if(At.substr(0,6)==="LAYOUT")or=Qe(fe.layout,At.replace("LAYOUT",""));else{var ar=ke[Ht];or=Q(Se._tracePreGUI[tt(ar)._fullInput.uid],We)(Be[ar],At)}At in $e||($e[At]=it()),$e[At][Ht]===void 0&&($e[At][Ht]=X(or.get())),Bt!==void 0&&or.set(Bt)}}function Mt(At){return function(Bt){return De[Bt][At]}}function Jt(At){return function(Bt,Ht){return Bt===!1?De[ke[Ht]][At]:null}}for(var $t in ge){if(T.hasParent(ge,$t))throw new Error("cannot set "+$t+" and a parent attribute simultaneously");var je,Ge,Ct,Ie,be,Ae,Pe=ge[$t];if($t!=="autobinx"&&$t!=="autobiny"||($t=$t.charAt($t.length-1)+"bins",Pe=Array.isArray(Pe)?Pe.map(Jt($t)):Pe===!1?ke.map(Mt($t)):null),Ye[$t]=Pe,$t.substr(0,6)!=="LAYOUT"){for($e[$t]=it(),Me=0;Me<ke.length;Me++)if(je=Be[ke[Me]],Ge=tt(ke[Me]),Ie=(Ct=Q(Se._tracePreGUI[Ge._fullInput.uid],We)(je,$t)).get(),(be=Array.isArray(Pe)?Pe[Me%Pe.length]:Pe)!==void 0){var ze=Ct.parts[Ct.parts.length-1],qe=$t.substr(0,$t.length-ze.length-1),ht=qe?qe+".":"",at=qe?e(Ge,qe).get():Ge;if((Ae=n.getTraceValObject(Ge,Ct.parts))&&Ae.impliedEdits&&be!==null)for(var nt in Ae.impliedEdits)Ke(u.relativeAttr($t,nt),Ae.impliedEdits[nt],Me);else if(ze!=="thicknessmode"&&ze!=="lenmode"||Ie===be||be!=="fraction"&&be!=="pixels"||!at){if($t==="type"&&(be==="pie"!=(Ie==="pie")||be==="funnelarea"!=(Ie==="funnelarea"))){var xt="x",Lt="y";be!=="bar"&&Ie!=="bar"||je.orientation!=="h"||(xt="y",Lt="x"),u.swapAttrs(je,["?","?src"],"labels",xt),u.swapAttrs(je,["d?","?0"],"label",xt),u.swapAttrs(je,["?","?src"],"values",Lt),Ie==="pie"||Ie==="funnelarea"?(e(je,"marker.color").set(e(je,"marker.colors").get()),Se._pielayer.selectAll("g.trace").remove()):a.traceIs(je,"cartesian")&&e(je,"marker.colors").set(e(je,"marker.color").get())}}else{var bt=Se._size,St=at.orient,st=St==="top"||St==="bottom";if(ze==="thicknessmode"){var It=st?bt.h:bt.w;Ke(ht+"thickness",at.thickness*(be==="fraction"?1/It:It),Me)}else{var jt=st?bt.w:bt.h;Ke(ht+"len",at.len*(be==="fraction"?1/jt:jt),Me)}}if($e[$t][Me]=X(Ie),["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf($t)!==-1){if($t==="orientation"){Ct.set(be);var Ut=je.x&&!je.y?"h":"v";if((Ct.get()||Ut)===Ge.orientation)continue}else $t==="orientationaxes"&&(je.orientation={v:"h",h:"v"}[Ge.orientation]);T.swapXYData(je),Xe.calc=Xe.clearAxisTypes=!0}else s.dataArrayContainers.indexOf(Ct.parts[0])!==-1?(T.manageArrayContainers(Ct,be,$e),Xe.calc=!0):(Ae?Ae.arrayOk&&!a.traceIs(Ge,"regl")&&(u.isArrayOrTypedArray(be)||u.isArrayOrTypedArray(Ie))?Xe.calc=!0:k.update(Xe,Ae):Xe.calc=!0,Ct.set(be))}if(["swapxyaxes","orientationaxes"].indexOf($t)!==-1&&r.swap(fe,ke),$t==="orientationaxes"){var zt=e(fe.layout,"hovermode"),Ce=zt.get();Ce==="x"?zt.set("y"):Ce==="y"?zt.set("x"):Ce==="x unified"?zt.set("y unified"):Ce==="y unified"&&zt.set("x unified")}if(["orientation","type"].indexOf($t)!==-1){for(Ue=[],Me=0;Me<ke.length;Me++){var lt=Be[ke[Me]];a.traceIs(lt,"cartesian")&&(ot(lt.xaxis||"x"),ot(lt.yaxis||"y"))}Ke(Ue.map(Et),!0,0),Ke(Ue.map(mt),[0,1],0)}}else Ct=Qe(fe.layout,$t.replace("LAYOUT","")),$e[$t]=[X(Ct.get())],Ct.set(Array.isArray(Pe)?Pe[0]:Pe),Xe.calc=!0}return(Xe.calc||Xe.plot)&&(Xe.fullReplot=!0),{flags:Xe,undoit:$e,redoit:Ye,traces:ke,eventData:u.extendDeepNoArrays([],[Oe,ke])}}function N(fe){var ge,ke,Me,Se=u.counterRegex("axis",".title",!1,!1),De=/colorbar\.title$/,Be=Object.keys(fe);for(ge=0;ge<Be.length;ge++)ke=Be[ge],Me=fe[ke],ke!=="title"&&!Se.test(ke)&&!De.test(ke)||typeof Me!="string"&&typeof Me!="number"?ke.indexOf("titlefont")>-1?We(ke,ke.replace("titlefont","title.font")):ke.indexOf("titleposition")>-1?We(ke,ke.replace("titleposition","title.position")):ke.indexOf("titleside")>-1?We(ke,ke.replace("titleside","title.side")):ke.indexOf("titleoffset")>-1&&We(ke,ke.replace("titleoffset","title.offset")):We(ke,ke.replace("title","title.text"));function We(Qe,Oe){fe[Oe]=fe[Qe],delete fe[Qe]}}function J(fe,ge,ke){fe=u.getGraphDiv(fe),T.clearPromiseQueue(fe);var Me={};if(typeof ge=="string")Me[ge]=ke;else{if(!u.isPlainObject(ge))return u.warn("Relayout fail.",ge,ke),Promise.reject();Me=u.extendFlat({},ge)}Object.keys(Me).length&&(fe.changed=!0);var Se=re(fe,Me),De=Se.flags;De.calc&&(fe.calcdata=void 0);var Be=[s.previousPromises];De.layoutReplot?Be.push(_.layoutReplot):Object.keys(Me).length&&(D(fe,De,Se)||s.supplyDefaults(fe),De.legend&&Be.push(_.doLegend),De.layoutstyle&&Be.push(_.layoutStyles),De.axrange&&U(Be,Se.rangesAltered),De.ticks&&Be.push(_.doTicksRelayout),De.modebar&&Be.push(_.doModeBar),De.camera&&Be.push(_.doCamera),De.colorbars&&Be.push(_.doColorBars),Be.push(b)),Be.push(s.rehover,s.redrag),o.add(fe,J,[fe,Se.undoit],J,[fe,Se.redoit]);var We=u.syncOrAsync(Be,fe);return We&&We.then||(We=Promise.resolve(fe)),We.then(function(){return fe.emit("plotly_relayout",Se.eventData),fe})}function D(fe,ge,ke){var Me=fe._fullLayout;if(!ge.axrange)return!1;for(var Se in ge)if(Se!=="axrange"&&ge[Se])return!1;for(var De in ke.rangesAltered){var Be=r.id2name(De),We=fe.layout[Be],Qe=Me[Be];if(Qe.autorange=We.autorange,We.range&&(Qe.range=We.range.slice()),Qe.cleanRange(),Qe._matchGroup){for(var Oe in Qe._matchGroup)if(Oe!==De){var Ue=Me[r.id2name(Oe)];Ue.autorange=Qe.autorange,Ue.range=Qe.range.slice(),Ue._input.range=Qe.range.slice()}}}return!0}function U(fe,ge){var ke=ge?function(Me){var Se=[],De=!0;for(var Be in ge){var We=r.getFromId(Me,Be);if(Se.push(Be),(We.ticklabelposition||"").indexOf("inside")!==-1&&We._anchorAxis&&Se.push(We._anchorAxis._id),We._matchGroup)for(var Qe in We._matchGroup)ge[Qe]||Se.push(Qe);We.automargin&&(De=!1)}return r.draw(Me,Se,{skipTitle:De})}:function(Me){return r.draw(Me,"redraw")};fe.push(m,_.doAutoRangeAndConstraints,ke,_.drawData,_.finalDraw)}var G=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,$=/^[xyz]axis[0-9]*\.autorange$/,K=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function re(fe,ge){var ke,Me,Se,De=fe.layout,Be=fe._fullLayout,We=Be._guiEditing,Qe=Q(Be._preGUI,We),Oe=Object.keys(ge),Ue=r.list(fe),Xe=u.extendDeepAll({},ge),Ye={};for(N(ge),Oe=Object.keys(ge),Me=0;Me<Oe.length;Me++)if(Oe[Me].indexOf("allaxes")===0){for(Se=0;Se<Ue.length;Se++){var $e=Ue[Se]._id.substr(1),it=$e.indexOf("scene")!==-1?$e+".":"",ot=Oe[Me].replace("allaxes",it+Ue[Se]._name);ge[ot]||(ge[ot]=ge[Oe[Me]])}delete ge[Oe[Me]]}var Et=k.layoutFlags(),mt={},tt={};function Ke(ar,Nt){if(Array.isArray(ar))ar.forEach(function(Lr){Ke(Lr,Nt)});else if(!(ar in ge)&&!T.hasParent(ge,ar)){var nr=Qe(De,ar);ar in tt||(tt[ar]=X(nr.get())),Nt!==void 0&&nr.set(Nt)}}var Mt,Jt={};function $t(ar){var Nt=r.name2id(ar.split(".")[0]);return Jt[Nt]=1,Nt}for(var je in ge){if(T.hasParent(ge,je))throw new Error("cannot set "+je+" and a parent attribute simultaneously");for(var Ge=Qe(De,je),Ct=ge[je],Ie=Ge.parts.length-1;Ie>0&&typeof Ge.parts[Ie]!="string";)Ie--;var be=Ge.parts[Ie],Ae=Ge.parts[Ie-1]+"."+be,Pe=Ge.parts.slice(0,Ie).join("."),ze=e(fe.layout,Pe).get(),qe=e(Be,Pe).get(),ht=Ge.get();if(Ct!==void 0){mt[je]=Ct,tt[je]=be==="reverse"?Ct:X(ht);var at=n.getLayoutValObject(Be,Ge.parts);if(at&&at.impliedEdits&&Ct!==null)for(var nt in at.impliedEdits)Ke(u.relativeAttr(je,nt),at.impliedEdits[nt]);if(["width","height"].indexOf(je)!==-1)if(Ct){Ke("autosize",null);var xt=je==="height"?"width":"height";Ke(xt,Be[xt])}else Be[je]=fe._initialAutoSize[je];else if(je==="autosize")Ke("width",Ct?null:Be.width),Ke("height",Ct?null:Be.height);else if(Ae.match(G))$t(Ae),e(Be,Pe+"._inputRange").set(null);else if(Ae.match($)){$t(Ae),e(Be,Pe+"._inputRange").set(null);var Lt=e(Be,Pe).get();Lt._inputDomain&&(Lt._input.domain=Lt._inputDomain.slice())}else Ae.match(K)&&e(Be,Pe+"._inputDomain").set(null);if(be==="type"){Mt=ze;var bt=qe.type==="linear"&&Ct==="log",St=qe.type==="log"&&Ct==="linear";if(bt||St){if(Mt&&Mt.range)if(qe.autorange)bt&&(Mt.range=Mt.range[1]>Mt.range[0]?[1,2]:[2,1]);else{var st=Mt.range[0],It=Mt.range[1];bt?(st<=0&&It<=0&&Ke(Pe+".autorange",!0),st<=0?st=It/1e6:It<=0&&(It=st/1e6),Ke(Pe+".range[0]",Math.log(st)/Math.LN10),Ke(Pe+".range[1]",Math.log(It)/Math.LN10)):(Ke(Pe+".range[0]",Math.pow(10,st)),Ke(Pe+".range[1]",Math.pow(10,It)))}else Ke(Pe+".autorange",!0);Array.isArray(Be._subplots.polar)&&Be._subplots.polar.length&&Be[Ge.parts[0]]&&Ge.parts[1]==="radialaxis"&&delete Be[Ge.parts[0]]._subplot.viewInitial["radialaxis.range"],a.getComponentMethod("annotations","convertCoords")(fe,qe,Ct,Ke),a.getComponentMethod("images","convertCoords")(fe,qe,Ct,Ke)}else Ke(Pe+".autorange",!0),Ke(Pe+".range",null);e(Be,Pe+"._inputRange").set(null)}else if(be.match(E)){var jt=e(Be,je).get(),Ut=(Ct||{}).type;Ut&&Ut!=="-"||(Ut="linear"),a.getComponentMethod("annotations","convertCoords")(fe,jt,Ut,Ke),a.getComponentMethod("images","convertCoords")(fe,jt,Ut,Ke)}var zt=v.containerArrayMatch(je);if(zt){ke=zt.array,Me=zt.index;var Ce=zt.property,lt=at||{editType:"calc"};Me!==""&&Ce===""&&(v.isAddVal(Ct)?tt[je]=null:v.isRemoveVal(Ct)?tt[je]=(e(De,ke).get()||[])[Me]:u.warn("unrecognized full object value",ge)),k.update(Et,lt),Ye[ke]||(Ye[ke]={});var At=Ye[ke][Me];At||(At=Ye[ke][Me]={}),At[Ce]=Ct,delete ge[je]}else be==="reverse"?(ze.range?ze.range.reverse():(Ke(Pe+".autorange",!0),ze.range=[1,0]),qe.autorange?Et.calc=!0:Et.plot=!0):(Be._has("scatter-like")&&Be._has("regl")&&je==="dragmode"&&(Ct==="lasso"||Ct==="select")&&ht!=="lasso"&&ht!=="select"||Be._has("gl2d")?Et.plot=!0:at?k.update(Et,at):Et.calc=!0,Ge.set(Ct))}}for(ke in Ye)v.applyContainerArrayChanges(fe,Qe(De,ke),Ye[ke],Et,Qe)||(Et.plot=!0);for(var Bt in Jt){var Ht=(Mt=r.getFromId(fe,Bt))&&Mt._constraintGroup;if(Ht)for(var or in Et.calc=!0,Ht)Jt[or]||(r.getFromId(fe,or)._constraintShrinkable=!0)}return(ne(fe)||ge.height||ge.width)&&(Et.plot=!0),(Et.plot||Et.calc)&&(Et.layoutReplot=!0),{flags:Et,rangesAltered:Jt,undoit:tt,redoit:mt,eventData:Xe}}function ne(fe){var ge=fe._fullLayout,ke=ge.width,Me=ge.height;return fe.layout.autosize&&s.plotAutoSize(fe,fe.layout,ge),ge.width!==ke||ge.height!==Me}function ae(fe,ge,ke,Me){fe=u.getGraphDiv(fe),T.clearPromiseQueue(fe),u.isPlainObject(ge)||(ge={}),u.isPlainObject(ke)||(ke={}),Object.keys(ge).length&&(fe.changed=!0),Object.keys(ke).length&&(fe.changed=!0);var Se=T.coerceTraceIndices(fe,Me),De=Y(fe,u.extendFlat({},ge),Se),Be=De.flags,We=re(fe,u.extendFlat({},ke)),Qe=We.flags;(Be.calc||Qe.calc)&&(fe.calcdata=void 0),Be.clearAxisTypes&&T.clearAxisTypes(fe,Se,ke);var Oe=[];Qe.layoutReplot?Oe.push(_.layoutReplot):Be.fullReplot?Oe.push(V._doPlot):(Oe.push(s.previousPromises),D(fe,Qe,We)||s.supplyDefaults(fe),Be.style&&Oe.push(_.doTraceStyle),(Be.colorbars||Qe.colorbars)&&Oe.push(_.doColorBars),Qe.legend&&Oe.push(_.doLegend),Qe.layoutstyle&&Oe.push(_.layoutStyles),Qe.axrange&&U(Oe,We.rangesAltered),Qe.ticks&&Oe.push(_.doTicksRelayout),Qe.modebar&&Oe.push(_.doModeBar),Qe.camera&&Oe.push(_.doCamera),Oe.push(b)),Oe.push(s.rehover,s.redrag),o.add(fe,ae,[fe,De.undoit,We.undoit,De.traces],ae,[fe,De.redoit,We.redoit,De.traces]);var Ue=u.syncOrAsync(Oe,fe);return Ue&&Ue.then||(Ue=Promise.resolve(fe)),Ue.then(function(){return fe.emit("plotly_update",{data:De.eventData,layout:We.eventData}),fe})}function ie(fe){return function(ge){ge._fullLayout._guiEditing=!0;var ke=fe.apply(null,arguments);return ge._fullLayout._guiEditing=!1,ke}}var he=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],se=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function de(fe,ge){for(var ke=0;ke<ge.length;ke++){var Me=ge[ke],Se=fe.match(Me.pattern);if(Se)return{head:Se[1],attr:Me.attr}}}function ce(fe,ge){var ke=e(ge,fe).get();if(ke!==void 0)return ke;var Me=fe.split(".");for(Me.pop();Me.length>1;)if(Me.pop(),(ke=e(ge,Me.join(".")+".uirevision").get())!==void 0)return ke;return ge.uirevision}function ve(fe,ge){for(var ke=0;ke<ge.length;ke++)if(ge[ke]._fullInput.uid===fe)return ke;return-1}function Ee(fe,ge,ke){for(var Me=0;Me<ge.length;Me++)if(ge[Me].uid===fe)return Me;return!ge[ke]||ge[ke].uid?-1:ke}function Le(fe,ge){var ke=u.isPlainObject(fe),Me=Array.isArray(fe);return ke||Me?(ke&&u.isPlainObject(ge)||Me&&Array.isArray(ge))&&JSON.stringify(fe)===JSON.stringify(ge):fe===ge}function Te(fe,ge,ke,Me){var Se,De,Be,We=Me.getValObject,Qe=Me.flags,Oe=Me.immutable,Ue=Me.inArray,Xe=Me.arrayIndex;function Ye(){var ze=Se.editType;Ue&&ze.indexOf("arraydraw")!==-1?u.pushUnique(Qe.arrays[Ue],Xe):(k.update(Qe,Se),ze!=="none"&&Qe.nChanges++,Me.transition&&Se.anim&&Qe.nChangesAnim++,(G.test(Be)||$.test(Be))&&(Qe.rangesAltered[ke[0]]=1),K.test(Be)&&e(ge,"_inputDomain").set(null),De==="datarevision"&&(Qe.newDataRevision=1))}function $e(ze){return ze.valType==="data_array"||ze.arrayOk}for(De in fe){if(Qe.calc&&!Me.transition)return;var it=fe[De],ot=ge[De],Et=ke.concat(De);if(Be=Et.join("."),De.charAt(0)!=="_"&&typeof it!="function"&&it!==ot){if((De==="tick0"||De==="dtick")&&ke[0]!=="geo"){var mt=ge.tickmode;if(mt==="auto"||mt==="array"||!mt)continue}if((De!=="range"||!ge.autorange)&&(De!=="zmin"&&De!=="zmax"||ge.type!=="contourcarpet")&&(Se=We(Et))&&(!Se._compareAsJSON||JSON.stringify(it)!==JSON.stringify(ot))){var tt,Ke=Se.valType,Mt=$e(Se),Jt=Array.isArray(it),$t=Array.isArray(ot);if(Jt&&$t){var je="_input_"+De,Ge=fe[je],Ct=ge[je];if(Array.isArray(Ge)&&Ge===Ct)continue}if(ot===void 0)Mt&&Jt?Qe.calc=!0:Ye();else if(Se._isLinkedToArray){var Ie=[],be=!1;Ue||(Qe.arrays[De]=Ie);var Ae=Math.min(it.length,ot.length),Pe=Math.max(it.length,ot.length);if(Ae!==Pe){if(Se.editType!=="arraydraw"){Ye();continue}be=!0}for(tt=0;tt<Ae;tt++)Te(it[tt],ot[tt],Et.concat(tt),u.extendFlat({inArray:De,arrayIndex:tt},Me));if(be)for(tt=Ae;tt<Pe;tt++)Ie.push(tt)}else!Ke&&u.isPlainObject(it)?Te(it,ot,Et,Me):Mt?Jt&&$t?(Oe&&(Qe.calc=!0),(Oe||Me.newDataRevision)&&Ye()):Jt!==$t?Qe.calc=!0:Ye():Jt&&$t&&it.length===ot.length&&String(it)===String(ot)||Ye()}}}for(De in ge)if(!(De in fe)&&De.charAt(0)!=="_"&&typeof ge[De]!="function"){if($e(Se=We(ke.concat(De)))&&Array.isArray(ge[De]))return void(Qe.calc=!0);Ye()}}function xe(fe){var ge=fe._fullLayout,ke=fe.getBoundingClientRect();if(!u.equalDomRects(ke,ge._lastBBox)){var Me=ge._invTransform=u.inverseTransformMatrix(u.getFullTransformMatrix(fe));ge._invScaleX=Math.sqrt(Me[0][0]*Me[0][0]+Me[0][1]*Me[0][1]+Me[0][2]*Me[0][2]),ge._invScaleY=Math.sqrt(Me[1][0]*Me[1][0]+Me[1][1]*Me[1][1]+Me[1][2]*Me[1][2]),ge._lastBBox=ke}}V.animate=function(fe,ge,ke){if(fe=u.getGraphDiv(fe),!u.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Me=fe._transitionData;Me._frameQueue||(Me._frameQueue=[]);var Se=(ke=s.supplyAnimationDefaults(ke)).transition,De=ke.frame;function Be(Oe){return Array.isArray(Se)?Oe>=Se.length?Se[0]:Se[Oe]:Se}function We(Oe){return Array.isArray(De)?Oe>=De.length?De[0]:De[Oe]:De}function Qe(Oe,Ue){var Xe=0;return function(){if(Oe&&++Xe===Ue)return Oe()}}return Me._frameWaitingCnt===void 0&&(Me._frameWaitingCnt=0),new Promise(function(Oe,Ue){function Xe(){Me._currentFrame&&Me._currentFrame.onComplete&&Me._currentFrame.onComplete();var Ge=Me._currentFrame=Me._frameQueue.shift();if(Ge){var Ct=Ge.name?Ge.name.toString():null;fe._fullLayout._currentFrame=Ct,Me._lastFrameAt=Date.now(),Me._timeToNext=Ge.frameOpts.duration,s.transition(fe,Ge.frame.data,Ge.frame.layout,T.coerceTraceIndices(fe,Ge.frame.traces),Ge.frameOpts,Ge.transitionOpts).then(function(){Ge.onComplete&&Ge.onComplete()}),fe.emit("plotly_animatingframe",{name:Ct,frame:Ge.frame,animation:{frame:Ge.frameOpts,transition:Ge.transitionOpts}})}else fe.emit("plotly_animated"),window.cancelAnimationFrame(Me._animationRaf),Me._animationRaf=null}function Ye(){fe.emit("plotly_animating"),Me._lastFrameAt=-1/0,Me._timeToNext=0,Me._runningTransitions=0,Me._currentFrame=null;var Ge=function(){Me._animationRaf=window.requestAnimationFrame(Ge),Date.now()-Me._lastFrameAt>Me._timeToNext&&Xe()};Ge()}var $e,it,ot=0;function Et(Ge){return Array.isArray(Se)?ot>=Se.length?Ge.transitionOpts=Se[ot]:Ge.transitionOpts=Se[0]:Ge.transitionOpts=Se,ot++,Ge}var mt=[],tt=ge==null,Ke=Array.isArray(ge);if(!tt&&!Ke&&u.isPlainObject(ge))mt.push({type:"object",data:Et(u.extendFlat({},ge))});else if(tt||["string","number"].indexOf(typeof ge)!==-1)for($e=0;$e<Me._frames.length;$e++)(it=Me._frames[$e])&&(tt||String(it.group)===String(ge))&&mt.push({type:"byname",name:String(it.name),data:Et({name:it.name})});else if(Ke)for($e=0;$e<ge.length;$e++){var Mt=ge[$e];["number","string"].indexOf(typeof Mt)!==-1?(Mt=String(Mt),mt.push({type:"byname",name:Mt,data:Et({name:Mt})})):u.isPlainObject(Mt)&&mt.push({type:"object",data:Et(u.extendFlat({},Mt))})}for($e=0;$e<mt.length;$e++)if((it=mt[$e]).type==="byname"&&!Me._frameHash[it.data.name])return u.warn('animate failure: frame not found: "'+it.data.name+'"'),void Ue();["next","immediate"].indexOf(ke.mode)!==-1&&function(){if(Me._frameQueue.length!==0){for(;Me._frameQueue.length;){var Ge=Me._frameQueue.pop();Ge.onInterrupt&&Ge.onInterrupt()}fe.emit("plotly_animationinterrupted",[])}}(),ke.direction==="reverse"&&mt.reverse();var Jt=fe._fullLayout._currentFrame;if(Jt&&ke.fromcurrent){var $t=-1;for($e=0;$e<mt.length;$e++)if((it=mt[$e]).type==="byname"&&it.name===Jt){$t=$e;break}if($t>0&&$t<mt.length-1){var je=[];for($e=0;$e<mt.length;$e++)it=mt[$e],(mt[$e].type!=="byname"||$e>$t)&&je.push(it);mt=je}}mt.length>0?function(Ge){if(Ge.length!==0){for(var Ct=0;Ct<Ge.length;Ct++){var Ie;Ie=Ge[Ct].type==="byname"?s.computeFrame(fe,Ge[Ct].name):Ge[Ct].data;var be=We(Ct),Ae=Be(Ct);Ae.duration=Math.min(Ae.duration,be.duration);var Pe={frame:Ie,name:Ge[Ct].name,frameOpts:be,transitionOpts:Ae};Ct===Ge.length-1&&(Pe.onComplete=Qe(Oe,2),Pe.onInterrupt=Ue),Me._frameQueue.push(Pe)}ke.mode==="immediate"&&(Me._lastFrameAt=-1/0),Me._animationRaf||Ye()}}(mt):(fe.emit("plotly_animated"),Oe())})},V.addFrames=function(fe,ge,ke){if(fe=u.getGraphDiv(fe),ge==null)return Promise.resolve();if(!u.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Me,Se,De,Be,We=fe._transitionData._frames,Qe=fe._transitionData._frameHash;if(!Array.isArray(ge))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+ge);var Oe=We.length+2*ge.length,Ue=[],Xe={};for(Me=ge.length-1;Me>=0;Me--)if(u.isPlainObject(ge[Me])){var Ye=ge[Me].name,$e=(Qe[Ye]||Xe[Ye]||{}).name,it=ge[Me].name,ot=Qe[$e]||Xe[$e];$e&&it&&typeof it=="number"&&ot&&A<5&&(A++,u.warn('addFrames: overwriting frame "'+(Qe[$e]||Xe[$e]).name+'" with a frame whose name of type "number" also equates to "'+$e+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),A===5&&u.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Xe[Ye]={name:Ye},Ue.push({frame:s.supplyFrameDefaults(ge[Me]),index:ke&&ke[Me]!==void 0&&ke[Me]!==null?ke[Me]:Oe+Me})}Ue.sort(function(je,Ge){return je.index>Ge.index?-1:je.index<Ge.index?1:0});var Et=[],mt=[],tt=We.length;for(Me=Ue.length-1;Me>=0;Me--){if(typeof(Se=Ue[Me].frame).name=="number"&&u.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Se.name)for(;Qe[Se.name="frame "+fe._transitionData._counter++];);if(Qe[Se.name]){for(De=0;De<We.length&&(We[De]||{}).name!==Se.name;De++);Et.push({type:"replace",index:De,value:Se}),mt.unshift({type:"replace",index:De,value:We[De]})}else Be=Math.max(0,Math.min(Ue[Me].index,tt)),Et.push({type:"insert",index:Be,value:Se}),mt.unshift({type:"delete",index:Be}),tt++}var Ke=s.modifyFrames,Mt=s.modifyFrames,Jt=[fe,mt],$t=[fe,Et];return o&&o.add(fe,Ke,Jt,Mt,$t),s.modifyFrames(fe,Et)},V.deleteFrames=function(fe,ge){if(fe=u.getGraphDiv(fe),!u.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe);var ke,Me,Se=fe._transitionData._frames,De=[],Be=[];if(!ge)for(ge=[],ke=0;ke<Se.length;ke++)ge.push(ke);for((ge=ge.slice()).sort(),ke=ge.length-1;ke>=0;ke--)Me=ge[ke],De.push({type:"delete",index:Me}),Be.unshift({type:"insert",index:Me,value:Se[Me]});var We=s.modifyFrames,Qe=s.modifyFrames,Oe=[fe,Be],Ue=[fe,De];return o&&o.add(fe,We,Oe,Qe,Ue),s.modifyFrames(fe,De)},V.addTraces=function fe(ge,ke,Me){ge=u.getGraphDiv(ge);var Se,De,Be=[],We=V.deleteTraces,Qe=fe,Oe=[ge,Be],Ue=[ge,ke];for(function(Xe,Ye,$e){var it,ot;if(!Array.isArray(Xe.data))throw new Error("gd.data must be an array.");if(Ye===void 0)throw new Error("traces must be defined.");for(Array.isArray(Ye)||(Ye=[Ye]),it=0;it<Ye.length;it++)if(typeof(ot=Ye[it])!="object"||Array.isArray(ot)||ot===null)throw new Error("all values in traces array must be non-array objects");if($e===void 0||Array.isArray($e)||($e=[$e]),$e!==void 0&&$e.length!==Ye.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(ge,ke,Me),Array.isArray(ke)||(ke=[ke]),ke=ke.map(function(Xe){return u.extendFlat({},Xe)}),T.cleanData(ke),Se=0;Se<ke.length;Se++)ge.data.push(ke[Se]);for(Se=0;Se<ke.length;Se++)Be.push(-ke.length+Se);if(Me===void 0)return De=V.redraw(ge),o.add(ge,We,Oe,Qe,Ue),De;Array.isArray(Me)||(Me=[Me]);try{z(ge,Be,Me)}catch(Xe){throw ge.data.splice(ge.data.length-ke.length,ke.length),Xe}return o.startSequence(ge),o.add(ge,We,Oe,Qe,Ue),De=V.moveTraces(ge,Be,Me),o.stopSequence(ge),De},V.deleteTraces=function fe(ge,ke){ge=u.getGraphDiv(ge);var Me,Se,De=[],Be=V.addTraces,We=fe,Qe=[ge,De,ke],Oe=[ge,ke];if(ke===void 0)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(ke)||(ke=[ke]),P(ge,ke,"indices"),(ke=S(ke,ge.data.length-1)).sort(u.sorterDes),Me=0;Me<ke.length;Me+=1)Se=ge.data.splice(ke[Me],1)[0],De.push(Se);var Ue=V.redraw(ge);return o.add(ge,Be,Qe,We,Oe),Ue},V.extendTraces=function fe(ge,ke,Me,Se){function De(Oe,Ue,Xe){var Ye,$e;if(u.isTypedArray(Oe))if(Xe<0){var it=new Oe.constructor(0),ot=q(Oe,Ue);Xe<0?(Ye=ot,$e=it):(Ye=it,$e=ot)}else if(Ye=new Oe.constructor(Xe),$e=new Oe.constructor(Oe.length+Ue.length-Xe),Xe===Ue.length)Ye.set(Ue),$e.set(Oe);else if(Xe<Ue.length){var Et=Ue.length-Xe;Ye.set(Ue.subarray(Et)),$e.set(Oe),$e.set(Ue.subarray(0,Et),Oe.length)}else{var mt=Xe-Ue.length,tt=Oe.length-mt;Ye.set(Oe.subarray(tt)),Ye.set(Ue,mt),$e.set(Oe.subarray(0,tt))}else Ye=Oe.concat(Ue),$e=Xe>=0&&Xe<Ye.length?Ye.splice(0,Ye.length-Xe):[];return[Ye,$e]}var Be=F(ge=u.getGraphDiv(ge),ke,Me,Se,De),We=V.redraw(ge),Qe=[ge,Be.update,Me,Be.maxPoints];return o.add(ge,V.prependTraces,Qe,fe,arguments),We},V.moveTraces=function fe(ge,ke,Me){var Se,De=[],Be=[],We=fe,Qe=fe,Oe=[ge=u.getGraphDiv(ge),Me,ke],Ue=[ge,ke,Me];if(z(ge,ke,Me),ke=Array.isArray(ke)?ke:[ke],Me===void 0)for(Me=[],Se=0;Se<ke.length;Se++)Me.push(-ke.length+Se);for(Me=Array.isArray(Me)?Me:[Me],ke=S(ke,ge.data.length-1),Me=S(Me,ge.data.length-1),Se=0;Se<ge.data.length;Se++)ke.indexOf(Se)===-1&&De.push(ge.data[Se]);for(Se=0;Se<ke.length;Se++)Be.push({newIndex:Me[Se],trace:ge.data[ke[Se]]});for(Be.sort(function(Ye,$e){return Ye.newIndex-$e.newIndex}),Se=0;Se<Be.length;Se+=1)De.splice(Be[Se].newIndex,0,Be[Se].trace);ge.data=De;var Xe=V.redraw(ge);return o.add(ge,We,Oe,Qe,Ue),Xe},V.prependTraces=function fe(ge,ke,Me,Se){function De(Oe,Ue,Xe){var Ye,$e;if(u.isTypedArray(Oe))if(Xe<=0){var it=new Oe.constructor(0),ot=q(Ue,Oe);Xe<0?(Ye=ot,$e=it):(Ye=it,$e=ot)}else if(Ye=new Oe.constructor(Xe),$e=new Oe.constructor(Oe.length+Ue.length-Xe),Xe===Ue.length)Ye.set(Ue),$e.set(Oe);else if(Xe<Ue.length){var Et=Ue.length-Xe;Ye.set(Ue.subarray(0,Et)),$e.set(Ue.subarray(Et)),$e.set(Oe,Et)}else{var mt=Xe-Ue.length;Ye.set(Ue),Ye.set(Oe.subarray(0,mt),Ue.length),$e.set(Oe.subarray(mt))}else Ye=Ue.concat(Oe),$e=Xe>=0&&Xe<Ye.length?Ye.splice(Xe,Ye.length):[];return[Ye,$e]}var Be=F(ge=u.getGraphDiv(ge),ke,Me,Se,De),We=V.redraw(ge),Qe=[ge,Be.update,Me,Be.maxPoints];return o.add(ge,V.extendTraces,Qe,fe,arguments),We},V.newPlot=function(fe,ge,ke,Me){return fe=u.getGraphDiv(fe),s.cleanPlot([],{},fe._fullData||[],fe._fullLayout||{}),s.purge(fe),V._doPlot(fe,ge,ke,Me)},V._doPlot=function(fe,ge,ke,Me){var Se;if(fe=u.getGraphDiv(fe),l.init(fe),u.isPlainObject(ge)){var De=ge;ge=De.data,ke=De.layout,Me=De.config,Se=De.frames}if(l.triggerHandler(fe,"plotly_beforeplot",[ge,ke,Me])===!1)return Promise.reject();ge||ke||u.isPlotDiv(fe)||u.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",fe),C(fe,Me),ke||(ke={}),t.select(fe).classed("js-plotly-plot",!0),c.makeTester(),Array.isArray(fe._promises)||(fe._promises=[]);var Be=(fe.data||[]).length===0&&Array.isArray(ge);Array.isArray(ge)&&(T.cleanData(ge),Be?fe.data=ge:fe.data.push.apply(fe.data,ge),fe.empty=!1),fe.layout&&!Be||(fe.layout=T.cleanLayout(ke)),s.supplyDefaults(fe);var We=fe._fullLayout,Qe=We._has("cartesian");We._replotting=!0,(Be||We._shouldCreateBgLayer)&&(function(mt){var tt=t.select(mt),Ke=mt._fullLayout;if(Ke._calcInverseTransform=xe,Ke._calcInverseTransform(mt),Ke._container=tt.selectAll(".plot-container").data([0]),Ke._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Ke._paperdiv=Ke._container.selectAll(".svg-container").data([0]),Ke._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Ke._glcontainer=Ke._paperdiv.selectAll(".gl-container").data([{}]),Ke._glcontainer.enter().append("div").classed("gl-container",!0),Ke._paperdiv.selectAll(".main-svg").remove(),Ke._paperdiv.select(".modebar-container").remove(),Ke._paper=Ke._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Ke._toppaper=Ke._paperdiv.append("svg").classed("main-svg",!0),Ke._modebardiv=Ke._paperdiv.append("div"),delete Ke._modeBar,Ke._hoverpaper=Ke._paperdiv.append("svg").classed("main-svg",!0),!Ke._uid){var Mt={};t.selectAll("defs").each(function(){this.id&&(Mt[this.id.split("-")[1]]=1)}),Ke._uid=u.randstr(Mt)}Ke._paperdiv.selectAll(".main-svg").attr(g.svgAttrs),Ke._defs=Ke._paper.append("defs").attr("id","defs-"+Ke._uid),Ke._clips=Ke._defs.append("g").classed("clips",!0),Ke._topdefs=Ke._toppaper.append("defs").attr("id","topdefs-"+Ke._uid),Ke._topclips=Ke._topdefs.append("g").classed("clips",!0),Ke._bgLayer=Ke._paper.append("g").classed("bglayer",!0),Ke._draggers=Ke._paper.append("g").classed("draglayer",!0);var Jt=Ke._paper.append("g").classed("layer-below",!0);Ke._imageLowerLayer=Jt.append("g").classed("imagelayer",!0),Ke._shapeLowerLayer=Jt.append("g").classed("shapelayer",!0),Ke._cartesianlayer=Ke._paper.append("g").classed("cartesianlayer",!0),Ke._polarlayer=Ke._paper.append("g").classed("polarlayer",!0),Ke._ternarylayer=Ke._paper.append("g").classed("ternarylayer",!0),Ke._geolayer=Ke._paper.append("g").classed("geolayer",!0),Ke._funnelarealayer=Ke._paper.append("g").classed("funnelarealayer",!0),Ke._pielayer=Ke._paper.append("g").classed("pielayer",!0),Ke._iciclelayer=Ke._paper.append("g").classed("iciclelayer",!0),Ke._treemaplayer=Ke._paper.append("g").classed("treemaplayer",!0),Ke._sunburstlayer=Ke._paper.append("g").classed("sunburstlayer",!0),Ke._indicatorlayer=Ke._toppaper.append("g").classed("indicatorlayer",!0),Ke._glimages=Ke._paper.append("g").classed("glimages",!0);var $t=Ke._toppaper.append("g").classed("layer-above",!0);Ke._imageUpperLayer=$t.append("g").classed("imagelayer",!0),Ke._shapeUpperLayer=$t.append("g").classed("shapelayer",!0),Ke._infolayer=Ke._toppaper.append("g").classed("infolayer",!0),Ke._menulayer=Ke._toppaper.append("g").classed("menulayer",!0),Ke._zoomlayer=Ke._toppaper.append("g").classed("zoomlayer",!0),Ke._hoverlayer=Ke._hoverpaper.append("g").classed("hoverlayer",!0),Ke._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),mt.emit("plotly_framework")}(fe),We._shouldCreateBgLayer&&delete We._shouldCreateBgLayer),c.initGradients(fe),c.initPatterns(fe),Be&&r.saveShowSpikeInitial(fe);var Oe=!fe.calcdata||fe.calcdata.length!==(fe._fullData||[]).length;Oe&&s.doCalcdata(fe);for(var Ue=0;Ue<fe.calcdata.length;Ue++)fe.calcdata[Ue][0].trace=fe._fullData[Ue];fe._context.responsive?fe._responsiveChartHandler||(fe._responsiveChartHandler=function(){u.isHidden(fe)||s.resize(fe)},window.addEventListener("resize",fe._responsiveChartHandler)):u.clearResponsive(fe);var Xe=u.extendFlat({},We._size),Ye=0;function $e(){if(s.clearAutoMarginIds(fe),_.drawMarginPushers(fe),r.allowAutoMargin(fe),We._has("pie"))for(var mt=fe._fullData,tt=0;tt<mt.length;tt++){var Ke=mt[tt];Ke.type==="pie"&&Ke.automargin&&s.allowAutoMargin(fe,"pie."+Ke.uid+".automargin")}return s.doAutoMargin(fe),s.previousPromises(fe)}function it(){fe._transitioning||(_.doAutoRangeAndConstraints(fe),Be&&r.saveRangeInitial(fe),a.getComponentMethod("rangeslider","calcAutorange")(fe))}var ot=[s.previousPromises,function(){if(Se)return V.addFrames(fe,Se)},function mt(){for(var tt=We._basePlotModules,Ke=0;Ke<tt.length;Ke++)tt[Ke].drawFramework&&tt[Ke].drawFramework(fe);!We._glcanvas&&We._has("gl")&&(We._glcanvas=We._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(je){return je.key}),We._glcanvas.enter().append("canvas").attr("class",function(je){return"gl-canvas gl-canvas-"+je.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var Mt=fe._context.plotGlPixelRatio;if(We._glcanvas){We._glcanvas.attr("width",We.width*Mt).attr("height",We.height*Mt).style("width",We.width+"px").style("height",We.height+"px");var Jt=We._glcanvas.data()[0].regl;if(Jt&&(Math.floor(We.width*Mt)!==Jt._gl.drawingBufferWidth||Math.floor(We.height*Mt)!==Jt._gl.drawingBufferHeight)){var $t="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!Ye)return u.log($t+" Clearing graph and plotting again."),s.cleanPlot([],{},fe._fullData,We),s.supplyDefaults(fe),We=fe._fullLayout,s.doCalcdata(fe),Ye++,mt();u.error($t)}}return We.modebar.orientation==="h"?We._modebardiv.style("height",null).style("width","100%"):We._modebardiv.style("width",null).style("height",We.height+"px"),s.previousPromises(fe)},$e,function(){if(s.didMarginChange(Xe,We._size))return u.syncOrAsync([$e,_.layoutStyles],fe)}];Qe&&ot.push(function(){if(Oe)return u.syncOrAsync([a.getComponentMethod("shapes","calcAutorange"),a.getComponentMethod("annotations","calcAutorange"),it],fe);it()}),ot.push(_.layoutStyles),Qe&&ot.push(function(){return r.draw(fe,Be?"":"redraw")},function(mt){mt._fullLayout._insideTickLabelsAutorange&&J(mt,mt._fullLayout._insideTickLabelsAutorange).then(function(){mt._fullLayout._insideTickLabelsAutorange=void 0})}),ot.push(_.drawData,_.finalDraw,d,s.addLinks,s.rehover,s.redrag,s.doAutoMargin,function(mt){mt._fullLayout._insideTickLabelsAutorange&&Be&&r.saveRangeInitial(mt,!0)},s.previousPromises);var Et=u.syncOrAsync(ot,fe);return Et&&Et.then||(Et=Promise.resolve()),Et.then(function(){return b(fe),fe})},V.purge=function(fe){var ge=(fe=u.getGraphDiv(fe))._fullLayout||{},ke=fe._fullData||[];return s.cleanPlot([],{},ke,ge),s.purge(fe),l.purge(fe),ge._container&&ge._container.remove(),delete fe._context,fe},V.react=function(fe,ge,ke,Me){var Se,De;fe=u.getGraphDiv(fe),T.clearPromiseQueue(fe);var Be=fe._fullData,We=fe._fullLayout;if(u.isPlotDiv(fe)&&Be&&We){if(u.isPlainObject(ge)){var Qe=ge;ge=Qe.data,ke=Qe.layout,Me=Qe.config,Se=Qe.frames}var Oe=!1;if(Me){var Ue=u.extendDeep({},fe._context);fe._context=void 0,C(fe,Me),Oe=function Pe(ze,qe){var ht;for(ht in ze)if(ht.charAt(0)!=="_"){var at=ze[ht],nt=qe[ht];if(at!==nt)if(u.isPlainObject(at)&&u.isPlainObject(nt)){if(Pe(at,nt))return!0}else{if(!Array.isArray(at)||!Array.isArray(nt)||at.length!==nt.length)return!0;for(var xt=0;xt<at.length;xt++)if(at[xt]!==nt[xt]&&(!u.isPlainObject(at[xt])||!u.isPlainObject(nt[xt])||Pe(at[xt],nt[xt])))return!0}}}(Ue,fe._context)}fe.data=ge||[],T.cleanData(fe.data),fe.layout=ke||{},T.cleanLayout(fe.layout),function(Pe,ze,qe,ht){var at,nt,xt,Lt,bt,St,st,It,jt=ht._preGUI,Ut=[],zt={};for(at in jt){if(bt=de(at,he)){if(nt=bt.attr||bt.head+".uirevision",(Lt=(xt=e(ht,nt).get())&&ce(nt,ze))&&Lt===xt&&((St=jt[at])===null&&(St=void 0),Le(It=(st=e(ze,at)).get(),St))){It===void 0&&at.substr(at.length-9)==="autorange"&&Ut.push(at.substr(0,at.length-10)),st.set(X(e(ht,at).get()));continue}}else u.warn("unrecognized GUI edit: "+at);delete jt[at],at.substr(at.length-8,6)==="range["&&(zt[at.substr(0,at.length-9)]=1)}for(var Ce=0;Ce<Ut.length;Ce++){var lt=Ut[Ce];if(zt[lt]){var At=e(ze,lt).get();At&&delete At.autorange}}var Bt=ht._tracePreGUI;for(var Ht in Bt){var or,ar=Bt[Ht],Nt=null;for(at in ar){if(!Nt){var nr=ve(Ht,qe);if(nr<0){delete Bt[Ht];break}var Lr=Ee(Ht,Pe,(or=qe[nr]._fullInput).index);if(Lr<0){delete Bt[Ht];break}Nt=Pe[Lr]}if(bt=de(at,se)){if(bt.attr?Lt=(xt=e(ht,bt.attr).get())&&ce(bt.attr,ze):(xt=or.uirevision,(Lt=Nt.uirevision)===void 0&&(Lt=ze.uirevision)),Lt&&Lt===xt&&((St=ar[at])===null&&(St=void 0),Le(It=(st=e(Nt,at)).get(),St))){st.set(X(e(or,at).get()));continue}}else u.warn("unrecognized GUI edit: "+at+" in trace uid "+Ht);delete ar[at]}}}(fe.data,fe.layout,Be,We),s.supplyDefaults(fe,{skipUpdateCalc:!0});var Xe=fe._fullData,Ye=fe._fullLayout,$e=Ye.datarevision===void 0,it=Ye.transition,ot=function(Pe,ze,qe,ht,at){var nt=k.layoutFlags();function xt(Lt){return n.getLayoutValObject(qe,Lt)}return nt.arrays={},nt.rangesAltered={},nt.nChanges=0,nt.nChangesAnim=0,Te(ze,qe,[],{getValObject:xt,flags:nt,immutable:ht,transition:at,gd:Pe}),(nt.plot||nt.calc)&&(nt.layoutReplot=!0),at&&nt.nChanges&&nt.nChangesAnim&&(nt.anim=nt.nChanges===nt.nChangesAnim?"all":"some"),nt}(fe,We,Ye,$e,it),Et=ot.newDataRevision,mt=function(Pe,ze,qe,ht,at,nt){var xt=ze.length===qe.length;if(!at&&!xt)return{fullReplot:!0,calc:!0};var Lt,bt,St=k.traceFlags();St.arrays={},St.nChanges=0,St.nChangesAnim=0;var st={getValObject:function(jt){var Ut=n.getTraceValObject(bt,jt);return!bt._module.animatable&&Ut.anim&&(Ut.anim=!1),Ut},flags:St,immutable:ht,transition:at,newDataRevision:nt,gd:Pe},It={};for(Lt=0;Lt<ze.length;Lt++)if(qe[Lt]){if(bt=qe[Lt]._fullInput,s.hasMakesDataTransform(bt)&&(bt=qe[Lt]),It[bt.uid])continue;It[bt.uid]=1,Te(ze[Lt]._fullInput,bt,[],st)}return(St.calc||St.plot)&&(St.fullReplot=!0),at&&St.nChanges&&St.nChangesAnim&&(St.anim=St.nChanges===St.nChangesAnim&&xt?"all":"some"),St}(fe,Be,Xe,$e,it,Et);if(ne(fe)&&(ot.layoutReplot=!0),mt.calc||ot.calc){fe.calcdata=void 0;for(var tt=Object.getOwnPropertyNames(Ye),Ke=0;Ke<tt.length;Ke++){var Mt=tt[Ke],Jt=Mt.substring(0,5);if(Jt==="xaxis"||Jt==="yaxis"){var $t=Ye[Mt]._emptyCategories;$t&&$t()}}}else s.supplyDefaultsUpdateCalc(fe.calcdata,Xe);var je=[];if(Se&&(fe._transitionData={},s.createTransitionData(fe),je.push(function(){return V.addFrames(fe,Se)})),Ye.transition&&!Oe&&(mt.anim||ot.anim))ot.ticks&&je.push(_.doTicksRelayout),s.doCalcdata(fe),_.doAutoRangeAndConstraints(fe),je.push(function(){return s.transitionFromReact(fe,mt,ot,We)});else if(mt.fullReplot||ot.layoutReplot||Oe)fe._fullLayout._skipDefaults=!0,je.push(V._doPlot);else{for(var Ge in ot.arrays){var Ct=ot.arrays[Ge];if(Ct.length){var Ie=a.getComponentMethod(Ge,"drawOne");if(Ie!==u.noop)for(var be=0;be<Ct.length;be++)Ie(fe,Ct[be]);else{var Ae=a.getComponentMethod(Ge,"draw");if(Ae===u.noop)throw new Error("cannot draw components: "+Ge);Ae(fe)}}}je.push(s.previousPromises),mt.style&&je.push(_.doTraceStyle),(mt.colorbars||ot.colorbars)&&je.push(_.doColorBars),ot.legend&&je.push(_.doLegend),ot.layoutstyle&&je.push(_.layoutStyles),ot.axrange&&U(je),ot.ticks&&je.push(_.doTicksRelayout),ot.modebar&&je.push(_.doModeBar),ot.camera&&je.push(_.doCamera),je.push(b)}je.push(s.rehover,s.redrag),(De=u.syncOrAsync(je,fe))&&De.then||(De=Promise.resolve(fe))}else De=V.newPlot(fe,ge,ke,Me);return De.then(function(){return fe.emit("plotly_react",{data:ge,layout:ke}),fe})},V.redraw=function(fe){if(fe=u.getGraphDiv(fe),!u.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe);return T.cleanData(fe.data),T.cleanLayout(fe.layout),fe.calcdata=void 0,V._doPlot(fe).then(function(){return fe.emit("plotly_redraw"),fe})},V.relayout=J,V.restyle=W,V.setPlotConfig=function(fe){return u.extendFlat(y,fe)},V.update=ae,V._guiRelayout=ie(J),V._guiRestyle=ie(W),V._guiUpdate=ie(ae),V._storeDirectGUIEdit=function(fe,ge,ke){for(var Me in ke)Z(Me,e(fe,Me).get(),ke[Me],ge)}},{"../components/color":666,"../components/drawing":688,"../constants/xmlns_namespaces":780,"../lib":803,"../lib/events":792,"../lib/queue":819,"../plots/cartesian/axes":854,"../plots/cartesian/constants":861,"../plots/cartesian/graph_interact":864,"../plots/cartesian/select":874,"../plots/plots":917,"../registry":931,"./edit_types":836,"./helpers":837,"./manage_arrays":839,"./plot_config":841,"./plot_schema":842,"./subroutines":844,"@plotly/d3":58,"fast-isnumeric":249,"has-hover":443}],841:[function(i,B,V){var t={staticPlot:{valType:"boolean",dflt:!1},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},h={};(function p(u,e){for(var l in u){var o=u[l];o.valType?e[l]=o.dflt:(e[l]||(e[l]={}),p(o,e[l]))}})(t,h),B.exports={configAttributes:t,dfltConfig:h}},{}],842:[function(i,B,V){var t=i("../registry"),h=i("../lib"),p=i("../plots/attributes"),u=i("../plots/layout_attributes"),e=i("../plots/frame_attributes"),l=i("../plots/animation_attributes"),o=i("./plot_config").configAttributes,a=i("./edit_types"),n=h.extendDeepAll,s=h.isPlainObject,r=h.isArrayOrTypedArray,c=h.nestedProperty,f=h.valObjectMeta,d=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function g(E,A,b){if(!E)return!1;if(E._isLinkedToArray){if(m(A[b]))b++;else if(b<A.length)return!1}for(;b<A.length;b++){var L=E[A[b]];if(!s(L)||(E=L,b===A.length-1))break;if(E._isLinkedToArray){if(!m(A[++b]))return!1}else if(E.valType==="info_array"){var w=A[++b];if(!m(w))return!1;var C=E.items;if(Array.isArray(C)){if(w>=C.length)return!1;if(E.dimensions===2){if(b++,A.length===b)return E;var S=A[b];if(!m(S))return!1;E=C[w][S]}else E=C[w]}else E=C}}return E}function m(E){return E===Math.round(E)&&E>=0}function y(){var E,A,b={};for(E in n(b,u),t.subplotsRegistry)if((A=t.subplotsRegistry[E]).layoutAttributes)if(Array.isArray(A.attr))for(var L=0;L<A.attr.length;L++)_(b,A,A.attr[L]);else _(b,A,A.attr==="subplot"?A.name:A.attr);for(E in t.componentsRegistry){var w=(A=t.componentsRegistry[E]).schema;if(w&&(w.subplots||w.layout)){var C=w.subplots;if(C&&C.xaxis&&!C.yaxis)for(var S in C.xaxis)delete b.yaxis[S]}else A.name==="colorscale"?n(b,A.layoutAttributes):A.layoutAttributes&&k(b,A.layoutAttributes,A.name)}return{layoutAttributes:T(b)}}function v(){var E={frames:n({},e)};return T(E),E.frames}function T(E){return function(A){V.crawl(A,function(b,L,w){V.isValObject(b)?b.arrayOk!==!0&&b.valType!=="data_array"||(w[L+"src"]={valType:"string",editType:"none"}):s(b)&&(b.role="object")})}(E),function(A){V.crawl(A,function(b,L,w){if(b){var C=b._isLinkedToArray;C&&(delete b._isLinkedToArray,w[L]={items:{}},w[L].items[C]=b,w[L].role="object")}})}(E),function(A){(function b(L){for(var w in L)if(s(L[w]))b(L[w]);else if(Array.isArray(L[w]))for(var C=0;C<L[w].length;C++)b(L[w][C]);else L[w]instanceof RegExp&&(L[w]=L[w].toString())})(A)}(E),E}function _(E,A,b){var L=c(E,b),w=n({},A.layoutAttributes);w._isSubplotObj=!0,L.set(w)}function k(E,A,b){var L=c(E,b);L.set(n(L.get()||{},A))}V.IS_SUBPLOT_OBJ="_isSubplotObj",V.IS_LINKED_TO_ARRAY="_isLinkedToArray",V.DEPRECATED="_deprecated",V.UNDERSCORE_ATTRS=d,V.get=function(){var E={};t.allTypes.forEach(function(b){E[b]=function(L){var w,C;w=t.modules[L]._module,C=w.basePlotModule;var S={type:null},P=n({},p),z=n({},w.attributes);V.crawl(z,function(W,X,Q,Z,Y){c(P,Y).set(void 0),W===void 0&&c(z,Y).set(void 0)}),n(S,P),t.traceIs(L,"noOpacity")&&delete S.opacity,t.traceIs(L,"showLegend")||(delete S.showlegend,delete S.legendgroup),t.traceIs(L,"noHover")&&(delete S.hoverinfo,delete S.hoverlabel),w.selectPoints||delete S.selectedpoints,n(S,z),C.attributes&&n(S,C.attributes),S.type=L;var F={meta:w.meta||{},categories:w.categories||{},animatable:!!w.animatable,type:L,attributes:T(S)};if(w.layoutAttributes){var q={};n(q,w.layoutAttributes),F.layoutAttributes=T(q)}return w.animatable||V.crawl(F,function(W){V.isValObject(W)&&"anim"in W&&delete W.anim}),F}(b)});var A={};return Object.keys(t.transformsRegistry).forEach(function(b){A[b]=function(L){var w=t.transformsRegistry[L],C=n({},w.attributes);return Object.keys(t.componentsRegistry).forEach(function(S){var P=t.componentsRegistry[S];P.schema&&P.schema.transforms&&P.schema.transforms[L]&&Object.keys(P.schema.transforms[L]).forEach(function(z){k(C,P.schema.transforms[L][z],z)})}),{attributes:T(C)}}(b)}),{defs:{valObjects:f,metaKeys:d.concat(["description","role","editType","impliedEdits"]),editType:{traces:a.traces,layout:a.layout},impliedEdits:{}},traces:E,layout:y(),transforms:A,frames:v(),animation:T(l),config:T(o)}},V.crawl=function(E,A,b,L){var w=b||0;L=L||"",Object.keys(E).forEach(function(C){var S=E[C];if(d.indexOf(C)===-1){var P=(L?L+".":"")+C;A(S,C,E,w,P),V.isValObject(S)||s(S)&&C!=="impliedEdits"&&V.crawl(S,A,w+1,P)}})},V.isValObject=function(E){return E&&E.valType!==void 0},V.findArrayAttributes=function(E){var A,b,L=[],w=[],C=[];function S(W,X,Q,Z){w=w.slice(0,Z).concat([X]),C=C.slice(0,Z).concat([W&&W._isLinkedToArray]),W&&(W.valType==="data_array"||W.arrayOk===!0)&&!(w[Z-1]==="colorbar"&&(X==="ticktext"||X==="tickvals"))&&function Y(N,J,D){var U=N[w[J]],G=D+w[J];if(J===w.length-1)r(U)&&L.push(b+G);else if(C[J]){if(Array.isArray(U))for(var $=0;$<U.length;$++)s(U[$])&&Y(U[$],J+1,G+"["+$+"].")}else s(U)&&Y(U,J+1,G+".")}(A,0,"")}A=E,b="",V.crawl(p,S),E._module&&E._module.attributes&&V.crawl(E._module.attributes,S);var P=E.transforms;if(P)for(var z=0;z<P.length;z++){var F=P[z],q=F._module;q&&(b="transforms["+z+"].",A=F,V.crawl(q.attributes,S))}return L},V.getTraceValObject=function(E,A){var b,L,w=A[0],C=1;if(w==="transforms"){if(A.length===1)return p.transforms;var S=E.transforms;if(!Array.isArray(S)||!S.length)return!1;var P=A[1];if(!m(P)||P>=S.length)return!1;L=(b=(t.transformsRegistry[S[P].type]||{}).attributes)&&b[A[2]],C=3}else{var z=E._module;if(z||(z=(t.modules[E.type||p.type.dflt]||{})._module),!z)return!1;if(!(L=(b=z.attributes)&&b[w])){var F=z.basePlotModule;F&&F.attributes&&(L=F.attributes[w])}L||(L=p[w])}return g(L,A,C)},V.getLayoutValObject=function(E,A){return g(function(b,L){var w,C,S,P,z=b._basePlotModules;if(z){var F;for(w=0;w<z.length;w++){if((S=z[w]).attrRegex&&S.attrRegex.test(L)){if(S.layoutAttrOverrides)return S.layoutAttrOverrides;!F&&S.layoutAttributes&&(F=S.layoutAttributes)}var q=S.baseLayoutAttrOverrides;if(q&&L in q)return q[L]}if(F)return F}var W=b._modules;if(W){for(w=0;w<W.length;w++)if((P=W[w].layoutAttributes)&&L in P)return P[L]}for(C in t.componentsRegistry){if((S=t.componentsRegistry[C]).name==="colorscale"&&L.indexOf("coloraxis")===0)return S.layoutAttributes[L];if(!S.schema&&L===S.name)return S.layoutAttributes}return L in u&&u[L]}(E,A[0]),A,1)}},{"../lib":803,"../plots/animation_attributes":848,"../plots/attributes":850,"../plots/frame_attributes":884,"../plots/layout_attributes":908,"../registry":931,"./edit_types":836,"./plot_config":841}],843:[function(i,B,V){var t=i("../lib"),h=i("../plots/attributes"),p={name:{valType:"string",editType:"none"}};function u(l){return l&&typeof l=="string"}function e(l){var o=l.length-1;return l.charAt(o)!=="s"&&t.warn("bad argument to arrayDefaultKey: "+l),l.substr(0,l.length-1)+"defaults"}p.templateitemname={valType:"string",editType:"calc"},V.templatedArray=function(l,o){return o._isLinkedToArray=l,o.name=p.name,o.templateitemname=p.templateitemname,o},V.traceTemplater=function(l){var o,a,n={};for(o in l)a=l[o],Array.isArray(a)&&a.length&&(n[o]=0);return{newTrace:function(s){var r={type:o=t.coerce(s,{},h,"type"),_template:null};if(o in n){a=l[o];var c=n[o]%a.length;n[o]++,r._template=a[c]}return r}}},V.newContainer=function(l,o,a){var n=l._template,s=n&&(n[o]||a&&n[a]);return t.isPlainObject(s)||(s=null),l[o]={_template:s}},V.arrayTemplater=function(l,o,a){var n=l._template,s=n&&n[e(o)],r=n&&n[o];Array.isArray(r)&&r.length||(r=[]);var c={};return{newItem:function(f){var d={name:f.name,_input:f},g=d.templateitemname=f.templateitemname;if(!u(g))return d._template=s,d;for(var m=0;m<r.length;m++){var y=r[m];if(y.name===g)return c[g]=1,d._template=y,d}return d[a]=f[a]||!1,d._template=!1,d},defaultItems:function(){for(var f=[],d=0;d<r.length;d++){var g=r[d],m=g.name;if(u(m)&&!c[m]){var y={_template:g,name:m,_input:{_templateitemname:m}};y.templateitemname=g.templateitemname,f.push(y),c[m]=1}}return f}}},V.arrayDefaultKey=e,V.arrayEditor=function(l,o,a){var n=(t.nestedProperty(l,o).get()||[]).length,s=a._index,r=s>=n&&(a._input||{})._templateitemname;r&&(s=n);var c,f=o+"["+s+"]";function d(){c={},r&&(c[f]={},c[f].templateitemname=r)}function g(y,v){r?t.nestedProperty(c[f],y).set(v):c[f+"."+y]=v}function m(){var y=c;return d(),y}return d(),{modifyBase:function(y,v){c[y]=v},modifyItem:g,getUpdateObj:m,applyUpdate:function(y,v){y&&g(y,v);var T=m();for(var _ in T)t.nestedProperty(l,_).set(T[_])}}}},{"../lib":803,"../plots/attributes":850}],844:[function(i,B,V){var t=i("@plotly/d3"),h=i("../registry"),p=i("../plots/plots"),u=i("../lib"),e=i("../lib/clear_gl_canvases"),l=i("../components/color"),o=i("../components/drawing"),a=i("../components/titles"),n=i("../components/modebar"),s=i("../plots/cartesian/axes"),r=i("../constants/alignment"),c=i("../plots/cartesian/constraints"),f=c.enforce,d=c.clean,g=i("../plots/cartesian/autorange").doAutoRange;function m(A,b,L){for(var w=0;w<L.length;w++){var C=L[w][0],S=L[w][1];if(!(C[0]>=A[1]||C[1]<=A[0])&&S[0]<b[1]&&S[1]>b[0])return!0}return!1}function y(A){var b,L,w,C,S,P,z=A._fullLayout,F=z._size,q=F.p,W=s.list(A,"",!0);if(z._paperdiv.style({width:A._context.responsive&&z.autosize&&!A._context._hasZeroWidth&&!A.layout.width?"100%":z.width+"px",height:A._context.responsive&&z.autosize&&!A._context._hasZeroHeight&&!A.layout.height?"100%":z.height+"px"}).selectAll(".main-svg").call(o.setSize,z.width,z.height),A._context.setBackground(A,z.paper_bgcolor),V.drawMainTitle(A),n.manage(A),!z._has("cartesian"))return p.previousPromises(A);function X(Ye,$e,it){var ot=Ye._lw/2;return Ye._id.charAt(0)==="x"?$e?it==="top"?$e._offset-q-ot:$e._offset+$e._length+q+ot:F.t+F.h*(1-(Ye.position||0))+ot%1:$e?it==="right"?$e._offset+$e._length+q+ot:$e._offset-q-ot:F.l+F.w*(Ye.position||0)+ot%1}for(b=0;b<W.length;b++){var Q=(C=W[b])._anchorAxis;C._linepositions={},C._lw=o.crispRound(A,C.linewidth,1),C._mainLinePosition=X(C,Q,C.side),C._mainMirrorPosition=C.mirror&&Q?X(C,Q,r.OPPOSITE_SIDE[C.side]):null}var Z=[],Y=[],N=[],J=l.opacity(z.paper_bgcolor)===1&&l.opacity(z.plot_bgcolor)===1&&z.paper_bgcolor===z.plot_bgcolor;for(L in z._plots)if((w=z._plots[L]).mainplot)w.bg&&w.bg.remove(),w.bg=void 0;else{var D=w.xaxis.domain,U=w.yaxis.domain,G=w.plotgroup;if(m(D,U,N)){var $=G.node(),K=w.bg=u.ensureSingle(G,"rect","bg");$.insertBefore(K.node(),$.childNodes[0]),Y.push(L)}else G.select("rect.bg").remove(),N.push([D,U]),J||(Z.push(L),Y.push(L))}var re,ne,ae,ie,he,se,de,ce,ve,Ee,Le,Te,xe,fe=z._bgLayer.selectAll(".bg").data(Z);for(fe.enter().append("rect").classed("bg",!0),fe.exit().remove(),fe.each(function(Ye){z._plots[Ye].bg=t.select(this)}),b=0;b<Y.length;b++)w=z._plots[Y[b]],S=w.xaxis,P=w.yaxis,w.bg&&S._offset!==void 0&&P._offset!==void 0&&w.bg.call(o.setRect,S._offset-q,P._offset-q,S._length+2*q,P._length+2*q).call(l.fill,z.plot_bgcolor).style("stroke-width",0);if(!z._hasOnlyLargeSploms)for(L in z._plots){w=z._plots[L],S=w.xaxis,P=w.yaxis;var ge,ke,Me=w.clipId="clip"+z._uid+L+"plot",Se=u.ensureSingleById(z._clips,"clipPath",Me,function(Ye){Ye.classed("plotclip",!0).append("rect")});w.clipRect=Se.select("rect").attr({width:S._length,height:P._length}),o.setTranslate(w.plot,S._offset,P._offset),w._hasClipOnAxisFalse?(ge=null,ke=Me):(ge=Me,ke=null),o.setClipUrl(w.plot,ge,A),w.layerClipId=ke}function De(Ye){return"M"+re+","+Ye+"H"+ne}function Be(Ye){return"M"+S._offset+","+Ye+"h"+S._length}function We(Ye){return"M"+Ye+","+ce+"V"+de}function Qe(Ye){return"M"+Ye+","+P._offset+"v"+P._length}function Oe(Ye,$e,it){if(!Ye.showline||L!==Ye._mainSubplot)return"";if(!Ye._anchorAxis)return it(Ye._mainLinePosition);var ot=$e(Ye._mainLinePosition);return Ye.mirror&&(ot+=$e(Ye._mainMirrorPosition)),ot}for(L in z._plots){w=z._plots[L],S=w.xaxis,P=w.yaxis;var Ue="M0,0";v(S,L)&&(he=_(S,"left",P,W),re=S._offset-(he?q+he:0),se=_(S,"right",P,W),ne=S._offset+S._length+(se?q+se:0),ae=X(S,P,"bottom"),ie=X(S,P,"top"),!(xe=!S._anchorAxis||L!==S._mainSubplot)||S.mirror!=="allticks"&&S.mirror!=="all"||(S._linepositions[L]=[ae,ie]),Ue=Oe(S,De,Be),xe&&S.showline&&(S.mirror==="all"||S.mirror==="allticks")&&(Ue+=De(ae)+De(ie)),w.xlines.style("stroke-width",S._lw+"px").call(l.stroke,S.showline?S.linecolor:"rgba(0,0,0,0)")),w.xlines.attr("d",Ue);var Xe="M0,0";v(P,L)&&(Le=_(P,"bottom",S,W),de=P._offset+P._length+(Le?q:0),Te=_(P,"top",S,W),ce=P._offset-(Te?q:0),ve=X(P,S,"left"),Ee=X(P,S,"right"),!(xe=!P._anchorAxis||L!==P._mainSubplot)||P.mirror!=="allticks"&&P.mirror!=="all"||(P._linepositions[L]=[ve,Ee]),Xe=Oe(P,We,Qe),xe&&P.showline&&(P.mirror==="all"||P.mirror==="allticks")&&(Xe+=We(ve)+We(Ee)),w.ylines.style("stroke-width",P._lw+"px").call(l.stroke,P.showline?P.linecolor:"rgba(0,0,0,0)")),w.ylines.attr("d",Xe)}return s.makeClipPaths(A),p.previousPromises(A)}function v(A,b){return(A.ticks||A.showline)&&(b===A._mainSubplot||A.mirror==="all"||A.mirror==="allticks")}function T(A,b,L){if(!L.showline||!L._lw)return!1;if(L.mirror==="all"||L.mirror==="allticks")return!0;var w=L._anchorAxis;if(!w)return!1;var C=r.FROM_BL[b];return L.side===b?w.domain[C]===A.domain[C]:L.mirror&&w.domain[1-C]===A.domain[1-C]}function _(A,b,L,w){if(T(A,b,L))return L._lw;for(var C=0;C<w.length;C++){var S=w[C];if(S._mainAxis===L._mainAxis&&T(A,b,S))return S._lw}return 0}function k(A,b){var L=A.title,w=A._size,C=0;switch(b==="start"?C=L.pad.l:b==="end"&&(C=-L.pad.r),L.xref){case"paper":return w.l+w.w*L.x+C;case"container":default:return A.width*L.x+C}}function E(A,b){var L=A.title,w=A._size,C=0;if(b!=="0em"&&b?b===r.CAP_SHIFT+"em"&&(C=L.pad.t):C=-L.pad.b,L.y==="auto")return w.t/2;switch(L.yref){case"paper":return w.t+w.h-w.h*L.y+C;case"container":default:return A.height-A.height*L.y+C}}V.layoutStyles=function(A){return u.syncOrAsync([p.doAutoMargin,y],A)},V.drawMainTitle=function(A){var b=A._fullLayout,L=function(C){var S=C.title,P="middle";return u.isRightAnchor(S)?P="end":u.isLeftAnchor(S)&&(P="start"),P}(b),w=function(C){var S=C.title,P="0em";return u.isTopAnchor(S)?P=r.CAP_SHIFT+"em":u.isMiddleAnchor(S)&&(P=r.MID_SHIFT+"em"),P}(b);a.draw(A,"gtitle",{propContainer:b,propName:"title.text",placeholder:b._dfltTitle.plot,attributes:{x:k(b,L),y:E(b,w),"text-anchor":L,dy:w}})},V.doTraceStyle=function(A){var b,L=A.calcdata,w=[];for(b=0;b<L.length;b++){var C=L[b],S=C[0]||{},P=S.trace||{},z=P._module||{},F=z.arraysToCalcdata;F&&F(C,P);var q=z.editStyle;q&&w.push({fn:q,cd0:S})}if(w.length){for(b=0;b<w.length;b++){var W=w[b];W.fn(A,W.cd0)}e(A),V.redrawReglTraces(A)}return p.style(A),h.getComponentMethod("legend","draw")(A),p.previousPromises(A)},V.doColorBars=function(A){return h.getComponentMethod("colorbar","draw")(A),p.previousPromises(A)},V.layoutReplot=function(A){var b=A.layout;return A.layout=void 0,h.call("_doPlot",A,"",b)},V.doLegend=function(A){return h.getComponentMethod("legend","draw")(A),p.previousPromises(A)},V.doTicksRelayout=function(A){return s.draw(A,"redraw"),A._fullLayout._hasOnlyLargeSploms&&(h.subplotsRegistry.splom.updateGrid(A),e(A),V.redrawReglTraces(A)),V.drawMainTitle(A),p.previousPromises(A)},V.doModeBar=function(A){var b=A._fullLayout;n.manage(A);for(var L=0;L<b._basePlotModules.length;L++){var w=b._basePlotModules[L].updateFx;w&&w(A)}return p.previousPromises(A)},V.doCamera=function(A){for(var b=A._fullLayout,L=b._subplots.gl3d,w=0;w<L.length;w++){var C=b[L[w]];C._scene.setViewport(C)}},V.drawData=function(A){var b=A._fullLayout;e(A);for(var L=b._basePlotModules,w=0;w<L.length;w++)L[w].plot(A);return V.redrawReglTraces(A),p.style(A),h.getComponentMethod("shapes","draw")(A),h.getComponentMethod("annotations","draw")(A),h.getComponentMethod("images","draw")(A),b._replotting=!1,p.previousPromises(A)},V.redrawReglTraces=function(A){var b=A._fullLayout;if(b._has("regl")){var L,w,C=A._fullData,S=[],P=[];for(b._hasOnlyLargeSploms&&b._splomGrid.draw(),L=0;L<C.length;L++){var z=C[L];z.visible===!0&&z._length!==0&&(z.type==="splom"?b._splomScenes[z.uid].draw():z.type==="scattergl"?u.pushUnique(S,z.xaxis+z.yaxis):z.type==="scatterpolargl"&&u.pushUnique(P,z.subplot))}for(L=0;L<S.length;L++)(w=b._plots[S[L]])._scene&&w._scene.draw();for(L=0;L<P.length;L++)(w=b[P[L]]._subplot)._scene&&w._scene.draw()}},V.doAutoRangeAndConstraints=function(A){for(var b,L=s.list(A,"",!0),w={},C=0;C<L.length;C++)if(!w[(b=L[C])._id]){w[b._id]=1,d(A,b),g(A,b);var S=b._matchGroup;if(S)for(var P in S){var z=s.getFromId(A,P);g(A,z,b.range),w[P]=1}}f(A)},V.finalDraw=function(A){h.getComponentMethod("rangeslider","draw")(A),h.getComponentMethod("rangeselector","draw")(A)},V.drawMarginPushers=function(A){h.getComponentMethod("legend","draw")(A),h.getComponentMethod("rangeselector","draw")(A),h.getComponentMethod("sliders","draw")(A),h.getComponentMethod("updatemenus","draw")(A),h.getComponentMethod("colorbar","draw")(A)}},{"../components/color":666,"../components/drawing":688,"../components/modebar":729,"../components/titles":764,"../constants/alignment":771,"../lib":803,"../lib/clear_gl_canvases":787,"../plots/cartesian/autorange":853,"../plots/cartesian/axes":854,"../plots/cartesian/constraints":862,"../plots/plots":917,"../registry":931,"@plotly/d3":58}],845:[function(i,B,V){var t=i("../lib"),h=t.isPlainObject,p=i("./plot_schema"),u=i("../plots/plots"),e=i("../plots/attributes"),l=i("./plot_template"),o=i("./plot_config").dfltConfig;function a(m,y){m=t.extendDeep({},m);var v,T,_=Object.keys(m).sort();function k(w,C,S){if(h(C)&&h(w))a(w,C);else if(Array.isArray(C)&&Array.isArray(w)){var P=l.arrayTemplater({_template:m},S);for(T=0;T<C.length;T++){var z=C[T],F=P.newItem(z)._template;F&&a(F,z)}var q=P.defaultItems();for(T=0;T<q.length;T++)C.push(q[T]._template);for(T=0;T<C.length;T++)delete C[T].templateitemname}}for(v=0;v<_.length;v++){var E=_[v],A=m[E];if(E in y?k(A,y[E],E):y[E]=A,n(E)===E)for(var b in y){var L=n(b);b===L||L!==E||b in m||k(A,y[b],E)}}}function n(m){return m.replace(/[0-9]+$/,"")}function s(m,y,v,T,_){var k=_&&v(_);for(var E in m){var A=m[E],b=f(m,E,T),L=f(m,E,_),w=v(L);if(!w){var C=n(E);C!==E&&(w=v(L=f(m,C,_)))}if((!k||k!==w)&&!(!w||w._noTemplating||w.valType==="data_array"||w.arrayOk&&Array.isArray(A)))if(!w.valType&&h(A))s(A,y,v,b,L);else if(w._isLinkedToArray&&Array.isArray(A))for(var S=!1,P=0,z={},F=0;F<A.length;F++){var q=A[F];if(h(q)){var W=q.name;if(W)z[W]||(s(q,y,v,f(A,P,b),f(A,P,L)),P++,z[W]=1);else if(!S){var X=f(m,l.arrayDefaultKey(E),T),Q=f(A,P,b);s(q,y,v,Q,f(A,P,L));var Z=t.nestedProperty(y,Q);t.nestedProperty(y,X).set(Z.get()),Z.set(null),S=!0}}}else t.nestedProperty(y,b).set(A)}}function r(m,y){return p.getLayoutValObject(m,t.nestedProperty({},y).parts)}function c(m,y){return p.getTraceValObject(m,t.nestedProperty({},y).parts)}function f(m,y,v){return v?Array.isArray(m)?v+"["+y+"]":v+"."+y:y}function d(m){for(var y=0;y<m.length;y++)if(h(m[y]))return!0}function g(m){var y;switch(m.code){case"data":y="The template has no key data.";break;case"layout":y="The template has no key layout.";break;case"missing":y=m.path?"There are no templates for item "+m.path+" with name "+m.templateitemname:"There are no templates for trace "+m.index+", of type "+m.traceType+".";break;case"unused":y=m.path?"The template item at "+m.path+" was not used in constructing the plot.":m.dataCount?"Some of the templates of type "+m.traceType+" were not used. The template has "+m.templateCount+" traces, the data only has "+m.dataCount+" of this type.":"The template has "+m.templateCount+" traces of type "+m.traceType+" but there are none in the data.";break;case"reused":y="Some of the templates of type "+m.traceType+" were used more than once. The template has "+m.templateCount+" traces, the data has "+m.dataCount+" of this type."}return m.msg=y,m}V.makeTemplate=function(m){m=t.isPlainObject(m)?m:t.getGraphDiv(m),m=t.extendDeep({_context:o},{data:m.data,layout:m.layout}),u.supplyDefaults(m);var y=m.data||[],v=m.layout||{};v._basePlotModules=m._fullLayout._basePlotModules,v._modules=m._fullLayout._modules;var T={data:{},layout:{}};y.forEach(function(P){var z={};s(P,z,c.bind(null,P));var F=t.coerce(P,{},e,"type"),q=T.data[F];q||(q=T.data[F]=[]),q.push(z)}),s(v,T.layout,r.bind(null,v)),delete T.layout.template;var _=v.template;if(h(_)){var k,E,A,b,L,w,C=_.layout;h(C)&&a(C,T.layout);var S=_.data;if(h(S)){for(E in T.data)if(A=S[E],Array.isArray(A)){for(w=(L=T.data[E]).length,b=A.length,k=0;k<w;k++)a(A[k%b],L[k]);for(k=w;k<b;k++)L.push(t.extendDeep({},A[k]))}for(E in S)E in T.data||(T.data[E]=t.extendDeep([],S[E]))}}return T},V.validateTemplate=function(m,y){var v=t.extendDeep({},{_context:o,data:m.data,layout:m.layout}),T=v.layout||{};h(y)||(y=T.template||{});var _=y.layout,k=y.data,E=[];v.layout=T,v.layout.template=y,u.supplyDefaults(v);var A=v._fullLayout,b=v._fullData,L={};if(h(_)?(function q(W,X){for(var Q in W)if(Q.charAt(0)!=="_"&&h(W[Q])){var Z,Y=n(Q),N=[];for(Z=0;Z<X.length;Z++)N.push(f(W,Q,X[Z])),Y!==Q&&N.push(f(W,Y,X[Z]));for(Z=0;Z<N.length;Z++)L[N[Z]]=1;q(W[Q],N)}}(A,["layout"]),function q(W,X){for(var Q in W)if(Q.indexOf("defaults")===-1&&h(W[Q])){var Z=f(W,Q,X);L[Z]?q(W[Q],Z):E.push({code:"unused",path:Z})}}(_,"layout")):E.push({code:"layout"}),h(k)){for(var w,C={},S=0;S<b.length;S++){var P=b[S];C[w=P.type]=(C[w]||0)+1,P._fullInput._template||E.push({code:"missing",index:P._fullInput.index,traceType:w})}for(w in k){var z=k[w].length,F=C[w]||0;z>F?E.push({code:"unused",traceType:w,templateCount:z,dataCount:F}):F>z&&E.push({code:"reused",traceType:w,templateCount:z,dataCount:F})}}else E.push({code:"data"});if(function q(W,X){for(var Q in W)if(Q.charAt(0)!=="_"){var Z=W[Q],Y=f(W,Q,X);h(Z)?(Array.isArray(W)&&Z._template===!1&&Z.templateitemname&&E.push({code:"missing",path:Y,templateitemname:Z.templateitemname}),q(Z,Y)):Array.isArray(Z)&&d(Z)&&q(Z,Y)}}({data:b,layout:A},""),E.length)return E.map(g)}},{"../lib":803,"../plots/attributes":850,"../plots/plots":917,"./plot_config":841,"./plot_schema":842,"./plot_template":843}],846:[function(i,B,V){var t=i("fast-isnumeric"),h=i("./plot_api"),p=i("../plots/plots"),u=i("../lib"),e=i("../snapshot/helpers"),l=i("../snapshot/tosvg"),o=i("../snapshot/svgtoimg"),a=i("../version").version,n={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};B.exports=function(s,r){var c,f,d,g;function m(F){return!(F in r)||u.validate(r[F],n[F])}if(r=r||{},u.isPlainObject(s)?(c=s.data||[],f=s.layout||{},d=s.config||{},g={}):(s=u.getGraphDiv(s),c=u.extendDeep([],s.data),f=u.extendDeep({},s.layout),d=s._context,g=s._fullLayout||{}),!m("width")&&r.width!==null||!m("height")&&r.height!==null)throw new Error("Height and width should be pixel values.");if(!m("format"))throw new Error("Export format is not "+u.join2(n.format.values,", "," or ")+".");var y={};function v(F,q){return u.coerce(r,y,n,F,q)}var T=v("format"),_=v("width"),k=v("height"),E=v("scale"),A=v("setBackground"),b=v("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var w=u.extendFlat({},f);_?w.width=_:r.width===null&&t(g.width)&&(w.width=g.width),k?w.height=k:r.height===null&&t(g.height)&&(w.height=g.height);var C=u.extendFlat({},d,{_exportedPlot:!0,staticPlot:!0,setBackground:A}),S=e.getRedrawFunc(L);function P(){return new Promise(function(F){setTimeout(F,e.getDelay(L._fullLayout))})}function z(){return new Promise(function(F,q){var W=l(L,T,E),X=L._fullLayout.width,Q=L._fullLayout.height;function Z(){h.purge(L),document.body.removeChild(L)}if(T==="full-json"){var Y=p.graphJson(L,!1,"keepdata","object",!0,!0);return Y.version=a,Y=JSON.stringify(Y),Z(),F(b?Y:e.encodeJSON(Y))}if(Z(),T==="svg")return F(b?W:e.encodeSVG(W));var N=document.createElement("canvas");N.id=u.randstr(),o({format:T,width:X,height:Q,scale:E,canvas:N,svg:W,promise:!0}).then(F).catch(q)})}return new Promise(function(F,q){h.newPlot(L,c,w,C).then(S).then(P).then(z).then(function(W){F(function(X){return b?X.replace(e.IMAGE_URL_PREFIX,""):X}(W))}).catch(function(W){q(W)})})}},{"../lib":803,"../plots/plots":917,"../snapshot/helpers":935,"../snapshot/svgtoimg":937,"../snapshot/tosvg":939,"../version":1404,"./plot_api":840,"fast-isnumeric":249}],847:[function(i,B,V){var t=i("../lib"),h=i("../plots/plots"),p=i("./plot_schema"),u=i("./plot_config").dfltConfig,e=t.isPlainObject,l=Array.isArray,o=t.isArrayOrTypedArray;function a(y,v,T,_,k,E){E=E||[];for(var A=Object.keys(y),b=0;b<A.length;b++){var L=A[b];if(L!=="transforms"){var w=E.slice();w.push(L);var C=y[L],S=v[L],P=d(T,L),z=(P||{}).valType,F=z==="info_array",q=z==="colorscale",W=(P||{}).items;if(f(T,L))if(e(C)&&e(S)&&z!=="any")a(C,S,P,_,k,w);else if(F&&l(C)){C.length>S.length&&_.push(c("unused",k,w.concat(S.length)));var X,Q,Z,Y,N,J=S.length,D=Array.isArray(W);if(D&&(J=Math.min(J,W.length)),P.dimensions===2)for(Q=0;Q<J;Q++)if(l(C[Q])){C[Q].length>S[Q].length&&_.push(c("unused",k,w.concat(Q,S[Q].length)));var U=S[Q].length;for(X=0;X<(D?Math.min(U,W[Q].length):U);X++)Z=D?W[Q][X]:W,Y=C[Q][X],N=S[Q][X],t.validate(Y,Z)?N!==Y&&N!==+Y&&_.push(c("dynamic",k,w.concat(Q,X),Y,N)):_.push(c("value",k,w.concat(Q,X),Y))}else _.push(c("array",k,w.concat(Q),C[Q]));else for(Q=0;Q<J;Q++)Z=D?W[Q]:W,Y=C[Q],N=S[Q],t.validate(Y,Z)?N!==Y&&N!==+Y&&_.push(c("dynamic",k,w.concat(Q),Y,N)):_.push(c("value",k,w.concat(Q),Y))}else if(P.items&&!F&&l(C)){var G,$,K=W[Object.keys(W)[0]],re=[];for(G=0;G<S.length;G++){var ne=S[G]._index||G;if(($=w.slice()).push(ne),e(C[ne])&&e(S[G])){re.push(ne);var ae=C[ne],ie=S[G];e(ae)&&ae.visible!==!1&&ie.visible===!1?_.push(c("invisible",k,$)):a(ae,ie,K,_,k,$)}}for(G=0;G<C.length;G++)($=w.slice()).push(G),e(C[G])?re.indexOf(G)===-1&&_.push(c("unused",k,$)):_.push(c("object",k,$,C[G]))}else!e(C)&&e(S)?_.push(c("object",k,w,C)):o(C)||!o(S)||F||q?L in v?t.validate(C,P)?P.valType==="enumerated"&&(P.coerceNumber&&C!==+S||C!==S)&&_.push(c("dynamic",k,w,C,S)):_.push(c("value",k,w,C)):_.push(c("unused",k,w,C)):_.push(c("array",k,w,C));else _.push(c("schema",k,w))}}return _}function n(y,v){for(var T=y.layout.layoutAttributes,_=0;_<v.length;_++){var k=v[_],E=y.traces[k.type],A=E.layoutAttributes;A&&(k.subplot?t.extendFlat(T[E.attributes.subplot.dflt],A):t.extendFlat(T,A))}return T}B.exports=function(y,v){y===void 0&&(y=[]),v===void 0&&(v={});var T,_,k=p.get(),E=[],A={_context:t.extendFlat({},u)};l(y)?(A.data=t.extendDeep([],y),T=y):(A.data=[],T=[],E.push(c("array","data"))),e(v)?(A.layout=t.extendDeep({},v),_=v):(A.layout={},_={},arguments.length>1&&E.push(c("object","layout"))),h.supplyDefaults(A);for(var b=A._fullData,L=T.length,w=0;w<L;w++){var C=T[w],S=["data",w];if(e(C)){var P=b[w],z=P.type,F=k.traces[z].attributes;F.type={valType:"enumerated",values:[z]},P.visible===!1&&C.visible!==!1&&E.push(c("invisible",S)),a(C,P,F,E,S);var q=C.transforms,W=P.transforms;if(q){l(q)||E.push(c("array",S,["transforms"])),S.push("transforms");for(var X=0;X<q.length;X++){var Q=["transforms",X],Z=q[X].type;if(e(q[X])){var Y=k.transforms[Z]?k.transforms[Z].attributes:{};Y.type={valType:"enumerated",values:Object.keys(k.transforms)},a(q[X],W[X],Y,E,S,Q)}else E.push(c("object",S,Q))}}}else E.push(c("object",S))}var N=A._fullLayout,J=n(k,b);return a(_,N,J,E,"layout"),E.length===0?void 0:E};var s={object:function(y,v){return(y==="layout"&&v===""?"The layout argument":y[0]==="data"&&v===""?"Trace "+y[1]+" in the data argument":r(y)+"key "+v)+" must be linked to an object container"},array:function(y,v){return(y==="data"?"The data argument":r(y)+"key "+v)+" must be linked to an array container"},schema:function(y,v){return r(y)+"key "+v+" is not part of the schema"},unused:function(y,v,T){var _=e(T)?"container":"key";return r(y)+_+" "+v+" did not get coerced"},dynamic:function(y,v,T,_){return[r(y)+"key",v,"(set to '"+T+"')","got reset to","'"+_+"'","during defaults."].join(" ")},invisible:function(y,v){return(v?r(y)+"item "+v:"Trace "+y[1])+" got defaulted to be not visible"},value:function(y,v,T){return[r(y)+"key "+v,"is set to an invalid value ("+T+")"].join(" ")}};function r(y){return l(y)?"In data trace "+y[1]+", ":"In "+y+", "}function c(y,v,T,_,k){var E,A;T=T||"",l(v)?(E=v[0],A=v[1]):(E=v,A=null);var b=function(w){if(!l(w))return String(w);for(var C="",S=0;S<w.length;S++){var P=w[S];typeof P=="number"?C=C.substr(0,C.length-1)+"["+P+"]":C+=P,S<w.length-1&&(C+=".")}return C}(T),L=s[y](v,b,_,k);return t.log(L),{code:y,container:E,trace:A,path:T,astr:b,msg:L}}function f(y,v){var T=m(v),_=T.keyMinusId,k=T.id;return!!(_ in y&&y[_]._isSubplotObj&&k)||v in y}function d(y,v){return v in y?y[v]:y[m(v).keyMinusId]}var g=t.counterRegex("([a-z]+)");function m(y){var v=y.match(g);return{keyMinusId:v&&v[1],id:v&&v[2]}}},{"../lib":803,"../plots/plots":917,"./plot_config":841,"./plot_schema":842}],848:[function(i,B,V){B.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],849:[function(i,B,V){var t=i("../lib"),h=i("../plot_api/plot_template");B.exports=function(p,u,e){var l,o,a=e.name,n=e.inclusionAttr||"visible",s=u[a],r=t.isArrayOrTypedArray(p[a])?p[a]:[],c=u[a]=[],f=h.arrayTemplater(u,a,n);for(l=0;l<r.length;l++){var d=r[l];t.isPlainObject(d)?o=f.newItem(d):(o=f.newItem({}))[n]=!1,o._index=l,o[n]!==!1&&e.handleItemDefaults(d,o,u,e),c.push(o)}var g=f.defaultItems();for(l=0;l<g.length;l++)(o=g[l])._index=c.length,e.handleItemDefaults({},o,u,e,{}),c.push(o);if(t.isArrayOrTypedArray(s)){var m=Math.min(s.length,c.length);for(l=0;l<m;l++)t.relinkPrivateKeys(c[l],s[l])}return c}},{"../lib":803,"../plot_api/plot_template":843}],850:[function(i,B,V){var t=i("./font_attributes"),h=i("../components/fx/attributes");B.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:t({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:h.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":697,"./font_attributes":883}],851:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=h.dateTime2ms,u=h.incrementMonth,e=i("../../constants/numerical").ONEAVGMONTH;B.exports=function(l,o,a,n){if(o.type!=="date")return{vals:n};var s=l[a+"periodalignment"];if(!s)return{vals:n};var r,c=l[a+"period"];if(t(c)){if((c=+c)<=0)return{vals:n}}else if(typeof c=="string"&&c.charAt(0)==="M"){var f=+c.substring(1);if(!(f>0&&Math.round(f)===f))return{vals:n};r=f}for(var d=o.calendar,g=s==="start",m=s==="end",y=l[a+"period0"],v=p(y,d)||0,T=[],_=[],k=[],E=n.length,A=0;A<E;A++){var b,L,w,C=n[A];if(r){for(b=Math.round((C-v)/(r*e)),w=u(v,r*b,d);w>C;)w=u(w,-r,d);for(;w<=C;)w=u(w,r,d);L=u(w,-r,d)}else{for(w=v+(b=Math.round((C-v)/c))*c;w>C;)w-=c;for(;w<=C;)w+=c;L=w-c}T[A]=g?L:m?w:(L+w)/2,_[A]=L,k[A]=w}return{vals:T,starts:_,ends:k}}},{"../../constants/numerical":779,"../../lib":803,"fast-isnumeric":249}],852:[function(i,B,V){B.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],853:[function(i,B,V){var t=i("@plotly/d3"),h=i("fast-isnumeric"),p=i("../../lib"),u=i("../../constants/numerical").FP_SAFE,e=i("../../registry"),l=i("../../components/drawing"),o=i("./axis_ids"),a=o.getFromId,n=o.isLinked;function s(_,k){var E,A,b=[],L=_._fullLayout,w=c(L,k,0),C=c(L,k,1),S=f(_,k),P=S.min,z=S.max;if(P.length===0||z.length===0)return p.simpleMap(k.range,k.r2l);var F=P[0].val,q=z[0].val;for(E=1;E<P.length&&F===q;E++)F=Math.min(F,P[E].val);for(E=1;E<z.length&&F===q;E++)q=Math.max(q,z[E].val);var W=!1;if(k.range){var X=p.simpleMap(k.range,k.r2l);W=X[1]<X[0]}k.autorange==="reversed"&&(W=!0,k.autorange=!0);var Q,Z,Y,N,J,D,U=k.rangemode,G=U==="tozero",$=U==="nonnegative",K=k._length,re=K/10,ne=0;for(E=0;E<P.length;E++)for(Q=P[E],A=0;A<z.length;A++)(D=(Z=z[A]).val-Q.val-r(k,Q.val,Z.val))>0&&((J=K-w(Q)-C(Z))>re?D/J>ne&&(Y=Q,N=Z,ne=D/J):D/K>ne&&(Y={val:Q.val,nopad:1},N={val:Z.val,nopad:1},ne=D/K));if(F===q){var ae=F-1,ie=F+1;if(G)if(F===0)b=[0,1];else{var he=(F>0?z:P).reduce(function(de,ce){return Math.max(de,C(ce))},0),se=F/(1-Math.min(.5,he/K));b=F>0?[0,se]:[se,0]}else b=$?[Math.max(0,ae),Math.max(1,ie)]:[ae,ie]}else G?(Y.val>=0&&(Y={val:0,nopad:1}),N.val<=0&&(N={val:0,nopad:1})):$&&(Y.val-ne*w(Y)<0&&(Y={val:0,nopad:1}),N.val<=0&&(N={val:1,nopad:1})),ne=(N.val-Y.val-r(k,Q.val,Z.val))/(K-w(Y)-C(N)),b=[Y.val-ne*w(Y),N.val+ne*C(N)];return W&&b.reverse(),p.simpleMap(b,k.l2r||Number)}function r(_,k,E){var A=0;if(_.rangebreaks)for(var b=_.locateBreaks(k,E),L=0;L<b.length;L++){var w=b[L];A+=w.max-w.min}return A}function c(_,k,E){var A=.05*k._length,b=k._anchorAxis||{};if((k.ticklabelposition||"").indexOf("inside")!==-1||(b.ticklabelposition||"").indexOf("inside")!==-1){var L=k.autorange==="reversed";if(!L){var w=p.simpleMap(k.range,k.r2l);L=w[1]<w[0]}L&&(E=!E)}var C=0;return n(_,k._id)||(C=function(S,P,z){var F=0,q=P._id.charAt(0)==="x";for(var W in S._plots){var X=S._plots[W];if(P._id===X.xaxis._id||P._id===X.yaxis._id){var Q=(q?X.yaxis:X.xaxis)||{};if((Q.ticklabelposition||"").indexOf("inside")!==-1&&(!z&&(Q.side==="left"||Q.side==="bottom")||z&&(Q.side==="top"||Q.side==="right"))){if(Q._vals){var Z=p.deg2rad(Q._tickAngles[Q._id+"tick"]||0),Y=Math.abs(Math.cos(Z)),N=Math.abs(Math.sin(Z));if(!Q._vals[0].bb){var J=Q._id+"tick";Q._selections[J].each(function(K){var re=t.select(this);re.select(".text-math-group").empty()&&(K.bb=l.bBox(re.node()))})}for(var D=0;D<Q._vals.length;D++){var U=Q._vals[D].bb;if(U){var G=6+U.width,$=6+U.height;F=Math.max(F,q?Math.max(G*Y,$*N):Math.max($*Y,G*N))}}}Q.ticks==="inside"&&Q.ticklabelposition==="inside"&&(F+=Q.ticklen||0)}}}return F}(_,k,E)),A=Math.max(C,A),k.constrain==="domain"&&k._inputDomain&&(A*=(k._inputDomain[1]-k._inputDomain[0])/(k.domain[1]-k.domain[0])),function(S){return S.nopad?0:S.pad+(S.extrapad?A:C)}}B.exports={getAutoRange:s,makePadFn:c,doAutoRange:function(_,k,E){if(k.setScale(),k.autorange){k.range=E?E.slice():s(_,k),k._r=k.range.slice(),k._rl=p.simpleMap(k._r,k.r2l);var A=k._input,b={};b[k._attr+".range"]=k.range,b[k._attr+".autorange"]=k.autorange,e.call("_storeDirectGUIEdit",_.layout,_._fullLayout._preGUI,b),A.range=k.range.slice(),A.autorange=k.autorange}var L=k._anchorAxis;if(L&&L.rangeslider){var w=L.rangeslider[k._name];w&&w.rangemode==="auto"&&(w.range=s(_,k)),L._input.rangeslider[k._name]=p.extendFlat({},w)}},findExtremes:function(_,k,E){E||(E={}),_._m||_.setScale();var A,b,L,w,C,S,P,z,F,q=[],W=[],X=k.length,Q=E.padded||!1,Z=E.tozero&&(_.type==="linear"||_.type==="-"),Y=_.type==="log",N=!1,J=E.vpadLinearized||!1;function D(ie){if(Array.isArray(ie))return N=!0,function(se){return Math.max(Number(ie[se]||0),0)};var he=Math.max(Number(ie||0),0);return function(){return he}}var U=D((_._m>0?E.ppadplus:E.ppadminus)||E.ppad||0),G=D((_._m>0?E.ppadminus:E.ppadplus)||E.ppad||0),$=D(E.vpadplus||E.vpad),K=D(E.vpadminus||E.vpad);if(!N){if(z=1/0,F=-1/0,Y)for(A=0;A<X;A++)(b=k[A])<z&&b>0&&(z=b),b>F&&b<u&&(F=b);else for(A=0;A<X;A++)(b=k[A])<z&&b>-u&&(z=b),b>F&&b<u&&(F=b);k=[z,F],X=2}var re={tozero:Z,extrapad:Q};function ne(ie){L=k[ie],h(L)&&(S=U(ie),P=G(ie),J?(w=_.c2l(L)-K(ie),C=_.c2l(L)+$(ie)):(z=L-K(ie),F=L+$(ie),Y&&z<F/10&&(z=F/10),w=_.c2l(z),C=_.c2l(F)),Z&&(w=Math.min(0,w),C=Math.max(0,C)),y(w)&&d(q,w,P,re),y(C)&&g(W,C,S,re))}var ae=Math.min(6,X);for(A=0;A<ae;A++)ne(A);for(A=X-1;A>=ae;A--)ne(A);return{min:q,max:W,opts:E}},concatExtremes:f};function f(_,k,E){var A,b,L,w=k._id,C=_._fullData,S=_._fullLayout,P=[],z=[];function F(Z,Y){for(A=0;A<Y.length;A++){var N=Z[Y[A]],J=(N._extremes||{})[w];if(N.visible===!0&&J){for(b=0;b<J.min.length;b++)L=J.min[b],d(P,L.val,L.pad,{extrapad:L.extrapad});for(b=0;b<J.max.length;b++)L=J.max[b],g(z,L.val,L.pad,{extrapad:L.extrapad})}}}if(F(C,k._traceIndices),F(S.annotations||[],k._annIndices||[]),F(S.shapes||[],k._shapeIndices||[]),k._matchGroup&&!E){for(var q in k._matchGroup)if(q!==k._id){var W=a(_,q),X=f(_,W,!0),Q=k._length/W._length;for(b=0;b<X.min.length;b++)L=X.min[b],d(P,L.val,L.pad*Q,{extrapad:L.extrapad});for(b=0;b<X.max.length;b++)L=X.max[b],g(z,L.val,L.pad*Q,{extrapad:L.extrapad})}}return{min:P,max:z}}function d(_,k,E,A){m(_,k,E,A,v)}function g(_,k,E,A){m(_,k,E,A,T)}function m(_,k,E,A,b){for(var L=A.tozero,w=A.extrapad,C=!0,S=0;S<_.length&&C;S++){var P=_[S];if(b(P.val,k)&&P.pad>=E&&(P.extrapad||!w)){C=!1;break}b(k,P.val)&&P.pad<=E&&(w||!P.extrapad)&&(_.splice(S,1),S--)}if(C){var z=L&&k===0;_.push({val:k,pad:z?0:E,extrapad:!z&&w})}}function y(_){return h(_)&&Math.abs(_)<u}function v(_,k){return _<=k}function T(_,k){return _>=k}},{"../../components/drawing":688,"../../constants/numerical":779,"../../lib":803,"../../registry":931,"./axis_ids":858,"@plotly/d3":58,"fast-isnumeric":249}],854:[function(i,B,V){var t=i("@plotly/d3"),h=i("fast-isnumeric"),p=i("../../plots/plots"),u=i("../../registry"),e=i("../../lib"),l=e.strTranslate,o=i("../../lib/svg_text_utils"),a=i("../../components/titles"),n=i("../../components/color"),s=i("../../components/drawing"),r=i("./layout_attributes"),c=i("./clean_ticks"),f=i("../../constants/numerical"),d=f.ONEMAXYEAR,g=f.ONEAVGYEAR,m=f.ONEMINYEAR,y=f.ONEMAXQUARTER,v=f.ONEAVGQUARTER,T=f.ONEMINQUARTER,_=f.ONEMAXMONTH,k=f.ONEAVGMONTH,E=f.ONEMINMONTH,A=f.ONEWEEK,b=f.ONEDAY,L=b/2,w=f.ONEHOUR,C=f.ONEMIN,S=f.ONESEC,P=f.MINUS_SIGN,z=f.BADNUM,F={K:"zeroline"},q={K:"gridline",L:"path"},W={K:"tick",L:"path"},X={K:"tick",L:"text"},Q=i("../../constants/alignment"),Z=Q.MID_SHIFT,Y=Q.CAP_SHIFT,N=Q.LINE_SPACING,J=Q.OPPOSITE_SIDE,D=B.exports={};D.setConvert=i("./set_convert");var U=i("./axis_autotype"),G=i("./axis_ids"),$=G.idSort,K=G.isLinked;D.id2name=G.id2name,D.name2id=G.name2id,D.cleanId=G.cleanId,D.list=G.list,D.listIds=G.listIds,D.getFromId=G.getFromId,D.getFromTrace=G.getFromTrace;var re=i("./autorange");D.getAutoRange=re.getAutoRange,D.findExtremes=re.findExtremes;function ne(je){var Ge=1e-4*(je[1]-je[0]);return[je[0]-Ge,je[1]+Ge]}D.coerceRef=function(je,Ge,Ct,Ie,be,Ae){var Pe=Ie.charAt(Ie.length-1),ze=Ct._fullLayout._subplots[Pe+"axis"],qe=Ie+"ref",ht={};return be||(be=ze[0]||(typeof Ae=="string"?Ae:Ae[0])),Ae||(Ae=be),ze=ze.concat(ze.map(function(at){return at+" domain"})),ht[qe]={valType:"enumerated",values:ze.concat(Ae?typeof Ae=="string"?[Ae]:Ae:[]),dflt:be},e.coerce(je,Ge,ht,qe)},D.getRefType=function(je){return je===void 0?je:je==="paper"?"paper":je==="pixel"?"pixel":/( domain)$/.test(je)?"domain":"range"},D.coercePosition=function(je,Ge,Ct,Ie,be,Ae){var Pe,ze;if(D.getRefType(Ie)!=="range")Pe=e.ensureNumber,ze=Ct(be,Ae);else{var qe=D.getFromId(Ge,Ie);ze=Ct(be,Ae=qe.fraction2r(Ae)),Pe=qe.cleanPos}je[be]=Pe(ze)},D.cleanPosition=function(je,Ge,Ct){return(Ct==="paper"||Ct==="pixel"?e.ensureNumber:D.getFromId(Ge,Ct).cleanPos)(je)},D.redrawComponents=function(je,Ge){Ge=Ge||D.listIds(je);var Ct=je._fullLayout;function Ie(be,Ae,Pe,ze){for(var qe=u.getComponentMethod(be,Ae),ht={},at=0;at<Ge.length;at++)for(var nt=Ct[D.id2name(Ge[at])][Pe],xt=0;xt<nt.length;xt++){var Lt=nt[xt];if(!ht[Lt]&&(qe(je,Lt),ht[Lt]=1,ze))return}}Ie("annotations","drawOne","_annIndices"),Ie("shapes","drawOne","_shapeIndices"),Ie("images","draw","_imgIndices",!0)};var ae=D.getDataConversions=function(je,Ge,Ct,Ie){var be,Ae=Ct==="x"||Ct==="y"||Ct==="z"?Ct:Ie;if(Array.isArray(Ae)){if(be={type:U(Ie,void 0,{autotypenumbers:je._fullLayout.autotypenumbers}),_categories:[]},D.setConvert(be),be.type==="category")for(var Pe=0;Pe<Ie.length;Pe++)be.d2c(Ie[Pe])}else be=D.getFromTrace(je,Ge,Ae);return be?{d2c:be.d2c,c2d:be.c2d}:Ae==="ids"?{d2c:he,c2d:he}:{d2c:ie,c2d:ie}};function ie(je){return+je}function he(je){return String(je)}function se(je){return+je.substring(1)}D.getDataToCoordFunc=function(je,Ge,Ct,Ie){return ae(je,Ge,Ct,Ie).d2c},D.counterLetter=function(je){var Ge=je.charAt(0);return Ge==="x"?"y":Ge==="y"?"x":void 0},D.minDtick=function(je,Ge,Ct,Ie){["log","category","multicategory"].indexOf(je.type)===-1&&Ie?je._minDtick===void 0?(je._minDtick=Ge,je._forceTick0=Ct):je._minDtick&&((je._minDtick/Ge+1e-6)%1<2e-6&&((Ct-je._forceTick0)/Ge%1+1.000001)%1<2e-6?(je._minDtick=Ge,je._forceTick0=Ct):((Ge/je._minDtick+1e-6)%1>2e-6||((Ct-je._forceTick0)/je._minDtick%1+1.000001)%1>2e-6)&&(je._minDtick=0)):je._minDtick=0},D.saveRangeInitial=function(je,Ge){for(var Ct=D.list(je,"",!0),Ie=!1,be=0;be<Ct.length;be++){var Ae=Ct[be],Pe=Ae._rangeInitial===void 0,ze=Pe||!(Ae.range[0]===Ae._rangeInitial[0]&&Ae.range[1]===Ae._rangeInitial[1]);(Pe&&Ae.autorange===!1||Ge&&ze)&&(Ae._rangeInitial=Ae.range.slice(),Ie=!0)}return Ie},D.saveShowSpikeInitial=function(je,Ge){for(var Ct=D.list(je,"",!0),Ie=!1,be="on",Ae=0;Ae<Ct.length;Ae++){var Pe=Ct[Ae],ze=Pe._showSpikeInitial===void 0,qe=ze||Pe.showspikes!==Pe._showspikes;(ze||Ge&&qe)&&(Pe._showSpikeInitial=Pe.showspikes,Ie=!0),be!=="on"||Pe.showspikes||(be="off")}return je._fullLayout._cartesianSpikesEnabled=be,Ie},D.autoBin=function(je,Ge,Ct,Ie,be,Ae){var Pe,ze=e.aggNums(Math.min,null,je),qe=e.aggNums(Math.max,null,je);if(Ge.type==="category"||Ge.type==="multicategory")return{start:ze-.5,end:qe+.5,size:Math.max(1,Math.round(Ae)||1),_dataSpan:qe-ze};if(be||(be=Ge.calendar),Pe=Ge.type==="log"?{type:"linear",range:[ze,qe]}:{type:Ge.type,range:e.simpleMap([ze,qe],Ge.c2r,0,be),calendar:be},D.setConvert(Pe),Ae=Ae&&c.dtick(Ae,Pe.type))Pe.dtick=Ae,Pe.tick0=c.tick0(void 0,Pe.type,be);else{var ht;if(Ct)ht=(qe-ze)/Ct;else{var at=e.distinctVals(je),nt=Math.pow(10,Math.floor(Math.log(at.minDiff)/Math.LN10)),xt=nt*e.roundUp(at.minDiff/nt,[.9,1.9,4.9,9.9],!0);ht=Math.max(xt,2*e.stdev(je)/Math.pow(je.length,Ie?.25:.4)),h(ht)||(ht=1)}D.autoTicks(Pe,ht)}var Lt,bt=Pe.dtick,St=D.tickIncrement(D.tickFirst(Pe),bt,"reverse",be);if(typeof bt=="number")Lt=(St=function(st,It,jt,Ut,zt){var Ce=0,lt=0,At=0,Bt=0;function Ht(nr){return(1+100*(nr-st)/jt.dtick)%100<2}for(var or=0;or<It.length;or++)It[or]%1==0?At++:h(It[or])||Bt++,Ht(It[or])&&Ce++,Ht(It[or]+jt.dtick/2)&&lt++;var ar=It.length-Bt;if(At===ar&&jt.type!=="date")jt.dtick<1?st=Ut-.5*jt.dtick:(st-=.5)+jt.dtick<Ut&&(st+=jt.dtick);else if(lt<.1*ar&&(Ce>.3*ar||Ht(Ut)||Ht(zt))){var Nt=jt.dtick/2;st+=st+Nt<Ut?Nt:-Nt}return st}(St,je,Pe,ze,qe))+(1+Math.floor((qe-St)/bt))*bt;else for(Pe.dtick.charAt(0)==="M"&&(St=function(st,It,jt,Ut,zt){var Ce=e.findExactDates(It,zt);if(Ce.exactDays>.8){var lt=Number(jt.substr(1));Ce.exactYears>.8&&lt%12==0?st=D.tickIncrement(st,"M6","reverse")+1.5*b:Ce.exactMonths>.8?st=D.tickIncrement(st,"M1","reverse")+15.5*b:st-=L;var At=D.tickIncrement(st,jt);if(At<=Ut)return At}return st}(St,je,bt,ze,be)),Lt=St,0;Lt<=qe;)Lt=D.tickIncrement(Lt,bt,!1,be);return{start:Ge.c2r(St,0,be),end:Ge.c2r(Lt,0,be),size:bt,_dataSpan:qe-ze}},D.prepTicks=function(je,Ge){var Ct=e.simpleMap(je.range,je.r2l,void 0,void 0,Ge);if(je._dtickInit=je.dtick,je._tick0Init=je.tick0,je.tickmode==="auto"||!je.dtick){var Ie,be=je.nticks;be||(je.type==="category"||je.type==="multicategory"?(Ie=je.tickfont?e.bigFont(je.tickfont.size||12):15,be=je._length/Ie):(Ie=je._id.charAt(0)==="y"?40:80,be=e.constrain(je._length/Ie,4,9)+1),je._name==="radialaxis"&&(be*=2)),je.tickmode==="array"&&(be*=100),je._roughDTick=Math.abs(Ct[1]-Ct[0])/be,D.autoTicks(je,je._roughDTick),je._minDtick>0&&je.dtick<2*je._minDtick&&(je.dtick=je._minDtick,je.tick0=je.l2r(je._forceTick0))}je.ticklabelmode==="period"&&function(Ae){var Pe;function ze(){return!(h(Ae.dtick)||Ae.dtick.charAt(0)!=="M")}var qe=ze(),ht=D.getTickFormat(Ae);if(ht){var at=Ae._dtickInit!==Ae.dtick;/%[fLQsSMX]/.test(ht)||(/%[HI]/.test(ht)?(Pe=w,at&&!qe&&Ae.dtick<w&&(Ae.dtick=w)):/%p/.test(ht)?(Pe=L,at&&!qe&&Ae.dtick<L&&(Ae.dtick=L)):/%[Aadejuwx]/.test(ht)?(Pe=b,at&&!qe&&Ae.dtick<b&&(Ae.dtick=b)):/%[UVW]/.test(ht)?(Pe=A,at&&!qe&&Ae.dtick<A&&(Ae.dtick=A)):/%[Bbm]/.test(ht)?(Pe=k,at&&(qe?se(Ae.dtick)<1:Ae.dtick<E)&&(Ae.dtick="M1")):/%[q]/.test(ht)?(Pe=v,at&&(qe?se(Ae.dtick)<3:Ae.dtick<T)&&(Ae.dtick="M3")):/%[Yy]/.test(ht)&&(Pe=g,at&&(qe?se(Ae.dtick)<12:Ae.dtick<m)&&(Ae.dtick="M12")))}(qe=ze())&&Ae.tick0===Ae._dowTick0&&(Ae.tick0=Ae._rawTick0),Ae._definedDelta=Pe}(je),je.tick0||(je.tick0=je.type==="date"?"2000-01-01":0),je.type==="date"&&je.dtick<.1&&(je.dtick=.1),ge(je)},D.calcTicks=function(je,Ge){D.prepTicks(je,Ge);var Ct=e.simpleMap(je.range,je.r2l,void 0,void 0,Ge);if(je.tickmode==="array")return function(or){var ar=or.tickvals,Nt=or.ticktext,nr=new Array(ar.length),Lr=ne(e.simpleMap(or.range,or.r2l)),dr=Math.min(Lr[0],Lr[1]),Kt=Math.max(Lr[0],Lr[1]),yr=0;Array.isArray(Nt)||(Nt=[]);var xr=or.type==="category"?or.d2l_noadd:or.d2l;or.type==="log"&&String(or.dtick).charAt(0)!=="L"&&(or.dtick="L"+Math.pow(10,Math.floor(Math.min(or.range[0],or.range[1]))-1));for(var gr=0;gr<ar.length;gr++){var wr=xr(ar[gr]);wr>dr&&wr<Kt&&(Nt[gr]===void 0?nr[yr]=D.tickText(or,wr):nr[yr]=ke(or,wr,String(Nt[gr])),yr++)}return yr<ar.length&&nr.splice(yr,ar.length-yr),or.rangebreaks&&(nr=nr.filter(function(zr){return or.maskBreaks(zr.x)!==z})),nr}(je);var Ie=ne(Ct),be=Ie[0],Ae=Ie[1],Pe=Ct[1]<Ct[0],ze=Math.min(Ct[0],Ct[1]),qe=Math.max(Ct[0],Ct[1]),ht=je.type==="log"&&!(h(je.dtick)||je.dtick.charAt(0)==="L"),at=je.ticklabelmode==="period";if(je._tmin=D.tickFirst(je,Ge),je._tmin<be!==Pe)return[];je.type!=="category"&&je.type!=="multicategory"||(Ae=Pe?Math.max(-.5,Ae):Math.min(je._categories.length-.5,Ae));var nt=je._tmin;je.rangebreaks&&je._tick0Init!==je.tick0&&(nt=Mt(nt,je),Pe||(nt=D.tickIncrement(nt,je.dtick,!Pe,je.calendar))),at&&(nt=D.tickIncrement(nt,je.dtick,!Pe,je.calendar));for(var xt,Lt=Math.max(1e3,je._length||0),bt=[],St=null;Pe?nt>=Ae:nt<=Ae;nt=D.tickIncrement(nt,je.dtick,Pe,je.calendar)){if(je.rangebreaks&&!Pe){if(nt<be)continue;if(je.maskBreaks(nt)===z&&Mt(nt,je)>=qe)break}if(bt.length>Lt||nt===St)break;St=nt;var st=!1;ht&&nt!==(0|nt)&&(st=!0),bt.push({minor:st,value:nt})}if(at&&function(or,ar,Nt){for(var nr=0;nr<or.length;nr++){var Lr=or[nr].value,dr=nr,Kt=nr+1;nr<or.length-1?(dr=nr,Kt=nr+1):nr>0?(dr=nr-1,Kt=nr):(dr=nr,Kt=nr);var yr,xr=or[dr].value,gr=or[Kt].value,wr=Math.abs(gr-xr),zr=Nt||wr,Rr=0;zr>=m?Rr=wr>=m&&wr<=d?wr:g:Nt===v&&zr>=T?Rr=wr>=T&&wr<=y?wr:v:zr>=E?Rr=wr>=E&&wr<=_?wr:k:Nt===A&&zr>=A?Rr=A:zr>=b?Rr=b:Nt===L&&zr>=L?Rr=L:Nt===w&&zr>=w&&(Rr=w),Rr>=wr&&(Rr=wr,yr=!0);var Wr=Lr+Rr;if(ar.rangebreaks&&Rr>0){for(var gn=0,rn=0;rn<84;rn++){var Zr=(rn+.5)/84;ar.maskBreaks(Lr*(1-Zr)+Zr*Wr)!==z&&gn++}(Rr*=gn/84)||(or[nr].drop=!0),yr&&wr>A&&(Rr=wr)}(Rr>0||nr===0)&&(or[nr].periodX=Lr+Rr/2)}}(bt,je,je._definedDelta),je.rangebreaks){var It=je._id.charAt(0)==="y",jt=1;je.tickmode==="auto"&&(jt=je.tickfont?je.tickfont.size:12);var Ut=NaN;for(xt=bt.length-1;xt>-1;xt--)if(bt[xt].drop)bt.splice(xt,1);else{bt[xt].value=Mt(bt[xt].value,je);var zt=je.c2p(bt[xt].value);(It?Ut>zt-jt:Ut<zt+jt)?bt.splice(Pe?xt+1:xt,1):Ut=zt}}Ke(je)&&Math.abs(Ct[1]-Ct[0])===360&&bt.pop(),je._tmax=(bt[bt.length-1]||{}).value,je._prevDateHead="",je._inCalcTicks=!0;var Ce,lt,At=[];for(xt=0;xt<bt.length;xt++){var Bt=bt[xt].minor,Ht=bt[xt].value;Ce=D.tickText(je,Ht,!1,Bt),(lt=bt[xt].periodX)!==void 0&&(Ce.periodX=lt,(lt>qe||lt<ze)&&(lt>qe&&(Ce.periodX=qe),lt<ze&&(Ce.periodX=ze),Ce.text=" ",je._prevDateHead="")),At.push(Ce)}return je._inCalcTicks=!1,At};var de=[2,5,10],ce=[1,2,3,6,12],ve=[1,2,5,10,15,30],Ee=[1,2,3,7,14],Le=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],Te=[-.301,0,.301,.699,1],xe=[15,30,45,90,180];function fe(je,Ge,Ct){return Ge*e.roundUp(je/Ge,Ct)}function ge(je){var Ge=je.dtick;if(je._tickexponent=0,h(Ge)||typeof Ge=="string"||(Ge=1),je.type!=="category"&&je.type!=="multicategory"||(je._tickround=null),je.type==="date"){var Ct=je.r2l(je.tick0),Ie=je.l2r(Ct).replace(/(^-|i)/g,""),be=Ie.length;if(String(Ge).charAt(0)==="M")be>10||Ie.substr(5)!=="01-01"?je._tickround="d":je._tickround=+Ge.substr(1)%12==0?"y":"m";else if(Ge>=b&&be<=10||Ge>=15*b)je._tickround="d";else if(Ge>=C&&be<=16||Ge>=w)je._tickround="M";else if(Ge>=S&&be<=19||Ge>=C)je._tickround="S";else{var Ae=je.l2r(Ct+Ge).replace(/^-/,"").length;je._tickround=Math.max(be,Ae)-20,je._tickround<0&&(je._tickround=4)}}else if(h(Ge)||Ge.charAt(0)==="L"){var Pe=je.range.map(je.r2d||Number);h(Ge)||(Ge=Number(Ge.substr(1))),je._tickround=2-Math.floor(Math.log(Ge)/Math.LN10+.01);var ze=Math.max(Math.abs(Pe[0]),Math.abs(Pe[1])),qe=Math.floor(Math.log(ze)/Math.LN10+.01),ht=je.minexponent===void 0?3:je.minexponent;Math.abs(qe)>ht&&(Se(je.exponentformat)&&!De(qe)?je._tickexponent=3*Math.round((qe-1)/3):je._tickexponent=qe)}else je._tickround=null}function ke(je,Ge,Ct){var Ie=je.tickfont||{};return{x:Ge,dx:0,dy:0,text:Ct||"",fontSize:Ie.size,font:Ie.family,fontColor:Ie.color}}D.autoTicks=function(je,Ge){var Ct;function Ie(at){return Math.pow(at,Math.floor(Math.log(Ge)/Math.LN10))}if(je.type==="date"){je.tick0=e.dateTick0(je.calendar,0);var be=2*Ge;if(be>g)Ge/=g,Ct=Ie(10),je.dtick="M"+12*fe(Ge,Ct,de);else if(be>k)Ge/=k,je.dtick="M"+fe(Ge,1,ce);else if(be>b){je.dtick=fe(Ge,b,je._hasDayOfWeekBreaks?[1,2,7,14]:Ee);var Ae=D.getTickFormat(je),Pe=je.ticklabelmode==="period";Pe&&(je._rawTick0=je.tick0),/%[uVW]/.test(Ae)?je.tick0=e.dateTick0(je.calendar,2):je.tick0=e.dateTick0(je.calendar,1),Pe&&(je._dowTick0=je.tick0)}else be>w?je.dtick=fe(Ge,w,ce):be>C?je.dtick=fe(Ge,C,ve):be>S?je.dtick=fe(Ge,S,ve):(Ct=Ie(10),je.dtick=fe(Ge,Ct,de))}else if(je.type==="log"){je.tick0=0;var ze=e.simpleMap(je.range,je.r2l);if(Ge>.7)je.dtick=Math.ceil(Ge);else if(Math.abs(ze[1]-ze[0])<1){var qe=1.5*Math.abs((ze[1]-ze[0])/Ge);Ge=Math.abs(Math.pow(10,ze[1])-Math.pow(10,ze[0]))/qe,Ct=Ie(10),je.dtick="L"+fe(Ge,Ct,de)}else je.dtick=Ge>.3?"D2":"D1"}else je.type==="category"||je.type==="multicategory"?(je.tick0=0,je.dtick=Math.ceil(Math.max(Ge,1))):Ke(je)?(je.tick0=0,Ct=1,je.dtick=fe(Ge,Ct,xe)):(je.tick0=0,Ct=Ie(10),je.dtick=fe(Ge,Ct,de));if(je.dtick===0&&(je.dtick=1),!h(je.dtick)&&typeof je.dtick!="string"){var ht=je.dtick;throw je.dtick=1,"ax.dtick error: "+String(ht)}},D.tickIncrement=function(je,Ge,Ct,Ie){var be=Ct?-1:1;if(h(Ge))return e.increment(je,be*Ge);var Ae=Ge.charAt(0),Pe=be*Number(Ge.substr(1));if(Ae==="M")return e.incrementMonth(je,Pe,Ie);if(Ae==="L")return Math.log(Math.pow(10,je)+Pe)/Math.LN10;if(Ae==="D"){var ze=Ge==="D2"?Te:Le,qe=je+.01*be,ht=e.roundUp(e.mod(qe,1),ze,Ct);return Math.floor(qe)+Math.log(t.round(Math.pow(10,ht),1))/Math.LN10}throw"unrecognized dtick "+String(Ge)},D.tickFirst=function(je,Ge){var Ct=je.r2l||Number,Ie=e.simpleMap(je.range,Ct,void 0,void 0,Ge),be=Ie[1]<Ie[0],Ae=be?Math.floor:Math.ceil,Pe=ne(Ie)[0],ze=je.dtick,qe=Ct(je.tick0);if(h(ze)){var ht=Ae((Pe-qe)/ze)*ze+qe;return je.type!=="category"&&je.type!=="multicategory"||(ht=e.constrain(ht,0,je._categories.length-1)),ht}var at=ze.charAt(0),nt=Number(ze.substr(1));if(at==="M"){for(var xt,Lt,bt,St=0,st=qe;St<10;){if(((xt=D.tickIncrement(st,ze,be,je.calendar))-Pe)*(st-Pe)<=0)return be?Math.min(st,xt):Math.max(st,xt);Lt=(Pe-(st+xt)/2)/(xt-st),bt=at+(Math.abs(Math.round(Lt))||1)*nt,st=D.tickIncrement(st,bt,Lt<0?!be:be,je.calendar),St++}return e.error("tickFirst did not converge",je),st}if(at==="L")return Math.log(Ae((Math.pow(10,Pe)-qe)/nt)*nt+qe)/Math.LN10;if(at==="D"){var It=ze==="D2"?Te:Le,jt=e.roundUp(e.mod(Pe,1),It,be);return Math.floor(Pe)+Math.log(t.round(Math.pow(10,jt),1))/Math.LN10}throw"unrecognized dtick "+String(ze)},D.tickText=function(je,Ge,Ct,Ie){var be,Ae=ke(je,Ge),Pe=je.tickmode==="array",ze=Ct||Pe,qe=je.type,ht=qe==="category"?je.d2l_noadd:je.d2l;if(Pe&&Array.isArray(je.ticktext)){var at=e.simpleMap(je.range,je.r2l),nt=(Math.abs(at[1]-at[0])-(je._lBreaks||0))/1e4;for(be=0;be<je.ticktext.length&&!(Math.abs(Ge-ht(je.tickvals[be]))<nt);be++);if(be<je.ticktext.length)return Ae.text=String(je.ticktext[be]),Ae}function xt(St){if(St===void 0)return!0;if(Ct)return St==="none";var st={first:je._tmin,last:je._tmax}[St];return St!=="all"&&Ge!==st}var Lt=Ct?"never":je.exponentformat!=="none"&&xt(je.showexponent)?"hide":"";if(qe==="date"?function(St,st,It,jt){var Ut=St._tickround,zt=It&&St.hoverformat||D.getTickFormat(St);jt&&(Ut=h(Ut)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[Ut]);var Ce,lt=e.formatDate(st.x,zt,Ut,St._dateFormat,St.calendar,St._extraFormat),At=lt.indexOf(`
`);if(At!==-1&&(Ce=lt.substr(At+1),lt=lt.substr(0,At)),jt&&(lt==="00:00:00"||lt==="00:00"?(lt=Ce,Ce=""):lt.length===8&&(lt=lt.replace(/:00$/,""))),Ce)if(It)Ut==="d"?lt+=", "+Ce:lt=Ce+(lt?", "+lt:"");else if(St._inCalcTicks&&St._prevDateHead===Ce){var Bt=Jt(St),Ht=St._realSide||St.side;(!Bt&&Ht==="top"||Bt&&Ht==="bottom")&&(lt+="<br> ")}else St._prevDateHead=Ce,lt+="<br>"+Ce;st.text=lt}(je,Ae,Ct,ze):qe==="log"?function(St,st,It,jt,Ut){var zt=St.dtick,Ce=st.x,lt=St.tickformat,At=typeof zt=="string"&&zt.charAt(0);if(Ut==="never"&&(Ut=""),jt&&At!=="L"&&(zt="L3",At="L"),lt||At==="L")st.text=Be(Math.pow(10,Ce),St,Ut,jt);else if(h(zt)||At==="D"&&e.mod(Ce+.01,1)<.1){var Bt=Math.round(Ce),Ht=Math.abs(Bt),or=St.exponentformat;or==="power"||Se(or)&&De(Bt)?(st.text=Bt===0?1:Bt===1?"10":"10<sup>"+(Bt>1?"":P)+Ht+"</sup>",st.fontSize*=1.25):(or==="e"||or==="E")&&Ht>2?st.text="1"+or+(Bt>0?"+":P)+Ht:(st.text=Be(Math.pow(10,Ce),St,"","fakehover"),zt==="D1"&&St._id.charAt(0)==="y"&&(st.dy-=st.fontSize/6))}else{if(At!=="D")throw"unrecognized dtick "+String(zt);st.text=String(Math.round(Math.pow(10,e.mod(Ce,1)))),st.fontSize*=.75}if(St.dtick==="D1"){var ar=String(st.text).charAt(0);ar!=="0"&&ar!=="1"||(St._id.charAt(0)==="y"?st.dx-=st.fontSize/4:(st.dy+=st.fontSize/2,st.dx+=(St.range[1]>St.range[0]?1:-1)*st.fontSize*(Ce<0?.5:.25)))}}(je,Ae,0,ze,Lt):qe==="category"?function(St,st){var It=St._categories[Math.round(st.x)];It===void 0&&(It=""),st.text=String(It)}(je,Ae):qe==="multicategory"?function(St,st,It){var jt=Math.round(st.x),Ut=St._categories[jt]||[],zt=Ut[1]===void 0?"":String(Ut[1]),Ce=Ut[0]===void 0?"":String(Ut[0]);It?st.text=Ce+" - "+zt:(st.text=zt,st.text2=Ce)}(je,Ae,Ct):Ke(je)?function(St,st,It,jt,Ut){if(St.thetaunit!=="radians"||It)st.text=Be(st.x,St,Ut,jt);else{var zt=st.x/180;if(zt===0)st.text="0";else{var Ce=function(At){function Bt(Nt,nr){return Math.abs(Nt-nr)<=1e-6}var Ht=function(Nt){for(var nr=1;!Bt(Math.round(Nt*nr)/nr,Nt);)nr*=10;return nr}(At),or=At*Ht,ar=Math.abs(function Nt(nr,Lr){return Bt(Lr,0)?nr:Nt(Lr,nr%Lr)}(or,Ht));return[Math.round(or/ar),Math.round(Ht/ar)]}(zt);if(Ce[1]>=100)st.text=Be(e.deg2rad(st.x),St,Ut,jt);else{var lt=st.x<0;Ce[1]===1?Ce[0]===1?st.text="π":st.text=Ce[0]+"π":st.text=["<sup>",Ce[0],"</sup>","⁄","<sub>",Ce[1],"</sub>","π"].join(""),lt&&(st.text=P+st.text)}}}}(je,Ae,Ct,ze,Lt):function(St,st,It,jt,Ut){Ut==="never"?Ut="":St.showexponent==="all"&&Math.abs(st.x/St.dtick)<1e-6&&(Ut="hide"),st.text=Be(st.x,St,Ut,jt)}(je,Ae,0,ze,Lt),Ie||(je.tickprefix&&!xt(je.showtickprefix)&&(Ae.text=je.tickprefix+Ae.text),je.ticksuffix&&!xt(je.showticksuffix)&&(Ae.text+=je.ticksuffix)),je.tickson==="boundaries"||je.showdividers){var bt=function(St){var st=je.l2p(St);return st>=0&&st<=je._length?St:null};Ae.xbnd=[bt(Ae.x-.5),bt(Ae.x+je.dtick-.5)]}return Ae},D.hoverLabelText=function(je,Ge,Ct){Ct&&(je=e.extendFlat({},je,{hoverformat:Ct}));var Ie=Array.isArray(Ge)?Ge[0]:Ge,be=Array.isArray(Ge)?Ge[1]:void 0;if(be!==void 0&&be!==Ie)return D.hoverLabelText(je,Ie,Ct)+" - "+D.hoverLabelText(je,be,Ct);var Ae=je.type==="log"&&Ie<=0,Pe=D.tickText(je,je.c2l(Ae?-Ie:Ie),"hover").text;return Ae?Ie===0?"0":P+Pe:Pe};var Me=["f","p","n","μ","m","","k","M","G","T"];function Se(je){return je==="SI"||je==="B"}function De(je){return je>14||je<-15}function Be(je,Ge,Ct,Ie){var be=je<0,Ae=Ge._tickround,Pe=Ct||Ge.exponentformat||"B",ze=Ge._tickexponent,qe=D.getTickFormat(Ge),ht=Ge.separatethousands;if(Ie){var at={exponentformat:Pe,minexponent:Ge.minexponent,dtick:Ge.showexponent==="none"?Ge.dtick:h(je)&&Math.abs(je)||1,range:Ge.showexponent==="none"?Ge.range.map(Ge.r2d):[0,je||1]};ge(at),Ae=(Number(at._tickround)||0)+4,ze=at._tickexponent,Ge.hoverformat&&(qe=Ge.hoverformat)}if(qe)return Ge._numFormat(qe)(je).replace(/-/g,P);var nt,xt=Math.pow(10,-Ae)/2;if(Pe==="none"&&(ze=0),(je=Math.abs(je))<xt)je="0",be=!1;else{if(je+=xt,ze&&(je*=Math.pow(10,-ze),Ae+=ze),Ae===0)je=String(Math.floor(je));else if(Ae<0){je=(je=String(Math.round(je))).substr(0,je.length+Ae);for(var Lt=Ae;Lt<0;Lt++)je+="0"}else{var bt=(je=String(je)).indexOf(".")+1;bt&&(je=je.substr(0,bt+Ae).replace(/\.?0+$/,""))}je=e.numSeparate(je,Ge._separators,ht)}return ze&&Pe!=="hide"&&(Se(Pe)&&De(ze)&&(Pe="power"),nt=ze<0?P+-ze:Pe!=="power"?"+"+ze:String(ze),Pe==="e"||Pe==="E"?je+=Pe+nt:Pe==="power"?je+="×10<sup>"+nt+"</sup>":Pe==="B"&&ze===9?je+="B":Se(Pe)&&(je+=Me[ze/3+5])),be?P+je:je}function We(je,Ge){for(var Ct=[],Ie={},be=0;be<Ge.length;be++){var Ae=Ge[be];Ie[Ae.text2]?Ie[Ae.text2].push(Ae.x):Ie[Ae.text2]=[Ae.x]}for(var Pe in Ie)Ct.push(ke(je,e.interp(Ie[Pe],.5),Pe));return Ct}function Qe(je){return je.periodX!==void 0?je.periodX:je.x}function Oe(je){return[je.text,je.x,je.axInfo,je.font,je.fontSize,je.fontColor].join("_")}function Ue(je){var Ge=je.title.font.size,Ct=(je.title.text.match(o.BR_TAG_ALL)||[]).length;return je.title.hasOwnProperty("standoff")?Ct?Ge*(Y+Ct*N):Ge*Y:Ct?Ge*(Ct+1)*N:Ge}function Xe(je,Ge){var Ct=je.l2p(Ge);return Ct>1&&Ct<je._length-1}function Ye(je){var Ge=t.select(je),Ct=Ge.select(".text-math-group");return Ct.empty()?Ge.select("text"):Ct}function $e(je){return je._id+".automargin"}function it(je){return $e(je)+".mirror"}function ot(je){return je._id+".rangeslider"}function Et(je,Ge){for(var Ct=0;Ct<Ge.length;Ct++)je.indexOf(Ge[Ct])===-1&&je.push(Ge[Ct])}function mt(je,Ge,Ct){var Ie,be,Ae=[],Pe=[],ze=je.layout;for(Ie=0;Ie<Ge.length;Ie++)Ae.push(D.getFromId(je,Ge[Ie]));for(Ie=0;Ie<Ct.length;Ie++)Pe.push(D.getFromId(je,Ct[Ie]));var qe=Object.keys(r),ht=["anchor","domain","overlaying","position","side","tickangle","editType"],at=["linear","log"];for(Ie=0;Ie<qe.length;Ie++){var nt=qe[Ie],xt=Ae[0][nt],Lt=Pe[0][nt],bt=!0,St=!1,st=!1;if(nt.charAt(0)!=="_"&&typeof xt!="function"&&ht.indexOf(nt)===-1){for(be=1;be<Ae.length&&bt;be++){var It=Ae[be][nt];nt==="type"&&at.indexOf(xt)!==-1&&at.indexOf(It)!==-1&&xt!==It?St=!0:It!==xt&&(bt=!1)}for(be=1;be<Pe.length&&bt;be++){var jt=Pe[be][nt];nt==="type"&&at.indexOf(Lt)!==-1&&at.indexOf(jt)!==-1&&Lt!==jt?st=!0:Pe[be][nt]!==Lt&&(bt=!1)}bt&&(St&&(ze[Ae[0]._name].type="linear"),st&&(ze[Pe[0]._name].type="linear"),tt(ze,nt,Ae,Pe,je._fullLayout._dfltTitle))}}for(Ie=0;Ie<je._fullLayout.annotations.length;Ie++){var Ut=je._fullLayout.annotations[Ie];Ge.indexOf(Ut.xref)!==-1&&Ct.indexOf(Ut.yref)!==-1&&e.swapAttrs(ze.annotations[Ie],["?"])}}function tt(je,Ge,Ct,Ie,be){var Ae,Pe=e.nestedProperty,ze=Pe(je[Ct[0]._name],Ge).get(),qe=Pe(je[Ie[0]._name],Ge).get();for(Ge==="title"&&(ze&&ze.text===be.x&&(ze.text=be.y),qe&&qe.text===be.y&&(qe.text=be.x)),Ae=0;Ae<Ct.length;Ae++)Pe(je,Ct[Ae]._name+"."+Ge).set(qe);for(Ae=0;Ae<Ie.length;Ae++)Pe(je,Ie[Ae]._name+"."+Ge).set(ze)}function Ke(je){return je._id==="angularaxis"}function Mt(je,Ge){for(var Ct=Ge._rangebreaks.length,Ie=0;Ie<Ct;Ie++){var be=Ge._rangebreaks[Ie];if(je>=be.min&&je<be.max)return be.max}return je}function Jt(je){return(je.ticklabelposition||"").indexOf("inside")!==-1}function $t(je,Ge){Jt(je._anchorAxis||{})&&je._hideCounterAxisInsideTickLabels&&je._hideCounterAxisInsideTickLabels(Ge)}D.getTickFormat=function(je){var Ge,Ct,Ie,be,Ae,Pe,ze,qe;function ht(xt){return typeof xt!="string"?xt:Number(xt.replace("M",""))*k}function at(xt,Lt){var bt=["L","D"];if(typeof xt==typeof Lt){if(typeof xt=="number")return xt-Lt;var St=bt.indexOf(xt.charAt(0)),st=bt.indexOf(Lt.charAt(0));return St===st?Number(xt.replace(/(L|D)/g,""))-Number(Lt.replace(/(L|D)/g,"")):St-st}return typeof xt=="number"?1:-1}function nt(xt,Lt){var bt=Lt[0]===null,St=Lt[1]===null,st=at(xt,Lt[0])>=0,It=at(xt,Lt[1])<=0;return(bt||st)&&(St||It)}if(je.tickformatstops&&je.tickformatstops.length>0)switch(je.type){case"date":case"linear":for(Ge=0;Ge<je.tickformatstops.length;Ge++)if((Ie=je.tickformatstops[Ge]).enabled&&(be=je.dtick,Ae=Ie.dtickrange,Pe=void 0,ze=void 0,qe=void 0,Pe=ht||function(xt){return xt},ze=Ae[0],qe=Ae[1],(!ze&&typeof ze!="number"||Pe(ze)<=Pe(be))&&(!qe&&typeof qe!="number"||Pe(qe)>=Pe(be)))){Ct=Ie;break}break;case"log":for(Ge=0;Ge<je.tickformatstops.length;Ge++)if((Ie=je.tickformatstops[Ge]).enabled&&nt(je.dtick,Ie.dtickrange)){Ct=Ie;break}}return Ct?Ct.value:je.tickformat},D.getSubplots=function(je,Ge){var Ct=je._fullLayout._subplots,Ie=Ct.cartesian.concat(Ct.gl2d||[]),be=Ge?D.findSubplotsWithAxis(Ie,Ge):Ie;return be.sort(function(Ae,Pe){var ze=Ae.substr(1).split("y"),qe=Pe.substr(1).split("y");return ze[0]===qe[0]?+ze[1]-+qe[1]:+ze[0]-+qe[0]}),be},D.findSubplotsWithAxis=function(je,Ge){for(var Ct=new RegExp(Ge._id.charAt(0)==="x"?"^"+Ge._id+"y":Ge._id+"$"),Ie=[],be=0;be<je.length;be++){var Ae=je[be];Ct.test(Ae)&&Ie.push(Ae)}return Ie},D.makeClipPaths=function(je){var Ge=je._fullLayout;if(!Ge._hasOnlyLargeSploms){var Ct,Ie,be={_offset:0,_length:Ge.width,_id:""},Ae={_offset:0,_length:Ge.height,_id:""},Pe=D.list(je,"x",!0),ze=D.list(je,"y",!0),qe=[];for(Ct=0;Ct<Pe.length;Ct++)for(qe.push({x:Pe[Ct],y:Ae}),Ie=0;Ie<ze.length;Ie++)Ct===0&&qe.push({x:be,y:ze[Ie]}),qe.push({x:Pe[Ct],y:ze[Ie]});var ht=Ge._clips.selectAll(".axesclip").data(qe,function(at){return at.x._id+at.y._id});ht.enter().append("clipPath").classed("axesclip",!0).attr("id",function(at){return"clip"+Ge._uid+at.x._id+at.y._id}).append("rect"),ht.exit().remove(),ht.each(function(at){t.select(this).select("rect").attr({x:at.x._offset||0,y:at.y._offset||0,width:at.x._length||1,height:at.y._length||1})})}},D.draw=function(je,Ge,Ct){var Ie=je._fullLayout;Ge==="redraw"&&Ie._paper.selectAll("g.subplot").each(function(Ae){var Pe=Ae[0],ze=Ie._plots[Pe];if(ze){var qe=ze.xaxis,ht=ze.yaxis;ze.xaxislayer.selectAll("."+qe._id+"tick").remove(),ze.yaxislayer.selectAll("."+ht._id+"tick").remove(),ze.xaxislayer.selectAll("."+qe._id+"tick2").remove(),ze.yaxislayer.selectAll("."+ht._id+"tick2").remove(),ze.xaxislayer.selectAll("."+qe._id+"divider").remove(),ze.yaxislayer.selectAll("."+ht._id+"divider").remove(),ze.gridlayer&&ze.gridlayer.selectAll("path").remove(),ze.zerolinelayer&&ze.zerolinelayer.selectAll("path").remove(),Ie._infolayer.select(".g-"+qe._id+"title").remove(),Ie._infolayer.select(".g-"+ht._id+"title").remove()}});var be=Ge&&Ge!=="redraw"?Ge:D.listIds(je);return e.syncOrAsync(be.map(function(Ae){return function(){if(Ae){var Pe=D.getFromId(je,Ae),ze=D.drawOne(je,Pe,Ct);return Pe._r=Pe.range.slice(),Pe._rl=e.simpleMap(Pe._r,Pe.r2l),ze}}}))},D.drawOne=function(je,Ge,Ct){var Ie,be,Ae;Ct=Ct||{},Ge.setScale();var Pe=je._fullLayout,ze=Ge._id,qe=ze.charAt(0),ht=D.counterLetter(ze),at=Pe._plots[Ge._mainSubplot];if(at){var nt=at[qe+"axislayer"],xt=Ge._mainLinePosition,Lt=Ge._mainMirrorPosition,bt=Ge._vals=D.calcTicks(Ge),St=[Ge.mirror,xt,Lt].join("_");for(Ie=0;Ie<bt.length;Ie++)bt[Ie].axInfo=St;Ge._selections={},Ge._tickAngles&&(Ge._prevTickAngles=Ge._tickAngles),Ge._tickAngles={},Ge._depth=null;var st={};if(Ge.visible){var It,jt,Ut=D.makeTransTickFn(Ge),zt=D.makeTransTickLabelFn(Ge),Ce=Ge.ticks==="inside",lt=Ge.ticks==="outside";if(Ge.tickson==="boundaries"){var At=function(Dr,br){var Xr,fn=[],Qr=function(un,Pn){var kn=un.xbnd[Pn];kn!==null&&fn.push(e.extendFlat({},un,{x:kn}))};if(br.length){for(Xr=0;Xr<br.length;Xr++)Qr(br[Xr],0);Qr(br[Xr-1],1)}return fn}(0,bt);jt=D.clipEnds(Ge,At),It=Ce?jt:At}else jt=D.clipEnds(Ge,bt),It=Ce&&Ge.ticklabelmode!=="period"?jt:bt;var Bt=Ge._gridVals=jt,Ht=function(Dr,br){var Xr,fn,Qr=[],un=br.length&&br[br.length-1].x<br[0].x,Pn=function(Hn,aa){var gt=Hn.xbnd[aa];gt!==null&&Qr.push(e.extendFlat({},Hn,{x:gt}))};if(Dr.showdividers&&br.length){for(Xr=0;Xr<br.length;Xr++){var kn=br[Xr];kn.text2!==fn&&Pn(kn,un?1:0),fn=kn.text2}Pn(br[Xr-1],un?0:1)}return Qr}(Ge,bt);if(!Pe._hasOnlyLargeSploms){var or=Ge._subplotsWith,ar={};for(Ie=0;Ie<or.length;Ie++){be=or[Ie];var Nt=(Ae=Pe._plots[be])[ht+"axis"],nr=Nt._mainAxis._id;if(!ar[nr]){ar[nr]=1;var Lr=qe==="x"?"M0,"+Nt._offset+"v"+Nt._length:"M"+Nt._offset+",0h"+Nt._length;D.drawGrid(je,Ge,{vals:Bt,counterAxis:Nt,layer:Ae.gridlayer.select("."+ze),path:Lr,transFn:Ut}),D.drawZeroLine(je,Ge,{counterAxis:Nt,layer:Ae.zerolinelayer,path:Lr,transFn:Ut})}}}var dr=D.getTickSigns(Ge),Kt=[];if(Ge.ticks){var yr,xr,gr,wr=D.makeTickPath(Ge,xt,dr[2]);if(Ge._anchorAxis&&Ge.mirror&&Ge.mirror!==!0?(yr=D.makeTickPath(Ge,Lt,dr[3]),xr=wr+yr):(yr="",xr=wr),Ge.showdividers&&lt&&Ge.tickson==="boundaries"){var zr={};for(Ie=0;Ie<Ht.length;Ie++)zr[Ht[Ie].x]=1;gr=function(Dr){return zr[Dr.x]?yr:xr}}else gr=xr;D.drawTicks(je,Ge,{vals:It,layer:nt,path:gr,transFn:Ut}),Ge.mirror==="allticks"&&(Kt=Object.keys(Ge._linepositions||{}))}for(Ie=0;Ie<Kt.length;Ie++){be=Kt[Ie],Ae=Pe._plots[be];var Rr=Ge._linepositions[be]||[],Wr=D.makeTickPath(Ge,Rr[0],dr[0])+D.makeTickPath(Ge,Rr[1],dr[1]);D.drawTicks(je,Ge,{vals:It,layer:Ae[qe+"axislayer"],path:Wr,transFn:Ut})}var gn=[];if(gn.push(function(){return D.drawLabels(je,Ge,{vals:bt,layer:nt,plotinfo:Ae,transFn:zt,labelFns:D.makeLabelFns(Ge,xt)})}),Ge.type==="multicategory"){var rn={x:2,y:10}[qe];gn.push(function(){var Dr={x:"height",y:"width"}[qe],br=bn()[Dr]+rn+(Ge._tickAngles[ze+"tick"]?Ge.tickfont.size*N:0);return D.drawLabels(je,Ge,{vals:We(Ge,bt),layer:nt,cls:ze+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:Ut,labelFns:D.makeLabelFns(Ge,xt+br*dr[4])})}),gn.push(function(){return Ge._depth=dr[4]*(bn("tick2")[Ge.side]-xt),function(Dr,br,Xr){var fn=br._id+"divider",Qr=Xr.vals,un=Xr.layer.selectAll("path."+fn).data(Qr,Oe);un.exit().remove(),un.enter().insert("path",":first-child").classed(fn,1).classed("crisp",1).call(n.stroke,br.dividercolor).style("stroke-width",s.crispRound(Dr,br.dividerwidth,1)+"px"),un.attr("transform",Xr.transFn).attr("d",Xr.path)}(je,Ge,{vals:Ht,layer:nt,path:D.makeTickPath(Ge,xt,dr[4],Ge._depth),transFn:Ut})})}else Ge.title.hasOwnProperty("standoff")&&gn.push(function(){Ge._depth=dr[4]*(bn()[Ge.side]-xt)});var Zr=u.getComponentMethod("rangeslider","isVisible")(Ge);return gn.push(function(){var Dr,br,Xr,fn,Qr=Ge.side.charAt(0),un=J[Ge.side].charAt(0),Pn=D.getPxPosition(je,Ge),kn=lt?Ge.ticklen:0;if((Ge.automargin||Zr)&&(Ge.type==="multicategory"?Dr=bn("tick2"):(Dr=bn(),qe==="x"&&Qr==="b"&&(Ge._depth=Math.max(Dr.width>0?Dr.bottom-Pn:0,kn)))),Ge.automargin){br={x:0,y:0,r:0,l:0,t:0,b:0};var Hn=[0,1];if(qe==="x"){if(Qr==="b"?br[Qr]=Ge._depth:(br[Qr]=Ge._depth=Math.max(Dr.width>0?Pn-Dr.top:0,kn),Hn.reverse()),Dr.width>0){var aa=Dr.right-(Ge._offset+Ge._length);aa>0&&(br.xr=1,br.r=aa);var gt=Ge._offset-Dr.left;gt>0&&(br.xl=0,br.l=gt)}}else if(Qr==="l"?br[Qr]=Ge._depth=Math.max(Dr.height>0?Pn-Dr.left:0,kn):(br[Qr]=Ge._depth=Math.max(Dr.height>0?Dr.right-Pn:0,kn),Hn.reverse()),Dr.height>0){var Qt=Dr.bottom-(Ge._offset+Ge._length);Qt>0&&(br.yb=0,br.b=Qt);var Zt=Ge._offset-Dr.top;Zt>0&&(br.yt=1,br.t=Zt)}br[ht]=Ge.anchor==="free"?Ge.position:Ge._anchorAxis.domain[Hn[0]],Ge.title.text!==Pe._dfltTitle[qe]&&(br[Qr]+=Ue(Ge)+(Ge.title.standoff||0)),Ge.mirror&&Ge.anchor!=="free"&&((Xr={x:0,y:0,r:0,l:0,t:0,b:0})[un]=Ge.linewidth,Ge.mirror&&Ge.mirror!==!0&&(Xr[un]+=kn),Ge.mirror===!0||Ge.mirror==="ticks"?Xr[ht]=Ge._anchorAxis.domain[Hn[1]]:Ge.mirror!=="all"&&Ge.mirror!=="allticks"||(Xr[ht]=[Ge._counterDomainMin,Ge._counterDomainMax][Hn[1]]))}Zr&&(fn=u.getComponentMethod("rangeslider","autoMarginOpts")(je,Ge)),p.autoMargin(je,$e(Ge),br),p.autoMargin(je,it(Ge),Xr),p.autoMargin(je,ot(Ge),fn)}),Ct.skipTitle||Zr&&Ge.side==="bottom"||gn.push(function(){return function(Dr,br){var Xr,fn=Dr._fullLayout,Qr=br._id,un=Qr.charAt(0),Pn=br.title.font.size;if(br.title.hasOwnProperty("standoff"))Xr=br._depth+br.title.standoff+Ue(br);else{var kn=Jt(br);if(br.type==="multicategory")Xr=br._depth;else{var Hn=1.5*Pn;kn&&(Hn=.5*Pn,br.ticks==="outside"&&(Hn+=br.ticklen)),Xr=10+Hn+(br.linewidth?br.linewidth-1:0)}kn||(Xr+=un==="x"?br.side==="top"?Pn*(br.showticklabels?1:0):Pn*(br.showticklabels?1.5:.5):br.side==="right"?Pn*(br.showticklabels?1:.5):Pn*(br.showticklabels?.5:0))}var aa,gt,Qt,Zt,pr=D.getPxPosition(Dr,br);if(un==="x"?(gt=br._offset+br._length/2,Qt=br.side==="top"?pr-Xr:pr+Xr):(Qt=br._offset+br._length/2,gt=br.side==="right"?pr+Xr:pr-Xr,aa={rotate:"-90",offset:0}),br.type!=="multicategory"){var Mr=br._selections[br._id+"tick"];if(Zt={selection:Mr,side:br.side},Mr&&Mr.node()&&Mr.node().parentNode){var Vr=s.getTranslate(Mr.node().parentNode);Zt.offsetLeft=Vr.x,Zt.offsetTop=Vr.y}br.title.hasOwnProperty("standoff")&&(Zt.pad=0)}return a.draw(Dr,Qr+"title",{propContainer:br,propName:br._name+".title.text",placeholder:fn._dfltTitle[un],avoid:Zt,transform:aa,attributes:{x:gt,y:Qt,"text-anchor":"middle"}})}(je,Ge)}),e.syncOrAsync(gn)}}function bn(Dr){var br=ze+(Dr||"tick");return st[br]||(st[br]=function(Xr,fn){var Qr,un,Pn,kn;return Xr._selections[fn].size()?(Qr=1/0,un=-1/0,Pn=1/0,kn=-1/0,Xr._selections[fn].each(function(){var Hn=Ye(this),aa=s.bBox(Hn.node().parentNode);Qr=Math.min(Qr,aa.top),un=Math.max(un,aa.bottom),Pn=Math.min(Pn,aa.left),kn=Math.max(kn,aa.right)})):(Qr=0,un=0,Pn=0,kn=0),{top:Qr,bottom:un,left:Pn,right:kn,height:un-Qr,width:kn-Pn}}(Ge,br)),st[br]}},D.getTickSigns=function(je){var Ge=je._id.charAt(0),Ct={x:"top",y:"right"}[Ge],Ie=je.side===Ct?1:-1,be=[-1,1,Ie,-Ie];return je.ticks!=="inside"==(Ge==="x")&&(be=be.map(function(Ae){return-Ae})),je.side&&be.push({l:-1,t:-1,r:1,b:1}[je.side.charAt(0)]),be},D.makeTransTickFn=function(je){return je._id.charAt(0)==="x"?function(Ge){return l(je._offset+je.l2p(Ge.x),0)}:function(Ge){return l(0,je._offset+je.l2p(Ge.x))}},D.makeTransTickLabelFn=function(je){var Ge=function(be){var Ae=be.ticklabelposition||"",Pe=function(It){return Ae.indexOf(It)!==-1},ze=Pe("top"),qe=Pe("left"),ht=Pe("right"),at=Pe("bottom"),nt=Pe("inside"),xt=at||qe||ze||ht;if(!xt&&!nt)return[0,0];var Lt=be.side,bt=xt?(be.tickwidth||0)/2:0,St=3,st=be.tickfont?be.tickfont.size:12;return(at||ze)&&(bt+=st*Y,St+=(be.linewidth||0)/2),(qe||ht)&&(bt+=(be.linewidth||0)/2,St+=3),nt&&Lt==="top"&&(St-=st*(1-Y)),(qe||ze)&&(bt=-bt),Lt!=="bottom"&&Lt!=="right"||(St=-St),[xt?bt:0,nt?St:0]}(je),Ct=Ge[0],Ie=Ge[1];return je._id.charAt(0)==="x"?function(be){return l(Ct+je._offset+je.l2p(Qe(be)),Ie)}:function(be){return l(Ie,Ct+je._offset+je.l2p(Qe(be)))}},D.makeTickPath=function(je,Ge,Ct,Ie){Ie=Ie!==void 0?Ie:je.ticklen;var be=je._id.charAt(0),Ae=(je.linewidth||1)/2;return be==="x"?"M0,"+(Ge+Ae*Ct)+"v"+Ie*Ct:"M"+(Ge+Ae*Ct)+",0h"+Ie*Ct},D.makeLabelFns=function(je,Ge,Ct){var Ie=je.ticklabelposition||"",be=function(ar){return Ie.indexOf(ar)!==-1},Ae=be("top"),Pe=be("left"),ze=be("right"),qe=be("bottom")||Pe||Ae||ze,ht=be("inside"),at=Ie==="inside"&&je.ticks==="inside"||!ht&&je.ticks==="outside"&&je.tickson!=="boundaries",nt=0,xt=0,Lt=at?je.ticklen:0;if(ht?Lt*=-1:qe&&(Lt=0),at&&(nt+=Lt,Ct)){var bt=e.deg2rad(Ct);nt=Lt*Math.cos(bt)+1,xt=Lt*Math.sin(bt)}je.showticklabels&&(at||je.showline)&&(nt+=.2*je.tickfont.size);var St,st,It,jt,Ut,zt={labelStandoff:nt+=(je.linewidth||1)/2*(ht?-1:1),labelShift:xt},Ce=0,lt=je.side,At=je._id.charAt(0),Bt=je.tickangle;if(At==="x")jt=(Ut=!ht&&lt==="bottom"||ht&&lt==="top")?1:-1,ht&&(jt*=-1),St=xt*jt,st=Ge+nt*jt,It=Ut?1:-.2,Math.abs(Bt)===90&&(ht?It+=Z:It=Bt===-90&&lt==="bottom"?Y:Bt===90&&lt==="top"?Z:.5,Ce=Z/2*(Bt/90)),zt.xFn=function(ar){return ar.dx+St+Ce*ar.fontSize},zt.yFn=function(ar){return ar.dy+st+ar.fontSize*It},zt.anchorFn=function(ar,Nt){if(qe){if(Pe)return"end";if(ze)return"start"}return h(Nt)&&Nt!==0&&Nt!==180?Nt*jt<0!==ht?"end":"start":"middle"},zt.heightFn=function(ar,Nt,nr){return Nt<-60||Nt>60?-.5*nr:je.side==="top"!==ht?-nr:0};else if(At==="y"){if(jt=(Ut=!ht&&lt==="left"||ht&&lt==="right")?1:-1,ht&&(jt*=-1),St=nt,st=xt*jt,It=0,ht||Math.abs(Bt)!==90||(It=Bt===-90&&lt==="left"||Bt===90&&lt==="right"?Y:.5),ht){var Ht=h(Bt)?+Bt:0;if(Ht!==0){var or=e.deg2rad(Ht);Ce=Math.abs(Math.sin(or))*Y*jt,It=0}}zt.xFn=function(ar){return ar.dx+Ge-(St+ar.fontSize*It)*jt+Ce*ar.fontSize},zt.yFn=function(ar){return ar.dy+st+ar.fontSize*Z},zt.anchorFn=function(ar,Nt){return h(Nt)&&Math.abs(Nt)===90?"middle":Ut?"end":"start"},zt.heightFn=function(ar,Nt,nr){return je.side==="right"&&(Nt*=-1),Nt<-30?-nr:Nt<30?-.5*nr:0}}return zt},D.drawTicks=function(je,Ge,Ct){Ct=Ct||{};var Ie=Ge._id+"tick",be=Ct.vals;Ge.ticklabelmode==="period"&&(be=be.slice()).shift();var Ae=Ct.layer.selectAll("path."+Ie).data(Ge.ticks?be:[],Oe);Ae.exit().remove(),Ae.enter().append("path").classed(Ie,1).classed("ticks",1).classed("crisp",Ct.crisp!==!1).call(n.stroke,Ge.tickcolor).style("stroke-width",s.crispRound(je,Ge.tickwidth,1)+"px").attr("d",Ct.path).style("display",null),$t(Ge,[W]),Ae.attr("transform",Ct.transFn)},D.drawGrid=function(je,Ge,Ct){Ct=Ct||{};var Ie=Ge._id+"grid",be=Ct.vals,Ae=Ct.counterAxis;if(Ge.showgrid===!1)be=[];else if(Ae&&D.shouldShowZeroLine(je,Ge,Ae))for(var Pe=Ge.tickmode==="array",ze=0;ze<be.length;ze++){var qe=be[ze].x;if(Pe?!qe:Math.abs(qe)<Ge.dtick/100){if(be=be.slice(0,ze).concat(be.slice(ze+1)),!Pe)break;ze--}}var ht=Ct.layer.selectAll("path."+Ie).data(be,Oe);ht.exit().remove(),ht.enter().append("path").classed(Ie,1).classed("crisp",Ct.crisp!==!1),Ge._gw=s.crispRound(je,Ge.gridwidth,1),ht.attr("transform",Ct.transFn).attr("d",Ct.path).call(n.stroke,Ge.gridcolor||"#ddd").style("stroke-width",Ge._gw+"px").style("display",null),$t(Ge,[q]),typeof Ct.path=="function"&&ht.attr("d",Ct.path)},D.drawZeroLine=function(je,Ge,Ct){Ct=Ct||Ct;var Ie=Ge._id+"zl",be=D.shouldShowZeroLine(je,Ge,Ct.counterAxis),Ae=Ct.layer.selectAll("path."+Ie).data(be?[{x:0,id:Ge._id}]:[]);Ae.exit().remove(),Ae.enter().append("path").classed(Ie,1).classed("zl",1).classed("crisp",Ct.crisp!==!1).each(function(){Ct.layer.selectAll("path").sort(function(Pe,ze){return $(Pe.id,ze.id)})}),Ae.attr("transform",Ct.transFn).attr("d",Ct.path).call(n.stroke,Ge.zerolinecolor||n.defaultLine).style("stroke-width",s.crispRound(je,Ge.zerolinewidth,Ge._gw||1)+"px").style("display",null),$t(Ge,[F])},D.drawLabels=function(je,Ge,Ct){Ct=Ct||{};var Ie=je._fullLayout,be=Ge._id,Ae=be.charAt(0),Pe=Ct.cls||be+"tick",ze=Ct.vals,qe=Ct.labelFns,ht=Ct.secondary?0:Ge.tickangle,at=(Ge._prevTickAngles||{})[Pe],nt=Ct.layer.selectAll("g."+Pe).data(Ge.showticklabels?ze:[],Oe),xt=[];function Lt(jt,Ut){jt.each(function(zt){var Ce=t.select(this),lt=Ce.select(".text-math-group"),At=qe.anchorFn(zt,Ut),Bt=Ct.transFn.call(Ce.node(),zt)+(h(Ut)&&+Ut!=0?" rotate("+Ut+","+qe.xFn(zt)+","+(qe.yFn(zt)-zt.fontSize/2)+")":""),Ht=o.lineCount(Ce),or=N*zt.fontSize,ar=qe.heightFn(zt,h(Ut)?+Ut:0,(Ht-1)*or);if(ar&&(Bt+=l(0,ar)),lt.empty()){var Nt=Ce.select("text");Nt.attr({transform:Bt,"text-anchor":At}),Nt.style("opacity",1),Ge._adjustTickLabelsOverflow&&Ge._adjustTickLabelsOverflow()}else{var nr=s.bBox(lt.node()).width*{end:-.5,start:.5}[At];lt.attr("transform",Bt+l(nr,0))}})}nt.enter().append("g").classed(Pe,1).append("text").attr("text-anchor","middle").each(function(jt){var Ut=t.select(this),zt=je._promises.length;Ut.call(o.positionText,qe.xFn(jt),qe.yFn(jt)).call(s.font,jt.font,jt.fontSize,jt.fontColor).text(jt.text).call(o.convertToTspans,je),je._promises[zt]?xt.push(je._promises.pop().then(function(){Lt(Ut,ht)})):Lt(Ut,ht)}),$t(Ge,[X]),nt.exit().remove(),Ct.repositionOnUpdate&&nt.each(function(jt){t.select(this).select("text").call(o.positionText,qe.xFn(jt),qe.yFn(jt))}),Ge._adjustTickLabelsOverflow=function(){var jt=Ge.ticklabeloverflow;if(jt&&jt!=="allow"){var Ut=jt.indexOf("hide")!==-1,zt=Ge._id.charAt(0)==="x",Ce=0,lt=zt?je._fullLayout.width:je._fullLayout.height;if(jt.indexOf("domain")!==-1){var At=e.simpleMap(Ge.range,Ge.r2l);Ce=Ge.l2p(At[0])+Ge._offset,lt=Ge.l2p(At[1])+Ge._offset}var Bt=Math.min(Ce,lt),Ht=Math.max(Ce,lt),or=Ge.side,ar=1/0,Nt=-1/0;for(var nr in nt.each(function(Kt){var yr=t.select(this);if(yr.select(".text-math-group").empty()){var xr=s.bBox(yr.node()),gr=0;zt?(xr.right>Ht||xr.left<Bt)&&(gr=1):(xr.bottom>Ht||xr.top+(Ge.tickangle?0:Kt.fontSize/4)<Bt)&&(gr=1);var wr=yr.select("text");gr?Ut&&wr.style("opacity",0):(wr.style("opacity",1),ar=or==="bottom"||or==="right"?Math.min(ar,zt?xr.top:xr.left):-1/0,Nt=or==="top"||or==="left"?Math.max(Nt,zt?xr.bottom:xr.right):1/0)}}),Ie._plots){var Lr=Ie._plots[nr];if(Ge._id===Lr.xaxis._id||Ge._id===Lr.yaxis._id){var dr=zt?Lr.yaxis:Lr.xaxis;dr&&(dr["_visibleLabelMin_"+Ge._id]=ar,dr["_visibleLabelMax_"+Ge._id]=Nt)}}}},Ge._hideCounterAxisInsideTickLabels=function(jt){var Ut=Ge._id.charAt(0)==="x",zt=[];for(var Ce in Ie._plots){var lt=Ie._plots[Ce];Ge._id!==lt.xaxis._id&&Ge._id!==lt.yaxis._id||zt.push(Ut?lt.yaxis:lt.xaxis)}zt.forEach(function(At,Bt){At&&Jt(At)&&(jt||[F,q,W,X]).forEach(function(Ht){var or=Ht.K==="tick"&&Ht.L==="text"&&Ge.ticklabelmode==="period",ar=Ie._plots[Ge._mainSubplot];(Ht.K===F.K?ar.zerolinelayer.selectAll("."+Ge._id+"zl"):Ht.K===q.K?ar.gridlayer.selectAll("."+Ge._id):ar[Ge._id.charAt(0)+"axislayer"]).each(function(){var Nt=t.select(this);Ht.L&&(Nt=Nt.selectAll(Ht.L)),Nt.each(function(nr){var Lr=Ge.l2p(or?Qe(nr):nr.x)+Ge._offset,dr=t.select(this);Lr<Ge["_visibleLabelMax_"+At._id]&&Lr>Ge["_visibleLabelMin_"+At._id]?dr.style("display","none"):Ht.K!=="tick"||Bt||dr.style("display",null)})})})})},Lt(nt,at+1?at:ht);var bt=null;Ge._selections&&(Ge._selections[Pe]=nt);var St=[function(){return xt.length&&Promise.all(xt)}];Ge.automargin&&Ie._redrawFromAutoMarginCount&&at===90?(bt=90,St.push(function(){Lt(nt,at)})):St.push(function(){if(Lt(nt,ht),ze.length&&Ae==="x"&&!h(ht)&&(Ge.type!=="log"||String(Ge.dtick).charAt(0)!=="D")){bt=0;var jt,Ut=0,zt=[];if(nt.each(function(yr){Ut=Math.max(Ut,yr.fontSize);var xr=Ge.l2p(yr.x),gr=Ye(this),wr=s.bBox(gr.node());zt.push({top:0,bottom:10,height:10,left:xr-wr.width/2,right:xr+wr.width/2+2,width:wr.width+2})}),Ge.tickson!=="boundaries"&&!Ge.showdividers||Ct.secondary){var Ce=ze.length,lt=Math.abs((ze[Ce-1].x-ze[0].x)*Ge._m)/(Ce-1),At=Ge.ticklabelposition||"",Bt=function(yr){return At.indexOf(yr)!==-1},Ht=Bt("top"),or=Bt("left"),ar=Bt("right"),Nt=Bt("bottom")||or||Ht||ar?(Ge.tickwidth||0)+6:0,nr=lt<2.5*Ut||Ge.type==="multicategory";for(jt=0;jt<zt.length-1;jt++)if(e.bBoxIntersect(zt[jt],zt[jt+1],Nt)){bt=nr?90:30;break}}else{var Lr=2;for(Ge.ticks&&(Lr+=Ge.tickwidth/2),jt=0;jt<zt.length;jt++){var dr=ze[jt].xbnd,Kt=zt[jt];if(dr[0]!==null&&Kt.left-Ge.l2p(dr[0])<Lr||dr[1]!==null&&Ge.l2p(dr[1])-Kt.right<Lr){bt=90;break}}}bt&&Lt(nt,bt)}}),Ge._tickAngles&&St.push(function(){Ge._tickAngles[Pe]=bt===null?h(ht)?ht:0:bt});var st=Ge._anchorAxis;st&&st.autorange&&Jt(Ge)&&!K(Ie,Ge._id)&&(Ie._insideTickLabelsAutorange||(Ie._insideTickLabelsAutorange={}),Ie._insideTickLabelsAutorange[st._name+".autorange"]=st.autorange,St.push(function(){nt.each(function(jt,Ut){var zt=Ye(this);zt.select(".text-math-group").empty()&&(Ge._vals[Ut].bb=s.bBox(zt.node()))})}));var It=e.syncOrAsync(St);return It&&It.then&&je._promises.push(It),It},D.getPxPosition=function(je,Ge){var Ct,Ie=je._fullLayout._size,be=Ge._id.charAt(0),Ae=Ge.side;return Ge.anchor!=="free"?Ct=Ge._anchorAxis:be==="x"?Ct={_offset:Ie.t+(1-(Ge.position||0))*Ie.h,_length:0}:be==="y"&&(Ct={_offset:Ie.l+(Ge.position||0)*Ie.w,_length:0}),Ae==="top"||Ae==="left"?Ct._offset:Ae==="bottom"||Ae==="right"?Ct._offset+Ct._length:void 0},D.shouldShowZeroLine=function(je,Ge,Ct){var Ie=e.simpleMap(Ge.range,Ge.r2l);return Ie[0]*Ie[1]<=0&&Ge.zeroline&&(Ge.type==="linear"||Ge.type==="-")&&!(Ge.rangebreaks&&Ge.maskBreaks(0)===z)&&(Xe(Ge,0)||!function(be,Ae,Pe,ze){var qe=Pe._mainAxis;if(!qe)return;var ht=be._fullLayout,at=Ae._id.charAt(0),nt=D.counterLetter(Ae._id),xt=Ae._offset+(Math.abs(ze[0])<Math.abs(ze[1])==(at==="x")?0:Ae._length);function Lt(jt){if(!jt.showline||!jt.linewidth)return!1;var Ut=Math.max((jt.linewidth+Ae.zerolinewidth)/2,1);function zt(At){return typeof At=="number"&&Math.abs(At-xt)<Ut}if(zt(jt._mainLinePosition)||zt(jt._mainMirrorPosition))return!0;var Ce=jt._linepositions||{};for(var lt in Ce)if(zt(Ce[lt][0])||zt(Ce[lt][1]))return!0}var bt=ht._plots[Pe._mainSubplot];if(!(bt.mainplotinfo||bt).overlays.length)return Lt(Pe);for(var St=D.list(be,nt),st=0;st<St.length;st++){var It=St[st];if(It._mainAxis===qe&&Lt(It))return!0}}(je,Ge,Ct,Ie)||function(be,Ae){for(var Pe=be._fullData,ze=Ae._mainSubplot,qe=Ae._id.charAt(0),ht=0;ht<Pe.length;ht++){var at=Pe[ht];if(at.visible===!0&&at.xaxis+at.yaxis===ze&&(u.traceIs(at,"bar-like")&&at.orientation==={x:"h",y:"v"}[qe]||at.fill&&at.fill.charAt(at.fill.length-1)===qe))return!0}return!1}(je,Ge))},D.clipEnds=function(je,Ge){return Ge.filter(function(Ct){return Xe(je,Ct.x)})},D.allowAutoMargin=function(je){for(var Ge=D.list(je,"",!0),Ct=0;Ct<Ge.length;Ct++){var Ie=Ge[Ct];Ie.automargin&&(p.allowAutoMargin(je,$e(Ie)),Ie.mirror&&p.allowAutoMargin(je,it(Ie))),u.getComponentMethod("rangeslider","isVisible")(Ie)&&p.allowAutoMargin(je,ot(Ie))}},D.swap=function(je,Ge){for(var Ct=function(be,Ae){var Pe,ze,qe=[];for(Pe=0;Pe<Ae.length;Pe++){var ht=[],at=be._fullData[Ae[Pe]].xaxis,nt=be._fullData[Ae[Pe]].yaxis;if(at&&nt){for(ze=0;ze<qe.length;ze++)qe[ze].x.indexOf(at)===-1&&qe[ze].y.indexOf(nt)===-1||ht.push(ze);if(ht.length){var xt,Lt=qe[ht[0]];if(ht.length>1)for(ze=1;ze<ht.length;ze++)xt=qe[ht[ze]],Et(Lt.x,xt.x),Et(Lt.y,xt.y);Et(Lt.x,[at]),Et(Lt.y,[nt])}else qe.push({x:[at],y:[nt]})}}return qe}(je,Ge),Ie=0;Ie<Ct.length;Ie++)mt(je,Ct[Ie].x,Ct[Ie].y)}},{"../../components/color":666,"../../components/drawing":688,"../../components/titles":764,"../../constants/alignment":771,"../../constants/numerical":779,"../../lib":803,"../../lib/svg_text_utils":829,"../../plots/plots":917,"../../registry":931,"./autorange":853,"./axis_autotype":855,"./axis_ids":858,"./clean_ticks":860,"./layout_attributes":869,"./set_convert":875,"@plotly/d3":58,"fast-isnumeric":249}],855:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("../../constants/numerical").BADNUM,u=h.isArrayOrTypedArray,e=h.isDateTime,l=h.cleanNumber,o=Math.round;function a(s,r){return r?t(s):typeof s=="number"}function n(s){return Math.max(1,(s-1)/1e3)}B.exports=function(s,r,c){var f=s,d=c.noMultiCategory;if(u(f)&&!f.length)return"-";if(!d&&function(T){return u(T[0])&&u(T[1])}(f))return"multicategory";if(d&&Array.isArray(f[0])){for(var g=[],m=0;m<f.length;m++)if(u(f[m]))for(var y=0;y<f[m].length;y++)g.push(f[m][y]);f=g}if(function(T,_){for(var k=T.length,E=n(k),A=0,b=0,L={},w=0;w<k;w+=E){var C=o(w),S=T[C],P=String(S);L[P]||(L[P]=1,e(S,_)&&A++,t(S)&&b++)}return A>2*b}(f,r))return"date";var v=c.autotypenumbers!=="strict";return function(T,_){for(var k=T.length,E=n(k),A=0,b=0,L={},w=0;w<k;w+=E){var C=o(w),S=T[C],P=String(S);if(!L[P]){L[P]=1;var z=typeof S;z==="boolean"?b++:(_?l(S)!==p:z==="number")?A++:z==="string"&&b++}}return b>2*A}(f,v)?"category":function(T,_){for(var k=T.length,E=0;E<k;E++)if(a(T[E],_))return!0;return!1}(f,v)?"linear":"-"}},{"../../constants/numerical":779,"../../lib":803,"fast-isnumeric":249}],856:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../registry"),p=i("../../lib"),u=i("../array_container_defaults"),e=i("./layout_attributes"),l=i("./tick_value_defaults"),o=i("./tick_mark_defaults"),a=i("./tick_label_defaults"),n=i("./category_order_defaults"),s=i("./line_grid_defaults"),r=i("./set_convert"),c=i("./constants").WEEKDAY_PATTERN,f=i("./constants").HOUR_PATTERN;function d(y,v,T){function _(S,P){return p.coerce(y,v,e.rangebreaks,S,P)}if(_("enabled")){var k=_("bounds");if(k&&k.length>=2){var E,A,b="";if(k.length===2){for(E=0;E<2;E++)if(A=m(k[E])){b=c;break}}var L=_("pattern",b);if(L===c)for(E=0;E<2;E++)(A=m(k[E]))&&(v.bounds[E]=k[E]=A-1);if(L)for(E=0;E<2;E++)switch(A=k[E],L){case c:if(!t(A)||(A=+A)!==Math.floor(A)||A<0||A>=7)return void(v.enabled=!1);v.bounds[E]=k[E]=A;break;case f:if(!t(A)||(A=+A)<0||A>24)return void(v.enabled=!1);v.bounds[E]=k[E]=A}if(T.autorange===!1){var w=T.range;if(w[0]<w[1]){if(k[0]<w[0]&&k[1]>w[1])return void(v.enabled=!1)}else if(k[0]>w[0]&&k[1]<w[1])return void(v.enabled=!1)}}else{var C=_("values");if(!C||!C.length)return void(v.enabled=!1);_("dvalue")}}}B.exports=function(y,v,T,_,k){var E,A=_.letter,b=_.font||{},L=_.splomStash||{},w=T("visible",!_.visibleDflt),C=v._template||{},S=v.type||C.type||"-";S==="date"&&(h.getComponentMethod("calendars","handleDefaults")(y,v,"calendar",_.calendar),_.noTicklabelmode||(E=T("ticklabelmode")));var P="";_.noTicklabelposition&&S!=="multicategory"||(P=p.coerce(y,v,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:E==="period"?["outside","inside"]:A==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),_.noTicklabeloverflow||T("ticklabeloverflow",P.indexOf("inside")!==-1?"hide past domain":S==="category"||S==="multicategory"?"allow":"hide past div"),r(v,k);var z=!v.isValidRange(y.range);z&&_.reverseDflt&&(z="reversed"),!T("autorange",z)||S!=="linear"&&S!=="-"||T("rangemode"),T("range"),v.cleanRange(),n(y,v,T,_),S==="category"||_.noHover||T("hoverformat");var F=T("color"),q=F!==e.color.dflt?F:b.color,W=L.label||k._dfltTitle[A];if(a(y,v,T,S,_,{pass:1}),!w)return v;T("title.text",W),p.coerceFont(T,"title.font",{family:b.family,size:p.bigFont(b.size),color:q}),l(y,v,T,S),a(y,v,T,S,_,{pass:2}),o(y,v,T,_),s(y,v,T,{dfltColor:F,bgColor:_.bgColor,showGrid:_.showGrid,attributes:e}),(v.showline||v.ticks)&&T("mirror"),_.automargin&&T("automargin");var X,Q=S==="multicategory";if(_.noTickson||S!=="category"&&!Q||!v.ticks&&!v.showgrid||(Q&&(X="boundaries"),T("tickson",X)==="boundaries"&&delete v.ticklabelposition),Q&&T("showdividers")&&(T("dividercolor"),T("dividerwidth")),S==="date")if(u(y,v,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:d}),v.rangebreaks.length){for(var Z=0;Z<v.rangebreaks.length;Z++)if(v.rangebreaks[Z].pattern===c){v._hasDayOfWeekBreaks=!0;break}if(r(v,k),k._has("scattergl")||k._has("splom"))for(var Y=0;Y<_.data.length;Y++){var N=_.data[Y];N.type!=="scattergl"&&N.type!=="splom"||(N.visible=!1,p.warn(N.type+" traces do not work on axes with rangebreaks. Setting trace "+N.index+" to `visible: false`."))}}else delete v.rangebreaks;return v};var g={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function m(y){if(typeof y=="string")return g[y.substr(0,3).toLowerCase()]}},{"../../lib":803,"../../registry":931,"../array_container_defaults":849,"./category_order_defaults":859,"./constants":861,"./layout_attributes":869,"./line_grid_defaults":871,"./set_convert":875,"./tick_label_defaults":876,"./tick_mark_defaults":877,"./tick_value_defaults":878,"fast-isnumeric":249}],857:[function(i,B,V){var t=i("../../constants/docs"),h=t.FORMAT_LINK,p=t.DATE_FORMAT_LINK;function u(l,o){return["Sets the "+l+" formatting rule"+(o?"for `"+o+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+h+"."].join(" ")}function e(l,o){return u(l,o)+[" And for dates see: "+p+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}B.exports={axisHoverFormat:function(l,o){return{valType:"string",dflt:"",editType:"none",description:(o?u:e)("hover text",l)+["By default the values are formatted using "+(o?"generic number format":"`"+l+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:u,descriptionWithDates:e}},{"../../constants/docs":774}],858:[function(i,B,V){var t=i("../../registry"),h=i("./constants");function p(u,e){if(e&&e.length){for(var l=0;l<e.length;l++)if(e[l][u])return!0}return!1}V.id2name=function(u){if(typeof u=="string"&&u.match(h.AX_ID_PATTERN)){var e=u.split(" ")[0].substr(1);return e==="1"&&(e=""),u.charAt(0)+"axis"+e}},V.name2id=function(u){if(u.match(h.AX_NAME_PATTERN)){var e=u.substr(5);return e==="1"&&(e=""),u.charAt(0)+e}},V.cleanId=function(u,e,l){var o=/( domain)$/.test(u);if(typeof u=="string"&&u.match(h.AX_ID_PATTERN)&&(!e||u.charAt(0)===e)&&(!o||l)){var a=u.split(" ")[0].substr(1).replace(/^0+/,"");return a==="1"&&(a=""),u.charAt(0)+a+(o&&l?" domain":"")}},V.list=function(u,e,l){var o=u._fullLayout;if(!o)return[];var a,n=V.listIds(u,e),s=new Array(n.length);for(a=0;a<n.length;a++){var r=n[a];s[a]=o[r.charAt(0)+"axis"+r.substr(1)]}if(!l){var c=o._subplots.gl3d||[];for(a=0;a<c.length;a++){var f=o[c[a]];e?s.push(f[e+"axis"]):s.push(f.xaxis,f.yaxis,f.zaxis)}}return s},V.listIds=function(u,e){var l=u._fullLayout;if(!l)return[];var o=l._subplots;return e?o[e+"axis"]:o.xaxis.concat(o.yaxis)},V.getFromId=function(u,e,l){var o=u._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),l==="x"?e=e.replace(/y[0-9]*/,""):l==="y"&&(e=e.replace(/x[0-9]*/,"")),o[V.id2name(e)]},V.getFromTrace=function(u,e,l){var o=u._fullLayout,a=null;if(t.traceIs(e,"gl3d")){var n=e.scene;n.substr(0,5)==="scene"&&(a=o[n][l+"axis"])}else a=V.getFromId(u,e[l+"axis"]||l);return a},V.idSort=function(u,e){var l=u.charAt(0),o=e.charAt(0);return l!==o?l>o?1:-1:+(u.substr(1)||1)-+(e.substr(1)||1)},V.ref2id=function(u){return!!/^[xyz]/.test(u)&&u.split(" ")[0]},V.isLinked=function(u,e){return p(e,u._axisMatchGroups)||p(e,u._axisConstraintGroups)}},{"../../registry":931,"./constants":861}],859:[function(i,B,V){B.exports=function(t,h,p,u){if(h.type==="category"){var e,l=t.categoryarray,o=Array.isArray(l)&&l.length>0;o&&(e="array");var a,n=p("categoryorder",e);n==="array"&&(a=p("categoryarray")),o||n!=="array"||(n=h.categoryorder="trace"),n==="trace"?h._initialCategories=[]:n==="array"?h._initialCategories=a.slice():(a=function(s,r){var c,f,d,g=r.dataAttr||s._id.charAt(0),m={};if(r.axData)c=r.axData;else for(c=[],f=0;f<r.data.length;f++){var y=r.data[f];y[g+"axis"]===s._id&&c.push(y)}for(f=0;f<c.length;f++){var v=c[f][g];for(d=0;d<v.length;d++){var T=v[d];T!=null&&(m[T]=1)}}return Object.keys(m)}(h,u).sort(),n==="category ascending"?h._initialCategories=a:n==="category descending"&&(h._initialCategories=a.reverse()))}}},{}],860:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("../../constants/numerical"),u=p.ONEDAY,e=p.ONEWEEK;V.dtick=function(l,o){var a=o==="log",n=o==="date",s=o==="category",r=n?u:1;if(!l)return r;if(t(l))return(l=Number(l))<=0?r:s?Math.max(1,Math.round(l)):n?Math.max(.1,l):l;if(typeof l!="string"||!n&&!a)return r;var c=l.charAt(0),f=l.substr(1);return(f=t(f)?Number(f):0)<=0||!(n&&c==="M"&&f===Math.round(f)||a&&c==="L"||a&&c==="D"&&(f===1||f===2))?r:l},V.tick0=function(l,o,a,n){return o==="date"?h.cleanDate(l,h.dateTick0(a,n%e==0?1:0)):n!=="D1"&&n!=="D2"?t(l)?Number(l):0:void 0}},{"../../constants/numerical":779,"../../lib":803,"fast-isnumeric":249}],861:[function(i,B,V){var t=i("../../lib/regex").counter;B.exports={idRegex:{x:t("x","( domain)?"),y:t("y","( domain)?")},attrRegex:t("[xy]axis"),xAxisMatch:t("xaxis"),yAxisMatch:t("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":820}],862:[function(i,B,V){var t=i("../../lib"),h=i("./autorange"),p=i("./axis_ids").id2name,u=i("./layout_attributes"),e=i("./scale_zoom"),l=i("./set_convert"),o=i("../../constants/numerical").ALMOST_EQUAL,a=i("../../constants/alignment").FROM_BL;function n(m,y,v){var T=v.axIds,_=v.layoutOut,k=v.hasImage,E=_._axisConstraintGroups,A=_._axisMatchGroups,b=y._id,L=b.charAt(0),w=((_._splomAxes||{})[L]||{})[b]||{},C=y._id,S=C.charAt(0)==="x";function P($,K){return t.coerce(m,y,u,$,K)}y._matchGroup=null,y._constraintGroup=null,P("constrain",k?"domain":"range"),t.coerce(m,y,{constraintoward:{valType:"enumerated",values:S?["left","center","right"]:["bottom","middle","top"],dflt:S?"center":"middle"}},"constraintoward");var z,F,q=y.type,W=[];for(z=0;z<T.length;z++)(F=T[z])!==C&&_[p(F)].type===q&&W.push(F);var X=r(E,C);if(X){var Q=[];for(z=0;z<W.length;z++)X[F=W[z]]||Q.push(F);W=Q}var Z,Y,N=W.length;N&&(m.matches||w.matches)&&(Z=t.coerce(m,y,{matches:{valType:"enumerated",values:W,dflt:W.indexOf(w.matches)!==-1?w.matches:void 0}},"matches"));var J=k&&!S?y.anchor:void 0;if(N&&!Z&&(m.scaleanchor||J)&&(Y=t.coerce(m,y,{scaleanchor:{valType:"enumerated",values:W}},"scaleanchor",J)),Z){y._matchGroup=c(A,C,Z,1);var D=_[p(Z)],U=s(_,y)/s(_,D);S!==(Z.charAt(0)==="x")&&(U=(S?"x":"y")+U),c(E,C,Z,U)}else m.matches&&T.indexOf(m.matches)!==-1&&t.warn("ignored "+y._name+'.matches: "'+m.matches+'" to avoid an infinite loop');if(Y){var G=P("scaleratio");G||(G=y.scaleratio=1),c(E,C,Y,G)}else m.scaleanchor&&T.indexOf(m.scaleanchor)!==-1&&t.warn("ignored "+y._name+'.scaleanchor: "'+m.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function s(m,y){var v=y.domain;return v||(v=m[p(y.overlaying)].domain),v[1]-v[0]}function r(m,y){for(var v=0;v<m.length;v++)if(m[v][y])return m[v];return null}function c(m,y,v,T){var _,k,E,A,b,L=r(m,y);L===null?((L={})[y]=1,b=m.length,m.push(L)):b=m.indexOf(L);var w=Object.keys(L);for(_=0;_<m.length;_++)if(E=m[_],_!==b&&E[v]){var C=E[v];for(k=0;k<w.length;k++)E[A=w[k]]=f(C,f(T,L[A]));return void m.splice(b,1)}if(T!==1)for(k=0;k<w.length;k++){var S=w[k];L[S]=f(T,L[S])}L[v]=1}function f(m,y){var v,T,_="",k="";typeof m=="string"&&(v=(_=m.match(/^[xy]*/)[0]).length,m=+m.substr(v)),typeof y=="string"&&(T=(k=y.match(/^[xy]*/)[0]).length,y=+y.substr(T));var E=m*y;return v||T?v&&T&&_.charAt(0)!==k.charAt(0)?v===T?E:(v>T?_.substr(T):k.substr(v))+E:_+k+m*y:E}function d(m,y){for(var v=y._size,T=v.h/v.w,_={},k=Object.keys(m),E=0;E<k.length;E++){var A=k[E],b=m[A];if(typeof b=="string"){var L=b.match(/^[xy]*/)[0],w=L.length;b=+b.substr(w);for(var C=L.charAt(0)==="y"?T:1/T,S=0;S<w;S++)b*=C}_[A]=b}return _}function g(m,y){var v=m._inputDomain,T=a[m.constraintoward],_=v[0]+(v[1]-v[0])*T;m.domain=m._input.domain=[_+(v[0]-_)/y,_+(v[1]-_)/y],m.setScale()}V.handleDefaults=function(m,y,v){var T,_,k,E,A,b,L,w,C=v.axIds,S=v.axHasImage,P=y._axisConstraintGroups=[],z=y._axisMatchGroups=[];for(T=0;T<C.length;T++)n(A=m[E=p(C[T])],b=y[E],{axIds:C,layoutOut:y,hasImage:S[E]});function F(D,U){for(T=0;T<D.length;T++)for(k in _=D[T])y[p(k)][U]=_}for(F(z,"_matchGroup"),T=0;T<P.length;T++)for(k in _=P[T])if((b=y[p(k)]).fixedrange){for(var q in _){var W=p(q);(m[W]||{}).fixedrange===!1&&t.warn("fixedrange was specified as false for axis "+W+" but was overridden because another axis in its constraint group has fixedrange true"),y[W].fixedrange=!0}break}for(T=0;T<P.length;){for(k in _=P[T]){(b=y[p(k)])._matchGroup&&Object.keys(b._matchGroup).length===Object.keys(_).length&&(P.splice(T,1),T--);break}T++}F(P,"_constraintGroup");var X=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],Q=!1,Z=!1;function Y(){w=b[L],L==="rangebreaks"&&(Z=b._hasDayOfWeekBreaks)}for(T=0;T<z.length;T++){_=z[T];for(var N=0;N<X.length;N++){var J;for(k in L=X[N],w=null,_)if(A=m[E=p(k)],b=y[E],L in b){if(!b.matches&&(J=b,L in A)){Y();break}w===null&&L in A&&Y()}if(L==="range"&&w&&(Q=!0),L==="autorange"&&w===null&&Q&&(w=!1),w===null&&L in J&&(w=J[L]),w!==null)for(k in _)(b=y[p(k)])[L]=L==="range"?w.slice():w,L==="rangebreaks"&&(b._hasDayOfWeekBreaks=Z,l(b,y))}}},V.enforce=function(m){var y,v,T,_,k,E,A,b,L=m._fullLayout,w=L._axisConstraintGroups||[];for(y=0;y<w.length;y++){T=d(w[y],L);var C=Object.keys(T),S=1/0,P=0,z=1/0,F={},q={},W=!1;for(v=0;v<C.length;v++)q[_=C[v]]=k=L[p(_)],k._inputDomain?k.domain=k._inputDomain.slice():k._inputDomain=k.domain.slice(),k._inputRange||(k._inputRange=k.range.slice()),k.setScale(),F[_]=E=Math.abs(k._m)/T[_],S=Math.min(S,E),k.constrain!=="domain"&&k._constraintShrinkable||(z=Math.min(z,E)),delete k._constraintShrinkable,P=Math.max(P,E),k.constrain==="domain"&&(W=!0);if(!(S>o*P)||W){for(v=0;v<C.length;v++)if(E=F[_=C[v]],A=(k=q[_]).constrain,E!==z||A==="domain")if(b=E/z,A==="range")e(k,b);else{var X=k._inputDomain,Q=(k.domain[1]-k.domain[0])/(X[1]-X[0]),Z=(k.r2l(k.range[1])-k.r2l(k.range[0]))/(k.r2l(k._inputRange[1])-k.r2l(k._inputRange[0]));if((b/=Q)*Z<1){k.domain=k._input.domain=X.slice(),e(k,b);continue}if(Z<1&&(k.range=k._input.range=k._inputRange.slice(),b*=Z),k.autorange){var Y=k.r2l(k.range[0]),N=k.r2l(k.range[1]),J=(Y+N)/2,D=J,U=J,G=Math.abs(N-J),$=J-G*b*1.0001,K=J+G*b*1.0001,re=h.makePadFn(L,k,0),ne=h.makePadFn(L,k,1);g(k,b);var ae,ie,he=Math.abs(k._m),se=h.concatExtremes(m,k),de=se.min,ce=se.max;for(ie=0;ie<de.length;ie++)(ae=de[ie].val-re(de[ie])/he)>$&&ae<D&&(D=ae);for(ie=0;ie<ce.length;ie++)(ae=ce[ie].val+ne(ce[ie])/he)<K&&ae>U&&(U=ae);b/=(U-D)/(2*G),D=k.l2r(D),U=k.l2r(U),k.range=k._input.range=Y<N?[D,U]:[U,D]}g(k,b)}}}},V.getAxisGroup=function(m,y){for(var v=m._axisMatchGroups,T=0;T<v.length;T++)if(v[T][y])return"g"+T;return y},V.clean=function(m,y){if(y._inputDomain){for(var v=!1,T=y._id,_=m._fullLayout._axisConstraintGroups,k=0;k<_.length;k++)if(_[k][T]){v=!0;break}v&&y.constrain==="domain"||(y._input.domain=y.domain=y._inputDomain,delete y._inputDomain)}}},{"../../constants/alignment":771,"../../constants/numerical":779,"../../lib":803,"./autorange":853,"./axis_ids":858,"./layout_attributes":869,"./scale_zoom":873,"./set_convert":875}],863:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=h.numberFormat,u=i("tinycolor2"),e=i("has-passive-events"),l=i("../../registry"),o=h.strTranslate,a=i("../../lib/svg_text_utils"),n=i("../../components/color"),s=i("../../components/drawing"),r=i("../../components/fx"),c=i("./axes"),f=i("../../lib/setcursor"),d=i("../../components/dragelement"),g=i("../../components/dragelement/helpers"),m=g.selectingOrDrawing,y=g.freeMode,v=i("../../constants/alignment").FROM_TL,T=i("../../lib/clear_gl_canvases"),_=i("../../plot_api/subroutines").redrawReglTraces,k=i("../plots"),E=i("./axis_ids").getFromId,A=i("./select").prepSelect,b=i("./select").clearSelect,L=i("./select").selectOnClick,w=i("./scale_zoom"),C=i("./constants"),S=C.MINDRAG,P=C.MINZOOM,z=!0;function F(ae,ie,he,se){var de=h.ensureSingle(ae.draglayer,ie,he,function(ce){ce.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",ae.id)});return de.call(f,se),de.node()}function q(ae,ie,he,se,de,ce,ve){var Ee=F(ae,"rect",ie,he);return t.select(Ee).call(s.setRect,se,de,ce,ve),Ee}function W(ae,ie){for(var he=0;he<ae.length;he++)if(!ae[he].fixedrange)return ie;return""}function X(ae,ie,he,se,de){for(var ce=0;ce<ae.length;ce++){var ve=ae[ce];if(!ve.fixedrange)if(ve.rangebreaks){var Ee=ve._id.charAt(0)==="y",Le=Ee?1-ie:ie,Te=Ee?1-he:he;se[ve._name+".range[0]"]=ve.l2r(ve.p2l(Le*ve._length)),se[ve._name+".range[1]"]=ve.l2r(ve.p2l(Te*ve._length))}else{var xe=ve._rl[0],fe=ve._rl[1]-xe;se[ve._name+".range[0]"]=ve.l2r(xe+fe*ie),se[ve._name+".range[1]"]=ve.l2r(xe+fe*he)}}if(de&&de.length){var ge=(ie+(1-he))/2;X(de,ge,1-ge,se,[])}}function Q(ae,ie){for(var he=0;he<ae.length;he++){var se=ae[he];if(!se.fixedrange)if(se.rangebreaks){var de=se._length,ce=(se.p2l(0+ie)-se.p2l(0)+(se.p2l(de+ie)-se.p2l(de)))/2;se.range=[se.l2r(se._rl[0]-ce),se.l2r(se._rl[1]-ce)]}else se.range=[se.l2r(se._rl[0]-ie/se._m),se.l2r(se._rl[1]-ie/se._m)]}}function Z(ae){return 1-(ae>=0?Math.min(ae,.9):1/(1/Math.max(ae,-.3)+3.222))}function Y(ae,ie,he,se,de){return ae.append("path").attr("class","zoombox").style({fill:ie>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",o(he,se)).attr("d",de+"Z")}function N(ae,ie,he){return ae.append("path").attr("class","zoombox-corners").style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,opacity:0}).attr("transform",o(ie,he)).attr("d","M0,0Z")}function J(ae,ie,he,se,de,ce){ae.attr("d",se+"M"+he.l+","+he.t+"v"+he.h+"h"+he.w+"v-"+he.h+"h-"+he.w+"Z"),D(ae,ie,de,ce)}function D(ae,ie,he,se){he||(ae.transition().style("fill",se>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ie.transition().style("opacity",1).duration(200))}function U(ae){t.select(ae).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function G(ae){z&&ae.data&&ae._context.showTips&&(h.notifier(h._(ae,"Double-click to zoom back out"),"long"),z=!1)}function $(ae){var ie=Math.floor(Math.min(ae.b-ae.t,ae.r-ae.l,P)/2);return"M"+(ae.l-3.5)+","+(ae.t-.5+ie)+"h3v"+-ie+"h"+ie+"v-3h-"+(ie+3)+"ZM"+(ae.r+3.5)+","+(ae.t-.5+ie)+"h-3v"+-ie+"h"+-ie+"v-3h"+(ie+3)+"ZM"+(ae.r+3.5)+","+(ae.b+.5-ie)+"h-3v"+ie+"h"+-ie+"v3h"+(ie+3)+"ZM"+(ae.l-3.5)+","+(ae.b+.5-ie)+"h3v"+ie+"h"+ie+"v3h-"+(ie+3)+"Z"}function K(ae,ie,he,se,de){for(var ce,ve,Ee,Le,Te=!1,xe={},fe={},ge=(de||{}).xaHash,ke=(de||{}).yaHash,Me=0;Me<ie.length;Me++){var Se=ie[Me];for(ce in he)if(Se[ce]){for(Ee in Se)de&&(ge[Ee]||ke[Ee])||(Ee.charAt(0)==="x"?he:se)[Ee]||(xe[Ee]=ce);for(ve in se)de&&(ge[ve]||ke[ve])||!Se[ve]||(Te=!0)}for(ve in se)if(Se[ve])for(Le in Se)de&&(ge[Le]||ke[Le])||(Le.charAt(0)==="x"?he:se)[Le]||(fe[Le]=ve)}Te&&(h.extendFlat(xe,fe),fe={});var De={},Be=[];for(Ee in xe){var We=E(ae,Ee);Be.push(We),De[We._id]=We}var Qe={},Oe=[];for(Le in fe){var Ue=E(ae,Le);Oe.push(Ue),Qe[Ue._id]=Ue}return{xaHash:De,yaHash:Qe,xaxes:Be,yaxes:Oe,xLinks:xe,yLinks:fe,isSubplotConstrained:Te}}function re(ae,ie){if(e){var he=ae.onwheel!==void 0?"wheel":"mousewheel";ae._onwheel&&ae.removeEventListener(he,ae._onwheel),ae._onwheel=ie,ae.addEventListener(he,ie,{passive:!1})}else ae.onwheel!==void 0?ae.onwheel=ie:ae.onmousewheel!==void 0?ae.onmousewheel=ie:ae.isAddedWheelEvent||(ae.isAddedWheelEvent=!0,ae.addEventListener("wheel",ie,{passive:!1}))}function ne(ae){var ie=[];for(var he in ae)ie.push(ae[he]);return ie}B.exports={makeDragBox:function(ae,ie,he,se,de,ce,ve,Ee){var Le,Te,xe,fe,ge,ke,Me,Se,De,Be,We,Qe,Oe,Ue,Xe,Ye,$e,it,ot,Et,mt,tt,Ke,Mt=ae._fullLayout._zoomlayer,Jt=ve+Ee==="nsew",$t=(ve+Ee).length===1;function je(){if(Le=ie.xaxis,Te=ie.yaxis,De=Le._length,Be=Te._length,Me=Le._offset,Se=Te._offset,(xe={})[Le._id]=Le,(fe={})[Te._id]=Te,ve&&Ee)for(var Kt=ie.overlays,yr=0;yr<Kt.length;yr++){var xr=Kt[yr].xaxis;xe[xr._id]=xr;var gr=Kt[yr].yaxis;fe[gr._id]=gr}ge=ne(xe),ke=ne(fe),Oe=W(ge,Ee),Ue=W(ke,ve),Xe=!Ue&&!Oe,Qe=K(ae,ae._fullLayout._axisMatchGroups,xe,fe);var wr=(We=K(ae,ae._fullLayout._axisConstraintGroups,xe,fe,Qe)).isSubplotConstrained||Qe.isSubplotConstrained;Ye=Ee||wr,$e=ve||wr;var zr=ae._fullLayout;it=zr._has("scattergl"),ot=zr._has("splom"),Et=zr._has("svg")}je();var Ge=function(Kt,yr,xr){return Kt?Kt==="nsew"?xr?"":yr==="pan"?"move":"crosshair":Kt.toLowerCase()+"-resize":"pointer"}(Ue+Oe,ae._fullLayout.dragmode,Jt),Ct=q(ie,ve+Ee+"drag",Ge,he,se,de,ce);if(Xe&&!Jt)return Ct.onmousedown=null,Ct.style.pointerEvents="none",Ct;var Ie,be,Ae,Pe,ze,qe,ht,at,nt,xt,Lt={element:Ct,gd:ae,plotinfo:ie};function bt(){Lt.plotinfo.selection=!1,b(ae)}function St(Kt,yr){var xr=Lt.gd;if(xr._fullLayout._activeShapeIndex>=0)xr._fullLayout._deactivateShape(xr);else{var gr=xr._fullLayout.clickmode;if(U(xr),Kt!==2||$t||or(),Jt)gr.indexOf("select")>-1&&L(yr,xr,ge,ke,ie.id,Lt),gr.indexOf("event")>-1&&r.click(xr,yr,ie.id);else if(Kt===1&&$t){var wr=ve?Te:Le,zr=ve==="s"||Ee==="w"?0:1,Rr=wr._name+".range["+zr+"]",Wr=function(Zr,bn){var Dr,br=Zr.range[bn],Xr=Math.abs(br-Zr.range[1-bn]);return Zr.type==="date"?br:Zr.type==="log"?(Dr=Math.ceil(Math.max(0,-Math.log(Xr)/Math.LN10))+3,p("."+Dr+"g")(Math.pow(10,br))):(Dr=Math.floor(Math.log(Math.abs(br))/Math.LN10)-Math.floor(Math.log(Xr)/Math.LN10)+4,p("."+String(Dr)+"g")(br))}(wr,zr),gn="left",rn="middle";if(wr.fixedrange)return;ve?(rn=ve==="n"?"top":"bottom",wr.side==="right"&&(gn="right")):Ee==="e"&&(gn="right"),xr._context.showAxisRangeEntryBoxes&&t.select(Ct).call(a.makeEditable,{gd:xr,immediate:!0,background:xr._fullLayout.paper_bgcolor,text:String(Wr),fill:wr.tickfont?wr.tickfont.color:"#444",horizontalAlign:gn,verticalAlign:rn}).on("edit",function(Zr){var bn=wr.d2r(Zr);bn!==void 0&&l.call("_guiRelayout",xr,Rr,bn)})}}}function st(Kt,yr){if(ae._transitioningWithDuration)return!1;var xr=Math.max(0,Math.min(De,tt*Kt+Ie)),gr=Math.max(0,Math.min(Be,Ke*yr+be)),wr=Math.abs(xr-Ie),zr=Math.abs(gr-be);function Rr(){ht="",Ae.r=Ae.l,Ae.t=Ae.b,nt.attr("d","M0,0Z")}if(Ae.l=Math.min(Ie,xr),Ae.r=Math.max(Ie,xr),Ae.t=Math.min(be,gr),Ae.b=Math.max(be,gr),We.isSubplotConstrained)wr>P||zr>P?(ht="xy",wr/De>zr/Be?(zr=wr*Be/De,be>gr?Ae.t=be-zr:Ae.b=be+zr):(wr=zr*De/Be,Ie>xr?Ae.l=Ie-wr:Ae.r=Ie+wr),nt.attr("d",$(Ae))):Rr();else if(Qe.isSubplotConstrained)if(wr>P||zr>P){ht="xy";var Wr=Math.min(Ae.l/De,(Be-Ae.b)/Be),gn=Math.max(Ae.r/De,(Be-Ae.t)/Be);Ae.l=Wr*De,Ae.r=gn*De,Ae.b=(1-Wr)*Be,Ae.t=(1-gn)*Be,nt.attr("d",$(Ae))}else Rr();else!Ue||zr<Math.min(Math.max(.6*wr,S),P)?wr<S||!Oe?Rr():(Ae.t=0,Ae.b=Be,ht="x",nt.attr("d",function(rn,Zr){return"M"+(rn.l-.5)+","+(Zr-P-.5)+"h-3v"+(2*P+1)+"h3ZM"+(rn.r+.5)+","+(Zr-P-.5)+"h3v"+(2*P+1)+"h-3Z"}(Ae,be))):!Oe||wr<Math.min(.6*zr,P)?(Ae.l=0,Ae.r=De,ht="y",nt.attr("d",function(rn,Zr){return"M"+(Zr-P-.5)+","+(rn.t-.5)+"v-3h"+(2*P+1)+"v3ZM"+(Zr-P-.5)+","+(rn.b+.5)+"v3h"+(2*P+1)+"v-3Z"}(Ae,Ie))):(ht="xy",nt.attr("d",$(Ae)));Ae.w=Ae.r-Ae.l,Ae.h=Ae.b-Ae.t,ht&&(xt=!0),ae._dragged=xt,J(at,nt,Ae,ze,qe,Pe),It(),ae.emit("plotly_relayouting",mt),qe=!0}function It(){mt={},ht!=="xy"&&ht!=="x"||(X(ge,Ae.l/De,Ae.r/De,mt,We.xaxes),Bt("x",mt)),ht!=="xy"&&ht!=="y"||(X(ke,(Be-Ae.b)/Be,(Be-Ae.t)/Be,mt,We.yaxes),Bt("y",mt))}function jt(){It(),U(ae),ar(),G(ae)}Lt.prepFn=function(Kt,yr,xr){var gr=Lt.dragmode,wr=ae._fullLayout.dragmode;wr!==gr&&(Lt.dragmode=wr),je(),tt=ae._fullLayout._invScaleX,Ke=ae._fullLayout._invScaleY,Xe||(Jt?Kt.shiftKey?wr==="pan"?wr="zoom":m(wr)||(wr="pan"):Kt.ctrlKey&&(wr="pan"):wr="pan"),y(wr)?Lt.minDrag=1:Lt.minDrag=void 0,m(wr)?(Lt.xaxes=ge,Lt.yaxes=ke,A(Kt,yr,xr,Lt,wr)):(Lt.clickFn=St,m(gr)&&bt(),Xe||(wr==="zoom"?(Lt.moveFn=st,Lt.doneFn=jt,Lt.minDrag=1,function(zr,Rr,Wr){var gn=Ct.getBoundingClientRect();Ie=Rr-gn.left,be=Wr-gn.top,ae._fullLayout._calcInverseTransform(ae);var rn=h.apply3DTransform(ae._fullLayout._invTransform)(Ie,be);Ie=rn[0],be=rn[1],Ae={l:Ie,r:Ie,w:0,t:be,b:be,h:0},Pe=ae._hmpixcount?ae._hmlumcount/ae._hmpixcount:u(ae._fullLayout.plot_bgcolor).getLuminance(),qe=!1,ht="xy",xt=!1,at=Y(Mt,Pe,Me,Se,ze="M0,0H"+De+"V"+Be+"H0V0"),nt=N(Mt,Me,Se)}(0,yr,xr)):wr==="pan"&&(Lt.moveFn=At,Lt.doneFn=ar))),ae._fullLayout._redrag=function(){var zr=ae._dragdata;if(zr&&zr.element===Ct){var Rr=ae._fullLayout.dragmode;m(Rr)||(je(),Nt([0,0,De,Be]),Lt.moveFn(zr.dx,zr.dy))}}},d.init(Lt);var Ut=[0,0,De,Be],zt=null,Ce=C.REDRAWDELAY,lt=ie.mainplot?ae._fullLayout._plots[ie.mainplot]:ie;function At(Kt,yr){if(Kt*=tt,yr*=Ke,!ae._transitioningWithDuration){if(ae._fullLayout._replotting=!0,Oe==="ew"||Ue==="ns"){var xr=Oe?-Kt:0,gr=Ue?-yr:0;if(Qe.isSubplotConstrained){if(Oe&&Ue){var wr=(Kt/De-yr/Be)/2;xr=-(Kt=wr*De),gr=-(yr=-wr*Be)}Ue?xr=-gr*De/Be:gr=-xr*Be/De}return Oe&&(Q(ge,Kt),Bt("x")),Ue&&(Q(ke,yr),Bt("y")),Nt([xr,gr,De,Be]),Ht(),void ae.emit("plotly_relayouting",mt)}var zr,Rr,Wr=Oe==="w"==(Ue==="n")?1:-1;if(Oe&&Ue&&(We.isSubplotConstrained||Qe.isSubplotConstrained)){var gn=(Kt/De+Wr*yr/Be)/2;Kt=gn*De,yr=Wr*gn*Be}if(Oe==="w"?Kt=Dr(ge,0,Kt):Oe==="e"?Kt=Dr(ge,1,-Kt):Oe||(Kt=0),Ue==="n"?yr=Dr(ke,1,yr):Ue==="s"?yr=Dr(ke,0,-yr):Ue||(yr=0),zr=Oe==="w"?Kt:0,Rr=Ue==="n"?yr:0,We.isSubplotConstrained&&!Qe.isSubplotConstrained||Qe.isSubplotConstrained&&Oe&&Ue&&Wr>0){var rn;if(Qe.isSubplotConstrained||!Oe&&Ue.length===1){for(rn=0;rn<ge.length;rn++)ge[rn].range=ge[rn]._r.slice(),w(ge[rn],1-yr/Be);zr=(Kt=yr*De/Be)/2}if(Qe.isSubplotConstrained||!Ue&&Oe.length===1){for(rn=0;rn<ke.length;rn++)ke[rn].range=ke[rn]._r.slice(),w(ke[rn],1-Kt/De);Rr=(yr=Kt*Be/De)/2}}Qe.isSubplotConstrained&&Ue||Bt("x"),Qe.isSubplotConstrained&&Oe||Bt("y");var Zr=De-Kt,bn=Be-yr;!Qe.isSubplotConstrained||Oe&&Ue||(Oe?(Rr=zr?0:Kt*Be/De,bn=Zr*Be/De):(zr=Rr?0:yr*De/Be,Zr=bn*De/Be)),Nt([zr,Rr,Zr,bn]),Ht(),ae.emit("plotly_relayouting",mt)}function Dr(br,Xr,fn){for(var Qr,un,Pn=1-Xr,kn=0;kn<br.length;kn++){var Hn=br[kn];if(!Hn.fixedrange){Qr=Hn,un=Hn._rl[Pn]+(Hn._rl[Xr]-Hn._rl[Pn])/Z(fn/Hn._length);var aa=Hn.l2r(un);aa!==!1&&aa!==void 0&&(Hn.range[Xr]=aa)}}return Qr._length*(Qr._rl[Xr]-un)/(Qr._rl[Xr]-Qr._rl[Pn])}}function Bt(Kt,yr){for(var xr=Qe.isSubplotConstrained?{x:ke,y:ge}[Kt]:Qe[Kt+"axes"],gr=Qe.isSubplotConstrained?{x:ge,y:ke}[Kt]:[],wr=0;wr<xr.length;wr++){var zr=xr[wr],Rr=zr._id,Wr=Qe.xLinks[Rr]||Qe.yLinks[Rr],gn=gr[0]||xe[Wr]||fe[Wr];gn&&(yr?(yr[zr._name+".range[0]"]=yr[gn._name+".range[0]"],yr[zr._name+".range[1]"]=yr[gn._name+".range[1]"]):zr.range=gn.range.slice())}}function Ht(){var Kt,yr=[];function xr(zr){for(Kt=0;Kt<zr.length;Kt++)zr[Kt].fixedrange||yr.push(zr[Kt]._id)}for(Ye&&(xr(ge),xr(We.xaxes),xr(Qe.xaxes)),$e&&(xr(ke),xr(We.yaxes),xr(Qe.yaxes)),mt={},Kt=0;Kt<yr.length;Kt++){var gr=yr[Kt],wr=E(ae,gr);c.drawOne(ae,wr,{skipTitle:!0}),mt[wr._name+".range[0]"]=wr.range[0],mt[wr._name+".range[1]"]=wr.range[1]}c.redrawComponents(ae,yr)}function or(){if(!ae._transitioningWithDuration){var Kt=ae._context.doubleClick,yr=[];Oe&&(yr=yr.concat(ge)),Ue&&(yr=yr.concat(ke)),Qe.xaxes&&(yr=yr.concat(Qe.xaxes)),Qe.yaxes&&(yr=yr.concat(Qe.yaxes));var xr,gr,wr,zr={};if(Kt==="reset+autosize"){for(Kt="autosize",gr=0;gr<yr.length;gr++)if((xr=yr[gr])._rangeInitial&&(xr.range[0]!==xr._rangeInitial[0]||xr.range[1]!==xr._rangeInitial[1])||!xr._rangeInitial&&!xr.autorange){Kt="reset";break}}if(Kt==="autosize")for(gr=0;gr<yr.length;gr++)(xr=yr[gr]).fixedrange||(zr[xr._name+".autorange"]=!0);else if(Kt==="reset")for((Oe||We.isSubplotConstrained)&&(yr=yr.concat(We.xaxes)),Ue&&!We.isSubplotConstrained&&(yr=yr.concat(We.yaxes)),We.isSubplotConstrained&&(Oe?Ue||(yr=yr.concat(ke)):yr=yr.concat(ge)),gr=0;gr<yr.length;gr++)(xr=yr[gr]).fixedrange||(xr._rangeInitial?(wr=xr._rangeInitial,zr[xr._name+".range[0]"]=wr[0],zr[xr._name+".range[1]"]=wr[1]):zr[xr._name+".autorange"]=!0);ae.emit("plotly_doubleclick",null),l.call("_guiRelayout",ae,zr)}}function ar(){Nt([0,0,De,Be]),h.syncOrAsync([k.previousPromises,function(){ae._fullLayout._replotting=!1,l.call("_guiRelayout",ae,mt)}],ae)}function Nt(Kt){var yr,xr,gr,wr,zr=ae._fullLayout,Rr=zr._plots,Wr=zr._subplots.cartesian;if(ot&&l.subplotsRegistry.splom.drag(ae),it){for(yr=0;yr<Wr.length;yr++)if(gr=(xr=Rr[Wr[yr]]).xaxis,wr=xr.yaxis,xr._scene){var gn=h.simpleMap(gr.range,gr.r2l),rn=h.simpleMap(wr.range,wr.r2l);xr._scene.update({range:[gn[0],rn[0],gn[1],rn[1]]})}}if((ot||it)&&(T(ae),_(ae)),Et){var Zr=Kt[2]/Le._length,bn=Kt[3]/Te._length;for(yr=0;yr<Wr.length;yr++){gr=(xr=Rr[Wr[yr]]).xaxis,wr=xr.yaxis;var Dr,br,Xr,fn,Qr=(Ye||Qe.isSubplotConstrained)&&!gr.fixedrange&&xe[gr._id],un=($e||Qe.isSubplotConstrained)&&!wr.fixedrange&&fe[wr._id];if(Qr?(Dr=Zr,Xr=Ee||Qe.isSubplotConstrained?Kt[0]:dr(gr,Dr)):Qe.xaHash[gr._id]?(Dr=Zr,Xr=Kt[0]*gr._length/Le._length):Qe.yaHash[gr._id]?(Dr=bn,Xr=Ue==="ns"?-Kt[1]*gr._length/Te._length:dr(gr,Dr,{n:"top",s:"bottom"}[Ue])):Xr=Lr(gr,Dr=nr(gr,Zr,bn)),un?(br=bn,fn=ve||Qe.isSubplotConstrained?Kt[1]:dr(wr,br)):Qe.yaHash[wr._id]?(br=bn,fn=Kt[1]*wr._length/Te._length):Qe.xaHash[wr._id]?(br=Zr,fn=Oe==="ew"?-Kt[0]*wr._length/Le._length:dr(wr,br,{e:"right",w:"left"}[Oe])):fn=Lr(wr,br=nr(wr,Zr,bn)),Dr||br){Dr||(Dr=1),br||(br=1);var Pn=gr._offset-Xr/Dr,kn=wr._offset-fn/br;xr.clipRect.call(s.setTranslate,Xr,fn).call(s.setScale,Dr,br),xr.plot.call(s.setTranslate,Pn,kn).call(s.setScale,1/Dr,1/br),Dr===xr.xScaleFactor&&br===xr.yScaleFactor||(s.setPointGroupScale(xr.zoomScalePts,Dr,br),s.setTextPointsScale(xr.zoomScaleTxt,Dr,br)),s.hideOutsideRangePoints(xr.clipOnAxisFalseTraces,xr),xr.xScaleFactor=Dr,xr.yScaleFactor=br}}}}function nr(Kt,yr,xr){return Kt.fixedrange?0:Ye&&We.xaHash[Kt._id]?yr:$e&&(We.isSubplotConstrained?We.xaHash:We.yaHash)[Kt._id]?xr:0}function Lr(Kt,yr){return yr?(Kt.range=Kt._r.slice(),w(Kt,yr),dr(Kt,yr)):0}function dr(Kt,yr,xr){return Kt._length*(1-yr)*v[xr||Kt.constraintoward||"middle"]}return ve.length*Ee.length!=1&&re(Ct,function(Kt){if(ae._context._scrollZoom.cartesian||ae._fullLayout._enablescrollzoom){if(bt(),ae._transitioningWithDuration)return Kt.preventDefault(),void Kt.stopPropagation();je(),clearTimeout(zt);var yr=-Kt.deltaY;if(isFinite(yr)||(yr=Kt.wheelDelta/10),isFinite(yr)){var xr,gr=Math.exp(-Math.min(Math.max(yr,-20),20)/200),wr=lt.draglayer.select(".nsewdrag").node().getBoundingClientRect(),zr=(Kt.clientX-wr.left)/wr.width,Rr=(wr.bottom-Kt.clientY)/wr.height;if(Ye){for(Ee||(zr=.5),xr=0;xr<ge.length;xr++)Wr(ge[xr],zr,gr);Bt("x"),Ut[2]*=gr,Ut[0]+=Ut[2]*zr*(1/gr-1)}if($e){for(ve||(Rr=.5),xr=0;xr<ke.length;xr++)Wr(ke[xr],Rr,gr);Bt("y"),Ut[3]*=gr,Ut[1]+=Ut[3]*(1-Rr)*(1/gr-1)}Nt(Ut),Ht(),ae.emit("plotly_relayouting",mt),zt=setTimeout(function(){ae._fullLayout&&(Ut=[0,0,De,Be],ar())},Ce),Kt.preventDefault()}else h.log("Did not find wheel motion attributes: ",Kt)}function Wr(gn,rn,Zr){if(!gn.fixedrange){var bn=h.simpleMap(gn.range,gn.r2l),Dr=bn[0]+(bn[1]-bn[0])*rn;gn.range=bn.map(function(br){return gn.l2r(Dr+(br-Dr)*Zr)})}}}),Ct},makeDragger:F,makeRectDragger:q,makeZoombox:Y,makeCorners:N,updateZoombox:J,xyCorners:$,transitionZoombox:D,removeZoombox:U,showDoubleClickNotifier:G,attachWheelEventHandler:re}},{"../../components/color":666,"../../components/dragelement":685,"../../components/dragelement/helpers":684,"../../components/drawing":688,"../../components/fx":706,"../../constants/alignment":771,"../../lib":803,"../../lib/clear_gl_canvases":787,"../../lib/setcursor":824,"../../lib/svg_text_utils":829,"../../plot_api/subroutines":844,"../../registry":931,"../plots":917,"./axes":854,"./axis_ids":858,"./constants":861,"./scale_zoom":873,"./select":874,"@plotly/d3":58,"has-passive-events":444,tinycolor2:598}],864:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/fx"),p=i("../../components/dragelement"),u=i("../../lib/setcursor"),e=i("./dragbox").makeDragBox,l=i("./constants").DRAGGERSIZE;V.initInteractions=function(o){var a=o._fullLayout;if(o._context.staticPlot)t.select(o).selectAll(".drag").remove();else if(a._has("cartesian")||a._has("splom")){Object.keys(a._plots||{}).sort(function(s,r){if((a._plots[s].mainplot&&!0)===(a._plots[r].mainplot&&!0)){var c=s.split("y"),f=r.split("y");return c[0]===f[0]?Number(c[1]||1)-Number(f[1]||1):Number(c[0]||1)-Number(f[0]||1)}return a._plots[s].mainplot?1:-1}).forEach(function(s){var r=a._plots[s],c=r.xaxis,f=r.yaxis;if(!r.mainplot){var d=e(o,r,c._offset,f._offset,c._length,f._length,"ns","ew");d.onmousemove=function(y){o._fullLayout._rehover=function(){o._fullLayout._hoversubplot===s&&o._fullLayout._plots[s]&&h.hover(o,y,s)},h.hover(o,y,s),o._fullLayout._lasthover=d,o._fullLayout._hoversubplot=s},d.onmouseout=function(y){o._dragging||(o._fullLayout._hoversubplot=null,p.unhover(o,y))},o._context.showAxisDragHandles&&(e(o,r,c._offset-l,f._offset-l,l,l,"n","w"),e(o,r,c._offset+c._length,f._offset-l,l,l,"n","e"),e(o,r,c._offset-l,f._offset+f._length,l,l,"s","w"),e(o,r,c._offset+c._length,f._offset+f._length,l,l,"s","e"))}if(o._context.showAxisDragHandles){if(s===c._mainSubplot){var g=c._mainLinePosition;c.side==="top"&&(g-=l),e(o,r,c._offset+.1*c._length,g,.8*c._length,l,"","ew"),e(o,r,c._offset,g,.1*c._length,l,"","w"),e(o,r,c._offset+.9*c._length,g,.1*c._length,l,"","e")}if(s===f._mainSubplot){var m=f._mainLinePosition;f.side!=="right"&&(m-=l),e(o,r,m,f._offset+.1*f._length,l,.8*f._length,"ns",""),e(o,r,m,f._offset+.9*f._length,l,.1*f._length,"s",""),e(o,r,m,f._offset,l,.1*f._length,"n","")}}});var n=a._hoverlayer.node();n.onmousemove=function(s){s.target=o._fullLayout._lasthover,h.hover(o,s,a._hoversubplot)},n.onclick=function(s){s.target=o._fullLayout._lasthover,h.click(o,s)},n.onmousedown=function(s){o._fullLayout._lasthover.onmousedown(s)},V.updateFx(o)}},V.updateFx=function(o){var a=o._fullLayout,n=a.dragmode==="pan"?"move":"crosshair";u(a._draggers,n)}},{"../../components/dragelement":685,"../../components/fx":706,"../../lib/setcursor":824,"./constants":861,"./dragbox":863,"@plotly/d3":58}],865:[function(i,B,V){B.exports={clearOutlineControllers:function(t){var h=t._fullLayout._zoomlayer;h&&h.selectAll(".outline-controllers").remove()},clearSelect:function(t){var h=t._fullLayout._zoomlayer;h&&h.selectAll(".select-outline").remove(),t._fullLayout._drawing=!1}}},{}],866:[function(i,B,V){var t=i("../../lib").strTranslate;function h(p,u){switch(p.type){case"log":return p.p2d(u);case"date":return p.p2r(u,0,p.calendar);default:return p.p2r(u)}}B.exports={p2r:h,r2p:function(p,u){switch(p.type){case"log":return p.d2p(u);case"date":return p.r2p(u,0,p.calendar);default:return p.r2p(u)}},axValue:function(p){var u=p._id.charAt(0)==="y"?1:0;return function(e){return h(p,e[u])}},getTransform:function(p){return t(p.xaxis._offset,p.yaxis._offset)}}},{"../../lib":803}],867:[function(i,B,V){var t=i("../../registry"),h=i("../../lib"),p=i("./axis_ids");B.exports=function(u){return function(e,l){var o=e[u];if(Array.isArray(o))for(var a=t.subplotsRegistry.cartesian,n=a.idRegex,s=l._subplots,r=s.xaxis,c=s.yaxis,f=s.cartesian,d=l._has("cartesian")||l._has("gl2d"),g=0;g<o.length;g++){var m=o[g];if(h.isPlainObject(m)){var y=p.cleanId(m.xref,"x",!1),v=p.cleanId(m.yref,"y",!1),T=n.x.test(y),_=n.y.test(v);if(T||_){d||h.pushUnique(l._basePlotModules,a);var k=!1;T&&r.indexOf(y)===-1&&(r.push(y),k=!0),_&&c.indexOf(v)===-1&&(c.push(v),k=!0),k&&T&&_&&f.push(y+v)}}}}}},{"../../lib":803,"../../registry":931,"./axis_ids":858}],868:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../registry"),p=i("../../lib"),u=i("../plots"),e=i("../../components/drawing"),l=i("../get_data").getModuleCalcData,o=i("./axis_ids"),a=i("./constants"),n=i("../../constants/xmlns_namespaces"),s=p.ensureSingle;function r(m,y,v){return p.ensureSingle(m,y,v,function(T){T.datum(v)})}function c(m,y,v,T,_){for(var k,E,A,b=a.traceLayerClasses,L=m._fullLayout,w=L._modules,C=[],S=[],P=0;P<w.length;P++){var z=(k=w[P]).name,F=h.modules[z].categories;if(F.svg){var q=k.layerName||z+"layer",W=k.plot;A=(E=l(v,W))[0],v=E[1],A.length&&C.push({i:b.indexOf(q),className:q,plotMethod:W,cdModule:A}),F.zoomScale&&S.push("."+q)}}C.sort(function(Z,Y){return Z.i-Y.i});var X=y.plot.selectAll("g.mlayer").data(C,function(Z){return Z.className});if(X.enter().append("g").attr("class",function(Z){return Z.className}).classed("mlayer",!0).classed("rangeplot",y.isRangePlot),X.exit().remove(),X.order(),X.each(function(Z){var Y=t.select(this),N=Z.className;Z.plotMethod(m,y,Z.cdModule,Y,T,_),a.clipOnAxisFalseQuery.indexOf("."+N)===-1&&e.setClipUrl(Y,y.layerClipId,m)}),L._has("scattergl")&&(k=h.getModule("scattergl"),A=l(v,k)[0],k.plot(m,y,A)),!m._context.staticPlot&&(y._hasClipOnAxisFalse&&(y.clipOnAxisFalseTraces=y.plot.selectAll(a.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),S.length)){var Q=y.plot.selectAll(S.join(",")).selectAll(".trace");y.zoomScalePts=Q.selectAll("path.point"),y.zoomScaleTxt=Q.selectAll(".textpoint")}}function f(m,y){var v=y.plotgroup,T=y.id,_=a.layerValue2layerClass[y.xaxis.layer],k=a.layerValue2layerClass[y.yaxis.layer],E=m._fullLayout._hasOnlyLargeSploms;if(y.mainplot){var A=y.mainplotinfo,b=A.plotgroup,L=T+"-x",w=T+"-y";y.gridlayer=A.gridlayer,y.zerolinelayer=A.zerolinelayer,s(A.overlinesBelow,"path",L),s(A.overlinesBelow,"path",w),s(A.overaxesBelow,"g",L),s(A.overaxesBelow,"g",w),y.plot=s(A.overplot,"g",T),s(A.overlinesAbove,"path",L),s(A.overlinesAbove,"path",w),s(A.overaxesAbove,"g",L),s(A.overaxesAbove,"g",w),y.xlines=b.select(".overlines-"+_).select("."+L),y.ylines=b.select(".overlines-"+k).select("."+w),y.xaxislayer=b.select(".overaxes-"+_).select("."+L),y.yaxislayer=b.select(".overaxes-"+k).select("."+w)}else if(E)y.xlines=s(v,"path","xlines-above"),y.ylines=s(v,"path","ylines-above"),y.xaxislayer=s(v,"g","xaxislayer-above"),y.yaxislayer=s(v,"g","yaxislayer-above");else{var C=s(v,"g","layer-subplot");y.shapelayer=s(C,"g","shapelayer"),y.imagelayer=s(C,"g","imagelayer"),y.gridlayer=s(v,"g","gridlayer"),y.zerolinelayer=s(v,"g","zerolinelayer"),s(v,"path","xlines-below"),s(v,"path","ylines-below"),y.overlinesBelow=s(v,"g","overlines-below"),s(v,"g","xaxislayer-below"),s(v,"g","yaxislayer-below"),y.overaxesBelow=s(v,"g","overaxes-below"),y.plot=s(v,"g","plot"),y.overplot=s(v,"g","overplot"),y.xlines=s(v,"path","xlines-above"),y.ylines=s(v,"path","ylines-above"),y.overlinesAbove=s(v,"g","overlines-above"),s(v,"g","xaxislayer-above"),s(v,"g","yaxislayer-above"),y.overaxesAbove=s(v,"g","overaxes-above"),y.xlines=v.select(".xlines-"+_),y.ylines=v.select(".ylines-"+k),y.xaxislayer=v.select(".xaxislayer-"+_),y.yaxislayer=v.select(".yaxislayer-"+k)}E||(r(y.gridlayer,"g",y.xaxis._id),r(y.gridlayer,"g",y.yaxis._id),y.gridlayer.selectAll("g").map(function(S){return S[0]}).sort(o.idSort)),y.xlines.style("fill","none").classed("crisp",!0),y.ylines.style("fill","none").classed("crisp",!0)}function d(m,y){if(m){var v={};for(var T in m.each(function(A){var b=A[0];t.select(this).remove(),g(b,y),v[b]=!0}),y._plots)for(var _=y._plots[T].overlays||[],k=0;k<_.length;k++){var E=_[k];v[E.id]&&E.plot.selectAll(".trace").remove()}}}function g(m,y){y._draggers.selectAll("g."+m).remove(),y._defs.select("#clip"+y._uid+m+"plot").remove()}V.name="cartesian",V.attr=["xaxis","yaxis"],V.idRoot=["x","y"],V.idRegex=a.idRegex,V.attrRegex=a.attrRegex,V.attributes=i("./attributes"),V.layoutAttributes=i("./layout_attributes"),V.supplyLayoutDefaults=i("./layout_defaults"),V.transitionAxes=i("./transition_axes"),V.finalizeSubplots=function(m,y){var v,T,_,k=y._subplots,E=k.xaxis,A=k.yaxis,b=k.cartesian,L=b.concat(k.gl2d||[]),w={},C={};for(v=0;v<L.length;v++){var S=L[v].split("y");w[S[0]]=1,C["y"+S[1]]=1}for(v=0;v<E.length;v++)w[T=E[v]]||(_=(m[o.id2name(T)]||{}).anchor,a.idRegex.y.test(_)||(_="y"),b.push(T+_),L.push(T+_),C[_]||(C[_]=1,p.pushUnique(A,_)));for(v=0;v<A.length;v++)C[_=A[v]]||(T=(m[o.id2name(_)]||{}).anchor,a.idRegex.x.test(T)||(T="x"),b.push(T+_),L.push(T+_),w[T]||(w[T]=1,p.pushUnique(E,T)));if(!L.length){for(var P in T="",_="",m)a.attrRegex.test(P)&&(P.charAt(0)==="x"?(!T||+P.substr(5)<+T.substr(5))&&(T=P):(!_||+P.substr(5)<+_.substr(5))&&(_=P));T=T?o.name2id(T):"x",_=_?o.name2id(_):"y",E.push(T),A.push(_),b.push(T+_)}},V.plot=function(m,y,v,T){var _,k=m._fullLayout,E=k._subplots.cartesian,A=m.calcdata;if(!Array.isArray(y))for(y=[],_=0;_<A.length;_++)y.push(_);for(_=0;_<E.length;_++){for(var b,L=E[_],w=k._plots[L],C=[],S=0;S<A.length;S++){var P=A[S],z=P[0].trace;z.xaxis+z.yaxis===L&&((y.indexOf(z.index)!==-1||z.carpet)&&(b&&b[0].trace.xaxis+b[0].trace.yaxis===L&&["tonextx","tonexty","tonext"].indexOf(z.fill)!==-1&&C.indexOf(b)===-1&&C.push(b),C.push(P)),b=P)}c(m,w,C,v,T)}},V.clean=function(m,y,v,T){var _,k,E,A=T._plots||{},b=y._plots||{},L=T._subplots||{};if(T._hasOnlyLargeSploms&&!y._hasOnlyLargeSploms)for(E in A)(_=A[E]).plotgroup&&_.plotgroup.remove();var w=T._has&&T._has("gl"),C=y._has&&y._has("gl");if(w&&!C)for(E in A)(_=A[E])._scene&&_._scene.destroy();if(L.xaxis&&L.yaxis){var S=o.listIds({_fullLayout:T});for(k=0;k<S.length;k++){var P=S[k];y[o.id2name(P)]||T._infolayer.selectAll(".g-"+P+"title").remove()}}var z=T._has&&T._has("cartesian"),F=y._has&&y._has("cartesian");if(z&&!F)d(T._cartesianlayer.selectAll(".subplot"),T),T._defs.selectAll(".axesclip").remove(),delete T._axisConstraintGroups,delete T._axisMatchGroups;else if(L.cartesian)for(k=0;k<L.cartesian.length;k++){var q=L.cartesian[k];if(!b[q]){var W="."+q+",."+q+"-x,."+q+"-y";T._cartesianlayer.selectAll(W).remove(),g(q,T)}}},V.drawFramework=function(m){var y=m._fullLayout,v=function(_){var k,E,A,b,L,w,C=_._fullLayout,S=C._subplots.cartesian,P=S.length,z=[],F=[];for(k=0;k<P;k++){A=S[k],b=C._plots[A],L=b.xaxis,w=b.yaxis;var q=L._mainAxis,W=w._mainAxis,X=q._id+W._id,Q=C._plots[X];b.overlays=[],X!==A&&Q?(b.mainplot=X,b.mainplotinfo=Q,F.push(A)):(b.mainplot=void 0,b.mainplotinfo=void 0,z.push(A))}for(k=0;k<F.length;k++)A=F[k],(b=C._plots[A]).mainplotinfo.overlays.push(b);var Z=z.concat(F),Y=new Array(P);for(k=0;k<P;k++){A=Z[k],b=C._plots[A],L=b.xaxis,w=b.yaxis;var N=[A,L.layer,w.layer,L.overlaying||"",w.overlaying||""];for(E=0;E<b.overlays.length;E++)N.push(b.overlays[E].id);Y[k]=N}return Y}(m),T=y._cartesianlayer.selectAll(".subplot").data(v,String);T.enter().append("g").attr("class",function(_){return"subplot "+_[0]}),T.order(),T.exit().call(d,y),T.each(function(_){var k=_[0],E=y._plots[k];E.plotgroup=t.select(this),f(m,E),E.draglayer=s(y._draggers,"g",k)})},V.rangePlot=function(m,y,v){f(m,y),c(m,y,v),u.style(m)},V.toSVG=function(m){var y=m._fullLayout._glimages,v=t.select(m).selectAll(".svg-container");v.filter(function(T,_){return _===v.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var T=this.toDataURL("image/png");y.append("svg:image").attr({xmlns:n.svg,"xlink:href":T,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},V.updateFx=i("./graph_interact").updateFx},{"../../components/drawing":688,"../../constants/xmlns_namespaces":780,"../../lib":803,"../../registry":931,"../get_data":891,"../plots":917,"./attributes":852,"./axis_ids":858,"./constants":861,"./graph_interact":864,"./layout_attributes":869,"./layout_defaults":870,"./transition_axes":879,"@plotly/d3":58}],869:[function(i,B,V){var t=i("../font_attributes"),h=i("../../components/color/attributes"),p=i("../../components/drawing/attributes").dash,u=i("../../lib/extend").extendFlat,e=i("../../plot_api/plot_template").templatedArray,l=i("../../plots/cartesian/axis_format_attributes").descriptionWithDates,o=i("../../constants/numerical").ONEDAY,a=i("./constants"),n=a.HOUR_PATTERN,s=a.WEEKDAY_PATTERN;B.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:h.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:t({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[s,n,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:o},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:h.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:u({},p,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:t({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:l("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:l("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:h.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:h.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:h.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:h.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:t({editType:"ticks"})}}},{"../../components/color/attributes":665,"../../components/drawing/attributes":687,"../../constants/numerical":779,"../../lib/extend":793,"../../plot_api/plot_template":843,"../../plots/cartesian/axis_format_attributes":857,"../font_attributes":883,"./constants":861}],870:[function(i,B,V){var t=i("../../lib"),h=i("../../components/color"),p=i("../../components/fx/helpers").isUnifiedHover,u=i("../../components/fx/hovermode_defaults"),e=i("../../plot_api/plot_template"),l=i("../layout_attributes"),o=i("./layout_attributes"),a=i("./type_defaults"),n=i("./axis_defaults"),s=i("./constraints"),r=i("./position_defaults"),c=i("./axis_ids"),f=c.id2name,d=c.name2id,g=i("./constants").AX_ID_PATTERN,m=i("../../registry"),y=m.traceIs,v=m.getComponentMethod;function T(_,k,E){Array.isArray(_[k])?_[k].push(E):_[k]=[E]}B.exports=function(_,k,E){var A,b,L=k.autotypenumbers,w={},C={},S={},P={},z={},F={},q={},W={},X={},Q={};for(A=0;A<E.length;A++){var Z=E[A];if(y(Z,"cartesian")||y(Z,"gl2d")){var Y,N;if(Z.xaxis)Y=f(Z.xaxis),T(w,Y,Z);else if(Z.xaxes)for(b=0;b<Z.xaxes.length;b++)T(w,f(Z.xaxes[b]),Z);if(Z.yaxis)N=f(Z.yaxis),T(w,N,Z);else if(Z.yaxes)for(b=0;b<Z.yaxes.length;b++)T(w,f(Z.yaxes[b]),Z);Z.type==="funnel"?Z.orientation==="h"?(Y&&(C[Y]=!0),N&&(q[N]=!0)):N&&(S[N]=!0):Z.type==="image"?(N&&(W[N]=!0),Y&&(W[Y]=!0)):(N&&(z[N]=!0,F[N]=!0),y(Z,"carpet")&&(Z.type!=="carpet"||Z._cheater)||Y&&(P[Y]=!0)),Z.type==="carpet"&&Z._cheater&&Y&&(C[Y]=!0),y(Z,"2dMap")&&(X[Y]=!0,X[N]=!0),y(Z,"oriented")&&(Q[Z.orientation==="h"?N:Y]=!0)}}var J=k._subplots,D=J.xaxis,U=J.yaxis,G=t.simpleMap(D,f),$=t.simpleMap(U,f),K=G.concat($),re=h.background;D.length&&U.length&&(re=t.coerce(_,k,l,"plot_bgcolor"));var ne,ae,ie,he,se,de=h.combine(re,k.paper_bgcolor);function ce(){var Ke=w[ne]||[];se._traceIndices=Ke.map(function(Mt){return Mt._expandedIndex}),se._annIndices=[],se._shapeIndices=[],se._imgIndices=[],se._subplotsWith=[],se._counterAxes=[],se._name=se._attr=ne,se._id=ae}function ve(Ke,Mt){return t.coerce(he,se,o,Ke,Mt)}function Ee(Ke,Mt){return t.coerce2(he,se,o,Ke,Mt)}function Le(Ke){return Ke==="x"?U:D}function Te(Ke,Mt){for(var Jt=Ke==="x"?G:$,$t=[],je=0;je<Jt.length;je++){var Ge=Jt[je];Ge===Mt||(_[Ge]||{}).overlaying||$t.push(d(Ge))}return $t}var xe={x:Le("x"),y:Le("y")},fe=xe.x.concat(xe.y),ge={},ke=[];function Me(){var Ke=he.matches;g.test(Ke)&&fe.indexOf(Ke)===-1&&(ge[Ke]=he.type,ke=Object.keys(ge))}var Se=u(_,k),De=p(Se);for(A=0;A<K.length;A++){ne=K[A],ae=d(ne),ie=ne.charAt(0),t.isPlainObject(_[ne])||(_[ne]={}),he=_[ne],se=e.newContainer(k,ne,ie+"axis"),ce();var Be=ie==="x"&&!P[ne]&&C[ne]||ie==="y"&&!z[ne]&&S[ne],We=ie==="y"&&(!F[ne]&&q[ne]||W[ne]),Qe={letter:ie,font:k.font,outerTicks:X[ne],showGrid:!Q[ne],data:w[ne]||[],bgColor:de,calendar:k.calendar,automargin:!0,visibleDflt:Be,reverseDflt:We,autotypenumbersDflt:L,splomStash:((k._splomAxes||{})[ie]||{})[ae]};ve("uirevision",k.uirevision),a(he,se,ve,Qe),n(he,se,ve,Qe,k);var Oe=De&&ie===Se.charAt(0),Ue=Ee("spikecolor",De?se.color:void 0),Xe=Ee("spikethickness",De?1.5:void 0),Ye=Ee("spikedash",De?"dot":void 0),$e=Ee("spikemode",De?"across":void 0),it=Ee("spikesnap");ve("showspikes",!!(Oe||Ue||Xe||Ye||$e||it))||(delete se.spikecolor,delete se.spikethickness,delete se.spikedash,delete se.spikemode,delete se.spikesnap),r(he,se,ve,{letter:ie,counterAxes:xe[ie],overlayableAxes:Te(ie,ne),grid:k.grid}),ve("title.standoff"),Me(),se._input=he}for(A=0;A<ke.length;){ae=ke[A++],ie=(ne=f(ae)).charAt(0),t.isPlainObject(_[ne])||(_[ne]={}),he=_[ne],se=e.newContainer(k,ne,ie+"axis"),ce();var ot={letter:ie,font:k.font,outerTicks:X[ne],showGrid:!Q[ne],data:[],bgColor:de,calendar:k.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:L,splomStash:((k._splomAxes||{})[ie]||{})[ae]};ve("uirevision",k.uirevision),se.type=ge[ae]||"linear",n(he,se,ve,ot,k),r(he,se,ve,{letter:ie,counterAxes:xe[ie],overlayableAxes:Te(ie,ne),grid:k.grid}),ve("fixedrange"),Me(),se._input=he}var Et=v("rangeslider","handleDefaults"),mt=v("rangeselector","handleDefaults");for(A=0;A<G.length;A++)ne=G[A],he=_[ne],se=k[ne],Et(_,k,ne),se.type==="date"&&mt(he,se,k,$,se.calendar),ve("fixedrange");for(A=0;A<$.length;A++){ne=$[A],he=_[ne],se=k[ne];var tt=k[f(se.anchor)];ve("fixedrange",v("rangeslider","isVisible")(tt))}s.handleDefaults(_,k,{axIds:fe.concat(ke).sort(c.idSort),axHasImage:W})}},{"../../components/color":666,"../../components/fx/helpers":702,"../../components/fx/hovermode_defaults":705,"../../lib":803,"../../plot_api/plot_template":843,"../../registry":931,"../layout_attributes":908,"./axis_defaults":856,"./axis_ids":858,"./constants":861,"./constraints":862,"./layout_attributes":869,"./position_defaults":872,"./type_defaults":880}],871:[function(i,B,V){var t=i("tinycolor2").mix,h=i("../../components/color/attributes").lightFraction,p=i("../../lib");B.exports=function(u,e,l,o){var a=(o=o||{}).dfltColor;function n(m,y){return p.coerce2(u,e,o.attributes,m,y)}var s=n("linecolor",a),r=n("linewidth");l("showline",o.showLine||!!s||!!r)||(delete e.linecolor,delete e.linewidth);var c=n("gridcolor",t(a,o.bgColor,o.blend||h).toRgbString()),f=n("gridwidth");if(l("showgrid",o.showGrid||!!c||!!f)||(delete e.gridcolor,delete e.gridwidth),!o.noZeroLine){var d=n("zerolinecolor",a),g=n("zerolinewidth");l("zeroline",o.showGrid||!!d||!!g)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":665,"../../lib":803,tinycolor2:598}],872:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib");B.exports=function(p,u,e,l){var o,a,n,s,r=l.counterAxes||[],c=l.overlayableAxes||[],f=l.letter,d=l.grid;d&&(a=d._domains[f][d._axisMap[u._id]],o=d._anchors[u._id],a&&(n=d[f+"side"].split(" ")[0],s=d.domain[f][n==="right"||n==="top"?1:0])),a=a||[0,1],o=o||(t(p.position)?"free":r[0]||"free"),n=n||(f==="x"?"bottom":"left"),s=s||0,h.coerce(p,u,{anchor:{valType:"enumerated",values:["free"].concat(r),dflt:o}},"anchor")==="free"&&e("position",s),h.coerce(p,u,{side:{valType:"enumerated",values:f==="x"?["bottom","top"]:["left","right"],dflt:n}},"side");var g=!1;if(c.length&&(g=h.coerce(p,u,{overlaying:{valType:"enumerated",values:[!1].concat(c),dflt:!1}},"overlaying")),!g){var m=e("domain",a);m[0]>m[1]-1/4096&&(u.domain=a),h.noneOrAll(p.domain,u.domain,a)}return e("layer"),u}},{"../../lib":803,"fast-isnumeric":249}],873:[function(i,B,V){var t=i("../../constants/alignment").FROM_BL;B.exports=function(h,p,u){u===void 0&&(u=t[h.constraintoward||"center"]);var e=[h.r2l(h.range[0]),h.r2l(h.range[1])],l=e[0]+(e[1]-e[0])*u;h.range=h._input.range=[h.l2r(l+(e[0]-l)*p),h.l2r(l+(e[1]-l)*p)],h.setScale()}},{"../../constants/alignment":771}],874:[function(i,B,V){var t=i("polybooljs"),h=i("../../registry"),p=i("../../components/drawing").dashStyle,u=i("../../components/color"),e=i("../../components/fx"),l=i("../../components/fx/helpers").makeEventData,o=i("../../components/dragelement/helpers"),a=o.freeMode,n=o.rectMode,s=o.drawMode,r=o.openMode,c=o.selectMode,f=i("../../components/shapes/draw_newshape/display_outlines"),d=i("../../components/shapes/draw_newshape/helpers").handleEllipse,g=i("../../components/shapes/draw_newshape/newshapes"),m=i("../../lib"),y=i("../../lib/polygon"),v=i("../../lib/throttle"),T=i("./axis_ids").getFromId,_=i("../../lib/clear_gl_canvases"),k=i("../../plot_api/subroutines").redrawReglTraces,E=i("./constants"),A=E.MINSELECT,b=y.filter,L=y.tester,w=i("./handle_outline").clearSelect,C=i("./helpers"),S=C.p2r,P=C.axValue,z=C.getTransform;function F(G,$,K,re,ne,ae,ie){var he,se,de,ce,ve,Ee,Le,Te,xe,fe=$._hoverdata,ge=$._fullLayout.clickmode.indexOf("event")>-1,ke=[];if(function(We){return We&&Array.isArray(We)&&We[0].hoverOnBox!==!0}(fe)){Q(G,$,ae);var Me=function(We,Qe){var Oe,Ue,Xe=We[0],Ye=-1,$e=[];for(Ue=0;Ue<Qe.length;Ue++)if(Oe=Qe[Ue],Xe.fullData._expandedIndex===Oe.cd[0].trace._expandedIndex){if(Xe.hoverOnBox===!0)break;Xe.pointNumber!==void 0?Ye=Xe.pointNumber:Xe.binNumber!==void 0&&(Ye=Xe.binNumber,$e=Xe.pointNumbers);break}return{pointNumber:Ye,pointNumbers:$e,searchInfo:Oe}}(fe,he=Y($,K,re,ne));if(Me.pointNumbers.length>0?function(We,Qe){var Oe,Ue,Xe,Ye=[];for(Xe=0;Xe<We.length;Xe++)(Oe=We[Xe]).cd[0].trace.selectedpoints&&Oe.cd[0].trace.selectedpoints.length>0&&Ye.push(Oe);if(Ye.length===1&&Ye[0]===Qe.searchInfo&&(Ue=Qe.searchInfo.cd[0].trace).selectedpoints.length===Qe.pointNumbers.length){for(Xe=0;Xe<Qe.pointNumbers.length;Xe++)if(Ue.selectedpoints.indexOf(Qe.pointNumbers[Xe])<0)return!1;return!0}return!1}(he,Me):function(We){var Qe,Oe,Ue,Xe=0;for(Ue=0;Ue<We.length;Ue++)if(Qe=We[Ue],(Oe=Qe.cd[0].trace).selectedpoints&&(Oe.selectedpoints.length>1||(Xe+=Oe.selectedpoints.length)>1))return!1;return Xe===1}(he)&&(Ee=N(Me))){for(ie&&ie.remove(),xe=0;xe<he.length;xe++)(se=he[xe])._module.selectPoints(se,!1);J($,he),Z(ae),ge&&$.emit("plotly_deselect",null)}else{for(Le=G.shiftKey&&(Ee!==void 0?Ee:N(Me)),de=function(We,Qe,Oe){return{pointNumber:We,searchInfo:Qe,subtract:Oe}}(Me.pointNumber,Me.searchInfo,Le),ce=X(ae.selectionDefs.concat([de])),xe=0;xe<he.length;xe++)if(ve=D(he[xe]._module.selectPoints(he[xe],ce),he[xe]),ke.length)for(var Se=0;Se<ve.length;Se++)ke.push(ve[Se]);else ke=ve;if(J($,he,Te={points:ke}),de&&ae&&ae.selectionDefs.push(de),ie){var De=ae.mergedPolygons,Be=r(ae.dragmode);f(U(De,Be),ie,ae)}ge&&$.emit("plotly_selected",Te)}}}function q(G){return"pointNumber"in G&&"searchInfo"in G}function W(G){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function($,K,re,ne){var ae=G.searchInfo.cd[0].trace._expandedIndex;return ne.cd[0].trace._expandedIndex===ae&&re===G.pointNumber},isRect:!1,degenerate:!1,subtract:G.subtract}}function X(G){for(var $=[],K=q(G[0])?0:G[0][0][0],re=K,ne=q(G[0])?0:G[0][0][1],ae=ne,ie=0;ie<G.length;ie++)if(q(G[ie]))$.push(W(G[ie]));else{var he=y.tester(G[ie]);he.subtract=G[ie].subtract,$.push(he),K=Math.min(K,he.xmin),re=Math.max(re,he.xmax),ne=Math.min(ne,he.ymin),ae=Math.max(ae,he.ymax)}return{xmin:K,xmax:re,ymin:ne,ymax:ae,pts:[],contains:function(se,de,ce,ve){for(var Ee=!1,Le=0;Le<$.length;Le++)$[Le].contains(se,de,ce,ve)&&(Ee=$[Le].subtract===!1);return Ee},isRect:!1,degenerate:!1}}function Q(G,$,K){$._fullLayout._drawing=!1;var re=$._fullLayout,ne=K.plotinfo,ae=K.dragmode,ie=re._lastSelectedSubplot&&re._lastSelectedSubplot===ne.id,he=(G.shiftKey||G.altKey)&&!(s(ae)&&r(ae));ie&&he&&ne.selection&&ne.selection.selectionDefs&&!K.selectionDefs?(K.selectionDefs=ne.selection.selectionDefs,K.mergedPolygons=ne.selection.mergedPolygons):he&&ne.selection||Z(K),ie||(w($),re._lastSelectedSubplot=ne.id)}function Z(G){var $=G.dragmode,K=G.plotinfo,re=G.gd;if(re._fullLayout._activeShapeIndex>=0&&re._fullLayout._deactivateShape(re),s($)){var ne=re._fullLayout._zoomlayer.selectAll(".select-outline-"+K.id);if(ne&&re._fullLayout._drawing){var ae=g(ne,G);ae&&h.call("_guiRelayout",re,{shapes:ae}),re._fullLayout._drawing=!1}}K.selection={},K.selection.selectionDefs=G.selectionDefs=[],K.selection.mergedPolygons=G.mergedPolygons=[]}function Y(G,$,K,re){var ne,ae,ie,he=[],se=$.map(function(Le){return Le._id}),de=K.map(function(Le){return Le._id});for(ie=0;ie<G.calcdata.length;ie++)if((ae=(ne=G.calcdata[ie])[0].trace).visible===!0&&ae._module&&ae._module.selectPoints)if(!re||ae.subplot!==re&&ae.geo!==re)if(ae.type==="splom"&&ae._xaxes[se[0]]&&ae._yaxes[de[0]]){var ce=Ee(ae._module,ne,$[0],K[0]);ce.scene=G._fullLayout._splomScenes[ae.uid],he.push(ce)}else if(ae.type==="sankey"){var ve=Ee(ae._module,ne,$[0],K[0]);he.push(ve)}else{if(se.indexOf(ae.xaxis)===-1||de.indexOf(ae.yaxis)===-1)continue;he.push(Ee(ae._module,ne,T(G,ae.xaxis),T(G,ae.yaxis)))}else he.push(Ee(ae._module,ne,$[0],K[0]));return he;function Ee(Le,Te,xe,fe){return{_module:Le,cd:Te,xaxis:xe,yaxis:fe}}}function N(G){var $=G.searchInfo.cd[0].trace,K=G.pointNumber,re=G.pointNumbers,ne=re.length>0?re[0]:K;return!!$.selectedpoints&&$.selectedpoints.indexOf(ne)>-1}function J(G,$,K){var re,ne,ae,ie;for(re=0;re<$.length;re++){var he=$[re].cd[0].trace._fullInput,se=G._fullLayout._tracePreGUI[he.uid]||{};se.selectedpoints===void 0&&(se.selectedpoints=he._input.selectedpoints||null)}if(K){var de=K.points||[];for(re=0;re<$.length;re++)(ie=$[re].cd[0].trace)._input.selectedpoints=ie._fullInput.selectedpoints=[],ie._fullInput!==ie&&(ie.selectedpoints=[]);for(re=0;re<de.length;re++){var ce=de[re],ve=ce.data,Ee=ce.fullData;ce.pointIndices?([].push.apply(ve.selectedpoints,ce.pointIndices),ie._fullInput!==ie&&[].push.apply(Ee.selectedpoints,ce.pointIndices)):(ve.selectedpoints.push(ce.pointIndex),ie._fullInput!==ie&&Ee.selectedpoints.push(ce.pointIndex))}}else for(re=0;re<$.length;re++)delete(ie=$[re].cd[0].trace).selectedpoints,delete ie._input.selectedpoints,ie._fullInput!==ie&&delete ie._fullInput.selectedpoints;var Le=!1;for(re=0;re<$.length;re++){ie=(ae=(ne=$[re]).cd)[0].trace,h.traceIs(ie,"regl")&&(Le=!0);var Te=ne._module,xe=Te.styleOnSelect||Te.style;xe&&(xe(G,ae,ae[0].node3),ae[0].nodeRangePlot3&&xe(G,ae,ae[0].nodeRangePlot3))}Le&&(_(G),k(G))}function D(G,$){if(Array.isArray(G))for(var K=$.cd,re=$.cd[0].trace,ne=0;ne<G.length;ne++)G[ne]=l(G[ne],re,K);return G}function U(G,$){for(var K=[],re=0;re<G.length;re++){K[re]=[];for(var ne=0;ne<G[re].length;ne++){K[re][ne]=[],K[re][ne][0]=ne?"L":"M";for(var ae=0;ae<G[re][ne].length;ae++)K[re][ne].push(G[re][ne][ae])}$||K[re].push(["Z",K[re][0][1],K[re][0][2]])}return K}B.exports={prepSelect:function(G,$,K,re,ne){var ae=a(ne),ie=n(ne),he=r(ne),se=s(ne),de=c(ne),ce=ne==="drawcircle",ve=ne==="drawline"||ce,Ee=re.gd,Le=Ee._fullLayout,Te=Le._zoomlayer,xe=re.element.getBoundingClientRect(),fe=re.plotinfo,ge=z(fe),ke=$-xe.left,Me=K-xe.top;Le._calcInverseTransform(Ee);var Se=m.apply3DTransform(Le._invTransform)(ke,Me);ke=Se[0],Me=Se[1];var De,Be,We,Qe,Oe,Ue,Xe,Ye=Le._invScaleX,$e=Le._invScaleY,it=ke,ot=Me,Et="M"+ke+","+Me,mt=re.xaxes[0]._length,tt=re.yaxes[0]._length,Ke=re.xaxes.concat(re.yaxes),Mt=G.altKey&&!(s(ne)&&he);Q(G,Ee,re),ae&&(De=b([[ke,Me]],E.BENDPX));var Jt=Te.selectAll("path.select-outline-"+fe.id).data(se?[0]:[1,2]),$t=Le.newshape;Jt.enter().append("path").attr("class",function(Pe){return"select-outline select-outline-"+Pe+" select-outline-"+fe.id}).style(se?{opacity:$t.opacity/2,fill:he?void 0:$t.fillcolor,stroke:$t.line.color,"stroke-dasharray":p($t.line.dash,$t.line.width),"stroke-width":$t.line.width+"px"}:{}).attr("fill-rule",$t.fillrule).classed("cursor-move",!!se).attr("transform",ge).attr("d",Et+"Z");var je,Ge=Te.append("path").attr("class","zoombox-corners").style({fill:u.background,stroke:u.defaultLine,"stroke-width":1}).attr("transform",ge).attr("d","M0,0Z"),Ct=Le._uid+E.SELECTID,Ie=[],be=Y(Ee,re.xaxes,re.yaxes,re.subplot);function Ae(Pe,ze){return Pe-ze}je=fe.fillRangeItems?fe.fillRangeItems:ie?function(Pe,ze){var qe=Pe.range={};for(Oe=0;Oe<Ke.length;Oe++){var ht=Ke[Oe],at=ht._id.charAt(0);qe[ht._id]=[S(ht,ze[at+"min"]),S(ht,ze[at+"max"])].sort(Ae)}}:function(Pe,ze,qe){var ht=Pe.lassoPoints={};for(Oe=0;Oe<Ke.length;Oe++){var at=Ke[Oe];ht[at._id]=qe.filtered.map(P(at))}},re.moveFn=function(Pe,ze){it=Math.max(0,Math.min(mt,Ye*Pe+ke)),ot=Math.max(0,Math.min(tt,$e*ze+Me));var qe=Math.abs(it-ke),ht=Math.abs(ot-Me);if(ie){var at,nt,xt;if(de){var Lt=Le.selectdirection;switch(at=Lt==="any"?ht<Math.min(.6*qe,A)?"h":qe<Math.min(.6*ht,A)?"v":"d":Lt){case"h":nt=ce?tt/2:0,xt=tt;break;case"v":nt=ce?mt/2:0,xt=mt}}if(se)switch(Le.newshape.drawdirection){case"vertical":at="h",nt=ce?tt/2:0,xt=tt;break;case"horizontal":at="v",nt=ce?mt/2:0,xt=mt;break;case"ortho":qe<ht?(at="h",nt=Me,xt=ot):(at="v",nt=ke,xt=it);break;default:at="d"}at==="h"?((Qe=ve?d(ce,[it,nt],[it,xt]):[[ke,nt],[ke,xt],[it,xt],[it,nt]]).xmin=ve?it:Math.min(ke,it),Qe.xmax=ve?it:Math.max(ke,it),Qe.ymin=Math.min(nt,xt),Qe.ymax=Math.max(nt,xt),Ge.attr("d","M"+Qe.xmin+","+(Me-A)+"h-4v"+2*A+"h4ZM"+(Qe.xmax-1)+","+(Me-A)+"h4v"+2*A+"h-4Z")):at==="v"?((Qe=ve?d(ce,[nt,ot],[xt,ot]):[[nt,Me],[nt,ot],[xt,ot],[xt,Me]]).xmin=Math.min(nt,xt),Qe.xmax=Math.max(nt,xt),Qe.ymin=ve?ot:Math.min(Me,ot),Qe.ymax=ve?ot:Math.max(Me,ot),Ge.attr("d","M"+(ke-A)+","+Qe.ymin+"v-4h"+2*A+"v4ZM"+(ke-A)+","+(Qe.ymax-1)+"v4h"+2*A+"v-4Z")):at==="d"&&((Qe=ve?d(ce,[ke,Me],[it,ot]):[[ke,Me],[ke,ot],[it,ot],[it,Me]]).xmin=Math.min(ke,it),Qe.xmax=Math.max(ke,it),Qe.ymin=Math.min(Me,ot),Qe.ymax=Math.max(Me,ot),Ge.attr("d","M0,0Z"))}else ae&&(De.addPt([it,ot]),Qe=De.filtered);re.selectionDefs&&re.selectionDefs.length?(We=function(bt,St,st){return st?t.difference({regions:bt,inverted:!1},{regions:[St],inverted:!1}).regions:t.union({regions:bt,inverted:!1},{regions:[St],inverted:!1}).regions}(re.mergedPolygons,Qe,Mt),Qe.subtract=Mt,Be=X(re.selectionDefs.concat([Qe]))):(We=[Qe],Be=L(Qe)),f(U(We,he),Jt,re),de&&v.throttle(Ct,E.SELECTDELAY,function(){var bt;Ie=[];var St;for(Oe=0;Oe<be.length;Oe++)if(St=(Ue=be[Oe])._module.selectPoints(Ue,Be),bt=D(St,Ue),Ie.length)for(var st=0;st<bt.length;st++)Ie.push(bt[st]);else Ie=bt;J(Ee,be,Xe={points:Ie}),je(Xe,Qe,De),re.gd.emit("plotly_selecting",Xe)})},re.clickFn=function(Pe,ze){if(Ge.remove(),Ee._fullLayout._activeShapeIndex>=0)Ee._fullLayout._deactivateShape(Ee);else if(!se){var qe=Le.clickmode;v.done(Ct).then(function(){if(v.clear(Ct),Pe===2){for(Jt.remove(),Oe=0;Oe<be.length;Oe++)(Ue=be[Oe])._module.selectPoints(Ue,!1);J(Ee,be),Z(re),Ee.emit("plotly_deselect",null)}else qe.indexOf("select")>-1&&F(ze,Ee,re.xaxes,re.yaxes,re.subplot,re,Jt),qe==="event"&&Ee.emit("plotly_selected",void 0);e.click(Ee,ze)}).catch(m.error)}},re.doneFn=function(){Ge.remove(),v.done(Ct).then(function(){v.clear(Ct),re.gd.emit("plotly_selected",Xe),Qe&&re.selectionDefs&&(Qe.subtract=Mt,re.selectionDefs.push(Qe),re.mergedPolygons.length=0,[].push.apply(re.mergedPolygons,We)),re.doneFnCompleted&&re.doneFnCompleted(Ie)}).catch(m.error),se&&Z(re)}},clearSelect:w,clearSelectionsCache:Z,selectOnClick:F}},{"../../components/color":666,"../../components/dragelement/helpers":684,"../../components/drawing":688,"../../components/fx":706,"../../components/fx/helpers":702,"../../components/shapes/draw_newshape/display_outlines":754,"../../components/shapes/draw_newshape/helpers":755,"../../components/shapes/draw_newshape/newshapes":756,"../../lib":803,"../../lib/clear_gl_canvases":787,"../../lib/polygon":815,"../../lib/throttle":830,"../../plot_api/subroutines":844,"../../registry":931,"./axis_ids":858,"./constants":861,"./handle_outline":865,"./helpers":866,polybooljs:504}],875:[function(i,B,V){var t=i("@plotly/d3"),h=i("d3-time-format").utcFormat,p=i("../../lib"),u=p.numberFormat,e=i("fast-isnumeric"),l=p.cleanNumber,o=p.ms2DateTime,a=p.dateTime2ms,n=p.ensureNumber,s=p.isArrayOrTypedArray,r=i("../../constants/numerical"),c=r.FP_SAFE,f=r.BADNUM,d=r.LOG_CLIP,g=r.ONEWEEK,m=r.ONEDAY,y=r.ONEHOUR,v=r.ONEMIN,T=r.ONESEC,_=i("./axis_ids"),k=i("./constants"),E=k.HOUR_PATTERN,A=k.WEEKDAY_PATTERN;function b(w){return Math.pow(10,w)}function L(w){return w!=null}B.exports=function(w,C){C=C||{};var S=w._id||"x",P=S.charAt(0);function z(K,re){if(K>0)return Math.log(K)/Math.LN10;if(K<=0&&re&&w.range&&w.range.length===2){var ne=w.range[0],ae=w.range[1];return .5*(ne+ae-2*d*Math.abs(ne-ae))}return f}function F(K,re,ne,ae){if((ae||{}).msUTC&&e(K))return+K;var ie=a(K,ne||w.calendar);if(ie===f){if(!e(K))return f;K=+K;var he=Math.floor(10*p.mod(K+.05,1)),se=Math.round(K-he/10);ie=a(new Date(se))+he/10}return ie}function q(K,re,ne){return o(K,re,ne||w.calendar)}function W(K){return w._categories[Math.round(K)]}function X(K){if(L(K)){if(w._categoriesMap===void 0&&(w._categoriesMap={}),w._categoriesMap[K]!==void 0)return w._categoriesMap[K];w._categories.push(typeof K=="number"?String(K):K);var re=w._categories.length-1;return w._categoriesMap[K]=re,re}return f}function Q(K){if(w._categoriesMap)return w._categoriesMap[K]}function Z(K){var re=Q(K);return re!==void 0?re:e(K)?+K:void 0}function Y(K){return e(K)?+K:Q(K)}function N(K,re,ne){return t.round(ne+re*K,2)}function J(K,re,ne){return(K-ne)/re}var D=function(K){return e(K)?N(K,w._m,w._b):f},U=function(K){return J(K,w._m,w._b)};if(w.rangebreaks){var G=P==="y";D=function(K){if(!e(K))return f;var re=w._rangebreaks.length;if(!re)return N(K,w._m,w._b);var ne=G;w.range[0]>w.range[1]&&(ne=!ne);for(var ae=ne?-1:1,ie=ae*K,he=0,se=0;se<re;se++){var de=ae*w._rangebreaks[se].min,ce=ae*w._rangebreaks[se].max;if(ie<de)break;if(!(ie>ce)){he=ie<(de+ce)/2?se:se+1;break}he=se+1}var ve=w._B[he]||0;return isFinite(ve)?N(K,w._m2,ve):0},U=function(K){var re=w._rangebreaks.length;if(!re)return J(K,w._m,w._b);for(var ne=0,ae=0;ae<re&&!(K<w._rangebreaks[ae].pmin);ae++)K>w._rangebreaks[ae].pmax&&(ne=ae+1);return J(K,w._m2,w._B[ne])}}w.c2l=w.type==="log"?z:n,w.l2c=w.type==="log"?b:n,w.l2p=D,w.p2l=U,w.c2p=w.type==="log"?function(K,re){return D(z(K,re))}:D,w.p2c=w.type==="log"?function(K){return b(U(K))}:U,["linear","-"].indexOf(w.type)!==-1?(w.d2r=w.r2d=w.d2c=w.r2c=w.d2l=w.r2l=l,w.c2d=w.c2r=w.l2d=w.l2r=n,w.d2p=w.r2p=function(K){return w.l2p(l(K))},w.p2d=w.p2r=U,w.cleanPos=n):w.type==="log"?(w.d2r=w.d2l=function(K,re){return z(l(K),re)},w.r2d=w.r2c=function(K){return b(l(K))},w.d2c=w.r2l=l,w.c2d=w.l2r=n,w.c2r=z,w.l2d=b,w.d2p=function(K,re){return w.l2p(w.d2r(K,re))},w.p2d=function(K){return b(U(K))},w.r2p=function(K){return w.l2p(l(K))},w.p2r=U,w.cleanPos=n):w.type==="date"?(w.d2r=w.r2d=p.identity,w.d2c=w.r2c=w.d2l=w.r2l=F,w.c2d=w.c2r=w.l2d=w.l2r=q,w.d2p=w.r2p=function(K,re,ne){return w.l2p(F(K,0,ne))},w.p2d=w.p2r=function(K,re,ne){return q(U(K),re,ne)},w.cleanPos=function(K){return p.cleanDate(K,f,w.calendar)}):w.type==="category"?(w.d2c=w.d2l=X,w.r2d=w.c2d=w.l2d=W,w.d2r=w.d2l_noadd=Z,w.r2c=function(K){var re=Y(K);return re!==void 0?re:w.fraction2r(.5)},w.l2r=w.c2r=n,w.r2l=Y,w.d2p=function(K){return w.l2p(w.r2c(K))},w.p2d=function(K){return W(U(K))},w.r2p=w.d2p,w.p2r=U,w.cleanPos=function(K){return typeof K=="string"&&K!==""?K:n(K)}):w.type==="multicategory"&&(w.r2d=w.c2d=w.l2d=W,w.d2r=w.d2l_noadd=Z,w.r2c=function(K){var re=Z(K);return re!==void 0?re:w.fraction2r(.5)},w.r2c_just_indices=Q,w.l2r=w.c2r=n,w.r2l=Z,w.d2p=function(K){return w.l2p(w.r2c(K))},w.p2d=function(K){return W(U(K))},w.r2p=w.d2p,w.p2r=U,w.cleanPos=function(K){return Array.isArray(K)||typeof K=="string"&&K!==""?K:n(K)},w.setupMultiCategory=function(K){var re,ne,ae=w._traceIndices,ie=w._matchGroup;if(ie&&w._categories.length===0){for(var he in ie)if(he!==S){var se=C[_.id2name(he)];ae=ae.concat(se._traceIndices)}}var de=[[0,{}],[0,{}]],ce=[];for(re=0;re<ae.length;re++){var ve=K[ae[re]];if(P in ve){var Ee=ve[P],Le=ve._length||p.minRowLength(Ee);if(s(Ee[0])&&s(Ee[1]))for(ne=0;ne<Le;ne++){var Te=Ee[0][ne],xe=Ee[1][ne];L(Te)&&L(xe)&&(ce.push([Te,xe]),Te in de[0][1]||(de[0][1][Te]=de[0][0]++),xe in de[1][1]||(de[1][1][xe]=de[1][0]++))}}}for(ce.sort(function(fe,ge){var ke=de[0][1],Me=ke[fe[0]]-ke[ge[0]];if(Me)return Me;var Se=de[1][1];return Se[fe[1]]-Se[ge[1]]}),re=0;re<ce.length;re++)X(ce[re])}),w.fraction2r=function(K){var re=w.r2l(w.range[0]),ne=w.r2l(w.range[1]);return w.l2r(re+K*(ne-re))},w.r2fraction=function(K){var re=w.r2l(w.range[0]),ne=w.r2l(w.range[1]);return(w.r2l(K)-re)/(ne-re)},w.cleanRange=function(K,re){re||(re={}),K||(K="range");var ne,ae,ie=p.nestedProperty(w,K).get();if(ae=(ae=w.type==="date"?p.dfltRange(w.calendar):P==="y"?k.DFLTRANGEY:re.dfltRange||k.DFLTRANGEX).slice(),w.rangemode!=="tozero"&&w.rangemode!=="nonnegative"||(ae[0]=0),ie&&ie.length===2)for(w.type!=="date"||w.autorange||(ie[0]=p.cleanDate(ie[0],f,w.calendar),ie[1]=p.cleanDate(ie[1],f,w.calendar)),ne=0;ne<2;ne++)if(w.type==="date"){if(!p.isDateTime(ie[ne],w.calendar)){w[K]=ae;break}if(w.r2l(ie[0])===w.r2l(ie[1])){var he=p.constrain(w.r2l(ie[0]),p.MIN_MS+1e3,p.MAX_MS-1e3);ie[0]=w.l2r(he-1e3),ie[1]=w.l2r(he+1e3);break}}else{if(!e(ie[ne])){if(!e(ie[1-ne])){w[K]=ae;break}ie[ne]=ie[1-ne]*(ne?10:.1)}if(ie[ne]<-c?ie[ne]=-c:ie[ne]>c&&(ie[ne]=c),ie[0]===ie[1]){var se=Math.max(1,Math.abs(1e-6*ie[0]));ie[0]-=se,ie[1]+=se}}else p.nestedProperty(w,K).set(ae)},w.setScale=function(K){var re=C._size;if(w.overlaying){var ne=_.getFromId({_fullLayout:C},w.overlaying);w.domain=ne.domain}var ae=K&&w._r?"_r":"range",ie=w.calendar;w.cleanRange(ae);var he,se,de=w.r2l(w[ae][0],ie),ce=w.r2l(w[ae][1],ie),ve=P==="y";if(ve?(w._offset=re.t+(1-w.domain[1])*re.h,w._length=re.h*(w.domain[1]-w.domain[0]),w._m=w._length/(de-ce),w._b=-w._m*ce):(w._offset=re.l+w.domain[0]*re.w,w._length=re.w*(w.domain[1]-w.domain[0]),w._m=w._length/(ce-de),w._b=-w._m*de),w._rangebreaks=[],w._lBreaks=0,w._m2=0,w._B=[],w.rangebreaks&&(w._rangebreaks=w.locateBreaks(Math.min(de,ce),Math.max(de,ce)),w._rangebreaks.length)){for(he=0;he<w._rangebreaks.length;he++)se=w._rangebreaks[he],w._lBreaks+=Math.abs(se.max-se.min);var Ee=ve;de>ce&&(Ee=!Ee),Ee&&w._rangebreaks.reverse();var Le=Ee?-1:1;for(w._m2=Le*w._length/(Math.abs(ce-de)-w._lBreaks),w._B.push(-w._m2*(ve?ce:de)),he=0;he<w._rangebreaks.length;he++)se=w._rangebreaks[he],w._B.push(w._B[w._B.length-1]-Le*w._m2*(se.max-se.min));for(he=0;he<w._rangebreaks.length;he++)(se=w._rangebreaks[he]).pmin=D(se.min),se.pmax=D(se.max)}if(!isFinite(w._m)||!isFinite(w._b)||w._length<0)throw C._replotting=!1,new Error("Something went wrong with axis scaling")},w.maskBreaks=function(K){var re,ne,ae,ie,he,se=w.rangebreaks||[];se._cachedPatterns||(se._cachedPatterns=se.map(function(Te){return Te.enabled&&Te.bounds?p.simpleMap(Te.bounds,Te.pattern?l:w.d2c):null})),se._cachedValues||(se._cachedValues=se.map(function(Te){return Te.enabled&&Te.values?p.simpleMap(Te.values,w.d2c).sort(p.sorterAsc):null}));for(var de=0;de<se.length;de++){var ce=se[de];if(ce.enabled){if(ce.bounds){var ve=ce.pattern;switch(ne=(re=se._cachedPatterns[de])[0],ae=re[1],ve){case A:ie=(he=new Date(K)).getUTCDay(),ne>ae&&(ae+=7,ie<ne&&(ie+=7));break;case E:ie=(he=new Date(K)).getUTCHours()+(he.getUTCMinutes()/60+he.getUTCSeconds()/3600+he.getUTCMilliseconds()/36e5),ne>ae&&(ae+=24,ie<ne&&(ie+=24));break;case"":ie=K}if(ie>=ne&&ie<ae)return f}else for(var Ee=se._cachedValues[de],Le=0;Le<Ee.length;Le++)if(ae=(ne=Ee[Le])+ce.dvalue,K>=ne&&K<ae)return f}}return K},w.locateBreaks=function(K,re){var ne,ae,ie,he,se=[];if(!w.rangebreaks)return se;var de=w.rangebreaks.slice().sort(function(Se,De){return Se.pattern===A&&De.pattern===E?-1:De.pattern===A&&Se.pattern===E?1:0}),ce=function(Se,De){if((Se=p.constrain(Se,K,re))!==(De=p.constrain(De,K,re))){for(var Be=!0,We=0;We<se.length;We++){var Qe=se[We];Se<Qe.max&&De>=Qe.min&&(Se<Qe.min&&(Qe.min=Se),De>Qe.max&&(Qe.max=De),Be=!1)}Be&&se.push({min:Se,max:De})}};for(ne=0;ne<de.length;ne++){var ve=de[ne];if(ve.enabled)if(ve.bounds){var Ee=K,Le=re;ve.pattern&&(Ee=Math.floor(Ee)),ie=(ae=p.simpleMap(ve.bounds,ve.pattern?l:w.r2l))[0],he=ae[1];var Te,xe,fe=new Date(Ee);switch(ve.pattern){case A:xe=g,Te=(he-ie+(he<ie?7:0))*m,Ee+=ie*m-(fe.getUTCDay()*m+fe.getUTCHours()*y+fe.getUTCMinutes()*v+fe.getUTCSeconds()*T+fe.getUTCMilliseconds());break;case E:xe=m,Te=(he-ie+(he<ie?24:0))*y,Ee+=ie*y-(fe.getUTCHours()*y+fe.getUTCMinutes()*v+fe.getUTCSeconds()*T+fe.getUTCMilliseconds());break;default:Ee=Math.min(ae[0],ae[1]),Te=xe=(Le=Math.max(ae[0],ae[1]))-Ee}for(var ge=Ee;ge<Le;ge+=xe)ce(ge,ge+Te)}else for(var ke=p.simpleMap(ve.values,w.d2c),Me=0;Me<ke.length;Me++)ce(ie=ke[Me],he=ie+ve.dvalue)}return se.sort(function(Se,De){return Se.min-De.min}),se},w.makeCalcdata=function(K,re,ne){var ae,ie,he,se,de=w.type,ce=de==="date"&&K[re+"calendar"];if(re in K){if(ae=K[re],se=K._length||p.minRowLength(ae),p.isTypedArray(ae)&&(de==="linear"||de==="log")){if(se===ae.length)return ae;if(ae.subarray)return ae.subarray(0,se)}if(de==="multicategory")return function(Le,Te){for(var xe=new Array(Te),fe=0;fe<Te;fe++){var ge=(Le[0]||[])[fe],ke=(Le[1]||[])[fe];xe[fe]=Q([ge,ke])}return xe}(ae,se);for(ie=new Array(se),he=0;he<se;he++)ie[he]=w.d2c(ae[he],0,ce,ne)}else{var ve=re+"0"in K?w.d2c(K[re+"0"],0,ce):0,Ee=K["d"+re]?Number(K["d"+re]):1;for(ae=K[{x:"y",y:"x"}[re]],se=K._length||ae.length,ie=new Array(se),he=0;he<se;he++)ie[he]=ve+he*Ee}if(w.rangebreaks)for(he=0;he<se;he++)ie[he]=w.maskBreaks(ie[he]);return ie},w.isValidRange=function(K){return Array.isArray(K)&&K.length===2&&e(w.r2l(K[0]))&&e(w.r2l(K[1]))},w.isPtWithinRange=function(K,re){var ne=w.c2l(K[P],null,re),ae=w.r2l(w.range[0]),ie=w.r2l(w.range[1]);return ae<ie?ae<=ne&&ne<=ie:ie<=ne&&ne<=ae},w._emptyCategories=function(){w._categories=[],w._categoriesMap={}},w.clearCalc=function(){var K=w._matchGroup;if(K){var re=null,ne=null;for(var ae in K){var ie=C[_.id2name(ae)];if(ie._categories){re=ie._categories,ne=ie._categoriesMap;break}}re&&ne?(w._categories=re,w._categoriesMap=ne):w._emptyCategories()}else w._emptyCategories();if(w._initialCategories)for(var he=0;he<w._initialCategories.length;he++)X(w._initialCategories[he])},w.sortByInitialCategories=function(){var K=[];if(w._emptyCategories(),w._initialCategories)for(var re=0;re<w._initialCategories.length;re++)X(w._initialCategories[re]);K=K.concat(w._traceIndices);var ne=w._matchGroup;for(var ae in ne)if(S!==ae){var ie=C[_.id2name(ae)];ie._categories=w._categories,ie._categoriesMap=w._categoriesMap,K=K.concat(ie._traceIndices)}return K};var $=C._d3locale;w.type==="date"&&(w._dateFormat=$?$.timeFormat:h,w._extraFormat=C._extraFormat),w._separators=C.separators,w._numFormat=$?$.numberFormat:u,delete w._minDtick,delete w._forceTick0}},{"../../constants/numerical":779,"../../lib":803,"./axis_ids":858,"./constants":861,"@plotly/d3":58,"d3-time-format":175,"fast-isnumeric":249}],876:[function(i,B,V){var t=i("../../lib"),h=i("../../components/color").contrast,p=i("./layout_attributes"),u=i("../array_container_defaults");function e(o){var a=["showexponent","showtickprefix","showticksuffix"].filter(function(n){return o[n]!==void 0});if(a.every(function(n){return o[n]===o[a[0]]})||a.length===1)return o[a[0]]}function l(o,a){function n(s,r){return t.coerce(o,a,p.tickformatstops,s,r)}n("enabled")&&(n("dtickrange"),n("value"))}B.exports=function(o,a,n,s,r,c){c&&c.pass!==1||function(f,d,g,m,y){var v=e(f);g("tickprefix")&&g("showtickprefix",v),g("ticksuffix",y.tickSuffixDflt)&&g("showticksuffix",v)}(o,0,n,0,r),c&&c.pass!==2||function(f,d,g,m,y){var v=e(f);if(g("tickprefix")&&g("showtickprefix",v),g("ticksuffix",y.tickSuffixDflt)&&g("showticksuffix",v),g("showticklabels")){var T=y.font||{},_=d.color,k=(d.ticklabelposition||"").indexOf("inside")!==-1?h(y.bgColor):_&&_!==p.color.dflt?_:T.color;if(t.coerceFont(g,"tickfont",{family:T.family,size:T.size,color:k}),g("tickangle"),m!=="category"){var E=g("tickformat");u(f,d,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:l}),d.tickformatstops.length||delete d.tickformatstops,E||m==="date"||(g("showexponent",v),g("exponentformat"),g("minexponent"),g("separatethousands"))}}}(o,a,n,s,r)}},{"../../components/color":666,"../../lib":803,"../array_container_defaults":849,"./layout_attributes":869}],877:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes");B.exports=function(p,u,e,l){var o=t.coerce2(p,u,h,"ticklen"),a=t.coerce2(p,u,h,"tickwidth"),n=t.coerce2(p,u,h,"tickcolor",u.color);e("ticks",l.outerTicks||o||a||n?"outside":"")||(delete u.ticklen,delete u.tickwidth,delete u.tickcolor)}},{"../../lib":803,"./layout_attributes":869}],878:[function(i,B,V){var t=i("./clean_ticks"),h=i("../../lib").isArrayOrTypedArray;B.exports=function(p,u,e,l){function o(f){var d=p[f];return d!==void 0?d:(u._template||{})[f]}var a=o("tick0"),n=o("dtick"),s=o("tickvals"),r=e("tickmode",h(s)?"array":n?"linear":"auto");if(r==="auto")e("nticks");else if(r==="linear"){var c=u.dtick=t.dtick(n,l);u.tick0=t.tick0(a,l,u.calendar,c)}else l!=="multicategory"&&(e("tickvals")===void 0?u.tickmode="auto":e("ticktext"))}},{"../../lib":803,"./clean_ticks":860}],879:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../registry"),p=i("../../lib"),u=i("../../components/drawing"),e=i("./axes");B.exports=function(l,o,a,n){var s=l._fullLayout;if(o.length!==0){var r,c,f,d;n&&(r=n());var g=t.ease(a.easing);return l._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(d),d=null,function(){for(var v={},T=0;T<o.length;T++){var _=o[T],k=_.plotinfo.xaxis,E=_.plotinfo.yaxis;_.xr0&&(v[k._name+".range"]=_.xr0.slice()),_.yr0&&(v[E._name+".range"]=_.yr0.slice())}return h.call("relayout",l,v).then(function(){for(var A=0;A<o.length;A++)m(o[A].plotinfo)})}()}),c=Date.now(),d=window.requestAnimationFrame(function v(){f=Date.now();for(var T=Math.min(1,(f-c)/a.duration),_=g(T),k=0;k<o.length;k++)y(o[k],_);f-c>a.duration?(function(){for(var E={},A=0;A<o.length;A++){var b=o[A],L=b.plotinfo.xaxis,w=b.plotinfo.yaxis;b.xr1&&(E[L._name+".range"]=b.xr1.slice()),b.yr1&&(E[w._name+".range"]=b.yr1.slice())}r&&r(),h.call("relayout",l,E).then(function(){for(var C=0;C<o.length;C++)m(o[C].plotinfo)})}(),d=window.cancelAnimationFrame(v)):d=window.requestAnimationFrame(v)}),Promise.resolve()}function m(v){var T=v.xaxis,_=v.yaxis;s._defs.select("#"+v.clipId+"> rect").call(u.setTranslate,0,0).call(u.setScale,1,1),v.plot.call(u.setTranslate,T._offset,_._offset).call(u.setScale,1,1);var k=v.plot.selectAll(".scatterlayer .trace");k.selectAll(".point").call(u.setPointGroupScale,1,1),k.selectAll(".textpoint").call(u.setTextPointsScale,1,1),k.call(u.hideOutsideRangePoints,v)}function y(v,T){var _=v.plotinfo,k=_.xaxis,E=_.yaxis,A=k._length,b=E._length,L=!!v.xr1,w=!!v.yr1,C=[];if(L){var S=p.simpleMap(v.xr0,k.r2l),P=p.simpleMap(v.xr1,k.r2l),z=S[1]-S[0],F=P[1]-P[0];C[0]=(S[0]*(1-T)+T*P[0]-S[0])/(S[1]-S[0])*A,C[2]=A*(1-T+T*F/z),k.range[0]=k.l2r(S[0]*(1-T)+T*P[0]),k.range[1]=k.l2r(S[1]*(1-T)+T*P[1])}else C[0]=0,C[2]=A;if(w){var q=p.simpleMap(v.yr0,E.r2l),W=p.simpleMap(v.yr1,E.r2l),X=q[1]-q[0],Q=W[1]-W[0];C[1]=(q[1]*(1-T)+T*W[1]-q[1])/(q[0]-q[1])*b,C[3]=b*(1-T+T*Q/X),E.range[0]=k.l2r(q[0]*(1-T)+T*W[0]),E.range[1]=E.l2r(q[1]*(1-T)+T*W[1])}else C[1]=0,C[3]=b;e.drawOne(l,k,{skipTitle:!0}),e.drawOne(l,E,{skipTitle:!0}),e.redrawComponents(l,[k._id,E._id]);var Z=L?A/C[2]:1,Y=w?b/C[3]:1,N=L?C[0]:0,J=w?C[1]:0,D=L?C[0]/C[2]*A:0,U=w?C[1]/C[3]*b:0,G=k._offset-D,$=E._offset-U;_.clipRect.call(u.setTranslate,N,J).call(u.setScale,1/Z,1/Y),_.plot.call(u.setTranslate,G,$).call(u.setScale,Z,Y),u.setPointGroupScale(_.zoomScalePts,1/Z,1/Y),u.setTextPointsScale(_.zoomScaleTxt,1/Z,1/Y)}e.redrawComponents(l)}},{"../../components/drawing":688,"../../lib":803,"../../registry":931,"./axes":854,"@plotly/d3":58}],880:[function(i,B,V){var t=i("../../registry").traceIs,h=i("./axis_autotype");function p(e){return{v:"x",h:"y"}[e.orientation||"v"]}function u(e,l){var o=p(e),a=t(e,"box-violin"),n=t(e._fullInput||{},"candlestick");return a&&!n&&l===o&&e[o]===void 0&&e[o+"0"]===void 0}B.exports=function(e,l,o,a){o("autotypenumbers",a.autotypenumbersDflt),o("type",(a.splomStash||{}).type)==="-"&&(function(n,s){if(n.type==="-"){var r,c=n._id,f=c.charAt(0);c.indexOf("scene")!==-1&&(c=f);var d=function(E,A,b){for(var L=0;L<E.length;L++){var w=E[L];if(w.type==="splom"&&w._length>0&&(w["_"+b+"axes"]||{})[A]||(w[b+"axis"]||b)===A&&(u(w,b)||(w[b]||[]).length||w[b+"0"]))return w}}(s,c,f);if(d){if(d.type==="histogram"&&f==={v:"y",h:"x"}[d.orientation||"v"])return void(n.type="linear");var g=f+"calendar",m=d[g],y={noMultiCategory:!t(d,"cartesian")||t(d,"noMultiCategory")};if(d.type==="box"&&d._hasPreCompStats&&f==={h:"x",v:"y"}[d.orientation||"v"]&&(y.noMultiCategory=!0),y.autotypenumbers=n.autotypenumbers,u(d,f)){var v=p(d),T=[];for(r=0;r<s.length;r++){var _=s[r];t(_,"box-violin")&&(_[f+"axis"]||f)===c&&(_[v]!==void 0?T.push(_[v][0]):_.name!==void 0?T.push(_.name):T.push("text"),_[g]!==m&&(m=void 0))}n.type=h(T,m,y)}else if(d.type==="splom"){var k=d.dimensions[d._axesDim[c]];k.visible&&(n.type=h(k.values,m,y))}else n.type=h(d[f]||[d[f+"0"]],m,y)}}}(l,a.data),l.type==="-"?l.type="linear":e.type=l.type)}},{"../../registry":931,"./axis_autotype":855}],881:[function(i,B,V){var t=i("../registry"),h=i("../lib");function p(o,a,n){var s,r,c,f=!1;if(a.type==="data")s=o._fullData[a.traces!==null?a.traces[0]:0];else{if(a.type!=="layout")return!1;s=o._fullLayout}return r=h.nestedProperty(s,a.prop).get(),(c=n[a.type]=n[a.type]||{}).hasOwnProperty(a.prop)&&c[a.prop]!==r&&(f=!0),c[a.prop]=r,{changed:f,value:r}}function u(o,a){var n=[],s=a[0],r={};if(typeof s=="string")r[s]=a[1];else{if(!h.isPlainObject(s))return n;r=s}return l(r,function(c,f,d){n.push({type:"layout",prop:c,value:d})},"",0),n}function e(o,a){var n,s,r,c,f=[];if(s=a[0],r=a[1],n=a[2],c={},typeof s=="string")c[s]=r;else{if(!h.isPlainObject(s))return f;c=s,n===void 0&&(n=r)}return n===void 0&&(n=null),l(c,function(d,g,m){var y,v;if(Array.isArray(m)){v=m.slice();var T=Math.min(v.length,o.data.length);n&&(T=Math.min(T,n.length)),y=[];for(var _=0;_<T;_++)y[_]=n?n[_]:_}else v=m,y=n?n.slice():null;if(y===null)Array.isArray(v)&&(v=v[0]);else if(Array.isArray(y)){if(!Array.isArray(v)){var k=v;v=[];for(var E=0;E<y.length;E++)v[E]=k}v.length=Math.min(y.length,v.length)}f.push({type:"data",prop:d,traces:y,value:v})},"",0),f}function l(o,a,n,s){Object.keys(o).forEach(function(r){var c=o[r];if(r[0]!=="_"){var f=n+(s>0?".":"")+r;h.isPlainObject(c)?l(c,a,f,s+1):a(f,r,c)}})}V.manageCommandObserver=function(o,a,n,s){var r={},c=!0;a&&a._commandObserver&&(r=a._commandObserver),r.cache||(r.cache={}),r.lookupTable={};var f=V.hasSimpleAPICommandBindings(o,n,r.lookupTable);if(a&&a._commandObserver){if(f)return r;if(a._commandObserver.remove)return a._commandObserver.remove(),a._commandObserver=null,r}if(f){p(o,f,r.cache),r.check=function(){if(c){var m=p(o,f,r.cache);return m.changed&&s&&r.lookupTable[m.value]!==void 0&&(r.disable(),Promise.resolve(s({value:m.value,type:f.type,prop:f.prop,traces:f.traces,index:r.lookupTable[m.value]})).then(r.enable,r.enable)),m.changed}};for(var d=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],g=0;g<d.length;g++)o._internalOn(d[g],r.check);r.remove=function(){for(var m=0;m<d.length;m++)o._removeInternalListener(d[m],r.check)}}else h.log("Unable to automatically bind plot updates to API command"),r.lookupTable={},r.remove=function(){};return r.disable=function(){c=!1},r.enable=function(){c=!0},a&&(a._commandObserver=r),r},V.hasSimpleAPICommandBindings=function(o,a,n){var s,r,c=a.length;for(s=0;s<c;s++){var f,d=a[s],g=d.method,m=d.args;if(Array.isArray(m)||(m=[]),!g)return!1;var y=V.computeAPICommandBindings(o,g,m);if(y.length!==1)return!1;if(r){if((f=y[0]).type!==r.type||f.prop!==r.prop)return!1;if(Array.isArray(r.traces)){if(!Array.isArray(f.traces))return!1;f.traces.sort();for(var v=0;v<r.traces.length;v++)if(r.traces[v]!==f.traces[v])return!1}else if(f.prop!==r.prop)return!1}else r=y[0],Array.isArray(r.traces)&&r.traces.sort();var T=(f=y[0]).value;if(Array.isArray(T)){if(T.length!==1)return!1;T=T[0]}n&&(n[T]=s)}return r},V.executeAPICommand=function(o,a,n){if(a==="skip")return Promise.resolve();var s=t.apiMethodRegistry[a],r=[o];Array.isArray(n)||(n=[]);for(var c=0;c<n.length;c++)r.push(n[c]);return s.apply(null,r).catch(function(f){return h.warn("API call to Plotly."+a+" rejected.",f),Promise.reject(f)})},V.computeAPICommandBindings=function(o,a,n){var s;switch(Array.isArray(n)||(n=[]),a){case"restyle":s=e(o,n);break;case"relayout":s=u(o,n);break;case"update":s=e(o,[n[0],n[2]]).concat(u(o,[n[1]]));break;case"animate":s=function(r,c){return Array.isArray(c[0])&&c[0].length===1&&["string","number"].indexOf(typeof c[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:c[0][0].toString()}]:[]}(0,n);break;default:s=[]}return s}},{"../lib":803,"../registry":931}],882:[function(i,B,V){var t=i("../lib/extend").extendFlat;V.attributes=function(h,p){p=p||{};var u={valType:"info_array",editType:(h=h||{}).editType,items:[{valType:"number",min:0,max:1,editType:h.editType},{valType:"number",min:0,max:1,editType:h.editType}],dflt:[0,1]},e=(h.name&&h.name,h.trace,p.description&&p.description,{x:t({},u,{}),y:t({},u,{}),editType:h.editType});return h.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:h.editType},e.column={valType:"integer",min:0,dflt:0,editType:h.editType}),e},V.defaults=function(h,p,u,e){var l=e&&e.x||[0,1],o=e&&e.y||[0,1],a=p.grid;if(a){var n=u("domain.column");n!==void 0&&(n<a.columns?l=a._domains.x[n]:delete h.domain.column);var s=u("domain.row");s!==void 0&&(s<a.rows?o=a._domains.y[s]:delete h.domain.row)}var r=u("domain.x",l),c=u("domain.y",o);r[0]<r[1]||(h.domain.x=l.slice()),c[0]<c[1]||(h.domain.y=o.slice())}},{"../lib/extend":793}],883:[function(i,B,V){B.exports=function(t){var h=t.editType,p=t.colorEditType;p===void 0&&(p=h);var u={family:{valType:"string",noBlank:!0,strict:!0,editType:h},size:{valType:"number",min:1,editType:h},color:{valType:"color",editType:p},editType:h};return t.arrayOk&&(u.family.arrayOk=!0,u.size.arrayOk=!0,u.color.arrayOk=!0),u}},{}],884:[function(i,B,V){B.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],885:[function(i,B,V){V.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},V.axesNames=["lonaxis","lataxis"],V.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},V.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},V.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},V.clipPad=.001,V.precision=.1,V.landColor="#F0DC82",V.waterColor="#3399FF",V.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},V.sphereSVG={type:"Sphere"},V.fillLayers={ocean:1,land:1,lakes:1},V.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},V.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],V.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],V.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],886:[function(i,B,V){var t=i("@plotly/d3"),h=i("d3-geo"),p=h.geoPath,u=h.geoDistance,e=i("d3-geo-projection"),l=i("../../registry"),o=i("../../lib"),a=o.strTranslate,n=i("../../components/color"),s=i("../../components/drawing"),r=i("../../components/fx"),c=i("../plots"),f=i("../cartesian/axes"),d=i("../cartesian/autorange").getAutoRange,g=i("../../components/dragelement"),m=i("../cartesian/select").prepSelect,y=i("../cartesian/select").clearSelect,v=i("../cartesian/select").selectOnClick,T=i("./zoom"),_=i("./constants"),k=i("../../lib/geo_location_utils"),E=i("../../lib/topojson_utils"),A=i("topojson-client").feature;function b(C){this.id=C.id,this.graphDiv=C.graphDiv,this.container=C.container,this.topojsonURL=C.topojsonURL,this.isStatic=C.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var L=b.prototype;function w(C,S){var P=_.clipPad,z=C[0]+P,F=C[1]-P,q=S[0]+P,W=S[1]-P;z>0&&F<0&&(F+=360);var X=(F-z)/4;return{type:"Polygon",coordinates:[[[z,q],[z,W],[z+X,W],[z+2*X,W],[z+3*X,W],[F,W],[F,q],[F-X,q],[F-2*X,q],[F-3*X,q],[z,q]]]}}B.exports=function(C){return new b(C)},L.plot=function(C,S,P){var z=this,F=S[this.id],q=[],W=!1;for(var X in _.layerNameToAdjective)if(X!=="frame"&&F["show"+X]){W=!0;break}for(var Q=0;Q<C.length;Q++)if(C[0][0].trace.locationmode){W=!0;break}if(W){var Z=E.getTopojsonName(F);z.topojson!==null&&Z===z.topojsonName||(z.topojsonName=Z,PlotlyGeoAssets.topojson[z.topojsonName]===void 0&&q.push(z.fetchTopojson()))}q=q.concat(k.fetchTraceGeoData(C)),P.push(new Promise(function(Y,N){Promise.all(q).then(function(){z.topojson=PlotlyGeoAssets.topojson[z.topojsonName],z.update(C,S),Y()}).catch(N)}))},L.fetchTopojson=function(){var C=this,S=E.getTopojsonPath(C.topojsonURL,C.topojsonName);return new Promise(function(P,z){t.json(S,function(F,q){if(F)return F.status===404?z(new Error(["plotly.js could not find topojson file at",S,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):z(new Error(["unexpected error while fetching topojson file at",S].join(" ")));PlotlyGeoAssets.topojson[C.topojsonName]=q,P()})})},L.update=function(C,S){var P=S[this.id];this.hasChoropleth=!1;for(var z=0;z<C.length;z++){var F=C[z],q=F[0].trace;q.type==="choropleth"&&(this.hasChoropleth=!0),q.visible===!0&&q._length>0&&q._module.calcGeoJSON(F,S)}if(!this.updateProjection(C,S)){this.viewInitial&&this.scope===P.scope||this.saveViewInitial(P),this.scope=P.scope,this.updateBaseLayers(S,P),this.updateDims(S,P),this.updateFx(S,P),c.generalUpdatePerTraceModule(this.graphDiv,this,C,P);var W=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=W.selectAll(".point"),this.dataPoints.text=W.selectAll("text"),this.dataPaths.line=W.selectAll(".js-line");var X=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=X.selectAll("path"),this.render()}},L.updateProjection=function(C,S){var P=this.graphDiv,z=S[this.id],F=S._size,q=z.domain,W=z.projection,X=z.lonaxis,Q=z.lataxis,Z=X._ax,Y=Q._ax,N=this.projection=function(fe){var ge=fe.projection,ke=ge.type,Me=_.projNames[ke];Me="geo"+o.titleCase(Me);for(var Se=(h[Me]||e[Me])(),De=fe._isSatellite?180*Math.acos(1/ge.distance)/Math.PI:fe._isClipped?_.lonaxisSpan[ke]/2:null,Be=["center","rotate","parallels","clipExtent"],We=function(Ue){return Ue?Se:[]},Qe=0;Qe<Be.length;Qe++){var Oe=Be[Qe];typeof Se[Oe]!="function"&&(Se[Oe]=We)}return Se.isLonLatOverEdges=function(Ue){if(Se(Ue)===null)return!0;if(De){var Xe=Se.rotate();return u(Ue,[-Xe[0],-Xe[1]])>De*Math.PI/180}return!1},Se.getPath=function(){return p().projection(Se)},Se.getBounds=function(Ue){return Se.getPath().bounds(Ue)},Se.precision(_.precision),fe._isSatellite&&Se.tilt(ge.tilt).distance(ge.distance),De&&Se.clipAngle(De-_.clipPad),Se}(z),J=[[F.l+F.w*q.x[0],F.t+F.h*(1-q.y[1])],[F.l+F.w*q.x[1],F.t+F.h*(1-q.y[0])]],D=z.center||{},U=W.rotation||{},G=X.range||[],$=Q.range||[];if(z.fitbounds){Z._length=J[1][0]-J[0][0],Y._length=J[1][1]-J[0][1],Z.range=d(P,Z),Y.range=d(P,Y);var K=(Z.range[0]+Z.range[1])/2,re=(Y.range[0]+Y.range[1])/2;if(z._isScoped)D={lon:K,lat:re};else if(z._isClipped){D={lon:K,lat:re},U={lon:K,lat:re,roll:U.roll};var ne=W.type,ae=_.lonaxisSpan[ne]/2||180,ie=_.lataxisSpan[ne]/2||90;G=[K-ae,K+ae],$=[re-ie,re+ie]}else D={lon:K,lat:re},U={lon:K,lat:U.lat,roll:U.roll}}N.center([D.lon-U.lon,D.lat-U.lat]).rotate([-U.lon,-U.lat,U.roll]).parallels(W.parallels);var he=w(G,$);N.fitExtent(J,he);var se=this.bounds=N.getBounds(he),de=this.fitScale=N.scale(),ce=N.translate();if(z.fitbounds){var ve=N.getBounds(w(Z.range,Y.range)),Ee=Math.min((se[1][0]-se[0][0])/(ve[1][0]-ve[0][0]),(se[1][1]-se[0][1])/(ve[1][1]-ve[0][1]));isFinite(Ee)?N.scale(Ee*de):o.warn("Something went wrong during"+this.id+"fitbounds computations.")}else N.scale(W.scale*de);var Le=this.midPt=[(se[0][0]+se[1][0])/2,(se[0][1]+se[1][1])/2];if(N.translate([ce[0]+(Le[0]-ce[0]),ce[1]+(Le[1]-ce[1])]).clipExtent(se),z._isAlbersUsa){var Te=N([D.lon,D.lat]),xe=N.translate();N.translate([xe[0]-(Te[0]-xe[0]),xe[1]-(Te[1]-xe[1])])}},L.updateBaseLayers=function(C,S){var P=this,z=P.topojson,F=P.layers,q=P.basePaths;function W(N){return N==="lonaxis"||N==="lataxis"}function X(N){return!!_.lineLayers[N]}function Q(N){return!!_.fillLayers[N]}var Z=(this.hasChoropleth?_.layersForChoropleth:_.layers).filter(function(N){return X(N)||Q(N)?S["show"+N]:!W(N)||S[N].showgrid}),Y=P.framework.selectAll(".layer").data(Z,String);Y.exit().each(function(N){delete F[N],delete q[N],t.select(this).remove()}),Y.enter().append("g").attr("class",function(N){return"layer "+N}).each(function(N){var J=F[N]=t.select(this);N==="bg"?P.bgRect=J.append("rect").style("pointer-events","all"):W(N)?q[N]=J.append("path").style("fill","none"):N==="backplot"?J.append("g").classed("choroplethlayer",!0):N==="frontplot"?J.append("g").classed("scatterlayer",!0):X(N)?q[N]=J.append("path").style("fill","none").style("stroke-miterlimit",2):Q(N)&&(q[N]=J.append("path").style("stroke","none"))}),Y.order(),Y.each(function(N){var J=q[N],D=_.layerNameToAdjective[N];N==="frame"?J.datum(_.sphereSVG):X(N)||Q(N)?J.datum(A(z,z.objects[N])):W(N)&&J.datum(function(U,G,$){var K,re,ne,ae=G[U],ie=_.scopeDefaults[G.scope];U==="lonaxis"?(K=ie.lonaxisRange,re=ie.lataxisRange,ne=function(xe,fe){return[xe,fe]}):U==="lataxis"&&(K=ie.lataxisRange,re=ie.lonaxisRange,ne=function(xe,fe){return[fe,xe]});var he={type:"linear",range:[K[0],K[1]-1e-6],tick0:ae.tick0,dtick:ae.dtick};f.setConvert(he,$);var se=f.calcTicks(he);G.isScoped||U!=="lonaxis"||se.pop();for(var de=se.length,ce=new Array(de),ve=0;ve<de;ve++)for(var Ee=se[ve].x,Le=ce[ve]=[],Te=re[0];Te<re[1]+2.5;Te+=2.5)Le.push(ne(Ee,Te));return{type:"MultiLineString",coordinates:ce}}(N,S,C)).call(n.stroke,S[N].gridcolor).call(s.dashLine,"",S[N].gridwidth),X(N)?J.call(n.stroke,S[D+"color"]).call(s.dashLine,"",S[D+"width"]):Q(N)&&J.call(n.fill,S[D+"color"])})},L.updateDims=function(C,S){var P=this.bounds,z=(S.framewidth||0)/2,F=P[0][0]-z,q=P[0][1]-z,W=P[1][0]-F+z,X=P[1][1]-q+z;s.setRect(this.clipRect,F,q,W,X),this.bgRect.call(s.setRect,F,q,W,X).call(n.fill,S.bgcolor),this.xaxis._offset=F,this.xaxis._length=W,this.yaxis._offset=q,this.yaxis._length=X},L.updateFx=function(C,S){var P=this,z=P.graphDiv,F=P.bgRect,q=C.dragmode,W=C.clickmode;if(!P.isStatic){var X;q==="select"?X=function(Y,N){(Y.range={})[P.id]=[Z([N.xmin,N.ymin]),Z([N.xmax,N.ymax])]}:q==="lasso"&&(X=function(Y,N,J){(Y.lassoPoints={})[P.id]=J.filtered.map(Z)});var Q={element:P.bgRect.node(),gd:z,plotinfo:{id:P.id,xaxis:P.xaxis,yaxis:P.yaxis,fillRangeItems:X},xaxes:[P.xaxis],yaxes:[P.yaxis],subplot:P.id,clickFn:function(Y){Y===2&&y(z)}};q==="pan"?(F.node().onmousedown=null,F.call(T(P,S)),F.on("dblclick.zoom",function(){var Y=P.viewInitial,N={};for(var J in Y)N[P.id+"."+J]=Y[J];l.call("_guiRelayout",z,N),z.emit("plotly_doubleclick",null)}),z._context._scrollZoom.geo||F.on("wheel.zoom",null)):q!=="select"&&q!=="lasso"||(F.on(".zoom",null),Q.prepFn=function(Y,N,J){m(Y,N,J,Q,q)},g.init(Q)),F.on("mousemove",function(){var Y=P.projection.invert(o.getPositionFromD3Event());if(!Y)return g.unhover(z,t.event);P.xaxis.p2c=function(){return Y[0]},P.yaxis.p2c=function(){return Y[1]},r.hover(z,t.event,P.id)}),F.on("mouseout",function(){z._dragging||g.unhover(z,t.event)}),F.on("click",function(){q!=="select"&&q!=="lasso"&&(W.indexOf("select")>-1&&v(t.event,z,[P.xaxis],[P.yaxis],P.id,Q),W.indexOf("event")>-1&&r.click(z,t.event))})}function Z(Y){return P.projection.invert([Y[0]+P.xaxis._offset,Y[1]+P.yaxis._offset])}},L.makeFramework=function(){var C=this,S=C.graphDiv,P=S._fullLayout,z="clip"+P._uid+C.id;C.clipDef=P._clips.append("clipPath").attr("id",z),C.clipRect=C.clipDef.append("rect"),C.framework=t.select(C.container).append("g").attr("class","geo "+C.id).call(s.setClipUrl,z,S),C.project=function(F){var q=C.projection(F);return q?[q[0]-C.xaxis._offset,q[1]-C.yaxis._offset]:[null,null]},C.xaxis={_id:"x",c2p:function(F){return C.project(F)[0]}},C.yaxis={_id:"y",c2p:function(F){return C.project(F)[1]}},C.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},f.setConvert(C.mockAxis,P)},L.saveViewInitial=function(C){var S,P=C.center||{},z=C.projection,F=z.rotation||{};this.viewInitial={fitbounds:C.fitbounds,"projection.scale":z.scale},S=C._isScoped?{"center.lon":P.lon,"center.lat":P.lat}:C._isClipped?{"projection.rotation.lon":F.lon,"projection.rotation.lat":F.lat}:{"center.lon":P.lon,"center.lat":P.lat,"projection.rotation.lon":F.lon},o.extendFlat(this.viewInitial,S)},L.render=function(){var C,S=this.projection,P=S.getPath();function z(q){var W=S(q.lonlat);return W?a(W[0],W[1]):null}function F(q){return S.isLonLatOverEdges(q.lonlat)?"none":null}for(C in this.basePaths)this.basePaths[C].attr("d",P);for(C in this.dataPaths)this.dataPaths[C].attr("d",function(q){return P(q.geojson)});for(C in this.dataPoints)this.dataPoints[C].attr("display",F).attr("transform",z)}},{"../../components/color":666,"../../components/dragelement":685,"../../components/drawing":688,"../../components/fx":706,"../../lib":803,"../../lib/geo_location_utils":796,"../../lib/topojson_utils":832,"../../registry":931,"../cartesian/autorange":853,"../cartesian/axes":854,"../cartesian/select":874,"../plots":917,"./constants":885,"./zoom":890,"@plotly/d3":58,"d3-geo":169,"d3-geo-projection":168,"topojson-client":601}],887:[function(i,B,V){var t=i("../../plots/get_data").getSubplotCalcData,h=i("../../lib").counterRegex,p=i("./geo"),u="geo",e=h(u),l={};l.geo={valType:"subplotid",dflt:u,editType:"calc"},B.exports={attr:u,name:u,idRoot:u,idRegex:e,attrRegex:e,attributes:l,layoutAttributes:i("./layout_attributes"),supplyLayoutDefaults:i("./layout_defaults"),plot:function(o){for(var a=o._fullLayout,n=o.calcdata,s=a._subplots.geo,r=0;r<s.length;r++){var c=s[r],f=t(n,u,c),d=a[c]._subplot;d||(d=p({id:c,graphDiv:o,container:a._geolayer.node(),topojsonURL:o._context.topojsonURL,staticPlot:o._context.staticPlot}),a[c]._subplot=d),d.plot(f,a,o._promises)}},updateFx:function(o){for(var a=o._fullLayout,n=a._subplots.geo,s=0;s<n.length;s++){var r=a[n[s]];r._subplot.updateFx(a,r)}},clean:function(o,a,n,s){for(var r=s._subplots.geo||[],c=0;c<r.length;c++){var f=r[c],d=s[f]._subplot;!a[f]&&d&&(d.framework.remove(),d.clipDef.remove())}}}},{"../../lib":803,"../../plots/get_data":891,"./geo":886,"./layout_attributes":888,"./layout_defaults":889}],888:[function(i,B,V){var t=i("../../components/color/attributes"),h=i("../domain").attributes,p=i("./constants"),u=i("../../plot_api/edit_types").overrideAll,e=i("../../lib/sort_object_keys"),l={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:t.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};(B.exports=u({domain:h({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:e(p.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:e(p.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:t.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:p.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:p.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:p.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:p.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:t.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:t.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:t.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:t.background},lonaxis:l,lataxis:l},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":665,"../../lib/sort_object_keys":826,"../../plot_api/edit_types":836,"../domain":882,"./constants":885}],889:[function(i,B,V){var t=i("../../lib"),h=i("../subplot_defaults"),p=i("../get_data").getSubplotData,u=i("./constants"),e=i("./layout_attributes"),l=u.axesNames;function o(a,n,s,r){var c=p(r.fullData,"geo",r.id).map(function(U){return U._expandedIndex}),f=s("resolution"),d=s("scope"),g=u.scopeDefaults[d],m=s("projection.type",g.projType),y=n._isAlbersUsa=m==="albers usa";y&&(d=n.scope="usa");var v=n._isScoped=d!=="world",T=n._isSatellite=m==="satellite",_=n._isConic=m.indexOf("conic")!==-1||m==="albers",k=n._isClipped=!!u.lonaxisSpan[m];if(a.visible===!1){var E=t.extendDeep({},n._template);E.showcoastlines=!1,E.showcountries=!1,E.showframe=!1,E.showlakes=!1,E.showland=!1,E.showocean=!1,E.showrivers=!1,E.showsubunits=!1,E.lonaxis&&(E.lonaxis.showgrid=!1),E.lataxis&&(E.lataxis.showgrid=!1),n._template=E}for(var A=s("visible"),b=0;b<l.length;b++){var L,w=l[b],C=[30,10][b];if(v)L=g[w+"Range"];else{var S=u[w+"Span"],P=(S[m]||S["*"])/2,z=s("projection.rotation."+w.substr(0,3),g.projRotate[b]);L=[z-P,z+P]}var F=s(w+".range",L);s(w+".tick0"),s(w+".dtick",C),s(w+".showgrid",!!A&&void 0)&&(s(w+".gridcolor"),s(w+".gridwidth")),n[w]._ax={type:"linear",_id:w.slice(0,3),_traceIndices:c,setScale:t.identity,c2l:t.identity,r2l:t.identity,autorange:!0,range:F.slice(),_m:1,_input:{}}}var q=n.lonaxis.range,W=n.lataxis.range,X=q[0],Q=q[1];X>0&&Q<0&&(Q+=360);var Z,Y,N,J=(X+Q)/2;if(!y){var D=v?g.projRotate:[J,0,0];Z=s("projection.rotation.lon",D[0]),s("projection.rotation.lat",D[1]),s("projection.rotation.roll",D[2]),s("showcoastlines",!v&&A)&&(s("coastlinecolor"),s("coastlinewidth")),s("showocean",!!A&&void 0)&&s("oceancolor")}y?(Y=-96.6,N=38.7):(Y=v?J:Z,N=(W[0]+W[1])/2),s("center.lon",Y),s("center.lat",N),T&&(s("projection.tilt"),s("projection.distance")),_&&s("projection.parallels",g.projParallels||[0,60]),s("projection.scale"),s("showland",!!A&&void 0)&&s("landcolor"),s("showlakes",!!A&&void 0)&&s("lakecolor"),s("showrivers",!!A&&void 0)&&(s("rivercolor"),s("riverwidth")),s("showcountries",v&&d!=="usa"&&A)&&(s("countrycolor"),s("countrywidth")),(d==="usa"||d==="north america"&&f===50)&&(s("showsubunits",A),s("subunitcolor"),s("subunitwidth")),v||s("showframe",A)&&(s("framecolor"),s("framewidth")),s("bgcolor"),s("fitbounds")&&(delete n.projection.scale,v?(delete n.center.lon,delete n.center.lat):k?(delete n.center.lon,delete n.center.lat,delete n.projection.rotation.lon,delete n.projection.rotation.lat,delete n.lonaxis.range,delete n.lataxis.range):(delete n.center.lon,delete n.center.lat,delete n.projection.rotation.lon))}B.exports=function(a,n,s){h(a,n,s,{type:"geo",attributes:e,handleDefaults:o,fullData:s,partition:"y"})}},{"../../lib":803,"../get_data":891,"../subplot_defaults":925,"./constants":885,"./layout_attributes":888}],890:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../registry"),u=Math.PI/180,e=180/Math.PI,l={cursor:"pointer"},o={cursor:"auto"};function a(A,b){return t.behavior.zoom().translate(b.translate()).scale(b.scale())}function n(A,b,L){var w=A.id,C=A.graphDiv,S=C.layout,P=S[w],z=C._fullLayout,F=z[w],q={},W={};function X(Q,Z){q[w+"."+Q]=h.nestedProperty(P,Q).get(),p.call("_storeDirectGUIEdit",S,z._preGUI,q);var Y=h.nestedProperty(F,Q);Y.get()!==Z&&(Y.set(Z),h.nestedProperty(P,Q).set(Z),W[w+"."+Q]=Z)}L(X),X("projection.scale",b.scale()/A.fitScale),X("fitbounds",!1),C.emit("plotly_relayout",W)}function s(A,b){var L=a(0,b);function w(C){var S=b.invert(A.midPt);C("center.lon",S[0]),C("center.lat",S[1])}return L.on("zoomstart",function(){t.select(this).style(l)}).on("zoom",function(){b.scale(t.event.scale).translate(t.event.translate),A.render();var C=b.invert(A.midPt);A.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":b.scale()/A.fitScale,"geo.center.lon":C[0],"geo.center.lat":C[1]})}).on("zoomend",function(){t.select(this).style(o),n(A,b,w)}),L}function r(A,b){var L,w,C,S,P,z,F,q,W,X=a(0,b);function Q(Y){return b.invert(Y)}function Z(Y){var N=b.rotate(),J=b.invert(A.midPt);Y("projection.rotation.lon",-N[0]),Y("center.lon",J[0]),Y("center.lat",J[1])}return X.on("zoomstart",function(){t.select(this).style(l),L=t.mouse(this),w=b.rotate(),C=b.translate(),S=w,P=Q(L)}).on("zoom",function(){if(z=t.mouse(this),function(J){var D=Q(J);if(!D)return!0;var U=b(D);return Math.abs(U[0]-J[0])>2||Math.abs(U[1]-J[1])>2}(L))return X.scale(b.scale()),void X.translate(b.translate());b.scale(t.event.scale),b.translate([C[0],t.event.translate[1]]),P?Q(z)&&(q=Q(z),F=[S[0]+(q[0]-P[0]),w[1],w[2]],b.rotate(F),S=F):P=Q(L=z),W=!0,A.render();var Y=b.rotate(),N=b.invert(A.midPt);A.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":b.scale()/A.fitScale,"geo.center.lon":N[0],"geo.center.lat":N[1],"geo.projection.rotation.lon":-Y[0]})}).on("zoomend",function(){t.select(this).style(o),W&&n(A,b,Z)}),X}function c(A,b){var L;b.rotate(),b.scale();var w=a(0,b),C=function(X){for(var Q=0,Z=arguments.length,Y=[];++Q<Z;)Y.push(arguments[Q]);var N=t.dispatch.apply(null,Y);return N.of=function(J,D){return function(U){var G;try{G=U.sourceEvent=t.event,U.target=X,t.event=U,N[U.type].apply(J,D)}finally{t.event=G}}},N}(w,"zoomstart","zoom","zoomend"),S=0,P=w.on;function z(X){S++||X({type:"zoomstart"})}function F(X){X({type:"zoom"})}function q(X){--S||X({type:"zoomend"})}function W(X){var Q=b.rotate();X("projection.rotation.lon",-Q[0]),X("projection.rotation.lat",-Q[1])}return w.on("zoomstart",function(){t.select(this).style(l);var X=t.mouse(this),Q=b.rotate(),Z=Q,Y=b.translate(),N=d(Q);L=f(b,X),P.call(w,"zoom",function(){var J=t.mouse(this);if(b.scale(t.event.scale),L){if(f(b,J)){b.rotate(Q).translate(Y);var D=f(b,J),U=m(L,D),G=k(g(N,U)),$=y(G,L,Z);isFinite($[0])&&isFinite($[1])&&isFinite($[2])||($=Z),b.rotate($),Z=$}}else L=f(b,X=J);F(C.of(this,arguments))}),z(C.of(this,arguments))}).on("zoomend",function(){t.select(this).style(o),P.call(w,"zoom",null),q(C.of(this,arguments)),n(A,b,W)}).on("zoom.redraw",function(){A.render();var X=b.rotate();A.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":b.scale()/A.fitScale,"geo.projection.rotation.lon":-X[0],"geo.projection.rotation.lat":-X[1]})}),t.rebind(w,C,"on")}function f(A,b){var L=A.invert(b);return L&&isFinite(L[0])&&isFinite(L[1])&&function(w){var C=w[0]*u,S=w[1]*u,P=Math.cos(S);return[P*Math.cos(C),P*Math.sin(C),Math.sin(S)]}(L)}function d(A){var b=.5*A[0]*u,L=.5*A[1]*u,w=.5*A[2]*u,C=Math.sin(b),S=Math.cos(b),P=Math.sin(L),z=Math.cos(L),F=Math.sin(w),q=Math.cos(w);return[S*z*q+C*P*F,C*z*q-S*P*F,S*P*q+C*z*F,S*z*F-C*P*q]}function g(A,b){var L=A[0],w=A[1],C=A[2],S=A[3],P=b[0],z=b[1],F=b[2],q=b[3];return[L*P-w*z-C*F-S*q,L*z+w*P+C*q-S*F,L*F-w*q+C*P+S*z,L*q+w*F-C*z+S*P]}function m(A,b){if(A&&b){var L=function(P,z){return[P[1]*z[2]-P[2]*z[1],P[2]*z[0]-P[0]*z[2],P[0]*z[1]-P[1]*z[0]]}(A,b),w=Math.sqrt(E(L,L)),C=.5*Math.acos(Math.max(-1,Math.min(1,E(A,b)))),S=Math.sin(C)/w;return w&&[Math.cos(C),L[2]*S,-L[1]*S,L[0]*S]}}function y(A,b,L){var w=_(b,2,A[0]);w=_(w,1,A[1]),w=_(w,0,A[2]-L[2]);var C,S,P=b[0],z=b[1],F=b[2],q=w[0],W=w[1],X=w[2],Q=Math.atan2(z,P)*e,Z=Math.sqrt(P*P+z*z);Math.abs(W)>Z?(S=(W>0?90:-90)-Q,C=0):(S=Math.asin(W/Z)*e-Q,C=Math.sqrt(Z*Z-W*W));var Y=180-S-2*Q,N=(Math.atan2(X,q)-Math.atan2(F,C))*e,J=(Math.atan2(X,q)-Math.atan2(F,-C))*e;return v(L[0],L[1],S,N)<=v(L[0],L[1],Y,J)?[S,N,L[2]]:[Y,J,L[2]]}function v(A,b,L,w){var C=T(L-A),S=T(w-b);return Math.sqrt(C*C+S*S)}function T(A){return(A%360+540)%360-180}function _(A,b,L){var w=L*u,C=A.slice(),S=b===0?1:0,P=b===2?1:2,z=Math.cos(w),F=Math.sin(w);return C[S]=A[S]*z-A[P]*F,C[P]=A[P]*z+A[S]*F,C}function k(A){return[Math.atan2(2*(A[0]*A[1]+A[2]*A[3]),1-2*(A[1]*A[1]+A[2]*A[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(A[0]*A[2]-A[3]*A[1]))))*e,Math.atan2(2*(A[0]*A[3]+A[1]*A[2]),1-2*(A[2]*A[2]+A[3]*A[3]))*e]}function E(A,b){for(var L=0,w=0,C=A.length;w<C;++w)L+=A[w]*b[w];return L}B.exports=function(A,b){var L=A.projection;return(b._isScoped?s:b._isClipped?c:r)(A,L)}},{"../../lib":803,"../../registry":931,"@plotly/d3":58}],891:[function(i,B,V){var t=i("../registry"),h=i("./cartesian/constants").SUBPLOT_PATTERN;V.getSubplotCalcData=function(p,u,e){var l=t.subplotsRegistry[u];if(!l)return[];for(var o=l.attr,a=[],n=0;n<p.length;n++){var s=p[n];s[0].trace[o]===e&&a.push(s)}return a},V.getModuleCalcData=function(p,u){var e,l=[],o=[];if(!(e=typeof u=="string"?t.getModule(u).plot:typeof u=="function"?u:u.plot))return[l,p];for(var a=0;a<p.length;a++){var n=p[a],s=n[0].trace;s.visible===!0&&s._length!==0&&(s._module.plot===e?l.push(n):o.push(n))}return[l,o]},V.getSubplotData=function(p,u,e){if(!t.subplotsRegistry[u])return[];var l,o,a,n=t.subplotsRegistry[u].attr,s=[];if(u==="gl2d"){var r=e.match(h);o="x"+r[1],a="y"+r[2]}for(var c=0;c<p.length;c++)l=p[c],u==="gl2d"&&t.traceIs(l,"gl2d")?l[n[0]]===o&&l[n[1]]===a&&s.push(l):l[n]===e&&s.push(l);return s}},{"../registry":931,"./cartesian/constants":861}],892:[function(i,B,V){var t=i("mouse-change"),h=i("mouse-wheel"),p=i("mouse-event-offset"),u=i("../cartesian/constants"),e=i("has-passive-events");function l(o,a){this.element=o,this.plot=a,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}B.exports=function(o){var a=o.mouseContainer,n=o.glplot,s=new l(a,n);function r(){o.xaxis.autorange=!1,o.yaxis.autorange=!1}function c(f,d,g){var m,y,v=o.calcDataBox(),T=n.viewBox,_=s.lastPos[0],k=s.lastPos[1],E=u.MINDRAG*n.pixelRatio,A=u.MINZOOM*n.pixelRatio;function b(z,F,q){var W=Math.min(F,q),X=Math.max(F,q);W!==X?(v[z]=W,v[z+2]=X,s.dataBox=v,o.setRanges(v)):(o.selectBox.selectBox=[0,0,1,1],o.glplot.setDirty())}switch(d*=n.pixelRatio,g*=n.pixelRatio,g=T[3]-T[1]-g,o.fullLayout.dragmode){case"zoom":if(f){var L=d/(T[2]-T[0])*(v[2]-v[0])+v[0],w=g/(T[3]-T[1])*(v[3]-v[1])+v[1];s.boxInited||(s.boxStart[0]=L,s.boxStart[1]=w,s.dragStart[0]=d,s.dragStart[1]=g),s.boxEnd[0]=L,s.boxEnd[1]=w,s.boxInited=!0,s.boxEnabled||s.boxStart[0]===s.boxEnd[0]&&s.boxStart[1]===s.boxEnd[1]||(s.boxEnabled=!0);var C=Math.abs(s.dragStart[0]-d)<A,S=Math.abs(s.dragStart[1]-g)<A;if(!function(){for(var z=o.graphDiv._fullLayout._axisConstraintGroups,F=o.xaxis._id,q=o.yaxis._id,W=0;W<z.length;W++)if(z[W][F]!==-1){if(z[W][q]!==-1)return!0;break}return!1}()||C&&S)C&&(s.boxEnd[0]=s.boxStart[0]),S&&(s.boxEnd[1]=s.boxStart[1]);else{m=s.boxEnd[0]-s.boxStart[0],y=s.boxEnd[1]-s.boxStart[1];var P=(v[3]-v[1])/(v[2]-v[0]);Math.abs(m*P)>Math.abs(y)?(s.boxEnd[1]=s.boxStart[1]+Math.abs(m)*P*(y>=0?1:-1),s.boxEnd[1]<v[1]?(s.boxEnd[1]=v[1],s.boxEnd[0]=s.boxStart[0]+(v[1]-s.boxStart[1])/Math.abs(P)):s.boxEnd[1]>v[3]&&(s.boxEnd[1]=v[3],s.boxEnd[0]=s.boxStart[0]+(v[3]-s.boxStart[1])/Math.abs(P))):(s.boxEnd[0]=s.boxStart[0]+Math.abs(y)/P*(m>=0?1:-1),s.boxEnd[0]<v[0]?(s.boxEnd[0]=v[0],s.boxEnd[1]=s.boxStart[1]+(v[0]-s.boxStart[0])*Math.abs(P)):s.boxEnd[0]>v[2]&&(s.boxEnd[0]=v[2],s.boxEnd[1]=s.boxStart[1]+(v[2]-s.boxStart[0])*Math.abs(P)))}}else s.boxEnabled?(m=s.boxStart[0]!==s.boxEnd[0],y=s.boxStart[1]!==s.boxEnd[1],m||y?(m&&(b(0,s.boxStart[0],s.boxEnd[0]),o.xaxis.autorange=!1),y&&(b(1,s.boxStart[1],s.boxEnd[1]),o.yaxis.autorange=!1),o.relayoutCallback()):o.glplot.setDirty(),s.boxEnabled=!1,s.boxInited=!1):s.boxInited&&(s.boxInited=!1);break;case"pan":s.boxEnabled=!1,s.boxInited=!1,f?(s.panning||(s.dragStart[0]=d,s.dragStart[1]=g),Math.abs(s.dragStart[0]-d)<E&&(d=s.dragStart[0]),Math.abs(s.dragStart[1]-g)<E&&(g=s.dragStart[1]),m=(_-d)*(v[2]-v[0])/(n.viewBox[2]-n.viewBox[0]),y=(k-g)*(v[3]-v[1])/(n.viewBox[3]-n.viewBox[1]),v[0]+=m,v[2]+=m,v[1]+=y,v[3]+=y,o.setRanges(v),s.panning=!0,s.lastInputTime=Date.now(),r(),o.cameraChanged(),o.handleAnnotations()):s.panning&&(s.panning=!1,o.relayoutCallback())}s.lastPos[0]=d,s.lastPos[1]=g}return s.mouseListener=t(a,c),a.addEventListener("touchstart",function(f){var d=p(f.changedTouches[0],a);c(0,d[0],d[1]),c(1,d[0],d[1]),f.preventDefault()},!!e&&{passive:!1}),a.addEventListener("touchmove",function(f){f.preventDefault();var d=p(f.changedTouches[0],a);c(1,d[0],d[1]),f.preventDefault()},!!e&&{passive:!1}),a.addEventListener("touchend",function(f){c(0,s.lastPos[0],s.lastPos[1]),f.preventDefault()},!!e&&{passive:!1}),s.wheelListener=h(a,function(f,d){if(!o.scrollZoom)return!1;var g=o.calcDataBox(),m=n.viewBox,y=s.lastPos[0],v=s.lastPos[1],T=Math.exp(5*d/(m[3]-m[1])),_=y/(m[2]-m[0])*(g[2]-g[0])+g[0],k=v/(m[3]-m[1])*(g[3]-g[1])+g[1];return g[0]=(g[0]-_)*T+_,g[2]=(g[2]-_)*T+_,g[1]=(g[1]-k)*T+k,g[3]=(g[3]-k)*T+k,o.setRanges(g),s.lastInputTime=Date.now(),r(),o.cameraChanged(),o.handleAnnotations(),o.relayoutCallback(),!0},!0),s}},{"../cartesian/constants":861,"has-passive-events":444,"mouse-change":470,"mouse-event-offset":471,"mouse-wheel":473}],893:[function(i,B,V){var t=i("../cartesian/axes"),h=i("../../lib/str2rgbarray");function p(l){this.scene=l,this.gl=l.gl,this.pixelRatio=l.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var u=p.prototype,e=["xaxis","yaxis"];u.merge=function(l){var o,a,n,s,r,c,f,d,g,m,y;for(this.titleEnable=!1,this.backgroundColor=h(l.plot_bgcolor),m=0;m<2;++m){var v=(o=e[m]).charAt(0);for(n=(a=l[this.scene[o]._name]).title.text===this.scene.fullLayout._dfltTitle[v]?"":a.title.text,y=0;y<=2;y+=2)this.labelEnable[m+y]=!1,this.labels[m+y]=n,this.labelColor[m+y]=h(a.title.font.color),this.labelFont[m+y]=a.title.font.family,this.labelSize[m+y]=a.title.font.size,this.labelPad[m+y]=this.getLabelPad(o,a),this.tickEnable[m+y]=!1,this.tickColor[m+y]=h((a.tickfont||{}).color),this.tickAngle[m+y]=a.tickangle==="auto"?0:Math.PI*-a.tickangle/180,this.tickPad[m+y]=this.getTickPad(a),this.tickMarkLength[m+y]=0,this.tickMarkWidth[m+y]=a.tickwidth||0,this.tickMarkColor[m+y]=h(a.tickcolor),this.borderLineEnable[m+y]=!1,this.borderLineColor[m+y]=h(a.linecolor),this.borderLineWidth[m+y]=a.linewidth||0;f=this.hasSharedAxis(a),r=this.hasAxisInDfltPos(o,a)&&!f,c=this.hasAxisInAltrPos(o,a)&&!f,s=a.mirror||!1,d=f?String(s).indexOf("all")!==-1:!!s,g=f?s==="allticks":String(s).indexOf("ticks")!==-1,r?this.labelEnable[m]=!0:c&&(this.labelEnable[m+2]=!0),r?this.tickEnable[m]=a.showticklabels:c&&(this.tickEnable[m+2]=a.showticklabels),(r||d)&&(this.borderLineEnable[m]=a.showline),(c||d)&&(this.borderLineEnable[m+2]=a.showline),(r||g)&&(this.tickMarkLength[m]=this.getTickMarkLength(a)),(c||g)&&(this.tickMarkLength[m+2]=this.getTickMarkLength(a)),this.gridLineEnable[m]=a.showgrid,this.gridLineColor[m]=h(a.gridcolor),this.gridLineWidth[m]=a.gridwidth,this.zeroLineEnable[m]=a.zeroline,this.zeroLineColor[m]=h(a.zerolinecolor),this.zeroLineWidth[m]=a.zerolinewidth}},u.hasSharedAxis=function(l){var o=this.scene,a=o.fullLayout._subplots.gl2d;return t.findSubplotsWithAxis(a,l).indexOf(o.id)!==0},u.hasAxisInDfltPos=function(l,o){var a=o.side;return l==="xaxis"?a==="bottom":l==="yaxis"?a==="left":void 0},u.hasAxisInAltrPos=function(l,o){var a=o.side;return l==="xaxis"?a==="top":l==="yaxis"?a==="right":void 0},u.getLabelPad=function(l,o){var a=o.title.font.size,n=o.showticklabels;return l==="xaxis"?o.side==="top"?a*(1.5+(n?1:0))-10:a*(1.5+(n?.5:0))-10:l==="yaxis"?o.side==="right"?10+a*(1.5+(n?1:.5)):10+a*(1.5+(n?.5:0)):void 0},u.getTickPad=function(l){return l.ticks==="outside"?10+l.ticklen:15},u.getTickMarkLength=function(l){if(!l.ticks)return 0;var o=l.ticklen;return l.ticks==="inside"?-o:o},B.exports=function(l){return new p(l)}},{"../../lib/str2rgbarray":828,"../cartesian/axes":854}],894:[function(i,B,V){var t=i("../../plot_api/edit_types").overrideAll,h=i("./scene2d"),p=i("../layout_attributes"),u=i("../../constants/xmlns_namespaces"),e=i("../cartesian/constants"),l=i("../cartesian"),o=i("../../components/fx/layout_attributes"),a=i("../get_data").getSubplotData;V.name="gl2d",V.attr=["xaxis","yaxis"],V.idRoot=["x","y"],V.idRegex=e.idRegex,V.attrRegex=e.attrRegex,V.attributes=i("../cartesian/attributes"),V.supplyLayoutDefaults=function(n,s,r){s._has("cartesian")||l.supplyLayoutDefaults(n,s,r)},V.layoutAttrOverrides=t(l.layoutAttributes,"plot","from-root"),V.baseLayoutAttrOverrides=t({plot_bgcolor:p.plot_bgcolor,hoverlabel:o.hoverlabel},"plot","nested"),V.plot=function(n){for(var s=n._fullLayout,r=n._fullData,c=s._subplots.gl2d,f=0;f<c.length;f++){var d=c[f],g=s._plots[d],m=a(r,"gl2d",d),y=g._scene2d;y===void 0&&(y=new h({id:d,graphDiv:n,container:n.querySelector(".gl-container"),staticPlot:n._context.staticPlot,plotGlPixelRatio:n._context.plotGlPixelRatio},s),g._scene2d=y),y.plot(m,n.calcdata,s,n.layout)}},V.clean=function(n,s,r,c){for(var f=c._subplots.gl2d||[],d=0;d<f.length;d++){var g=f[d],m=c._plots[g];if(m._scene2d){var y=a(n,"gl2d",g);y.length===0&&(m._scene2d.destroy(),delete c._plots[g])}}l.clean.apply(this,arguments)},V.drawFramework=function(n){n._context.staticPlot||l.drawFramework(n)},V.toSVG=function(n){for(var s=n._fullLayout,r=s._subplots.gl2d,c=0;c<r.length;c++){var f=s._plots[r[c]]._scene2d,d=f.toImage("png");s._glimages.append("svg:image").attr({xmlns:u.svg,"xlink:href":d,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),f.destroy()}},V.updateFx=function(n){for(var s=n._fullLayout,r=s._subplots.gl2d,c=0;c<r.length;c++)s._plots[r[c]]._scene2d.updateFx(s.dragmode)}},{"../../components/fx/layout_attributes":707,"../../constants/xmlns_namespaces":780,"../../plot_api/edit_types":836,"../cartesian":868,"../cartesian/attributes":852,"../cartesian/constants":861,"../get_data":891,"../layout_attributes":908,"./scene2d":895}],895:[function(i,B,V){var t,h,p=i("../../registry"),u=i("../../plots/cartesian/axes"),e=i("../../components/fx"),l=i("gl-plot2d"),o=i("gl-spikes2d"),a=i("gl-select-box"),n=i("webgl-context"),s=i("./convert"),r=i("./camera"),c=i("../../lib/show_no_webgl_msg"),f=i("../cartesian/constraints"),d=f.enforce,g=f.clean,m=i("../cartesian/autorange").doAutoRange,y=i("../../components/dragelement/helpers"),v=y.drawMode,T=y.selectMode,_=["xaxis","yaxis"],k=i("../cartesian/constants").SUBPLOT_PATTERN;function E(b,L){this.container=b.container,this.graphDiv=b.graphDiv,this.pixelRatio=b.plotGlPixelRatio||window.devicePixelRatio,this.id=b.id,this.staticPlot=!!b.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),this.stopped||(this.glplotOptions=s(this),this.glplotOptions.merge(L),this.glplot=l(this.glplotOptions),this.camera=r(this),this.traces={},this.spikes=o(this.glplot),this.selectBox=a(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}B.exports=E;var A=E.prototype;A.makeFramework=function(){if(this.staticPlot){if(!(h||(t=document.createElement("canvas"),h=n({canvas:t,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=t,this.gl=h}else{var b=this.container.querySelector(".gl-canvas-focus"),L=n({canvas:b,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L)return c(this),void(this.stopped=!0);this.canvas=b,this.gl=L}var w=this.canvas;w.style.width="100%",w.style.height="100%",w.style.position="absolute",w.style.top="0px",w.style.left="0px",w.style["pointer-events"]="none",this.updateSize(w);var C=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");C.style.position="absolute",C.style.top=C.style.left="0px",C.style.width=C.style.height="100%",C.style["z-index"]=20,C.style["pointer-events"]="none";var S=this.mouseContainer=document.createElement("div");S.style.position="absolute",S.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var P=this.container;P.appendChild(C),P.appendChild(S);var z=this;S.addEventListener("mouseout",function(){z.isMouseOver=!1,z.unhover()}),S.addEventListener("mouseover",function(){z.isMouseOver=!0})},A.toImage=function(b){b||(b="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(t),this.updateSize(this.canvas);var L=this.glplot.gl,w=L.drawingBufferWidth,C=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var S=new Uint8Array(w*C*4);L.readPixels(0,0,w,C,L.RGBA,L.UNSIGNED_BYTE,S);for(var P=0,z=C-1;P<z;++P,--z)for(var F=0;F<w;++F)for(var q=0;q<4;++q){var W=S[4*(w*P+F)+q];S[4*(w*P+F)+q]=S[4*(w*z+F)+q],S[4*(w*z+F)+q]=W}var X=document.createElement("canvas");X.width=w,X.height=C;var Q,Z=X.getContext("2d"),Y=Z.createImageData(w,C);switch(Y.data.set(S),Z.putImageData(Y,0,0),b){case"jpeg":Q=X.toDataURL("image/jpeg");break;case"webp":Q=X.toDataURL("image/webp");break;default:Q=X.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(t),Q},A.updateSize=function(b){b||(b=this.canvas);var L=this.pixelRatio,w=this.fullLayout,C=w.width,S=w.height,P=0|Math.ceil(L*C),z=0|Math.ceil(L*S);return b.width===P&&b.height===z||(b.width=P,b.height=z),b},A.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var b=[u.calcTicks(this.xaxis),u.calcTicks(this.yaxis)],L=0;L<2;++L)for(var w=0;w<b[L].length;++w)b[L][w].text=b[L][w].text+"";return b},A.updateRefs=function(b){this.fullLayout=b;var L=this.id.match(k),w="xaxis"+L[1],C="yaxis"+L[2];this.xaxis=this.fullLayout[w],this.yaxis=this.fullLayout[C]},A.relayoutCallback=function(){var b=this.graphDiv,L=this.xaxis,w=this.yaxis,C=b.layout,S={},P=S[L._name+".range"]=L.range.slice(),z=S[w._name+".range"]=w.range.slice();S[L._name+".autorange"]=L.autorange,S[w._name+".autorange"]=w.autorange,p.call("_storeDirectGUIEdit",b.layout,b._fullLayout._preGUI,S);var F=C[L._name];F.range=P,F.autorange=L.autorange;var q=C[w._name];q.range=z,q.autorange=w.autorange,S.lastInputTime=this.camera.lastInputTime,b.emit("plotly_relayout",S)},A.cameraChanged=function(){var b=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks();(function(w,C){for(var S=0;S<2;++S){var P=w[S],z=C[S];if(P.length!==z.length)return!0;for(var F=0;F<P.length;++F)if(P[F].x!==z[F].x)return!0}return!1})(L,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=b.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},A.handleAnnotations=function(){for(var b=this.graphDiv,L=this.fullLayout.annotations,w=0;w<L.length;w++){var C=L[w];C.xref===this.xaxis._id&&C.yref===this.yaxis._id&&p.getComponentMethod("annotations","drawOne")(b,w)}},A.destroy=function(){if(this.glplot){var b=this.traces;b&&Object.keys(b).map(function(L){b[L].dispose(),delete b[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},A.plot=function(b,L,w){var C=this.glplot;this.updateRefs(w),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(b,L),this.updateFx(w.dragmode);var S=w.width,P=w.height;this.updateSize(this.canvas);var z=this.glplotOptions;z.merge(w),z.screenBox=[0,0,S,P];var F={_fullLayout:{_axisConstraintGroups:w._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:w._size}};g(F,this.xaxis),g(F,this.yaxis);var q,W,X=w._size,Q=this.xaxis.domain,Z=this.yaxis.domain;for(z.viewBox=[X.l+Q[0]*X.w,X.b+Z[0]*X.h,S-X.r-(1-Q[1])*X.w,P-X.t-(1-Z[1])*X.h],this.mouseContainer.style.width=X.w*(Q[1]-Q[0])+"px",this.mouseContainer.style.height=X.h*(Z[1]-Z[0])+"px",this.mouseContainer.height=X.h*(Z[1]-Z[0]),this.mouseContainer.style.left=X.l+Q[0]*X.w+"px",this.mouseContainer.style.top=X.t+(1-Z[1])*X.h+"px",W=0;W<2;++W)(q=this[_[W]])._length=z.viewBox[W+2]-z.viewBox[W],m(this.graphDiv,q),q.setScale();d(F),z.ticks=this.computeTickMarks(),z.dataBox=this.calcDataBox(),z.merge(w),C.update(z),this.glplot.draw()},A.calcDataBox=function(){var b=this.xaxis,L=this.yaxis,w=b.range,C=L.range,S=b.r2l,P=L.r2l;return[S(w[0]),P(C[0]),S(w[1]),P(C[1])]},A.setRanges=function(b){var L=this.xaxis,w=this.yaxis,C=L.l2r,S=w.l2r;L.range=[C(b[0]),C(b[2])],w.range=[S(b[1]),S(b[3])]},A.updateTraces=function(b,L){var w,C,S,P=Object.keys(this.traces);this.fullData=b;e:for(w=0;w<P.length;w++){var z=P[w],F=this.traces[z];for(C=0;C<b.length;C++)if((S=b[C]).uid===z&&S.type===F.type)continue e;F.dispose(),delete this.traces[z]}for(w=0;w<b.length;w++){S=b[w];var q=L[w],W=this.traces[S.uid];W?W.update(S,q):(W=S._module.plot(this,S,q),this.traces[S.uid]=W)}this.glplot.objects.sort(function(X,Q){return X._trace.index-Q._trace.index})},A.updateFx=function(b){T(b)||v(b)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor=b==="pan"?"move":b==="zoom"?"crosshair":null},A.emitPointAction=function(b,L){for(var w,C=b.trace.uid,S=b.pointIndex,P=0;P<this.fullData.length;P++)this.fullData[P].uid===C&&(w=this.fullData[P]);var z={x:b.traceCoord[0],y:b.traceCoord[1],curveNumber:w.index,pointNumber:S,data:w._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(z,w,S),this.graphDiv.emit(L,{points:[z]})},A.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var b=this.glplot,L=this.camera,w=L.mouseListener,C=this.lastButtonState===1&&w.buttons===0,S=this.fullLayout;this.lastButtonState=w.buttons,this.cameraChanged();var P,z=w.x*b.pixelRatio,F=this.canvas.height-b.pixelRatio*w.y;if(L.boxEnabled&&S.dragmode==="zoom"){this.selectBox.enabled=!0;for(var q=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],W=0;W<2;W++)L.boxStart[W]===L.boxEnd[W]&&(q[W]=b.dataBox[W],q[W+2]=b.dataBox[W+2]);b.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var X=S._size,Q=this.xaxis.domain,Z=this.yaxis.domain,Y=(P=b.pick(z/b.pixelRatio+X.l+Q[0]*X.w,F/b.pixelRatio-(X.t+(1-Z[1])*X.h)))&&P.object._trace.handlePick(P);if(Y&&C&&this.emitPointAction(Y,"plotly_click"),P&&P.object._trace.hoverinfo!=="skip"&&S.hovermode&&Y&&(!this.lastPickResult||this.lastPickResult.traceUid!==Y.trace.uid||this.lastPickResult.dataCoord[0]!==Y.dataCoord[0]||this.lastPickResult.dataCoord[1]!==Y.dataCoord[1])){var N=Y;this.lastPickResult={traceUid:Y.trace?Y.trace.uid:null,dataCoord:Y.dataCoord.slice()},this.spikes.update({center:P.dataCoord}),N.screenCoord=[((b.viewBox[2]-b.viewBox[0])*(P.dataCoord[0]-b.dataBox[0])/(b.dataBox[2]-b.dataBox[0])+b.viewBox[0])/b.pixelRatio,(this.canvas.height-(b.viewBox[3]-b.viewBox[1])*(P.dataCoord[1]-b.dataBox[1])/(b.dataBox[3]-b.dataBox[1])-b.viewBox[1])/b.pixelRatio],this.emitPointAction(Y,"plotly_hover");var J=this.fullData[N.trace.index]||{},D=N.pointIndex,U=e.castHoverinfo(J,S,D);if(U&&U!=="all"){var G=U.split("+");G.indexOf("x")===-1&&(N.traceCoord[0]=void 0),G.indexOf("y")===-1&&(N.traceCoord[1]=void 0),G.indexOf("z")===-1&&(N.traceCoord[2]=void 0),G.indexOf("text")===-1&&(N.textLabel=void 0),G.indexOf("name")===-1&&(N.name=void 0)}e.loneHover({x:N.screenCoord[0],y:N.screenCoord[1],xLabel:this.hoverFormatter("xaxis",N.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",N.traceCoord[1]),zLabel:N.traceCoord[2],text:N.textLabel,name:N.name,color:e.castHoverOption(J,D,"bgcolor")||N.color,borderColor:e.castHoverOption(J,D,"bordercolor"),fontFamily:e.castHoverOption(J,D,"font.family"),fontSize:e.castHoverOption(J,D,"font.size"),fontColor:e.castHoverOption(J,D,"font.color"),nameLength:e.castHoverOption(J,D,"namelength"),textAlign:e.castHoverOption(J,D,"align")},{container:this.svgContainer,gd:this.graphDiv})}}P||this.unhover(),b.draw()}},A.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},A.hoverFormatter=function(b,L){if(L!==void 0){var w=this[b];return u.tickText(w,w.c2l(L),"hover").text}}},{"../../components/dragelement/helpers":684,"../../components/fx":706,"../../lib/show_no_webgl_msg":825,"../../plots/cartesian/axes":854,"../../registry":931,"../cartesian/autorange":853,"../cartesian/constants":861,"../cartesian/constraints":862,"./camera":892,"./convert":893,"gl-plot2d":322,"gl-select-box":337,"gl-spikes2d":346,"webgl-context":629}],896:[function(i,B,V){var t=i("../../plot_api/edit_types").overrideAll,h=i("../../components/fx/layout_attributes"),p=i("./scene"),u=i("../get_data").getSubplotData,e=i("../../lib"),l=i("../../constants/xmlns_namespaces");V.name="gl3d",V.attr="scene",V.idRoot="scene",V.idRegex=V.attrRegex=e.counterRegex("scene"),V.attributes=i("./layout/attributes"),V.layoutAttributes=i("./layout/layout_attributes"),V.baseLayoutAttrOverrides=t({hoverlabel:h.hoverlabel},"plot","nested"),V.supplyLayoutDefaults=i("./layout/defaults"),V.plot=function(o){for(var a=o._fullLayout,n=o._fullData,s=a._subplots.gl3d,r=0;r<s.length;r++){var c=s[r],f=u(n,"gl3d",c),d=a[c],g=d.camera,m=d._scene;m||(m=new p({id:c,graphDiv:o,container:o.querySelector(".gl-container"),staticPlot:o._context.staticPlot,plotGlPixelRatio:o._context.plotGlPixelRatio,camera:g},a),d._scene=m),m.viewInitial||(m.viewInitial={up:{x:g.up.x,y:g.up.y,z:g.up.z},eye:{x:g.eye.x,y:g.eye.y,z:g.eye.z},center:{x:g.center.x,y:g.center.y,z:g.center.z}}),m.plot(f,a,o.layout)}},V.clean=function(o,a,n,s){for(var r=s._subplots.gl3d||[],c=0;c<r.length;c++){var f=r[c];!a[f]&&s[f]._scene&&(s[f]._scene.destroy(),s._infolayer&&s._infolayer.selectAll(".annotation-"+f).remove())}},V.toSVG=function(o){for(var a=o._fullLayout,n=a._subplots.gl3d,s=a._size,r=0;r<n.length;r++){var c=a[n[r]],f=c.domain,d=c._scene,g=d.toImage("png");a._glimages.append("svg:image").attr({xmlns:l.svg,"xlink:href":g,x:s.l+s.w*f.x[0],y:s.t+s.h*(1-f.y[1]),width:s.w*(f.x[1]-f.x[0]),height:s.h*(f.y[1]-f.y[0]),preserveAspectRatio:"none"}),d.destroy()}},V.cleanId=function(o){if(o.match(/^scene[0-9]*$/)){var a=o.substr(5);return a==="1"&&(a=""),"scene"+a}},V.updateFx=function(o){for(var a=o._fullLayout,n=a._subplots.gl3d,s=0;s<n.length;s++)a[n[s]]._scene.updateFx(a.dragmode,a.hovermode)}},{"../../components/fx/layout_attributes":707,"../../constants/xmlns_namespaces":780,"../../lib":803,"../../plot_api/edit_types":836,"../get_data":891,"./layout/attributes":897,"./layout/defaults":901,"./layout/layout_attributes":902,"./scene":906}],897:[function(i,B,V){B.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],898:[function(i,B,V){var t=i("../../../components/color"),h=i("../../cartesian/layout_attributes"),p=i("../../../lib/extend").extendFlat,u=i("../../../plot_api/edit_types").overrideAll;B.exports=u({visible:h.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:t.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:h.color,categoryorder:h.categoryorder,categoryarray:h.categoryarray,title:{text:h.title.text,font:h.title.font},type:p({},h.type,{values:["-","linear","log","date","category"]}),autotypenumbers:h.autotypenumbers,autorange:h.autorange,rangemode:h.rangemode,range:p({},h.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:h.tickmode,nticks:h.nticks,tick0:h.tick0,dtick:h.dtick,tickvals:h.tickvals,ticktext:h.ticktext,ticks:h.ticks,mirror:h.mirror,ticklen:h.ticklen,tickwidth:h.tickwidth,tickcolor:h.tickcolor,showticklabels:h.showticklabels,tickfont:h.tickfont,tickangle:h.tickangle,tickprefix:h.tickprefix,showtickprefix:h.showtickprefix,ticksuffix:h.ticksuffix,showticksuffix:h.showticksuffix,showexponent:h.showexponent,exponentformat:h.exponentformat,minexponent:h.minexponent,separatethousands:h.separatethousands,tickformat:h.tickformat,tickformatstops:h.tickformatstops,hoverformat:h.hoverformat,showline:h.showline,linecolor:h.linecolor,linewidth:h.linewidth,showgrid:h.showgrid,gridcolor:p({},h.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:h.gridwidth,zeroline:h.zeroline,zerolinecolor:h.zerolinecolor,zerolinewidth:h.zerolinewidth,_deprecated:{title:h._deprecated.title,titlefont:h._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":666,"../../../lib/extend":793,"../../../plot_api/edit_types":836,"../../cartesian/layout_attributes":869}],899:[function(i,B,V){var t=i("tinycolor2").mix,h=i("../../../lib"),p=i("../../../plot_api/plot_template"),u=i("./axis_attributes"),e=i("../../cartesian/type_defaults"),l=i("../../cartesian/axis_defaults"),o=["xaxis","yaxis","zaxis"];B.exports=function(a,n,s){var r,c;function f(m,y){return h.coerce(r,c,u,m,y)}for(var d=0;d<o.length;d++){var g=o[d];r=a[g]||{},(c=p.newContainer(n,g))._id=g[0]+s.scene,c._name=g,e(r,c,f,s),l(r,c,f,{font:s.font,letter:g[0],data:s.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:s.bgColor,calendar:s.calendar},s.fullLayout),f("gridcolor",t(c.color,s.bgColor,13600/187).toRgbString()),f("title.text",g[0]),c.setScale=h.noop,f("showspikes")&&(f("spikesides"),f("spikethickness"),f("spikecolor",c.color)),f("showaxeslabels"),f("showbackground")&&f("backgroundcolor")}}},{"../../../lib":803,"../../../plot_api/plot_template":843,"../../cartesian/axis_defaults":856,"../../cartesian/type_defaults":880,"./axis_attributes":898,tinycolor2:598}],900:[function(i,B,V){var t=i("../../../lib/str2rgbarray"),h=i("../../../lib"),p=["xaxis","yaxis","zaxis"];function u(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}u.prototype.merge=function(e,l){for(var o=0;o<3;++o){var a=l[p[o]];a.visible?(this.labels[o]=e._meta?h.templateString(a.title.text,e._meta):a.title.text,"font"in a.title&&(a.title.font.color&&(this.labelColor[o]=t(a.title.font.color)),a.title.font.family&&(this.labelFont[o]=a.title.font.family),a.title.font.size&&(this.labelSize[o]=a.title.font.size)),"showline"in a&&(this.lineEnable[o]=a.showline),"linecolor"in a&&(this.lineColor[o]=t(a.linecolor)),"linewidth"in a&&(this.lineWidth[o]=a.linewidth),"showgrid"in a&&(this.gridEnable[o]=a.showgrid),"gridcolor"in a&&(this.gridColor[o]=t(a.gridcolor)),"gridwidth"in a&&(this.gridWidth[o]=a.gridwidth),a.type==="log"?this.zeroEnable[o]=!1:"zeroline"in a&&(this.zeroEnable[o]=a.zeroline),"zerolinecolor"in a&&(this.zeroLineColor[o]=t(a.zerolinecolor)),"zerolinewidth"in a&&(this.zeroLineWidth[o]=a.zerolinewidth),"ticks"in a&&a.ticks?this.lineTickEnable[o]=!0:this.lineTickEnable[o]=!1,"ticklen"in a&&(this.lineTickLength[o]=this._defaultLineTickLength[o]=a.ticklen),"tickcolor"in a&&(this.lineTickColor[o]=t(a.tickcolor)),"tickwidth"in a&&(this.lineTickWidth[o]=a.tickwidth),"tickangle"in a&&(this.tickAngle[o]=a.tickangle==="auto"?-3600:Math.PI*-a.tickangle/180),"showticklabels"in a&&(this.tickEnable[o]=a.showticklabels),"tickfont"in a&&(a.tickfont.color&&(this.tickColor[o]=t(a.tickfont.color)),a.tickfont.family&&(this.tickFont[o]=a.tickfont.family),a.tickfont.size&&(this.tickSize[o]=a.tickfont.size)),"mirror"in a?["ticks","all","allticks"].indexOf(a.mirror)!==-1?(this.lineTickMirror[o]=!0,this.lineMirror[o]=!0):a.mirror===!0?(this.lineTickMirror[o]=!1,this.lineMirror[o]=!0):(this.lineTickMirror[o]=!1,this.lineMirror[o]=!1):this.lineMirror[o]=!1,"showbackground"in a&&a.showbackground!==!1?(this.backgroundEnable[o]=!0,this.backgroundColor[o]=t(a.backgroundcolor)):this.backgroundEnable[o]=!1):(this.tickEnable[o]=!1,this.labelEnable[o]=!1,this.lineEnable[o]=!1,this.lineTickEnable[o]=!1,this.gridEnable[o]=!1,this.zeroEnable[o]=!1,this.backgroundEnable[o]=!1)}},B.exports=function(e,l){var o=new u;return o.merge(e,l),o}},{"../../../lib":803,"../../../lib/str2rgbarray":828}],901:[function(i,B,V){var t=i("../../../lib"),h=i("../../../components/color"),p=i("../../../registry"),u=i("../../subplot_defaults"),e=i("./axis_defaults"),l=i("./layout_attributes"),o=i("../../get_data").getSubplotData;function a(n,s,r,c){for(var f=r("bgcolor"),d=h.combine(f,c.paper_bgcolor),g=["up","center","eye"],m=0;m<g.length;m++)r("camera."+g[m]+".x"),r("camera."+g[m]+".y"),r("camera."+g[m]+".z");r("camera.projection.type");var y=!!r("aspectratio.x")&&!!r("aspectratio.y")&&!!r("aspectratio.z"),v=r("aspectmode",y?"manual":"auto");y||(n.aspectratio=s.aspectratio={x:1,y:1,z:1},v==="manual"&&(s.aspectmode="auto"),n.aspectmode=s.aspectmode);var T=o(c.fullData,"gl3d",c.id);e(n,s,{font:c.font,scene:c.id,data:T,bgColor:d,calendar:c.calendar,autotypenumbersDflt:c.autotypenumbersDflt,fullLayout:c.fullLayout}),p.getComponentMethod("annotations3d","handleDefaults")(n,s,c);var _=c.getDfltFromLayout("dragmode");if(_!==!1&&!_)if(_="orbit",n.camera&&n.camera.up){var k=n.camera.up.x,E=n.camera.up.y,A=n.camera.up.z;A!==0&&(k&&E&&A?A/Math.sqrt(k*k+E*E+A*A)>.999&&(_="turntable"):_="turntable")}else _="turntable";r("dragmode",_),r("hovermode",c.getDfltFromLayout("hovermode"))}B.exports=function(n,s,r){var c=s._basePlotModules.length>1;u(n,s,r,{type:"gl3d",attributes:l,handleDefaults:a,fullLayout:s,font:s.font,fullData:r,getDfltFromLayout:function(f){if(!c)return t.validate(n[f],l[f])?n[f]:void 0},autotypenumbersDflt:s.autotypenumbers,paper_bgcolor:s.paper_bgcolor,calendar:s.calendar})}},{"../../../components/color":666,"../../../lib":803,"../../../registry":931,"../../get_data":891,"../../subplot_defaults":925,"./axis_defaults":899,"./layout_attributes":902}],902:[function(i,B,V){var t=i("./axis_attributes"),h=i("../../domain").attributes,p=i("../../../lib/extend").extendFlat,u=i("../../../lib").counterRegex;function e(l,o,a){return{x:{valType:"number",dflt:l,editType:"camera"},y:{valType:"number",dflt:o,editType:"camera"},z:{valType:"number",dflt:a,editType:"camera"},editType:"camera"}}B.exports={_arrayAttrRegexps:[u("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:p(e(0,0,1),{}),center:p(e(0,0,0),{}),eye:p(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:h({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:t,yaxis:t,zaxis:t,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":803,"../../../lib/extend":793,"../../domain":882,"./axis_attributes":898}],903:[function(i,B,V){var t=i("../../../lib/str2rgbarray"),h=["xaxis","yaxis","zaxis"];function p(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}p.prototype.merge=function(u){for(var e=0;e<3;++e){var l=u[h[e]];l.visible?(this.enabled[e]=l.showspikes,this.colors[e]=t(l.spikecolor),this.drawSides[e]=l.spikesides,this.lineWidth[e]=l.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},B.exports=function(u){var e=new p;return e.merge(u),e}},{"../../../lib/str2rgbarray":828}],904:[function(i,B,V){B.exports=function(e){for(var l=e.axesOptions,o=e.glplot.axesPixels,a=e.fullSceneLayout,n=[[],[],[]],s=0;s<3;++s){var r=a[p[s]];if(r._length=(o[s].hi-o[s].lo)*o[s].pixelsPerDataUnit/e.dataScale[s],Math.abs(r._length)===1/0||isNaN(r._length))n[s]=[];else{r._input_range=r.range.slice(),r.range[0]=o[s].lo/e.dataScale[s],r.range[1]=o[s].hi/e.dataScale[s],r._m=1/(e.dataScale[s]*o[s].pixelsPerDataUnit),r.range[0]===r.range[1]&&(r.range[0]-=1,r.range[1]+=1);var c=r.tickmode;if(r.tickmode==="auto"){r.tickmode="linear";var f=r.nticks||h.constrain(r._length/40,4,9);t.autoTicks(r,Math.abs(r.range[1]-r.range[0])/f)}for(var d=t.calcTicks(r,{msUTC:!0}),g=0;g<d.length;++g)d[g].x=d[g].x*e.dataScale[s],r.type==="date"&&(d[g].text=d[g].text.replace(/\<br\>/g," "));n[s]=d,r.tickmode=c}}for(l.ticks=n,s=0;s<3;++s)for(u[s]=.5*(e.glplot.bounds[0][s]+e.glplot.bounds[1][s]),g=0;g<2;++g)l.bounds[g][s]=e.glplot.bounds[g][s];e.contourLevels=function(m){for(var y=new Array(3),v=0;v<3;++v){for(var T=m[v],_=new Array(T.length),k=0;k<T.length;++k)_[k]=T[k].x;y[v]=_}return y}(n)};var t=i("../../cartesian/axes"),h=i("../../../lib"),p=["xaxis","yaxis","zaxis"],u=[0,0,0]},{"../../../lib":803,"../../cartesian/axes":854}],905:[function(i,B,V){function t(h,p){var u,e,l=[0,0,0,0];for(u=0;u<4;++u)for(e=0;e<4;++e)l[e]+=h[4*u+e]*p[u];return l}B.exports=function(h,p){return t(h.projection,t(h.view,t(h.model,[p[0],p[1],p[2],1])))}},{}],906:[function(i,B,V){var t,h,p=i("gl-plot3d"),u=p.createCamera,e=p.createScene,l=i("webgl-context"),o=i("has-passive-events"),a=i("../../registry"),n=i("../../lib"),s=n.preserveDrawingBuffer(),r=i("../../plots/cartesian/axes"),c=i("../../components/fx"),f=i("../../lib/str2rgbarray"),d=i("../../lib/show_no_webgl_msg"),g=i("./project"),m=i("./layout/convert"),y=i("./layout/spikes"),v=i("./layout/tick_marks");function T(b,L){var w=document.createElement("div"),C=b.container;this.graphDiv=b.graphDiv;var S=document.createElementNS("http://www.w3.org/2000/svg","svg");S.style.position="absolute",S.style.top=S.style.left="0px",S.style.width=S.style.height="100%",S.style["z-index"]=20,S.style["pointer-events"]="none",w.appendChild(S),this.svgContainer=S,w.id=b.id,w.style.position="absolute",w.style.top=w.style.left="0px",w.style.width=w.style.height="100%",C.appendChild(w),this.fullLayout=L,this.id=b.id||"scene",this.fullSceneLayout=L[this.id],this.plotArgs=[[],{},{}],this.axesOptions=m(L,L[this.id]),this.spikeOptions=y(L[this.id]),this.container=w,this.staticMode=!!b.staticPlot,this.pixelRatio=this.pixelRatio||b.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=a.getComponentMethod("annotations3d","convert"),this.drawAnnotations=a.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var _=T.prototype;_.prepareOptions=function(){var b={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:s,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(h||(t=document.createElement("canvas"),h=l({canvas:t,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");b.gl=h,b.canvas=t}return b};var k=!0;_.tryCreatePlot=function(){var b=this.prepareOptions(),L=!0;try{this.glplot=e(b)}catch{if(this.staticMode||!k||s)L=!1;else{n.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{s=b.glOptions.preserveDrawingBuffer=!0,this.glplot=e(b)}catch{s=b.glOptions.preserveDrawingBuffer=!1,L=!1}}}return k=!1,L},_.initializeGLCamera=function(){var b=this.fullSceneLayout.camera,L=b.projection.type==="orthographic";this.camera=u(this.container,{center:[b.center.x,b.center.y,b.center.z],eye:[b.eye.x,b.eye.y,b.eye.z],up:[b.up.x,b.up.y,b.up.z],_ortho:L,zoomMin:.01,zoomMax:100,mode:"orbit"})},_.initializeGLPlot=function(){var b=this;if(b.initializeGLCamera(),!b.tryCreatePlot())return d(b);b.traces={},b.make4thDimension();var L=b.graphDiv,w=L.layout,C=function(){var P={};return b.isCameraChanged(w)&&(P[b.id+".camera"]=b.getCamera()),b.isAspectChanged(w)&&(P[b.id+".aspectratio"]=b.glplot.getAspectratio(),w[b.id].aspectmode!=="manual"&&(b.fullSceneLayout.aspectmode=w[b.id].aspectmode=P[b.id+".aspectmode"]="manual")),P},S=function(P){if(P.fullSceneLayout.dragmode!==!1){var z=C();P.saveLayout(w),P.graphDiv.emit("plotly_relayout",z)}};return b.glplot.canvas&&(b.glplot.canvas.addEventListener("mouseup",function(){S(b)}),b.glplot.canvas.addEventListener("wheel",function(P){if(L._context._scrollZoom.gl3d){if(b.camera._ortho){var z=P.deltaX>P.deltaY?1.1:.9090909090909091,F=b.glplot.getAspectratio();b.glplot.setAspectratio({x:z*F.x,y:z*F.y,z:z*F.z})}S(b)}},!!o&&{passive:!1}),b.glplot.canvas.addEventListener("mousemove",function(){if(b.fullSceneLayout.dragmode!==!1&&b.camera.mouseListener.buttons!==0){var P=C();b.graphDiv.emit("plotly_relayouting",P)}}),b.staticMode||b.glplot.canvas.addEventListener("webglcontextlost",function(P){L&&L.emit&&L.emit("plotly_webglcontextlost",{event:P,layer:b.id})},!1)),b.glplot.oncontextloss=function(){b.recoverContext()},b.glplot.onrender=function(){b.render()},!0},_.render=function(){var b,L=this,w=L.graphDiv,C=L.svgContainer,S=L.container.getBoundingClientRect();w._fullLayout._calcInverseTransform(w);var P=w._fullLayout._invScaleX,z=w._fullLayout._invScaleY,F=S.width*P,q=S.height*z;C.setAttributeNS(null,"viewBox","0 0 "+F+" "+q),C.setAttributeNS(null,"width",F),C.setAttributeNS(null,"height",q),v(L),L.glplot.axes.update(L.axesOptions);for(var W,X=Object.keys(L.traces),Q=null,Z=L.glplot.selection,Y=0;Y<X.length;++Y)(b=L.traces[X[Y]]).data.hoverinfo!=="skip"&&b.handlePick(Z)&&(Q=b),b.setContourLevels&&b.setContourLevels();function N(se,de,ce){var ve=L.fullSceneLayout[se+"axis"];return ve.type!=="log"&&(de=ve.d2l(de)),r.hoverLabelText(ve,de,ce)}if(Q!==null){var J=g(L.glplot.cameraParams,Z.dataCoordinate);b=Q.data;var D,U=w._fullData[b.index],G=Z.index,$={xLabel:N("x",Z.traceCoordinate[0],b.xhoverformat),yLabel:N("y",Z.traceCoordinate[1],b.yhoverformat),zLabel:N("z",Z.traceCoordinate[2],b.zhoverformat)},K=c.castHoverinfo(U,L.fullLayout,G),re=(K||"").split("+"),ne=K&&K==="all";U.hovertemplate||ne||(re.indexOf("x")===-1&&($.xLabel=void 0),re.indexOf("y")===-1&&($.yLabel=void 0),re.indexOf("z")===-1&&($.zLabel=void 0),re.indexOf("text")===-1&&(Z.textLabel=void 0),re.indexOf("name")===-1&&(Q.name=void 0));var ae=[];b.type==="cone"||b.type==="streamtube"?($.uLabel=N("x",Z.traceCoordinate[3],b.uhoverformat),(ne||re.indexOf("u")!==-1)&&ae.push("u: "+$.uLabel),$.vLabel=N("y",Z.traceCoordinate[4],b.vhoverformat),(ne||re.indexOf("v")!==-1)&&ae.push("v: "+$.vLabel),$.wLabel=N("z",Z.traceCoordinate[5],b.whoverformat),(ne||re.indexOf("w")!==-1)&&ae.push("w: "+$.wLabel),$.normLabel=Z.traceCoordinate[6].toPrecision(3),(ne||re.indexOf("norm")!==-1)&&ae.push("norm: "+$.normLabel),b.type==="streamtube"&&($.divergenceLabel=Z.traceCoordinate[7].toPrecision(3),(ne||re.indexOf("divergence")!==-1)&&ae.push("divergence: "+$.divergenceLabel)),Z.textLabel&&ae.push(Z.textLabel),D=ae.join("<br>")):b.type==="isosurface"||b.type==="volume"?($.valueLabel=r.hoverLabelText(L._mockAxis,L._mockAxis.d2l(Z.traceCoordinate[3]),b.valuehoverformat),ae.push("value: "+$.valueLabel),Z.textLabel&&ae.push(Z.textLabel),D=ae.join("<br>")):D=Z.textLabel;var ie={x:Z.traceCoordinate[0],y:Z.traceCoordinate[1],z:Z.traceCoordinate[2],data:U._input,fullData:U,curveNumber:U.index,pointNumber:G};c.appendArrayPointValue(ie,U,G),b._module.eventData&&(ie=U._module.eventData(ie,Z,U,{},G));var he={points:[ie]};L.fullSceneLayout.hovermode&&c.loneHover({trace:U,x:(.5+.5*J[0]/J[3])*F,y:(.5-.5*J[1]/J[3])*q,xLabel:$.xLabel,yLabel:$.yLabel,zLabel:$.zLabel,text:D,name:Q.name,color:c.castHoverOption(U,G,"bgcolor")||Q.color,borderColor:c.castHoverOption(U,G,"bordercolor"),fontFamily:c.castHoverOption(U,G,"font.family"),fontSize:c.castHoverOption(U,G,"font.size"),fontColor:c.castHoverOption(U,G,"font.color"),nameLength:c.castHoverOption(U,G,"namelength"),textAlign:c.castHoverOption(U,G,"align"),hovertemplate:n.castOption(U,G,"hovertemplate"),hovertemplateLabels:n.extendFlat({},ie,$),eventData:[ie]},{container:C,gd:w}),Z.buttons&&Z.distance<5?w.emit("plotly_click",he):w.emit("plotly_hover",he),W=he}else c.loneUnhover(C),w.emit("plotly_unhover",W);L.drawAnnotations(L)},_.recoverContext=function(){var b=this;b.glplot.dispose();var L=function(){b.glplot.gl.isContextLost()?requestAnimationFrame(L):b.initializeGLPlot()?b.plot.apply(b,b.plotArgs):n.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(L)};var E=["xaxis","yaxis","zaxis"];function A(b,L,w){for(var C=b.fullSceneLayout,S=0;S<3;S++){var P=E[S],z=P.charAt(0),F=C[P],q=L[z],W=L[z+"calendar"],X=L["_"+z+"length"];if(n.isArrayOrTypedArray(q))for(var Q,Z=0;Z<(X||q.length);Z++)if(n.isArrayOrTypedArray(q[Z]))for(var Y=0;Y<q[Z].length;++Y)Q=F.d2l(q[Z][Y],0,W),!isNaN(Q)&&isFinite(Q)&&(w[0][S]=Math.min(w[0][S],Q),w[1][S]=Math.max(w[1][S],Q));else Q=F.d2l(q[Z],0,W),!isNaN(Q)&&isFinite(Q)&&(w[0][S]=Math.min(w[0][S],Q),w[1][S]=Math.max(w[1][S],Q));else w[0][S]=Math.min(w[0][S],0),w[1][S]=Math.max(w[1][S],X-1)}}_.plot=function(b,L,w){if(this.plotArgs=[b,L,w],!this.glplot.contextLost){var C,S,P,z,F,q,W=L[this.id],X=w[this.id];this.fullLayout=L,this.fullSceneLayout=W,this.axesOptions.merge(L,W),this.spikeOptions.merge(W),this.setViewport(W),this.updateFx(W.dragmode,W.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(f(W.bgcolor)),this.setConvert(F),b?Array.isArray(b)||(b=[b]):b=[];var Q=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(P=0;P<b.length;++P)(C=b[P]).visible===!0&&C._length!==0&&A(this,C,Q);(function(ke,Me){for(var Se=ke.fullSceneLayout,De=Se.annotations||[],Be=0;Be<3;Be++)for(var We=E[Be],Qe=We.charAt(0),Oe=Se[We],Ue=0;Ue<De.length;Ue++){var Xe=De[Ue];if(Xe.visible){var Ye=Oe.r2l(Xe[Qe]);!isNaN(Ye)&&isFinite(Ye)&&(Me[0][Be]=Math.min(Me[0][Be],Ye),Me[1][Be]=Math.max(Me[1][Be],Ye))}}})(this,Q);var Z=[1,1,1];for(z=0;z<3;++z)Q[1][z]===Q[0][z]?Z[z]=1:Z[z]=1/(Q[1][z]-Q[0][z]);for(this.dataScale=Z,this.convertAnnotations(this),P=0;P<b.length;++P)(C=b[P]).visible===!0&&C._length!==0&&((S=this.traces[C.uid])?S.data.type===C.type?S.update(C):(S.dispose(),S=C._module.plot(this,C),this.traces[C.uid]=S):(S=C._module.plot(this,C),this.traces[C.uid]=S),S.name=C.name);var Y=Object.keys(this.traces);e:for(P=0;P<Y.length;++P){for(z=0;z<b.length;++z)if(b[z].uid===Y[P]&&b[z].visible===!0&&b[z]._length!==0)continue e;(S=this.traces[Y[P]]).dispose(),delete this.traces[Y[P]]}this.glplot.objects.sort(function(ke,Me){return ke._trace.data.index-Me._trace.data.index});var N,J=[[0,0,0],[0,0,0]],D=[],U={};for(P=0;P<3;++P){if((q=(F=W[E[P]]).type)in U?(U[q].acc*=Z[P],U[q].count+=1):U[q]={acc:Z[P],count:1},F.autorange){J[0][P]=1/0,J[1][P]=-1/0;var G=this.glplot.objects,$=this.fullSceneLayout.annotations||[],K=F._name.charAt(0);for(z=0;z<G.length;z++){var re=G[z],ne=re.bounds,ae=re._trace.data._pad||0;re.constructor.name==="ErrorBars"&&F._lowerLogErrorBound?J[0][P]=Math.min(J[0][P],F._lowerLogErrorBound):J[0][P]=Math.min(J[0][P],ne[0][P]/Z[P]-ae),J[1][P]=Math.max(J[1][P],ne[1][P]/Z[P]+ae)}for(z=0;z<$.length;z++){var ie=$[z];if(ie.visible){var he=F.r2l(ie[K]);J[0][P]=Math.min(J[0][P],he),J[1][P]=Math.max(J[1][P],he)}}if("rangemode"in F&&F.rangemode==="tozero"&&(J[0][P]=Math.min(J[0][P],0),J[1][P]=Math.max(J[1][P],0)),J[0][P]>J[1][P])J[0][P]=-1,J[1][P]=1;else{var se=J[1][P]-J[0][P];J[0][P]-=se/32,J[1][P]+=se/32}if(F.autorange==="reversed"){var de=J[0][P];J[0][P]=J[1][P],J[1][P]=de}}else{var ce=F.range;J[0][P]=F.r2l(ce[0]),J[1][P]=F.r2l(ce[1])}J[0][P]===J[1][P]&&(J[0][P]-=1,J[1][P]+=1),D[P]=J[1][P]-J[0][P],this.glplot.setBounds(P,{min:J[0][P]*Z[P],max:J[1][P]*Z[P]})}var ve=W.aspectmode;if(ve==="cube")N=[1,1,1];else if(ve==="manual"){var Ee=W.aspectratio;N=[Ee.x,Ee.y,Ee.z]}else{if(ve!=="auto"&&ve!=="data")throw new Error("scene.js aspectRatio was not one of the enumerated types");var Le=[1,1,1];for(P=0;P<3;++P){var Te=U[q=(F=W[E[P]]).type];Le[P]=Math.pow(Te.acc,1/Te.count)/Z[P]}N=ve==="data"||Math.max.apply(null,Le)/Math.min.apply(null,Le)<=4?Le:[1,1,1]}W.aspectratio.x=X.aspectratio.x=N[0],W.aspectratio.y=X.aspectratio.y=N[1],W.aspectratio.z=X.aspectratio.z=N[2],this.glplot.setAspectratio(W.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:W.aspectratio.x,y:W.aspectratio.y,z:W.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=W.aspectmode);var xe=W.domain||null,fe=L._size||null;if(xe&&fe){var ge=this.container.style;ge.position="absolute",ge.left=fe.l+xe.x[0]*fe.w+"px",ge.top=fe.t+(1-xe.y[1])*fe.h+"px",ge.width=fe.w*(xe.x[1]-xe.x[0])+"px",ge.height=fe.h*(xe.y[1]-xe.y[0])+"px"}this.glplot.redraw()}},_.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},_.getCamera=function(){var b;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(b=this.camera).up[0],y:b.up[1],z:b.up[2]},center:{x:b.center[0],y:b.center[1],z:b.center[2]},eye:{x:b.eye[0],y:b.eye[1],z:b.eye[2]},projection:{type:b._ortho===!0?"orthographic":"perspective"}}},_.setViewport=function(b){var L,w=b.camera;this.camera.lookAt.apply(this,[[(L=w).eye.x,L.eye.y,L.eye.z],[L.center.x,L.center.y,L.center.z],[L.up.x,L.up.y,L.up.z]]),this.glplot.setAspectratio(b.aspectratio),w.projection.type==="orthographic"!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},_.isCameraChanged=function(b){var L=this.getCamera(),w=n.nestedProperty(b,this.id+".camera").get();function C(F,q,W,X){var Q=["up","center","eye"],Z=["x","y","z"];return q[Q[W]]&&F[Q[W]][Z[X]]===q[Q[W]][Z[X]]}var S=!1;if(w===void 0)S=!0;else{for(var P=0;P<3;P++)for(var z=0;z<3;z++)if(!C(L,w,P,z)){S=!0;break}(!w.projection||L.projection&&L.projection.type!==w.projection.type)&&(S=!0)}return S},_.isAspectChanged=function(b){var L=this.glplot.getAspectratio(),w=n.nestedProperty(b,this.id+".aspectratio").get();return w===void 0||w.x!==L.x||w.y!==L.y||w.z!==L.z},_.saveLayout=function(b){var L,w,C,S,P,z,F=this.fullLayout,q=this.isCameraChanged(b),W=this.isAspectChanged(b),X=q||W;if(X){var Q={};q&&(L=this.getCamera(),C=(w=n.nestedProperty(b,this.id+".camera")).get(),Q[this.id+".camera"]=C),W&&(S=this.glplot.getAspectratio(),z=(P=n.nestedProperty(b,this.id+".aspectratio")).get(),Q[this.id+".aspectratio"]=z),a.call("_storeDirectGUIEdit",b,F._preGUI,Q),q&&(w.set(L),n.nestedProperty(F,this.id+".camera").set(L)),W&&(P.set(S),n.nestedProperty(F,this.id+".aspectratio").set(S),this.glplot.redraw())}return X},_.updateFx=function(b,L){var w=this.camera;if(w)if(b==="orbit")w.mode="orbit",w.keyBindingMode="rotate";else if(b==="turntable"){w.up=[0,0,1],w.mode="turntable",w.keyBindingMode="rotate";var C=this.graphDiv,S=C._fullLayout,P=this.fullSceneLayout.camera,z=P.up.x,F=P.up.y,q=P.up.z;if(q/Math.sqrt(z*z+F*F+q*q)<.999){var W=this.id+".camera.up",X={x:0,y:0,z:1},Q={};Q[W]=X;var Z=C.layout;a.call("_storeDirectGUIEdit",Z,S._preGUI,Q),P.up=X,n.nestedProperty(Z,W).set(X)}}else w.keyBindingMode=b;this.fullSceneLayout.hovermode=L},_.toImage=function(b){b||(b="png"),this.staticMode&&this.container.appendChild(t),this.glplot.redraw();var L=this.glplot.gl,w=L.drawingBufferWidth,C=L.drawingBufferHeight;L.bindFramebuffer(L.FRAMEBUFFER,null);var S=new Uint8Array(w*C*4);L.readPixels(0,0,w,C,L.RGBA,L.UNSIGNED_BYTE,S),function(W,X,Q){for(var Z=0,Y=Q-1;Z<Y;++Z,--Y)for(var N=0;N<X;++N)for(var J=0;J<4;++J){var D=4*(X*Z+N)+J,U=4*(X*Y+N)+J,G=W[D];W[D]=W[U],W[U]=G}}(S,w,C),function(W,X,Q){for(var Z=0;Z<Q;++Z)for(var Y=0;Y<X;++Y){var N=4*(X*Z+Y),J=W[N+3];if(J>0)for(var D=255/J,U=0;U<3;++U)W[N+U]=Math.min(D*W[N+U],255)}}(S,w,C);var P=document.createElement("canvas");P.width=w,P.height=C;var z,F=P.getContext("2d"),q=F.createImageData(w,C);switch(q.data.set(S),F.putImageData(q,0,0),b){case"jpeg":z=P.toDataURL("image/jpeg");break;case"webp":z=P.toDataURL("image/webp");break;default:z=P.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(t),z},_.setConvert=function(){for(var b=0;b<3;b++){var L=this.fullSceneLayout[E[b]];r.setConvert(L,this.fullLayout),L.setScale=n.noop}},_.make4thDimension=function(){var b=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},r.setConvert(this._mockAxis,b)},B.exports=T},{"../../components/fx":706,"../../lib":803,"../../lib/show_no_webgl_msg":825,"../../lib/str2rgbarray":828,"../../plots/cartesian/axes":854,"../../registry":931,"./layout/convert":900,"./layout/spikes":903,"./layout/tick_marks":904,"./project":905,"gl-plot3d":326,"has-passive-events":444,"webgl-context":629}],907:[function(i,B,V){B.exports=function(t,h,p,u){u=u||t.length;for(var e=new Array(u),l=0;l<u;l++)e[l]=[t[l],h[l],p[l]];return e}},{}],908:[function(i,B,V){var t=i("./font_attributes"),h=i("./animation_attributes"),p=i("../components/color/attributes"),u=i("../components/shapes/draw_newshape/attributes"),e=i("./pad_attributes"),l=i("../lib/extend").extendFlat,o=t({editType:"calc"});o.family.dflt='"Open Sans", verdana, arial, sans-serif',o.size.dflt=12,o.color.dflt=p.defaultLine,B.exports={font:o,title:{text:{valType:"string",editType:"layoutstyle"},font:t({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:l(e({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:p.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:p.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:p.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:u.newshape,activeshape:u.activeshape,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:l({},h.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:t({editType:"layoutstyle"})}}},{"../components/color/attributes":665,"../components/shapes/draw_newshape/attributes":751,"../lib/extend":793,"./animation_attributes":848,"./font_attributes":883,"./pad_attributes":916}],909:[function(i,B,V){var t=i("../../lib/sort_object_keys"),h='© <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',p=['© <a target="_blank" href="https://carto.com/">Carto</a>',h].join(" "),u=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:h,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:p,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:p,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:u,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:u,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},l=t(e);B.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:l,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",l.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":826}],910:[function(i,B,V){var t=i("../../lib");B.exports=function(h,p){var u=h.split(" "),e=u[0],l=u[1],o=t.isArrayOrTypedArray(p)?t.mean(p):p,a=.5+o/100,n=1.5+o/100,s=["",""],r=[0,0];switch(e){case"top":s[0]="top",r[1]=-n;break;case"bottom":s[0]="bottom",r[1]=n}switch(l){case"left":s[1]="right",r[0]=-a;break;case"right":s[1]="left",r[0]=a}return{anchor:s[0]&&s[1]?s.join("-"):s[0]?s[0]:s[1]?s[1]:"center",offset:r}}},{"../../lib":803}],911:[function(i,B,V){var t=i("mapbox-gl/dist/mapbox-gl-unminified"),h=i("../../lib"),p=h.strTranslate,u=h.strScale,e=i("../../plots/get_data").getSubplotCalcData,l=i("../../constants/xmlns_namespaces"),o=i("@plotly/d3"),a=i("../../components/drawing"),n=i("../../lib/svg_text_utils"),s=i("./mapbox"),r=V.constants=i("./constants");function c(f){return typeof f=="string"&&(r.styleValuesMapbox.indexOf(f)!==-1||f.indexOf("mapbox://")===0)}V.name="mapbox",V.attr="subplot",V.idRoot="mapbox",V.idRegex=V.attrRegex=h.counterRegex("mapbox"),V.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},V.layoutAttributes=i("./layout_attributes"),V.supplyLayoutDefaults=i("./layout_defaults"),V.plot=function(f){var d=f._fullLayout,g=f.calcdata,m=d._subplots.mapbox;if(t.version!==r.requiredVersion)throw new Error(r.wrongVersionErrorMsg);var y=function(A,b){var L=A._fullLayout;if(A._context.mapboxAccessToken==="")return"";for(var w=[],C=[],S=!1,P=!1,z=0;z<b.length;z++){var F=L[b[z]],q=F.accesstoken;c(F.style)&&(q?h.pushUnique(w,q):(c(F._input.style)&&(h.error("Uses Mapbox map style, but did not set an access token."),S=!0),P=!0)),q&&h.pushUnique(C,q)}if(P){var W=S?r.noAccessTokenErrorMsg:r.missingStyleErrorMsg;throw h.error(W),new Error(W)}return w.length?(w.length>1&&h.warn(r.multipleTokensErrorMsg),w[0]):(C.length&&h.log(["Listed mapbox access token(s)",C.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(f,m);t.accessToken=y;for(var v=0;v<m.length;v++){var T=m[v],_=e(g,"mapbox",T),k=d[T],E=k._subplot;E||(E=new s(f,T),d[T]._subplot=E),E.viewInitial||(E.viewInitial={center:h.extendFlat({},k.center),zoom:k.zoom,bearing:k.bearing,pitch:k.pitch}),E.plot(_,d,f._promises)}},V.clean=function(f,d,g,m){for(var y=m._subplots.mapbox||[],v=0;v<y.length;v++){var T=y[v];!d[T]&&m[T]._subplot&&m[T]._subplot.destroy()}},V.toSVG=function(f){for(var d=f._fullLayout,g=d._subplots.mapbox,m=d._size,y=0;y<g.length;y++){var v=d[g[y]],T=v.domain,_=v._subplot.toImage("png");d._glimages.append("svg:image").attr({xmlns:l.svg,"xlink:href":_,x:m.l+m.w*T.x[0],y:m.t+m.h*(1-T.y[1]),width:m.w*(T.x[1]-T.x[0]),height:m.h*(T.y[1]-T.y[0]),preserveAspectRatio:"none"});var k=o.select(v._subplot.div);if(k.select(".mapboxgl-ctrl-logo").node().offsetParent!==null){var E=d._glimages.append("g");E.attr("transform",p(m.l+m.w*T.x[0]+10,m.t+m.h*(1-T.y[0])-31)),E.append("path").attr("d",r.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),E.append("path").attr("d",r.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),E.append("path").attr("d",r.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),E.append("polygon").attr("points",r.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var A=k.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),b=d._glimages.append("g"),L=b.append("text");L.text(A).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":A});var w=a.bBox(L.node()),C=m.w*(T.x[1]-T.x[0]);if(w.width>C/2){var S=A.split("|").join("<br>");L.text(S).attr("data-unformatted",S).call(n.convertToTspans,f),w=a.bBox(L.node())}L.attr("transform",p(-3,8-w.height)),b.insert("rect",".static-attribution").attr({x:-w.width-6,y:-w.height-3,width:w.width+6,height:w.height+3,fill:"rgba(255, 255, 255, 0.75)"});var P=1;w.width+6>C&&(P=C/(w.width+6));var z=[m.l+m.w*T.x[1],m.t+m.h*(1-T.y[0])];b.attr("transform",p(z[0],z[1])+u(P))}},V.updateFx=function(f){for(var d=f._fullLayout,g=d._subplots.mapbox,m=0;m<g.length;m++)d[g[m]]._subplot.updateFx(d)}},{"../../components/drawing":688,"../../constants/xmlns_namespaces":780,"../../lib":803,"../../lib/svg_text_utils":829,"../../plots/get_data":891,"./constants":909,"./layout_attributes":913,"./layout_defaults":914,"./mapbox":915,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":461}],912:[function(i,B,V){var t=i("../../lib"),h=i("../../lib/svg_text_utils").sanitizeHTML,p=i("./convert_text_opts"),u=i("./constants");function e(n,s){this.subplot=n,this.uid=n.uid+"-"+s,this.index=s,this.idSource="source-"+this.uid,this.idLayer=u.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var l=e.prototype;function o(n){if(!n.visible)return!1;var s=n.source;if(Array.isArray(s)&&s.length>0){for(var r=0;r<s.length;r++)if(typeof s[r]!="string"||s[r].length===0)return!1;return!0}return t.isPlainObject(s)||typeof s=="string"&&s.length>0}function a(n){var s={},r={};switch(n.type){case"circle":t.extendFlat(r,{"circle-radius":n.circle.radius,"circle-color":n.color,"circle-opacity":n.opacity});break;case"line":t.extendFlat(r,{"line-width":n.line.width,"line-color":n.color,"line-opacity":n.opacity,"line-dasharray":n.line.dash});break;case"fill":t.extendFlat(r,{"fill-color":n.color,"fill-outline-color":n.fill.outlinecolor,"fill-opacity":n.opacity});break;case"symbol":var c=n.symbol,f=p(c.textposition,c.iconsize);t.extendFlat(s,{"icon-image":c.icon+"-15","icon-size":c.iconsize/10,"text-field":c.text,"text-size":c.textfont.size,"text-anchor":f.anchor,"text-offset":f.offset,"symbol-placement":c.placement}),t.extendFlat(r,{"icon-color":n.color,"text-color":c.textfont.color,"text-opacity":n.opacity});break;case"raster":t.extendFlat(r,{"raster-fade-duration":0,"raster-opacity":n.opacity})}return{layout:s,paint:r}}l.update=function(n){this.visible?this.needsNewImage(n)?this.updateImage(n):this.needsNewSource(n)?(this.removeLayer(),this.updateSource(n),this.updateLayer(n)):this.needsNewLayer(n)?this.updateLayer(n):this.updateStyle(n):(this.updateSource(n),this.updateLayer(n)),this.visible=o(n)},l.needsNewImage=function(n){return this.subplot.map.getSource(this.idSource)&&this.sourceType==="image"&&n.sourcetype==="image"&&(this.source!==n.source||JSON.stringify(this.coordinates)!==JSON.stringify(n.coordinates))},l.needsNewSource=function(n){return this.sourceType!==n.sourcetype||JSON.stringify(this.source)!==JSON.stringify(n.source)||this.layerType!==n.type},l.needsNewLayer=function(n){return this.layerType!==n.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},l.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},l.updateImage=function(n){this.subplot.map.getSource(this.idSource).updateImage({url:n.source,coordinates:n.coordinates});var s=this.findFollowingMapboxLayerId(this.lookupBelow());s!==null&&this.subplot.map.moveLayer(this.idLayer,s)},l.updateSource=function(n){var s=this.subplot.map;if(s.getSource(this.idSource)&&s.removeSource(this.idSource),this.sourceType=n.sourcetype,this.source=n.source,o(n)){var r=function(c){var f,d=c.sourcetype,g=c.source,m={type:d};return d==="geojson"?f="data":d==="vector"?f=typeof g=="string"?"url":"tiles":d==="raster"?(f="tiles",m.tileSize=256):d==="image"&&(f="url",m.coordinates=c.coordinates),m[f]=g,c.sourceattribution&&(m.attribution=h(c.sourceattribution)),m}(n);s.addSource(this.idSource,r)}},l.findFollowingMapboxLayerId=function(n){if(n==="traces")for(var s=this.subplot.getMapLayers(),r=0;r<s.length;r++){var c=s[r].id;if(typeof c=="string"&&c.indexOf(u.traceLayerPrefix)===0){n=c;break}}return n},l.updateLayer=function(n){var s=this.subplot,r=a(n),c=this.lookupBelow(),f=this.findFollowingMapboxLayerId(c);this.removeLayer(),o(n)&&s.addLayer({id:this.idLayer,source:this.idSource,"source-layer":n.sourcelayer||"",type:n.type,minzoom:n.minzoom,maxzoom:n.maxzoom,layout:r.layout,paint:r.paint},f),this.layerType=n.type,this.below=c},l.updateStyle=function(n){if(o(n)){var s=a(n);this.subplot.setOptions(this.idLayer,"setLayoutProperty",s.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",s.paint)}},l.removeLayer=function(){var n=this.subplot.map;n.getLayer(this.idLayer)&&n.removeLayer(this.idLayer)},l.dispose=function(){var n=this.subplot.map;n.getLayer(this.idLayer)&&n.removeLayer(this.idLayer),n.getSource(this.idSource)&&n.removeSource(this.idSource)},B.exports=function(n,s,r){var c=new e(n,s);return c.update(r),c}},{"../../lib":803,"../../lib/svg_text_utils":829,"./constants":909,"./convert_text_opts":910}],913:[function(i,B,V){var t=i("../../lib"),h=i("../../components/color").defaultLine,p=i("../domain").attributes,u=i("../font_attributes"),e=i("../../traces/scatter/attributes").textposition,l=i("../../plot_api/edit_types").overrideAll,o=i("../../plot_api/plot_template").templatedArray,a=i("./constants"),n=u({});n.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(B.exports=l({_arrayAttrRegexps:[t.counterRegex("mapbox",".layers",!0)],domain:p({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:a.styleValuesMapbox.concat(a.styleValuesNonMapbox),dflt:a.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:o("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:h},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:h}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:n,textposition:t.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":666,"../../lib":803,"../../plot_api/edit_types":836,"../../plot_api/plot_template":843,"../../traces/scatter/attributes":1218,"../domain":882,"../font_attributes":883,"./constants":909}],914:[function(i,B,V){var t=i("../../lib"),h=i("../subplot_defaults"),p=i("../array_container_defaults"),u=i("./layout_attributes");function e(o,a,n,s){n("accesstoken",s.accessToken),n("style"),n("center.lon"),n("center.lat"),n("zoom"),n("bearing"),n("pitch"),p(o,a,{name:"layers",handleItemDefaults:l}),a._input=o}function l(o,a){function n(d,g){return t.coerce(o,a,u.layers,d,g)}if(n("visible")){var s,r=n("sourcetype"),c=r==="raster"||r==="image";n("source"),n("sourceattribution"),r==="vector"&&n("sourcelayer"),r==="image"&&n("coordinates"),c&&(s="raster");var f=n("type",s);c&&f!=="raster"&&(f=a.type="raster",t.log("Source types *raster* and *image* must drawn *raster* layer type.")),n("below"),n("color"),n("opacity"),n("minzoom"),n("maxzoom"),f==="circle"&&n("circle.radius"),f==="line"&&(n("line.width"),n("line.dash")),f==="fill"&&n("fill.outlinecolor"),f==="symbol"&&(n("symbol.icon"),n("symbol.iconsize"),n("symbol.text"),t.coerceFont(n,"symbol.textfont"),n("symbol.textposition"),n("symbol.placement"))}}B.exports=function(o,a,n){h(o,a,n,{type:"mapbox",attributes:u,handleDefaults:e,partition:"y",accessToken:a._mapboxAccessToken})}},{"../../lib":803,"../array_container_defaults":849,"../subplot_defaults":925,"./layout_attributes":913}],915:[function(i,B,V){var t=i("mapbox-gl/dist/mapbox-gl-unminified"),h=i("../../lib"),p=i("../../lib/geo_location_utils"),u=i("../../registry"),e=i("../cartesian/axes"),l=i("../../components/dragelement"),o=i("../../components/fx"),a=i("../../components/dragelement/helpers"),n=a.rectMode,s=a.drawMode,r=a.selectMode,c=i("../cartesian/select").prepSelect,f=i("../cartesian/select").clearSelect,d=i("../cartesian/select").clearSelectionsCache,g=i("../cartesian/select").selectOnClick,m=i("./constants"),y=i("./layers");function v(b,L){this.id=L,this.gd=b;var w=b._fullLayout,C=b._context;this.container=w._glcontainer.node(),this.isStatic=C.staticPlot,this.uid=w._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(w),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var T=v.prototype;T.plot=function(b,L,w){var C,S=this,P=L[S.id];S.map&&P.accesstoken!==S.accessToken&&(S.map.remove(),S.map=null,S.styleObj=null,S.traceHash={},S.layerList=[]),C=S.map?new Promise(function(z,F){S.updateMap(b,L,z,F)}):new Promise(function(z,F){S.createMap(b,L,z,F)}),w.push(C)},T.createMap=function(b,L,w,C){var S=this,P=L[S.id],z=S.styleObj=k(P.style);S.accessToken=P.accesstoken;var F=S.map=new t.Map({container:S.div,style:z.style,center:A(P.center),zoom:P.zoom,bearing:P.bearing,pitch:P.pitch,interactive:!S.isStatic,preserveDrawingBuffer:S.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new t.AttributionControl({compact:!0}));F._canvas.style.left="0px",F._canvas.style.top="0px",S.rejectOnError(C),S.isStatic||S.initFx(b,L);var q=[];q.push(new Promise(function(W){F.once("load",W)})),q=q.concat(p.fetchTraceGeoData(b)),Promise.all(q).then(function(){S.fillBelowLookup(b,L),S.updateData(b),S.updateLayout(L),S.resolveOnRender(w)}).catch(C)},T.updateMap=function(b,L,w,C){var S=this,P=S.map,z=L[this.id];S.rejectOnError(C);var F=[],q=k(z.style);JSON.stringify(S.styleObj)!==JSON.stringify(q)&&(S.styleObj=q,P.setStyle(q.style),S.traceHash={},F.push(new Promise(function(W){P.once("styledata",W)}))),F=F.concat(p.fetchTraceGeoData(b)),Promise.all(F).then(function(){S.fillBelowLookup(b,L),S.updateData(b),S.updateLayout(L),S.resolveOnRender(w)}).catch(C)},T.fillBelowLookup=function(b,L){var w,C,S=L[this.id].layers,P=this.belowLookup={},z=!1;for(w=0;w<b.length;w++){var F=b[w][0].trace,q=F._module;typeof F.below=="string"?C=F.below:q.getBelow&&(C=q.getBelow(F,this)),C===""&&(z=!0),P["trace-"+F.uid]=C||""}for(w=0;w<S.length;w++){var W=S[w];C=typeof W.below=="string"?W.below:z?"traces":"",P["layout-"+w]=C}var X,Q,Z={};for(X in P)Z[C=P[X]]?Z[C].push(X):Z[C]=[X];for(C in Z){var Y=Z[C];if(Y.length>1)for(w=0;w<Y.length;w++)(X=Y[w]).indexOf("trace-")===0?(Q=X.split("trace-")[1],this.traceHash[Q]&&(this.traceHash[Q].below=null)):X.indexOf("layout-")===0&&(Q=X.split("layout-")[1],this.layerList[Q]&&(this.layerList[Q].below=null))}};var _={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function k(b){var L={};return h.isPlainObject(b)?(L.id=b.id,L.style=b):typeof b=="string"?(L.id=b,m.styleValuesMapbox.indexOf(b)!==-1?L.style=E(b):m.stylesNonMapbox[b]?L.style=m.stylesNonMapbox[b]:L.style=b):(L.id=m.styleValueDflt,L.style=E(m.styleValueDflt)),L.transition={duration:0,delay:0},L}function E(b){return m.styleUrlPrefix+b+"-"+m.styleUrlSuffix}function A(b){return[b.lon,b.lat]}T.updateData=function(b){var L,w,C,S,P=this.traceHash,z=b.slice().sort(function(Q,Z){return _[Q[0].trace.type]-_[Z[0].trace.type]});for(C=0;C<z.length;C++){var F=z[C],q=!1;(L=P[(w=F[0].trace).uid])&&(L.type===w.type?(L.update(F),q=!0):L.dispose()),!q&&w._module&&(P[w.uid]=w._module.plot(this,F))}var W=Object.keys(P);e:for(C=0;C<W.length;C++){var X=W[C];for(S=0;S<b.length;S++)if(X===(w=b[S][0].trace).uid)continue e;(L=P[X]).dispose(),delete P[X]}},T.updateLayout=function(b){var L=this.map,w=b[this.id];this.dragging||this.wheeling||(L.setCenter(A(w.center)),L.setZoom(w.zoom),L.setBearing(w.bearing),L.setPitch(w.pitch)),this.updateLayers(b),this.updateFramework(b),this.updateFx(b),this.map.resize(),this.gd._context._scrollZoom.mapbox?L.scrollZoom.enable():L.scrollZoom.disable()},T.resolveOnRender=function(b){var L=this.map;L.on("render",function w(){L.loaded()&&(L.off("render",w),setTimeout(b,10))})},T.rejectOnError=function(b){var L=this.map;function w(){b(new Error(m.mapOnErrorMsg))}L.once("error",w),L.once("style.error",w),L.once("source.error",w),L.once("tile.error",w),L.once("layer.error",w)},T.createFramework=function(b){var L=this,w=L.div=document.createElement("div");w.id=L.uid,w.style.position="absolute",L.container.appendChild(w),L.xaxis={_id:"x",c2p:function(C){return L.project(C).x}},L.yaxis={_id:"y",c2p:function(C){return L.project(C).y}},L.updateFramework(b),L.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(L.mockAxis,b)},T.initFx=function(b,L){var w=this,C=w.gd,S=w.map;function P(){o.loneUnhover(L._hoverlayer)}function z(){var F=w.getView();C.emit("plotly_relayouting",w.getViewEditsWithDerived(F))}S.on("moveend",function(F){if(w.map){var q=C._fullLayout;if(F.originalEvent||w.wheeling){var W=q[w.id];u.call("_storeDirectGUIEdit",C.layout,q._preGUI,w.getViewEdits(W));var X=w.getView();W._input.center=W.center=X.center,W._input.zoom=W.zoom=X.zoom,W._input.bearing=W.bearing=X.bearing,W._input.pitch=W.pitch=X.pitch,C.emit("plotly_relayout",w.getViewEditsWithDerived(X))}F.originalEvent&&F.originalEvent.type==="mouseup"?w.dragging=!1:w.wheeling&&(w.wheeling=!1),q._rehover&&q._rehover()}}),S.on("wheel",function(){w.wheeling=!0}),S.on("mousemove",function(F){var q=w.div.getBoundingClientRect(),W=[F.originalEvent.offsetX,F.originalEvent.offsetY];F.target.getBoundingClientRect=function(){return q},w.xaxis.p2c=function(){return S.unproject(W).lng},w.yaxis.p2c=function(){return S.unproject(W).lat},C._fullLayout._rehover=function(){C._fullLayout._hoversubplot===w.id&&C._fullLayout[w.id]&&o.hover(C,F,w.id)},o.hover(C,F,w.id),C._fullLayout._hoversubplot=w.id}),S.on("dragstart",function(){w.dragging=!0,P()}),S.on("zoomstart",P),S.on("mouseout",function(){C._fullLayout._hoversubplot=null}),S.on("drag",z),S.on("zoom",z),S.on("dblclick",function(){var F=C._fullLayout[w.id];u.call("_storeDirectGUIEdit",C.layout,C._fullLayout._preGUI,w.getViewEdits(F));var q=w.viewInitial;S.setCenter(A(q.center)),S.setZoom(q.zoom),S.setBearing(q.bearing),S.setPitch(q.pitch);var W=w.getView();F._input.center=F.center=W.center,F._input.zoom=F.zoom=W.zoom,F._input.bearing=F.bearing=W.bearing,F._input.pitch=F.pitch=W.pitch,C.emit("plotly_doubleclick",null),C.emit("plotly_relayout",w.getViewEditsWithDerived(W))}),w.clearSelect=function(){d(w.dragOptions),f(w.dragOptions.gd)},w.onClickInPanFn=function(F){return function(q){var W=C._fullLayout.clickmode;W.indexOf("select")>-1&&g(q.originalEvent,C,[w.xaxis],[w.yaxis],w.id,F),W.indexOf("event")>-1&&o.click(C,q.originalEvent)}}},T.updateFx=function(b){var L=this,w=L.map,C=L.gd;if(!L.isStatic){var S,P=b.dragmode;S=n(P)?function(q,W){(q.range={})[L.id]=[F([W.xmin,W.ymin]),F([W.xmax,W.ymax])]}:function(q,W,X){(q.lassoPoints={})[L.id]=X.filtered.map(F)};var z=L.dragOptions;L.dragOptions=h.extendDeep(z||{},{dragmode:b.dragmode,element:L.div,gd:C,plotinfo:{id:L.id,domain:b[L.id].domain,xaxis:L.xaxis,yaxis:L.yaxis,fillRangeItems:S},xaxes:[L.xaxis],yaxes:[L.yaxis],subplot:L.id}),w.off("click",L.onClickInPanHandler),r(P)||s(P)?(w.dragPan.disable(),w.on("zoomstart",L.clearSelect),L.dragOptions.prepFn=function(q,W,X){c(q,W,X,L.dragOptions,P)},l.init(L.dragOptions)):(w.dragPan.enable(),w.off("zoomstart",L.clearSelect),L.div.onmousedown=null,L.onClickInPanHandler=L.onClickInPanFn(L.dragOptions),w.on("click",L.onClickInPanHandler))}function F(q){var W=L.map.unproject(q);return[W.lng,W.lat]}},T.updateFramework=function(b){var L=b[this.id].domain,w=b._size,C=this.div.style;C.width=w.w*(L.x[1]-L.x[0])+"px",C.height=w.h*(L.y[1]-L.y[0])+"px",C.left=w.l+L.x[0]*w.w+"px",C.top=w.t+(1-L.y[1])*w.h+"px",this.xaxis._offset=w.l+L.x[0]*w.w,this.xaxis._length=w.w*(L.x[1]-L.x[0]),this.yaxis._offset=w.t+(1-L.y[1])*w.h,this.yaxis._length=w.h*(L.y[1]-L.y[0])},T.updateLayers=function(b){var L,w=b[this.id].layers,C=this.layerList;if(w.length!==C.length){for(L=0;L<C.length;L++)C[L].dispose();for(C=this.layerList=[],L=0;L<w.length;L++)C.push(y(this,L,w[L]))}else for(L=0;L<w.length;L++)C[L].update(w[L])},T.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},T.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},T.setOptions=function(b,L,w){for(var C in w)this.map[L](b,C,w[C])},T.getMapLayers=function(){return this.map.getStyle().layers},T.addLayer=function(b,L){var w=this.map;if(typeof L=="string"){if(L==="")return void w.addLayer(b,L);for(var C=this.getMapLayers(),S=0;S<C.length;S++)if(L===C[S].id)return void w.addLayer(b,L);h.warn(["Trying to add layer with *below* value",L,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}w.addLayer(b)},T.project=function(b){return this.map.project(new t.LngLat(b[0],b[1]))},T.getView=function(){var b=this.map,L=b.getCenter(),w={lon:L.lng,lat:L.lat},C=b.getCanvas(),S=C.width,P=C.height;return{center:w,zoom:b.getZoom(),bearing:b.getBearing(),pitch:b.getPitch(),_derived:{coordinates:[b.unproject([0,0]).toArray(),b.unproject([S,0]).toArray(),b.unproject([S,P]).toArray(),b.unproject([0,P]).toArray()]}}},T.getViewEdits=function(b){for(var L=this.id,w=["center","zoom","bearing","pitch"],C={},S=0;S<w.length;S++){var P=w[S];C[L+"."+P]=b[P]}return C},T.getViewEditsWithDerived=function(b){var L=this.id,w=this.getViewEdits(b);return w[L+"._derived"]=b._derived,w},B.exports=v},{"../../components/dragelement":685,"../../components/dragelement/helpers":684,"../../components/fx":706,"../../lib":803,"../../lib/geo_location_utils":796,"../../registry":931,"../cartesian/axes":854,"../cartesian/select":874,"./constants":909,"./layers":912,"mapbox-gl/dist/mapbox-gl-unminified":461}],916:[function(i,B,V){B.exports=function(t){var h=t.editType;return{t:{valType:"number",dflt:0,editType:h},r:{valType:"number",dflt:0,editType:h},b:{valType:"number",dflt:0,editType:h},l:{valType:"number",dflt:0,editType:h},editType:h}}},{}],917:[function(i,B,V){var t=i("@plotly/d3"),h=i("d3-time-format").timeFormatLocale,p=i("d3-format").formatLocale,u=i("fast-isnumeric"),e=i("../registry"),l=i("../plot_api/plot_schema"),o=i("../plot_api/plot_template"),a=i("../lib"),n=i("../components/color"),s=i("../constants/numerical").BADNUM,r=i("./cartesian/axis_ids"),c=i("./cartesian/handle_outline").clearSelect,f=i("./animation_attributes"),d=i("./frame_attributes"),g=i("../plots/get_data").getModuleCalcData,m=a.relinkPrivateKeys,y=a._,v=B.exports={};a.extendFlat(v,e),v.attributes=i("./attributes"),v.attributes.type.values=v.allTypes,v.fontAttrs=i("./font_attributes"),v.layoutAttributes=i("./layout_attributes"),v.fontWeight="normal";var T=v.transformsRegistry,_=i("./command");v.executeAPICommand=_.executeAPICommand,v.computeAPICommandBindings=_.computeAPICommandBindings,v.manageCommandObserver=_.manageCommandObserver,v.hasSimpleAPICommandBindings=_.hasSimpleAPICommandBindings,v.redrawText=function(X){return X=a.getGraphDiv(X),new Promise(function(Q){setTimeout(function(){X._fullLayout&&(e.getComponentMethod("annotations","draw")(X),e.getComponentMethod("legend","draw")(X),e.getComponentMethod("colorbar","draw")(X),Q(v.previousPromises(X)))},300)})},v.resize=function(X){var Q;X=a.getGraphDiv(X);var Z=new Promise(function(Y,N){X&&!a.isHidden(X)||N(new Error("Resize must be passed a displayed plot div element.")),X._redrawTimer&&clearTimeout(X._redrawTimer),X._resolveResize&&(Q=X._resolveResize),X._resolveResize=Y,X._redrawTimer=setTimeout(function(){if(!X.layout||X.layout.width&&X.layout.height||a.isHidden(X))Y(X);else{delete X.layout.width,delete X.layout.height;var J=X.changed;X.autoplay=!0,e.call("relayout",X,{autosize:!0}).then(function(){X.changed=J,X._resolveResize===Y&&(delete X._resolveResize,Y(X))})}},100)});return Q&&Q(Z),Z},v.previousPromises=function(X){if((X._promises||[]).length)return Promise.all(X._promises).then(function(){X._promises=[]})},v.addLinks=function(X){if(X._context.showLink||X._context.showSources){var Q=X._fullLayout,Z=a.ensureSingle(Q._paper,"text","js-plot-link-container",function(G){G.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:n.defaultLine,"pointer-events":"all"}).each(function(){var $=t.select(this);$.append("tspan").classed("js-link-to-tool",!0),$.append("tspan").classed("js-link-spacer",!0),$.append("tspan").classed("js-sourcelinks",!0)})}),Y=Z.node(),N={y:Q._paper.attr("height")-9};document.body.contains(Y)&&Y.getComputedTextLength()>=Q.width-20?(N["text-anchor"]="start",N.x=5):(N["text-anchor"]="end",N.x=Q._paper.attr("width")-7),Z.attr(N);var J=Z.select(".js-link-to-tool"),D=Z.select(".js-link-spacer"),U=Z.select(".js-sourcelinks");X._context.showSources&&X._context.showSources(X),X._context.showLink&&function(G,$){$.text("");var K=$.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(G._context.linkText+" "+String.fromCharCode(187));if(G._context.sendData)K.on("click",function(){v.sendDataToCloud(G)});else{var re=window.location.pathname.split("/"),ne=window.location.search;K.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+re[2].split(".")[0]+"/"+re[1]+ne})}}(X,J),D.text(J.text()&&U.text()?" - ":"")}},v.sendDataToCloud=function(X){var Q=(window.PLOTLYENV||{}).BASE_URL||X._context.plotlyServerURL;if(Q){X.emit("plotly_beforeexport");var Z=t.select(X).append("div").attr("id","hiddenform").style("display","none"),Y=Z.append("form").attr({action:Q+"/external",method:"post",target:"_blank"});return Y.append("input").attr({type:"text",name:"data"}).node().value=v.graphJson(X,!1,"keepdata"),Y.node().submit(),Z.remove(),X.emit("plotly_afterexport"),!1}};var k=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],E=["year","month","dayMonth","dayMonthYear"];function A(X,Q){var Z=X._context.locale;Z||(Z="en-US");var Y=!1,N={};function J(re){for(var ne=!0,ae=0;ae<Q.length;ae++){var ie=Q[ae];N[ie]||(re[ie]?N[ie]=re[ie]:ne=!1)}ne&&(Y=!0)}for(var D=0;D<2;D++){for(var U=X._context.locales,G=0;G<2;G++){var $=(U[Z]||{}).format;if($&&(J($),Y))break;U=e.localeRegistry}var K=Z.split("-")[0];if(Y||K===Z)break;Z=K}return Y||J(e.localeRegistry.en.format),N}function b(X,Q){var Z={_fullLayout:Q},Y=X._id.charAt(0)==="x",N=X._mainAxis._anchorAxis,J="",D="",U="";if(N&&(U=N._mainAxis._id,J=Y?X._id+U:U+X._id),!J||!Q._plots[J]){J="";for(var G=X._counterAxes,$=0;$<G.length;$++){var K=G[$],re=Y?X._id+K:K+X._id;D||(D=re);var ne=r.getFromId(Z,K);if(U&&ne.overlaying===U){J=re;break}}}return J||D}function L(X){var Q=X.transforms;if(Array.isArray(Q)&&Q.length)for(var Z=0;Z<Q.length;Z++){var Y=Q[Z],N=Y._module||T[Y.type];if(N&&N.makesData)return!0}return!1}function w(X,Q,Z,Y){for(var N=X.transforms,J=[X],D=0;D<N.length;D++){var U=N[D],G=T[U.type];G&&G.transform&&(J=G.transform(J,{transform:U,fullTrace:X,fullData:Q,layout:Z,fullLayout:Y,transformIndex:D}))}return J}function C(X){return typeof X=="string"&&X.substr(X.length-2)==="px"&&parseFloat(X)}function S(X){var Q=X.margin;if(!X._size){var Z=X._size={l:Math.round(Q.l),r:Math.round(Q.r),t:Math.round(Q.t),b:Math.round(Q.b),p:Math.round(Q.pad)};Z.w=Math.round(X.width)-Z.l-Z.r,Z.h=Math.round(X.height)-Z.t-Z.b}X._pushmargin||(X._pushmargin={}),X._pushmarginIds||(X._pushmarginIds={})}v.supplyDefaults=function(X,Q){var Z=Q&&Q.skipUpdateCalc,Y=X._fullLayout||{};if(Y._skipDefaults)delete Y._skipDefaults;else{var N,J=X._fullLayout={},D=X.layout||{},U=X._fullData||[],G=X._fullData=[],$=X.data||[],K=X.calcdata||[],re=X._context||{};X._transitionData||v.createTransitionData(X),J._dfltTitle={plot:y(X,"Click to enter Plot title"),x:y(X,"Click to enter X axis title"),y:y(X,"Click to enter Y axis title"),colorbar:y(X,"Click to enter Colorscale title"),annotation:y(X,"new text")},J._traceWord=y(X,"trace");var ne=A(X,k);if(J._mapboxAccessToken=re.mapboxAccessToken,Y._initialAutoSizeIsDone){var ae=Y.width,ie=Y.height;v.supplyLayoutGlobalDefaults(D,J,ne),D.width||(J.width=ae),D.height||(J.height=ie),v.sanitizeMargins(J)}else{v.supplyLayoutGlobalDefaults(D,J,ne);var he=!D.width||!D.height,se=J.autosize,de=re.autosizable;he&&(se||de)?v.plotAutoSize(X,D,J):he&&v.sanitizeMargins(J),!se&&he&&(D.width=J.width,D.height=J.height)}J._d3locale=function(Ue,Xe){return Ue.decimal=Xe.charAt(0),Ue.thousands=Xe.charAt(1),{numberFormat:function(Ye){try{Ye=p(Ue).format(a.adjustFormat(Ye))}catch{return a.warnBadFormat(Ye),a.noFormat}return Ye},timeFormat:h(Ue).utcFormat}}(ne,J.separators),J._extraFormat=A(X,E),J._initialAutoSizeIsDone=!0,J._dataLength=$.length,J._modules=[],J._visibleModules=[],J._basePlotModules=[];var ce=J._subplots=function(){var Ue,Xe,Ye=e.collectableSubplotTypes,$e={};if(!Ye){Ye=[];var it=e.subplotsRegistry;for(var ot in it){var Et=it[ot].attr;if(Et&&(Ye.push(ot),Array.isArray(Et)))for(Xe=0;Xe<Et.length;Xe++)a.pushUnique(Ye,Et[Xe])}}for(Ue=0;Ue<Ye.length;Ue++)$e[Ye[Ue]]=[];return $e}(),ve=J._splomAxes={x:{},y:{}},Ee=J._splomSubplots={};J._splomGridDflt={},J._scatterStackOpts={},J._firstScatter={},J._alignmentOpts={},J._colorAxes={},J._requestRangeslider={},J._traceUids=function(Ue,Xe){var Ye,$e,it=Xe.length,ot=[];for(Ye=0;Ye<Ue.length;Ye++){var Et=Ue[Ye]._fullInput;Et!==$e&&ot.push(Et),$e=Et}var mt=ot.length,tt=new Array(it),Ke={};function Mt(je,Ge){tt[Ge]=je,Ke[je]=1}function Jt(je,Ge){if(je&&typeof je=="string"&&!Ke[je])return Mt(je,Ge),!0}for(Ye=0;Ye<it;Ye++){var $t=Xe[Ye].uid;typeof $t=="number"&&($t=String($t)),Jt($t,Ye)||Ye<mt&&Jt(ot[Ye].uid,Ye)||Mt(a.randstr(Ke),Ye)}return tt}(U,$),J._globalTransforms=(X._context||{}).globalTransforms,v.supplyDataDefaults($,G,D,J);var Le=Object.keys(ve.x),Te=Object.keys(ve.y);if(Le.length>1&&Te.length>1){for(e.getComponentMethod("grid","sizeDefaults")(D,J),N=0;N<Le.length;N++)a.pushUnique(ce.xaxis,Le[N]);for(N=0;N<Te.length;N++)a.pushUnique(ce.yaxis,Te[N]);for(var xe in Ee)a.pushUnique(ce.cartesian,xe)}if(J._has=v._hasPlotType.bind(J),U.length===G.length)for(N=0;N<G.length;N++)m(G[N],U[N]);v.supplyLayoutModuleDefaults(D,J,G,X._transitionData);var fe=J._visibleModules,ge=[];for(N=0;N<fe.length;N++){var ke=fe[N].crossTraceDefaults;ke&&a.pushUnique(ge,ke)}for(N=0;N<ge.length;N++)ge[N](G,J);J._hasOnlyLargeSploms=J._basePlotModules.length===1&&J._basePlotModules[0].name==="splom"&&Le.length>15&&Te.length>15&&J.shapes.length===0&&J.images.length===0,v.linkSubplots(G,J,U,Y),v.cleanPlot(G,J,U,Y);var Me=!(!Y._has||!Y._has("gl2d")),Se=!(!J._has||!J._has("gl2d")),De=!(!Y._has||!Y._has("cartesian"))||Me,Be=!(!J._has||!J._has("cartesian"))||Se;De&&!Be?Y._bgLayer.remove():Be&&!De&&(J._shouldCreateBgLayer=!0),Y._zoomlayer&&!X._dragging&&c({_fullLayout:Y}),function(Ue,Xe){var Ye,$e=[];Xe.meta&&(Ye=Xe._meta={meta:Xe.meta,layout:{meta:Xe.meta}});for(var it=0;it<Ue.length;it++){var ot=Ue[it];ot.meta?$e[ot.index]=ot._meta={meta:ot.meta}:Xe.meta&&(ot._meta={meta:Xe.meta}),Xe.meta&&(ot._meta.layout={meta:Xe.meta})}$e.length&&(Ye||(Ye=Xe._meta={}),Ye.data=$e)}(G,J),m(J,Y),e.getComponentMethod("colorscale","crossTraceDefaults")(G,J),J._preGUI||(J._preGUI={}),J._tracePreGUI||(J._tracePreGUI={});var We,Qe=J._tracePreGUI,Oe={};for(We in Qe)Oe[We]="old";for(N=0;N<G.length;N++)Oe[We=G[N]._fullInput.uid]||(Qe[We]={}),Oe[We]="new";for(We in Oe)Oe[We]==="old"&&delete Qe[We];S(J),e.getComponentMethod("rangeslider","makeData")(J),Z||K.length!==G.length||v.supplyDefaultsUpdateCalc(K,G)}},v.supplyDefaultsUpdateCalc=function(X,Q){for(var Z=0;Z<Q.length;Z++){var Y=Q[Z],N=(X[Z]||[])[0];if(N&&N.trace){var J=N.trace;if(J._hasCalcTransform){var D,U,G,$=J._arrayAttrs;for(D=0;D<$.length;D++)U=$[D],G=a.nestedProperty(J,U).get().slice(),a.nestedProperty(Y,U).set(G)}N.trace=Y}}},v.createTransitionData=function(X){X._transitionData||(X._transitionData={}),X._transitionData._frames||(X._transitionData._frames=[]),X._transitionData._frameHash||(X._transitionData._frameHash={}),X._transitionData._counter||(X._transitionData._counter=0),X._transitionData._interruptCallbacks||(X._transitionData._interruptCallbacks=[])},v._hasPlotType=function(X){var Q,Z=this._basePlotModules||[];for(Q=0;Q<Z.length;Q++)if(Z[Q].name===X)return!0;var Y=this._modules||[];for(Q=0;Q<Y.length;Q++){var N=Y[Q].name;if(N===X)return!0;var J=e.modules[N];if(J&&J.categories[X])return!0}return!1},v.cleanPlot=function(X,Q,Z,Y){var N,J,D=Y._basePlotModules||[];for(N=0;N<D.length;N++){var U=D[N];U.clean&&U.clean(X,Q,Z,Y)}var G=Y._has&&Y._has("gl"),$=Q._has&&Q._has("gl");G&&!$&&Y._glcontainer!==void 0&&(Y._glcontainer.selectAll(".gl-canvas").remove(),Y._glcontainer.selectAll(".no-webgl").remove(),Y._glcanvas=null);var K=!!Y._infolayer;e:for(N=0;N<Z.length;N++){var re=Z[N].uid;for(J=0;J<X.length;J++)if(re===X[J].uid)continue e;K&&Y._infolayer.select(".cb"+re).remove()}},v.linkSubplots=function(X,Q,Z,Y){var N,J,D=Y._plots||{},U=Q._plots={},G=Q._subplots,$={_fullData:X,_fullLayout:Q},K=G.cartesian.concat(G.gl2d||[]);for(N=0;N<K.length;N++){var re,ne=K[N],ae=D[ne],ie=r.getFromId($,ne,"x"),he=r.getFromId($,ne,"y");for(ae?re=U[ne]=ae:(re=U[ne]={}).id=ne,ie._counterAxes.push(he._id),he._counterAxes.push(ie._id),ie._subplotsWith.push(ne),he._subplotsWith.push(ne),re.xaxis=ie,re.yaxis=he,re._hasClipOnAxisFalse=!1,J=0;J<X.length;J++){var se=X[J];if(se.xaxis===re.xaxis._id&&se.yaxis===re.yaxis._id&&se.cliponaxis===!1){re._hasClipOnAxisFalse=!0;break}}}var de,ce=r.list($,null,!0);for(N=0;N<ce.length;N++){var ve=null;(de=ce[N]).overlaying&&(ve=r.getFromId($,de.overlaying))&&ve.overlaying&&(de.overlaying=!1,ve=null),de._mainAxis=ve||de,ve&&(de.domain=ve.domain.slice()),de._anchorAxis=de.anchor==="free"?null:r.getFromId($,de.anchor)}for(N=0;N<ce.length;N++)if((de=ce[N])._counterAxes.sort(r.idSort),de._subplotsWith.sort(a.subplotSort),de._mainSubplot=b(de,Q),de._counterAxes.length&&(de.spikemode&&de.spikemode.indexOf("across")!==-1||de.automargin&&de.mirror&&de.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(de))){var Ee=1,Le=0;for(J=0;J<de._counterAxes.length;J++){var Te=r.getFromId($,de._counterAxes[J]);Ee=Math.min(Ee,Te.domain[0]),Le=Math.max(Le,Te.domain[1])}Ee<Le&&(de._counterDomainMin=Ee,de._counterDomainMax=Le)}},v.clearExpandedTraceDefaultColors=function(X){var Q,Z,Y;for(Z=[],(Q=X._module._colorAttrs)||(X._module._colorAttrs=Q=[],l.crawl(X._module.attributes,function(N,J,D,U){Z[U]=J,Z.length=U+1,N.valType==="color"&&N.dflt===void 0&&Q.push(Z.join("."))})),Y=0;Y<Q.length;Y++)a.nestedProperty(X,"_input."+Q[Y]).get()||a.nestedProperty(X,Q[Y]).set(null)},v.supplyDataDefaults=function(X,Q,Z,Y){var N,J,D,U=Y._modules,G=Y._visibleModules,$=Y._basePlotModules,K=0,re=0;function ne(xe){Q.push(xe);var fe=xe._module;fe&&(a.pushUnique(U,fe),xe.visible===!0&&a.pushUnique(G,fe),a.pushUnique($,xe._module.basePlotModule),K++,xe._input.visible!==!1&&re++)}Y._transformModules=[];var ae={},ie=[],he=(Z.template||{}).data||{},se=o.traceTemplater(he);for(N=0;N<X.length;N++){if(D=X[N],(J=se.newTrace(D)).uid=Y._traceUids[N],v.supplyTraceDefaults(D,J,re,Y,N),J.index=N,J._input=D,J._expandedIndex=K,J.transforms&&J.transforms.length)for(var de=D.visible!==!1&&J.visible===!1,ce=w(J,Q,Z,Y),ve=0;ve<ce.length;ve++){var Ee=ce[ve],Le={_template:J._template,type:J.type,uid:J.uid+ve};de&&Ee.visible===!1&&delete Ee.visible,v.supplyTraceDefaults(Ee,Le,K,Y,N),m(Le,Ee),Le.index=N,Le._input=D,Le._fullInput=J,Le._expandedIndex=K,Le._expandedInput=Ee,ne(Le)}else J._fullInput=J,J._expandedInput=J,ne(J);e.traceIs(J,"carpetAxis")&&(ae[J.carpet]=J),e.traceIs(J,"carpetDependent")&&ie.push(N)}for(N=0;N<ie.length;N++)if((J=Q[ie[N]]).visible){var Te=ae[J.carpet];J._carpet=Te,Te&&Te.visible?(J.xaxis=Te.xaxis,J.yaxis=Te.yaxis):J.visible=!1}},v.supplyAnimationDefaults=function(X){var Q;X=X||{};var Z={};function Y(N,J){return a.coerce(X||{},Z,f,N,J)}if(Y("mode"),Y("direction"),Y("fromcurrent"),Array.isArray(X.frame))for(Z.frame=[],Q=0;Q<X.frame.length;Q++)Z.frame[Q]=v.supplyAnimationFrameDefaults(X.frame[Q]||{});else Z.frame=v.supplyAnimationFrameDefaults(X.frame||{});if(Array.isArray(X.transition))for(Z.transition=[],Q=0;Q<X.transition.length;Q++)Z.transition[Q]=v.supplyAnimationTransitionDefaults(X.transition[Q]||{});else Z.transition=v.supplyAnimationTransitionDefaults(X.transition||{});return Z},v.supplyAnimationFrameDefaults=function(X){var Q={};function Z(Y,N){return a.coerce(X||{},Q,f.frame,Y,N)}return Z("duration"),Z("redraw"),Q},v.supplyAnimationTransitionDefaults=function(X){var Q={};function Z(Y,N){return a.coerce(X||{},Q,f.transition,Y,N)}return Z("duration"),Z("easing"),Q},v.supplyFrameDefaults=function(X){var Q={};function Z(Y,N){return a.coerce(X,Q,d,Y,N)}return Z("group"),Z("name"),Z("traces"),Z("baseframe"),Z("data"),Z("layout"),Q},v.supplyTraceDefaults=function(X,Q,Z,Y,N){var J,D=Y.colorway||n.defaults,U=D[Z%D.length];function G(ce,ve){return a.coerce(X,Q,v.attributes,ce,ve)}var $=G("visible");G("type"),G("name",Y._traceWord+" "+N),G("uirevision",Y.uirevision);var K=v.getModule(Q);if(Q._module=K,K){var re=K.basePlotModule,ne=re.attr,ae=re.attributes;if(ne&&ae){var ie=Y._subplots,he="";if($||re.name!=="gl2d"){if(Array.isArray(ne))for(J=0;J<ne.length;J++){var se=ne[J],de=a.coerce(X,Q,ae,se);ie[se]&&a.pushUnique(ie[se],de),he+=de}else he=a.coerce(X,Q,ae,ne);ie[re.name]&&a.pushUnique(ie[re.name],he)}}}return $&&(G("customdata"),G("ids"),G("meta"),e.traceIs(Q,"showLegend")?(a.coerce(X,Q,K.attributes.showlegend?K.attributes:v.attributes,"showlegend"),G("legendgroup"),G("legendgrouptitle.text")&&a.coerceFont(G,"legendgrouptitle.font",a.extendFlat({},Y.font,{size:Math.round(1.1*Y.font.size)})),G("legendrank"),Q._dfltShowLegend=!0):Q._dfltShowLegend=!1,K&&K.supplyDefaults(X,Q,U,Y),e.traceIs(Q,"noOpacity")||G("opacity"),e.traceIs(Q,"notLegendIsolatable")&&(Q.visible=!!Q.visible),e.traceIs(Q,"noHover")||(Q.hovertemplate||a.coerceHoverinfo(X,Q,Y),Q.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(X,Q,U,Y)),K&&K.selectPoints&&G("selectedpoints"),v.supplyTransformDefaults(X,Q,Y)),Q},v.hasMakesDataTransform=L,v.supplyTransformDefaults=function(X,Q,Z){if(Q._length||L(X)){var Y=Z._globalTransforms||[],N=Z._transformModules||[];if(Array.isArray(X.transforms)||Y.length!==0)for(var J=X.transforms||[],D=Y.concat(J),U=Q.transforms=[],G=0;G<D.length;G++){var $,K=D[G],re=K.type,ne=T[re],ae=!(K._module&&K._module===ne),ie=ne&&typeof ne.transform=="function";ne||a.warn("Unrecognized transform type "+re+"."),ne&&ne.supplyDefaults&&(ae||ie)?(($=ne.supplyDefaults(K,Q,Z,X)).type=re,$._module=ne,a.pushUnique(N,ne)):$=a.extendFlat({},K),U.push($)}}},v.supplyLayoutGlobalDefaults=function(X,Q,Z){function Y(U,G){return a.coerce(X,Q,v.layoutAttributes,U,G)}var N=X.template;a.isPlainObject(N)&&(Q.template=N,Q._template=N.layout,Q._dataTemplate=N.data),Y("autotypenumbers");var J=a.coerceFont(Y,"font");Y("title.text",Q._dfltTitle.plot),a.coerceFont(Y,"title.font",{family:J.family,size:Math.round(1.4*J.size),color:J.color}),Y("title.xref"),Y("title.yref"),Y("title.x"),Y("title.y"),Y("title.xanchor"),Y("title.yanchor"),Y("title.pad.t"),Y("title.pad.r"),Y("title.pad.b"),Y("title.pad.l"),Y("uniformtext.mode")&&Y("uniformtext.minsize"),Y("autosize",!(X.width&&X.height)),Y("width"),Y("height"),Y("margin.l"),Y("margin.r"),Y("margin.t"),Y("margin.b"),Y("margin.pad"),Y("margin.autoexpand"),X.width&&X.height&&v.sanitizeMargins(Q),e.getComponentMethod("grid","sizeDefaults")(X,Q),Y("paper_bgcolor"),Y("separators",Z.decimal+Z.thousands),Y("hidesources"),Y("colorway"),Y("datarevision");var D=Y("uirevision");Y("editrevision",D),Y("selectionrevision",D),e.getComponentMethod("modebar","supplyLayoutDefaults")(X,Q),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(X,Q,Y),Y("meta"),a.isPlainObject(X.transition)&&(Y("transition.duration"),Y("transition.easing"),Y("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(X,Q,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(X,Q,Y)},v.plotAutoSize=function(X,Q,Z){var Y,N,J=X._context||{},D=J.frameMargins,U=a.isPlotDiv(X);if(U&&X.emit("plotly_autosize"),J.fillFrame)Y=window.innerWidth,N=window.innerHeight,document.body.style.overflow="hidden";else{var G=U?window.getComputedStyle(X):{};if(Y=C(G.width)||C(G.maxWidth)||Z.width,N=C(G.height)||C(G.maxHeight)||Z.height,u(D)&&D>0){var $=1-2*D;Y=Math.round($*Y),N=Math.round($*N)}}var K=v.layoutAttributes.width.min,re=v.layoutAttributes.height.min;Y<K&&(Y=K),N<re&&(N=re);var ne=!Q.width&&Math.abs(Z.width-Y)>1,ae=!Q.height&&Math.abs(Z.height-N)>1;(ae||ne)&&(ne&&(Z.width=Y),ae&&(Z.height=N)),X._initialAutoSize||(X._initialAutoSize={width:Y,height:N}),v.sanitizeMargins(Z)},v.supplyLayoutModuleDefaults=function(X,Q,Z,Y){var N,J,D,U=e.componentsRegistry,G=Q._basePlotModules,$=e.subplotsRegistry.cartesian;for(N in U)(D=U[N]).includeBasePlot&&D.includeBasePlot(X,Q);for(var K in G.length||G.push($),Q._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(X,Q),$.finalizeSubplots(X,Q)),Q._subplots)Q._subplots[K].sort(a.subplotSort);for(J=0;J<G.length;J++)(D=G[J]).supplyLayoutDefaults&&D.supplyLayoutDefaults(X,Q,Z);var re=Q._modules;for(J=0;J<re.length;J++)(D=re[J]).supplyLayoutDefaults&&D.supplyLayoutDefaults(X,Q,Z);var ne=Q._transformModules;for(J=0;J<ne.length;J++)(D=ne[J]).supplyLayoutDefaults&&D.supplyLayoutDefaults(X,Q,Z,Y);for(N in U)(D=U[N]).supplyLayoutDefaults&&D.supplyLayoutDefaults(X,Q,Z)},v.purge=function(X){var Q=X._fullLayout||{};Q._glcontainer!==void 0&&(Q._glcontainer.selectAll(".gl-canvas").remove(),Q._glcontainer.remove(),Q._glcanvas=null),Q._modeBar&&Q._modeBar.destroy(),X._transitionData&&(X._transitionData._interruptCallbacks&&(X._transitionData._interruptCallbacks.length=0),X._transitionData._animationRaf&&window.cancelAnimationFrame(X._transitionData._animationRaf)),a.clearThrottle(),a.clearResponsive(X),delete X.data,delete X.layout,delete X._fullData,delete X._fullLayout,delete X.calcdata,delete X.empty,delete X.fid,delete X.undoqueue,delete X.undonum,delete X.autoplay,delete X.changed,delete X._promises,delete X._redrawTimer,delete X._hmlumcount,delete X._hmpixcount,delete X._transitionData,delete X._transitioning,delete X._initialAutoSize,delete X._transitioningWithDuration,delete X._dragging,delete X._dragged,delete X._dragdata,delete X._hoverdata,delete X._snapshotInProgress,delete X._editing,delete X._mouseDownTime,delete X._legendMouseDownTime,X.removeAllListeners&&X.removeAllListeners()},v.style=function(X){var Q,Z=X._fullLayout._visibleModules,Y=[];for(Q=0;Q<Z.length;Q++){var N=Z[Q];N.style&&a.pushUnique(Y,N.style)}for(Q=0;Q<Y.length;Q++)Y[Q](X)},v.sanitizeMargins=function(X){if(X&&X.margin){var Q,Z=X.width,Y=X.height,N=X.margin,J=Z-(N.l+N.r),D=Y-(N.t+N.b);J<0&&(Q=(Z-1)/(N.l+N.r),N.l=Math.floor(Q*N.l),N.r=Math.floor(Q*N.r)),D<0&&(Q=(Y-1)/(N.t+N.b),N.t=Math.floor(Q*N.t),N.b=Math.floor(Q*N.b))}},v.clearAutoMarginIds=function(X){X._fullLayout._pushmarginIds={}},v.allowAutoMargin=function(X,Q){X._fullLayout._pushmarginIds[Q]=1},v.autoMargin=function(X,Q,Z){var Y=X._fullLayout,N=Y.width,J=Y.height,D=Y.margin,U=a.constrain(N-D.l-D.r,2,64),G=a.constrain(J-D.t-D.b,2,64),$=Math.max(0,N-U),K=Math.max(0,J-G),re=Y._pushmargin,ne=Y._pushmarginIds;if(D.autoexpand!==!1){if(Z){var ae=Z.pad;if(ae===void 0&&(ae=Math.min(12,D.l,D.r,D.t,D.b)),$){var ie=(Z.l+Z.r)/$;ie>1&&(Z.l/=ie,Z.r/=ie)}if(K){var he=(Z.t+Z.b)/K;he>1&&(Z.t/=he,Z.b/=he)}var se=Z.xl!==void 0?Z.xl:Z.x,de=Z.xr!==void 0?Z.xr:Z.x,ce=Z.yt!==void 0?Z.yt:Z.y,ve=Z.yb!==void 0?Z.yb:Z.y;re[Q]={l:{val:se,size:Z.l+ae},r:{val:de,size:Z.r+ae},b:{val:ve,size:Z.b+ae},t:{val:ce,size:Z.t+ae}},ne[Q]=1}else delete re[Q],delete ne[Q];if(!Y._replotting)return v.doAutoMargin(X)}},v.doAutoMargin=function(X){var Q=X._fullLayout,Z=Q.width,Y=Q.height;Q._size||(Q._size={}),S(Q);var N=Q._size,J=Q.margin,D=a.extendFlat({},N),U=J.l,G=J.r,$=J.t,K=J.b,re=Q._pushmargin,ne=Q._pushmarginIds;if(Q.margin.autoexpand!==!1){for(var ae in re)ne[ae]||delete re[ae];for(var ie in re.base={l:{val:0,size:U},r:{val:1,size:G},t:{val:1,size:$},b:{val:0,size:K}},re){var he=re[ie].l||{},se=re[ie].b||{},de=he.val,ce=he.size,ve=se.val,Ee=se.size;for(var Le in re){if(u(ce)&&re[Le].r){var Te=re[Le].r.val,xe=re[Le].r.size;if(Te>de){var fe=(ce*Te+(xe-Z)*de)/(Te-de),ge=(xe*(1-de)+(ce-Z)*(1-Te))/(Te-de);fe+ge>U+G&&(U=fe,G=ge)}}if(u(Ee)&&re[Le].t){var ke=re[Le].t.val,Me=re[Le].t.size;if(ke>ve){var Se=(Ee*ke+(Me-Y)*ve)/(ke-ve),De=(Me*(1-ve)+(Ee-Y)*(1-ke))/(ke-ve);Se+De>K+$&&(K=Se,$=De)}}}}}var Be=a.constrain(Z-J.l-J.r,2,64),We=a.constrain(Y-J.t-J.b,2,64),Qe=Math.max(0,Z-Be),Oe=Math.max(0,Y-We);if(Qe){var Ue=(U+G)/Qe;Ue>1&&(U/=Ue,G/=Ue)}if(Oe){var Xe=(K+$)/Oe;Xe>1&&(K/=Xe,$/=Xe)}if(N.l=Math.round(U),N.r=Math.round(G),N.t=Math.round($),N.b=Math.round(K),N.p=Math.round(J.pad),N.w=Math.round(Z)-N.l-N.r,N.h=Math.round(Y)-N.t-N.b,!Q._replotting&&v.didMarginChange(D,N)){"_redrawFromAutoMarginCount"in Q?Q._redrawFromAutoMarginCount++:Q._redrawFromAutoMarginCount=1;var Ye=3*(1+Object.keys(ne).length);if(Q._redrawFromAutoMarginCount<Ye)return e.call("_doPlot",X);Q._size=D,a.warn("Too many auto-margin redraws.")}(function($e){var it=r.list($e,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(ot){for(var Et=0;Et<it.length;Et++){var mt=it[Et][ot];mt&&mt()}})})(X)};var P=["l","r","t","b","p","w","h"];function z(X,Q,Z){var Y=!1,N=[v.previousPromises,function(){if(X._transitionData)return X._transitioning=!1,function(D){var U=Promise.resolve();if(!D)return U;for(;D.length;)U=U.then(D.shift());return U}(X._transitionData._interruptCallbacks)},Z.prepareFn,v.rehover,function(){return X.emit("plotly_transitioning",[]),new Promise(function(D){X._transitioning=!0,Q.duration>0&&(X._transitioningWithDuration=!0),X._transitionData._interruptCallbacks.push(function(){Y=!0}),Z.redraw&&X._transitionData._interruptCallbacks.push(function(){return e.call("redraw",X)}),X._transitionData._interruptCallbacks.push(function(){X.emit("plotly_transitioninterrupted",[])});var U=0,G=0;function $(){return U++,function(){G++,Y||G!==U||function(K){X._transitionData&&(function(re){if(re)for(;re.length;)re.shift()}(X._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(Z.redraw)return e.call("redraw",X)}).then(function(){X._transitioning=!1,X._transitioningWithDuration=!1,X.emit("plotly_transitioned",[])}).then(K))}(D)}}Z.runFn($),setTimeout($())})}],J=a.syncOrAsync(N,X);return J&&J.then||(J=Promise.resolve()),J.then(function(){return X})}v.didMarginChange=function(X,Q){for(var Z=0;Z<P.length;Z++){var Y=P[Z],N=X[Y],J=Q[Y];if(!u(N)||Math.abs(J-N)>1)return!0}return!1},v.graphJson=function(X,Q,Z,Y,N,J){(N&&Q&&!X._fullData||N&&!Q&&!X._fullLayout)&&v.supplyDefaults(X);var D=N?X._fullData:X.data,U=N?X._fullLayout:X.layout,G=(X._transitionData||{})._frames;function $(ne,ae){if(typeof ne=="function")return ae?"_function_":null;if(a.isPlainObject(ne)){var ie,he={};return Object.keys(ne).sort().forEach(function(se){if(["_","["].indexOf(se.charAt(0))===-1)if(typeof ne[se]!="function"){if(Z==="keepdata"){if(se.substr(se.length-3)==="src")return}else if(Z==="keepstream"){if(typeof(ie=ne[se+"src"])=="string"&&ie.indexOf(":")>0&&!a.isPlainObject(ne.stream))return}else if(Z!=="keepall"&&typeof(ie=ne[se+"src"])=="string"&&ie.indexOf(":")>0)return;he[se]=$(ne[se],ae)}else ae&&(he[se]="_function")}),he}return Array.isArray(ne)?ne.map(function(se){return $(se,ae)}):a.isTypedArray(ne)?a.simpleMap(ne,a.identity):a.isJSDate(ne)?a.ms2DateTimeLocal(+ne):ne}var K={data:(D||[]).map(function(ne){var ae=$(ne);return Q&&delete ae.fit,ae})};if(!Q&&(K.layout=$(U),N)){var re=U._size;K.layout.computed={margin:{b:re.b,l:re.l,r:re.r,t:re.t}}}return G&&(K.frames=$(G)),J&&(K.config=$(X._context,!0)),Y==="object"?K:JSON.stringify(K)},v.modifyFrames=function(X,Q){var Z,Y,N,J=X._transitionData._frames,D=X._transitionData._frameHash;for(Z=0;Z<Q.length;Z++)switch((Y=Q[Z]).type){case"replace":N=Y.value;var U=(J[Y.index]||{}).name,G=N.name;J[Y.index]=D[G]=N,G!==U&&(delete D[U],D[G]=N);break;case"insert":D[(N=Y.value).name]=N,J.splice(Y.index,0,N);break;case"delete":delete D[(N=J[Y.index]).name],J.splice(Y.index,1)}return Promise.resolve()},v.computeFrame=function(X,Q){var Z,Y,N,J,D=X._transitionData._frameHash;if(!Q)throw new Error("computeFrame must be given a string frame name");var U=D[Q.toString()];if(!U)return!1;for(var G=[U],$=[U.name];U.baseframe&&(U=D[U.baseframe.toString()])&&$.indexOf(U.name)===-1;)G.push(U),$.push(U.name);for(var K={};U=G.pop();)if(U.layout&&(K.layout=v.extendLayout(K.layout,U.layout)),U.data){if(K.data||(K.data=[]),!(Y=U.traces))for(Y=[],Z=0;Z<U.data.length;Z++)Y[Z]=Z;for(K.traces||(K.traces=[]),Z=0;Z<U.data.length;Z++)(N=Y[Z])!=null&&((J=K.traces.indexOf(N))===-1&&(J=K.data.length,K.traces[J]=N),K.data[J]=v.extendTrace(K.data[J],U.data[Z]))}return K},v.recomputeFrameHash=function(X){for(var Q=X._transitionData._frameHash={},Z=X._transitionData._frames,Y=0;Y<Z.length;Y++){var N=Z[Y];N&&N.name&&(Q[N.name]=N)}},v.extendObjectWithContainers=function(X,Q,Z){var Y,N,J,D,U,G,$,K=a.extendDeepNoArrays({},Q||{}),re=a.expandObjectPaths(K),ne={};if(Z&&Z.length)for(J=0;J<Z.length;J++)(N=(Y=a.nestedProperty(re,Z[J])).get())===void 0?a.nestedProperty(ne,Z[J]).set(null):(Y.set(null),a.nestedProperty(ne,Z[J]).set(N));if(X=a.extendDeepNoArrays(X||{},re),Z&&Z.length){for(J=0;J<Z.length;J++)if(G=a.nestedProperty(ne,Z[J]).get()){for($=(U=a.nestedProperty(X,Z[J])).get(),Array.isArray($)||($=[],U.set($)),D=0;D<G.length;D++){var ae=G[D];$[D]=ae===null?null:v.extendObjectWithContainers($[D],ae)}U.set($)}}return X},v.dataArrayContainers=["transforms","dimensions"],v.layoutArrayContainers=e.layoutArrayContainers,v.extendTrace=function(X,Q){return v.extendObjectWithContainers(X,Q,v.dataArrayContainers)},v.extendLayout=function(X,Q){return v.extendObjectWithContainers(X,Q,v.layoutArrayContainers)},v.transition=function(X,Q,Z,Y,N,J){var D={redraw:N.redraw},U={},G=[];return D.prepareFn=function(){for(var $=Array.isArray(Q)?Q.length:0,K=Y.slice(0,$),re=0;re<K.length;re++){var ne=K[re],ae=X._fullData[ne]._module;if(ae){if(ae.animatable){var ie=ae.basePlotModule.name;U[ie]||(U[ie]=[]),U[ie].push(ne)}X.data[K[re]]=v.extendTrace(X.data[K[re]],Q[re])}}var he=a.expandObjectPaths(a.extendDeepNoArrays({},Z)),se=/^[xy]axis[0-9]*$/;for(var de in he)se.test(de)&&delete he[de].range;v.extendLayout(X.layout,he),delete X.calcdata,v.supplyDefaults(X),v.doCalcdata(X);var ce=a.expandObjectPaths(Z);if(ce){var ve=X._fullLayout._plots;for(var Ee in ve){var Le=ve[Ee],Te=Le.xaxis,xe=Le.yaxis,fe=Te.range.slice(),ge=xe.range.slice(),ke=null,Me=null,Se=null,De=null;Array.isArray(ce[Te._name+".range"])?ke=ce[Te._name+".range"].slice():Array.isArray((ce[Te._name]||{}).range)&&(ke=ce[Te._name].range.slice()),Array.isArray(ce[xe._name+".range"])?Me=ce[xe._name+".range"].slice():Array.isArray((ce[xe._name]||{}).range)&&(Me=ce[xe._name].range.slice()),fe&&ke&&(Te.r2l(fe[0])!==Te.r2l(ke[0])||Te.r2l(fe[1])!==Te.r2l(ke[1]))&&(Se={xr0:fe,xr1:ke}),ge&&Me&&(xe.r2l(ge[0])!==xe.r2l(Me[0])||xe.r2l(ge[1])!==xe.r2l(Me[1]))&&(De={yr0:ge,yr1:Me}),(Se||De)&&G.push(a.extendFlat({plotinfo:Le},Se,De))}}return Promise.resolve()},D.runFn=function($){var K,re,ne=X._fullLayout._basePlotModules,ae=G.length;if(Z)for(re=0;re<ne.length;re++)ne[re].transitionAxes&&ne[re].transitionAxes(X,G,J,$);for(var ie in ae?((K=a.extendFlat({},J)).duration=0,delete U.cartesian):K=J,U){var he=U[ie];X._fullData[he[0]]._module.basePlotModule.plot(X,he,K,$)}},z(X,J,D)},v.transitionFromReact=function(X,Q,Z,Y){var N=X._fullLayout,J=N.transition,D={},U=[];return D.prepareFn=function(){var G=N._plots;for(var $ in D.redraw=!1,Q.anim==="some"&&(D.redraw=!0),Z.anim==="some"&&(D.redraw=!0),G){var K=G[$],re=K.xaxis,ne=K.yaxis,ae=Y[re._name].range.slice(),ie=Y[ne._name].range.slice(),he=re.range.slice(),se=ne.range.slice();re.setScale(),ne.setScale();var de=null,ce=null;re.r2l(ae[0])===re.r2l(he[0])&&re.r2l(ae[1])===re.r2l(he[1])||(de={xr0:ae,xr1:he}),ne.r2l(ie[0])===ne.r2l(se[0])&&ne.r2l(ie[1])===ne.r2l(se[1])||(ce={yr0:ie,yr1:se}),(de||ce)&&U.push(a.extendFlat({plotinfo:K},de,ce))}return Promise.resolve()},D.runFn=function(G){for(var $,K,re,ne=X._fullData,ae=X._fullLayout._basePlotModules,ie=[],he=0;he<ne.length;he++)ie.push(he);function se(){if(X._fullLayout)for(var ce=0;ce<ae.length;ce++)ae[ce].transitionAxes&&ae[ce].transitionAxes(X,U,$,G)}function de(){if(X._fullLayout)for(var ce=0;ce<ae.length;ce++)ae[ce].plot(X,re,K,G)}U.length&&Q.anim?J.ordering==="traces first"?($=a.extendFlat({},J,{duration:0}),re=ie,K=J,setTimeout(se,J.duration),de()):($=J,re=null,K=a.extendFlat({},J,{duration:0}),setTimeout(de,$.duration),se()):U.length?($=J,se()):Q.anim&&(re=ie,K=J,de())},z(X,J,D)},v.doCalcdata=function(X,Q){var Z,Y,N,J,D=r.list(X),U=X._fullData,G=X._fullLayout,$=new Array(U.length),K=(X.calcdata||[]).slice();for(X.calcdata=$,G._numBoxes=0,G._numViolins=0,G._violinScaleGroupStats={},X._hmpixcount=0,X._hmlumcount=0,G._piecolormap={},G._sunburstcolormap={},G._treemapcolormap={},G._iciclecolormap={},G._funnelareacolormap={},N=0;N<U.length;N++)Array.isArray(Q)&&Q.indexOf(N)===-1&&($[N]=K[N]);for(N=0;N<U.length;N++)(Z=U[N])._arrayAttrs=l.findArrayAttributes(Z),Z._extremes={};var re=G._subplots.polar||[];for(N=0;N<re.length;N++)D.push(G[re[N]].radialaxis,G[re[N]].angularaxis);for(var ne in G._colorAxes){var ae=G[ne];ae.cauto!==!1&&(delete ae.cmin,delete ae.cmax)}var ie=!1;function he(ce){if(Z=U[ce],Y=Z._module,Z.visible===!0&&Z.transforms){if(Y&&Y.calc){var ve=Y.calc(X,Z);ve[0]&&ve[0].t&&ve[0].t._scene&&delete ve[0].t._scene.dirty}for(J=0;J<Z.transforms.length;J++){var Ee=Z.transforms[J];(Y=T[Ee.type])&&Y.calcTransform&&(Z._hasCalcTransform=!0,ie=!0,Y.calcTransform(X,Z,Ee))}}}function se(ce,ve){if(Z=U[ce],!!(Y=Z._module).isContainer===ve){var Ee=[];if(Z.visible===!0&&Z._length!==0){delete Z._indexToPoints;var Le=Z.transforms||[];for(J=Le.length-1;J>=0;J--)if(Le[J].enabled){Z._indexToPoints=Le[J]._indexToPoints;break}Y&&Y.calc&&(Ee=Y.calc(X,Z))}Array.isArray(Ee)&&Ee[0]||(Ee=[{x:s,y:s}]),Ee[0].t||(Ee[0].t={}),Ee[0].trace=Z,$[ce]=Ee}}for(q(D,U,G),N=0;N<U.length;N++)se(N,!0);for(N=0;N<U.length;N++)he(N);for(ie&&q(D,U,G),N=0;N<U.length;N++)se(N,!0);for(N=0;N<U.length;N++)se(N,!1);W(X);var de=function(ce,ve){var Ee,Le,Te,xe,fe,ge=[];function ke(Ie,be,Ae){var Pe=be._id.charAt(0);if(Ie==="histogram2dcontour"){var ze=be._counterAxes[0],qe=r.getFromId(ve,ze),ht=Pe==="x"||ze==="x"&&qe.type==="category",at=Pe==="y"||ze==="y"&&qe.type==="category";return function(nt,xt){return nt===0||xt===0||ht&&nt===Ae[xt].length-1||at&&xt===Ae.length-1?-1:(Pe==="y"?xt:nt)-1}}return function(nt,xt){return Pe==="y"?xt:nt}}var Me={min:function(Ie){return a.aggNums(Math.min,null,Ie)},max:function(Ie){return a.aggNums(Math.max,null,Ie)},sum:function(Ie){return a.aggNums(function(be,Ae){return be+Ae},null,Ie)},total:function(Ie){return a.aggNums(function(be,Ae){return be+Ae},null,Ie)},mean:function(Ie){return a.mean(Ie)},median:function(Ie){return a.median(Ie)}};for(Ee=0;Ee<ce.length;Ee++){var Se=ce[Ee];if(Se.type==="category"){var De=Se.categoryorder.match(F);if(De){var Be=De[1],We=De[2],Qe=Se._id.charAt(0),Oe=Qe==="x",Ue=[];for(Le=0;Le<Se._categories.length;Le++)Ue.push([Se._categories[Le],[]]);for(Le=0;Le<Se._traceIndices.length;Le++){var Xe=Se._traceIndices[Le],Ye=ve._fullData[Xe];if(Ye.visible===!0){var $e=Ye.type;e.traceIs(Ye,"histogram")&&(delete Ye._xautoBinFinished,delete Ye._yautoBinFinished);var it=$e==="splom",ot=$e==="scattergl",Et=ve.calcdata[Xe];for(Te=0;Te<Et.length;Te++){var mt,tt,Ke=Et[Te];if(it){var Mt=Ye._axesDim[Se._id];if(!Oe){var Jt=Ye._diag[Mt][0];Jt&&(Se=ve._fullLayout[r.id2name(Jt)])}var $t=Ke.trace.dimensions[Mt].values;for(xe=0;xe<$t.length;xe++)for(mt=Se._categoriesMap[$t[xe]],fe=0;fe<Ke.trace.dimensions.length;fe++)if(fe!==Mt){var je=Ke.trace.dimensions[fe];Ue[mt][1].push(je.values[xe])}}else if(ot){for(xe=0;xe<Ke.t.x.length;xe++)Oe?(mt=Ke.t.x[xe],tt=Ke.t.y[xe]):(mt=Ke.t.y[xe],tt=Ke.t.x[xe]),Ue[mt][1].push(tt);Ke.t&&Ke.t._scene&&delete Ke.t._scene.dirty}else if(Ke.hasOwnProperty("z")){tt=Ke.z;var Ge=ke(Ye.type,Se,tt);for(xe=0;xe<tt.length;xe++)for(fe=0;fe<tt[xe].length;fe++)(mt=Ge(fe,xe))+1&&Ue[mt][1].push(tt[xe][fe])}else for((mt=Ke.p)===void 0&&(mt=Ke[Qe]),(tt=Ke.s)===void 0&&(tt=Ke.v),tt===void 0&&(tt=Oe?Ke.y:Ke.x),Array.isArray(tt)||(tt=tt===void 0?[]:[tt]),xe=0;xe<tt.length;xe++)Ue[mt][1].push(tt[xe])}}}Se._categoriesValue=Ue;var Ct=[];for(Le=0;Le<Ue.length;Le++)Ct.push([Ue[Le][0],Me[Be](Ue[Le][1])]);Ct.sort(function(Ie,be){return Ie[1]-be[1]}),Se._categoriesAggregatedValue=Ct,Se._initialCategories=Ct.map(function(Ie){return Ie[0]}),We==="descending"&&Se._initialCategories.reverse(),ge=ge.concat(Se.sortByInitialCategories())}}}return ge}(D,X);if(de.length){for(G._numBoxes=0,G._numViolins=0,N=0;N<de.length;N++)se(de[N],!0);for(N=0;N<de.length;N++)se(de[N],!1);W(X)}e.getComponentMethod("fx","calc")(X),e.getComponentMethod("errorbars","calc")(X)};var F=/(total|sum|min|max|mean|median) (ascending|descending)/;function q(X,Q,Z){var Y={};function N(G){G.clearCalc(),G.type==="multicategory"&&G.setupMultiCategory(Q),Y[G._id]=1}a.simpleMap(X,N);for(var J=Z._axisMatchGroups||[],D=0;D<J.length;D++)for(var U in J[D])Y[U]||N(Z[r.id2name(U)])}function W(X){var Q,Z,Y,N=X._fullLayout,J=N._visibleModules,D={};for(Z=0;Z<J.length;Z++){var U=J[Z],G=U.crossTraceCalc;if(G){var $=U.basePlotModule.name;D[$]?a.pushUnique(D[$],G):D[$]=[G]}}for(Y in D){var K=D[Y],re=N._subplots[Y];if(Array.isArray(re))for(Q=0;Q<re.length;Q++){var ne=re[Q],ae=Y==="cartesian"?N._plots[ne]:N[ne];for(Z=0;Z<K.length;Z++)K[Z](X,ae,ne)}else for(Z=0;Z<K.length;Z++)K[Z](X)}}v.rehover=function(X){X._fullLayout._rehover&&X._fullLayout._rehover()},v.redrag=function(X){X._fullLayout._redrag&&X._fullLayout._redrag()},v.generalUpdatePerTraceModule=function(X,Q,Z,Y){var N,J=Q.traceHash,D={};for(N=0;N<Z.length;N++){var U=Z[N],G=U[0].trace;G.visible&&(D[G.type]=D[G.type]||[],D[G.type].push(U))}for(var $ in J)if(!D[$]){var K=J[$][0];K[0].trace.visible=!1,D[$]=[K]}for(var re in D){var ne=D[re];ne[0][0].trace._module.plot(X,Q,a.filterVisible(ne),Y)}Q.traceHash=D},v.plotBasePlot=function(X,Q,Z,Y,N){var J=e.getModule(X),D=g(Q.calcdata,J)[0];J.plot(Q,D,Y,N)},v.cleanBasePlot=function(X,Q,Z,Y,N){var J=N._has&&N._has(X),D=Z._has&&Z._has(X);J&&!D&&N["_"+X+"layer"].selectAll("g.trace").remove()}},{"../components/color":666,"../constants/numerical":779,"../lib":803,"../plot_api/plot_schema":842,"../plot_api/plot_template":843,"../plots/get_data":891,"../registry":931,"./animation_attributes":848,"./attributes":850,"./cartesian/axis_ids":858,"./cartesian/handle_outline":865,"./command":881,"./font_attributes":883,"./frame_attributes":884,"./layout_attributes":908,"@plotly/d3":58,"d3-format":167,"d3-time-format":175,"fast-isnumeric":249}],918:[function(i,B,V){B.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],919:[function(i,B,V){var t=i("../../lib"),h=i("../../lib/polygon").tester,p=t.findIndexOfMin,u=t.isAngleInsideSector,e=t.angleDelta,l=t.angleDist;function o(r,c,f,d){var g,m,y=d[0],v=d[1],T=n(Math.sin(c)-Math.sin(r)),_=n(Math.cos(c)-Math.cos(r)),k=Math.tan(f),E=n(1/k),A=T/_,b=v-A*y;return E?T&&_?m=k*(g=b/(k-A)):_?(g=v*E,m=v):(g=y,m=y*k):T&&_?(g=0,m=b):_?(g=0,m=v):g=m=NaN,[g,m]}function a(r,c,f,d){return t.isFullCircle([c,f])?function(g,m){var y,v=m.length,T=new Array(v+1);for(y=0;y<v;y++){var _=m[y];T[y]=[g*Math.cos(_),g*Math.sin(_)]}return T[y]=T[0].slice(),T}(r,d):function(g,m,y,v){var T,_,k=v.length,E=[];function A(q){return[g*Math.cos(q),g*Math.sin(q)]}function b(q,W,X){return o(q,W,X,A(q))}function L(q){return t.mod(q,k)}function w(q){return u(q,[m,y])}var C=p(v,function(q){return w(q)?l(q,m):1/0}),S=b(v[C],v[L(C-1)],m);for(E.push(S),T=C,_=0;_<k;T++,_++){var P=v[L(T)];if(!w(P))break;E.push(A(P))}var z=p(v,function(q){return w(q)?l(q,y):1/0}),F=b(v[z],v[L(z+1)],y);return E.push(F),E.push([0,0]),E.push(E[0].slice()),E}(r,c,f,d)}function n(r){return Math.abs(r)>1e-10?r:0}function s(r,c,f){c=c||0,f=f||0;for(var d=r.length,g=new Array(d),m=0;m<d;m++){var y=r[m];g[m]=[c+y[0],f-y[1]]}return g}B.exports={isPtInsidePolygon:function(r,c,f,d,g){if(!u(c,d))return!1;var m,y;f[0]<f[1]?(m=f[0],y=f[1]):(m=f[1],y=f[0]);var v=h(a(m,d[0],d[1],g)),T=h(a(y,d[0],d[1],g)),_=[r*Math.cos(c),r*Math.sin(c)];return T.contains(_)&&!v.contains(_)},findPolygonOffset:function(r,c,f,d){for(var g=1/0,m=1/0,y=a(r,c,f,d),v=0;v<y.length;v++){var T=y[v];g=Math.min(g,T[0]),m=Math.min(m,-T[1])}return[g,m]},findEnclosingVertexAngles:function(r,c){var f=p(c,function(g){var m=e(g,r);return m>0?m:1/0}),d=t.mod(f+1,c.length);return[c[f],c[d]]},findIntersectionXY:o,findXYatLength:function(r,c,f,d){var g=-c*f,m=c*c+1,y=2*(c*g-f),v=g*g+f*f-r*r,T=Math.sqrt(y*y-4*m*v),_=(-y+T)/(2*m),k=(-y-T)/(2*m);return[[_,c*_+g+d],[k,c*k+g+d]]},clampTiny:n,pathPolygon:function(r,c,f,d,g,m){return"M"+s(a(r,c,f,d),g,m).join("L")},pathPolygonAnnulus:function(r,c,f,d,g,m,y){var v,T;r<c?(v=r,T=c):(v=c,T=r);var _=s(a(v,f,d,g),m,y);return"M"+s(a(T,f,d,g),m,y).reverse().join("L")+"M"+_.join("L")}}},{"../../lib":803,"../../lib/polygon":815}],920:[function(i,B,V){var t=i("../get_data").getSubplotCalcData,h=i("../../lib").counterRegex,p=i("./polar"),u=i("./constants"),e=u.attr,l=u.name,o=h(l),a={};a[e]={valType:"subplotid",dflt:l,editType:"calc"},B.exports={attr:e,name:l,idRoot:l,idRegex:o,attrRegex:o,attributes:a,layoutAttributes:i("./layout_attributes"),supplyLayoutDefaults:i("./layout_defaults"),plot:function(n){for(var s=n._fullLayout,r=n.calcdata,c=s._subplots[l],f=0;f<c.length;f++){var d=c[f],g=t(r,l,d),m=s[d]._subplot;m||(m=p(n,d),s[d]._subplot=m),m.plot(g,s,n._promises)}},clean:function(n,s,r,c){for(var f=c._subplots[l]||[],d=c._has&&c._has("gl"),g=s._has&&s._has("gl"),m=d&&!g,y=0;y<f.length;y++){var v=f[y],T=c[v]._subplot;if(!s[v]&&T)for(var _ in T.framework.remove(),T.layers["radial-axis-title"].remove(),T.clipPaths)T.clipPaths[_].remove();m&&T._scene&&(T._scene.destroy(),T._scene=null)}},toSVG:i("../cartesian").toSVG}},{"../../lib":803,"../cartesian":868,"../get_data":891,"./constants":918,"./layout_attributes":921,"./layout_defaults":922,"./polar":923}],921:[function(i,B,V){var t=i("../../components/color/attributes"),h=i("../cartesian/layout_attributes"),p=i("../domain").attributes,u=i("../../lib").extendFlat,e=i("../../plot_api/edit_types").overrideAll,l=e({color:h.color,showline:u({},h.showline,{dflt:!0}),linecolor:h.linecolor,linewidth:h.linewidth,showgrid:u({},h.showgrid,{dflt:!0}),gridcolor:h.gridcolor,gridwidth:h.gridwidth},"plot","from-root"),o=e({tickmode:h.tickmode,nticks:h.nticks,tick0:h.tick0,dtick:h.dtick,tickvals:h.tickvals,ticktext:h.ticktext,ticks:h.ticks,ticklen:h.ticklen,tickwidth:h.tickwidth,tickcolor:h.tickcolor,showticklabels:h.showticklabels,showtickprefix:h.showtickprefix,tickprefix:h.tickprefix,showticksuffix:h.showticksuffix,ticksuffix:h.ticksuffix,showexponent:h.showexponent,exponentformat:h.exponentformat,minexponent:h.minexponent,separatethousands:h.separatethousands,tickfont:h.tickfont,tickangle:h.tickangle,tickformat:h.tickformat,tickformatstops:h.tickformatstops,layer:h.layer},"plot","from-root"),a={visible:u({},h.visible,{dflt:!0}),type:u({},h.type,{values:["-","linear","log","date","category"]}),autotypenumbers:h.autotypenumbers,autorange:u({},h.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:u({},h.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:h.categoryorder,categoryarray:h.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:u({},h.title.text,{editType:"plot",dflt:""}),font:u({},h.title.font,{editType:"plot"}),editType:"plot"},hoverformat:h.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:h._deprecated.title,titlefont:h._deprecated.titlefont}};u(a,l,o);var n={visible:u({},h.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:h.autotypenumbers,categoryorder:h.categoryorder,categoryarray:h.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:h.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};u(n,l,o),B.exports={domain:p({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:t.background},radialaxis:a,angularaxis:n,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":665,"../../lib":803,"../../plot_api/edit_types":836,"../cartesian/layout_attributes":869,"../domain":882}],922:[function(i,B,V){var t=i("../../lib"),h=i("../../components/color"),p=i("../../plot_api/plot_template"),u=i("../subplot_defaults"),e=i("../get_data").getSubplotData,l=i("../cartesian/tick_value_defaults"),o=i("../cartesian/tick_mark_defaults"),a=i("../cartesian/tick_label_defaults"),n=i("../cartesian/category_order_defaults"),s=i("../cartesian/line_grid_defaults"),r=i("../cartesian/axis_autotype"),c=i("./layout_attributes"),f=i("./set_convert"),d=i("./constants"),g=d.axisNames;function m(v,T,_,k){var E=_("bgcolor");k.bgColor=h.combine(E,k.paper_bgcolor);var A=_("sector");_("hole");var b,L=e(k.fullData,d.name,k.id),w=k.layoutOut;function C(J,D){return _(b+"."+J,D)}for(var S=0;S<g.length;S++){b=g[S],t.isPlainObject(v[b])||(v[b]={});var P=v[b],z=p.newContainer(T,b);z._id=z._name=b,z._attr=k.id+"."+b,z._traceIndices=L.map(function(J){return J._expandedIndex});var F=d.axisName2dataArray[b],q=y(P,z,C,L,F,k);n(P,z,C,{axData:L,dataAttr:F});var W,X,Q=C("visible");switch(f(z,T,w),C("uirevision",T.uirevision),Q&&(X=(W=C("color"))===P.color?W:k.font.color),z._m=1,b){case"radialaxis":var Z=C("autorange",!z.isValidRange(P.range));P.autorange=Z,!Z||q!=="linear"&&q!=="-"||C("rangemode"),Z==="reversed"&&(z._m=-1),C("range"),z.cleanRange("range",{dfltRange:[0,1]}),Q&&(C("side"),C("angle",A[0]),C("title.text"),t.coerceFont(C,"title.font",{family:k.font.family,size:t.bigFont(k.font.size),color:X}));break;case"angularaxis":if(q==="date"){t.log("Polar plots do not support date angular axes yet.");for(var Y=0;Y<L.length;Y++)L[Y].visible=!1;q=P.type=z.type="linear"}C(q==="linear"?"thetaunit":"period");var N=C("direction");C("rotation",{counterclockwise:0,clockwise:90}[N])}Q&&(l(P,z,C,z.type),a(P,z,C,z.type,{tickSuffixDflt:z.thetaunit==="degrees"?"°":void 0}),o(P,z,C,{outerTicks:!0}),C("showticklabels")&&(t.coerceFont(C,"tickfont",{family:k.font.family,size:k.font.size,color:X}),C("tickangle"),C("tickformat")),s(P,z,C,{dfltColor:W,bgColor:k.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:c[b]}),C("layer")),q!=="category"&&C("hoverformat"),z._input=P}T.angularaxis.type==="category"&&_("gridshape")}function y(v,T,_,k,E,A){var b=_("autotypenumbers",A.autotypenumbersDflt);if(_("type")==="-"){for(var L,w=0;w<k.length;w++)if(k[w].visible){L=k[w];break}L&&L[E]&&(T.type=r(L[E],"gregorian",{noMultiCategory:!0,autotypenumbers:b})),T.type==="-"?T.type="linear":v.type=T.type}return T.type}B.exports=function(v,T,_){u(v,T,_,{type:d.name,attributes:c,handleDefaults:m,font:T.font,autotypenumbersDflt:T.autotypenumbers,paper_bgcolor:T.paper_bgcolor,fullData:_,layoutOut:T})}},{"../../components/color":666,"../../lib":803,"../../plot_api/plot_template":843,"../cartesian/axis_autotype":855,"../cartesian/category_order_defaults":859,"../cartesian/line_grid_defaults":871,"../cartesian/tick_label_defaults":876,"../cartesian/tick_mark_defaults":877,"../cartesian/tick_value_defaults":878,"../get_data":891,"../subplot_defaults":925,"./constants":918,"./layout_attributes":921,"./set_convert":924}],923:[function(i,B,V){var t=i("@plotly/d3"),h=i("tinycolor2"),p=i("../../registry"),u=i("../../lib"),e=u.strRotate,l=u.strTranslate,o=i("../../components/color"),a=i("../../components/drawing"),n=i("../plots"),s=i("../../plots/cartesian/axes"),r=i("../cartesian/set_convert"),c=i("./set_convert"),f=i("../cartesian/autorange").doAutoRange,d=i("../cartesian/dragbox"),g=i("../../components/dragelement"),m=i("../../components/fx"),y=i("../../components/titles"),v=i("../cartesian/select").prepSelect,T=i("../cartesian/select").selectOnClick,_=i("../cartesian/select").clearSelect,k=i("../../lib/setcursor"),E=i("../../lib/clear_gl_canvases"),A=i("../../plot_api/subroutines").redrawReglTraces,b=i("../../constants/alignment").MID_SHIFT,L=i("./constants"),w=i("./helpers"),C=u._,S=u.mod,P=u.deg2rad,z=u.rad2deg;function F(Z,Y){this.id=Y,this.gd=Z,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var N=Z._fullLayout,J="clip"+N._uid+Y;this.clipIds.forTraces=J+"-for-traces",this.clipPaths.forTraces=N._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=N._polarlayer.append("g").attr("class",Y),this.radialTickLayout=null,this.angularTickLayout=null}var q=F.prototype;function W(Z){var Y=Z.ticks+String(Z.ticklen)+String(Z.showticklabels);return"side"in Z&&(Y+=Z.side),Y}function X(Z,Y){return Y[u.findIndexOfMin(Y,function(N){return u.angleDist(Z,N)})]}function Q(Z,Y,N){return Y?(Z.attr("display",null),Z.attr(N)):Z&&Z.attr("display","none"),Z}B.exports=function(Z,Y){return new F(Z,Y)},q.plot=function(Z,Y){var N=Y[this.id];this._hasClipOnAxisFalse=!1;for(var J=0;J<Z.length;J++)if(Z[J][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(Y,N),this.updateLayout(Y,N),n.generalUpdatePerTraceModule(this.gd,this,Z,N),this.updateFx(Y,N)},q.updateLayers=function(Z,Y){var N=this.layers,J=Y.radialaxis,D=Y.angularaxis,U=L.layerNames,G=U.indexOf("frontplot"),$=U.slice(0,G),K=D.layer==="below traces",re=J.layer==="below traces";K&&$.push("angular-line"),re&&$.push("radial-line"),K&&$.push("angular-axis"),re&&$.push("radial-axis"),$.push("frontplot"),K||$.push("angular-line"),re||$.push("radial-line"),K||$.push("angular-axis"),re||$.push("radial-axis");var ne=this.framework.selectAll(".polarsublayer").data($,String);ne.enter().append("g").attr("class",function(ae){return"polarsublayer "+ae}).each(function(ae){var ie=N[ae]=t.select(this);switch(ae){case"frontplot":ie.append("g").classed("barlayer",!0),ie.append("g").classed("scatterlayer",!0);break;case"backplot":ie.append("g").classed("maplayer",!0);break;case"plotbg":N.bg=ie.append("path");break;case"radial-grid":case"angular-grid":ie.style("fill","none");break;case"radial-line":ie.append("line").style("fill","none");break;case"angular-line":ie.append("path").style("fill","none")}}),ne.order()},q.updateLayout=function(Z,Y){var N=this.layers,J=Z._size,D=Y.radialaxis,U=Y.angularaxis,G=Y.domain.x,$=Y.domain.y;this.xOffset=J.l+J.w*G[0],this.yOffset=J.t+J.h*(1-$[1]);var K=this.xLength=J.w*(G[1]-G[0]),re=this.yLength=J.h*($[1]-$[0]),ne=Y.sector;this.sectorInRad=ne.map(P);var ae,ie,he,se,de,ce=this.sectorBBox=function(Qe){var Oe,Ue,Xe,Ye,$e=Qe[0],it=Qe[1]-$e,ot=S($e,360),Et=ot+it,mt=Math.cos(P(ot)),tt=Math.sin(P(ot)),Ke=Math.cos(P(Et)),Mt=Math.sin(P(Et));return Ye=ot<=90&&Et>=90||ot>90&&Et>=450?1:tt<=0&&Mt<=0?0:Math.max(tt,Mt),Oe=ot<=180&&Et>=180||ot>180&&Et>=540?-1:mt>=0&&Ke>=0?0:Math.min(mt,Ke),Ue=ot<=270&&Et>=270||ot>270&&Et>=630?-1:tt>=0&&Mt>=0?0:Math.min(tt,Mt),Xe=Et>=360?1:mt<=0&&Ke<=0?0:Math.max(mt,Ke),[Oe,Ue,Xe,Ye]}(ne),ve=ce[2]-ce[0],Ee=ce[3]-ce[1],Le=re/K,Te=Math.abs(Ee/ve);Le>Te?(ae=K,de=(re-(ie=K*Te))/J.h/2,he=[G[0],G[1]],se=[$[0]+de,$[1]-de]):(ie=re,de=(K-(ae=re/Te))/J.w/2,he=[G[0]+de,G[1]-de],se=[$[0],$[1]]),this.xLength2=ae,this.yLength2=ie,this.xDomain2=he,this.yDomain2=se;var xe=this.xOffset2=J.l+J.w*he[0],fe=this.yOffset2=J.t+J.h*(1-se[1]),ge=this.radius=ae/ve,ke=this.innerRadius=Y.hole*ge,Me=this.cx=xe-ge*ce[0],Se=this.cy=fe+ge*ce[3],De=this.cxx=Me-xe,Be=this.cyy=Se-fe;this.radialAxis=this.mockAxis(Z,Y,D,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[D.side],_realSide:D.side,domain:[ke/J.w,ge/J.w]}),this.angularAxis=this.mockAxis(Z,Y,U,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(Z,Y),this.updateAngularAxis(Z,Y),this.updateRadialAxis(Z,Y),this.updateRadialAxisTitle(Z,Y),this.xaxis=this.mockCartesianAxis(Z,Y,{_id:"x",domain:he}),this.yaxis=this.mockCartesianAxis(Z,Y,{_id:"y",domain:se});var We=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",We).attr("transform",l(De,Be)),N.frontplot.attr("transform",l(xe,fe)).call(a.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),N.bg.attr("d",We).attr("transform",l(Me,Se)).call(o.fill,Y.bgcolor)},q.mockAxis=function(Z,Y,N,J){var D=u.extendFlat({},N,J);return c(D,Y,Z),D},q.mockCartesianAxis=function(Z,Y,N){var J=this,D=N._id,U=u.extendFlat({type:"linear"},N);r(U,Z);var G={x:[0,2],y:[1,3]};return U.setRange=function(){var $=J.sectorBBox,K=G[D],re=J.radialAxis._rl,ne=(re[1]-re[0])/(1-Y.hole);U.range=[$[K[0]]*ne,$[K[1]]*ne]},U.isPtWithinRange=D==="x"?function($){return J.isPtInside($)}:function(){return!0},U.setRange(),U.setScale(),U},q.doAutoRange=function(Z,Y){var N=this.gd,J=this.radialAxis,D=Y.radialaxis;J.setScale(),f(N,J);var U=J.range;D.range=U.slice(),D._input.range=U.slice(),J._rl=[J.r2l(U[0],null,"gregorian"),J.r2l(U[1],null,"gregorian")]},q.updateRadialAxis=function(Z,Y){var N=this,J=N.gd,D=N.layers,U=N.radius,G=N.innerRadius,$=N.cx,K=N.cy,re=Y.radialaxis,ne=S(Y.sector[0],360),ae=N.radialAxis,ie=G<U;N.fillViewInitialKey("radialaxis.angle",re.angle),N.fillViewInitialKey("radialaxis.range",ae.range.slice()),ae.setGeometry(),ae.tickangle==="auto"&&ne>90&&ne<=270&&(ae.tickangle=180);var he=function(xe){return l(ae.l2p(xe.x)+G,0)},se=W(re);if(N.radialTickLayout!==se&&(D["radial-axis"].selectAll(".xtick").remove(),N.radialTickLayout=se),ie){ae.setScale();var de=s.calcTicks(ae),ce=s.clipEnds(ae,de),ve=s.getTickSigns(ae)[2];s.drawTicks(J,ae,{vals:de,layer:D["radial-axis"],path:s.makeTickPath(ae,0,ve),transFn:he,crisp:!1}),s.drawGrid(J,ae,{vals:ce,layer:D["radial-grid"],path:function(xe){return N.pathArc(ae.r2p(xe.x)+G)},transFn:u.noop,crisp:!1}),s.drawLabels(J,ae,{vals:de,layer:D["radial-axis"],transFn:he,labelFns:s.makeLabelFns(ae,0)})}var Ee=N.radialAxisAngle=N.vangles?z(X(P(re.angle),N.vangles)):re.angle,Le=l($,K),Te=Le+e(-Ee);Q(D["radial-axis"],ie&&(re.showticklabels||re.ticks),{transform:Te}),Q(D["radial-grid"],ie&&re.showgrid,{transform:Le}),Q(D["radial-line"].select("line"),ie&&re.showline,{x1:G,y1:0,x2:U,y2:0,transform:Te}).attr("stroke-width",re.linewidth).call(o.stroke,re.linecolor)},q.updateRadialAxisTitle=function(Z,Y,N){var J=this.gd,D=this.radius,U=this.cx,G=this.cy,$=Y.radialaxis,K=this.id+"title",re=N!==void 0?N:this.radialAxisAngle,ne=P(re),ae=Math.cos(ne),ie=Math.sin(ne),he=0;if($.title){var se=a.bBox(this.layers["radial-axis"].node()).height,de=$.title.font.size;he=$.side==="counterclockwise"?-se-.4*de:se+.8*de}this.layers["radial-axis-title"]=y.draw(J,K,{propContainer:$,propName:this.id+".radialaxis.title",placeholder:C(J,"Click to enter radial axis title"),attributes:{x:U+D/2*ae+he*ie,y:G-D/2*ie+he*ae,"text-anchor":"middle"},transform:{rotate:-re}})},q.updateAngularAxis=function(Z,Y){var N=this,J=N.gd,D=N.layers,U=N.radius,G=N.innerRadius,$=N.cx,K=N.cy,re=Y.angularaxis,ne=N.angularAxis;N.fillViewInitialKey("angularaxis.rotation",re.rotation),ne.setGeometry(),ne.setScale();var ae=function(Te){return ne.t2g(Te.x)};ne.type==="linear"&&ne.thetaunit==="radians"&&(ne.tick0=z(ne.tick0),ne.dtick=z(ne.dtick));var ie=function(Te){return l($+U*Math.cos(Te),K-U*Math.sin(Te))},he=s.makeLabelFns(ne,0).labelStandoff,se={xFn:function(Te){var xe=ae(Te);return Math.cos(xe)*he},yFn:function(Te){var xe=ae(Te),fe=Math.sin(xe)>0?.2:1;return-Math.sin(xe)*(he+Te.fontSize*fe)+Math.abs(Math.cos(xe))*(Te.fontSize*b)},anchorFn:function(Te){var xe=ae(Te),fe=Math.cos(xe);return Math.abs(fe)<.1?"middle":fe>0?"start":"end"},heightFn:function(Te,xe,fe){var ge=ae(Te);return-.5*(1+Math.sin(ge))*fe}},de=W(re);N.angularTickLayout!==de&&(D["angular-axis"].selectAll("."+ne._id+"tick").remove(),N.angularTickLayout=de);var ce,ve=s.calcTicks(ne);if(Y.gridshape==="linear"?(ce=ve.map(ae),u.angleDelta(ce[0],ce[1])<0&&(ce=ce.slice().reverse())):ce=null,N.vangles=ce,ne.type==="category"&&(ve=ve.filter(function(Te){return u.isAngleInsideSector(ae(Te),N.sectorInRad)})),ne.visible){var Ee=ne.ticks==="inside"?-1:1,Le=(ne.linewidth||1)/2;s.drawTicks(J,ne,{vals:ve,layer:D["angular-axis"],path:"M"+Ee*Le+",0h"+Ee*ne.ticklen,transFn:function(Te){var xe=ae(Te);return ie(xe)+e(-z(xe))},crisp:!1}),s.drawGrid(J,ne,{vals:ve,layer:D["angular-grid"],path:function(Te){var xe=ae(Te),fe=Math.cos(xe),ge=Math.sin(xe);return"M"+[$+G*fe,K-G*ge]+"L"+[$+U*fe,K-U*ge]},transFn:u.noop,crisp:!1}),s.drawLabels(J,ne,{vals:ve,layer:D["angular-axis"],repositionOnUpdate:!0,transFn:function(Te){return ie(ae(Te))},labelFns:se})}Q(D["angular-line"].select("path"),re.showline,{d:N.pathSubplot(),transform:l($,K)}).attr("stroke-width",re.linewidth).call(o.stroke,re.linecolor)},q.updateFx=function(Z,Y){this.gd._context.staticPlot||(this.updateAngularDrag(Z),this.updateRadialDrag(Z,Y,0),this.updateRadialDrag(Z,Y,1),this.updateMainDrag(Z))},q.updateMainDrag=function(Z){var Y,N,J=this,D=J.gd,U=J.layers,G=Z._zoomlayer,$=L.MINZOOM,K=L.OFFEDGE,re=J.radius,ne=J.innerRadius,ae=J.cx,ie=J.cy,he=J.cxx,se=J.cyy,de=J.sectorInRad,ce=J.vangles,ve=J.radialAxis,Ee=w.clampTiny,Le=w.findXYatLength,Te=w.findEnclosingVertexAngles,xe=L.cornerHalfWidth,fe=L.cornerLen/2,ge=d.makeDragger(U,"path","maindrag","crosshair");t.select(ge).attr("d",J.pathSubplot()).attr("transform",l(ae,ie));var ke,Me,Se,De,Be,We,Qe,Oe,Ue,Xe={element:ge,gd:D,subplot:J.id,plotinfo:{id:J.id,xaxis:J.xaxis,yaxis:J.yaxis},xaxes:[J.xaxis],yaxes:[J.yaxis]};function Ye(Ie,be){return Math.sqrt(Ie*Ie+be*be)}function $e(Ie,be){return Ye(Ie-he,be-se)}function it(Ie,be){return Math.atan2(se-be,Ie-he)}function ot(Ie,be){return[Ie*Math.cos(be),Ie*Math.sin(-be)]}function Et(Ie,be){if(Ie===0)return J.pathSector(2*xe);var Ae=fe/Ie,Pe=be-Ae,ze=be+Ae,qe=Math.max(0,Math.min(Ie,re)),ht=qe-xe,at=qe+xe;return"M"+ot(ht,Pe)+"A"+[ht,ht]+" 0,0,0 "+ot(ht,ze)+"L"+ot(at,ze)+"A"+[at,at]+" 0,0,1 "+ot(at,Pe)+"Z"}function mt(Ie,be,Ae){if(Ie===0)return J.pathSector(2*xe);var Pe,ze,qe=ot(Ie,be),ht=ot(Ie,Ae),at=Ee((qe[0]+ht[0])/2),nt=Ee((qe[1]+ht[1])/2);if(at&&nt){var xt=nt/at,Lt=-1/xt,bt=Le(xe,xt,at,nt);Pe=Le(fe,Lt,bt[0][0],bt[0][1]),ze=Le(fe,Lt,bt[1][0],bt[1][1])}else{var St,st;nt?(St=fe,st=xe):(St=xe,st=fe),Pe=[[at-St,nt-st],[at+St,nt-st]],ze=[[at-St,nt+st],[at+St,nt+st]]}return"M"+Pe.join("L")+"L"+ze.reverse().join("L")+"Z"}function tt(Ie,be){return be=Math.max(Math.min(be,re),ne),Ie<K?Ie=0:re-Ie<K?Ie=re:be<K?be=0:re-be<K&&(be=re),Math.abs(be-Ie)>$?(Ie<be?(Se=Ie,De=be):(Se=be,De=Ie),!0):(Se=null,De=null,!1)}function Ke(Ie,be){Ie=Ie||Be,be=be||"M0,0Z",Oe.attr("d",Ie),Ue.attr("d",be),d.transitionZoombox(Oe,Ue,We,Qe),We=!0;var Ae={};Ge(Ae),D.emit("plotly_relayouting",Ae)}function Mt(Ie,be){var Ae,Pe,ze=ke+(Ie*=Y),qe=Me+(be*=N),ht=$e(ke,Me),at=Math.min($e(ze,qe),re),nt=it(ke,Me);tt(ht,at)&&(Ae=Be+J.pathSector(De),Se&&(Ae+=J.pathSector(Se)),Pe=Et(Se,nt)+Et(De,nt)),Ke(Ae,Pe)}function Jt(Ie,be,Ae,Pe){var ze=w.findIntersectionXY(Ae,Pe,Ae,[Ie-he,se-be]);return Ye(ze[0],ze[1])}function $t(Ie,be){var Ae,Pe,ze=ke+Ie,qe=Me+be,ht=it(ke,Me),at=it(ze,qe),nt=Te(ht,ce),xt=Te(at,ce);tt(Jt(ke,Me,nt[0],nt[1]),Math.min(Jt(ze,qe,xt[0],xt[1]),re))&&(Ae=Be+J.pathSector(De),Se&&(Ae+=J.pathSector(Se)),Pe=[mt(Se,nt[0],nt[1]),mt(De,nt[0],nt[1])].join(" ")),Ke(Ae,Pe)}function je(){if(d.removeZoombox(D),Se!==null&&De!==null){var Ie={};Ge(Ie),d.showDoubleClickNotifier(D),p.call("_guiRelayout",D,Ie)}}function Ge(Ie){var be=ve._rl,Ae=(be[1]-be[0])/(1-ne/re)/re,Pe=[be[0]+(Se-ne)*Ae,be[0]+(De-ne)*Ae];Ie[J.id+".radialaxis.range"]=Pe}function Ct(Ie,be){var Ae=D._fullLayout.clickmode;if(d.removeZoombox(D),Ie===2){var Pe={};for(var ze in J.viewInitial)Pe[J.id+"."+ze]=J.viewInitial[ze];D.emit("plotly_doubleclick",null),p.call("_guiRelayout",D,Pe)}Ae.indexOf("select")>-1&&Ie===1&&T(be,D,[J.xaxis],[J.yaxis],J.id,Xe),Ae.indexOf("event")>-1&&m.click(D,be,J.id)}Xe.prepFn=function(Ie,be,Ae){var Pe=D._fullLayout.dragmode,ze=ge.getBoundingClientRect();D._fullLayout._calcInverseTransform(D);var qe=D._fullLayout._invTransform;Y=D._fullLayout._invScaleX,N=D._fullLayout._invScaleY;var ht=u.apply3DTransform(qe)(be-ze.left,Ae-ze.top);if(ke=ht[0],Me=ht[1],ce){var at=w.findPolygonOffset(re,de[0],de[1],ce);ke+=he+at[0],Me+=se+at[1]}switch(Pe){case"zoom":Xe.moveFn=ce?$t:Mt,Xe.clickFn=Ct,Xe.doneFn=je,function(){Se=null,De=null,Be=J.pathSubplot(),We=!1;var nt=D._fullLayout[J.id];Qe=h(nt.bgcolor).getLuminance(),(Oe=d.makeZoombox(G,Qe,ae,ie,Be)).attr("fill-rule","evenodd"),Ue=d.makeCorners(G,ae,ie),_(D)}();break;case"select":case"lasso":v(Ie,be,Ae,Xe,Pe)}},ge.onmousemove=function(Ie){m.hover(D,Ie,J.id),D._fullLayout._lasthover=ge,D._fullLayout._hoversubplot=J.id},ge.onmouseout=function(Ie){D._dragging||g.unhover(D,Ie)},g.init(Xe)},q.updateRadialDrag=function(Z,Y,N){var J=this,D=J.gd,U=J.layers,G=J.radius,$=J.innerRadius,K=J.cx,re=J.cy,ne=J.radialAxis,ae=L.radialDragBoxSize,ie=ae/2;if(ne.visible){var he,se,de,ce=P(J.radialAxisAngle),ve=ne._rl,Ee=ve[0],Le=ve[1],Te=ve[N],xe=.75*(ve[1]-ve[0])/(1-Y.hole)/G;N?(he=K+(G+ie)*Math.cos(ce),se=re-(G+ie)*Math.sin(ce),de="radialdrag"):(he=K+($-ie)*Math.cos(ce),se=re-($-ie)*Math.sin(ce),de="radialdrag-inner");var fe,ge,ke,Me=d.makeRectDragger(U,de,"crosshair",-ie,-ie,ae,ae),Se={element:Me,gd:D};Q(t.select(Me),ne.visible&&$<G,{transform:l(he,se)}),Se.prepFn=function(){fe=null,ge=null,ke=null,Se.moveFn=De,Se.doneFn=Be,_(D)},Se.clampFn=function(Oe,Ue){return Math.sqrt(Oe*Oe+Ue*Ue)<L.MINDRAG&&(Oe=0,Ue=0),[Oe,Ue]},g.init(Se)}function De(Oe,Ue){if(fe)fe(Oe,Ue);else{var Xe=[Oe,-Ue],Ye=[Math.cos(ce),Math.sin(ce)],$e=Math.abs(u.dot(Xe,Ye)/Math.sqrt(u.dot(Xe,Xe)));isNaN($e)||(fe=$e<.5?We:Qe)}var it={};(function(ot){ge!==null?ot[J.id+".radialaxis.angle"]=ge:ke!==null&&(ot[J.id+".radialaxis.range["+N+"]"]=ke)})(it),D.emit("plotly_relayouting",it)}function Be(){ge!==null?p.call("_guiRelayout",D,J.id+".radialaxis.angle",ge):ke!==null&&p.call("_guiRelayout",D,J.id+".radialaxis.range["+N+"]",ke)}function We(Oe,Ue){if(N!==0){var Xe=he+Oe,Ye=se+Ue;ge=Math.atan2(re-Ye,Xe-K),J.vangles&&(ge=X(ge,J.vangles)),ge=z(ge);var $e=l(K,re)+e(-ge);U["radial-axis"].attr("transform",$e),U["radial-line"].select("line").attr("transform",$e);var it=J.gd._fullLayout,ot=it[J.id];J.updateRadialAxisTitle(it,ot,ge)}}function Qe(Oe,Ue){var Xe=u.dot([Oe,-Ue],[Math.cos(ce),Math.sin(ce)]);if(ke=Te-xe*Xe,xe>0==(N?ke>Ee:ke<Le)){var Ye=D._fullLayout,$e=Ye[J.id];ne.range[N]=ke,ne._rl[N]=ke,J.updateRadialAxis(Ye,$e),J.xaxis.setRange(),J.xaxis.setScale(),J.yaxis.setRange(),J.yaxis.setScale();var it=!1;for(var ot in J.traceHash){var Et=J.traceHash[ot],mt=u.filterVisible(Et);Et[0][0].trace._module.plot(D,J,mt,$e),p.traceIs(ot,"gl")&&mt.length&&(it=!0)}it&&(E(D),A(D))}else ke=null}},q.updateAngularDrag=function(Z){var Y=this,N=Y.gd,J=Y.layers,D=Y.radius,U=Y.angularAxis,G=Y.cx,$=Y.cy,K=Y.cxx,re=Y.cyy,ne=L.angularDragBoxSize,ae=d.makeDragger(J,"path","angulardrag","move"),ie={element:ae,gd:N};function he(Se,De){return Math.atan2(re+ne-De,Se-K-ne)}t.select(ae).attr("d",Y.pathAnnulus(D,D+ne)).attr("transform",l(G,$)).call(k,"move");var se,de,ce,ve,Ee,Le,Te=J.frontplot.select(".scatterlayer").selectAll(".trace"),xe=Te.selectAll(".point"),fe=Te.selectAll(".textpoint");function ge(Se,De){var Be=Y.gd._fullLayout,We=Be[Y.id],Qe=he(se+Se*Z._invScaleX,de+De*Z._invScaleY),Oe=z(Qe-Le);if(ve=ce+Oe,J.frontplot.attr("transform",l(Y.xOffset2,Y.yOffset2)+e([-Oe,K,re])),Y.vangles){Ee=Y.radialAxisAngle+Oe;var Ue=l(G,$)+e(-Oe),Xe=l(G,$)+e(-Ee);J.bg.attr("transform",Ue),J["radial-grid"].attr("transform",Ue),J["radial-axis"].attr("transform",Xe),J["radial-line"].select("line").attr("transform",Xe),Y.updateRadialAxisTitle(Be,We,Ee)}else Y.clipPaths.forTraces.select("path").attr("transform",l(K,re)+e(Oe));xe.each(function(){var mt=t.select(this),tt=a.getTranslate(mt);mt.attr("transform",l(tt.x,tt.y)+e([Oe]))}),fe.each(function(){var mt=t.select(this),tt=mt.select("text"),Ke=a.getTranslate(mt);mt.attr("transform",e([Oe,tt.attr("x"),tt.attr("y")])+l(Ke.x,Ke.y))}),U.rotation=u.modHalf(ve,360),Y.updateAngularAxis(Be,We),Y._hasClipOnAxisFalse&&!u.isFullCircle(Y.sectorInRad)&&Te.call(a.hideOutsideRangePoints,Y);var Ye=!1;for(var $e in Y.traceHash)if(p.traceIs($e,"gl")){var it=Y.traceHash[$e],ot=u.filterVisible(it);it[0][0].trace._module.plot(N,Y,ot,We),ot.length&&(Ye=!0)}Ye&&(E(N),A(N));var Et={};ke(Et),N.emit("plotly_relayouting",Et)}function ke(Se){Se[Y.id+".angularaxis.rotation"]=ve,Y.vangles&&(Se[Y.id+".radialaxis.angle"]=Ee)}function Me(){fe.select("text").attr("transform",null);var Se={};ke(Se),p.call("_guiRelayout",N,Se)}ie.prepFn=function(Se,De,Be){var We=Z[Y.id];ce=We.angularaxis.rotation;var Qe=ae.getBoundingClientRect();se=De-Qe.left,de=Be-Qe.top,N._fullLayout._calcInverseTransform(N);var Oe=u.apply3DTransform(Z._invTransform)(se,de);se=Oe[0],de=Oe[1],Le=he(se,de),ie.moveFn=ge,ie.doneFn=Me,_(N)},Y.vangles&&!u.isFullCircle(Y.sectorInRad)&&(ie.prepFn=u.noop,k(t.select(ae),null)),g.init(ie)},q.isPtInside=function(Z){var Y=this.sectorInRad,N=this.vangles,J=this.angularAxis.c2g(Z.theta),D=this.radialAxis,U=D.c2l(Z.r),G=D._rl;return(N?w.isPtInsidePolygon:u.isPtInsideSector)(U,J,G,Y,N)},q.pathArc=function(Z){var Y=this.sectorInRad,N=this.vangles;return(N?w.pathPolygon:u.pathArc)(Z,Y[0],Y[1],N)},q.pathSector=function(Z){var Y=this.sectorInRad,N=this.vangles;return(N?w.pathPolygon:u.pathSector)(Z,Y[0],Y[1],N)},q.pathAnnulus=function(Z,Y){var N=this.sectorInRad,J=this.vangles;return(J?w.pathPolygonAnnulus:u.pathAnnulus)(Z,Y,N[0],N[1],J)},q.pathSubplot=function(){var Z=this.innerRadius,Y=this.radius;return Z?this.pathAnnulus(Z,Y):this.pathSector(Y)},q.fillViewInitialKey=function(Z,Y){Z in this.viewInitial||(this.viewInitial[Z]=Y)}},{"../../components/color":666,"../../components/dragelement":685,"../../components/drawing":688,"../../components/fx":706,"../../components/titles":764,"../../constants/alignment":771,"../../lib":803,"../../lib/clear_gl_canvases":787,"../../lib/setcursor":824,"../../plot_api/subroutines":844,"../../plots/cartesian/axes":854,"../../registry":931,"../cartesian/autorange":853,"../cartesian/dragbox":863,"../cartesian/select":874,"../cartesian/set_convert":875,"../plots":917,"./constants":918,"./helpers":919,"./set_convert":924,"@plotly/d3":58,tinycolor2:598}],924:[function(i,B,V){var t=i("../../lib"),h=i("../cartesian/set_convert"),p=t.deg2rad,u=t.rad2deg;B.exports=function(e,l,o){switch(h(e,o),e._id){case"x":case"radialaxis":(function(a,n){var s=n._subplot;a.setGeometry=function(){var r=a._rl[0],c=a._rl[1],f=s.innerRadius,d=(s.radius-f)/(c-r),g=f/d,m=r>c?function(y){return y<=0}:function(y){return y>=0};a.c2g=function(y){var v=a.c2l(y)-r;return(m(v)?v:0)+g},a.g2c=function(y){return a.l2c(y+r-g)},a.g2p=function(y){return y*d},a.c2p=function(y){return a.g2p(a.c2g(y))}}})(e,l);break;case"angularaxis":(function(a,n){var s=a.type;if(s==="linear"){var r=a.d2c,c=a.c2d;a.d2c=function(f,d){return function(g,m){return m==="degrees"?p(g):g}(r(f),d)},a.c2d=function(f,d){return c(function(g,m){return m==="degrees"?u(g):g}(f,d))}}a.makeCalcdata=function(f,d){var g,m,y=f[d],v=f._length,T=function(b){return a.d2c(b,f.thetaunit)};if(y){if(t.isTypedArray(y)&&s==="linear"){if(v===y.length)return y;if(y.subarray)return y.subarray(0,v)}for(g=new Array(v),m=0;m<v;m++)g[m]=T(y[m])}else{var _=d+"0",k="d"+d,E=_ in f?T(f[_]):0,A=f[k]?T(f[k]):(a.period||2*Math.PI)/v;for(g=new Array(v),m=0;m<v;m++)g[m]=E+m*A}return g},a.setGeometry=function(){var f,d,g,m,y=n.sector,v=y.map(p),T={clockwise:-1,counterclockwise:1}[a.direction],_=p(a.rotation),k=function(L){return T*L+_},E=function(L){return(L-_)/T};switch(s){case"linear":d=f=t.identity,m=p,g=u,a.range=t.isFullCircle(v)?[y[0],y[0]+360]:v.map(E).map(u);break;case"category":var A=a._categories.length,b=a.period?Math.max(a.period,A):A;b===0&&(b=1),d=m=function(L){return 2*L*Math.PI/b},f=g=function(L){return L*b/Math.PI/2},a.range=[0,b]}a.c2g=function(L){return k(d(L))},a.g2c=function(L){return f(E(L))},a.t2g=function(L){return k(m(L))},a.g2t=function(L){return g(E(L))}}})(e,l)}}},{"../../lib":803,"../cartesian/set_convert":875}],925:[function(i,B,V){var t=i("../lib"),h=i("../plot_api/plot_template"),p=i("./domain").defaults;B.exports=function(u,e,l,o){var a,n,s=o.type,r=o.attributes,c=o.handleDefaults,f=o.partition||"x",d=e._subplots[s],g=d.length,m=g&&d[0].replace(/\d+$/,"");function y(k,E){return t.coerce(a,n,r,k,E)}for(var v=0;v<g;v++){var T=d[v];a=u[T]?u[T]:u[T]={},n=h.newContainer(e,T,m),y("uirevision",e.uirevision);var _={};_[f]=[v/g,(v+1)/g],p(n,e,y,_),o.id=T,c(a,n,y,o)}}},{"../lib":803,"../plot_api/plot_template":843,"./domain":882}],926:[function(i,B,V){var t=i("../constants/docs");t.FORMAT_LINK,t.DATE_FORMAT_LINK;function h(p){var u=p.description?" "+p.description:"",e=p.keys||[];if(e.length>0){for(var l=[],o=0;o<e.length;o++)l[o]="`"+e[o]+"`";u+="Finally, the template string has access to ",u=e.length===1?"variable "+l[0]:"variables "+l.slice(0,-1).join(", ")+" and "+l.slice(-1)+"."}return u}V.hovertemplateAttrs=function(p,u){p=p||{},h(u=u||{});var e={valType:"string",dflt:"",editType:p.editType||"none"};return p.arrayOk!==!1&&(e.arrayOk=!0),e},V.texttemplateAttrs=function(p,u){p=p||{},h(u=u||{});var e={valType:"string",dflt:"",editType:p.editType||"calc"};return p.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":774}],927:[function(i,B,V){var t=i("./ternary"),h=i("../../plots/get_data").getSubplotCalcData,p=i("../../lib").counterRegex;V.name="ternary";var u=V.attr="subplot";V.idRoot="ternary",V.idRegex=V.attrRegex=p("ternary"),(V.attributes={})[u]={valType:"subplotid",dflt:"ternary",editType:"calc"},V.layoutAttributes=i("./layout_attributes"),V.supplyLayoutDefaults=i("./layout_defaults"),V.plot=function(e){for(var l=e._fullLayout,o=e.calcdata,a=l._subplots.ternary,n=0;n<a.length;n++){var s=a[n],r=h(o,"ternary",s),c=l[s]._subplot;c||(c=new t({id:s,graphDiv:e,container:l._ternarylayer.node()},l),l[s]._subplot=c),c.plot(r,l,e._promises)}},V.clean=function(e,l,o,a){for(var n=a._subplots.ternary||[],s=0;s<n.length;s++){var r=n[s],c=a[r]._subplot;!l[r]&&c&&(c.plotContainer.remove(),c.clipDef.remove(),c.clipDefRelative.remove(),c.layers["a-title"].remove(),c.layers["b-title"].remove(),c.layers["c-title"].remove())}}},{"../../lib":803,"../../plots/get_data":891,"./layout_attributes":928,"./layout_defaults":929,"./ternary":930}],928:[function(i,B,V){var t=i("../../components/color/attributes"),h=i("../domain").attributes,p=i("../cartesian/layout_attributes"),u=i("../../plot_api/edit_types").overrideAll,e=i("../../lib/extend").extendFlat,l={title:{text:p.title.text,font:p.title.font},color:p.color,tickmode:p.tickmode,nticks:e({},p.nticks,{dflt:6,min:1}),tick0:p.tick0,dtick:p.dtick,tickvals:p.tickvals,ticktext:p.ticktext,ticks:p.ticks,ticklen:p.ticklen,tickwidth:p.tickwidth,tickcolor:p.tickcolor,showticklabels:p.showticklabels,showtickprefix:p.showtickprefix,tickprefix:p.tickprefix,showticksuffix:p.showticksuffix,ticksuffix:p.ticksuffix,showexponent:p.showexponent,exponentformat:p.exponentformat,minexponent:p.minexponent,separatethousands:p.separatethousands,tickfont:p.tickfont,tickangle:p.tickangle,tickformat:p.tickformat,tickformatstops:p.tickformatstops,hoverformat:p.hoverformat,showline:e({},p.showline,{dflt:!0}),linecolor:p.linecolor,linewidth:p.linewidth,showgrid:e({},p.showgrid,{dflt:!0}),gridcolor:p.gridcolor,gridwidth:p.gridwidth,layer:p.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:p._deprecated.title,titlefont:p._deprecated.titlefont}},o=B.exports=u({domain:h({name:"ternary"}),bgcolor:{valType:"color",dflt:t.background},sum:{valType:"number",dflt:1,min:0},aaxis:l,baxis:l,caxis:l},"plot","from-root");o.uirevision={valType:"any",editType:"none"},o.aaxis.uirevision=o.baxis.uirevision=o.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":665,"../../lib/extend":793,"../../plot_api/edit_types":836,"../cartesian/layout_attributes":869,"../domain":882}],929:[function(i,B,V){var t=i("../../components/color"),h=i("../../plot_api/plot_template"),p=i("../../lib"),u=i("../subplot_defaults"),e=i("../cartesian/tick_label_defaults"),l=i("../cartesian/tick_mark_defaults"),o=i("../cartesian/tick_value_defaults"),a=i("../cartesian/line_grid_defaults"),n=i("./layout_attributes"),s=["aaxis","baxis","caxis"];function r(f,d,g,m){var y,v,T,_=g("bgcolor"),k=g("sum");m.bgColor=t.combine(_,m.paper_bgcolor);for(var E=0;E<s.length;E++)v=f[y=s[E]]||{},(T=h.newContainer(d,y))._name=y,c(v,T,m,d);var A=d.aaxis,b=d.baxis,L=d.caxis;A.min+b.min+L.min>=k&&(A.min=0,b.min=0,L.min=0,f.aaxis&&delete f.aaxis.min,f.baxis&&delete f.baxis.min,f.caxis&&delete f.caxis.min)}function c(f,d,g,m){var y=n[d._name];function v(b,L){return p.coerce(f,d,y,b,L)}v("uirevision",m.uirevision),d.type="linear";var T=v("color"),_=T!==y.color.dflt?T:g.font.color,k=d._name.charAt(0).toUpperCase(),E="Component "+k,A=v("title.text",E);d._hovertitle=A===E?A:k,p.coerceFont(v,"title.font",{family:g.font.family,size:p.bigFont(g.font.size),color:_}),v("min"),o(f,d,v,"linear"),e(f,d,v,"linear",{}),l(f,d,v,{outerTicks:!0}),v("showticklabels")&&(p.coerceFont(v,"tickfont",{family:g.font.family,size:g.font.size,color:_}),v("tickangle"),v("tickformat")),a(f,d,v,{dfltColor:T,bgColor:g.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:y}),v("hoverformat"),v("layer")}B.exports=function(f,d,g){u(f,d,g,{type:"ternary",attributes:n,handleDefaults:r,font:d.font,paper_bgcolor:d.paper_bgcolor})}},{"../../components/color":666,"../../lib":803,"../../plot_api/plot_template":843,"../cartesian/line_grid_defaults":871,"../cartesian/tick_label_defaults":876,"../cartesian/tick_mark_defaults":877,"../cartesian/tick_value_defaults":878,"../subplot_defaults":925,"./layout_attributes":928}],930:[function(i,B,V){var t=i("@plotly/d3"),h=i("tinycolor2"),p=i("../../registry"),u=i("../../lib"),e=u.strTranslate,l=u._,o=i("../../components/color"),a=i("../../components/drawing"),n=i("../cartesian/set_convert"),s=i("../../lib/extend").extendFlat,r=i("../plots"),c=i("../cartesian/axes"),f=i("../../components/dragelement"),d=i("../../components/fx"),g=i("../../components/dragelement/helpers"),m=g.freeMode,y=g.rectMode,v=i("../../components/titles"),T=i("../cartesian/select").prepSelect,_=i("../cartesian/select").selectOnClick,k=i("../cartesian/select").clearSelect,E=i("../cartesian/select").clearSelectionsCache,A=i("../cartesian/constants");function b(W,X){this.id=W.id,this.graphDiv=W.graphDiv,this.init(X),this.makeFramework(X),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}B.exports=b;var L=b.prototype;L.init=function(W){this.container=W._ternarylayer,this.defs=W._defs,this.layoutId=W._uid,this.traceHash={},this.layers={}},L.plot=function(W,X){var Q=X[this.id],Z=X._size;this._hasClipOnAxisFalse=!1;for(var Y=0;Y<W.length;Y++)if(W[Y][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(Q),this.adjustLayout(Q,Z),r.generalUpdatePerTraceModule(this.graphDiv,this,W,Q),this.layers.plotbg.select("path").call(o.fill,Q.bgcolor)},L.makeFramework=function(W){var X=this.graphDiv,Q=W[this.id],Z=this.clipId="clip"+this.layoutId+this.id,Y=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=u.ensureSingleById(W._clips,"clipPath",Z,function(N){N.append("path").attr("d","M0,0Z")}),this.clipDefRelative=u.ensureSingleById(W._clips,"clipPath",Y,function(N){N.append("path").attr("d","M0,0Z")}),this.plotContainer=u.ensureSingle(this.container,"g",this.id),this.updateLayers(Q),a.setClipUrl(this.layers.backplot,Z,X),a.setClipUrl(this.layers.grids,Z,X)},L.updateLayers=function(W){var X=this.layers,Q=["draglayer","plotbg","backplot","grids"];W.aaxis.layer==="below traces"&&Q.push("aaxis","aline"),W.baxis.layer==="below traces"&&Q.push("baxis","bline"),W.caxis.layer==="below traces"&&Q.push("caxis","cline"),Q.push("frontplot"),W.aaxis.layer==="above traces"&&Q.push("aaxis","aline"),W.baxis.layer==="above traces"&&Q.push("baxis","bline"),W.caxis.layer==="above traces"&&Q.push("caxis","cline");var Z=this.plotContainer.selectAll("g.toplevel").data(Q,String),Y=["agrid","bgrid","cgrid"];Z.enter().append("g").attr("class",function(N){return"toplevel "+N}).each(function(N){var J=t.select(this);X[N]=J,N==="frontplot"?J.append("g").classed("scatterlayer",!0):N==="backplot"?J.append("g").classed("maplayer",!0):N==="plotbg"?J.append("path").attr("d","M0,0Z"):N==="aline"||N==="bline"||N==="cline"?J.append("path"):N==="grids"&&Y.forEach(function(D){X[D]=J.append("g").classed("grid "+D,!0)})}),Z.order()};var w=Math.sqrt(4/3);L.adjustLayout=function(W,X){var Q,Z,Y,N,J,D,U=this,G=W.domain,$=(G.x[0]+G.x[1])/2,K=(G.y[0]+G.y[1])/2,re=G.x[1]-G.x[0],ne=G.y[1]-G.y[0],ae=re*X.w,ie=ne*X.h,he=W.sum,se=W.aaxis.min,de=W.baxis.min,ce=W.caxis.min;ae>w*ie?Y=(N=ie)*w:N=(Y=ae)/w,J=re*Y/ae,D=ne*N/ie,Q=X.l+X.w*$-Y/2,Z=X.t+X.h*(1-K)-N/2,U.x0=Q,U.y0=Z,U.w=Y,U.h=N,U.sum=he,U.xaxis={type:"linear",range:[se+2*ce-he,he-se-2*de],domain:[$-J/2,$+J/2],_id:"x"},n(U.xaxis,U.graphDiv._fullLayout),U.xaxis.setScale(),U.xaxis.isPtWithinRange=function(De){return De.a>=U.aaxis.range[0]&&De.a<=U.aaxis.range[1]&&De.b>=U.baxis.range[1]&&De.b<=U.baxis.range[0]&&De.c>=U.caxis.range[1]&&De.c<=U.caxis.range[0]},U.yaxis={type:"linear",range:[se,he-de-ce],domain:[K-D/2,K+D/2],_id:"y"},n(U.yaxis,U.graphDiv._fullLayout),U.yaxis.setScale(),U.yaxis.isPtWithinRange=function(){return!0};var ve=U.yaxis.domain[0],Ee=U.aaxis=s({},W.aaxis,{range:[se,he-de-ce],side:"left",tickangle:(+W.aaxis.tickangle||0)-30,domain:[ve,ve+D*w],anchor:"free",position:0,_id:"y",_length:Y});n(Ee,U.graphDiv._fullLayout),Ee.setScale();var Le=U.baxis=s({},W.baxis,{range:[he-se-ce,de],side:"bottom",domain:U.xaxis.domain,anchor:"free",position:0,_id:"x",_length:Y});n(Le,U.graphDiv._fullLayout),Le.setScale();var Te=U.caxis=s({},W.caxis,{range:[he-se-de,ce],side:"right",tickangle:(+W.caxis.tickangle||0)+30,domain:[ve,ve+D*w],anchor:"free",position:0,_id:"y",_length:Y});n(Te,U.graphDiv._fullLayout),Te.setScale();var xe="M"+Q+","+(Z+N)+"h"+Y+"l-"+Y/2+",-"+N+"Z";U.clipDef.select("path").attr("d",xe),U.layers.plotbg.select("path").attr("d",xe);var fe="M0,"+N+"h"+Y+"l-"+Y/2+",-"+N+"Z";U.clipDefRelative.select("path").attr("d",fe);var ge=e(Q,Z);U.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",ge),U.clipDefRelative.select("path").attr("transform",null);var ke=e(Q-Le._offset,Z+N);U.layers.baxis.attr("transform",ke),U.layers.bgrid.attr("transform",ke);var Me=e(Q+Y/2,Z)+"rotate(30)"+e(0,-Ee._offset);U.layers.aaxis.attr("transform",Me),U.layers.agrid.attr("transform",Me);var Se=e(Q+Y/2,Z)+"rotate(-30)"+e(0,-Te._offset);U.layers.caxis.attr("transform",Se),U.layers.cgrid.attr("transform",Se),U.drawAxes(!0),U.layers.aline.select("path").attr("d",Ee.showline?"M"+Q+","+(Z+N)+"l"+Y/2+",-"+N:"M0,0").call(o.stroke,Ee.linecolor||"#000").style("stroke-width",(Ee.linewidth||0)+"px"),U.layers.bline.select("path").attr("d",Le.showline?"M"+Q+","+(Z+N)+"h"+Y:"M0,0").call(o.stroke,Le.linecolor||"#000").style("stroke-width",(Le.linewidth||0)+"px"),U.layers.cline.select("path").attr("d",Te.showline?"M"+(Q+Y/2)+","+Z+"l"+Y/2+","+N:"M0,0").call(o.stroke,Te.linecolor||"#000").style("stroke-width",(Te.linewidth||0)+"px"),U.graphDiv._context.staticPlot||U.initInteractions(),a.setClipUrl(U.layers.frontplot,U._hasClipOnAxisFalse?null:U.clipId,U.graphDiv)},L.drawAxes=function(W){var X=this.graphDiv,Q=this.id.substr(7)+"title",Z=this.layers,Y=this.aaxis,N=this.baxis,J=this.caxis;if(this.drawAx(Y),this.drawAx(N),this.drawAx(J),W){var D=Math.max(Y.showticklabels?Y.tickfont.size/2:0,(J.showticklabels?.75*J.tickfont.size:0)+(J.ticks==="outside"?.87*J.ticklen:0)),U=(N.showticklabels?N.tickfont.size:0)+(N.ticks==="outside"?N.ticklen:0)+3;Z["a-title"]=v.draw(X,"a"+Q,{propContainer:Y,propName:this.id+".aaxis.title",placeholder:l(X,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-Y.title.font.size/3-D,"text-anchor":"middle"}}),Z["b-title"]=v.draw(X,"b"+Q,{propContainer:N,propName:this.id+".baxis.title",placeholder:l(X,"Click to enter Component B title"),attributes:{x:this.x0-U,y:this.y0+this.h+.83*N.title.font.size+U,"text-anchor":"middle"}}),Z["c-title"]=v.draw(X,"c"+Q,{propContainer:J,propName:this.id+".caxis.title",placeholder:l(X,"Click to enter Component C title"),attributes:{x:this.x0+this.w+U,y:this.y0+this.h+.83*J.title.font.size+U,"text-anchor":"middle"}})}},L.drawAx=function(W){var X,Q=this.graphDiv,Z=W._name,Y=Z.charAt(0),N=W._id,J=this.layers[Z],D=Y+"tickLayout",U=(X=W).ticks+String(X.ticklen)+String(X.showticklabels);this[D]!==U&&(J.selectAll("."+N+"tick").remove(),this[D]=U),W.setScale();var G=c.calcTicks(W),$=c.clipEnds(W,G),K=c.makeTransTickFn(W),re=c.getTickSigns(W)[2],ne=u.deg2rad(30),ae=re*(W.linewidth||1)/2,ie=re*W.ticklen,he=this.w,se=this.h,de=Y==="b"?"M0,"+ae+"l"+Math.sin(ne)*ie+","+Math.cos(ne)*ie:"M"+ae+",0l"+Math.cos(ne)*ie+","+-Math.sin(ne)*ie,ce={a:"M0,0l"+se+",-"+he/2,b:"M0,0l-"+he/2+",-"+se,c:"M0,0l-"+se+","+he/2}[Y];c.drawTicks(Q,W,{vals:W.ticks==="inside"?$:G,layer:J,path:de,transFn:K,crisp:!1}),c.drawGrid(Q,W,{vals:$,layer:this.layers[Y+"grid"],path:ce,transFn:K,crisp:!1}),c.drawLabels(Q,W,{vals:G,layer:J,transFn:K,labelFns:c.makeLabelFns(W,0,30)})};var C=A.MINZOOM/2+.87,S="m-0.87,.5h"+C+"v3h-"+(C+5.2)+"l"+(C/2+2.6)+",-"+(.87*C+4.5)+"l2.6,1.5l-"+C/2+","+.87*C+"Z",P="m0.87,.5h-"+C+"v3h"+(C+5.2)+"l-"+(C/2+2.6)+",-"+(.87*C+4.5)+"l-2.6,1.5l"+C/2+","+.87*C+"Z",z="m0,1l"+C/2+","+.87*C+"l2.6,-1.5l-"+(C/2+2.6)+",-"+(.87*C+4.5)+"l-"+(C/2+2.6)+","+(.87*C+4.5)+"l2.6,1.5l"+C/2+",-"+.87*C+"Z",F=!0;function q(W){t.select(W).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}L.clearSelect=function(){E(this.dragOptions),k(this.dragOptions.gd)},L.initInteractions=function(){var W,X,Q,Z,Y,N,J,D,U,G,$,K,re=this,ne=re.layers.plotbg.select("path").node(),ae=re.graphDiv,ie=ae._fullLayout._zoomlayer;function he(fe){var ge={};return ge[re.id+".aaxis.min"]=fe.a,ge[re.id+".baxis.min"]=fe.b,ge[re.id+".caxis.min"]=fe.c,ge}function se(fe,ge){var ke=ae._fullLayout.clickmode;q(ae),fe===2&&(ae.emit("plotly_doubleclick",null),p.call("_guiRelayout",ae,he({a:0,b:0,c:0}))),ke.indexOf("select")>-1&&fe===1&&_(ge,ae,[re.xaxis],[re.yaxis],re.id,re.dragOptions),ke.indexOf("event")>-1&&d.click(ae,ge,re.id)}function de(fe,ge){return 1-ge/re.h}function ce(fe,ge){return 1-(fe+(re.h-ge)/Math.sqrt(3))/re.w}function ve(fe,ge){return(fe-(re.h-ge)/Math.sqrt(3))/re.w}function Ee(fe,ge){var ke=Q+fe*W,Me=Z+ge*X,Se=Math.max(0,Math.min(1,de(0,Z),de(0,Me))),De=Math.max(0,Math.min(1,ce(Q,Z),ce(ke,Me))),Be=Math.max(0,Math.min(1,ve(Q,Z),ve(ke,Me))),We=(Se/2+Be)*re.w,Qe=(1-Se/2-De)*re.w,Oe=(We+Qe)/2,Ue=Qe-We,Xe=(1-Se)*re.h,Ye=Xe-Ue/w;Ue<A.MINZOOM?(J=Y,$.attr("d",U),K.attr("d","M0,0Z")):(J={a:Y.a+Se*N,b:Y.b+De*N,c:Y.c+Be*N},$.attr("d",U+"M"+We+","+Xe+"H"+Qe+"L"+Oe+","+Ye+"L"+We+","+Xe+"Z"),K.attr("d","M"+Q+","+Z+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+We+","+Xe+S+"M"+Qe+","+Xe+P+"M"+Oe+","+Ye+z)),G||($.transition().style("fill",D>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),K.transition().style("opacity",1).duration(200),G=!0),ae.emit("plotly_relayouting",he(J))}function Le(){q(ae),J!==Y&&(p.call("_guiRelayout",ae,he(J)),F&&ae.data&&ae._context.showTips&&(u.notifier(l(ae,"Double-click to zoom back out"),"long"),F=!1))}function Te(fe,ge){var ke=fe/re.xaxis._m,Me=ge/re.yaxis._m,Se=[(J={a:Y.a-Me,b:Y.b+(ke+Me)/2,c:Y.c-(ke-Me)/2}).a,J.b,J.c].sort(u.sorterAsc),De=Se.indexOf(J.a),Be=Se.indexOf(J.b),We=Se.indexOf(J.c);Se[0]<0&&(Se[1]+Se[0]/2<0?(Se[2]+=Se[0]+Se[1],Se[0]=Se[1]=0):(Se[2]+=Se[0]/2,Se[1]+=Se[0]/2,Se[0]=0),J={a:Se[De],b:Se[Be],c:Se[We]},ge=(Y.a-J.a)*re.yaxis._m,fe=(Y.c-J.c-Y.b+J.b)*re.xaxis._m);var Qe=e(re.x0+fe,re.y0+ge);re.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Qe);var Oe=e(-fe,-ge);re.clipDefRelative.select("path").attr("transform",Oe),re.aaxis.range=[J.a,re.sum-J.b-J.c],re.baxis.range=[re.sum-J.a-J.c,J.b],re.caxis.range=[re.sum-J.a-J.b,J.c],re.drawAxes(!1),re._hasClipOnAxisFalse&&re.plotContainer.select(".scatterlayer").selectAll(".trace").call(a.hideOutsideRangePoints,re),ae.emit("plotly_relayouting",he(J))}function xe(){p.call("_guiRelayout",ae,he(J))}this.dragOptions={element:ne,gd:ae,plotinfo:{id:re.id,domain:ae._fullLayout[re.id].domain,xaxis:re.xaxis,yaxis:re.yaxis},subplot:re.id,prepFn:function(fe,ge,ke){re.dragOptions.xaxes=[re.xaxis],re.dragOptions.yaxes=[re.yaxis],W=ae._fullLayout._invScaleX,X=ae._fullLayout._invScaleY;var Me=re.dragOptions.dragmode=ae._fullLayout.dragmode;m(Me)?re.dragOptions.minDrag=1:re.dragOptions.minDrag=void 0,Me==="zoom"?(re.dragOptions.moveFn=Ee,re.dragOptions.clickFn=se,re.dragOptions.doneFn=Le,function(Se,De,Be){var We=ne.getBoundingClientRect();Q=De-We.left,Z=Be-We.top,ae._fullLayout._calcInverseTransform(ae);var Qe=ae._fullLayout._invTransform,Oe=u.apply3DTransform(Qe)(Q,Z);Q=Oe[0],Z=Oe[1],Y={a:re.aaxis.range[0],b:re.baxis.range[1],c:re.caxis.range[1]},J=Y,N=re.aaxis.range[1]-Y.a,D=h(re.graphDiv._fullLayout[re.id].bgcolor).getLuminance(),U="M0,"+re.h+"L"+re.w/2+", 0L"+re.w+","+re.h+"Z",G=!1,$=ie.append("path").attr("class","zoombox").attr("transform",e(re.x0,re.y0)).style({fill:D>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",U),K=ie.append("path").attr("class","zoombox-corners").attr("transform",e(re.x0,re.y0)).style({fill:o.background,stroke:o.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),re.clearSelect(ae)}(0,ge,ke)):Me==="pan"?(re.dragOptions.moveFn=Te,re.dragOptions.clickFn=se,re.dragOptions.doneFn=xe,Y={a:re.aaxis.range[0],b:re.baxis.range[1],c:re.caxis.range[1]},J=Y,re.clearSelect(ae)):(y(Me)||m(Me))&&T(fe,ge,ke,re.dragOptions,Me)}},ne.onmousemove=function(fe){d.hover(ae,fe,re.id),ae._fullLayout._lasthover=ne,ae._fullLayout._hoversubplot=re.id},ne.onmouseout=function(fe){ae._dragging||f.unhover(ae,fe)},f.init(this.dragOptions)}},{"../../components/color":666,"../../components/dragelement":685,"../../components/dragelement/helpers":684,"../../components/drawing":688,"../../components/fx":706,"../../components/titles":764,"../../lib":803,"../../lib/extend":793,"../../registry":931,"../cartesian/axes":854,"../cartesian/constants":861,"../cartesian/select":874,"../cartesian/set_convert":875,"../plots":917,"@plotly/d3":58,tinycolor2:598}],931:[function(i,B,V){var t=i("./lib/loggers"),h=i("./lib/noop"),p=i("./lib/push_unique"),u=i("./lib/is_plain_object"),e=i("./lib/dom").addStyleRule,l=i("./lib/extend"),o=i("./plots/attributes"),a=i("./plots/layout_attributes"),n=l.extendFlat,s=l.extendDeepAll;function r(_){var k=_.name,E=_.categories,A=_.meta;if(V.modules[k])t.log("Type "+k+" already registered");else{V.subplotsRegistry[_.basePlotModule.name]||function(F){var q=F.name;if(V.subplotsRegistry[q])return void t.log("Plot type "+q+" already registered.");for(var W in g(F),V.subplotsRegistry[q]=F,V.componentsRegistry)v(W,F.name)}(_.basePlotModule);for(var b={},L=0;L<E.length;L++)b[E[L]]=!0,V.allCategories[E[L]]=!0;for(var w in V.modules[k]={_module:_,categories:b},A&&Object.keys(A).length&&(V.modules[k].meta=A),V.allTypes.push(k),V.componentsRegistry)m(w,k);_.layoutAttributes&&n(V.traceLayoutAttributes,_.layoutAttributes);var C=_.basePlotModule,S=C.name;if(S==="mapbox"){var P=C.constants.styleRules;for(var z in P)e(".js-plotly-plot .plotly .mapboxgl-"+z,P[z])}S!=="geo"&&S!=="mapbox"||typeof window===void 0||window.PlotlyGeoAssets!==void 0||(window.PlotlyGeoAssets={topojson:{}})}}function c(_){if(typeof _.name!="string")throw new Error("Component module *name* must be a string.");var k=_.name;for(var E in V.componentsRegistry[k]=_,_.layoutAttributes&&(_.layoutAttributes._isLinkedToArray&&p(V.layoutArrayContainers,k),g(_)),V.modules)m(k,E);for(var A in V.subplotsRegistry)v(k,A);for(var b in V.transformsRegistry)y(k,b);_.schema&&_.schema.layout&&s(a,_.schema.layout)}function f(_){if(typeof _.name!="string")throw new Error("Transform module *name* must be a string.");var k="Transform module "+_.name,E=typeof _.transform=="function",A=typeof _.calcTransform=="function";if(!E&&!A)throw new Error(k+" is missing a *transform* or *calcTransform* method.");for(var b in E&&A&&t.log([k+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),u(_.attributes)||t.log(k+" registered without an *attributes* object."),typeof _.supplyDefaults!="function"&&t.log(k+" registered without a *supplyDefaults* method."),V.transformsRegistry[_.name]=_,V.componentsRegistry)y(b,_.name)}function d(_){var k=_.name,E=k.split("-")[0],A=_.dictionary,b=_.format,L=A&&Object.keys(A).length,w=b&&Object.keys(b).length,C=V.localeRegistry,S=C[k];if(S||(C[k]=S={}),E!==k){var P=C[E];P||(C[E]=P={}),L&&P.dictionary===S.dictionary&&(P.dictionary=A),w&&P.format===S.format&&(P.format=b)}L&&(S.dictionary=A),w&&(S.format=b)}function g(_){if(_.layoutAttributes){var k=_.layoutAttributes._arrayAttrRegexps;if(k)for(var E=0;E<k.length;E++)p(V.layoutArrayRegexes,k[E])}}function m(_,k){var E=V.componentsRegistry[_].schema;if(E&&E.traces){var A=E.traces[k];A&&s(V.modules[k]._module.attributes,A)}}function y(_,k){var E=V.componentsRegistry[_].schema;if(E&&E.transforms){var A=E.transforms[k];A&&s(V.transformsRegistry[k].attributes,A)}}function v(_,k){var E=V.componentsRegistry[_].schema;if(E&&E.subplots){var A=V.subplotsRegistry[k],b=A.layoutAttributes,L=A.attr==="subplot"?A.name:A.attr;Array.isArray(L)&&(L=L[0]);var w=E.subplots[L];b&&w&&s(b,w)}}function T(_){return typeof _=="object"&&(_=_.type),_}V.modules={},V.allCategories={},V.allTypes=[],V.subplotsRegistry={},V.transformsRegistry={},V.componentsRegistry={},V.layoutArrayContainers=[],V.layoutArrayRegexes=[],V.traceLayoutAttributes={},V.localeRegistry={},V.apiMethodRegistry={},V.collectableSubplotTypes=null,V.register=function(_){if(V.collectableSubplotTypes=null,!_)throw new Error("No argument passed to Plotly.register.");_&&!Array.isArray(_)&&(_=[_]);for(var k=0;k<_.length;k++){var E=_[k];if(!E)throw new Error("Invalid module was attempted to be registered!");switch(E.moduleType){case"trace":r(E);break;case"transform":f(E);break;case"component":c(E);break;case"locale":d(E);break;case"apiMethod":var A=E.name;V.apiMethodRegistry[A]=E.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},V.getModule=function(_){var k=V.modules[T(_)];return!!k&&k._module},V.traceIs=function(_,k){if((_=T(_))==="various")return!1;var E=V.modules[_];return E||(_&&t.log("Unrecognized trace type "+_+"."),E=V.modules[o.type.dflt]),!!E.categories[k]},V.getTransformIndices=function(_,k){for(var E=[],A=_.transforms||[],b=0;b<A.length;b++)A[b].type===k&&E.push(b);return E},V.hasTransform=function(_,k){for(var E=_.transforms||[],A=0;A<E.length;A++)if(E[A].type===k)return!0;return!1},V.getComponentMethod=function(_,k){var E=V.componentsRegistry[_];return E&&E[k]||h},V.call=function(){var _=arguments[0],k=[].slice.call(arguments,1);return V.apiMethodRegistry[_].apply(null,k)}},{"./lib/dom":791,"./lib/extend":793,"./lib/is_plain_object":804,"./lib/loggers":807,"./lib/noop":812,"./lib/push_unique":818,"./plots/attributes":850,"./plots/layout_attributes":908}],932:[function(i,B,V){var t=i("../registry"),h=i("../lib"),p=h.extendFlat,u=h.extendDeep;function e(l){var o;switch(l){case"themes__thumb":o={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":o={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:o={}}return o}B.exports=function(l,o){var a,n,s=l.data,r=l.layout,c=u([],s),f=u({},r,e(o.tileClass)),d=l._context||{};if(o.width&&(f.width=o.width),o.height&&(f.height=o.height),o.tileClass==="thumbnail"||o.tileClass==="themes__thumb"){f.annotations=[];var g=Object.keys(f);for(a=0;a<g.length;a++)n=g[a],["xaxis","yaxis","zaxis"].indexOf(n.slice(0,5))>-1&&(f[g[a]].title={text:""});for(a=0;a<c.length;a++){var m=c[a];m.showscale=!1,m.marker&&(m.marker.showscale=!1),t.traceIs(m,"pie-like")&&(m.textposition="none")}}if(Array.isArray(o.annotations))for(a=0;a<o.annotations.length;a++)f.annotations.push(o.annotations[a]);var y=Object.keys(f).filter(function(E){return E.match(/^scene\d*$/)});if(y.length){var v={};for(o.tileClass==="thumbnail"&&(v={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),a=0;a<y.length;a++){var T=f[y[a]];T.xaxis||(T.xaxis={}),T.yaxis||(T.yaxis={}),T.zaxis||(T.zaxis={}),p(T.xaxis,v),p(T.yaxis,v),p(T.zaxis,v),T._scene=null}}var _=document.createElement("div");o.tileClass&&(_.className=o.tileClass);var k={gd:_,td:_,layout:f,data:c,config:{staticPlot:o.staticPlot===void 0||o.staticPlot,plotGlPixelRatio:o.plotGlPixelRatio===void 0?2:o.plotGlPixelRatio,displaylogo:o.displaylogo||!1,showLink:o.showLink||!1,showTips:o.showTips||!1,mapboxAccessToken:d.mapboxAccessToken}};return o.setBackground!=="transparent"&&(k.config.setBackground=o.setBackground||"opaque"),k.gd.defaultLayout=e(o.tileClass),k}},{"../lib":803,"../registry":931}],933:[function(i,B,V){var t=i("../lib"),h=i("../plot_api/to_image"),p=i("./filesaver"),u=i("./helpers");B.exports=function(e,l){var o;return t.isPlainObject(e)||(o=t.getGraphDiv(e)),(l=l||{}).format=l.format||"png",l.width=l.width||null,l.height=l.height||null,l.imageDataOnly=!0,new Promise(function(a,n){o&&o._snapshotInProgress&&n(new Error("Snapshotting already in progress.")),t.isIE()&&l.format!=="svg"&&n(new Error(u.MSG_IE_BAD_FORMAT)),o&&(o._snapshotInProgress=!0);var s=h(e,l),r=l.filename||e.fn||"newplot";r+="."+l.format.replace("-","."),s.then(function(c){return o&&(o._snapshotInProgress=!1),p(c,r,l.format)}).then(function(c){a(c)}).catch(function(c){o&&(o._snapshotInProgress=!1),n(c)})})}},{"../lib":803,"../plot_api/to_image":846,"./filesaver":934,"./helpers":935}],934:[function(i,B,V){var t=i("../lib"),h=i("./helpers");B.exports=function(p,u,e){var l=document.createElement("a"),o="download"in l;return new Promise(function(a,n){var s,r;if(t.isIE())return s=h.createBlob(p,"svg"),window.navigator.msSaveBlob(s,u),s=null,a(u);if(o)return s=h.createBlob(p,e),r=h.createObjectURL(s),l.href=r,l.download=u,document.body.appendChild(l),l.click(),document.body.removeChild(l),h.revokeObjectURL(r),s=null,a(u);if(t.isSafari()){var c=e==="svg"?",":";base64,";return h.octetStream(c+encodeURIComponent(p)),a(u)}n(new Error("download error"))})}},{"../lib":803,"./helpers":935}],935:[function(i,B,V){var t=i("../registry");V.getDelay=function(p){return p._has&&(p._has("gl3d")||p._has("gl2d")||p._has("mapbox"))?500:0},V.getRedrawFunc=function(p){return function(){t.getComponentMethod("colorbar","draw")(p)}},V.encodeSVG=function(p){return"data:image/svg+xml,"+encodeURIComponent(p)},V.encodeJSON=function(p){return"data:application/json,"+encodeURIComponent(p)};var h=window.URL||window.webkitURL;V.createObjectURL=function(p){return h.createObjectURL(p)},V.revokeObjectURL=function(p){return h.revokeObjectURL(p)},V.createBlob=function(p,u){if(u==="svg")return new window.Blob([p],{type:"image/svg+xml;charset=utf-8"});if(u==="full-json")return new window.Blob([p],{type:"application/json;charset=utf-8"});var e=function(l){for(var o=l.length,a=new ArrayBuffer(o),n=new Uint8Array(a),s=0;s<o;s++)n[s]=l.charCodeAt(s);return a}(window.atob(p));return new window.Blob([e],{type:"image/"+u})},V.octetStream=function(p){document.location.href="data:application/octet-stream"+p},V.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,V.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":931}],936:[function(i,B,V){var t=i("./helpers"),h={getDelay:t.getDelay,getRedrawFunc:t.getRedrawFunc,clone:i("./cloneplot"),toSVG:i("./tosvg"),svgToImg:i("./svgtoimg"),toImage:i("./toimage"),downloadImage:i("./download")};B.exports=h},{"./cloneplot":932,"./download":933,"./helpers":935,"./svgtoimg":937,"./toimage":938,"./tosvg":939}],937:[function(i,B,V){var t=i("../lib"),h=i("events").EventEmitter,p=i("./helpers");B.exports=function(u){var e=u.emitter||new h,l=new Promise(function(o,a){var n=window.Image,s=u.svg,r=u.format||"png";if(t.isIE()&&r!=="svg"){var c=new Error(p.MSG_IE_BAD_FORMAT);return a(c),u.promise?l:e.emit("error",c)}var f,d,g=u.canvas,m=u.scale||1,y=u.width||300,v=u.height||150,T=m*y,_=m*v,k=g.getContext("2d"),E=new n;r==="svg"||t.isSafari()?d=p.encodeSVG(s):(f=p.createBlob(s,"svg"),d=p.createObjectURL(f)),g.width=T,g.height=_,E.onload=function(){var A;switch(f=null,p.revokeObjectURL(d),r!=="svg"&&k.drawImage(E,0,0,T,_),r){case"jpeg":A=g.toDataURL("image/jpeg");break;case"png":A=g.toDataURL("image/png");break;case"webp":A=g.toDataURL("image/webp");break;case"svg":A=d;break;default:var b="Image format is not jpeg, png, svg or webp.";if(a(new Error(b)),!u.promise)return e.emit("error",b)}o(A),u.promise||e.emit("success",A)},E.onerror=function(A){if(f=null,p.revokeObjectURL(d),a(A),!u.promise)return e.emit("error",A)},E.src=d});return u.promise?l:e}},{"../lib":803,"./helpers":935,events:116}],938:[function(i,B,V){var t=i("events").EventEmitter,h=i("../registry"),p=i("../lib"),u=i("./helpers"),e=i("./cloneplot"),l=i("./tosvg"),o=i("./svgtoimg");B.exports=function(a,n){var s=new t,r=e(a,{format:"png"}),c=r.gd;c.style.position="absolute",c.style.left="-5000px",document.body.appendChild(c);var f=u.getRedrawFunc(c);return h.call("_doPlot",c,r.data,r.layout,r.config).then(f).then(function(){var d=u.getDelay(c._fullLayout);setTimeout(function(){var g=l(c),m=document.createElement("canvas");m.id=p.randstr(),(s=o({format:n.format,width:c._fullLayout.width,height:c._fullLayout.height,canvas:m,emitter:s,svg:g})).clean=function(){c&&document.body.removeChild(c)}},d)}).catch(function(d){s.emit("error",d)}),s}},{"../lib":803,"../registry":931,"./cloneplot":932,"./helpers":935,"./svgtoimg":937,"./tosvg":939,events:116}],939:[function(i,B,V){var t=i("@plotly/d3"),h=i("../lib"),p=i("../components/drawing"),u=i("../components/color"),e=i("../constants/xmlns_namespaces"),l=/"/g,o=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");B.exports=function(a,n,s){var r,c,f=a._fullLayout,d=f._paper,g=f._toppaper,m=f.width,y=f.height;d.insert("rect",":first-child").call(p.setRect,0,0,m,y).call(u.fill,f.paper_bgcolor);var v=f._basePlotModules||[];for(r=0;r<v.length;r++){var T=v[r];T.toSVG&&T.toSVG(a)}if(g){var _=g.node().childNodes,k=Array.prototype.slice.call(_);for(r=0;r<k.length;r++){var E=k[r];E.childNodes.length&&d.node().appendChild(E)}}f._draggers&&f._draggers.remove(),d.node().style.background="",d.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var L=t.select(this);if(this.style.visibility!=="hidden"&&this.style.display!=="none"){L.style({visibility:null,display:null});var w=this.style.fontFamily;w&&w.indexOf('"')!==-1&&L.style("font-family",w.replace(l,"TOBESTRIPPED"))}else L.remove()});var A=[];if(f._gradientUrlQueryParts)for(c in f._gradientUrlQueryParts)A.push(c);if(f._patternUrlQueryParts)for(c in f._patternUrlQueryParts)A.push(c);A.length&&d.selectAll(A.join(",")).each(function(){var L=t.select(this),w=this.style.fill;w&&w.indexOf("url(")!==-1&&L.style("fill",w.replace(l,"TOBESTRIPPED"));var C=this.style.stroke;C&&C.indexOf("url(")!==-1&&L.style("stroke",C.replace(l,"TOBESTRIPPED"))}),n!=="pdf"&&n!=="eps"||d.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),d.node().setAttributeNS(e.xmlns,"xmlns",e.svg),d.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),n==="svg"&&s&&(d.attr("width",s*m),d.attr("height",s*y),d.attr("viewBox","0 0 "+m+" "+y));var b=new window.XMLSerializer().serializeToString(d.node());return b=function(L){var w=t.select("body").append("div").style({display:"none"}).html(""),C=L.replace(/(&[^;]*;)/gi,function(S){return S==="&lt;"?"&#60;":S==="&rt;"?"&#62;":S.indexOf("<")!==-1||S.indexOf(">")!==-1?"":w.html(S).text()});return w.remove(),C}(b),b=(b=b.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(o,"'"),h.isIE()&&(b=(b=(b=b.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),b}},{"../components/color":666,"../components/drawing":688,"../constants/xmlns_namespaces":780,"../lib":803,"@plotly/d3":58}],940:[function(i,B,V){var t=i("../../lib");B.exports=function(h,p){for(var u=0;u<h.length;u++)h[u].i=u;t.mergeArray(p.text,h,"tx"),t.mergeArray(p.hovertext,h,"htx");var e=p.marker;if(e){t.mergeArray(e.opacity,h,"mo",!0),t.mergeArray(e.color,h,"mc");var l=e.line;l&&(t.mergeArray(l.color,h,"mlc"),t.mergeArrayCastPositive(l.width,h,"mlw"))}}},{"../../lib":803}],941:[function(i,B,V){var t=i("../scatter/attributes"),h=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=i("../../plots/template_attributes").hovertemplateAttrs,u=i("../../plots/template_attributes").texttemplateAttrs,e=i("../../components/colorscale/attributes"),l=i("../../plots/font_attributes"),o=i("./constants"),a=i("../../components/drawing/attributes").pattern,n=i("../../lib/extend").extendFlat,s=l({editType:"calc",arrayOk:!0,colorEditType:"style"}),r=n({},t.marker.line.width,{dflt:0}),c=n({width:r,editType:"calc"},e("marker.line")),f=n({line:c,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:a});B.exports={x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:h("x"),yhoverformat:h("y"),text:t.text,texttemplate:u({editType:"plot"},{keys:o.eventDataKeys}),hovertext:t.hovertext,hovertemplate:p({},{keys:o.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:n({},s,{}),insidetextfont:n({},s,{}),outsidetextfont:n({},s,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:n({},t.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:f,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:t.selected.marker.opacity,color:t.selected.marker.color,editType:"style"},textfont:t.selected.textfont,editType:"style"},unselected:{marker:{opacity:t.unselected.marker.opacity,color:t.unselected.marker.color,editType:"style"},textfont:t.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":673,"../../components/drawing/attributes":687,"../../lib/extend":793,"../../plots/cartesian/axis_format_attributes":857,"../../plots/font_attributes":883,"../../plots/template_attributes":926,"../scatter/attributes":1218,"./constants":943}],942:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../../plots/cartesian/align_period"),p=i("../../components/colorscale/helpers").hasColorscale,u=i("../../components/colorscale/calc"),e=i("./arrays_to_calcdata"),l=i("../scatter/calc_selection");B.exports=function(o,a){var n,s,r,c,f,d,g=t.getFromId(o,a.xaxis||"x"),m=t.getFromId(o,a.yaxis||"y"),y={msUTC:!(!a.base&&a.base!==0)};a.orientation==="h"?(n=g.makeCalcdata(a,"x",y),r=m.makeCalcdata(a,"y"),c=h(a,m,"y",r),f=!!a.yperiodalignment,d="y"):(n=m.makeCalcdata(a,"y",y),r=g.makeCalcdata(a,"x"),c=h(a,g,"x",r),f=!!a.xperiodalignment,d="x"),s=c.vals;for(var v=Math.min(s.length,n.length),T=new Array(v),_=0;_<v;_++)T[_]={p:s[_],s:n[_]},f&&(T[_].orig_p=r[_],T[_][d+"End"]=c.ends[_],T[_][d+"Start"]=c.starts[_]),a.ids&&(T[_].id=String(a.ids[_]));return p(a,"marker")&&u(o,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),p(a,"marker.line")&&u(o,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(T,a),l(T,a),T}},{"../../components/colorscale/calc":674,"../../components/colorscale/helpers":677,"../../plots/cartesian/align_period":851,"../../plots/cartesian/axes":854,"../scatter/calc_selection":1220,"./arrays_to_calcdata":940}],943:[function(i,B,V){B.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],944:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib").isArrayOrTypedArray,p=i("../../constants/numerical").BADNUM,u=i("../../registry"),e=i("../../plots/cartesian/axes"),l=i("../../plots/cartesian/constraints").getAxisGroup,o=i("./sieve.js");function a(v,T,_,k,E){if(k.length){var A,b,L,w;switch(function(C,S){var P,z;for(P=0;P<S.length;P++){var F,q=S[P],W=q[0].trace,X=W.type==="funnel"?W._base:W.base,Q=W.orientation==="h"?W.xcalendar:W.ycalendar,Z=C.type==="category"||C.type==="multicategory"?function(){return null}:C.d2c;if(h(X)){for(z=0;z<Math.min(X.length,q.length);z++)F=Z(X[z],0,Q),t(F)?(q[z].b=+F,q[z].hasB=1):q[z].b=0;for(;z<q.length;z++)q[z].b=0}else{F=Z(X,0,Q);var Y=t(F);for(F=Y?F:0,z=0;z<q.length;z++)q[z].b=F,Y&&(q[z].hasB=1)}}}(_,k),E.mode){case"overlay":n(T,_,k,E);break;case"group":for(A=[],b=[],L=0;L<k.length;L++)(w=k[L])[0].trace.offset===void 0?b.push(w):A.push(w);b.length&&function(C,S,P,z,F){var q=new o(z,{posAxis:S,sepNegVal:!1,overlapNoMerge:!F.norm});(function(W,X,Q,Z){for(var Y=W._fullLayout,N=Q.positions,J=Q.distinctPositions,D=Q.minDiff,U=Q.traces,G=U.length,$=N.length!==J.length,K=D*(1-Z.gap),re=l(Y,X._id)+U[0][0].trace.orientation,ne=Y._alignmentOpts[re]||{},ae=0;ae<G;ae++){var ie,he,se=U[ae],de=se[0].trace,ce=ne[de.alignmentgroup]||{},ve=Object.keys(ce.offsetGroups||{}).length,Ee=(ie=ve?K/ve:$?K/G:K)*(1-(Z.groupgap||0));he=ve?((2*de._offsetIndex+1-ve)*ie-Ee)/2:$?((2*ae+1-G)*ie-Ee)/2:-Ee/2;var Le=se[0].t;Le.barwidth=Ee,Le.poffset=he,Le.bargroupwidth=K,Le.bardelta=D}Q.binWidth=U[0][0].t.barwidth/100,r(Q),c(X,Q),f(X,Q,$)})(C,S,q,F),function(W,X){for(var Q=W.traces,Z=0;Z<Q.length;Z++){var Y=Q[Z];if(Y[0].trace.base===void 0)for(var N=new o([Y],{posAxis:X,sepNegVal:!0,overlapNoMerge:!0}),J=0;J<Y.length;J++){var D=Y[J];if(D.p!==p){var U=N.put(D.p,D.b+D.s);U&&(D.b=U)}}}}(q,S),F.norm?(g(q),m(P,q,F)):d(P,q)}(v,T,_,b,E),A.length&&n(T,_,A,E);break;case"stack":case"relative":for(A=[],b=[],L=0;L<k.length;L++)(w=k[L])[0].trace.base===void 0?b.push(w):A.push(w);b.length&&function(C,S,P,z,F){var q=new o(z,{posAxis:S,sepNegVal:F.mode==="relative",overlapNoMerge:!(F.norm||F.mode==="stack"||F.mode==="relative")});s(S,q,F),function(Y,N,J){var D,U,G,$,K,re,ne=y(Y),ae=N.traces;for($=0;$<ae.length;$++)if(D=ae[$],(U=D[0].trace).type==="funnel")for(K=0;K<D.length;K++)(re=D[K]).s!==p&&N.put(re.p,-.5*re.s);for($=0;$<ae.length;$++){D=ae[$],U=D[0].trace,G=U.type==="funnel";var ie=[];for(K=0;K<D.length;K++)if((re=D[K]).s!==p){var he;he=G?re.s:re.s+re.b;var se=N.put(re.p,he),de=se+he;re.b=se,re[ne]=de,J.norm||(ie.push(de),re.hasB&&ie.push(se))}J.norm||(U._extremes[Y._id]=e.findExtremes(Y,ie,{tozero:!0,padded:!0}))}}(P,q,F);for(var W=0;W<z.length;W++)for(var X=z[W],Q=0;Q<X.length;Q++){var Z=X[Q];Z.s!==p&&Z.b+Z.s===q.get(Z.p,Z.s)&&(Z._outmost=!0)}F.norm&&m(P,q,F)}(0,T,_,b,E),A.length&&n(T,_,A,E)}(function(C,S){var P,z,F,q=y(S),W={},X=1/0,Q=-1/0;for(P=0;P<C.length;P++)for(F=C[P],z=0;z<F.length;z++){var Z=F[z].p;t(Z)&&(X=Math.min(X,Z),Q=Math.max(Q,Z))}var Y=1e4/(Q-X),N=W.round=function(re){return String(Math.round(Y*(re-X)))};for(P=0;P<C.length;P++){(F=C[P])[0].t.extents=W;var J=F[0].t.poffset,D=Array.isArray(J);for(z=0;z<F.length;z++){var U=F[z],G=U[q]-U.w/2;if(t(G)){var $=U[q]+U.w/2,K=N(U.p);W[K]?W[K]=[Math.min(G,W[K][0]),Math.max($,W[K][1])]:W[K]=[G,$]}U.p0=U.p+(D?J[z]:J),U.p1=U.p0+U.w,U.s0=U.b,U.s1=U.s0+U.s}}})(k,T)}}function n(v,T,_,k){for(var E=0;E<_.length;E++){var A=_[E],b=new o([A],{posAxis:v,sepNegVal:!1,overlapNoMerge:!k.norm});s(v,b,k),k.norm?(g(b),m(T,b,k)):d(T,b)}}function s(v,T,_){for(var k=T.minDiff,E=T.traces,A=k*(1-_.gap),b=A*(1-(_.groupgap||0)),L=-b/2,w=0;w<E.length;w++){var C=E[w][0].t;C.barwidth=b,C.poffset=L,C.bargroupwidth=A,C.bardelta=k}T.binWidth=E[0][0].t.barwidth/100,r(T),c(v,T),f(v,T)}function r(v){var T,_,k=v.traces;for(T=0;T<k.length;T++){var E,A=k[T],b=A[0],L=b.trace,w=b.t,C=L._offset||L.offset,S=w.poffset;if(h(C)){for(E=Array.prototype.slice.call(C,0,A.length),_=0;_<E.length;_++)t(E[_])||(E[_]=S);for(_=E.length;_<A.length;_++)E.push(S);w.poffset=E}else C!==void 0&&(w.poffset=C);var P=L._width||L.width,z=w.barwidth;if(h(P)){var F=Array.prototype.slice.call(P,0,A.length);for(_=0;_<F.length;_++)t(F[_])||(F[_]=z);for(_=F.length;_<A.length;_++)F.push(z);if(w.barwidth=F,C===void 0){for(E=[],_=0;_<A.length;_++)E.push(S+(z-F[_])/2);w.poffset=E}}else P!==void 0&&(w.barwidth=P,C===void 0&&(w.poffset=S+(z-P)/2))}}function c(v,T){for(var _=T.traces,k=y(v),E=0;E<_.length;E++)for(var A=_[E],b=A[0].t,L=b.poffset,w=Array.isArray(L),C=b.barwidth,S=Array.isArray(C),P=0;P<A.length;P++){var z=A[P],F=z.w=S?C[P]:C;z[k]=z.p+(w?L[P]:L)+F/2}}function f(v,T,_){var k=T.traces,E=T.minDiff/2;e.minDtick(v,T.minDiff,T.distinctPositions[0],_);for(var A=0;A<k.length;A++){var b,L,w,C,S=k[A],P=S[0],z=P.trace,F=[];for(C=0;C<S.length;C++)L=(b=S[C]).p-E,w=b.p+E,F.push(L,w);if(z.width||z.offset){var q=P.t,W=q.poffset,X=q.barwidth,Q=Array.isArray(W),Z=Array.isArray(X);for(C=0;C<S.length;C++){b=S[C];var Y=Q?W[C]:W,N=Z?X[C]:X;w=(L=b.p+Y)+N,F.push(L,w)}}z._extremes[v._id]=e.findExtremes(v,F,{padded:!1})}}function d(v,T){for(var _=T.traces,k=y(v),E=0;E<_.length;E++){for(var A=_[E],b=A[0].trace,L=[],w=!1,C=0;C<A.length;C++){var S=A[C],P=S.b,z=P+S.s;S[k]=z,L.push(z),S.hasB&&L.push(P),S.hasB&&S.b||(w=!0)}b._extremes[v._id]=e.findExtremes(v,L,{tozero:w,padded:!0})}}function g(v){for(var T=v.traces,_=0;_<T.length;_++)for(var k=T[_],E=0;E<k.length;E++){var A=k[E];A.s!==p&&v.put(A.p,A.b+A.s)}}function m(v,T,_){var k=T.traces,E=y(v),A=_.norm==="fraction"?1:100,b=A/1e9,L=v.l2c(v.c2l(0)),w=_.mode==="stack"?A:L;function C(J){return t(v.c2l(J))&&(J<L-b||J>w+b||!t(L))}for(var S=0;S<k.length;S++){for(var P=k[S],z=P[0].trace,F=[],q=!1,W=!1,X=0;X<P.length;X++){var Q=P[X];if(Q.s!==p){var Z=Math.abs(A/T.get(Q.p,Q.s));Q.b*=Z,Q.s*=Z;var Y=Q.b,N=Y+Q.s;Q[E]=N,F.push(N),W=W||C(N),Q.hasB&&(F.push(Y),W=W||C(Y)),Q.hasB&&Q.b||(q=!0)}}z._extremes[v._id]=e.findExtremes(v,F,{tozero:q,padded:W})}}function y(v){return v._id.charAt(0)}B.exports={crossTraceCalc:function(v,T){for(var _=T.xaxis,k=T.yaxis,E=v._fullLayout,A=v._fullData,b=v.calcdata,L=[],w=[],C=0;C<A.length;C++){var S=A[C];if(S.visible===!0&&u.traceIs(S,"bar")&&S.xaxis===_._id&&S.yaxis===k._id&&(S.orientation==="h"?L.push(b[C]):w.push(b[C]),S._computePh))for(var P=v.calcdata[C],z=0;z<P.length;z++)typeof P[z].ph0=="function"&&(P[z].ph0=P[z].ph0()),typeof P[z].ph1=="function"&&(P[z].ph1=P[z].ph1())}var F={xCat:_.type==="category"||_.type==="multicategory",yCat:k.type==="category"||k.type==="multicategory",mode:E.barmode,norm:E.barnorm,gap:E.bargap,groupgap:E.bargroupgap};a(v,_,k,w,F),a(v,k,_,L,F)},setGroupPositions:a}},{"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/axes":854,"../../plots/cartesian/constraints":862,"../../registry":931,"./sieve.js":954,"fast-isnumeric":249}],945:[function(i,B,V){var t=i("../../lib"),h=i("../../components/color"),p=i("../../registry"),u=i("../scatter/xy_defaults"),e=i("../scatter/period_defaults"),l=i("./style_defaults"),o=i("../../plots/cartesian/constraints").getAxisGroup,a=i("./attributes"),n=t.coerceFont;function s(c,f,d,g){var m=f.orientation,y=f[{v:"x",h:"y"}[m]+"axis"],v=o(d,y)+m,T=d._alignmentOpts||{},_=g("alignmentgroup"),k=T[v];k||(k=T[v]={});var E=k[_];E?E.traces.push(f):E=k[_]={traces:[f],alignmentIndex:Object.keys(k).length,offsetGroups:{}};var A=g("offsetgroup"),b=E.offsetGroups,L=b[A];A&&(L||(L=b[A]={offsetIndex:Object.keys(b).length}),f._offsetIndex=L.offsetIndex)}function r(c,f,d,g,m,y){var v=(y=y||{}).moduleHasSelected!==!1,T=y.moduleHasUnselected!==!1,_=y.moduleHasConstrain!==!1,k=y.moduleHasCliponaxis!==!1,E=y.moduleHasTextangle!==!1,A=y.moduleHasInsideanchor!==!1,b=!!y.hasPathbar,L=Array.isArray(m)||m==="auto",w=L||m==="inside",C=L||m==="outside";if(w||C){var S=n(g,"textfont",d.font),P=t.extendFlat({},S),z=!(c.textfont&&c.textfont.color);if(z&&delete P.color,n(g,"insidetextfont",P),b){var F=t.extendFlat({},S);z&&delete F.color,n(g,"pathbar.textfont",F)}C&&n(g,"outsidetextfont",S),v&&g("selected.textfont.color"),T&&g("unselected.textfont.color"),_&&g("constraintext"),k&&g("cliponaxis"),E&&g("textangle"),g("texttemplate")}w&&A&&g("insidetextanchor")}B.exports={supplyDefaults:function(c,f,d,g){function m(_,k){return t.coerce(c,f,a,_,k)}if(u(c,f,g,m)){e(c,f,g,m),m("xhoverformat"),m("yhoverformat"),m("orientation",f.x&&!f.y?"h":"v"),m("base"),m("offset"),m("width"),m("text"),m("hovertext"),m("hovertemplate");var y=m("textposition");r(c,f,g,m,y,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),l(c,f,m,d,g);var v=(f.marker.line||{}).color,T=p.getComponentMethod("errorbars","supplyDefaults");T(c,f,v||h.defaultLine,{axis:"y"}),T(c,f,v||h.defaultLine,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(f,m)}else f.visible=!1},crossTraceDefaults:function(c,f){var d;function g(y){return t.coerce(d._input,d,a,y)}if(f.barmode==="group")for(var m=0;m<c.length;m++)(d=c[m]).type==="bar"&&(d._input,s(0,d,f,g))},handleGroupingDefaults:s,handleText:r}},{"../../components/color":666,"../../lib":803,"../../plots/cartesian/constraints":862,"../../registry":931,"../scatter/period_defaults":1238,"../scatter/xy_defaults":1245,"./attributes":941,"./style_defaults":956}],946:[function(i,B,V){B.exports=function(t,h,p){return t.x="xVal"in h?h.xVal:h.x,t.y="yVal"in h?h.yVal:h.y,h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),p.orientation==="h"?(t.label=t.y,t.value=t.x):(t.label=t.x,t.value=t.y),t}},{}],947:[function(i,B,V){var t=i("fast-isnumeric"),h=i("tinycolor2"),p=i("../../lib").isArrayOrTypedArray;V.coerceString=function(u,e,l){if(typeof e=="string"){if(e||!u.noBlank)return e}else if((typeof e=="number"||e===!0)&&!u.strict)return String(e);return l!==void 0?l:u.dflt},V.coerceNumber=function(u,e,l){if(t(e)){e=+e;var o=u.min,a=u.max;if(!(o!==void 0&&e<o||a!==void 0&&e>a))return e}return l!==void 0?l:u.dflt},V.coerceColor=function(u,e,l){return h(e).isValid()?e:l!==void 0?l:u.dflt},V.coerceEnumerated=function(u,e,l){return u.coerceNumber&&(e=+e),u.values.indexOf(e)!==-1?e:l!==void 0?l:u.dflt},V.getValue=function(u,e){var l;return Array.isArray(u)?e<u.length&&(l=u[e]):l=u,l},V.getLineWidth=function(u,e){return 0<e.mlw?e.mlw:p(u.marker.line.width)?0:u.marker.line.width}},{"../../lib":803,"fast-isnumeric":249,tinycolor2:598}],948:[function(i,B,V){var t=i("../../components/fx"),h=i("../../registry"),p=i("../../components/color"),u=i("../../lib").fillText,e=i("./helpers").getLineWidth,l=i("../../plots/cartesian/axes").hoverLabelText,o=i("../../constants/numerical").BADNUM;function a(s,r,c,f,d){var g,m,y,v,T,_,k,E=s.cd,A=E[0].trace,b=E[0].t,L=f==="closest",w=A.type==="waterfall",C=s.maxHoverDistance,S=s.maxSpikeDistance;A.orientation==="h"?(g=c,m=r,y="y",v="x",T=D,_=N):(g=r,m=c,y="x",v="y",_=D,T=N);var P=A[y+"period"],z=L||P;function F(ie){return W(ie,-1)}function q(ie){return W(ie,1)}function W(ie,he){var se=ie.w;return ie[y]+he*se/2}function X(ie){return ie[y+"End"]-ie[y+"Start"]}var Q=L?F:P?function(ie){return ie.p-X(ie)/2}:function(ie){return Math.min(F(ie),ie.p-b.bardelta/2)},Z=L?q:P?function(ie){return ie.p+X(ie)/2}:function(ie){return Math.max(q(ie),ie.p+b.bardelta/2)};function Y(ie,he,se){return d.finiteRange&&(se=0),t.inbox(ie-g,he-g,se+Math.min(1,Math.abs(he-ie)/k)-1)}function N(ie){return Y(Q(ie),Z(ie),C)}function J(ie){var he=ie[v];if(w){var se=Math.abs(ie.rawS)||0;m>0?he+=se:m<0&&(he-=se)}return he}function D(ie){var he=m,se=ie.b,de=J(ie);return t.inbox(se-he,de-he,C+(de-he)/(de-se)-1)}var U=s[y+"a"],G=s[v+"a"];k=Math.abs(U.r2c(U.range[1])-U.r2c(U.range[0]));var $=t.getDistanceFunction(f,T,_,function(ie){return(T(ie)+_(ie))/2});if(t.getClosest(E,$,s),s.index!==!1&&E[s.index].p!==o){z||(Q=function(ie){return Math.min(F(ie),ie.p-b.bargroupwidth/2)},Z=function(ie){return Math.max(q(ie),ie.p+b.bargroupwidth/2)});var K=E[s.index],re=A.base?K.b+K.s:K.s;s[v+"0"]=s[v+"1"]=G.c2p(K[v],!0),s[v+"LabelVal"]=re;var ne=b.extents[b.extents.round(K.p)];s[y+"0"]=U.c2p(L?Q(K):ne[0],!0),s[y+"1"]=U.c2p(L?Z(K):ne[1],!0);var ae=K.orig_p!==void 0;return s[y+"LabelVal"]=ae?K.orig_p:K.p,s.labelLabel=l(U,s[y+"LabelVal"],A[y+"hoverformat"]),s.valueLabel=l(G,s[v+"LabelVal"],A[v+"hoverformat"]),s.baseLabel=l(G,K.b,A[v+"hoverformat"]),s.spikeDistance=(function(ie){var he=m,se=ie.b,de=J(ie);return t.inbox(se-he,de-he,S+(de-he)/(de-se)-1)}(K)+function(ie){return Y(F(ie),q(ie),S)}(K))/2,s[y+"Spike"]=U.c2p(K.p,!0),u(K,A,s),s.hovertemplate=A.hovertemplate,s}}function n(s,r){var c=r.mcc||s.marker.color,f=r.mlcc||s.marker.line.color,d=e(s,r);return p.opacity(c)?c:p.opacity(f)&&d?f:void 0}B.exports={hoverPoints:function(s,r,c,f,d){var g=a(s,r,c,f,d);if(g){var m=g.cd,y=m[0].trace,v=m[g.index];return g.color=n(y,v),h.getComponentMethod("errorbars","hoverInfo")(v,y,g),[g]}},hoverOnBars:a,getTraceColor:n}},{"../../components/color":666,"../../components/fx":706,"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/axes":854,"../../registry":931,"./helpers":947}],949:[function(i,B,V){B.exports={attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyDefaults:i("./defaults").supplyDefaults,crossTraceDefaults:i("./defaults").crossTraceDefaults,supplyLayoutDefaults:i("./layout_defaults"),calc:i("./calc"),crossTraceCalc:i("./cross_trace_calc").crossTraceCalc,colorbar:i("../scatter/marker_colorbar"),arraysToCalcdata:i("./arrays_to_calcdata"),plot:i("./plot").plot,style:i("./style").style,styleOnSelect:i("./style").styleOnSelect,hoverPoints:i("./hover").hoverPoints,eventData:i("./event_data"),selectPoints:i("./select"),moduleType:"trace",name:"bar",basePlotModule:i("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":868,"../scatter/marker_colorbar":1236,"./arrays_to_calcdata":940,"./attributes":941,"./calc":942,"./cross_trace_calc":944,"./defaults":945,"./event_data":946,"./hover":948,"./layout_attributes":950,"./layout_defaults":951,"./plot":952,"./select":953,"./style":955}],950:[function(i,B,V){B.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],951:[function(i,B,V){var t=i("../../registry"),h=i("../../plots/cartesian/axes"),p=i("../../lib"),u=i("./layout_attributes");B.exports=function(e,l,o){function a(y,v){return p.coerce(e,l,u,y,v)}for(var n=!1,s=!1,r=!1,c={},f=a("barmode"),d=0;d<o.length;d++){var g=o[d];if(t.traceIs(g,"bar")&&g.visible){if(n=!0,f==="group"){var m=g.xaxis+g.yaxis;c[m]&&(r=!0),c[m]=!0}g.visible&&g.type==="histogram"&&h.getFromId({_fullLayout:l},g[g.orientation==="v"?"xaxis":"yaxis"]).type!=="category"&&(s=!0)}}n?(f!=="overlay"&&a("barnorm"),a("bargap",s&&!r?0:.2),a("bargroupgap")):delete l.barmode}},{"../../lib":803,"../../plots/cartesian/axes":854,"../../registry":931,"./layout_attributes":950}],952:[function(i,B,V){var t=i("@plotly/d3"),h=i("fast-isnumeric"),p=i("../../lib"),u=i("../../lib/svg_text_utils"),e=i("../../components/color"),l=i("../../components/drawing"),o=i("../../registry"),a=i("../../plots/cartesian/axes").tickText,n=i("./uniform_text"),s=n.recordMinTextSize,r=n.clearMinTextSize,c=i("./style"),f=i("./helpers"),d=i("./constants"),g=i("./attributes"),m=g.text,y=g.textposition,v=i("../../components/fx/helpers").appendArrayPointValue,T=d.TEXTPAD;function _(S){return S.id}function k(S){if(S.ids)return _}function E(S,P){return S<P?1:-1}function A(S,P,z,F){var q;return!P.uniformtext.mode&&b(z)?(F&&(q=F()),S.transition().duration(z.duration).ease(z.easing).each("end",function(){q&&q()}).each("interrupt",function(){q&&q()})):S}function b(S){return S&&S.duration>0}function L(S){return S==="auto"?0:S}function w(S,P){var z=Math.PI/180*P,F=Math.abs(Math.sin(z)),q=Math.abs(Math.cos(z));return{x:S.width*q+S.height*F,y:S.width*F+S.height*q}}function C(S,P,z,F,q,W){var X=!!W.isHorizontal,Q=!!W.constrained,Z=W.angle||0,Y=W.anchor||"end",N=Y==="end",J=Y==="start",D=((W.leftToRight||0)+1)/2,U=1-D,G=q.width,$=q.height,K=Math.abs(P-S),re=Math.abs(F-z),ne=K>2*T&&re>2*T?T:0;K-=2*ne,re-=2*ne;var ae=L(Z);Z!=="auto"||G<=K&&$<=re||!(G>K||$>re)||(G>re||$>K)&&G<$==K<re||(ae+=90);var ie=w(q,ae),he=1;Q&&(he=Math.min(1,K/ie.x,re/ie.y));var se=q.left*U+q.right*D,de=(q.top+q.bottom)/2,ce=(S+T)*U+(P-T)*D,ve=(z+F)/2,Ee=0,Le=0;if(J||N){var Te=(X?ie.x:ie.y)/2,xe=X?E(S,P):E(z,F);X?J?(ce=S+xe*ne,Ee=-xe*Te):(ce=P-xe*ne,Ee=xe*Te):J?(ve=z+xe*ne,Le=-xe*Te):(ve=F-xe*ne,Le=xe*Te)}return{textX:se,textY:de,targetX:ce,targetY:ve,anchorX:Ee,anchorY:Le,scale:he,rotate:ae}}B.exports={plot:function(S,P,z,F,q,W){var X=P.xaxis,Q=P.yaxis,Z=S._fullLayout;q||(q={mode:Z.barmode,norm:Z.barmode,gap:Z.bargap,groupgap:Z.bargroupgap},r("bar",Z));var Y=p.makeTraceGroups(F,z,"trace bars").each(function(N){var J=t.select(this),D=N[0].trace,U=D.type==="waterfall",G=D.type==="funnel",$=D.type==="bar"||G,K=0;U&&D.connector.visible&&D.connector.mode==="between"&&(K=D.connector.line.width/2);var re=D.orientation==="h",ne=b(q),ae=p.ensureSingle(J,"g","points"),ie=k(D),he=ae.selectAll("g.point").data(p.identity,ie);he.enter().append("g").classed("point",!0),he.exit().remove(),he.each(function(de,ce){var ve,Ee,Le=t.select(this),Te=function(Oe,Ue,Xe,Ye){var $e=[],it=[],ot=Ye?Ue:Xe,Et=Ye?Xe:Ue;return $e[0]=ot.c2p(Oe.s0,!0),it[0]=Et.c2p(Oe.p0,!0),$e[1]=ot.c2p(Oe.s1,!0),it[1]=Et.c2p(Oe.p1,!0),Ye?[$e,it]:[it,$e]}(de,X,Q,re),xe=Te[0][0],fe=Te[0][1],ge=Te[1][0],ke=Te[1][1],Me=(re?fe-xe:ke-ge)==0;if(Me&&$&&f.getLineWidth(D,de)&&(Me=!1),Me||(Me=!(h(xe)&&h(fe)&&h(ge)&&h(ke))),de.isBlank=Me,Me&&(re?fe=xe:ke=ge),K&&!Me&&(re?(xe-=E(xe,fe)*K,fe+=E(xe,fe)*K):(ge-=E(ge,ke)*K,ke+=E(ge,ke)*K)),D.type==="waterfall"){if(!Me){var Se=D[de.dir].marker;ve=Se.line.width,Ee=Se.color}}else ve=f.getLineWidth(D,de),Ee=de.mc||D.marker.color;function De(Oe){var Ue=t.round(ve/2%1,2);return q.gap===0&&q.groupgap===0?t.round(Math.round(Oe)-Ue,2):Oe}if(!S._context.staticPlot){var Be=e.opacity(Ee)<1||ve>.01?De:function(Oe,Ue,Xe){return Xe&&Oe===Ue?Oe:Math.abs(Oe-Ue)>=2?De(Oe):Oe>Ue?Math.ceil(Oe):Math.floor(Oe)};xe=Be(xe,fe,re),fe=Be(fe,xe,re),ge=Be(ge,ke,!re),ke=Be(ke,ge,!re)}var We=A(p.ensureSingle(Le,"path"),Z,q,W);if(We.style("vector-effect","non-scaling-stroke").attr("d",isNaN((fe-xe)*(ke-ge))||Me&&S._context.staticPlot?"M0,0Z":"M"+xe+","+ge+"V"+ke+"H"+fe+"V"+ge+"Z").call(l.setClipUrl,P.layerClipId,S),!Z.uniformtext.mode&&ne){var Qe=l.makePointStyleFns(D);l.singlePointStyle(de,We,D,Qe,S)}(function(Oe,Ue,Xe,Ye,$e,it,ot,Et,mt,tt,Ke){var Mt,Jt=Ue.xaxis,$t=Ue.yaxis,je=Oe._fullLayout;function Ge(ar,Nt,nr){return p.ensureSingle(ar,"text").text(Nt).attr({class:"bartext bartext-"+Mt,"text-anchor":"middle","data-notex":1}).call(l.font,nr).call(u.convertToTspans,Oe)}var Ct=Ye[0].trace,Ie=Ct.orientation==="h",be=function(ar,Nt,nr,Lr,dr){var Kt,yr=Nt[0].trace;return Kt=yr.texttemplate?function(xr,gr,wr,zr,Rr){var Wr=gr[0].trace,gn=p.castOption(Wr,wr,"texttemplate");if(!gn)return"";var rn,Zr,bn,Dr,br=Wr.type==="waterfall",Xr=Wr.type==="funnel";Wr.orientation==="h"?(rn="y",Zr=Rr,bn="x",Dr=zr):(rn="x",Zr=zr,bn="y",Dr=Rr);function fn(gt){return a(Dr,Dr.c2l(gt),!0).text}var Qr=gr[wr],un={};un.label=Qr.p,un.labelLabel=un[rn+"Label"]=(Pn=Qr.p,a(Zr,Zr.c2l(Pn),!0).text);var Pn,kn=p.castOption(Wr,Qr.i,"text");(kn===0||kn)&&(un.text=kn),un.value=Qr.s,un.valueLabel=un[bn+"Label"]=fn(Qr.s);var Hn={};v(Hn,Wr,Qr.i),br&&(un.delta=+Qr.rawS||Qr.s,un.deltaLabel=fn(un.delta),un.final=Qr.v,un.finalLabel=fn(un.final),un.initial=un.final-un.delta,un.initialLabel=fn(un.initial)),Xr&&(un.value=Qr.s,un.valueLabel=fn(un.value),un.percentInitial=Qr.begR,un.percentInitialLabel=p.formatPercent(Qr.begR),un.percentPrevious=Qr.difR,un.percentPreviousLabel=p.formatPercent(Qr.difR),un.percentTotal=Qr.sumR,un.percenTotalLabel=p.formatPercent(Qr.sumR));var aa=p.castOption(Wr,Qr.i,"customdata");return aa&&(un.customdata=aa),p.texttemplateString(gn,un,xr._d3locale,Hn,un,Wr._meta||{})}(ar,Nt,nr,Lr,dr):yr.textinfo?function(xr,gr,wr,zr){var Rr=xr[0].trace,Wr=Rr.orientation==="h",gn=Rr.type==="waterfall",rn=Rr.type==="funnel";function Zr(Qt){return a(Wr?wr:zr,+Qt,!0).text}var bn,Dr=Rr.textinfo,br=xr[gr],Xr=Dr.split("+"),fn=[],Qr=function(Qt){return Xr.indexOf(Qt)!==-1};Qr("label")&&fn.push((un=xr[gr].p,a(Wr?zr:wr,un,!0).text));var un;if(Qr("text")&&((bn=p.castOption(Rr,br.i,"text"))===0||bn)&&fn.push(bn),gn){var Pn=+br.rawS||br.s,kn=br.v,Hn=kn-Pn;Qr("initial")&&fn.push(Zr(Hn)),Qr("delta")&&fn.push(Zr(Pn)),Qr("final")&&fn.push(Zr(kn))}if(rn){Qr("value")&&fn.push(Zr(br.s));var aa=0;Qr("percent initial")&&aa++,Qr("percent previous")&&aa++,Qr("percent total")&&aa++;var gt=aa>1;Qr("percent initial")&&(bn=p.formatPercent(br.begR),gt&&(bn+=" of initial"),fn.push(bn)),Qr("percent previous")&&(bn=p.formatPercent(br.difR),gt&&(bn+=" of previous"),fn.push(bn)),Qr("percent total")&&(bn=p.formatPercent(br.sumR),gt&&(bn+=" of total"),fn.push(bn))}return fn.join("<br>")}(Nt,nr,Lr,dr):f.getValue(yr.text,nr),f.coerceString(m,Kt)}(je,Ye,$e,Jt,$t);Mt=function(ar,Nt){var nr=f.getValue(ar.textposition,Nt);return f.coerceEnumerated(y,nr)}(Ct,$e);var Ae=tt.mode==="stack"||tt.mode==="relative",Pe=Ye[$e],ze=!Ae||Pe._outmost;if(!be||Mt==="none"||(Pe.isBlank||it===ot||Et===mt)&&(Mt==="auto"||Mt==="inside"))return void Xe.select("text").remove();var qe=je.font,ht=c.getBarColor(Ye[$e],Ct),at=c.getInsideTextFont(Ct,$e,qe,ht),nt=c.getOutsideTextFont(Ct,$e,qe),xt=Xe.datum();Ie?Jt.type==="log"&&xt.s0<=0&&(it=Jt.range[0]<Jt.range[1]?0:Jt._length):$t.type==="log"&&xt.s0<=0&&(Et=$t.range[0]<$t.range[1]?$t._length:0);var Lt,bt,St,st,It,jt=Math.abs(ot-it)-2*T,Ut=Math.abs(mt-Et)-2*T;if(Mt==="outside"&&(ze||Pe.hasB||(Mt="inside")),Mt==="auto")if(ze){Mt="inside",It=p.ensureUniformFontSize(Oe,at),Lt=Ge(Xe,be,It),bt=l.bBox(Lt.node()),St=bt.width,st=bt.height;var zt=St<=jt&&st<=Ut,Ce=St<=Ut&&st<=jt,lt=Ie?jt>=St*(Ut/st):Ut>=st*(jt/St);St>0&&st>0&&(zt||Ce||lt)?Mt="inside":(Mt="outside",Lt.remove(),Lt=null)}else Mt="inside";if(!Lt){It=p.ensureUniformFontSize(Oe,Mt==="outside"?nt:at);var At=(Lt=Ge(Xe,be,It)).attr("transform");if(Lt.attr("transform",""),bt=l.bBox(Lt.node()),St=bt.width,st=bt.height,Lt.attr("transform",At),St<=0||st<=0)return void Lt.remove()}var Bt,Ht,or=Ct.textangle;Mt==="outside"?(Ht=Ct.constraintext==="both"||Ct.constraintext==="outside",Bt=function(ar,Nt,nr,Lr,dr,Kt){var yr,xr=!!Kt.isHorizontal,gr=!!Kt.constrained,wr=Kt.angle||0,zr=dr.width,Rr=dr.height,Wr=Math.abs(Nt-ar),gn=Math.abs(Lr-nr);yr=xr?gn>2*T?T:0:Wr>2*T?T:0;var rn=1;gr&&(rn=xr?Math.min(1,gn/Rr):Math.min(1,Wr/zr));var Zr=L(wr),bn=w(dr,Zr),Dr=(xr?bn.x:bn.y)/2,br=(dr.left+dr.right)/2,Xr=(dr.top+dr.bottom)/2,fn=(ar+Nt)/2,Qr=(nr+Lr)/2,un=0,Pn=0,kn=xr?E(Nt,ar):E(nr,Lr);return xr?(fn=Nt-kn*yr,un=kn*Dr):(Qr=Lr+kn*yr,Pn=-kn*Dr),{textX:br,textY:Xr,targetX:fn,targetY:Qr,anchorX:un,anchorY:Pn,scale:rn,rotate:Zr}}(it,ot,Et,mt,bt,{isHorizontal:Ie,constrained:Ht,angle:or})):(Ht=Ct.constraintext==="both"||Ct.constraintext==="inside",Bt=C(it,ot,Et,mt,bt,{isHorizontal:Ie,constrained:Ht,angle:or,anchor:Ct.insidetextanchor})),Bt.fontSize=It.size,s(Ct.type,Bt,je),Pe.transform=Bt,A(Lt,je,tt,Ke).attr("transform",p.getTextTransform(Bt))})(S,P,Le,N,ce,xe,fe,ge,ke,q,W),P.layerClipId&&l.hideOutsideRangePoint(de,Le.select("text"),X,Q,D.xcalendar,D.ycalendar)});var se=D.cliponaxis===!1;l.setClipUrl(J,se?null:P.layerClipId,S)});o.getComponentMethod("errorbars","plot")(S,Y,P,q)},toMoveInsideBar:C}},{"../../components/color":666,"../../components/drawing":688,"../../components/fx/helpers":702,"../../lib":803,"../../lib/svg_text_utils":829,"../../plots/cartesian/axes":854,"../../registry":931,"./attributes":941,"./constants":943,"./helpers":947,"./style":955,"./uniform_text":957,"@plotly/d3":58,"fast-isnumeric":249}],953:[function(i,B,V){function t(h,p,u,e,l){var o=p.c2p(e?h.s0:h.p0,!0),a=p.c2p(e?h.s1:h.p1,!0),n=u.c2p(e?h.p0:h.s0,!0),s=u.c2p(e?h.p1:h.s1,!0);return l?[(o+a)/2,(n+s)/2]:e?[a,(n+s)/2]:[(o+a)/2,s]}B.exports=function(h,p){var u,e=h.cd,l=h.xaxis,o=h.yaxis,a=e[0].trace,n=a.type==="funnel",s=a.orientation==="h",r=[];if(p===!1)for(u=0;u<e.length;u++)e[u].selected=0;else for(u=0;u<e.length;u++){var c=e[u],f="ct"in c?c.ct:t(c,l,o,s,n);p.contains(f,!1,u,h)?(r.push({pointNumber:u,x:l.c2d(c.x),y:o.c2d(c.y)}),c.selected=1):c.selected=0}return r}},{}],954:[function(i,B,V){B.exports=p;var t=i("../../lib").distinctVals,h=i("../../constants/numerical").BADNUM;function p(u,e){this.traces=u,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var l=1/0,o=[],a=0;a<u.length;a++){for(var n=u[a],s=0;s<n.length;s++){var r=n[s];r.p!==h&&o.push(r.p)}n[0]&&n[0].width1&&(l=Math.min(n[0].width1,l))}this.positions=o;var c=t(o);this.distinctPositions=c.vals,c.vals.length===1&&l!==1/0?this.minDiff=l:this.minDiff=Math.min(c.minDiff,l);var f=(e.posAxis||{}).type;f!=="category"&&f!=="multicategory"||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}p.prototype.put=function(u,e){var l=this.getLabel(u,e),o=this.bins[l]||0;return this.bins[l]=o+e,o},p.prototype.get=function(u,e){var l=this.getLabel(u,e);return this.bins[l]||0},p.prototype.getLabel=function(u,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?u:Math.round(u/this.binWidth))}},{"../../constants/numerical":779,"../../lib":803}],955:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/color"),p=i("../../components/drawing"),u=i("../../lib"),e=i("../../registry"),l=i("./uniform_text").resizeText,o=i("./attributes"),a=o.textfont,n=o.insidetextfont,s=o.outsidetextfont,r=i("./helpers");function c(_,k,E){p.pointStyle(_.selectAll("path"),k,E),f(_,k,E)}function f(_,k,E){_.selectAll("text").each(function(A){var b=t.select(this),L=u.ensureUniformFontSize(E,d(b,A,k,E));p.font(b,L)})}function d(_,k,E,A){var b=A._fullLayout.font,L=E.textfont;if(_.classed("bartext-inside")){var w=T(k,E);L=m(E,k.i,b,w)}else _.classed("bartext-outside")&&(L=y(E,k.i,b));return L}function g(_,k,E){return v(a,_.textfont,k,E)}function m(_,k,E,A){var b=g(_,k,E);return(_._input.textfont===void 0||_._input.textfont.color===void 0||Array.isArray(_.textfont.color)&&_.textfont.color[k]===void 0)&&(b={color:h.contrast(A),family:b.family,size:b.size}),v(n,_.insidetextfont,k,b)}function y(_,k,E){var A=g(_,k,E);return v(s,_.outsidetextfont,k,A)}function v(_,k,E,A){k=k||{};var b=r.getValue(k.family,E),L=r.getValue(k.size,E),w=r.getValue(k.color,E);return{family:r.coerceString(_.family,b,A.family),size:r.coerceNumber(_.size,L,A.size),color:r.coerceColor(_.color,w,A.color)}}function T(_,k){return k.type==="waterfall"?k[_.dir].marker.color:_.mcc||_.mc||k.marker.color}B.exports={style:function(_){var k=t.select(_).selectAll("g.barlayer").selectAll("g.trace");l(_,k,"bar");var E=k.size(),A=_._fullLayout;k.style("opacity",function(b){return b[0].trace.opacity}).each(function(b){(A.barmode==="stack"&&E>1||A.bargap===0&&A.bargroupgap===0&&!b[0].trace.marker.line.width)&&t.select(this).attr("shape-rendering","crispEdges")}),k.selectAll("g.points").each(function(b){c(t.select(this),b[0].trace,_)}),e.getComponentMethod("errorbars","style")(k)},styleTextPoints:f,styleOnSelect:function(_,k,E){var A=k[0].trace;A.selectedpoints?function(b,L,w){p.selectedPointStyle(b.selectAll("path"),L),function(C,S,P){C.each(function(z){var F,q=t.select(this);if(z.selected){F=u.ensureUniformFontSize(P,d(q,z,S,P));var W=S.selected.textfont&&S.selected.textfont.color;W&&(F.color=W),p.font(q,F)}else p.selectedTextStyle(q,S)})}(b.selectAll("text"),L,w)}(E,A,_):(c(E,A,_),e.getComponentMethod("errorbars","style")(E))},getInsideTextFont:m,getOutsideTextFont:y,getBarColor:T,resizeText:l}},{"../../components/color":666,"../../components/drawing":688,"../../lib":803,"../../registry":931,"./attributes":941,"./helpers":947,"./uniform_text":957,"@plotly/d3":58}],956:[function(i,B,V){var t=i("../../components/color"),h=i("../../components/colorscale/helpers").hasColorscale,p=i("../../components/colorscale/defaults"),u=i("../../lib").coercePattern;B.exports=function(e,l,o,a,n){var s=o("marker.color",a),r=h(e,"marker");r&&p(e,l,n,o,{prefix:"marker.",cLetter:"c"}),o("marker.line.color",t.defaultLine),h(e,"marker.line")&&p(e,l,n,o,{prefix:"marker.line.",cLetter:"c"}),o("marker.line.width"),o("marker.opacity"),u(o,"marker.pattern",s,r),o("selected.marker.color"),o("unselected.marker.color")}},{"../../components/color":666,"../../components/colorscale/defaults":676,"../../components/colorscale/helpers":677,"../../lib":803}],957:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib");function p(u){return"_"+u+"Text_minsize"}B.exports={recordMinTextSize:function(u,e,l){if(l.uniformtext.mode){var o=p(u),a=l.uniformtext.minsize,n=e.scale*e.fontSize;e.hide=n<a,l[o]=l[o]||1/0,e.hide||(l[o]=Math.min(l[o],Math.max(n,a)))}},clearMinTextSize:function(u,e){e[p(u)]=void 0},resizeText:function(u,e,l){var o=u._fullLayout,a=o["_"+l+"Text_minsize"];if(a){var n,s=o.uniformtext.mode==="hide";switch(l){case"funnelarea":case"pie":case"sunburst":n="g.slice";break;case"treemap":case"icicle":n="g.slice, g.pathbar";break;default:n="g.points > g.point"}e.selectAll(n).each(function(r){var c=r.transform;c&&(c.scale=s&&c.hide?0:a/c.fontSize,t.select(this).select("text").attr("transform",h.getTextTransform(c)))})}}}},{"../../lib":803,"@plotly/d3":58}],958:[function(i,B,V){var t=i("../../plots/template_attributes").hovertemplateAttrs,h=i("../../lib/extend").extendFlat,p=i("../scatterpolar/attributes"),u=i("../bar/attributes");B.exports={r:p.r,theta:p.theta,r0:p.r0,dr:p.dr,theta0:p.theta0,dtheta:p.dtheta,thetaunit:p.thetaunit,base:h({},u.base,{}),offset:h({},u.offset,{}),width:h({},u.width,{}),text:h({},u.text,{}),hovertext:h({},u.hovertext,{}),marker:u.marker,hoverinfo:p.hoverinfo,hovertemplate:t(),selected:u.selected,unselected:u.unselected}},{"../../lib/extend":793,"../../plots/template_attributes":926,"../bar/attributes":941,"../scatterpolar/attributes":1292}],959:[function(i,B,V){var t=i("../../components/colorscale/helpers").hasColorscale,h=i("../../components/colorscale/calc"),p=i("../bar/arrays_to_calcdata"),u=i("../bar/cross_trace_calc").setGroupPositions,e=i("../scatter/calc_selection"),l=i("../../registry").traceIs,o=i("../../lib").extendFlat;B.exports={calc:function(a,n){for(var s=a._fullLayout,r=n.subplot,c=s[r].radialaxis,f=s[r].angularaxis,d=c.makeCalcdata(n,"r"),g=f.makeCalcdata(n,"theta"),m=n._length,y=new Array(m),v=d,T=g,_=0;_<m;_++)y[_]={p:T[_],s:v[_]};function k(E){var A=n[E];A!==void 0&&(n["_"+E]=Array.isArray(A)?f.makeCalcdata(n,E):f.d2c(A,n.thetaunit))}return f.type==="linear"&&(k("width"),k("offset")),t(n,"marker")&&h(a,n,{vals:n.marker.color,containerStr:"marker",cLetter:"c"}),t(n,"marker.line")&&h(a,n,{vals:n.marker.line.color,containerStr:"marker.line",cLetter:"c"}),p(y,n),e(y,n),y},crossTraceCalc:function(a,n,s){for(var r=a.calcdata,c=[],f=0;f<r.length;f++){var d=r[f],g=d[0].trace;g.visible===!0&&l(g,"bar")&&g.subplot===s&&c.push(d)}var m=o({},n.radialaxis,{_id:"x"}),y=n.angularaxis;u(a,y,m,c,{mode:n.barmode,norm:n.barnorm,gap:n.bargap,groupgap:n.bargroupgap})}}},{"../../components/colorscale/calc":674,"../../components/colorscale/helpers":677,"../../lib":803,"../../registry":931,"../bar/arrays_to_calcdata":940,"../bar/cross_trace_calc":944,"../scatter/calc_selection":1220}],960:[function(i,B,V){var t=i("../../lib"),h=i("../scatterpolar/defaults").handleRThetaDefaults,p=i("../bar/style_defaults"),u=i("./attributes");B.exports=function(e,l,o,a){function n(s,r){return t.coerce(e,l,u,s,r)}h(e,l,a,n)?(n("thetaunit"),n("base"),n("offset"),n("width"),n("text"),n("hovertext"),n("hovertemplate"),p(e,l,n,o,a),t.coerceSelectionMarkerOpacity(l,n)):l.visible=!1}},{"../../lib":803,"../bar/style_defaults":956,"../scatterpolar/defaults":1294,"./attributes":958}],961:[function(i,B,V){var t=i("../../components/fx"),h=i("../../lib"),p=i("../bar/hover").getTraceColor,u=h.fillText,e=i("../scatterpolar/hover").makeHoverPointText,l=i("../../plots/polar/helpers").isPtInsidePolygon;B.exports=function(o,a,n){var s=o.cd,r=s[0].trace,c=o.subplot,f=c.radialAxis,d=c.angularAxis,g=c.vangles,m=g?l:h.isPtInsideSector,y=o.maxHoverDistance,v=d._period||2*Math.PI,T=Math.abs(f.g2p(Math.sqrt(a*a+n*n))),_=Math.atan2(n,a);if(f.range[0]>f.range[1]&&(_+=Math.PI),t.getClosest(s,function(A){return m(T,_,[A.rp0,A.rp1],[A.thetag0,A.thetag1],g)?y+Math.min(1,Math.abs(A.thetag1-A.thetag0)/v)-1+(A.rp1-T)/(A.rp1-A.rp0)-1:1/0},o),o.index!==!1){var k=s[o.index];o.x0=o.x1=k.ct[0],o.y0=o.y1=k.ct[1];var E=h.extendFlat({},k,{r:k.s,theta:k.p});return u(k,r,o),e(E,r,c,o),o.hovertemplate=r.hovertemplate,o.color=p(r,k),o.xLabelVal=o.yLabelVal=void 0,k.s<0&&(o.idealAlign="left"),[o]}}},{"../../components/fx":706,"../../lib":803,"../../plots/polar/helpers":919,"../bar/hover":948,"../scatterpolar/hover":1296}],962:[function(i,B,V){B.exports={moduleType:"trace",name:"barpolar",basePlotModule:i("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyDefaults:i("./defaults"),supplyLayoutDefaults:i("./layout_defaults"),calc:i("./calc").calc,crossTraceCalc:i("./calc").crossTraceCalc,plot:i("./plot"),colorbar:i("../scatter/marker_colorbar"),formatLabels:i("../scatterpolar/format_labels"),style:i("../bar/style").style,styleOnSelect:i("../bar/style").styleOnSelect,hoverPoints:i("./hover"),selectPoints:i("../bar/select"),meta:{}}},{"../../plots/polar":920,"../bar/select":953,"../bar/style":955,"../scatter/marker_colorbar":1236,"../scatterpolar/format_labels":1295,"./attributes":958,"./calc":959,"./defaults":960,"./hover":961,"./layout_attributes":963,"./layout_defaults":964,"./plot":965}],963:[function(i,B,V){B.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],964:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes");B.exports=function(p,u,e){var l,o={};function a(r,c){return t.coerce(p[l]||{},u[l],h,r,c)}for(var n=0;n<e.length;n++){var s=e[n];s.type==="barpolar"&&s.visible===!0&&(o[l=s.subplot]||(a("barmode"),a("bargap"),o[l]=1))}}},{"../../lib":803,"./layout_attributes":963}],965:[function(i,B,V){var t=i("@plotly/d3"),h=i("fast-isnumeric"),p=i("../../lib"),u=i("../../components/drawing"),e=i("../../plots/polar/helpers");B.exports=function(l,o,a){var n=o.xaxis,s=o.yaxis,r=o.radialAxis,c=o.angularAxis,f=function(g){var m=g.cxx,y=g.cyy;return g.vangles?function(v,T,_,k){var E,A;p.angleDelta(_,k)>0?(E=_,A=k):(E=k,A=_);var b=[e.findEnclosingVertexAngles(E,g.vangles)[0],(E+A)/2,e.findEnclosingVertexAngles(A,g.vangles)[1]];return e.pathPolygonAnnulus(v,T,E,A,b,m,y)}:function(v,T,_,k){return p.pathAnnulus(v,T,_,k,m,y)}}(o),d=o.layers.frontplot.select("g.barlayer");p.makeTraceGroups(d,a,"trace bars").each(function(){var g=t.select(this),m=p.ensureSingle(g,"g","points").selectAll("g.point").data(p.identity);m.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),m.exit().remove(),m.each(function(y){var v,T=t.select(this),_=y.rp0=r.c2p(y.s0),k=y.rp1=r.c2p(y.s1),E=y.thetag0=c.c2g(y.p0),A=y.thetag1=c.c2g(y.p1);if(h(_)&&h(k)&&h(E)&&h(A)&&_!==k&&E!==A){var b=r.c2g(y.s1),L=(E+A)/2;y.ct=[n.c2p(b*Math.cos(L)),s.c2p(b*Math.sin(L))],v=f(_,k,E,A)}else v="M0,0Z";p.ensureSingle(T,"path").attr("d",v)}),u.setClipUrl(g,o._hasClipOnAxisFalse?o.clipIds.forTraces:null,l)})}},{"../../components/drawing":688,"../../lib":803,"../../plots/polar/helpers":919,"@plotly/d3":58,"fast-isnumeric":249}],966:[function(i,B,V){var t=i("../scatter/attributes"),h=i("../bar/attributes"),p=i("../../components/color/attributes"),u=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=i("../../plots/template_attributes").hovertemplateAttrs,l=i("../../lib/extend").extendFlat,o=t.marker,a=o.line;B.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:u("x"),yhoverformat:u("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:l({},o.symbol,{arrayOk:!1,editType:"plot"}),opacity:l({},o.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:l({},o.size,{arrayOk:!1,editType:"calc"}),color:l({},o.color,{arrayOk:!1,editType:"style"}),line:{color:l({},a.color,{arrayOk:!1,dflt:p.defaultLine,editType:"style"}),width:l({},a.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:t.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:h.offsetgroup,alignmentgroup:h.alignmentgroup,selected:{marker:t.selected.marker,editType:"style"},unselected:{marker:t.unselected.marker,editType:"style"},text:l({},t.text,{}),hovertext:l({},t.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":665,"../../lib/extend":793,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../bar/attributes":941,"../scatter/attributes":1218}],967:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../plots/cartesian/axes"),p=i("../../plots/cartesian/align_period"),u=i("../../lib"),e=i("../../constants/numerical").BADNUM,l=u._;B.exports=function(m,y){var v,T,_,k,E,A,b,L=m._fullLayout,w=h.getFromId(m,y.xaxis||"x"),C=h.getFromId(m,y.yaxis||"y"),S=[],P=y.type==="violin"?"_numViolins":"_numBoxes";y.orientation==="h"?(_=w,k="x",E=C,A="y",b=!!y.yperiodalignment):(_=C,k="y",E=w,A="x",b=!!y.xperiodalignment);var z,F,q,W,X,Q,Z=function(Xe,Ye,$e,it){var ot,Et=Ye+"0"in Xe,mt="d"+Ye in Xe;if(Ye in Xe||Et&&mt){var tt=$e.makeCalcdata(Xe,Ye);return[p(Xe,$e,Ye,tt).vals,tt]}ot=Et?Xe[Ye+"0"]:"name"in Xe&&($e.type==="category"||t(Xe.name)&&["linear","log"].indexOf($e.type)!==-1||u.isDateTime(Xe.name)&&$e.type==="date")?Xe.name:it;for(var Ke=$e.type==="multicategory"?$e.r2c_just_indices(ot):$e.d2c(ot,0,Xe[Ye+"calendar"]),Mt=Xe._length,Jt=new Array(Mt),$t=0;$t<Mt;$t++)Jt[$t]=Ke;return[Jt]}(y,A,E,L[P]),Y=Z[0],N=Z[1],J=u.distinctVals(Y,E),D=J.vals,U=J.minDiff/2,G=(y.boxpoints||y.points)==="all"?u.identity:function(Xe){return Xe.v<z.lf||Xe.v>z.uf};if(y._hasPreCompStats){var $=y[k],K=function(Xe){return _.d2c((y[Xe]||[])[v])},re=1/0,ne=-1/0;for(v=0;v<y._length;v++){var ae=Y[v];if(t(ae)){if((z={}).pos=z[A]=ae,b&&N&&(z.orig_p=N[v]),z.q1=K("q1"),z.med=K("median"),z.q3=K("q3"),F=[],$&&u.isArrayOrTypedArray($[v]))for(T=0;T<$[v].length;T++)(Q=_.d2c($[v][T]))!==e&&(a(X={v:Q,i:[v,T]},y,[v,T]),F.push(X));if(z.pts=F.sort(n),W=(q=z[k]=F.map(s)).length,z.med!==e&&z.q1!==e&&z.q3!==e&&z.med>=z.q1&&z.q3>=z.med){var ie=K("lowerfence");z.lf=ie!==e&&ie<=z.q1?ie:r(z,q,W);var he=K("upperfence");z.uf=he!==e&&he>=z.q3?he:c(z,q,W);var se=K("mean");z.mean=se!==e?se:W?u.mean(q,W):(z.q1+z.q3)/2;var de=K("sd");z.sd=se!==e&&de>=0?de:W?u.stdev(q,W,z.mean):z.q3-z.q1,z.lo=f(z),z.uo=d(z);var ce=K("notchspan");ce=ce!==e&&ce>0?ce:g(z,W),z.ln=z.med-ce,z.un=z.med+ce;var ve=z.lf,Ee=z.uf;y.boxpoints&&q.length&&(ve=Math.min(ve,q[0]),Ee=Math.max(Ee,q[W-1])),y.notched&&(ve=Math.min(ve,z.ln),Ee=Math.max(Ee,z.un)),z.min=ve,z.max=Ee}else{var Le;u.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+z.q1,"median = "+z.med,"q3 = "+z.q3].join(`
`)),Le=z.med!==e?z.med:z.q1!==e?z.q3!==e?(z.q1+z.q3)/2:z.q1:z.q3!==e?z.q3:0,z.med=Le,z.q1=z.q3=Le,z.lf=z.uf=Le,z.mean=z.sd=Le,z.ln=z.un=Le,z.min=z.max=Le}re=Math.min(re,z.min),ne=Math.max(ne,z.max),z.pts2=F.filter(G),S.push(z)}}y._extremes[_._id]=h.findExtremes(_,[re,ne],{padded:!0})}else{var Te=_.makeCalcdata(y,k),xe=function(Xe,Ye){for(var $e=Xe.length,it=new Array($e+1),ot=0;ot<$e;ot++)it[ot]=Xe[ot]-Ye;return it[$e]=Xe[$e-1]+Ye,it}(D,U),fe=D.length,ge=function(Xe){for(var Ye=new Array(Xe),$e=0;$e<Xe;$e++)Ye[$e]=[];return Ye}(fe);for(v=0;v<y._length;v++)if(Q=Te[v],t(Q)){var ke=u.findBin(Y[v],xe);ke>=0&&ke<fe&&(a(X={v:Q,i:v},y,v),ge[ke].push(X))}var Me=1/0,Se=-1/0,De=y.quartilemethod,Be=De==="exclusive",We=De==="inclusive";for(v=0;v<fe;v++)if(ge[v].length>0){var Qe,Oe;(z={}).pos=z[A]=D[v],F=z.pts=ge[v].sort(n),W=(q=z[k]=F.map(s)).length,z.min=q[0],z.max=q[W-1],z.mean=u.mean(q,W),z.sd=u.stdev(q,W,z.mean),z.med=u.interp(q,.5),W%2&&(Be||We)?(Be?(Qe=q.slice(0,W/2),Oe=q.slice(W/2+1)):We&&(Qe=q.slice(0,W/2+1),Oe=q.slice(W/2)),z.q1=u.interp(Qe,.5),z.q3=u.interp(Oe,.5)):(z.q1=u.interp(q,.25),z.q3=u.interp(q,.75)),z.lf=r(z,q,W),z.uf=c(z,q,W),z.lo=f(z),z.uo=d(z);var Ue=g(z,W);z.ln=z.med-Ue,z.un=z.med+Ue,Me=Math.min(Me,z.ln),Se=Math.max(Se,z.un),z.pts2=F.filter(G),S.push(z)}y._extremes[_._id]=h.findExtremes(_,y.notched?Te.concat([Me,Se]):Te,{padded:!0})}return function(Xe,Ye){if(u.isArrayOrTypedArray(Ye.selectedpoints))for(var $e=0;$e<Xe.length;$e++){for(var it=Xe[$e].pts||[],ot={},Et=0;Et<it.length;Et++)ot[it[Et].i]=Et;u.tagSelected(it,Ye,ot)}}(S,y),S.length>0?(S[0].t={num:L[P],dPos:U,posLetter:A,valLetter:k,labels:{med:l(m,"median:"),min:l(m,"min:"),q1:l(m,"q1:"),q3:l(m,"q3:"),max:l(m,"max:"),mean:y.boxmean==="sd"?l(m,"mean ± σ:"):l(m,"mean:"),lf:l(m,"lower fence:"),uf:l(m,"upper fence:")}},L[P]++,S):[{t:{empty:!0}}]};var o={text:"tx",hovertext:"htx"};function a(m,y,v){for(var T in o)u.isArrayOrTypedArray(y[T])&&(Array.isArray(v)?u.isArrayOrTypedArray(y[T][v[0]])&&(m[o[T]]=y[T][v[0]][v[1]]):m[o[T]]=y[T][v])}function n(m,y){return m.v-y.v}function s(m){return m.v}function r(m,y,v){return v===0?m.q1:Math.min(m.q1,y[Math.min(u.findBin(2.5*m.q1-1.5*m.q3,y,!0)+1,v-1)])}function c(m,y,v){return v===0?m.q3:Math.max(m.q3,y[Math.max(u.findBin(2.5*m.q3-1.5*m.q1,y),0)])}function f(m){return 4*m.q1-3*m.q3}function d(m){return 4*m.q3-3*m.q1}function g(m,y){return y===0?0:1.57*(m.q3-m.q1)/Math.sqrt(y)}},{"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/align_period":851,"../../plots/cartesian/axes":854,"fast-isnumeric":249}],968:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../../lib"),p=i("../../plots/cartesian/constraints").getAxisGroup,u=["v","h"];function e(l,o,a,n){var s,r,c,f=o.calcdata,d=o._fullLayout,g=n._id,m=g.charAt(0),y=[],v=0;for(s=0;s<a.length;s++)for(c=f[a[s]],r=0;r<c.length;r++)y.push(n.c2l(c[r].pos,!0)),v+=(c[r].pts2||[]).length;if(y.length){var T=h.distinctVals(y);n.type!=="category"&&n.type!=="multicategory"||(T.minDiff=1);var _=T.minDiff/2;t.minDtick(n,T.minDiff,T.vals[0],!0);var k=d[l==="violin"?"_numViolins":"_numBoxes"],E=d[l+"mode"]==="group"&&k>1,A=1-d[l+"gap"],b=1-d[l+"groupgap"];for(s=0;s<a.length;s++){var L,w,C,S,P,z,F=(c=f[a[s]])[0].trace,q=c[0].t,W=F.width,X=F.side;if(W)L=w=S=W/2,C=0;else if(L=_,E){var Q=p(d,n._id)+F.orientation,Z=(d._alignmentOpts[Q]||{})[F.alignmentgroup]||{},Y=Object.keys(Z.offsetGroups||{}).length,N=Y||k;w=L*A*b/N,C=2*L*(((Y?F._offsetIndex:q.num)+.5)/N-.5)*A,S=L*A/N}else w=L*A*b,C=0,S=L;q.dPos=L,q.bPos=C,q.bdPos=w,q.wHover=S;var J,D,U,G,$,K,re=C+w,ne=!!W;if(X==="positive"?(P=L*(W?1:.5),J=re,z=J=C):X==="negative"?(P=J=C,z=L*(W?1:.5),D=re):(P=z=L,J=D=re),(F.boxpoints||F.points)&&v>0){var ae=F.pointpos,ie=F.jitter,he=F.marker.size/2,se=0;ae+ie>=0&&((se=re*(ae+ie))>P?(ne=!0,$=he,U=se):se>J&&($=he,U=P)),se<=P&&(U=P);var de=0;ae-ie<=0&&((de=-re*(ae-ie))>z?(ne=!0,K=he,G=de):de>D&&(K=he,G=z)),de<=z&&(G=z)}else U=P,G=z;var ce=new Array(c.length);for(r=0;r<c.length;r++)ce[r]=c[r].pos;F._extremes[g]=t.findExtremes(n,ce,{padded:ne,vpadminus:G,vpadplus:U,vpadLinearized:!0,ppadminus:{x:K,y:$}[m],ppadplus:{x:$,y:K}[m]})}}}B.exports={crossTraceCalc:function(l,o){for(var a=l.calcdata,n=o.xaxis,s=o.yaxis,r=0;r<u.length;r++){for(var c=u[r],f=c==="h"?s:n,d=[],g=0;g<a.length;g++){var m=a[g],y=m[0].t,v=m[0].trace;v.visible!==!0||v.type!=="box"&&v.type!=="candlestick"||y.empty||(v.orientation||"v")!==c||v.xaxis!==n._id||v.yaxis!==s._id||d.push(g)}e("box",l,d,f)}},setPositionOffset:e}},{"../../lib":803,"../../plots/cartesian/axes":854,"../../plots/cartesian/constraints":862}],969:[function(i,B,V){var t=i("../../lib"),h=i("../../registry"),p=i("../../components/color"),u=i("../scatter/period_defaults"),e=i("../bar/defaults").handleGroupingDefaults,l=i("../../plots/cartesian/axis_autotype"),o=i("./attributes");function a(s,r,c,f){function d(X){var Q=0;return X&&X.length&&(Q+=1,t.isArrayOrTypedArray(X[0])&&X[0].length&&(Q+=1)),Q}function g(X){return t.validate(s[X],o[X])}var m,y=c("y"),v=c("x");if(r.type==="box"){var T=c("q1"),_=c("median"),k=c("q3");r._hasPreCompStats=T&&T.length&&_&&_.length&&k&&k.length,m=Math.min(t.minRowLength(T),t.minRowLength(_),t.minRowLength(k))}var E,A,b=d(y),L=d(v),w=b&&t.minRowLength(y),C=L&&t.minRowLength(v),S=f.calendar,P={autotypenumbers:f.autotypenumbers};if(r._hasPreCompStats)switch(String(L)+String(b)){case"00":var z=g("x0")||g("dx");E=(g("y0")||g("dy"))&&!z?"h":"v",A=m;break;case"10":E="v",A=Math.min(m,C);break;case"20":E="h",A=Math.min(m,v.length);break;case"01":E="h",A=Math.min(m,w);break;case"02":E="v",A=Math.min(m,y.length);break;case"12":E="v",A=Math.min(m,C,y.length);break;case"21":E="h",A=Math.min(m,v.length,w);break;case"11":A=0;break;case"22":var F,q=!1;for(F=0;F<v.length;F++)if(l(v[F],S,P)==="category"){q=!0;break}if(q)E="v",A=Math.min(m,C,y.length);else{for(F=0;F<y.length;F++)if(l(y[F],S,P)==="category"){q=!0;break}q?(E="h",A=Math.min(m,v.length,w)):(E="v",A=Math.min(m,C,y.length))}}else b>0?(E="v",A=L>0?Math.min(C,w):Math.min(w)):L>0?(E="h",A=Math.min(C)):A=0;if(A){r._length=A;var W=c("orientation",E);r._hasPreCompStats?W==="v"&&L===0?(c("x0",0),c("dx",1)):W==="h"&&b===0&&(c("y0",0),c("dy",1)):W==="v"&&L===0?c("x0"):W==="h"&&b===0&&c("y0"),h.getComponentMethod("calendars","handleTraceDefaults")(s,r,["x","y"],f)}else r.visible=!1}function n(s,r,c,f){var d=f.prefix,g=t.coerce2(s,r,o,"marker.outliercolor"),m=c("marker.line.outliercolor"),y="outliers";r._hasPreCompStats?y="all":(g||m)&&(y="suspectedoutliers");var v=c(d+"points",y);v?(c("jitter",v==="all"?.3:0),c("pointpos",v==="all"?-1.5:0),c("marker.symbol"),c("marker.opacity"),c("marker.size"),c("marker.color",r.line.color),c("marker.line.color"),c("marker.line.width"),v==="suspectedoutliers"&&(c("marker.line.outliercolor",r.marker.color),c("marker.line.outlierwidth")),c("selected.marker.color"),c("unselected.marker.color"),c("selected.marker.size"),c("unselected.marker.size"),c("text"),c("hovertext")):delete r.marker;var T=c("hoveron");T!=="all"&&T.indexOf("points")===-1||c("hovertemplate"),t.coerceSelectionMarkerOpacity(r,c)}B.exports={supplyDefaults:function(s,r,c,f){function d(k,E){return t.coerce(s,r,o,k,E)}if(a(s,r,d,f),r.visible!==!1){u(s,r,f,d),d("xhoverformat"),d("yhoverformat");var g=r._hasPreCompStats;g&&(d("lowerfence"),d("upperfence")),d("line.color",(s.marker||{}).color||c),d("line.width"),d("fillcolor",p.addOpacity(r.line.color,.5));var m=!1;if(g){var y=d("mean"),v=d("sd");y&&y.length&&(m=!0,v&&v.length&&(m="sd"))}d("boxmean",m),d("whiskerwidth"),d("width"),d("quartilemethod");var T=!1;if(g){var _=d("notchspan");_&&_.length&&(T=!0)}else t.validate(s.notchwidth,o.notchwidth)&&(T=!0);d("notched",T)&&d("notchwidth"),n(s,r,d,{prefix:"box"})}},crossTraceDefaults:function(s,r){var c,f;function d(y){return t.coerce(f._input,f,o,y)}for(var g=0;g<s.length;g++){var m=(f=s[g]).type;m!=="box"&&m!=="violin"||(c=f._input,r[m+"mode"]==="group"&&e(c,f,r,d))}},handleSampleDefaults:a,handlePointsDefaults:n}},{"../../components/color":666,"../../lib":803,"../../plots/cartesian/axis_autotype":855,"../../registry":931,"../bar/defaults":945,"../scatter/period_defaults":1238,"./attributes":966}],970:[function(i,B,V){B.exports=function(t,h){return h.hoverOnBox&&(t.hoverOnBox=h.hoverOnBox),"xVal"in h&&(t.x=h.xVal),"yVal"in h&&(t.y=h.yVal),h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),t}},{}],971:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../../lib"),p=i("../../components/fx"),u=i("../../components/color"),e=h.fillText;function l(a,n,s,r){var c,f,d,g,m,y,v,T,_,k,E,A,b,L,w=a.cd,C=a.xa,S=a.ya,P=w[0].trace,z=w[0].t,F=P.type==="violin",q=[],W=z.bdPos,X=z.wHover,Q=function(se){return d.c2l(se.pos)+z.bPos-d.c2l(y)};F&&P.side!=="both"?(P.side==="positive"&&(_=function(se){var de=Q(se);return p.inbox(de,de+X,k)},A=W,b=0),P.side==="negative"&&(_=function(se){var de=Q(se);return p.inbox(de-X,de,k)},A=0,b=W)):(_=function(se){var de=Q(se);return p.inbox(de-X,de+X,k)},A=b=W),L=F?function(se){return p.inbox(se.span[0]-m,se.span[1]-m,k)}:function(se){return p.inbox(se.min-m,se.max-m,k)},P.orientation==="h"?(m=n,y=s,v=L,T=_,c="y",d=S,f="x",g=C):(m=s,y=n,v=_,T=L,c="x",d=C,f="y",g=S);var Z=Math.min(1,W/Math.abs(d.r2c(d.range[1])-d.r2c(d.range[0])));function Y(se){return(v(se)+T(se))/2}k=a.maxHoverDistance-Z,E=a.maxSpikeDistance-Z;var N=p.getDistanceFunction(r,v,T,Y);if(p.getClosest(w,N,a),a.index===!1)return[];var J=w[a.index],D=P.line.color,U=(P.marker||{}).color;u.opacity(D)&&P.line.width?a.color=D:u.opacity(U)&&P.boxpoints?a.color=U:a.color=P.fillcolor,a[c+"0"]=d.c2p(J.pos+z.bPos-b,!0),a[c+"1"]=d.c2p(J.pos+z.bPos+A,!0),a[c+"LabelVal"]=J.orig_p!==void 0?J.orig_p:J.pos;var G=c+"Spike";a.spikeDistance=Y(J)*E/k,a[G]=d.c2p(J.pos,!0);var $={},K=["med","q1","q3","min","max"];(P.boxmean||(P.meanline||{}).visible)&&K.push("mean"),(P.boxpoints||P.points)&&K.push("lf","uf");for(var re=0;re<K.length;re++){var ne=K[re];if(ne in J&&!(J[ne]in $)){$[J[ne]]=!0;var ae=J[ne],ie=g.c2p(ae,!0),he=h.extendFlat({},a);he.attr=ne,he[f+"0"]=he[f+"1"]=ie,he[f+"LabelVal"]=ae,he[f+"Label"]=(z.labels?z.labels[ne]+" ":"")+t.hoverLabelText(g,ae,P[f+"hoverformat"]),he.hoverOnBox=!0,ne==="mean"&&"sd"in J&&P.boxmean==="sd"&&(he[f+"err"]=J.sd),a.name="",a.spikeDistance=void 0,a[G]=void 0,he.hovertemplate=!1,q.push(he)}}return q}function o(a,n,s){for(var r,c,f,d=a.cd,g=a.xa,m=a.ya,y=d[0].trace,v=g.c2p(n),T=m.c2p(s),_=p.quadrature(function(F){var q=Math.max(3,F.mrc||0);return Math.max(Math.abs(g.c2p(F.x)-v)-q,1-3/q)},function(F){var q=Math.max(3,F.mrc||0);return Math.max(Math.abs(m.c2p(F.y)-T)-q,1-3/q)}),k=!1,E=0;E<d.length;E++){c=d[E];for(var A=0;A<(c.pts||[]).length;A++){var b=_(f=c.pts[A]);b<=a.distance&&(a.distance=b,k=[E,A])}}if(!k)return!1;f=(c=d[k[0]]).pts[k[1]];var L=g.c2p(f.x,!0),w=m.c2p(f.y,!0),C=f.mrc||1;r=h.extendFlat({},a,{index:f.i,color:(y.marker||{}).color,name:y.name,x0:L-C,x1:L+C,y0:w-C,y1:w+C,spikeDistance:a.distance,hovertemplate:y.hovertemplate});var S,P=c.orig_p,z=P!==void 0?P:c.pos;return y.orientation==="h"?(S=m,r.xLabelVal=f.x,r.yLabelVal=z):(S=g,r.xLabelVal=z,r.yLabelVal=f.y),r[S._id.charAt(0)+"Spike"]=S.c2p(c.pos,!0),e(f,y,r),r}B.exports={hoverPoints:function(a,n,s,r){var c,f=a.cd[0].trace.hoveron,d=[];return f.indexOf("boxes")!==-1&&(d=d.concat(l(a,n,s,r))),f.indexOf("points")!==-1&&(c=o(a,n,s)),r==="closest"?c?[c]:d:(c&&d.push(c),d)},hoverOnBoxes:l,hoverOnPoints:o}},{"../../components/color":666,"../../components/fx":706,"../../lib":803,"../../plots/cartesian/axes":854}],972:[function(i,B,V){B.exports={attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyDefaults:i("./defaults").supplyDefaults,crossTraceDefaults:i("./defaults").crossTraceDefaults,supplyLayoutDefaults:i("./layout_defaults").supplyLayoutDefaults,calc:i("./calc"),crossTraceCalc:i("./cross_trace_calc").crossTraceCalc,plot:i("./plot").plot,style:i("./style").style,styleOnSelect:i("./style").styleOnSelect,hoverPoints:i("./hover").hoverPoints,eventData:i("./event_data"),selectPoints:i("./select"),moduleType:"trace",name:"box",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":868,"./attributes":966,"./calc":967,"./cross_trace_calc":968,"./defaults":969,"./event_data":970,"./hover":971,"./layout_attributes":973,"./layout_defaults":974,"./plot":975,"./select":976,"./style":977}],973:[function(i,B,V){B.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],974:[function(i,B,V){var t=i("../../registry"),h=i("../../lib"),p=i("./layout_attributes");function u(e,l,o,a,n){for(var s=n+"Layout",r=!1,c=0;c<o.length;c++){var f=o[c];if(t.traceIs(f,s)){r=!0;break}}r&&(a(n+"mode"),a(n+"gap"),a(n+"groupgap"))}B.exports={supplyLayoutDefaults:function(e,l,o){u(0,0,o,function(a,n){return h.coerce(e,l,p,a,n)},"box")},_supply:u}},{"../../lib":803,"../../registry":931,"./layout_attributes":973}],975:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../components/drawing");function u(o,a,n,s){var r,c,f=n.orientation==="h",d=a.val,g=a.pos,m=!!g.rangebreaks,y=s.bPos,v=s.wdPos||0,T=s.bPosPxOffset||0,_=n.whiskerwidth||0,k=n.notched||!1,E=k?1-2*n.notchwidth:1;Array.isArray(s.bdPos)?(r=s.bdPos[0],c=s.bdPos[1]):(r=s.bdPos,c=s.bdPos);var A=o.selectAll("path.box").data(n.type!=="violin"||n.box.visible?h.identity:[]);A.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),A.exit().remove(),A.each(function(b){if(b.empty)return"M0,0Z";var L=g.c2l(b.pos+y,!0),w=g.l2p(L-r)+T,C=g.l2p(L+c)+T,S=m?(w+C)/2:g.l2p(L)+T,P=n.whiskerwidth,z=m?w*P+(1-P)*S:g.l2p(L-v)+T,F=m?C*P+(1-P)*S:g.l2p(L+v)+T,q=g.l2p(L-r*E)+T,W=g.l2p(L+c*E)+T,X=d.c2p(b.q1,!0),Q=d.c2p(b.q3,!0),Z=h.constrain(d.c2p(b.med,!0),Math.min(X,Q)+1,Math.max(X,Q)-1),Y=b.lf===void 0||n.boxpoints===!1,N=d.c2p(Y?b.min:b.lf,!0),J=d.c2p(Y?b.max:b.uf,!0),D=d.c2p(b.ln,!0),U=d.c2p(b.un,!0);f?t.select(this).attr("d","M"+Z+","+q+"V"+W+"M"+X+","+w+"V"+C+(k?"H"+D+"L"+Z+","+W+"L"+U+","+C:"")+"H"+Q+"V"+w+(k?"H"+U+"L"+Z+","+q+"L"+D+","+w:"")+"ZM"+X+","+S+"H"+N+"M"+Q+","+S+"H"+J+(_===0?"":"M"+N+","+z+"V"+F+"M"+J+","+z+"V"+F)):t.select(this).attr("d","M"+q+","+Z+"H"+W+"M"+w+","+X+"H"+C+(k?"V"+D+"L"+W+","+Z+"L"+C+","+U:"")+"V"+Q+"H"+w+(k?"V"+U+"L"+q+","+Z+"L"+w+","+D:"")+"ZM"+S+","+X+"V"+N+"M"+S+","+Q+"V"+J+(_===0?"":"M"+z+","+N+"H"+F+"M"+z+","+J+"H"+F))})}function e(o,a,n,s){var r=a.x,c=a.y,f=s.bdPos,d=s.bPos,g=n.boxpoints||n.points;h.seedPseudoRandom();var m=o.selectAll("g.points").data(g?function(v){return v.forEach(function(T){T.t=s,T.trace=n}),v}:[]);m.enter().append("g").attr("class","points"),m.exit().remove();var y=m.selectAll("path").data(function(v){var T,_,k=v.pts2,E=Math.max((v.max-v.min)/10,v.q3-v.q1),A=1e-9*E,b=.01*E,L=[],w=0;if(n.jitter){if(E===0)for(w=1,L=new Array(k.length),T=0;T<k.length;T++)L[T]=1;else for(T=0;T<k.length;T++){var C=Math.max(0,T-5),S=k[C].v,P=Math.min(k.length-1,T+5),z=k[P].v;g!=="all"&&(k[T].v<v.lf?z=Math.min(z,v.lf):S=Math.max(S,v.uf));var F=Math.sqrt(b*(P-C)/(z-S+A))||0;F=h.constrain(Math.abs(F),0,1),L.push(F),w=Math.max(F,w)}_=2*n.jitter/(w||1)}for(T=0;T<k.length;T++){var q=k[T],W=q.v,X=n.jitter?_*L[T]*(h.pseudoRandom()-.5):0,Q=v.pos+d+f*(n.pointpos+X);n.orientation==="h"?(q.y=Q,q.x=W):(q.x=Q,q.y=W),g==="suspectedoutliers"&&W<v.uo&&W>v.lo&&(q.so=!0)}return k});y.enter().append("path").classed("point",!0),y.exit().remove(),y.call(p.translatePoints,r,c)}function l(o,a,n,s){var r,c,f=a.val,d=a.pos,g=!!d.rangebreaks,m=s.bPos,y=s.bPosPxOffset||0,v=n.boxmean||(n.meanline||{}).visible;Array.isArray(s.bdPos)?(r=s.bdPos[0],c=s.bdPos[1]):(r=s.bdPos,c=s.bdPos);var T=o.selectAll("path.mean").data(n.type==="box"&&n.boxmean||n.type==="violin"&&n.box.visible&&n.meanline.visible?h.identity:[]);T.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),T.exit().remove(),T.each(function(_){var k=d.c2l(_.pos+m,!0),E=d.l2p(k-r)+y,A=d.l2p(k+c)+y,b=g?(E+A)/2:d.l2p(k)+y,L=f.c2p(_.mean,!0),w=f.c2p(_.mean-_.sd,!0),C=f.c2p(_.mean+_.sd,!0);n.orientation==="h"?t.select(this).attr("d","M"+L+","+E+"V"+A+(v==="sd"?"m0,0L"+w+","+b+"L"+L+","+E+"L"+C+","+b+"Z":"")):t.select(this).attr("d","M"+E+","+L+"H"+A+(v==="sd"?"m0,0L"+b+","+w+"L"+E+","+L+"L"+b+","+C+"Z":""))})}B.exports={plot:function(o,a,n,s){var r=a.xaxis,c=a.yaxis;h.makeTraceGroups(s,n,"trace boxes").each(function(f){var d,g,m=t.select(this),y=f[0],v=y.t,T=y.trace;v.wdPos=v.bdPos*T.whiskerwidth,T.visible!==!0||v.empty?m.remove():(T.orientation==="h"?(d=c,g=r):(d=r,g=c),u(m,{pos:d,val:g},T,v),e(m,{x:r,y:c},T,v),l(m,{pos:d,val:g},T,v))})},plotBoxAndWhiskers:u,plotPoints:e,plotBoxMean:l}},{"../../components/drawing":688,"../../lib":803,"@plotly/d3":58}],976:[function(i,B,V){B.exports=function(t,h){var p,u,e=t.cd,l=t.xaxis,o=t.yaxis,a=[];if(h===!1)for(p=0;p<e.length;p++)for(u=0;u<(e[p].pts||[]).length;u++)e[p].pts[u].selected=0;else for(p=0;p<e.length;p++)for(u=0;u<(e[p].pts||[]).length;u++){var n=e[p].pts[u],s=l.c2p(n.x),r=o.c2p(n.y);h.contains([s,r],null,n.i,t)?(a.push({pointNumber:n.i,x:l.c2d(n.x),y:o.c2d(n.y)}),n.selected=1):n.selected=0}return a}},{}],977:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/color"),p=i("../../components/drawing");B.exports={style:function(u,e,l){var o=l||t.select(u).selectAll("g.trace.boxes");o.style("opacity",function(a){return a[0].trace.opacity}),o.each(function(a){var n=t.select(this),s=a[0].trace,r=s.line.width;function c(g,m,y,v){g.style("stroke-width",m+"px").call(h.stroke,y).call(h.fill,v)}var f=n.selectAll("path.box");if(s.type==="candlestick")f.each(function(g){if(!g.empty){var m=t.select(this),y=s[g.dir];c(m,y.line.width,y.line.color,y.fillcolor),m.style("opacity",s.selectedpoints&&!g.selected?.3:1)}});else{c(f,r,s.line.color,s.fillcolor),n.selectAll("path.mean").style({"stroke-width":r,"stroke-dasharray":2*r+"px,"+r+"px"}).call(h.stroke,s.line.color);var d=n.selectAll("path.point");p.pointStyle(d,s,u)}})},styleOnSelect:function(u,e,l){var o=e[0].trace,a=l.selectAll("path.point");o.selectedpoints?p.selectedPointStyle(a,o):p.pointStyle(a,o,u)}}},{"../../components/color":666,"../../components/drawing":688,"@plotly/d3":58}],978:[function(i,B,V){var t=i("../../lib").extendFlat,h=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=i("../ohlc/attributes"),u=i("../box/attributes");function e(l){return{line:{color:t({},u.line.color,{dflt:l}),width:u.line.width,editType:"style"},fillcolor:u.fillcolor,editType:"style"}}B.exports={xperiod:p.xperiod,xperiod0:p.xperiod0,xperiodalignment:p.xperiodalignment,xhoverformat:h("x"),yhoverformat:h("y"),x:p.x,open:p.open,high:p.high,low:p.low,close:p.close,line:{width:t({},u.line.width,{}),editType:"style"},increasing:e(p.increasing.line.color.dflt),decreasing:e(p.decreasing.line.color.dflt),text:p.text,hovertext:p.hovertext,whiskerwidth:t({},u.whiskerwidth,{dflt:0}),hoverlabel:p.hoverlabel}},{"../../lib":803,"../../plots/cartesian/axis_format_attributes":857,"../box/attributes":966,"../ohlc/attributes":1164}],979:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes"),p=i("../../plots/cartesian/align_period"),u=i("../ohlc/calc").calcCommon;function e(l,o,a,n){return{min:a,q1:Math.min(l,n),med:n,q3:Math.max(l,n),max:o}}B.exports=function(l,o){var a=l._fullLayout,n=h.getFromId(l,o.xaxis),s=h.getFromId(l,o.yaxis),r=n.makeCalcdata(o,"x"),c=p(o,n,"x",r).vals,f=u(l,o,r,c,s,e);return f.length?(t.extendFlat(f[0].t,{num:a._numBoxes,dPos:t.distinctVals(c).minDiff/2,posLetter:"x",valLetter:"y"}),a._numBoxes++,f):[{t:{empty:!0}}]}},{"../../lib":803,"../../plots/cartesian/align_period":851,"../../plots/cartesian/axes":854,"../ohlc/calc":1165}],980:[function(i,B,V){var t=i("../../lib"),h=i("../../components/color"),p=i("../ohlc/ohlc_defaults"),u=i("../scatter/period_defaults"),e=i("./attributes");function l(o,a,n,s){var r=n(s+".line.color");n(s+".line.width",a.line.width),n(s+".fillcolor",h.addOpacity(r,.5))}B.exports=function(o,a,n,s){function r(c,f){return t.coerce(o,a,e,c,f)}p(o,a,r,s)?(u(o,a,s,r,{x:!0}),r("xhoverformat"),r("yhoverformat"),r("line.width"),l(o,a,r,"increasing"),l(o,a,r,"decreasing"),r("text"),r("hovertext"),r("whiskerwidth"),s._requestRangeslider[a.xaxis]=!0):a.visible=!1}},{"../../components/color":666,"../../lib":803,"../ohlc/ohlc_defaults":1169,"../scatter/period_defaults":1238,"./attributes":978}],981:[function(i,B,V){B.exports={moduleType:"trace",name:"candlestick",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:i("./attributes"),layoutAttributes:i("../box/layout_attributes"),supplyLayoutDefaults:i("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:i("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:i("./defaults"),calc:i("./calc"),plot:i("../box/plot").plot,layerName:"boxlayer",style:i("../box/style").style,hoverPoints:i("../ohlc/hover").hoverPoints,selectPoints:i("../ohlc/select")}},{"../../plots/cartesian":868,"../box/cross_trace_calc":968,"../box/layout_attributes":973,"../box/layout_defaults":974,"../box/plot":975,"../box/style":977,"../ohlc/hover":1167,"../ohlc/select":1171,"./attributes":978,"./calc":979,"./defaults":980}],982:[function(i,B,V){var t=i("./axis_defaults"),h=i("../../plot_api/plot_template");B.exports=function(p,u,e,l,o){l("a")||(l("da"),l("a0")),l("b")||(l("db"),l("b0")),function(a,n,s,r){["aaxis","baxis"].forEach(function(c){var f=c.charAt(0),d=a[c]||{},g=h.newContainer(n,c),m={tickfont:"x",id:f+"axis",letter:f,font:n.font,name:c,data:a[f],calendar:n.calendar,dfltColor:r,bgColor:s.paper_bgcolor,autotypenumbersDflt:s.autotypenumbers,fullLayout:s};t(d,g,m),g._categories=g._categories||[],a[c]||d.type==="-"||(a[c]={type:d.type})})}(p,u,e,o)}},{"../../plot_api/plot_template":843,"./axis_defaults":987}],983:[function(i,B,V){var t=i("../../lib").isArrayOrTypedArray;B.exports=function(h){return function p(u,e){if(!t(u)||e>=10)return null;for(var l=1/0,o=-1/0,a=u.length,n=0;n<a;n++){var s=u[n];if(t(s)){var r=p(s,e+1);r&&(l=Math.min(r[0],l),o=Math.max(r[1],o))}else l=Math.min(s,l),o=Math.max(s,o)}return[l,o]}(h,0)}},{"../../lib":803}],984:[function(i,B,V){var t=i("../../plots/font_attributes"),h=i("./axis_attributes"),p=i("../../components/color/attributes"),u=t({editType:"calc"});u.family.dflt='"Open Sans", verdana, arial, sans-serif',u.size.dflt=12,u.color.dflt=p.defaultLine,B.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:h,baxis:h,font:u,color:{valType:"color",dflt:p.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":665,"../../plots/font_attributes":883,"./axis_attributes":986}],985:[function(i,B,V){var t=i("../../lib").isArrayOrTypedArray;B.exports=function(h,p,u,e){var l,o,a,n,s,r,c,f,d,g,m,y,v,T=t(u)?"a":"b",_=(T==="a"?h.aaxis:h.baxis).smoothing,k=T==="a"?h.a2i:h.b2j,E=T==="a"?u:e,A=T==="a"?e:u,b=T==="a"?p.a.length:p.b.length,L=T==="a"?p.b.length:p.a.length,w=Math.floor(T==="a"?h.b2j(A):h.a2i(A)),C=T==="a"?function(J){return h.evalxy([],J,w)}:function(J){return h.evalxy([],w,J)};_&&(a=Math.max(0,Math.min(L-2,w)),n=w-a,o=T==="a"?function(J,D){return h.dxydi([],J,a,D,n)}:function(J,D){return h.dxydj([],a,J,n,D)});var S=k(E[0]),P=k(E[1]),z=S<P?1:-1,F=1e-8*(P-S),q=z>0?Math.floor:Math.ceil,W=z>0?Math.ceil:Math.floor,X=z>0?Math.min:Math.max,Q=z>0?Math.max:Math.min,Z=q(S+F),Y=W(P-F),N=[[c=C(S)]];for(l=Z;l*z<Y*z;l+=z)s=[],m=Q(S,l),v=(y=X(P,l+z))-m,r=Math.max(0,Math.min(b-2,Math.floor(.5*(m+y)))),f=C(y),_&&(d=o(r,m-r),g=o(r,y-r),s.push([c[0]+d[0]/3*v,c[1]+d[1]/3*v]),s.push([f[0]-g[0]/3*v,f[1]-g[1]/3*v])),s.push(f),N.push(s),c=f;return N}},{"../../lib":803}],986:[function(i,B,V){var t=i("../../plots/font_attributes"),h=i("../../components/color/attributes"),p=i("../../plots/cartesian/layout_attributes"),u=i("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=i("../../plot_api/edit_types").overrideAll;B.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:t({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:p.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:t({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:u("tick label")},tickformatstops:e(p.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:h.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:h.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:t({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":665,"../../plot_api/edit_types":836,"../../plots/cartesian/axis_format_attributes":857,"../../plots/cartesian/layout_attributes":869,"../../plots/font_attributes":883}],987:[function(i,B,V){var t=i("./attributes"),h=i("../../components/color").addOpacity,p=i("../../registry"),u=i("../../lib"),e=i("../../plots/cartesian/tick_value_defaults"),l=i("../../plots/cartesian/tick_label_defaults"),o=i("../../plots/cartesian/category_order_defaults"),a=i("../../plots/cartesian/set_convert"),n=i("../../plots/cartesian/axis_autotype");B.exports=function(s,r,c){var f=c.letter,d=c.font||{},g=t[f+"axis"];function m(S,P){return u.coerce(s,r,g,S,P)}function y(S,P){return u.coerce2(s,r,g,S,P)}c.name&&(r._name=c.name,r._id=c.name),m("autotypenumbers",c.autotypenumbersDflt);var v=m("type");v==="-"&&(c.data&&function(S,P){if(S.type==="-"){var z=S._id.charAt(0),F=S[z+"calendar"];S.type=n(P,F,{autotypenumbers:S.autotypenumbers})}}(r,c.data),r.type==="-"?r.type="linear":v=s.type=r.type),m("smoothing"),m("cheatertype"),m("showticklabels"),m("labelprefix",f+" = "),m("labelsuffix"),m("showtickprefix"),m("showticksuffix"),m("separatethousands"),m("tickformat"),m("exponentformat"),m("minexponent"),m("showexponent"),m("categoryorder"),m("tickmode"),m("tickvals"),m("ticktext"),m("tick0"),m("dtick"),r.tickmode==="array"&&(m("arraytick0"),m("arraydtick")),m("labelpadding"),r._hovertitle=f,v==="date"&&p.getComponentMethod("calendars","handleDefaults")(s,r,"calendar",c.calendar),a(r,c.fullLayout),r.c2p=u.identity;var T=m("color",c.dfltColor),_=T===s.color?T:d.color;m("title.text")&&(u.coerceFont(m,"title.font",{family:d.family,size:u.bigFont(d.size),color:_}),m("title.offset")),m("tickangle"),m("autorange",!r.isValidRange(s.range))&&m("rangemode"),m("range"),r.cleanRange(),m("fixedrange"),e(s,r,m,v),l(s,r,m,v,c),o(s,r,m,{data:c.data,dataAttr:f});var k=y("gridcolor",h(T,.3)),E=y("gridwidth"),A=m("showgrid");A||(delete r.gridcolor,delete r.gridwidth);var b=y("startlinecolor",T),L=y("startlinewidth",E);m("startline",r.showgrid||!!b||!!L)||(delete r.startlinecolor,delete r.startlinewidth);var w=y("endlinecolor",T),C=y("endlinewidth",E);return m("endline",r.showgrid||!!w||!!C)||(delete r.endlinecolor,delete r.endlinewidth),A?(m("minorgridcount"),m("minorgridwidth",E),m("minorgridcolor",h(k,.06)),r.minorgridcount||(delete r.minorgridwidth,delete r.minorgridcolor)):(delete r.gridcolor,delete r.gridWidth),r.showticklabels==="none"&&(delete r.tickfont,delete r.tickangle,delete r.showexponent,delete r.exponentformat,delete r.minexponent,delete r.tickformat,delete r.showticksuffix,delete r.showtickprefix),r.showticksuffix||delete r.ticksuffix,r.showtickprefix||delete r.tickprefix,m("tickmode"),r}},{"../../components/color":666,"../../lib":803,"../../plots/cartesian/axis_autotype":855,"../../plots/cartesian/category_order_defaults":859,"../../plots/cartesian/set_convert":875,"../../plots/cartesian/tick_label_defaults":876,"../../plots/cartesian/tick_value_defaults":878,"../../registry":931,"./attributes":984}],988:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../../lib").isArray1D,p=i("./cheater_basis"),u=i("./array_minmax"),e=i("./calc_gridlines"),l=i("./calc_labels"),o=i("./calc_clippath"),a=i("../heatmap/clean_2d_array"),n=i("./smooth_fill_2d_array"),s=i("../heatmap/convert_column_xyz"),r=i("./set_convert");B.exports=function(c,f){var d=t.getFromId(c,f.xaxis),g=t.getFromId(c,f.yaxis),m=f.aaxis,y=f.baxis,v=f.x,T=f.y,_=[];v&&h(v)&&_.push("x"),T&&h(T)&&_.push("y"),_.length&&s(f,m,y,"a","b",_);var k=f._a=f._a||f.a,E=f._b=f._b||f.b;v=f._x||f.x,T=f._y||f.y;var A={};if(f._cheater){var b=m.cheatertype==="index"?k.length:k,L=y.cheatertype==="index"?E.length:E;v=p(b,L,f.cheaterslope)}f._x=v=a(v),f._y=T=a(T),n(v,k,E),n(T,k,E),r(f),f.setScale();var w=u(v),C=u(T),S=.5*(w[1]-w[0]),P=.5*(w[1]+w[0]),z=.5*(C[1]-C[0]),F=.5*(C[1]+C[0]);return w=[P-1.3*S,P+1.3*S],C=[F-1.3*z,F+1.3*z],f._extremes[d._id]=t.findExtremes(d,w,{padded:!0}),f._extremes[g._id]=t.findExtremes(g,C,{padded:!0}),e(f,"a","b"),e(f,"b","a"),l(f,m),l(f,y),A.clipsegments=o(f._xctrl,f._yctrl,m,y),A.x=v,A.y=T,A.a=k,A.b=E,[A]}},{"../../lib":803,"../../plots/cartesian/axes":854,"../heatmap/clean_2d_array":1087,"../heatmap/convert_column_xyz":1089,"./array_minmax":983,"./calc_clippath":989,"./calc_gridlines":990,"./calc_labels":991,"./cheater_basis":993,"./set_convert":1006,"./smooth_fill_2d_array":1007}],989:[function(i,B,V){B.exports=function(t,h,p,u){var e,l,o,a=[],n=!!p.smoothing,s=!!u.smoothing,r=t[0].length-1,c=t.length-1;for(e=0,l=[],o=[];e<=r;e++)l[e]=t[0][e],o[e]=h[0][e];for(a.push({x:l,y:o,bicubic:n}),e=0,l=[],o=[];e<=c;e++)l[e]=t[e][r],o[e]=h[e][r];for(a.push({x:l,y:o,bicubic:s}),e=r,l=[],o=[];e>=0;e--)l[r-e]=t[c][e],o[r-e]=h[c][e];for(a.push({x:l,y:o,bicubic:n}),e=c,l=[],o=[];e>=0;e--)l[c-e]=t[e][0],o[c-e]=h[e][0];return a.push({x:l,y:o,bicubic:s}),a}},{}],990:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../../lib/extend").extendFlat;B.exports=function(p,u,e){var l,o,a,n,s,r,c,f,d,g,m,y,v,T,_=p["_"+u],k=p[u+"axis"],E=k._gridlines=[],A=k._minorgridlines=[],b=k._boundarylines=[],L=p["_"+e],w=p[e+"axis"];k.tickmode==="array"&&(k.tickvals=_.slice());var C=p._xctrl,S=p._yctrl,P=C[0].length,z=C.length,F=p._a.length,q=p._b.length;t.prepTicks(k),k.tickmode==="array"&&delete k.tickvals;var W=k.smoothing?3:1;function X(Z){var Y,N,J,D,U,G,$,K,re,ne,ae,ie,he=[],se=[],de={};if(u==="b")for(N=p.b2j(Z),J=Math.floor(Math.max(0,Math.min(q-2,N))),D=N-J,de.length=q,de.crossLength=F,de.xy=function(ce){return p.evalxy([],ce,N)},de.dxy=function(ce,ve){return p.dxydi([],ce,J,ve,D)},Y=0;Y<F;Y++)G=Math.min(F-2,Y),$=Y-G,K=p.evalxy([],Y,N),w.smoothing&&Y>0&&(re=p.dxydi([],Y-1,J,0,D),he.push(U[0]+re[0]/3),se.push(U[1]+re[1]/3),ne=p.dxydi([],Y-1,J,1,D),he.push(K[0]-ne[0]/3),se.push(K[1]-ne[1]/3)),he.push(K[0]),se.push(K[1]),U=K;else for(Y=p.a2i(Z),G=Math.floor(Math.max(0,Math.min(F-2,Y))),$=Y-G,de.length=F,de.crossLength=q,de.xy=function(ce){return p.evalxy([],Y,ce)},de.dxy=function(ce,ve){return p.dxydj([],G,ce,$,ve)},N=0;N<q;N++)J=Math.min(q-2,N),D=N-J,K=p.evalxy([],Y,N),w.smoothing&&N>0&&(ae=p.dxydj([],G,N-1,$,0),he.push(U[0]+ae[0]/3),se.push(U[1]+ae[1]/3),ie=p.dxydj([],G,N-1,$,1),he.push(K[0]-ie[0]/3),se.push(K[1]-ie[1]/3)),he.push(K[0]),se.push(K[1]),U=K;return de.axisLetter=u,de.axis=k,de.crossAxis=w,de.value=Z,de.constvar=e,de.index=f,de.x=he,de.y=se,de.smoothing=w.smoothing,de}function Q(Z){var Y,N,J,D,U,G=[],$=[],K={};if(K.length=_.length,K.crossLength=L.length,u==="b")for(J=Math.max(0,Math.min(q-2,Z)),U=Math.min(1,Math.max(0,Z-J)),K.xy=function(re){return p.evalxy([],re,Z)},K.dxy=function(re,ne){return p.dxydi([],re,J,ne,U)},Y=0;Y<P;Y++)G[Y]=C[Z*W][Y],$[Y]=S[Z*W][Y];else for(N=Math.max(0,Math.min(F-2,Z)),D=Math.min(1,Math.max(0,Z-N)),K.xy=function(re){return p.evalxy([],Z,re)},K.dxy=function(re,ne){return p.dxydj([],N,re,D,ne)},Y=0;Y<z;Y++)G[Y]=C[Y][Z*W],$[Y]=S[Y][Z*W];return K.axisLetter=u,K.axis=k,K.crossAxis=w,K.value=_[Z],K.constvar=e,K.index=Z,K.x=G,K.y=$,K.smoothing=w.smoothing,K}if(k.tickmode==="array"){for(n=5e-15,r=(s=[Math.floor((_.length-1-k.arraytick0)/k.arraydtick*(1+n)),Math.ceil(-k.arraytick0/k.arraydtick/(1+n))].sort(function(Z,Y){return Z-Y}))[0]-1,c=s[1]+1,f=r;f<c;f++)(o=k.arraytick0+k.arraydtick*f)<0||o>_.length-1||E.push(h(Q(o),{color:k.gridcolor,width:k.gridwidth}));for(f=r;f<c;f++)if(a=k.arraytick0+k.arraydtick*f,m=Math.min(a+k.arraydtick,_.length-1),!(a<0||a>_.length-1||m<0||m>_.length-1))for(y=_[a],v=_[m],l=0;l<k.minorgridcount;l++)(T=m-a)<=0||(g=y+(v-y)*(l+1)/(k.minorgridcount+1)*(k.arraydtick/T))<_[0]||g>_[_.length-1]||A.push(h(X(g),{color:k.minorgridcolor,width:k.minorgridwidth}));k.startline&&b.push(h(Q(0),{color:k.startlinecolor,width:k.startlinewidth})),k.endline&&b.push(h(Q(_.length-1),{color:k.endlinecolor,width:k.endlinewidth}))}else{for(n=5e-15,r=(s=[Math.floor((_[_.length-1]-k.tick0)/k.dtick*(1+n)),Math.ceil((_[0]-k.tick0)/k.dtick/(1+n))].sort(function(Z,Y){return Z-Y}))[0],c=s[1],f=r;f<=c;f++)d=k.tick0+k.dtick*f,E.push(h(X(d),{color:k.gridcolor,width:k.gridwidth}));for(f=r-1;f<c+1;f++)for(d=k.tick0+k.dtick*f,l=0;l<k.minorgridcount;l++)(g=d+k.dtick*(l+1)/(k.minorgridcount+1))<_[0]||g>_[_.length-1]||A.push(h(X(g),{color:k.minorgridcolor,width:k.minorgridwidth}));k.startline&&b.push(h(X(_[0]),{color:k.startlinecolor,width:k.startlinewidth})),k.endline&&b.push(h(X(_[_.length-1]),{color:k.endlinecolor,width:k.endlinewidth}))}}},{"../../lib/extend":793,"../../plots/cartesian/axes":854}],991:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../../lib/extend").extendFlat;B.exports=function(p,u){var e,l,o,a=u._labels=[],n=u._gridlines;for(e=0;e<n.length;e++)o=n[e],["start","both"].indexOf(u.showticklabels)!==-1&&(l=t.tickText(u,o.value),h(l,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:o.xy(0),dxy:o.dxy(0,0),axis:o.axis,length:o.crossAxis.length,font:o.axis.tickfont,isFirst:e===0,isLast:e===n.length-1}),a.push(l)),["end","both"].indexOf(u.showticklabels)!==-1&&(l=t.tickText(u,o.value),h(l,{endAnchor:!1,xy:o.xy(o.crossLength-1),dxy:o.dxy(o.crossLength-2,1),axis:o.axis,length:o.crossAxis.length,font:o.axis.tickfont,isFirst:e===0,isLast:e===n.length-1}),a.push(l))}},{"../../lib/extend":793,"../../plots/cartesian/axes":854}],992:[function(i,B,V){B.exports=function(t,h,p,u){var e=t[0]-h[0],l=t[1]-h[1],o=p[0]-h[0],a=p[1]-h[1],n=Math.pow(e*e+l*l,.25),s=Math.pow(o*o+a*a,.25),r=(s*s*e-n*n*o)*u,c=(s*s*l-n*n*a)*u,f=s*(n+s)*3,d=n*(n+s)*3;return[[h[0]+(f&&r/f),h[1]+(f&&c/f)],[h[0]-(d&&r/d),h[1]-(d&&c/d)]]}},{}],993:[function(i,B,V){var t=i("../../lib").isArrayOrTypedArray;B.exports=function(h,p,u){var e,l,o,a,n,s,r=[],c=t(h)?h.length:h,f=t(p)?p.length:p,d=t(h)?h:null,g=t(p)?p:null;d&&(o=(d.length-1)/(d[d.length-1]-d[0])/(c-1)),g&&(a=(g.length-1)/(g[g.length-1]-g[0])/(f-1));var m=1/0,y=-1/0;for(l=0;l<f;l++)for(r[l]=[],n=g?(g[l]-g[0])*a:l/(f-1),e=0;e<c;e++)s=(d?(d[e]-d[0])*o:e/(c-1))-n*u,m=Math.min(s,m),y=Math.max(s,y),r[l][e]=s;var v=1/(y-m),T=-m*v;for(l=0;l<f;l++)for(e=0;e<c;e++)r[l][e]=v*r[l][e]+T;return r}},{"../../lib":803}],994:[function(i,B,V){var t=i("./catmull_rom"),h=i("../../lib").ensureArray;function p(u,e,l){var o=-.5*l[0]+1.5*e[0],a=-.5*l[1]+1.5*e[1];return[(2*o+u[0])/3,(2*a+u[1])/3]}B.exports=function(u,e,l,o,a,n){var s,r,c,f,d,g,m,y,v,T,_=l[0].length,k=l.length,E=a?3*_-2:_,A=n?3*k-2:k;for(u=h(u,A),e=h(e,A),c=0;c<A;c++)u[c]=h(u[c],E),e[c]=h(e[c],E);for(r=0,f=0;r<k;r++,f+=n?3:1)for(d=u[f],g=e[f],m=l[r],y=o[r],s=0,c=0;s<_;s++,c+=a?3:1)d[c]=m[s],g[c]=y[s];if(a)for(r=0,f=0;r<k;r++,f+=n?3:1){for(s=1,c=3;s<_-1;s++,c+=3)v=t([l[r][s-1],o[r][s-1]],[l[r][s],o[r][s]],[l[r][s+1],o[r][s+1]],a),u[f][c-1]=v[0][0],e[f][c-1]=v[0][1],u[f][c+1]=v[1][0],e[f][c+1]=v[1][1];T=p([u[f][0],e[f][0]],[u[f][2],e[f][2]],[u[f][3],e[f][3]]),u[f][1]=T[0],e[f][1]=T[1],T=p([u[f][E-1],e[f][E-1]],[u[f][E-3],e[f][E-3]],[u[f][E-4],e[f][E-4]]),u[f][E-2]=T[0],e[f][E-2]=T[1]}if(n)for(c=0;c<E;c++){for(f=3;f<A-3;f+=3)v=t([u[f-3][c],e[f-3][c]],[u[f][c],e[f][c]],[u[f+3][c],e[f+3][c]],n),u[f-1][c]=v[0][0],e[f-1][c]=v[0][1],u[f+1][c]=v[1][0],e[f+1][c]=v[1][1];T=p([u[0][c],e[0][c]],[u[2][c],e[2][c]],[u[3][c],e[3][c]]),u[1][c]=T[0],e[1][c]=T[1],T=p([u[A-1][c],e[A-1][c]],[u[A-3][c],e[A-3][c]],[u[A-4][c],e[A-4][c]]),u[A-2][c]=T[0],e[A-2][c]=T[1]}if(a&&n)for(f=1;f<A;f+=(f+1)%3==0?2:1){for(c=3;c<E-3;c+=3)v=t([u[f][c-3],e[f][c-3]],[u[f][c],e[f][c]],[u[f][c+3],e[f][c+3]],a),u[f][c-1]=.5*(u[f][c-1]+v[0][0]),e[f][c-1]=.5*(e[f][c-1]+v[0][1]),u[f][c+1]=.5*(u[f][c+1]+v[1][0]),e[f][c+1]=.5*(e[f][c+1]+v[1][1]);T=p([u[f][0],e[f][0]],[u[f][2],e[f][2]],[u[f][3],e[f][3]]),u[f][1]=.5*(u[f][1]+T[0]),e[f][1]=.5*(e[f][1]+T[1]),T=p([u[f][E-1],e[f][E-1]],[u[f][E-3],e[f][E-3]],[u[f][E-4],e[f][E-4]]),u[f][E-2]=.5*(u[f][E-2]+T[0]),e[f][E-2]=.5*(e[f][E-2]+T[1])}return[u,e]}},{"../../lib":803,"./catmull_rom":992}],995:[function(i,B,V){B.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],996:[function(i,B,V){B.exports=function(t,h,p){return h&&p?function(u,e,l,o,a){var n,s,r,c,f,d;u||(u=[]),e*=3,l*=3;var g=o*o,m=1-o,y=m*m,v=m*o*2,T=-3*y,_=3*(y-v),k=3*(v-g),E=3*g,A=a*a,b=A*a,L=1-a,w=L*L,C=w*L;for(d=0;d<t.length;d++)n=T*(f=t[d])[l][e]+_*f[l][e+1]+k*f[l][e+2]+E*f[l][e+3],s=T*f[l+1][e]+_*f[l+1][e+1]+k*f[l+1][e+2]+E*f[l+1][e+3],r=T*f[l+2][e]+_*f[l+2][e+1]+k*f[l+2][e+2]+E*f[l+2][e+3],c=T*f[l+3][e]+_*f[l+3][e+1]+k*f[l+3][e+2]+E*f[l+3][e+3],u[d]=C*n+3*(w*a*s+L*A*r)+b*c;return u}:h?function(u,e,l,o,a){var n,s,r,c;u||(u=[]),e*=3;var f=o*o,d=1-o,g=d*d,m=d*o*2,y=-3*g,v=3*(g-m),T=3*(m-f),_=3*f,k=1-a;for(r=0;r<t.length;r++)n=y*(c=t[r])[l][e]+v*c[l][e+1]+T*c[l][e+2]+_*c[l][e+3],s=y*c[l+1][e]+v*c[l+1][e+1]+T*c[l+1][e+2]+_*c[l+1][e+3],u[r]=k*n+a*s;return u}:p?function(u,e,l,o,a){var n,s,r,c,f,d;u||(u=[]),l*=3;var g=a*a,m=g*a,y=1-a,v=y*y,T=v*y;for(f=0;f<t.length;f++)n=(d=t[f])[l][e+1]-d[l][e],s=d[l+1][e+1]-d[l+1][e],r=d[l+2][e+1]-d[l+2][e],c=d[l+3][e+1]-d[l+3][e],u[f]=T*n+3*(v*a*s+y*g*r)+m*c;return u}:function(u,e,l,o,a){var n,s,r,c;u||(u=[]);var f=1-a;for(r=0;r<t.length;r++)n=(c=t[r])[l][e+1]-c[l][e],s=c[l+1][e+1]-c[l+1][e],u[r]=f*n+a*s;return u}}},{}],997:[function(i,B,V){B.exports=function(t,h,p){return h&&p?function(u,e,l,o,a){var n,s,r,c,f,d;u||(u=[]),e*=3,l*=3;var g=o*o,m=g*o,y=1-o,v=y*y,T=v*y,_=a*a,k=1-a,E=k*k,A=k*a*2,b=-3*E,L=3*(E-A),w=3*(A-_),C=3*_;for(d=0;d<t.length;d++)n=b*(f=t[d])[l][e]+L*f[l+1][e]+w*f[l+2][e]+C*f[l+3][e],s=b*f[l][e+1]+L*f[l+1][e+1]+w*f[l+2][e+1]+C*f[l+3][e+1],r=b*f[l][e+2]+L*f[l+1][e+2]+w*f[l+2][e+2]+C*f[l+3][e+2],c=b*f[l][e+3]+L*f[l+1][e+3]+w*f[l+2][e+3]+C*f[l+3][e+3],u[d]=T*n+3*(v*o*s+y*g*r)+m*c;return u}:h?function(u,e,l,o,a){var n,s,r,c,f,d;u||(u=[]),e*=3;var g=a*a,m=g*a,y=1-a,v=y*y,T=v*y;for(f=0;f<t.length;f++)n=(d=t[f])[l+1][e]-d[l][e],s=d[l+1][e+1]-d[l][e+1],r=d[l+1][e+2]-d[l][e+2],c=d[l+1][e+3]-d[l][e+3],u[f]=T*n+3*(v*a*s+y*g*r)+m*c;return u}:p?function(u,e,l,o,a){var n,s,r,c;u||(u=[]),l*=3;var f=1-o,d=a*a,g=1-a,m=g*g,y=g*a*2,v=-3*m,T=3*(m-y),_=3*(y-d),k=3*d;for(r=0;r<t.length;r++)n=v*(c=t[r])[l][e]+T*c[l+1][e]+_*c[l+2][e]+k*c[l+3][e],s=v*c[l][e+1]+T*c[l+1][e+1]+_*c[l+2][e+1]+k*c[l+3][e+1],u[r]=f*n+o*s;return u}:function(u,e,l,o,a){var n,s,r,c;u||(u=[]);var f=1-o;for(r=0;r<t.length;r++)n=(c=t[r])[l+1][e]-c[l][e],s=c[l+1][e+1]-c[l][e+1],u[r]=f*n+o*s;return u}}},{}],998:[function(i,B,V){B.exports=function(t,h,p,u,e){var l=h-2,o=p-2;return u&&e?function(a,n,s){var r,c,f,d,g,m;a||(a=[]);var y=Math.max(0,Math.min(Math.floor(n),l)),v=Math.max(0,Math.min(Math.floor(s),o)),T=Math.max(0,Math.min(1,n-y)),_=Math.max(0,Math.min(1,s-v));y*=3,v*=3;var k=T*T,E=k*T,A=1-T,b=A*A,L=b*A,w=_*_,C=w*_,S=1-_,P=S*S,z=P*S;for(m=0;m<t.length;m++)r=L*(g=t[m])[v][y]+3*(b*T*g[v][y+1]+A*k*g[v][y+2])+E*g[v][y+3],c=L*g[v+1][y]+3*(b*T*g[v+1][y+1]+A*k*g[v+1][y+2])+E*g[v+1][y+3],f=L*g[v+2][y]+3*(b*T*g[v+2][y+1]+A*k*g[v+2][y+2])+E*g[v+2][y+3],d=L*g[v+3][y]+3*(b*T*g[v+3][y+1]+A*k*g[v+3][y+2])+E*g[v+3][y+3],a[m]=z*r+3*(P*_*c+S*w*f)+C*d;return a}:u?function(a,n,s){a||(a=[]);var r,c,f,d,g,m,y=Math.max(0,Math.min(Math.floor(n),l)),v=Math.max(0,Math.min(Math.floor(s),o)),T=Math.max(0,Math.min(1,n-y)),_=Math.max(0,Math.min(1,s-v));y*=3;var k=T*T,E=k*T,A=1-T,b=A*A,L=b*A,w=1-_;for(g=0;g<t.length;g++)r=w*(m=t[g])[v][y]+_*m[v+1][y],c=w*m[v][y+1]+_*m[v+1][y+1],f=w*m[v][y+2]+_*m[v+1][y+1],d=w*m[v][y+3]+_*m[v+1][y+1],a[g]=L*r+3*(b*T*c+A*k*f)+E*d;return a}:e?function(a,n,s){a||(a=[]);var r,c,f,d,g,m,y=Math.max(0,Math.min(Math.floor(n),l)),v=Math.max(0,Math.min(Math.floor(s),o)),T=Math.max(0,Math.min(1,n-y)),_=Math.max(0,Math.min(1,s-v));v*=3;var k=_*_,E=k*_,A=1-_,b=A*A,L=b*A,w=1-T;for(g=0;g<t.length;g++)r=w*(m=t[g])[v][y]+T*m[v][y+1],c=w*m[v+1][y]+T*m[v+1][y+1],f=w*m[v+2][y]+T*m[v+2][y+1],d=w*m[v+3][y]+T*m[v+3][y+1],a[g]=L*r+3*(b*_*c+A*k*f)+E*d;return a}:function(a,n,s){a||(a=[]);var r,c,f,d,g=Math.max(0,Math.min(Math.floor(n),l)),m=Math.max(0,Math.min(Math.floor(s),o)),y=Math.max(0,Math.min(1,n-g)),v=Math.max(0,Math.min(1,s-m)),T=1-v,_=1-y;for(f=0;f<t.length;f++)r=_*(d=t[f])[m][g]+y*d[m][g+1],c=_*d[m+1][g]+y*d[m+1][g+1],a[f]=T*r+v*c;return a}}},{}],999:[function(i,B,V){var t=i("../../lib"),h=i("./xy_defaults"),p=i("./ab_defaults"),u=i("./attributes"),e=i("../../components/color/attributes");B.exports=function(l,o,a,n){function s(c,f){return t.coerce(l,o,u,c,f)}o._clipPathId="clip"+o.uid+"carpet";var r=s("color",e.defaultLine);t.coerceFont(s,"font"),s("carpet"),p(l,o,n,s,r),o.a&&o.b?(o.a.length<3&&(o.aaxis.smoothing=0),o.b.length<3&&(o.baxis.smoothing=0),h(l,o,s)||(o.visible=!1),o._cheater&&s("cheaterslope")):o.visible=!1}},{"../../components/color/attributes":665,"../../lib":803,"./ab_defaults":982,"./attributes":984,"./xy_defaults":1008}],1e3:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),plot:i("./plot"),calc:i("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":868,"./attributes":984,"./calc":988,"./defaults":999,"./plot":1005}],1001:[function(i,B,V){B.exports=function(t,h){for(var p,u=t._fullData.length,e=0;e<u;e++){var l=t._fullData[e];if(l.index!==h.index&&l.type==="carpet"&&(p||(p=l),l.carpet===h.carpet))return l}return p}},{}],1002:[function(i,B,V){B.exports=function(t,h,p){if(t.length===0)return"";var u,e=[],l=p?3:1;for(u=0;u<t.length;u+=l)e.push(t[u]+","+h[u]),p&&u<t.length-l&&(e.push("C"),e.push([t[u+1]+","+h[u+1],t[u+2]+","+h[u+2]+" "].join(" ")));return e.join(p?"":"L")}},{}],1003:[function(i,B,V){var t=i("../../lib").isArrayOrTypedArray;B.exports=function(h,p,u){var e;for(t(h)?h.length>p.length&&(h=h.slice(0,p.length)):h=[],e=0;e<p.length;e++)h[e]=u(p[e]);return h}},{"../../lib":803}],1004:[function(i,B,V){B.exports=function(t,h,p,u,e,l){var o=e[0]*t.dpdx(h),a=e[1]*t.dpdy(p),n=1,s=1;if(l){var r=Math.sqrt(e[0]*e[0]+e[1]*e[1]),c=Math.sqrt(l[0]*l[0]+l[1]*l[1]),f=(e[0]*l[0]+e[1]*l[1])/r/c;s=Math.max(0,f)}var d=180*Math.atan2(a,o)/Math.PI;return d<-90?(d+=180,n=-n):d>90&&(d-=180,n=-n),{angle:d,flip:n,p:t.c2p(u,h,p),offsetMultplier:s}}},{}],1005:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/drawing"),p=i("./map_1d_array"),u=i("./makepath"),e=i("./orient_text"),l=i("../../lib/svg_text_utils"),o=i("../../lib"),a=o.strRotate,n=o.strTranslate,s=i("../../constants/alignment");function r(m,y,v,T,_,k){var E="const-"+_+"-lines",A=v.selectAll("."+E).data(k);A.enter().append("path").classed(E,!0).style("vector-effect","non-scaling-stroke"),A.each(function(b){var L=b,w=L.x,C=L.y,S=p([],w,m.c2p),P=p([],C,y.c2p),z="M"+u(S,P,L.smoothing);t.select(this).attr("d",z).style("stroke-width",L.width).style("stroke",L.color).style("fill","none")}),A.exit().remove()}function c(m,y,v,T,_,k,E,A){var b=k.selectAll("text."+A).data(E);b.enter().append("text").classed(A,!0);var L=0,w={};return b.each(function(C,S){var P;if(C.axis.tickangle==="auto")P=e(T,y,v,C.xy,C.dxy);else{var z=(C.axis.tickangle+180)*Math.PI/180;P=e(T,y,v,C.xy,[Math.cos(z),Math.sin(z)])}S||(w={angle:P.angle,flip:P.flip});var F=(C.endAnchor?-1:1)*P.flip,q=t.select(this).attr({"text-anchor":F>0?"start":"end","data-notex":1}).call(h.font,C.font).text(C.text).call(l.convertToTspans,m),W=h.bBox(this);q.attr("transform",n(P.p[0],P.p[1])+a(P.angle)+n(C.axis.labelpadding*F,.3*W.height)),L=Math.max(L,W.width+C.axis.labelpadding)}),b.exit().remove(),w.maxExtent=L,w}B.exports=function(m,y,v,T){var _=y.xaxis,k=y.yaxis,E=m._fullLayout._clips;o.makeTraceGroups(T,v,"trace").each(function(A){var b=t.select(this),L=A[0],w=L.trace,C=w.aaxis,S=w.baxis,P=o.ensureSingle(b,"g","minorlayer"),z=o.ensureSingle(b,"g","majorlayer"),F=o.ensureSingle(b,"g","boundarylayer"),q=o.ensureSingle(b,"g","labellayer");b.style("opacity",w.opacity),r(_,k,z,C,"a",C._gridlines),r(_,k,z,S,"b",S._gridlines),r(_,k,P,C,"a",C._minorgridlines),r(_,k,P,S,"b",S._minorgridlines),r(_,k,F,C,"a-boundary",C._boundarylines),r(_,k,F,S,"b-boundary",S._boundarylines);var W=c(m,_,k,w,L,q,C._labels,"a-label"),X=c(m,_,k,w,L,q,S._labels,"b-label");(function(Q,Z,Y,N,J,D,U,G){var $,K,re,ne,ae=o.aggNums(Math.min,null,Y.a),ie=o.aggNums(Math.max,null,Y.a),he=o.aggNums(Math.min,null,Y.b),se=o.aggNums(Math.max,null,Y.b);$=.5*(ae+ie),K=he,re=Y.ab2xy($,K,!0),ne=Y.dxyda_rough($,K),U.angle===void 0&&o.extendFlat(U,e(Y,J,D,re,Y.dxydb_rough($,K))),g(Q,Z,Y,N,re,ne,Y.aaxis,J,D,U,"a-title"),$=ae,K=.5*(he+se),re=Y.ab2xy($,K,!0),ne=Y.dxydb_rough($,K),G.angle===void 0&&o.extendFlat(G,e(Y,J,D,re,Y.dxyda_rough($,K))),g(Q,Z,Y,N,re,ne,Y.baxis,J,D,G,"b-title")})(m,q,w,L,_,k,W,X),function(Q,Z,Y,N,J){var D,U,G,$,K=Y.select("#"+Q._clipPathId);K.size()||(K=Y.append("clipPath").classed("carpetclip",!0));var re=o.ensureSingle(K,"path","carpetboundary"),ne=Z.clipsegments,ae=[];for($=0;$<ne.length;$++)D=ne[$],U=p([],D.x,N.c2p),G=p([],D.y,J.c2p),ae.push(u(U,G,D.bicubic));var ie="M"+ae.join("L")+"Z";K.attr("id",Q._clipPathId),re.attr("d",ie)}(w,L,E,_,k)})};var f=s.LINE_SPACING,d=(1-s.MID_SHIFT)/f+1;function g(m,y,v,T,_,k,E,A,b,L,w){var C=[];E.title.text&&C.push(E.title.text);var S=y.selectAll("text."+w).data(C),P=L.maxExtent;S.enter().append("text").classed(w,!0),S.each(function(){var z=e(v,A,b,_,k);["start","both"].indexOf(E.showticklabels)===-1&&(P=0);var F=E.title.font.size;P+=F+E.title.offset;var q=(L.angle+(L.flip<0?180:0)-z.angle+450)%360,W=q>90&&q<270,X=t.select(this);X.text(E.title.text).call(l.convertToTspans,m),W&&(P=(-l.lineCount(X)+d)*f*F-P),X.attr("transform",n(z.p[0],z.p[1])+a(z.angle)+n(0,P)).attr("text-anchor","middle").call(h.font,E.title.font)}),S.exit().remove()}},{"../../components/drawing":688,"../../constants/alignment":771,"../../lib":803,"../../lib/svg_text_utils":829,"./makepath":1002,"./map_1d_array":1003,"./orient_text":1004,"@plotly/d3":58}],1006:[function(i,B,V){var t=i("./constants"),h=i("../../lib/search").findBin,p=i("./compute_control_points"),u=i("./create_spline_evaluator"),e=i("./create_i_derivative_evaluator"),l=i("./create_j_derivative_evaluator");B.exports=function(o){var a=o._a,n=o._b,s=a.length,r=n.length,c=o.aaxis,f=o.baxis,d=a[0],g=a[s-1],m=n[0],y=n[r-1],v=a[a.length-1]-a[0],T=n[n.length-1]-n[0],_=v*t.RELATIVE_CULL_TOLERANCE,k=T*t.RELATIVE_CULL_TOLERANCE;d-=_,g+=_,m-=k,y+=k,o.isVisible=function(E,A){return E>d&&E<g&&A>m&&A<y},o.isOccluded=function(E,A){return E<d||E>g||A<m||A>y},o.setScale=function(){var E=o._x,A=o._y,b=p(o._xctrl,o._yctrl,E,A,c.smoothing,f.smoothing);o._xctrl=b[0],o._yctrl=b[1],o.evalxy=u([o._xctrl,o._yctrl],s,r,c.smoothing,f.smoothing),o.dxydi=e([o._xctrl,o._yctrl],c.smoothing,f.smoothing),o.dxydj=l([o._xctrl,o._yctrl],c.smoothing,f.smoothing)},o.i2a=function(E){var A=Math.max(0,Math.floor(E[0]),s-2),b=E[0]-A;return(1-b)*a[A]+b*a[A+1]},o.j2b=function(E){var A=Math.max(0,Math.floor(E[1]),s-2),b=E[1]-A;return(1-b)*n[A]+b*n[A+1]},o.ij2ab=function(E){return[o.i2a(E[0]),o.j2b(E[1])]},o.a2i=function(E){var A=Math.max(0,Math.min(h(E,a),s-2)),b=a[A],L=a[A+1];return Math.max(0,Math.min(s-1,A+(E-b)/(L-b)))},o.b2j=function(E){var A=Math.max(0,Math.min(h(E,n),r-2)),b=n[A],L=n[A+1];return Math.max(0,Math.min(r-1,A+(E-b)/(L-b)))},o.ab2ij=function(E){return[o.a2i(E[0]),o.b2j(E[1])]},o.i2c=function(E,A){return o.evalxy([],E,A)},o.ab2xy=function(E,A,b){if(!b&&(E<a[0]||E>a[s-1]|A<n[0]||A>n[r-1]))return[!1,!1];var L=o.a2i(E),w=o.b2j(A),C=o.evalxy([],L,w);if(b){var S,P,z,F,q=0,W=0,X=[];E<a[0]?(S=0,P=0,q=(E-a[0])/(a[1]-a[0])):E>a[s-1]?(S=s-2,P=1,q=(E-a[s-1])/(a[s-1]-a[s-2])):P=L-(S=Math.max(0,Math.min(s-2,Math.floor(L)))),A<n[0]?(z=0,F=0,W=(A-n[0])/(n[1]-n[0])):A>n[r-1]?(z=r-2,F=1,W=(A-n[r-1])/(n[r-1]-n[r-2])):F=w-(z=Math.max(0,Math.min(r-2,Math.floor(w)))),q&&(o.dxydi(X,S,z,P,F),C[0]+=X[0]*q,C[1]+=X[1]*q),W&&(o.dxydj(X,S,z,P,F),C[0]+=X[0]*W,C[1]+=X[1]*W)}return C},o.c2p=function(E,A,b){return[A.c2p(E[0]),b.c2p(E[1])]},o.p2x=function(E,A,b){return[A.p2c(E[0]),b.p2c(E[1])]},o.dadi=function(E){var A=Math.max(0,Math.min(a.length-2,E));return a[A+1]-a[A]},o.dbdj=function(E){var A=Math.max(0,Math.min(n.length-2,E));return n[A+1]-n[A]},o.dxyda=function(E,A,b,L){var w=o.dxydi(null,E,A,b,L),C=o.dadi(E,b);return[w[0]/C,w[1]/C]},o.dxydb=function(E,A,b,L){var w=o.dxydj(null,E,A,b,L),C=o.dbdj(A,L);return[w[0]/C,w[1]/C]},o.dxyda_rough=function(E,A,b){var L=v*(b||.1),w=o.ab2xy(E+L,A,!0),C=o.ab2xy(E-L,A,!0);return[.5*(w[0]-C[0])/L,.5*(w[1]-C[1])/L]},o.dxydb_rough=function(E,A,b){var L=T*(b||.1),w=o.ab2xy(E,A+L,!0),C=o.ab2xy(E,A-L,!0);return[.5*(w[0]-C[0])/L,.5*(w[1]-C[1])/L]},o.dpdx=function(E){return E._m},o.dpdy=function(E){return E._m}}},{"../../lib/search":823,"./compute_control_points":994,"./constants":995,"./create_i_derivative_evaluator":996,"./create_j_derivative_evaluator":997,"./create_spline_evaluator":998}],1007:[function(i,B,V){var t=i("../../lib");B.exports=function(h,p,u){var e,l,o,a=[],n=[],s=h[0].length,r=h.length;function c(Z,Y){var N,J=0,D=0;return Z>0&&(N=h[Y][Z-1])!==void 0&&(D++,J+=N),Z<s-1&&(N=h[Y][Z+1])!==void 0&&(D++,J+=N),Y>0&&(N=h[Y-1][Z])!==void 0&&(D++,J+=N),Y<r-1&&(N=h[Y+1][Z])!==void 0&&(D++,J+=N),J/Math.max(1,D)}var f,d,g,m,y,v,T,_,k,E,A,b=0;for(e=0;e<s;e++)for(l=0;l<r;l++)h[l][e]===void 0&&(a.push(e),n.push(l),h[l][e]=c(e,l)),b=Math.max(b,Math.abs(h[l][e]));if(!a.length)return h;var L=0,w=0,C=a.length;do{for(L=0,o=0;o<C;o++){e=a[o],l=n[o];var S,P,z,F,q,W,X=0,Q=0;e===0?(z=p[q=Math.min(s-1,2)],F=p[1],S=h[l][q],Q+=(P=h[l][1])+(P-S)*(p[0]-F)/(F-z),X++):e===s-1&&(z=p[q=Math.max(0,s-3)],F=p[s-2],S=h[l][q],Q+=(P=h[l][s-2])+(P-S)*(p[s-1]-F)/(F-z),X++),(e===0||e===s-1)&&l>0&&l<r-1&&(f=u[l+1]-u[l],Q+=((d=u[l]-u[l-1])*h[l+1][e]+f*h[l-1][e])/(d+f),X++),l===0?(z=u[W=Math.min(r-1,2)],F=u[1],S=h[W][e],Q+=(P=h[1][e])+(P-S)*(u[0]-F)/(F-z),X++):l===r-1&&(z=u[W=Math.max(0,r-3)],F=u[r-2],S=h[W][e],Q+=(P=h[r-2][e])+(P-S)*(u[r-1]-F)/(F-z),X++),(l===0||l===r-1)&&e>0&&e<s-1&&(f=p[e+1]-p[e],Q+=((d=p[e]-p[e-1])*h[l][e+1]+f*h[l][e-1])/(d+f),X++),X?Q/=X:(g=p[e+1]-p[e],m=p[e]-p[e-1],_=(y=u[l+1]-u[l])*(v=u[l]-u[l-1])*(y+v),Q=((T=g*m*(g+m))*(v*h[l+1][e]+y*h[l-1][e])+_*(m*h[l][e+1]+g*h[l][e-1]))/(_*(m+g)+T*(v+y))),L+=(E=(k=Q-h[l][e])/b)*E,A=X?0:.85,h[l][e]+=k*(1+A)}L=Math.sqrt(L)}while(w++<100&&L>1e-5);return t.log("Smoother converged to",L,"after",w,"iterations"),h}},{"../../lib":803}],1008:[function(i,B,V){var t=i("../../lib").isArray1D;B.exports=function(h,p,u){var e=u("x"),l=e&&e.length,o=u("y"),a=o&&o.length;if(!l&&!a)return!1;if(p._cheater=!e,l&&!t(e)||a&&!t(o))p._length=null;else{var n=l?e.length:1/0;a&&(n=Math.min(n,o.length)),p.a&&p.a.length&&(n=Math.min(n,p.a.length)),p.b&&p.b.length&&(n=Math.min(n,p.b.length)),p._length=n}return!0}},{"../../lib":803}],1009:[function(i,B,V){var t=i("../../plots/template_attributes").hovertemplateAttrs,h=i("../scattergeo/attributes"),p=i("../../components/colorscale/attributes"),u=i("../../plots/attributes"),e=i("../../components/color/attributes").defaultLine,l=i("../../lib/extend").extendFlat,o=h.marker.line;B.exports=l({locations:{valType:"data_array",editType:"calc"},locationmode:h.locationmode,z:{valType:"data_array",editType:"calc"},geojson:l({},h.geojson,{}),featureidkey:h.featureidkey,text:l({},h.text,{}),hovertext:l({},h.hovertext,{}),marker:{line:{color:l({},o.color,{dflt:e}),width:l({},o.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:h.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:h.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:l({},u.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:t(),showlegend:l({},u.showlegend,{dflt:!1})},p("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":665,"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/template_attributes":926,"../scattergeo/attributes":1260}],1010:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../constants/numerical").BADNUM,p=i("../../components/colorscale/calc"),u=i("../scatter/arrays_to_calcdata"),e=i("../scatter/calc_selection");function l(o){return o&&typeof o=="string"}B.exports=function(o,a){var n,s=a._length,r=new Array(s);n=a.geojson?function(m){return l(m)||t(m)}:l;for(var c=0;c<s;c++){var f=r[c]={},d=a.locations[c],g=a.z[c];n(d)&&t(g)?(f.loc=d,f.z=g):(f.loc=null,f.z=h),f.index=c}return u(r,a),p(o,a,{vals:a.z,containerStr:"",cLetter:"z"}),e(r,a),r}},{"../../components/colorscale/calc":674,"../../constants/numerical":779,"../scatter/arrays_to_calcdata":1217,"../scatter/calc_selection":1220,"fast-isnumeric":249}],1011:[function(i,B,V){var t=i("../../lib"),h=i("../../components/colorscale/defaults"),p=i("./attributes");B.exports=function(u,e,l,o){function a(f,d){return t.coerce(u,e,p,f,d)}var n=a("locations"),s=a("z");if(n&&n.length&&t.isArrayOrTypedArray(s)&&s.length){e._length=Math.min(n.length,s.length);var r,c=a("geojson");(typeof c=="string"&&c!==""||t.isPlainObject(c))&&(r="geojson-id"),a("locationmode",r)==="geojson-id"&&a("featureidkey"),a("text"),a("hovertext"),a("hovertemplate"),a("marker.line.width")&&a("marker.line.color"),a("marker.opacity"),h(u,e,o,a,{prefix:"",cLetter:"z"}),t.coerceSelectionMarkerOpacity(e,a)}else e.visible=!1}},{"../../components/colorscale/defaults":676,"../../lib":803,"./attributes":1009}],1012:[function(i,B,V){B.exports=function(t,h,p,u,e){t.location=h.location,t.z=h.z;var l=u[e];return l.fIn&&l.fIn.properties&&(t.properties=l.fIn.properties),t.ct=l.ct,t}},{}],1013:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("./attributes"),p=i("../../lib").fillText;B.exports=function(u,e,l){var o,a,n,s,r=u.cd,c=r[0].trace,f=u.subplot,d=[e,l],g=[e+360,l];for(a=0;a<r.length;a++)if(s=!1,(o=r[a])._polygons){for(n=0;n<o._polygons.length;n++)o._polygons[n].contains(d)&&(s=!s),o._polygons[n].contains(g)&&(s=!s);if(s)break}if(s&&o)return u.x0=u.x1=u.xa.c2p(o.ct),u.y0=u.y1=u.ya.c2p(o.ct),u.index=o.index,u.location=o.loc,u.z=o.z,u.zLabel=t.tickText(f.mockAxis,f.mockAxis.c2l(o.z),"hover").text,u.hovertemplate=o.hovertemplate,function(m,y,v){if(!y.hovertemplate){var T=v.hi||y.hoverinfo,_=String(v.loc),k=T==="all"?h.hoverinfo.flags:T.split("+"),E=k.indexOf("name")!==-1,A=k.indexOf("location")!==-1,b=k.indexOf("z")!==-1,L=k.indexOf("text")!==-1,w=[];!E&&A?m.nameOverride=_:(E&&(m.nameOverride=y.name),A&&w.push(_)),b&&w.push(m.zLabel),L&&p(v,y,w),m.extraText=w.join("<br>")}}(u,c,o),[u]}},{"../../lib":803,"../../plots/cartesian/axes":854,"./attributes":1009}],1014:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../heatmap/colorbar"),calc:i("./calc"),calcGeoJSON:i("./plot").calcGeoJSON,plot:i("./plot").plot,style:i("./style").style,styleOnSelect:i("./style").styleOnSelect,hoverPoints:i("./hover"),eventData:i("./event_data"),selectPoints:i("./select"),moduleType:"trace",name:"choropleth",basePlotModule:i("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":887,"../heatmap/colorbar":1088,"./attributes":1009,"./calc":1010,"./defaults":1011,"./event_data":1012,"./hover":1013,"./plot":1015,"./select":1016,"./style":1017}],1015:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../lib/geo_location_utils"),u=i("../../lib/topojson_utils").getTopojsonFeatures,e=i("../../plots/cartesian/autorange").findExtremes,l=i("./style").style;B.exports={calcGeoJSON:function(o,a){for(var n=o[0].trace,s=a[n.geo],r=s._subplot,c=n.locationmode,f=n._length,d=c==="geojson-id"?p.extractTraceFeature(o):u(n,r.topojson),g=[],m=[],y=0;y<f;y++){var v=o[y],T=c==="geojson-id"?v.fOut:p.locationToFeature(c,v.loc,d);if(T){v.geojson=T,v.ct=T.properties.ct,v._polygons=p.feature2polygons(T);var _=p.computeBbox(T);g.push(_[0],_[2]),m.push(_[1],_[3])}else v.geojson=null}if(s.fitbounds==="geojson"&&c==="geojson-id"){var k=p.computeBbox(p.getTraceGeojson(n));g=[k[0],k[2]],m=[k[1],k[3]]}var E={padded:!0};n._extremes.lon=e(s.lonaxis._ax,g,E),n._extremes.lat=e(s.lataxis._ax,m,E)},plot:function(o,a,n){var s=a.layers.backplot.select(".choroplethlayer");h.makeTraceGroups(s,n,"trace choropleth").each(function(r){var c=t.select(this).selectAll("path.choroplethlocation").data(h.identity);c.enter().append("path").classed("choroplethlocation",!0),c.exit().remove(),l(o,r)})}}},{"../../lib":803,"../../lib/geo_location_utils":796,"../../lib/topojson_utils":832,"../../plots/cartesian/autorange":853,"./style":1017,"@plotly/d3":58}],1016:[function(i,B,V){B.exports=function(t,h){var p,u,e,l,o,a=t.cd,n=t.xaxis,s=t.yaxis,r=[];if(h===!1)for(p=0;p<a.length;p++)a[p].selected=0;else for(p=0;p<a.length;p++)(e=(u=a[p]).ct)&&(l=n.c2p(e),o=s.c2p(e),h.contains([l,o],null,p,t)?(r.push({pointNumber:p,lon:e[0],lat:e[1]}),u.selected=1):u.selected=0);return r}},{}],1017:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/color"),p=i("../../components/drawing"),u=i("../../components/colorscale");function e(l,o){var a=o[0].trace,n=o[0].node3.selectAll(".choroplethlocation"),s=a.marker||{},r=s.line||{},c=u.makeColorScaleFuncFromTrace(a);n.each(function(f){t.select(this).attr("fill",c(f.z)).call(h.stroke,f.mlc||r.color).call(p.dashLine,"",f.mlw||r.width||0).style("opacity",s.opacity)}),p.selectedPointStyle(n,a,l)}B.exports={style:function(l,o){o&&e(l,o)},styleOnSelect:function(l,o){var a=o[0].node3,n=o[0].trace;n.selectedpoints?p.selectedPointStyle(a.selectAll(".choroplethlocation"),n,l):e(l,o)}}},{"../../components/color":666,"../../components/colorscale":678,"../../components/drawing":688,"@plotly/d3":58}],1018:[function(i,B,V){var t=i("../choropleth/attributes"),h=i("../../components/colorscale/attributes"),p=i("../../plots/template_attributes").hovertemplateAttrs,u=i("../../plots/attributes"),e=i("../../lib/extend").extendFlat;B.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},t.featureidkey,{}),below:{valType:"string",editType:"plot"},text:t.text,hovertext:t.hovertext,marker:{line:{color:e({},t.marker.line.color,{editType:"plot"}),width:e({},t.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},t.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},t.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},t.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:t.hoverinfo,hovertemplate:p({},{keys:["properties"]}),showlegend:e({},u.showlegend,{dflt:!1})},h("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/template_attributes":926,"../choropleth/attributes":1009}],1019:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("../../components/colorscale"),u=i("../../components/drawing"),e=i("../../lib/geojson_utils").makeBlank,l=i("../../lib/geo_location_utils");function o(a){var n,s=a[0].trace,r=s._opts;if(s.selectedpoints){for(var c=u.makeSelectedPointStyleFns(s),f=0;f<a.length;f++){var d=a[f];d.fOut&&(d.fOut.properties.mo2=c.selectedOpacityFn(d))}n={type:"identity",property:"mo2"}}else n=h.isArrayOrTypedArray(s.marker.opacity)?{type:"identity",property:"mo"}:s.marker.opacity;return h.extendFlat(r.fill.paint,{"fill-opacity":n}),h.extendFlat(r.line.paint,{"line-opacity":n}),r}B.exports={convert:function(a){var n=a[0].trace,s=n.visible===!0&&n._length!==0,r={layout:{visibility:"none"},paint:{}},c={layout:{visibility:"none"},paint:{}},f=n._opts={fill:r,line:c,geojson:e()};if(!s)return f;var d=l.extractTraceFeature(a);if(!d)return f;var g,m,y,v=p.makeColorScaleFuncFromTrace(n),T=n.marker,_=T.line||{};h.isArrayOrTypedArray(T.opacity)&&(g=function(w){var C=w.mo;return t(C)?+h.constrain(C,0,1):0}),h.isArrayOrTypedArray(_.color)&&(m=function(w){return w.mlc}),h.isArrayOrTypedArray(_.width)&&(y=function(w){return w.mlw});for(var k=0;k<a.length;k++){var E=a[k],A=E.fOut;if(A){var b=A.properties;b.fc=v(E.z),g&&(b.mo=g(E)),m&&(b.mlc=m(E)),y&&(b.mlw=y(E)),E.ct=b.ct,E._polygons=l.feature2polygons(A)}}var L=g?{type:"identity",property:"mo"}:T.opacity;return h.extendFlat(r.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),h.extendFlat(c.paint,{"line-color":m?{type:"identity",property:"mlc"}:_.color,"line-width":y?{type:"identity",property:"mlw"}:_.width,"line-opacity":L}),r.layout.visibility="visible",c.layout.visibility="visible",f.geojson={type:"FeatureCollection",features:d},o(a),f},convertOnSelect:o}},{"../../components/colorscale":678,"../../components/drawing":688,"../../lib":803,"../../lib/geo_location_utils":796,"../../lib/geojson_utils":797,"fast-isnumeric":249}],1020:[function(i,B,V){var t=i("../../lib"),h=i("../../components/colorscale/defaults"),p=i("./attributes");B.exports=function(u,e,l,o){function a(c,f){return t.coerce(u,e,p,c,f)}var n=a("locations"),s=a("z"),r=a("geojson");t.isArrayOrTypedArray(n)&&n.length&&t.isArrayOrTypedArray(s)&&s.length&&(typeof r=="string"&&r!==""||t.isPlainObject(r))?(a("featureidkey"),e._length=Math.min(n.length,s.length),a("below"),a("text"),a("hovertext"),a("hovertemplate"),a("marker.line.width")&&a("marker.line.color"),a("marker.opacity"),h(u,e,o,a,{prefix:"",cLetter:"z"}),t.coerceSelectionMarkerOpacity(e,a)):e.visible=!1}},{"../../components/colorscale/defaults":676,"../../lib":803,"./attributes":1018}],1021:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../heatmap/colorbar"),calc:i("../choropleth/calc"),plot:i("./plot"),hoverPoints:i("../choropleth/hover"),eventData:i("../choropleth/event_data"),selectPoints:i("../choropleth/select"),styleOnSelect:function(t,h){h&&h[0].trace._glTrace.updateOnSelect(h)},getBelow:function(t,h){for(var p=h.getMapLayers(),u=p.length-2;u>=0;u--){var e=p[u].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var l=u+1;l<p.length;l++)if(typeof(e=p[l].id)=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:i("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":911,"../choropleth/calc":1010,"../choropleth/event_data":1012,"../choropleth/hover":1013,"../choropleth/select":1016,"../heatmap/colorbar":1088,"./attributes":1018,"./defaults":1020,"./plot":1022}],1022:[function(i,B,V){var t=i("./convert").convert,h=i("./convert").convertOnSelect,p=i("../../plots/mapbox/constants").traceLayerPrefix;function u(l,o){this.type="choroplethmapbox",this.subplot=l,this.uid=o,this.sourceId="source-"+o,this.layerList=[["fill",p+o+"-fill"],["line",p+o+"-line"]],this.below=null}var e=u.prototype;e.update=function(l){this._update(t(l))},e.updateOnSelect=function(l){this._update(h(l))},e._update=function(l){var o=this.subplot,a=this.layerList,n=o.belowLookup["trace-"+this.uid];o.map.getSource(this.sourceId).setData(l.geojson),n!==this.below&&(this._removeLayers(),this._addLayers(l,n),this.below=n);for(var s=0;s<a.length;s++){var r=a[s],c=r[0],f=r[1],d=l[c];o.setOptions(f,"setLayoutProperty",d.layout),d.layout.visibility==="visible"&&o.setOptions(f,"setPaintProperty",d.paint)}},e._addLayers=function(l,o){for(var a=this.subplot,n=this.layerList,s=this.sourceId,r=0;r<n.length;r++){var c=n[r],f=c[0],d=l[f];a.addLayer({type:f,id:c[1],source:s,layout:d.layout,paint:d.paint},o)}},e._removeLayers=function(){for(var l=this.subplot.map,o=this.layerList,a=o.length-1;a>=0;a--)l.removeLayer(o[a][1])},e.dispose=function(){var l=this.subplot.map;this._removeLayers(),l.removeSource(this.sourceId)},B.exports=function(l,o){var a=o[0].trace,n=new u(l,a.uid),s=n.sourceId,r=t(o),c=n.below=l.belowLookup["trace-"+a.uid];return l.map.addSource(s,{type:"geojson",data:r.geojson}),n._addLayers(r,c),o[0].trace._glTrace=n,n}},{"../../plots/mapbox/constants":909,"./convert":1019}],1023:[function(i,B,V){var t=i("../../components/colorscale/attributes"),h=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=i("../../plots/template_attributes").hovertemplateAttrs,u=i("../mesh3d/attributes"),e=i("../../plots/attributes"),l=i("../../lib/extend").extendFlat,o={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:p({editType:"calc"},{keys:["norm"]}),uhoverformat:h("u",1),vhoverformat:h("v",1),whoverformat:h("w",1),xhoverformat:h("x"),yhoverformat:h("y"),zhoverformat:h("z"),showlegend:l({},e.showlegend,{dflt:!1})};l(o,t("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){o[a]=u[a]}),o.hoverinfo=l({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),o.transforms=void 0,B.exports=o},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../mesh3d/attributes":1159}],1024:[function(i,B,V){var t=i("../../components/colorscale/calc");B.exports=function(h,p){for(var u=p.u,e=p.v,l=p.w,o=Math.min(p.x.length,p.y.length,p.z.length,u.length,e.length,l.length),a=-1/0,n=1/0,s=0;s<o;s++){var r=u[s],c=e[s],f=l[s],d=Math.sqrt(r*r+c*c+f*f);a=Math.max(a,d),n=Math.min(n,d)}p._len=o,p._normMax=a,t(h,p,{vals:[n,a],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":674}],1025:[function(i,B,V){var t=i("gl-cone3d"),h=i("gl-cone3d").createConeMesh,p=i("../../lib").simpleMap,u=i("../../lib/gl_format_color").parseColorScale,e=i("../../components/colorscale").extractOpts,l=i("../../plots/gl3d/zip3");function o(f,d){this.scene=f,this.uid=d,this.mesh=null,this.data=null}var a=o.prototype;a.handlePick=function(f){if(f.object===this.mesh){var d=f.index=f.data.index,g=this.data.x[d],m=this.data.y[d],y=this.data.z[d],v=this.data.u[d],T=this.data.v[d],_=this.data.w[d];f.traceCoordinate=[g,m,y,v,T,_,Math.sqrt(v*v+T*T+_*_)];var k=this.data.hovertext||this.data.text;return Array.isArray(k)&&k[d]!==void 0?f.textLabel=k[d]:k&&(f.textLabel=k),!0}};var n={xaxis:0,yaxis:1,zaxis:2},s={tip:1,tail:0,cm:.25,center:.5},r={tip:1,tail:1,cm:.75,center:.5};function c(f,d){var g=f.fullSceneLayout,m=f.dataScale,y={};function v(E,A){var b=g[A],L=m[n[A]];return p(E,function(w){return b.d2l(w)*L})}y.vectors=l(v(d.u,"xaxis"),v(d.v,"yaxis"),v(d.w,"zaxis"),d._len),y.positions=l(v(d.x,"xaxis"),v(d.y,"yaxis"),v(d.z,"zaxis"),d._len);var T=e(d);y.colormap=u(d),y.vertexIntensityBounds=[T.min/d._normMax,T.max/d._normMax],y.coneOffset=s[d.anchor],d.sizemode==="scaled"?y.coneSize=d.sizeref||.5:y.coneSize=d.sizeref&&d._normMax?d.sizeref/d._normMax:.5;var _=t(y),k=d.lightposition;return _.lightPosition=[k.x,k.y,k.z],_.ambient=d.lighting.ambient,_.diffuse=d.lighting.diffuse,_.specular=d.lighting.specular,_.roughness=d.lighting.roughness,_.fresnel=d.lighting.fresnel,_.opacity=d.opacity,d._pad=r[d.anchor]*_.vectorScale*_.coneScale*d._normMax,_}a.update=function(f){this.data=f;var d=c(this.scene,f);this.mesh.update(d)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},B.exports=function(f,d){var g=f.glplot.gl,m=c(f,d),y=h(g,m),v=new o(f,d.uid);return v.mesh=y,v.data=d,y._trace=v,f.glplot.add(y),v}},{"../../components/colorscale":678,"../../lib":803,"../../lib/gl_format_color":799,"../../plots/gl3d/zip3":907,"gl-cone3d":268}],1026:[function(i,B,V){var t=i("../../lib"),h=i("../../components/colorscale/defaults"),p=i("./attributes");B.exports=function(u,e,l,o){function a(g,m){return t.coerce(u,e,p,g,m)}var n=a("u"),s=a("v"),r=a("w"),c=a("x"),f=a("y"),d=a("z");n&&n.length&&s&&s.length&&r&&r.length&&c&&c.length&&f&&f.length&&d&&d.length?(a("sizeref"),a("sizemode"),a("anchor"),a("lighting.ambient"),a("lighting.diffuse"),a("lighting.specular"),a("lighting.roughness"),a("lighting.fresnel"),a("lightposition.x"),a("lightposition.y"),a("lightposition.z"),h(u,e,o,a,{prefix:"",cLetter:"c"}),a("text"),a("hovertext"),a("hovertemplate"),a("uhoverformat"),a("vhoverformat"),a("whoverformat"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":676,"../../lib":803,"./attributes":1023}],1027:[function(i,B,V){B.exports={moduleType:"trace",name:"cone",basePlotModule:i("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:i("./calc"),plot:i("./convert"),eventData:function(t,h){return t.norm=h.traceCoordinate[6],t},meta:{}}},{"../../plots/gl3d":896,"./attributes":1023,"./calc":1024,"./convert":1025,"./defaults":1026}],1028:[function(i,B,V){var t=i("../heatmap/attributes"),h=i("../scatter/attributes"),p=i("../../plots/cartesian/axis_format_attributes"),u=p.axisHoverFormat,e=p.descriptionOnlyNumbers,l=i("../../components/colorscale/attributes"),o=i("../../components/drawing/attributes").dash,a=i("../../plots/font_attributes"),n=i("../../lib/extend").extendFlat,s=i("../../constants/filter_ops"),r=s.COMPARISON_OPS2,c=s.INTERVAL_OPS,f=h.line;B.exports=n({z:t.z,x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:h.xperiod0,yperiod0:h.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,text:t.text,hovertext:t.hovertext,transpose:t.transpose,xtype:t.xtype,ytype:t.ytype,xhoverformat:u("x"),yhoverformat:u("y"),zhoverformat:u("z",1),hovertemplate:t.hovertemplate,hoverongaps:t.hoverongaps,connectgaps:n({},t.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:a({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(r).concat(c),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:n({},f.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:o,smoothing:n({},f.smoothing,{}),editType:"plot"}},l("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":673,"../../components/drawing/attributes":687,"../../constants/filter_ops":775,"../../lib/extend":793,"../../plots/cartesian/axis_format_attributes":857,"../../plots/font_attributes":883,"../heatmap/attributes":1085,"../scatter/attributes":1218}],1029:[function(i,B,V){var t=i("../../components/colorscale"),h=i("../heatmap/calc"),p=i("./set_contours"),u=i("./end_plus");B.exports=function(e,l){var o=h(e,l),a=o[0].z;p(l,a);var n,s=l.contours,r=t.extractOpts(l);if(s.coloring==="heatmap"&&r.auto&&l.autocontour===!1){var c=s.start,f=u(s),d=s.size||1,g=Math.floor((f-c)/d)+1;isFinite(d)||(d=1,g=1);var m=c-d/2;n=[m,m+g*d]}else n=a;return t.calc(e,l,{vals:n,cLetter:"z"}),o}},{"../../components/colorscale":678,"../heatmap/calc":1086,"./end_plus":1039,"./set_contours":1047}],1030:[function(i,B,V){B.exports=function(t,h){var p,u=t[0],e=u.z;switch(h.type){case"levels":var l=Math.min(e[0][0],e[0][1]);for(p=0;p<t.length;p++){var o=t[p];o.prefixBoundary=!o.edgepaths.length&&(l>o.level||o.starts.length&&l===o.level)}break;case"constraint":if(u.prefixBoundary=!1,u.edgepaths.length)return;var a=u.x.length,n=u.y.length,s=-1/0,r=1/0;for(p=0;p<n;p++)r=Math.min(r,e[p][0]),r=Math.min(r,e[p][a-1]),s=Math.max(s,e[p][0]),s=Math.max(s,e[p][a-1]);for(p=1;p<a-1;p++)r=Math.min(r,e[0][p]),r=Math.min(r,e[n-1][p]),s=Math.max(s,e[0][p]),s=Math.max(s,e[n-1][p]);var c,f,d=h.value;switch(h._operation){case">":d>s&&(u.prefixBoundary=!0);break;case"<":(d<r||u.starts.length&&d===r)&&(u.prefixBoundary=!0);break;case"[]":c=Math.min(d[0],d[1]),((f=Math.max(d[0],d[1]))<r||c>s||u.starts.length&&f===r)&&(u.prefixBoundary=!0);break;case"][":c=Math.min(d[0],d[1]),f=Math.max(d[0],d[1]),c<r&&f>s&&(u.prefixBoundary=!0)}}}},{}],1031:[function(i,B,V){var t=i("../../components/colorscale"),h=i("./make_color_map"),p=i("./end_plus");B.exports={min:"zmin",max:"zmax",calc:function(u,e,l){var o=e.contours,a=e.line,n=o.size||1,s=o.coloring,r=h(e,{isColorbar:!0});if(s==="heatmap"){var c=t.extractOpts(e);l._fillgradient=c.reversescale?t.flipScale(c.colorscale):c.colorscale,l._zrange=[c.min,c.max]}else s==="fill"&&(l._fillcolor=r);l._line={color:s==="lines"?r:a.color,width:o.showlines!==!1?a.width:0,dash:a.dash},l._levels={start:o.start,end:p(o),size:n}}}},{"../../components/colorscale":678,"./end_plus":1039,"./make_color_map":1044}],1032:[function(i,B,V){B.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],1033:[function(i,B,V){var t=i("fast-isnumeric"),h=i("./label_defaults"),p=i("../../components/color"),u=p.addOpacity,e=p.opacity,l=i("../../constants/filter_ops"),o=l.CONSTRAINT_REDUCTION,a=l.COMPARISON_OPS2;B.exports=function(n,s,r,c,f,d){var g,m,y,v=s.contours,T=r("contours.operation");v._operation=o[T],function(_,k){var E;a.indexOf(k.operation)===-1?(_("contours.value",[0,1]),Array.isArray(k.value)?k.value.length>2?k.value=k.value.slice(2):k.length===0?k.value=[0,1]:k.length<2?(E=parseFloat(k.value[0]),k.value=[E,E+1]):k.value=[parseFloat(k.value[0]),parseFloat(k.value[1])]:t(k.value)&&(E=parseFloat(k.value),k.value=[E,E+1])):(_("contours.value",0),t(k.value)||(Array.isArray(k.value)?k.value=parseFloat(k.value[0]):k.value=0))}(r,v),T==="="?g=v.showlines=!0:(g=r("contours.showlines"),y=r("fillcolor",u((n.line||{}).color||f,.5))),g&&(m=r("line.color",y&&e(y)?u(s.fillcolor,1):f),r("line.width",2),r("line.dash")),r("line.smoothing"),h(r,c,m,d)}},{"../../components/color":666,"../../constants/filter_ops":775,"./label_defaults":1043,"fast-isnumeric":249}],1034:[function(i,B,V){var t=i("../../constants/filter_ops"),h=i("fast-isnumeric");function p(l,o){var a,n=Array.isArray(o);function s(r){return h(r)?+r:null}return t.COMPARISON_OPS2.indexOf(l)!==-1?a=s(n?o[0]:o):t.INTERVAL_OPS.indexOf(l)!==-1?a=n?[s(o[0]),s(o[1])]:[s(o),s(o)]:t.SET_OPS.indexOf(l)!==-1&&(a=n?o.map(s):[s(o)]),a}function u(l){return function(o){o=p(l,o);var a=Math.min(o[0],o[1]),n=Math.max(o[0],o[1]);return{start:a,end:n,size:n-a}}}function e(l){return function(o){return{start:o=p(l,o),end:1/0,size:1/0}}}B.exports={"[]":u("[]"),"][":u("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":775,"fast-isnumeric":249}],1035:[function(i,B,V){B.exports=function(t,h,p,u){var e=u("contours.start"),l=u("contours.end"),o=e===!1||l===!1,a=p("contours.size");!(o?h.autocontour=!0:p("autocontour",!1))&&a||p("ncontours")}},{}],1036:[function(i,B,V){var t=i("../../lib");function h(p){return t.extendFlat({},p,{edgepaths:t.extendDeep([],p.edgepaths),paths:t.extendDeep([],p.paths),starts:t.extendDeep([],p.starts)})}B.exports=function(p,u){var e,l,o,a=function(r){return r.reverse()},n=function(r){return r};switch(u){case"=":case"<":return p;case">":for(p.length!==1&&t.warn("Contour data invalid for the specified inequality operation."),l=p[0],e=0;e<l.edgepaths.length;e++)l.edgepaths[e]=a(l.edgepaths[e]);for(e=0;e<l.paths.length;e++)l.paths[e]=a(l.paths[e]);for(e=0;e<l.starts.length;e++)l.starts[e]=a(l.starts[e]);return p;case"][":var s=a;a=n,n=s;case"[]":for(p.length!==2&&t.warn("Contour data invalid for the specified inequality range operation."),l=h(p[0]),o=h(p[1]),e=0;e<l.edgepaths.length;e++)l.edgepaths[e]=a(l.edgepaths[e]);for(e=0;e<l.paths.length;e++)l.paths[e]=a(l.paths[e]);for(e=0;e<l.starts.length;e++)l.starts[e]=a(l.starts[e]);for(;o.edgepaths.length;)l.edgepaths.push(n(o.edgepaths.shift()));for(;o.paths.length;)l.paths.push(n(o.paths.shift()));for(;o.starts.length;)l.starts.push(n(o.starts.shift()));return[l]}}},{"../../lib":803}],1037:[function(i,B,V){var t=i("../../lib"),h=i("../heatmap/xyz_defaults"),p=i("../scatter/period_defaults"),u=i("./constraint_defaults"),e=i("./contours_defaults"),l=i("./style_defaults"),o=i("./attributes");B.exports=function(a,n,s,r){function c(d,g){return t.coerce(a,n,o,d,g)}if(h(a,n,c,r)){p(a,n,r,c),c("xhoverformat"),c("yhoverformat"),c("text"),c("hovertext"),c("hovertemplate"),c("hoverongaps");var f=c("contours.type")==="constraint";c("connectgaps",t.isArray1D(n.z)),f?u(a,n,c,r,s):(e(a,n,c,function(d){return t.coerce2(a,n,o,d)}),l(a,n,c,r))}else n.visible=!1}},{"../../lib":803,"../heatmap/xyz_defaults":1099,"../scatter/period_defaults":1238,"./attributes":1028,"./constraint_defaults":1033,"./contours_defaults":1035,"./style_defaults":1049}],1038:[function(i,B,V){var t=i("../../lib"),h=i("./constraint_mapping"),p=i("./end_plus");B.exports=function(u,e,l){for(var o=u.type==="constraint"?h[u._operation](u.value):u,a=o.size,n=[],s=p(o),r=l.trace._carpetTrace,c=r?{xaxis:r.aaxis,yaxis:r.baxis,x:l.a,y:l.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:l.x,y:l.y},f=o.start;f<s;f+=a)if(n.push(t.extendFlat({level:f,crossings:{},starts:[],edgepaths:[],paths:[],z:l.z,smoothing:l.trace.line.smoothing},c)),n.length>1e3){t.warn("Too many contours, clipping at 1000",u);break}return n}},{"../../lib":803,"./constraint_mapping":1034,"./end_plus":1039}],1039:[function(i,B,V){B.exports=function(t){return t.end+t.size/1e6}},{}],1040:[function(i,B,V){var t=i("../../lib"),h=i("./constants");function p(l,o,a,n){return Math.abs(l[0]-o[0])<a&&Math.abs(l[1]-o[1])<n}function u(l,o,a,n,s){var r,c=o.join(","),f=l.crossings[c],d=function(re,ne,ae){var ie=0,he=0;return re>20&&ne?re===208||re===1114?ie=ae[0]===0?1:-1:he=ae[1]===0?1:-1:h.BOTTOMSTART.indexOf(re)!==-1?he=1:h.LEFTSTART.indexOf(re)!==-1?ie=1:h.TOPSTART.indexOf(re)!==-1?he=-1:ie=-1,[ie,he]}(f,a,o),g=[e(l,o,[-d[0],-d[1]])],m=l.z.length,y=l.z[0].length,v=o.slice(),T=d.slice();for(r=0;r<1e4;r++){if(f>20?(f=h.CHOOSESADDLE[f][(d[0]||d[1])<0?0:1],l.crossings[c]=h.SADDLEREMAINDER[f]):delete l.crossings[c],!(d=h.NEWDELTA[f])){t.log("Found bad marching index:",f,o,l.level);break}g.push(e(l,o,d)),o[0]+=d[0],o[1]+=d[1],c=o.join(","),p(g[g.length-1],g[g.length-2],n,s)&&g.pop();var _=d[0]&&(o[0]<0||o[0]>y-2)||d[1]&&(o[1]<0||o[1]>m-2);if(o[0]===v[0]&&o[1]===v[1]&&d[0]===T[0]&&d[1]===T[1]||a&&_)break;f=l.crossings[c]}r===1e4&&t.log("Infinite loop in contour?");var k,E,A,b,L,w,C,S,P,z,F,q,W,X,Q,Z=p(g[0],g[g.length-1],n,s),Y=0,N=.2*l.smoothing,J=[],D=0;for(r=1;r<g.length;r++)q=g[r],W=g[r-1],X=void 0,Q=void 0,X=q[2]-W[2],Q=q[3]-W[3],Y+=C=Math.sqrt(X*X+Q*Q),J.push(C);var U=Y/J.length*N;function G(re){return g[re%g.length]}for(r=g.length-2;r>=D;r--)if((k=J[r])<U){for(A=0,E=r-1;E>=D&&k+J[E]<U;E--)k+=J[E];if(Z&&r===g.length-2)for(A=0;A<E&&k+J[A]<U;A++)k+=J[A];L=r-E+A+1,w=Math.floor((r+E+A+2)/2),b=Z||r!==g.length-2?Z||E!==-1?L%2?G(w):[(G(w)[0]+G(w+1)[0])/2,(G(w)[1]+G(w+1)[1])/2]:g[0]:g[g.length-1],g.splice(E+1,r-E+1,b),r=E+1,A&&(D=A),Z&&(r===g.length-2?g[A]=g[g.length-1]:r===0&&(g[g.length-1]=g[0]))}for(g.splice(0,D),r=0;r<g.length;r++)g[r].length=2;if(!(g.length<2))if(Z)g.pop(),l.paths.push(g);else{a||t.log("Unclosed interior contour?",l.level,v.join(","),g.join("L"));var $=!1;for(S=0;S<l.edgepaths.length;S++)if(z=l.edgepaths[S],!$&&p(z[0],g[g.length-1],n,s)){g.pop(),$=!0;var K=!1;for(P=0;P<l.edgepaths.length;P++)if(p((F=l.edgepaths[P])[F.length-1],g[0],n,s)){K=!0,g.shift(),l.edgepaths.splice(S,1),P===S?l.paths.push(g.concat(F)):(P>S&&P--,l.edgepaths[P]=F.concat(g,z));break}K||(l.edgepaths[S]=g.concat(z))}for(S=0;S<l.edgepaths.length&&!$;S++)p((z=l.edgepaths[S])[z.length-1],g[0],n,s)&&(g.shift(),l.edgepaths[S]=z.concat(g),$=!0);$||l.edgepaths.push(g)}}function e(l,o,a){var n=o[0]+Math.max(a[0],0),s=o[1]+Math.max(a[1],0),r=l.z[s][n],c=l.xaxis,f=l.yaxis;if(a[1]){var d=(l.level-r)/(l.z[s][n+1]-r);return[c.c2p((1-d)*l.x[n]+d*l.x[n+1],!0),f.c2p(l.y[s],!0),n+d,s]}var g=(l.level-r)/(l.z[s+1][n]-r);return[c.c2p(l.x[n],!0),f.c2p((1-g)*l.y[s]+g*l.y[s+1],!0),n,s+g]}B.exports=function(l,o,a){var n,s,r,c;for(o=o||.01,a=a||.01,s=0;s<l.length;s++){for(r=l[s],c=0;c<r.starts.length;c++)u(r,r.starts[c],"edge",o,a);for(n=0;Object.keys(r.crossings).length&&n<1e4;)n++,u(r,Object.keys(r.crossings)[0].split(",").map(Number),void 0,o,a);n===1e4&&t.log("Infinite loop in contour?")}}},{"../../lib":803,"./constants":1032}],1041:[function(i,B,V){var t=i("../../components/color"),h=i("../heatmap/hover");B.exports=function(p,u,e,l,o){o||(o={}),o.isContour=!0;var a=h(p,u,e,l,o);return a&&a.forEach(function(n){var s=n.trace;s.contours.type==="constraint"&&(s.fillcolor&&t.opacity(s.fillcolor)?n.color=t.addOpacity(s.fillcolor,1):s.contours.showlines&&t.opacity(s.line.color)&&(n.color=t.addOpacity(s.line.color,1)))}),a}},{"../../components/color":666,"../heatmap/hover":1092}],1042:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("./calc"),plot:i("./plot").plot,style:i("./style"),colorbar:i("./colorbar"),hoverPoints:i("./hover"),moduleType:"trace",name:"contour",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":868,"./attributes":1028,"./calc":1029,"./colorbar":1031,"./defaults":1037,"./hover":1041,"./plot":1046,"./style":1048}],1043:[function(i,B,V){var t=i("../../lib");B.exports=function(h,p,u,e){if(e||(e={}),h("contours.showlabels")){var l=p.font;t.coerceFont(h,"contours.labelfont",{family:l.family,size:l.size,color:u}),h("contours.labelformat")}e.hasHover!==!1&&h("zhoverformat")}},{"../../lib":803}],1044:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/colorscale"),p=i("./end_plus");B.exports=function(u){var e=u.contours,l=e.start,o=p(e),a=e.size||1,n=Math.floor((o-l)/a)+1,s=e.coloring==="lines"?0:1,r=h.extractOpts(u);isFinite(a)||(a=1,n=1);var c,f,d=r.reversescale?h.flipScale(r.colorscale):r.colorscale,g=d.length,m=new Array(g),y=new Array(g);if(e.coloring==="heatmap"){var v=r.min,T=r.max;for(f=0;f<g;f++)c=d[f],m[f]=c[0]*(T-v)+v,y[f]=c[1];var _=t.extent([v,T,e.start,e.start+a*(n-1)]),k=_[v<T?0:1],E=_[v<T?1:0];k!==v&&(m.splice(0,0,k),y.splice(0,0,y[0])),E!==T&&(m.push(E),y.push(y[y.length-1]))}else for(f=0;f<g;f++)c=d[f],m[f]=(c[0]*(n+s-1)-s/2)*a+l,y[f]=c[1];return h.makeColorScaleFunc({domain:m,range:y},{noNumericCheck:!0})}},{"../../components/colorscale":678,"./end_plus":1039,"@plotly/d3":58}],1045:[function(i,B,V){var t=i("./constants");function h(p,u){var e=(u[0][0]>p?0:1)+(u[0][1]>p?0:2)+(u[1][1]>p?0:4)+(u[1][0]>p?0:8);return e===5||e===10?p>(u[0][0]+u[0][1]+u[1][0]+u[1][1])/4?e===5?713:1114:e===5?104:208:e===15?0:e}B.exports=function(p){var u,e,l,o,a,n,s,r,c,f=p[0].z,d=f.length,g=f[0].length,m=d===2||g===2;for(e=0;e<d-1;e++)for(o=[],e===0&&(o=o.concat(t.BOTTOMSTART)),e===d-2&&(o=o.concat(t.TOPSTART)),u=0;u<g-1;u++)for(l=o.slice(),u===0&&(l=l.concat(t.LEFTSTART)),u===g-2&&(l=l.concat(t.RIGHTSTART)),a=u+","+e,n=[[f[e][u],f[e][u+1]],[f[e+1][u],f[e+1][u+1]]],c=0;c<p.length;c++)(s=h((r=p[c]).level,n))&&(r.crossings[a]=s,l.indexOf(s)!==-1&&(r.starts.push([u,e]),m&&l.indexOf(s,l.indexOf(s)+1)!==-1&&r.starts.push([u,e])))}},{"./constants":1032}],1046:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../components/drawing"),u=i("../../components/colorscale"),e=i("../../lib/svg_text_utils"),l=i("../../plots/cartesian/axes"),o=i("../../plots/cartesian/set_convert"),a=i("../heatmap/plot"),n=i("./make_crossings"),s=i("./find_all_paths"),r=i("./empty_pathinfo"),c=i("./convert_to_constraints"),f=i("./close_boundaries"),d=i("./constants"),g=d.LABELOPTIMIZER;function m(T,_){var k,E,A,b,L,w,C,S="",P=0,z=T.edgepaths.map(function(Z,Y){return Y}),F=!0;function q(Z){return Math.abs(Z[1]-_[2][1])<.01}function W(Z){return Math.abs(Z[0]-_[0][0])<.01}function X(Z){return Math.abs(Z[0]-_[2][0])<.01}for(;z.length;){for(w=p.smoothopen(T.edgepaths[P],T.smoothing),S+=F?w:w.replace(/^M/,"L"),z.splice(z.indexOf(P),1),k=T.edgepaths[P][T.edgepaths[P].length-1],b=-1,A=0;A<4;A++){if(!k){h.log("Missing end?",P,T);break}for(C=k,Math.abs(C[1]-_[0][1])<.01&&!X(k)?E=_[1]:W(k)?E=_[0]:q(k)?E=_[3]:X(k)&&(E=_[2]),L=0;L<T.edgepaths.length;L++){var Q=T.edgepaths[L][0];Math.abs(k[0]-E[0])<.01?Math.abs(k[0]-Q[0])<.01&&(Q[1]-k[1])*(E[1]-Q[1])>=0&&(E=Q,b=L):Math.abs(k[1]-E[1])<.01?Math.abs(k[1]-Q[1])<.01&&(Q[0]-k[0])*(E[0]-Q[0])>=0&&(E=Q,b=L):h.log("endpt to newendpt is not vert. or horz.",k,E,Q)}if(k=E,b>=0)break;S+="L"+E}if(b===T.edgepaths.length){h.log("unclosed perimeter path");break}P=b,(F=z.indexOf(P)===-1)&&(P=z[0],S+="Z")}for(P=0;P<T.paths.length;P++)S+=p.smoothclosed(T.paths[P],T.smoothing);return S}function y(T,_,k,E){var A=_.width/2,b=_.height/2,L=T.x,w=T.y,C=T.theta,S=Math.cos(C)*A,P=Math.sin(C)*A,z=(L>E.center?E.right-L:L-E.left)/(S+Math.abs(Math.sin(C)*b)),F=(w>E.middle?E.bottom-w:w-E.top)/(Math.abs(P)+Math.cos(C)*b);if(z<1||F<1)return 1/0;var q=g.EDGECOST*(1/(z-1)+1/(F-1));q+=g.ANGLECOST*C*C;for(var W=L-S,X=w-P,Q=L+S,Z=w+P,Y=0;Y<k.length;Y++){var N=k[Y],J=Math.cos(N.theta)*N.width/2,D=Math.sin(N.theta)*N.width/2,U=2*h.segmentDistance(W,X,Q,Z,N.x-J,N.y-D,N.x+J,N.y+D)/(_.height+N.height),G=N.level===_.level,$=G?g.SAMELEVELDISTANCE:1;if(U<=$)return 1/0;q+=g.NEIGHBORCOST*(G?g.SAMELEVELFACTOR:1)/(U-$)}return q}function v(T){var _,k,E=T.trace._emptypoints,A=[],b=T.z.length,L=T.z[0].length,w=[];for(_=0;_<L;_++)w.push(1);for(_=0;_<b;_++)A.push(w.slice());for(_=0;_<E.length;_++)A[(k=E[_])[0]][k[1]]=0;return T.zmask=A,A}V.plot=function(T,_,k,E){var A=_.xaxis,b=_.yaxis;h.makeTraceGroups(E,k,"contour").each(function(L){var w=t.select(this),C=L[0],S=C.trace,P=C.x,z=C.y,F=S.contours,q=r(F,_,C),W=h.ensureSingle(w,"g","heatmapcoloring"),X=[];F.coloring==="heatmap"&&(X=[L]),a(T,_,X,W),n(q),s(q);var Q=A.c2p(P[0],!0),Z=A.c2p(P[P.length-1],!0),Y=b.c2p(z[0],!0),N=b.c2p(z[z.length-1],!0),J=[[Q,N],[Z,N],[Z,Y],[Q,Y]],D=q;F.type==="constraint"&&(D=c(q,F._operation)),function(U,G,$){var K=h.ensureSingle(U,"g","contourbg").selectAll("path").data($.coloring==="fill"?[0]:[]);K.enter().append("path"),K.exit().remove(),K.attr("d","M"+G.join("L")+"Z").style("stroke","none")}(w,J,F),function(U,G,$,K){var re=K.coloring==="fill"||K.type==="constraint"&&K._operation!=="=",ne="M"+$.join("L")+"Z";re&&f(G,K);var ae=h.ensureSingle(U,"g","contourfill").selectAll("path").data(re?G:[]);ae.enter().append("path"),ae.exit().remove(),ae.each(function(ie){var he=(ie.prefixBoundary?ne:"")+m(ie,$);he?t.select(this).attr("d",he).style("stroke","none"):t.select(this).remove()})}(w,D,J,F),function(U,G,$,K,re){var ne=h.ensureSingle(U,"g","contourlines"),ae=re.showlines!==!1,ie=re.showlabels,he=ae&&ie,se=V.createLines(ne,ae||ie,G),de=V.createLineClip(ne,he,$,K.trace.uid),ce=U.selectAll("g.contourlabels").data(ie?[0]:[]);if(ce.exit().remove(),ce.enter().append("g").classed("contourlabels",!0),ie){var ve=[],Ee=[];h.clearLocationCache();var Le=V.labelFormatter($,K),Te=p.tester.append("text").attr("data-notex",1).call(p.font,re.labelfont),xe=G[0].xaxis,fe=G[0].yaxis,ge=xe._length,ke=fe._length,Me=xe.range,Se=fe.range,De=h.aggNums(Math.min,null,K.x),Be=h.aggNums(Math.max,null,K.x),We=h.aggNums(Math.min,null,K.y),Qe=h.aggNums(Math.max,null,K.y),Oe=Math.max(xe.c2p(De,!0),0),Ue=Math.min(xe.c2p(Be,!0),ge),Xe=Math.max(fe.c2p(Qe,!0),0),Ye=Math.min(fe.c2p(We,!0),ke),$e={};Me[0]<Me[1]?($e.left=Oe,$e.right=Ue):($e.left=Ue,$e.right=Oe),Se[0]<Se[1]?($e.top=Xe,$e.bottom=Ye):($e.top=Ye,$e.bottom=Xe),$e.middle=($e.top+$e.bottom)/2,$e.center=($e.left+$e.right)/2,ve.push([[$e.left,$e.top],[$e.right,$e.top],[$e.right,$e.bottom],[$e.left,$e.bottom]]);var it=Math.sqrt(ge*ge+ke*ke),ot=d.LABELDISTANCE*it/Math.max(1,G.length/d.LABELINCREASE);se.each(function(Et){var mt=V.calcTextOpts(Et.level,Le,Te,$);t.select(this).selectAll("path").each(function(){var tt=h.getVisibleSegment(this,$e,mt.height/2);if(tt&&!(tt.len<(mt.width+mt.height)*d.LABELMIN))for(var Ke=Math.min(Math.ceil(tt.len/ot),d.LABELMAX),Mt=0;Mt<Ke;Mt++){var Jt=V.findBestTextLocation(this,tt,mt,Ee,$e);if(!Jt)break;V.addLabelData(Jt,mt,Ee,ve)}})}),Te.remove(),V.drawLabels(ce,Ee,$,de,he?ve:null)}ie&&!ae&&se.remove()}(w,q,T,C,F),function(U,G,$,K,re){var ne=K.trace,ae=$._fullLayout._clips,ie="clip"+ne.uid,he=ae.selectAll("#"+ie).data(ne.connectgaps?[]:[0]);if(he.enter().append("clipPath").classed("contourclip",!0).attr("id",ie),he.exit().remove(),ne.connectgaps===!1){var se={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:G.xaxis,yaxis:G.yaxis,x:K.x,y:K.y,z:v(K),smoothing:0};n([se]),s([se]),f([se],{type:"levels"}),h.ensureSingle(he,"path","").attr("d",(se.prefixBoundary?"M"+re.join("L")+"Z":"")+m(se,re))}else ie=null;p.setClipUrl(U,ie,$)}(w,_,T,C,J)})},V.createLines=function(T,_,k){var E=k[0].smoothing,A=T.selectAll("g.contourlevel").data(_?k:[]);if(A.exit().remove(),A.enter().append("g").classed("contourlevel",!0),_){var b=A.selectAll("path.openline").data(function(w){return w.pedgepaths||w.edgepaths});b.exit().remove(),b.enter().append("path").classed("openline",!0),b.attr("d",function(w){return p.smoothopen(w,E)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var L=A.selectAll("path.closedline").data(function(w){return w.ppaths||w.paths});L.exit().remove(),L.enter().append("path").classed("closedline",!0),L.attr("d",function(w){return p.smoothclosed(w,E)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return A},V.createLineClip=function(T,_,k,E){var A=_?"clipline"+E:null,b=k._fullLayout._clips.selectAll("#"+A).data(_?[0]:[]);return b.exit().remove(),b.enter().append("clipPath").classed("contourlineclip",!0).attr("id",A),p.setClipUrl(T,A,k),b},V.labelFormatter=function(T,_){var k=T._fullLayout,E=_.trace,A=E.contours,b={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(A.labelformat)b.tickformat=A.labelformat,o(b,k);else{var L=u.extractOpts(E);if(L&&L.colorbar&&L.colorbar._axis)b=L.colorbar._axis;else{if(A.type==="constraint"){var w=A.value;Array.isArray(w)?b.range=[w[0],w[w.length-1]]:b.range=[w,w]}else b.range=[A.start,A.end],b.nticks=(A.end-A.start)/A.size;b.range[0]===b.range[1]&&(b.range[1]+=b.range[0]||1),b.nticks||(b.nticks=1e3),o(b,k),l.prepTicks(b),b._tmin=null,b._tmax=null}}return function(C){return l.tickText(b,C).text}},V.calcTextOpts=function(T,_,k,E){var A=_(T);k.text(A).call(e.convertToTspans,E);var b=k.node(),L=p.bBox(b,!0);return{text:A,width:L.width,height:L.height,fontSize:+b.style["font-size"].replace("px",""),level:T,dy:(L.top+L.bottom)/2}},V.findBestTextLocation=function(T,_,k,E,A){var b,L,w,C,S,P=k.width;_.isClosed?(L=_.len/g.INITIALSEARCHPOINTS,b=_.min+L/2,w=_.max):(L=(_.len-P)/(g.INITIALSEARCHPOINTS+1),b=_.min+L+P/2,w=_.max-(L+P)/2);for(var z=1/0,F=0;F<g.ITERATIONS;F++){for(var q=b;q<w;q+=L){var W=h.getTextLocation(T,_.total,q,P),X=y(W,k,E,A);X<z&&(z=X,S=W,C=q)}if(z>2*g.MAXCOST)break;F&&(L/=2),w=(b=C-L/2)+1.5*L}if(z<=g.MAXCOST)return S},V.addLabelData=function(T,_,k,E){var A=_.fontSize,b=_.width+A/3,L=Math.max(0,_.height-A/3),w=T.x,C=T.y,S=T.theta,P=Math.sin(S),z=Math.cos(S),F=function(W,X){return[w+W*z-X*P,C+W*P+X*z]},q=[F(-b/2,-L/2),F(-b/2,L/2),F(b/2,L/2),F(b/2,-L/2)];k.push({text:_.text,x:w,y:C,dy:_.dy,theta:S,level:_.level,width:b,height:L}),E.push(q)},V.drawLabels=function(T,_,k,E,A){var b=T.selectAll("text").data(_,function(C){return C.text+","+C.x+","+C.y+","+C.theta});if(b.exit().remove(),b.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(C){var S=C.x+Math.sin(C.theta)*C.dy,P=C.y-Math.cos(C.theta)*C.dy;t.select(this).text(C.text).attr({x:S,y:P,transform:"rotate("+180*C.theta/Math.PI+" "+S+" "+P+")"}).call(e.convertToTspans,k)}),A){for(var L="",w=0;w<A.length;w++)L+="M"+A[w].join("L")+"Z";h.ensureSingle(E,"path","").attr("d",L)}}},{"../../components/colorscale":678,"../../components/drawing":688,"../../lib":803,"../../lib/svg_text_utils":829,"../../plots/cartesian/axes":854,"../../plots/cartesian/set_convert":875,"../heatmap/plot":1096,"./close_boundaries":1030,"./constants":1032,"./convert_to_constraints":1036,"./empty_pathinfo":1038,"./find_all_paths":1040,"./make_crossings":1045,"@plotly/d3":58}],1047:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../../lib");function p(u,e,l){var o={type:"linear",range:[u,e]};return t.autoTicks(o,(e-u)/(l||15)),o}B.exports=function(u,e){var l=u.contours;if(u.autocontour){var o=u.zmin,a=u.zmax;(u.zauto||o===void 0)&&(o=h.aggNums(Math.min,null,e)),(u.zauto||a===void 0)&&(a=h.aggNums(Math.max,null,e));var n=p(o,a,u.ncontours);l.size=n.dtick,l.start=t.tickFirst(n),n.range.reverse(),l.end=t.tickFirst(n),l.start===o&&(l.start+=l.size),l.end===a&&(l.end-=l.size),l.start>l.end&&(l.start=l.end=(l.start+l.end)/2),u._input.contours||(u._input.contours={}),h.extendFlat(u._input.contours,{start:l.start,end:l.end,size:l.size}),u._input.autocontour=!0}else if(l.type!=="constraint"){var s,r=l.start,c=l.end,f=u._input.contours;r>c&&(l.start=f.start=c,c=l.end=f.end=r,r=l.start),!(l.size>0)&&(s=r===c?1:p(r,c,u.ncontours).dtick,f.size=l.size=s)}}},{"../../lib":803,"../../plots/cartesian/axes":854}],1048:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/drawing"),p=i("../heatmap/style"),u=i("./make_color_map");B.exports=function(e){var l=t.select(e).selectAll("g.contour");l.style("opacity",function(o){return o[0].trace.opacity}),l.each(function(o){var a=t.select(this),n=o[0].trace,s=n.contours,r=n.line,c=s.size||1,f=s.start,d=s.type==="constraint",g=!d&&s.coloring==="lines",m=!d&&s.coloring==="fill",y=g||m?u(n):null;a.selectAll("g.contourlevel").each(function(_){t.select(this).selectAll("path").call(h.lineGroupStyle,r.width,g?y(_.level):r.color,r.dash)});var v=s.labelfont;if(a.selectAll("g.contourlabels text").each(function(_){h.font(t.select(this),{family:v.family,size:v.size,color:v.color||(g?y(_.level):r.color)})}),d)a.selectAll("g.contourfill path").style("fill",n.fillcolor);else if(m){var T;a.selectAll("g.contourfill path").style("fill",function(_){return T===void 0&&(T=_.level),y(_.level+.5*c)}),T===void 0&&(T=f),a.selectAll("g.contourbg path").style("fill",y(T-.5*c))}}),p(e)}},{"../../components/drawing":688,"../heatmap/style":1097,"./make_color_map":1044,"@plotly/d3":58}],1049:[function(i,B,V){var t=i("../../components/colorscale/defaults"),h=i("./label_defaults");B.exports=function(p,u,e,l,o){var a,n=e("contours.coloring"),s="";n==="fill"&&(a=e("contours.showlines")),a!==!1&&(n!=="lines"&&(s=e("line.color","#000")),e("line.width",.5),e("line.dash")),n!=="none"&&(p.showlegend!==!0&&(u.showlegend=!1),u._dfltShowLegend=!1,t(p,u,l,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),h(e,l,s,o)}},{"../../components/colorscale/defaults":676,"./label_defaults":1043}],1050:[function(i,B,V){var t=i("../heatmap/attributes"),h=i("../contour/attributes"),p=i("../../components/colorscale/attributes"),u=i("../../lib/extend").extendFlat,e=h.contours;B.exports=u({carpet:{valType:"string",editType:"calc"},z:t.z,a:t.x,a0:t.x0,da:t.dx,b:t.y,b0:t.y0,db:t.dy,text:t.text,hovertext:t.hovertext,transpose:t.transpose,atype:t.xtype,btype:t.ytype,fillcolor:h.fillcolor,autocontour:h.autocontour,ncontours:h.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:h.line.color,width:h.line.width,dash:h.line.dash,smoothing:h.line.smoothing,editType:"plot"},transforms:void 0},p("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../contour/attributes":1028,"../heatmap/attributes":1085}],1051:[function(i,B,V){var t=i("../../components/colorscale/calc"),h=i("../../lib"),p=i("../heatmap/convert_column_xyz"),u=i("../heatmap/clean_2d_array"),e=i("../heatmap/interp2d"),l=i("../heatmap/find_empties"),o=i("../heatmap/make_bound_array"),a=i("./defaults"),n=i("../carpet/lookup_carpetid"),s=i("../contour/set_contours");B.exports=function(r,c){var f=c._carpetTrace=n(r,c);if(f&&f.visible&&f.visible!=="legendonly"){if(!c.a||!c.b){var d=r.data[f.index],g=r.data[c.index];g.a||(g.a=d.a),g.b||(g.b=d.b),a(g,c,c._defaultColor,r._fullLayout)}var m=function(y,v){var T,_,k,E,A,b,L,w=v._carpetTrace,C=w.aaxis,S=w.baxis;C._minDtick=0,S._minDtick=0,h.isArray1D(v.z)&&p(v,C,S,"a","b",["z"]),T=v._a=v._a||v.a,E=v._b=v._b||v.b,T=T?C.makeCalcdata(v,"_a"):[],E=E?S.makeCalcdata(v,"_b"):[],_=v.a0||0,k=v.da||1,A=v.b0||0,b=v.db||1,L=v._z=u(v._z||v.z,v.transpose),v._emptypoints=l(L),e(L,v._emptypoints);var P=h.maxRowLength(L),z=v.xtype==="scaled"?"":T,F=o(v,z,_,k,P,C),q=v.ytype==="scaled"?"":E,W=o(v,q,A,b,L.length,S),X={a:F,b:W,z:L};return v.contours.type==="levels"&&v.contours.coloring!=="none"&&t(y,v,{vals:L,containerStr:"",cLetter:"z"}),[X]}(r,c);return s(c,c._z),m}}},{"../../components/colorscale/calc":674,"../../lib":803,"../carpet/lookup_carpetid":1001,"../contour/set_contours":1047,"../heatmap/clean_2d_array":1087,"../heatmap/convert_column_xyz":1089,"../heatmap/find_empties":1091,"../heatmap/interp2d":1094,"../heatmap/make_bound_array":1095,"./defaults":1052}],1052:[function(i,B,V){var t=i("../../lib"),h=i("../heatmap/xyz_defaults"),p=i("./attributes"),u=i("../contour/constraint_defaults"),e=i("../contour/contours_defaults"),l=i("../contour/style_defaults");B.exports=function(o,a,n,s){function r(c,f){return t.coerce(o,a,p,c,f)}if(r("carpet"),o.a&&o.b){if(!h(o,a,r,s,"a","b"))return void(a.visible=!1);r("text"),r("contours.type")==="constraint"?u(o,a,r,s,n,{hasHover:!1}):(e(o,a,r,function(c){return t.coerce2(o,a,p,c)}),l(o,a,r,s,{hasHover:!1}))}else a._defaultColor=n,a._length=null}},{"../../lib":803,"../contour/constraint_defaults":1033,"../contour/contours_defaults":1035,"../contour/style_defaults":1049,"../heatmap/xyz_defaults":1099,"./attributes":1050}],1053:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../contour/colorbar"),calc:i("./calc"),plot:i("./plot"),style:i("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":868,"../contour/colorbar":1031,"../contour/style":1048,"./attributes":1050,"./calc":1051,"./defaults":1052,"./plot":1054}],1054:[function(i,B,V){var t=i("@plotly/d3"),h=i("../carpet/map_1d_array"),p=i("../carpet/makepath"),u=i("../../components/drawing"),e=i("../../lib"),l=i("../contour/make_crossings"),o=i("../contour/find_all_paths"),a=i("../contour/plot"),n=i("../contour/constants"),s=i("../contour/convert_to_constraints"),r=i("../contour/empty_pathinfo"),c=i("../contour/close_boundaries"),f=i("../carpet/lookup_carpetid"),d=i("../carpet/axis_aligned_line");function g(v,T,_){var k=v.getPointAtLength(T),E=v.getPointAtLength(_),A=E.x-k.x,b=E.y-k.y,L=Math.sqrt(A*A+b*b);return[A/L,b/L]}function m(v){var T=Math.sqrt(v[0]*v[0]+v[1]*v[1]);return[v[0]/T,v[1]/T]}function y(v,T){var _=Math.abs(v[0]*T[0]+v[1]*T[1]);return Math.sqrt(1-_*_)/_}B.exports=function(v,T,_,k){var E=T.xaxis,A=T.yaxis;e.makeTraceGroups(k,_,"contour").each(function(b){var L=t.select(this),w=b[0],C=w.trace,S=C._carpetTrace=f(v,C),P=v.calcdata[S.index][0];if(S.visible&&S.visible!=="legendonly"){var z=w.a,F=w.b,q=C.contours,W=r(q,T,w),X=q.type==="constraint",Q=q._operation,Z=X?Q==="="?"lines":"fill":q.coloring,Y=[[z[0],F[F.length-1]],[z[z.length-1],F[F.length-1]],[z[z.length-1],F[0]],[z[0],F[0]]];l(W);var N=1e-8*(z[z.length-1]-z[0]),J=1e-8*(F[F.length-1]-F[0]);o(W,N,J);var D,U,G,$,K=W;q.type==="constraint"&&(K=s(W,Q)),function(ie,he){var se,de,ce,ve,Ee,Le,Te,xe,fe;for(se=0;se<ie.length;se++){for(ve=ie[se],Ee=ve.pedgepaths=[],Le=ve.ppaths=[],de=0;de<ve.edgepaths.length;de++){for(fe=ve.edgepaths[de],Te=[],ce=0;ce<fe.length;ce++)Te[ce]=he(fe[ce]);Ee.push(Te)}for(de=0;de<ve.paths.length;de++){for(fe=ve.paths[de],xe=[],ce=0;ce<fe.length;ce++)xe[ce]=he(fe[ce]);Le.push(xe)}}}(W,ae);var re=[];for($=P.clipsegments.length-1;$>=0;$--)D=P.clipsegments[$],U=h([],D.x,E.c2p),G=h([],D.y,A.c2p),U.reverse(),G.reverse(),re.push(p(U,G,D.bicubic));var ne="M"+re.join("L")+"Z";(function(ie,he,se,de,ce,ve){var Ee,Le,Te,xe,fe=e.ensureSingle(ie,"g","contourbg").selectAll("path").data(ve!=="fill"||ce?[]:[0]);fe.enter().append("path"),fe.exit().remove();var ge=[];for(xe=0;xe<he.length;xe++)Ee=he[xe],Le=h([],Ee.x,se.c2p),Te=h([],Ee.y,de.c2p),ge.push(p(Le,Te,Ee.bicubic));fe.attr("d","M"+ge.join("L")+"Z").style("stroke","none")})(L,P.clipsegments,E,A,X,Z),function(ie,he,se,de,ce,ve,Ee,Le,Te,xe,fe){var ge=xe==="fill";ge&&c(ce,ie.contours);var ke=e.ensureSingle(he,"g","contourfill").selectAll("path").data(ge?ce:[]);ke.enter().append("path"),ke.exit().remove(),ke.each(function(Me){var Se=(Me.prefixBoundary?fe:"")+function(De,Be,We,Qe,Oe,Ue,Xe,Ye){var $e,it,ot,Et,mt,tt,Ke,Mt="",Jt=Be.edgepaths.map(function(ht,at){return at}),$t=!0,je=1e-4*Math.abs(We[0][0]-We[2][0]),Ge=1e-4*Math.abs(We[0][1]-We[2][1]);function Ct(ht){return Math.abs(ht[1]-We[0][1])<Ge}function Ie(ht){return Math.abs(ht[1]-We[2][1])<Ge}function be(ht){return Math.abs(ht[0]-We[0][0])<je}function Ae(ht){return Math.abs(ht[0]-We[2][0])<je}function Pe(ht,at){var nt,xt,Lt,bt,St="";for(Ct(ht)&&!Ae(ht)||Ie(ht)&&!be(ht)?(bt=Oe.aaxis,Lt=d(Oe,Ue,[ht[0],at[0]],.5*(ht[1]+at[1]))):(bt=Oe.baxis,Lt=d(Oe,Ue,.5*(ht[0]+at[0]),[ht[1],at[1]])),nt=1;nt<Lt.length;nt++)for(St+=bt.smoothing?"C":"L",xt=0;xt<Lt[nt].length;xt++){var st=Lt[nt][xt];St+=[Xe.c2p(st[0]),Ye.c2p(st[1])]+" "}return St}for($e=0,it=null;Jt.length;){var ze=Be.edgepaths[$e][0];for(it&&(Mt+=Pe(it,ze)),Ke=u.smoothopen(Be.edgepaths[$e].map(Qe),Be.smoothing),Mt+=$t?Ke:Ke.replace(/^M/,"L"),Jt.splice(Jt.indexOf($e),1),it=Be.edgepaths[$e][Be.edgepaths[$e].length-1],mt=-1,Et=0;Et<4;Et++){if(!it){e.log("Missing end?",$e,Be);break}for(Ct(it)&&!Ae(it)?ot=We[1]:be(it)?ot=We[0]:Ie(it)?ot=We[3]:Ae(it)&&(ot=We[2]),tt=0;tt<Be.edgepaths.length;tt++){var qe=Be.edgepaths[tt][0];Math.abs(it[0]-ot[0])<je?Math.abs(it[0]-qe[0])<je&&(qe[1]-it[1])*(ot[1]-qe[1])>=0&&(ot=qe,mt=tt):Math.abs(it[1]-ot[1])<Ge?Math.abs(it[1]-qe[1])<Ge&&(qe[0]-it[0])*(ot[0]-qe[0])>=0&&(ot=qe,mt=tt):e.log("endpt to newendpt is not vert. or horz.",it,ot,qe)}if(mt>=0)break;Mt+=Pe(it,ot),it=ot}if(mt===Be.edgepaths.length){e.log("unclosed perimeter path");break}$e=mt,($t=Jt.indexOf($e)===-1)&&($e=Jt[0],Mt+=Pe(it,ot)+"Z",it=null)}for($e=0;$e<Be.paths.length;$e++)Mt+=u.smoothclosed(Be.paths[$e].map(Qe),Be.smoothing);return Mt}(0,Me,ve,Ee,Le,Te,se,de);Se?t.select(this).attr("d",Se).style("stroke","none"):t.select(this).remove()})}(C,L,E,A,K,Y,ae,S,P,Z,ne),function(ie,he,se,de,ce,ve,Ee){var Le=e.ensureSingle(ie,"g","contourlines"),Te=ce.showlines!==!1,xe=ce.showlabels,fe=Te&&xe,ge=a.createLines(Le,Te||xe,he),ke=a.createLineClip(Le,fe,se,de.trace.uid),Me=ie.selectAll("g.contourlabels").data(xe?[0]:[]);if(Me.exit().remove(),Me.enter().append("g").classed("contourlabels",!0),xe){var Se=ve.xaxis,De=ve.yaxis,Be=Se._length,We=De._length,Qe=[[[0,0],[Be,0],[Be,We],[0,We]]],Oe=[];e.clearLocationCache();var Ue=a.labelFormatter(se,de),Xe=u.tester.append("text").attr("data-notex",1).call(u.font,ce.labelfont),Ye={left:0,right:Be,center:Be/2,top:0,bottom:We,middle:We/2},$e=Math.sqrt(Be*Be+We*We),it=n.LABELDISTANCE*$e/Math.max(1,he.length/n.LABELINCREASE);ge.each(function(ot){var Et=a.calcTextOpts(ot.level,Ue,Xe,se);t.select(this).selectAll("path").each(function(mt){var tt=e.getVisibleSegment(this,Ye,Et.height/2);if(tt&&(function($t,je,Ge,Ct,Ie,be){for(var Ae,Pe=0;Pe<Ge.pedgepaths.length;Pe++)je===Ge.pedgepaths[Pe]&&(Ae=Ge.edgepaths[Pe]);if(!Ae)return;var ze=Ie.a[0],qe=Ie.a[Ie.a.length-1],ht=Ie.b[0],at=Ie.b[Ie.b.length-1];function nt(st,It){var jt,Ut=0;return(Math.abs(st[0]-ze)<.1||Math.abs(st[0]-qe)<.1)&&(jt=m(Ie.dxydb_rough(st[0],st[1],.1)),Ut=Math.max(Ut,be*y(It,jt)/2)),(Math.abs(st[1]-ht)<.1||Math.abs(st[1]-at)<.1)&&(jt=m(Ie.dxyda_rough(st[0],st[1],.1)),Ut=Math.max(Ut,be*y(It,jt)/2)),Ut}var xt=g($t,0,1),Lt=g($t,Ct.total,Ct.total-1),bt=nt(Ae[0],xt),St=Ct.total-nt(Ae[Ae.length-1],Lt);Ct.min<bt&&(Ct.min=bt),Ct.max>St&&(Ct.max=St),Ct.len=Ct.max-Ct.min}(this,mt,ot,tt,Ee,Et.height),!(tt.len<(Et.width+Et.height)*n.LABELMIN)))for(var Ke=Math.min(Math.ceil(tt.len/it),n.LABELMAX),Mt=0;Mt<Ke;Mt++){var Jt=a.findBestTextLocation(this,tt,Et,Oe,Ye);if(!Jt)break;a.addLabelData(Jt,Et,Oe,Qe)}})}),Xe.remove(),a.drawLabels(Me,Oe,se,ke,fe?Qe:null)}xe&&!Te&&ge.remove()}(L,W,v,w,q,T,S),u.setClipUrl(L,S._clipPathId,v)}function ae(ie){var he=S.ab2xy(ie[0],ie[1],!0);return[E.c2p(he[0]),A.c2p(he[1])]}})}},{"../../components/drawing":688,"../../lib":803,"../carpet/axis_aligned_line":985,"../carpet/lookup_carpetid":1001,"../carpet/makepath":1002,"../carpet/map_1d_array":1003,"../contour/close_boundaries":1030,"../contour/constants":1032,"../contour/convert_to_constraints":1036,"../contour/empty_pathinfo":1038,"../contour/find_all_paths":1040,"../contour/make_crossings":1045,"../contour/plot":1046,"@plotly/d3":58}],1055:[function(i,B,V){var t=i("../../components/colorscale/attributes"),h=i("../../plots/template_attributes").hovertemplateAttrs,p=i("../../plots/attributes"),u=i("../scattermapbox/attributes"),e=i("../../lib/extend").extendFlat;B.exports=e({lon:u.lon,lat:u.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:u.text,hovertext:u.hovertext,hoverinfo:e({},p.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:h(),showlegend:e({},p.showlegend,{dflt:!1})},t("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/template_attributes":926,"../scattermapbox/attributes":1283}],1056:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib").isArrayOrTypedArray,p=i("../../constants/numerical").BADNUM,u=i("../../components/colorscale/calc"),e=i("../../lib")._;B.exports=function(l,o){for(var a=o._length,n=new Array(a),s=o.z,r=h(s)&&s.length,c=0;c<a;c++){var f=n[c]={},d=o.lon[c],g=o.lat[c];if(f.lonlat=t(d)&&t(g)?[+d,+g]:[p,p],r){var m=s[c];f.z=t(m)?m:p}}return u(l,o,{vals:r?s:[0,1],containerStr:"",cLetter:"z"}),a&&(n[0].t={labels:{lat:e(l,"lat:")+" ",lon:e(l,"lon:")+" "}}),n}},{"../../components/colorscale/calc":674,"../../constants/numerical":779,"../../lib":803,"fast-isnumeric":249}],1057:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("../../components/color"),u=i("../../components/colorscale"),e=i("../../constants/numerical").BADNUM,l=i("../../lib/geojson_utils").makeBlank;B.exports=function(o){var a=o[0].trace,n=a.visible===!0&&a._length!==0,s=a._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:l()};if(!n)return s;var r,c=[],f=a.z,d=a.radius,g=h.isArrayOrTypedArray(f)&&f.length,m=h.isArrayOrTypedArray(d);for(r=0;r<o.length;r++){var y=o[r],v=y.lonlat;if(v[0]!==e){var T={};if(g){var _=y.z;T.z=_!==e?_:0}m&&(T.r=t(d[r])&&d[r]>0?+d[r]:0),c.push({type:"Feature",geometry:{type:"Point",coordinates:v},properties:T})}}var k=u.extractOpts(a),E=k.reversescale?u.flipScale(k.colorscale):k.colorscale,A=E[0][1],b=["interpolate",["linear"],["heatmap-density"],0,p.opacity(A)<1?A:p.addOpacity(A,0)];for(r=1;r<E.length;r++)b.push(E[r][0],E[r][1]);var L=["interpolate",["linear"],["get","z"],k.min,0,k.max,1];return h.extendFlat(s.heatmap.paint,{"heatmap-weight":g?L:1/(k.max-k.min),"heatmap-color":b,"heatmap-radius":m?{type:"identity",property:"r"}:a.radius,"heatmap-opacity":a.opacity}),s.geojson={type:"FeatureCollection",features:c},s.heatmap.layout.visibility="visible",s}},{"../../components/color":666,"../../components/colorscale":678,"../../constants/numerical":779,"../../lib":803,"../../lib/geojson_utils":797,"fast-isnumeric":249}],1058:[function(i,B,V){var t=i("../../lib"),h=i("../../components/colorscale/defaults"),p=i("./attributes");B.exports=function(u,e,l,o){function a(c,f){return t.coerce(u,e,p,c,f)}var n=a("lon")||[],s=a("lat")||[],r=Math.min(n.length,s.length);r?(e._length=r,a("z"),a("radius"),a("below"),a("text"),a("hovertext"),a("hovertemplate"),h(u,e,o,a,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":676,"../../lib":803,"./attributes":1055}],1059:[function(i,B,V){B.exports=function(t,h){return t.lon=h.lon,t.lat=h.lat,t.z=h.z,t}},{}],1060:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../scattermapbox/hover").hoverPoints,p=i("../scattermapbox/hover").getExtraText;B.exports=function(u,e,l){var o=h(u,e,l);if(o){var a=o[0],n=a.cd,s=n[0].trace,r=n[a.index];if(delete a.color,"z"in r){var c=a.subplot.mockAxis;a.z=r.z,a.zLabel=t.tickText(c,c.c2l(r.z),"hover").text}return a.extraText=p(s,r,n[0].t.labels),[a]}}},{"../../plots/cartesian/axes":854,"../scattermapbox/hover":1288}],1061:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../heatmap/colorbar"),formatLabels:i("../scattermapbox/format_labels"),calc:i("./calc"),plot:i("./plot"),hoverPoints:i("./hover"),eventData:i("./event_data"),getBelow:function(t,h){for(var p=h.getMapLayers(),u=0;u<p.length;u++){var e=p[u],l=e.id;if(e.type==="symbol"&&typeof l=="string"&&l.indexOf("plotly-")===-1)return l}},moduleType:"trace",name:"densitymapbox",basePlotModule:i("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":911,"../heatmap/colorbar":1088,"../scattermapbox/format_labels":1287,"./attributes":1055,"./calc":1056,"./defaults":1058,"./event_data":1059,"./hover":1060,"./plot":1062}],1062:[function(i,B,V){var t=i("./convert"),h=i("../../plots/mapbox/constants").traceLayerPrefix;function p(e,l){this.type="densitymapbox",this.subplot=e,this.uid=l,this.sourceId="source-"+l,this.layerList=[["heatmap",h+l+"-heatmap"]],this.below=null}var u=p.prototype;u.update=function(e){var l=this.subplot,o=this.layerList,a=t(e),n=l.belowLookup["trace-"+this.uid];l.map.getSource(this.sourceId).setData(a.geojson),n!==this.below&&(this._removeLayers(),this._addLayers(a,n),this.below=n);for(var s=0;s<o.length;s++){var r=o[s],c=r[0],f=r[1],d=a[c];l.setOptions(f,"setLayoutProperty",d.layout),d.layout.visibility==="visible"&&l.setOptions(f,"setPaintProperty",d.paint)}},u._addLayers=function(e,l){for(var o=this.subplot,a=this.layerList,n=this.sourceId,s=0;s<a.length;s++){var r=a[s],c=r[0],f=e[c];o.addLayer({type:c,id:r[1],source:n,layout:f.layout,paint:f.paint},l)}},u._removeLayers=function(){for(var e=this.subplot.map,l=this.layerList,o=l.length-1;o>=0;o--)e.removeLayer(l[o][1])},u.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},B.exports=function(e,l){var o=l[0].trace,a=new p(e,o.uid),n=a.sourceId,s=t(l),r=a.below=e.belowLookup["trace-"+o.uid];return e.map.addSource(n,{type:"geojson",data:s.geojson}),a._addLayers(s,r),a}},{"../../plots/mapbox/constants":909,"./convert":1057}],1063:[function(i,B,V){var t=i("../../lib");B.exports=function(h,p){for(var u=0;u<h.length;u++)h[u].i=u;t.mergeArray(p.text,h,"tx"),t.mergeArray(p.hovertext,h,"htx");var e=p.marker;if(e){t.mergeArray(e.opacity,h,"mo"),t.mergeArray(e.color,h,"mc");var l=e.line;l&&(t.mergeArray(l.color,h,"mlc"),t.mergeArrayCastPositive(l.width,h,"mlw"))}}},{"../../lib":803}],1064:[function(i,B,V){var t,h=i("../bar/attributes"),p=i("../scatter/attributes").line,u=i("../../plots/attributes"),e=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,l=i("../../plots/template_attributes").hovertemplateAttrs,o=i("../../plots/template_attributes").texttemplateAttrs,a=i("./constants"),n=i("../../lib/extend").extendFlat,s=i("../../components/color");B.exports={x:h.x,x0:h.x0,dx:h.dx,y:h.y,y0:h.y0,dy:h.dy,xperiod:h.xperiod,yperiod:h.yperiod,xperiod0:h.xperiod0,yperiod0:h.yperiod0,xperiodalignment:h.xperiodalignment,yperiodalignment:h.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),hovertext:h.hovertext,hovertemplate:l({},{keys:a.eventDataKeys}),hoverinfo:n({},u.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:o({editType:"plot"},{keys:a.eventDataKeys.concat(["label","value"])}),text:h.text,textposition:h.textposition,insidetextanchor:n({},h.insidetextanchor,{dflt:"middle"}),textangle:n({},h.textangle,{dflt:0}),textfont:h.textfont,insidetextfont:h.insidetextfont,outsidetextfont:h.outsidetextfont,constraintext:h.constraintext,cliponaxis:h.cliponaxis,orientation:n({},h.orientation,{}),offset:n({},h.offset,{arrayOk:!1}),width:n({},h.width,{arrayOk:!1}),marker:(t=n({},h.marker),delete t.pattern,t),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:n({},p.color,{dflt:s.defaultLine}),width:n({},p.width,{dflt:0,editType:"plot"}),dash:p.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:h.offsetgroup,alignmentgroup:h.alignmentgroup}},{"../../components/color":666,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../bar/attributes":941,"../scatter/attributes":1218,"./constants":1066}],1065:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../../plots/cartesian/align_period"),p=i("./arrays_to_calcdata"),u=i("../scatter/calc_selection"),e=i("../../constants/numerical").BADNUM;function l(o){return o===e?0:o}B.exports=function(o,a){var n,s,r,c,f,d,g,m,y=t.getFromId(o,a.xaxis||"x"),v=t.getFromId(o,a.yaxis||"y");a.orientation==="h"?(n=y.makeCalcdata(a,"x"),r=v.makeCalcdata(a,"y"),c=h(a,v,"y",r),f=!!a.yperiodalignment,d="y"):(n=v.makeCalcdata(a,"y"),r=y.makeCalcdata(a,"x"),c=h(a,y,"x",r),f=!!a.xperiodalignment,d="x"),s=c.vals;var T,_=Math.min(s.length,n.length),k=new Array(_);for(a._base=[],g=0;g<_;g++){n[g]<0&&(n[g]=e);var E=!1;n[g]!==e&&g+1<_&&n[g+1]!==e&&(E=!0),m=k[g]={p:s[g],s:n[g],cNext:E},a._base[g]=-.5*m.s,f&&(k[g].orig_p=r[g],k[g][d+"End"]=c.ends[g],k[g][d+"Start"]=c.starts[g]),a.ids&&(m.id=String(a.ids[g])),g===0&&(k[0].vTotal=0),k[0].vTotal+=l(m.s),m.begR=l(m.s)/l(k[0].s)}for(g=0;g<_;g++)(m=k[g]).s!==e&&(m.sumR=m.s/k[0].vTotal,m.difR=T!==void 0?m.s/T:1,T=m.s);return p(k,a),u(k,a),k}},{"../../constants/numerical":779,"../../plots/cartesian/align_period":851,"../../plots/cartesian/axes":854,"../scatter/calc_selection":1220,"./arrays_to_calcdata":1063}],1066:[function(i,B,V){B.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],1067:[function(i,B,V){var t=i("../bar/cross_trace_calc").setGroupPositions;B.exports=function(h,p){var u,e,l=h._fullLayout,o=h._fullData,a=h.calcdata,n=p.xaxis,s=p.yaxis,r=[],c=[],f=[];for(e=0;e<o.length;e++){var d=o[e],g=d.orientation==="h";d.visible===!0&&d.xaxis===n._id&&d.yaxis===s._id&&d.type==="funnel"&&(u=a[e],g?f.push(u):c.push(u),r.push(u))}var m={mode:l.funnelmode,norm:l.funnelnorm,gap:l.funnelgap,groupgap:l.funnelgroupgap};for(t(h,n,s,c,m),t(h,s,n,f,m),e=0;e<r.length;e++){u=r[e];for(var y=0;y<u.length;y++)y+1<u.length&&(u[y].nextP0=u[y+1].p0,u[y].nextS0=u[y+1].s0,u[y].nextP1=u[y+1].p1,u[y].nextS1=u[y+1].s1)}}},{"../bar/cross_trace_calc":944}],1068:[function(i,B,V){var t=i("../../lib"),h=i("../bar/defaults").handleGroupingDefaults,p=i("../bar/defaults").handleText,u=i("../scatter/xy_defaults"),e=i("../scatter/period_defaults"),l=i("./attributes"),o=i("../../components/color");B.exports={supplyDefaults:function(a,n,s,r){function c(m,y){return t.coerce(a,n,l,m,y)}if(u(a,n,r,c)){e(a,n,r,c),c("xhoverformat"),c("yhoverformat"),c("orientation",n.y&&!n.x?"v":"h"),c("offset"),c("width");var f=c("text");c("hovertext"),c("hovertemplate");var d=c("textposition");p(a,n,r,c,d,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),n.textposition==="none"||n.texttemplate||c("textinfo",Array.isArray(f)?"text+value":"value");var g=c("marker.color",s);c("marker.line.color",o.defaultLine),c("marker.line.width"),c("connector.visible")&&(c("connector.fillcolor",function(m){var y=t.isArrayOrTypedArray(m)?"#000":m;return o.addOpacity(y,.5*o.opacity(y))}(g)),c("connector.line.width")&&(c("connector.line.color"),c("connector.line.dash")))}else n.visible=!1},crossTraceDefaults:function(a,n){var s,r;function c(d){return t.coerce(r._input,r,l,d)}if(n.funnelmode==="group")for(var f=0;f<a.length;f++)s=(r=a[f])._input,h(s,r,n,c)}}},{"../../components/color":666,"../../lib":803,"../bar/defaults":945,"../scatter/period_defaults":1238,"../scatter/xy_defaults":1245,"./attributes":1064}],1069:[function(i,B,V){B.exports=function(t,h){return t.x="xVal"in h?h.xVal:h.x,t.y="yVal"in h?h.yVal:h.y,"percentInitial"in h&&(t.percentInitial=h.percentInitial),"percentPrevious"in h&&(t.percentPrevious=h.percentPrevious),"percentTotal"in h&&(t.percentTotal=h.percentTotal),h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),t}},{}],1070:[function(i,B,V){var t=i("../../components/color").opacity,h=i("../bar/hover").hoverOnBars,p=i("../../lib").formatPercent;B.exports=function(u,e,l,o,a){var n=h(u,e,l,o,a);if(n){var s=n.cd,r=s[0].trace,c=r.orientation==="h",f=s[n.index];n[(c?"x":"y")+"LabelVal"]=f.s,n.percentInitial=f.begR,n.percentInitialLabel=p(f.begR,1),n.percentPrevious=f.difR,n.percentPreviousLabel=p(f.difR,1),n.percentTotal=f.sumR,n.percentTotalLabel=p(f.sumR,1);var d=f.hi||r.hoverinfo,g=[];if(d&&d!=="none"&&d!=="skip"){var m=d==="all",y=d.split("+"),v=function(T){return m||y.indexOf(T)!==-1};v("percent initial")&&g.push(n.percentInitialLabel+" of initial"),v("percent previous")&&g.push(n.percentPreviousLabel+" of previous"),v("percent total")&&g.push(n.percentTotalLabel+" of total")}return n.extraText=g.join("<br>"),n.color=function(T,_){var k=T.marker,E=_.mc||k.color,A=_.mlc||k.line.color,b=_.mlw||k.line.width;if(t(E))return E;if(t(A)&&b)return A}(r,f),[n]}}},{"../../components/color":666,"../../lib":803,"../bar/hover":948}],1071:[function(i,B,V){B.exports={attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyDefaults:i("./defaults").supplyDefaults,crossTraceDefaults:i("./defaults").crossTraceDefaults,supplyLayoutDefaults:i("./layout_defaults"),calc:i("./calc"),crossTraceCalc:i("./cross_trace_calc"),plot:i("./plot"),style:i("./style").style,hoverPoints:i("./hover"),eventData:i("./event_data"),selectPoints:i("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:i("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":868,"../bar/select":953,"./attributes":1064,"./calc":1065,"./cross_trace_calc":1067,"./defaults":1068,"./event_data":1069,"./hover":1070,"./layout_attributes":1072,"./layout_defaults":1073,"./plot":1074,"./style":1075}],1072:[function(i,B,V){B.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1073:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes");B.exports=function(p,u,e){var l=!1;function o(s,r){return t.coerce(p,u,h,s,r)}for(var a=0;a<e.length;a++){var n=e[a];if(n.visible&&n.type==="funnel"){l=!0;break}}l&&(o("funnelmode"),o("funnelgap",.2),o("funnelgroupgap"))}},{"../../lib":803,"./layout_attributes":1072}],1074:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../components/drawing"),u=i("../../constants/numerical").BADNUM,e=i("../bar/plot"),l=i("../bar/uniform_text").clearMinTextSize;function o(a,n,s,r){var c=[],f=[],d=r?n:s,g=r?s:n;return c[0]=d.c2p(a.s0,!0),f[0]=g.c2p(a.p0,!0),c[1]=d.c2p(a.s1,!0),f[1]=g.c2p(a.p1,!0),c[2]=d.c2p(a.nextS0,!0),f[2]=g.c2p(a.nextP0,!0),c[3]=d.c2p(a.nextS1,!0),f[3]=g.c2p(a.nextP1,!0),r?[c,f]:[f,c]}B.exports=function(a,n,s,r){var c=a._fullLayout;l("funnel",c),function(f,d,g,m){var y=d.xaxis,v=d.yaxis;h.makeTraceGroups(m,g,"trace bars").each(function(T){var _=t.select(this),k=T[0].trace,E=h.ensureSingle(_,"g","regions");if(k.connector&&k.connector.visible){var A=k.orientation==="h",b=E.selectAll("g.region").data(h.identity);b.enter().append("g").classed("region",!0),b.exit().remove();var L=b.size();b.each(function(w,C){if(C===L-1||w.cNext){var S=o(w,y,v,A),P=S[0],z=S[1],F="";P[0]!==u&&z[0]!==u&&P[1]!==u&&z[1]!==u&&P[2]!==u&&z[2]!==u&&P[3]!==u&&z[3]!==u&&(F+=A?"M"+P[0]+","+z[1]+"L"+P[2]+","+z[2]+"H"+P[3]+"L"+P[1]+","+z[1]+"Z":"M"+P[1]+","+z[1]+"L"+P[2]+","+z[3]+"V"+z[2]+"L"+P[1]+","+z[0]+"Z"),F===""&&(F="M0,0Z"),h.ensureSingle(t.select(this),"path").attr("d",F).call(p.setClipUrl,d.layerClipId,f)}})}else E.remove()})}(a,n,s,r),function(f,d,g,m){var y=d.xaxis,v=d.yaxis;h.makeTraceGroups(m,g,"trace bars").each(function(T){var _=t.select(this),k=T[0].trace,E=h.ensureSingle(_,"g","lines");if(k.connector&&k.connector.visible&&k.connector.line.width){var A=k.orientation==="h",b=E.selectAll("g.line").data(h.identity);b.enter().append("g").classed("line",!0),b.exit().remove();var L=b.size();b.each(function(w,C){if(C===L-1||w.cNext){var S=o(w,y,v,A),P=S[0],z=S[1],F="";P[3]!==void 0&&z[3]!==void 0&&(A?(F+="M"+P[0]+","+z[1]+"L"+P[2]+","+z[2],F+="M"+P[1]+","+z[1]+"L"+P[3]+","+z[2]):(F+="M"+P[1]+","+z[1]+"L"+P[2]+","+z[3],F+="M"+P[1]+","+z[0]+"L"+P[2]+","+z[2])),F===""&&(F="M0,0Z"),h.ensureSingle(t.select(this),"path").attr("d",F).call(p.setClipUrl,d.layerClipId,f)}})}else E.remove()})}(a,n,s,r),e.plot(a,n,s,r,{mode:c.funnelmode,norm:c.funnelmode,gap:c.funnelgap,groupgap:c.funnelgroupgap})}},{"../../components/drawing":688,"../../constants/numerical":779,"../../lib":803,"../bar/plot":952,"../bar/uniform_text":957,"@plotly/d3":58}],1075:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/drawing"),p=i("../../components/color"),u=i("../../constants/interactions").DESELECTDIM,e=i("../bar/style"),l=i("../bar/uniform_text").resizeText,o=e.styleTextPoints;B.exports={style:function(a,n,s){var r=s||t.select(a).selectAll("g.funnellayer").selectAll("g.trace");l(a,r,"funnel"),r.style("opacity",function(c){return c[0].trace.opacity}),r.each(function(c){var f=t.select(this),d=c[0].trace;f.selectAll(".point > path").each(function(g){if(!g.isBlank){var m=d.marker;t.select(this).call(p.fill,g.mc||m.color).call(p.stroke,g.mlc||m.line.color).call(h.dashLine,m.line.dash,g.mlw||m.line.width).style("opacity",d.selectedpoints&&!g.selected?u:1)}}),o(f,d,a),f.selectAll(".regions").each(function(){t.select(this).selectAll("path").style("stroke-width",0).call(p.fill,d.connector.fillcolor)}),f.selectAll(".lines").each(function(){var g=d.connector.line;h.lineGroupStyle(t.select(this).selectAll("path"),g.width,g.color,g.dash)})})}}},{"../../components/color":666,"../../components/drawing":688,"../../constants/interactions":778,"../bar/style":955,"../bar/uniform_text":957,"@plotly/d3":58}],1076:[function(i,B,V){var t=i("../pie/attributes"),h=i("../../plots/attributes"),p=i("../../plots/domain").attributes,u=i("../../plots/template_attributes").hovertemplateAttrs,e=i("../../plots/template_attributes").texttemplateAttrs,l=i("../../lib/extend").extendFlat;B.exports={labels:t.labels,label0:t.label0,dlabel:t.dlabel,values:t.values,marker:{colors:t.marker.colors,line:{color:l({},t.marker.line.color,{dflt:null}),width:l({},t.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:t.text,hovertext:t.hovertext,scalegroup:l({},t.scalegroup,{}),textinfo:l({},t.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:l({},h.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:u({},{keys:["label","color","value","text","percent"]}),textposition:l({},t.textposition,{values:["inside","none"],dflt:"inside"}),textfont:t.textfont,insidetextfont:t.insidetextfont,title:{text:t.title.text,font:t.title.font,position:l({},t.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:p({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":793,"../../plots/attributes":850,"../../plots/domain":882,"../../plots/template_attributes":926,"../pie/attributes":1192}],1077:[function(i,B,V){var t=i("../../plots/plots");V.name="funnelarea",V.plot=function(h,p,u,e){t.plotBasePlot(V.name,h,p,u,e)},V.clean=function(h,p,u,e){t.cleanBasePlot(V.name,h,p,u,e)}},{"../../plots/plots":917}],1078:[function(i,B,V){var t=i("../pie/calc");B.exports={calc:function(h,p){return t.calc(h,p)},crossTraceCalc:function(h){t.crossTraceCalc(h,{type:"funnelarea"})}}},{"../pie/calc":1194}],1079:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("../../plots/domain").defaults,u=i("../bar/defaults").handleText,e=i("../pie/defaults").handleLabelsAndValues;B.exports=function(l,o,a,n){function s(T,_){return t.coerce(l,o,h,T,_)}var r=s("labels"),c=s("values"),f=e(r,c),d=f.len;if(o._hasLabels=f.hasLabels,o._hasValues=f.hasValues,!o._hasLabels&&o._hasValues&&(s("label0"),s("dlabel")),d){o._length=d,s("marker.line.width")&&s("marker.line.color",n.paper_bgcolor),s("marker.colors"),s("scalegroup");var g,m=s("text"),y=s("texttemplate");if(y||(g=s("textinfo",Array.isArray(m)?"text+percent":"percent")),s("hovertext"),s("hovertemplate"),y||g&&g!=="none"){var v=s("textposition");u(l,o,n,s,v,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}p(o,n,s),s("title.text")&&(s("title.position"),t.coerceFont(s,"title.font",n.font)),s("aspectratio"),s("baseratio")}else o.visible=!1}},{"../../lib":803,"../../plots/domain":882,"../bar/defaults":945,"../pie/defaults":1195,"./attributes":1076}],1080:[function(i,B,V){B.exports={moduleType:"trace",name:"funnelarea",basePlotModule:i("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyDefaults:i("./defaults"),supplyLayoutDefaults:i("./layout_defaults"),calc:i("./calc").calc,crossTraceCalc:i("./calc").crossTraceCalc,plot:i("./plot"),style:i("./style"),styleOne:i("../pie/style_one"),meta:{}}},{"../pie/style_one":1203,"./attributes":1076,"./base_plot":1077,"./calc":1078,"./defaults":1079,"./layout_attributes":1081,"./layout_defaults":1082,"./plot":1083,"./style":1084}],1081:[function(i,B,V){var t=i("../pie/layout_attributes").hiddenlabels;B.exports={hiddenlabels:t,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":1199}],1082:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes");B.exports=function(p,u){function e(l,o){return t.coerce(p,u,h,l,o)}e("hiddenlabels"),e("funnelareacolorway",u.colorway),e("extendfunnelareacolors")}},{"../../lib":803,"./layout_attributes":1081}],1083:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/drawing"),p=i("../../lib"),u=p.strScale,e=p.strTranslate,l=i("../../lib/svg_text_utils"),o=i("../bar/plot").toMoveInsideBar,a=i("../bar/uniform_text"),n=a.recordMinTextSize,s=a.clearMinTextSize,r=i("../pie/helpers"),c=i("../pie/plot"),f=c.attachFxHandlers,d=c.determineInsideTextFont,g=c.layoutAreas,m=c.prerenderTitles,y=c.positionTitleOutside,v=c.formatSliceLabel;function T(_,k){return"l"+(k[0]-_[0])+","+(k[1]-_[1])}B.exports=function(_,k){var E=_._fullLayout;s("funnelarea",E),m(k,_),g(k,E._size),p.makeTraceGroups(E._funnelarealayer,k,"trace").each(function(A){var b=t.select(this),L=A[0],w=L.trace;(function(C){if(!C.length)return;var S=C[0],P=S.trace,z=P.aspectratio,F=P.baseratio;F>.999&&(F=.999);var q,W=Math.pow(F,2),X=S.vTotal,Q=X,Z=X*W/(1-W)/X;function Y(){var Te,xe={x:Te=Math.sqrt(Z),y:-Te};return[xe.x,xe.y]}var N,J,D=[];for(D.push(Y()),N=C.length-1;N>-1;N--)if(!(J=C[N]).hidden){var U=J.v/Q;Z+=U,D.push(Y())}var G=1/0,$=-1/0;for(N=0;N<D.length;N++)q=D[N],G=Math.min(G,q[1]),$=Math.max($,q[1]);for(N=0;N<D.length;N++)D[N][1]-=($+G)/2;var K=D[D.length-1][0],re=S.r,ne=($-G)/2,ae=re/K,ie=re/ne*z;for(S.r=ie*ne,N=0;N<D.length;N++)D[N][0]*=ae,D[N][1]*=ie;var he=[-(q=D[0])[0],q[1]],se=[q[0],q[1]],de=0;for(N=C.length-1;N>-1;N--)if(!(J=C[N]).hidden){var ce=D[de+=1][0],ve=D[de][1];J.TL=[-ce,ve],J.TR=[ce,ve],J.BL=he,J.BR=se,J.pxmid=(Ee=J.TR,Le=J.BR,[.5*(Ee[0]+Le[0]),.5*(Ee[1]+Le[1])]),he=J.TL,se=J.TR}var Ee,Le})(A),b.each(function(){var C=t.select(this).selectAll("g.slice").data(A);C.enter().append("g").classed("slice",!0),C.exit().remove(),C.each(function(P,z){if(P.hidden)t.select(this).selectAll("path,g").remove();else{P.pointNumber=P.i,P.curveNumber=w.index;var F=L.cx,q=L.cy,W=t.select(this),X=W.selectAll("path.surface").data([P]);X.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),W.call(f,_,A);var Q="M"+(F+P.TR[0])+","+(q+P.TR[1])+T(P.TR,P.BR)+T(P.BR,P.BL)+T(P.BL,P.TL)+"Z";X.attr("d",Q),v(_,P,L);var Z=r.castOption(w.textposition,P.pts),Y=W.selectAll("g.slicetext").data(P.text&&Z!=="none"?[0]:[]);Y.enter().append("g").classed("slicetext",!0),Y.exit().remove(),Y.each(function(){var N=p.ensureSingle(t.select(this),"text","",function(ne){ne.attr("data-notex",1)}),J=p.ensureUniformFontSize(_,d(w,P,E.font));N.text(P.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(h.font,J).call(l.convertToTspans,_);var D,U,G,$=h.bBox(N.node()),K=Math.min(P.BL[1],P.BR[1])+q,re=Math.max(P.TL[1],P.TR[1])+q;U=Math.max(P.TL[0],P.BL[0])+F,G=Math.min(P.TR[0],P.BR[0])+F,(D=o(U,G,K,re,$,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=J.size,n(w.type,D,E),A[z].transform=D,N.attr("transform",p.getTextTransform(D))})}});var S=t.select(this).selectAll("g.titletext").data(w.title.text?[0]:[]);S.enter().append("g").classed("titletext",!0),S.exit().remove(),S.each(function(){var P=p.ensureSingle(t.select(this),"text","",function(q){q.attr("data-notex",1)}),z=w.title.text;w._meta&&(z=p.templateString(z,w._meta)),P.text(z).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(h.font,w.title.font).call(l.convertToTspans,_);var F=y(L,E._size);P.attr("transform",e(F.x,F.y)+u(Math.min(1,F.scale))+e(F.tx,F.ty))})})})}},{"../../components/drawing":688,"../../lib":803,"../../lib/svg_text_utils":829,"../bar/plot":952,"../bar/uniform_text":957,"../pie/helpers":1197,"../pie/plot":1201,"@plotly/d3":58}],1084:[function(i,B,V){var t=i("@plotly/d3"),h=i("../pie/style_one"),p=i("../bar/uniform_text").resizeText;B.exports=function(u){var e=u._fullLayout._funnelarealayer.selectAll(".trace");p(u,e,"funnelarea"),e.each(function(l){var o=l[0].trace,a=t.select(this);a.style({opacity:o.opacity}),a.selectAll("path.surface").each(function(n){t.select(this).call(h,n,o)})})}},{"../bar/uniform_text":957,"../pie/style_one":1203,"@plotly/d3":58}],1085:[function(i,B,V){var t=i("../scatter/attributes"),h=i("../../plots/attributes"),p=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,u=i("../../plots/template_attributes").hovertemplateAttrs,e=i("../../components/colorscale/attributes"),l=i("../../lib/extend").extendFlat;B.exports=l({z:{valType:"data_array",editType:"calc"},x:l({},t.x,{impliedEdits:{xtype:"array"}}),x0:l({},t.x0,{impliedEdits:{xtype:"scaled"}}),dx:l({},t.dx,{impliedEdits:{xtype:"scaled"}}),y:l({},t.y,{impliedEdits:{ytype:"array"}}),y0:l({},t.y0,{impliedEdits:{ytype:"scaled"}}),dy:l({},t.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:l({},t.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:l({},t.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:l({},t.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:l({},t.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:l({},t.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:l({},t.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:p("x"),yhoverformat:p("y"),zhoverformat:p("z",1),hovertemplate:u(),showlegend:l({},h.showlegend,{dflt:!1})},{transforms:void 0},e("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../scatter/attributes":1218}],1086:[function(i,B,V){var t=i("../../registry"),h=i("../../lib"),p=i("../../plots/cartesian/axes"),u=i("../../plots/cartesian/align_period"),e=i("../histogram2d/calc"),l=i("../../components/colorscale/calc"),o=i("./convert_column_xyz"),a=i("./clean_2d_array"),n=i("./interp2d"),s=i("./find_empties"),r=i("./make_bound_array"),c=i("../../constants/numerical").BADNUM;function f(d){for(var g=[],m=d.length,y=0;y<m;y++){var v=d[y];v!==c&&g.push(v)}return g}B.exports=function(d,g){var m,y,v,T,_,k,E,A,b,L,w,C=p.getFromId(d,g.xaxis||"x"),S=p.getFromId(d,g.yaxis||"y"),P=t.traceIs(g,"contour"),z=t.traceIs(g,"histogram"),F=t.traceIs(g,"gl2d"),q=P?"best":g.zsmooth;if(C._minDtick=0,S._minDtick=0,z)T=(w=e(d,g)).orig_x,m=w.x,y=w.x0,v=w.dx,A=w.orig_y,_=w.y,k=w.y0,E=w.dy,b=w.z;else{var W=g.z;h.isArray1D(W)?(o(g,C,S,"x","y",["z"]),m=g._x,_=g._y,W=g._z):(T=g.x?C.makeCalcdata(g,"x"):[],A=g.y?S.makeCalcdata(g,"y"):[],m=u(g,C,"x",T).vals,_=u(g,S,"y",A).vals,g._x=m,g._y=_),y=g.x0,v=g.dx,k=g.y0,E=g.dy,b=a(W,g,C,S)}function X(ne){q=g._input.zsmooth=g.zsmooth=!1,h.warn('cannot use zsmooth: "fast": '+ne)}if((C.rangebreaks||S.rangebreaks)&&(b=function(ne,ae,ie){for(var he=[],se=-1,de=0;de<ie.length;de++)if(ae[de]!==c){se++,he[se]=[];for(var ce=0;ce<ie[de].length;ce++)ne[ce]!==c&&he[se].push(ie[de][ce])}return he}(m,_,b),z||(m=f(m),_=f(_),g._x=m,g._y=_)),z||!P&&!g.connectgaps||(g._emptypoints=s(b),n(b,g._emptypoints)),q==="fast"){if(C.type==="log"||S.type==="log")X("log axis found");else if(!z){if(m.length){var Q=(m[m.length-1]-m[0])/(m.length-1),Z=Math.abs(Q/100);for(L=0;L<m.length-1;L++)if(Math.abs(m[L+1]-m[L]-Q)>Z){X("x scale is not linear");break}}if(_.length&&q==="fast"){var Y=(_[_.length-1]-_[0])/(_.length-1),N=Math.abs(Y/100);for(L=0;L<_.length-1;L++)if(Math.abs(_[L+1]-_[L]-Y)>N){X("y scale is not linear");break}}}}var J=h.maxRowLength(b),D=g.xtype==="scaled"?"":m,U=r(g,D,y,v,J,C),G=g.ytype==="scaled"?"":_,$=r(g,G,k,E,b.length,S);F||(g._extremes[C._id]=p.findExtremes(C,U),g._extremes[S._id]=p.findExtremes(S,$));var K={x:U,y:$,z:b,text:g._text||g.text,hovertext:g._hovertext||g.hovertext};if(g.xperiodalignment&&T&&(K.orig_x=T),g.yperiodalignment&&A&&(K.orig_y=A),D&&D.length===U.length-1&&(K.xCenter=D),G&&G.length===$.length-1&&(K.yCenter=G),z&&(K.xRanges=w.xRanges,K.yRanges=w.yRanges,K.pts=w.pts),P||l(d,g,{vals:b,cLetter:"z"}),P&&g.contours&&g.contours.coloring==="heatmap"){var re={type:g.type==="contour"?"heatmap":"histogram2d",xcalendar:g.xcalendar,ycalendar:g.ycalendar};K.xfill=r(re,D,y,v,J,C),K.yfill=r(re,G,k,E,b.length,S)}return[K]}},{"../../components/colorscale/calc":674,"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/align_period":851,"../../plots/cartesian/axes":854,"../../registry":931,"../histogram2d/calc":1118,"./clean_2d_array":1087,"./convert_column_xyz":1089,"./find_empties":1091,"./interp2d":1094,"./make_bound_array":1095}],1087:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("../../constants/numerical").BADNUM;B.exports=function(u,e,l,o){var a,n,s,r,c,f;function d(_){if(t(_))return+_}if(e&&e.transpose){for(a=0,c=0;c<u.length;c++)a=Math.max(a,u[c].length);if(a===0)return!1;s=function(_){return _.length},r=function(_,k,E){return(_[E]||[])[k]}}else a=u.length,s=function(_,k){return _[k].length},r=function(_,k,E){return(_[k]||[])[E]};var g=function(_,k,E){return k===p||E===p?p:r(_,k,E)};function m(_){if(e&&e.type!=="carpet"&&e.type!=="contourcarpet"&&_&&_.type==="category"&&e["_"+_._id.charAt(0)].length){var k=_._id.charAt(0),E={},A=e["_"+k+"CategoryMap"]||e[k];for(c=0;c<A.length;c++)E[A[c]]=c;return function(b){var L=E[_._categories[b]];return L+1?L:p}}return h.identity}var y=m(l),v=m(o);o&&o.type==="category"&&(a=o._categories.length);var T=new Array(a);for(c=0;c<a;c++)for(n=l&&l.type==="category"?l._categories.length:s(u,c),T[c]=new Array(n),f=0;f<n;f++)T[c][f]=d(g(u,v(c),y(f)));return T}},{"../../constants/numerical":779,"../../lib":803,"fast-isnumeric":249}],1088:[function(i,B,V){B.exports={min:"zmin",max:"zmax"}},{}],1089:[function(i,B,V){var t=i("../../lib"),h=i("../../constants/numerical").BADNUM,p=i("../../plots/cartesian/align_period");B.exports=function(u,e,l,o,a,n){var s=u._length,r=e.makeCalcdata(u,o),c=l.makeCalcdata(u,a);r=p(u,e,o,r).vals,c=p(u,l,a,c).vals;var f,d,g,m,y=u.text,v=y!==void 0&&t.isArray1D(y),T=u.hovertext,_=T!==void 0&&t.isArray1D(T),k=t.distinctVals(r),E=k.vals,A=t.distinctVals(c),b=A.vals,L=[],w=b.length,C=E.length;for(f=0;f<n.length;f++)L[f]=t.init2dArray(w,C);v&&(g=t.init2dArray(w,C)),_&&(m=t.init2dArray(w,C));var S=t.init2dArray(w,C);for(f=0;f<s;f++)if(r[f]!==h&&c[f]!==h){var P=t.findBin(r[f]+k.minDiff/2,E),z=t.findBin(c[f]+A.minDiff/2,b);for(d=0;d<n.length;d++){var F=u[n[d]];L[d][z][P]=F[f],S[z][P]=f}v&&(g[z][P]=y[f]),_&&(m[z][P]=T[f])}for(u["_"+o]=E,u["_"+a]=b,d=0;d<n.length;d++)u["_"+n[d]]=L[d];v&&(u._text=g),_&&(u._hovertext=m),e&&e.type==="category"&&(u["_"+o+"CategoryMap"]=E.map(function(q){return e._categories[q]})),l&&l.type==="category"&&(u["_"+a+"CategoryMap"]=b.map(function(q){return l._categories[q]})),u._after2before=S}},{"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/align_period":851}],1090:[function(i,B,V){var t=i("../../lib"),h=i("./xyz_defaults"),p=i("../scatter/period_defaults"),u=i("./style_defaults"),e=i("../../components/colorscale/defaults"),l=i("./attributes");B.exports=function(o,a,n,s){function r(c,f){return t.coerce(o,a,l,c,f)}h(o,a,r,s)?(p(o,a,s,r),r("xhoverformat"),r("yhoverformat"),r("text"),r("hovertext"),r("hovertemplate"),u(o,a,r,s),r("hoverongaps"),r("connectgaps",t.isArray1D(a.z)&&a.zsmooth!==!1),e(o,a,s,r,{prefix:"",cLetter:"z"})):a.visible=!1}},{"../../components/colorscale/defaults":676,"../../lib":803,"../scatter/period_defaults":1238,"./attributes":1085,"./style_defaults":1098,"./xyz_defaults":1099}],1091:[function(i,B,V){var t=i("../../lib").maxRowLength;B.exports=function(h){var p,u,e,l,o,a,n,s,r=[],c={},f=[],d=h[0],g=[],m=[0,0,0],y=t(h);for(u=0;u<h.length;u++)for(p=g,g=d,d=h[u+1]||[],e=0;e<y;e++)g[e]===void 0&&((a=(g[e-1]!==void 0?1:0)+(g[e+1]!==void 0?1:0)+(p[e]!==void 0?1:0)+(d[e]!==void 0?1:0))?(u===0&&a++,e===0&&a++,u===h.length-1&&a++,e===g.length-1&&a++,a<4&&(c[[u,e]]=[u,e,a]),r.push([u,e,a])):f.push([u,e]));for(;f.length;){for(n={},s=!1,o=f.length-1;o>=0;o--)(a=((c[[(u=(l=f[o])[0])-1,e=l[1]]]||m)[2]+(c[[u+1,e]]||m)[2]+(c[[u,e-1]]||m)[2]+(c[[u,e+1]]||m)[2])/20)&&(n[l]=[u,e,a],f.splice(o,1),s=!0);if(!s)throw"findEmpties iterated with no new neighbors";for(l in n)c[l]=n[l],r.push(n[l])}return r.sort(function(v,T){return T[2]-v[2]})}},{"../../lib":803}],1092:[function(i,B,V){var t=i("../../components/fx"),h=i("../../lib"),p=i("../../plots/cartesian/axes"),u=i("../../components/colorscale").extractOpts;B.exports=function(e,l,o,a,n){n||(n={});var s,r,c,f,d=n.isContour,g=e.cd[0],m=g.trace,y=e.xa,v=e.ya,T=g.x,_=g.y,k=g.z,E=g.xCenter,A=g.yCenter,b=g.zmask,L=m.zhoverformat,w=T,C=_;if(e.index!==!1){try{c=Math.round(e.index[1]),f=Math.round(e.index[0])}catch{return void h.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(c<0||c>=k[0].length||f<0||f>k.length)return}else{if(t.inbox(l-T[0],l-T[T.length-1],0)>0||t.inbox(o-_[0],o-_[_.length-1],0)>0)return;if(d){var S;for(w=[2*T[0]-T[1]],S=1;S<T.length;S++)w.push((T[S]+T[S-1])/2);for(w.push([2*T[T.length-1]-T[T.length-2]]),C=[2*_[0]-_[1]],S=1;S<_.length;S++)C.push((_[S]+_[S-1])/2);C.push([2*_[_.length-1]-_[_.length-2]])}c=Math.max(0,Math.min(w.length-2,h.findBin(l,w))),f=Math.max(0,Math.min(C.length-2,h.findBin(o,C)))}var P,z,F=y.c2p(T[c]),q=y.c2p(T[c+1]),W=v.c2p(_[f]),X=v.c2p(_[f+1]);d?(P=g.orig_x||T,z=g.orig_y||_,q=F,s=P[c],X=W,r=z[f]):(P=g.orig_x||E||T,z=g.orig_y||A||_,s=E?P[c]:(P[c]+P[c+1])/2,r=A?z[f]:(z[f]+z[f+1])/2,y&&y.type==="category"&&(s=T[c]),v&&v.type==="category"&&(r=_[f]),m.zsmooth&&(F=q=y.c2p(s),W=X=v.c2p(r)));var Q=k[f][c];if(b&&!b[f][c]&&(Q=void 0),Q!==void 0||m.hoverongaps){var Z;Array.isArray(g.hovertext)&&Array.isArray(g.hovertext[f])?Z=g.hovertext[f][c]:Array.isArray(g.text)&&Array.isArray(g.text[f])&&(Z=g.text[f][c]);var Y=u(m),N={type:"linear",range:[Y.min,Y.max],hoverformat:L,_separators:y._separators,_numFormat:y._numFormat},J=p.tickText(N,Q,"hover").text;return[h.extendFlat(e,{index:m._after2before?m._after2before[f][c]:[f,c],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:F,x1:q,y0:W,y1:X,xLabelVal:s,yLabelVal:r,zLabelVal:Q,zLabel:J,text:Z})]}}},{"../../components/colorscale":678,"../../components/fx":706,"../../lib":803,"../../plots/cartesian/axes":854}],1093:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("./calc"),plot:i("./plot"),colorbar:i("./colorbar"),style:i("./style"),hoverPoints:i("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":868,"./attributes":1085,"./calc":1086,"./colorbar":1088,"./defaults":1090,"./hover":1092,"./plot":1096,"./style":1097}],1094:[function(i,B,V){var t=i("../../lib"),h=[[-1,0],[1,0],[0,-1],[0,1]];function p(e){return .5-.25*Math.min(1,.5*e)}function u(e,l,o){var a,n,s,r,c,f,d,g,m,y,v,T,_,k=0;for(r=0;r<l.length;r++){for(n=(a=l[r])[0],s=a[1],v=e[n][s],y=0,m=0,c=0;c<4;c++)(d=e[n+(f=h[c])[0]])&&(g=d[s+f[1]])!==void 0&&(y===0?T=_=g:(T=Math.min(T,g),_=Math.max(_,g)),m++,y+=g);if(m===0)throw"iterateInterp2d order is wrong: no defined neighbors";e[n][s]=y/m,v===void 0?m<4&&(k=1):(e[n][s]=(1+o)*e[n][s]-o*v,_>T&&(k=Math.max(k,Math.abs(e[n][s]-v)/(_-T))))}return k}B.exports=function(e,l){var o,a=1;for(u(e,l),o=0;o<l.length&&!(l[o][2]<4);o++);for(l=l.slice(o),o=0;o<100&&a>.01;o++)a=u(e,l,p(a));return a>.01&&t.log("interp2d didn't converge quickly",a),e}},{"../../lib":803}],1095:[function(i,B,V){var t=i("../../registry"),h=i("../../lib").isArrayOrTypedArray;B.exports=function(p,u,e,l,o,a){var n,s,r,c=[],f=t.traceIs(p,"contour"),d=t.traceIs(p,"histogram"),g=t.traceIs(p,"gl2d");if(h(u)&&u.length>1&&!d&&a.type!=="category"){var m=u.length;if(!(m<=o))return f?u.slice(0,o):u.slice(0,o+1);if(f||g)c=u.slice(0,o);else if(o===1)c=[u[0]-.5,u[0]+.5];else{for(c=[1.5*u[0]-.5*u[1]],r=1;r<m;r++)c.push(.5*(u[r-1]+u[r]));c.push(1.5*u[m-1]-.5*u[m-2])}if(m<o){var y=c[c.length-1],v=y-c[c.length-2];for(r=m;r<o;r++)y+=v,c.push(y)}}else{var T=p[a._id.charAt(0)+"calendar"];for(d?n=a.r2c(e,0,T):h(u)&&u.length===1?n=u[0]:e===void 0?n=0:n=(a.type==="log"?a.d2c:a.r2c)(e,0,T),s=l||1,r=f||g?0:-.5;r<o;r++)c.push(n+s*r)}return c}},{"../../lib":803,"../../registry":931}],1096:[function(i,B,V){var t=i("@plotly/d3"),h=i("tinycolor2"),p=i("../../registry"),u=i("../../lib"),e=i("../../components/colorscale").makeColorScaleFuncFromTrace,l=i("../../constants/xmlns_namespaces");function o(s,r){var c=r.length-2,f=u.constrain(u.findBin(s,r),0,c),d=r[f],g=r[f+1],m=u.constrain(f+(s-d)/(g-d)-.5,0,c),y=Math.round(m),v=Math.abs(m-y);return m&&m!==c&&v?{bin0:y,frac:v,bin1:Math.round(y+v/(m-y))}:{bin0:y,bin1:y,frac:0}}function a(s,r){var c=r.length-1,f=u.constrain(u.findBin(s,r),0,c),d=r[f],g=(s-d)/(r[f+1]-d)||0;return g<=0?{bin0:f,bin1:f,frac:0}:g<.5?{bin0:f,bin1:f+1,frac:g}:{bin0:f+1,bin1:f,frac:1-g}}function n(s,r,c){s[r]=c[0],s[r+1]=c[1],s[r+2]=c[2],s[r+3]=Math.round(255*c[3])}B.exports=function(s,r,c,f){var d=r.xaxis,g=r.yaxis;u.makeTraceGroups(f,c,"hm").each(function(m){var y,v,T,_,k,E,A=t.select(this),b=m[0],L=b.trace,w=b.z,C=b.x,S=b.y,P=b.xCenter,z=b.yCenter,F=p.traceIs(L,"contour"),q=F?"best":L.zsmooth,W=w.length,X=u.maxRowLength(w),Q=!1,Z=!1;for(E=0;y===void 0&&E<C.length-1;)y=d.c2p(C[E]),E++;for(E=C.length-1;v===void 0&&E>0;)v=d.c2p(C[E]),E--;for(v<y&&(T=v,v=y,y=T,Q=!0),E=0;_===void 0&&E<S.length-1;)_=g.c2p(S[E]),E++;for(E=S.length-1;k===void 0&&E>0;)k=g.c2p(S[E]),E--;if(k<_&&(T=_,_=k,k=T,Z=!0),F&&(P=C,z=S,C=b.xfill,S=b.yfill),q!=="fast"){var Y=q==="best"?0:.5;y=Math.max(-Y*d._length,y),v=Math.min((1+Y)*d._length,v),_=Math.max(-Y*g._length,_),k=Math.min((1+Y)*g._length,k)}var N=Math.round(v-y),J=Math.round(k-_);if(N<=0||J<=0)A.selectAll("image").data([]).exit().remove();else{var D,U;q==="fast"?(D=X,U=W):(D=N,U=J);var G=document.createElement("canvas");G.width=D,G.height=U;var $,K,re=G.getContext("2d"),ne=e(L,{noNumericCheck:!0,returnArray:!0});q==="fast"?($=Q?function(Ct){return X-1-Ct}:u.identity,K=Z?function(Ct){return W-1-Ct}:u.identity):($=function(Ct){return u.constrain(Math.round(d.c2p(C[Ct])-y),0,N)},K=function(Ct){return u.constrain(Math.round(g.c2p(S[Ct])-_),0,J)});var ae,ie,he,se,de,ce=K(0),ve=[ce,ce],Ee=Q?0:1,Le=Z?0:1,Te=0,xe=0,fe=0,ge=0;if(q){var ke,Me=0;try{ke=new Uint8Array(N*J*4)}catch{ke=new Array(N*J*4)}if(q==="best"){var Se,De,Be,We=P||C,Qe=z||S,Oe=new Array(We.length),Ue=new Array(Qe.length),Xe=new Array(N),Ye=P?a:o,$e=z?a:o;for(E=0;E<We.length;E++)Oe[E]=Math.round(d.c2p(We[E])-y);for(E=0;E<Qe.length;E++)Ue[E]=Math.round(g.c2p(Qe[E])-_);for(E=0;E<N;E++)Xe[E]=Ye(E,Oe);for(ie=0;ie<J;ie++)for(De=w[(Se=$e(ie,Ue)).bin0],Be=w[Se.bin1],E=0;E<N;E++,Me+=4)n(ke,Me,de=Ge(De,Be,Xe[E],Se))}else for(ie=0;ie<W;ie++)for(se=w[ie],ve=K(ie),E=0;E<N;E++)de=je(se[E],1),n(ke,Me=4*(ve*N+$(E)),de);var it=re.createImageData(N,J);try{it.data.set(ke)}catch{var ot=it.data,Et=ot.length;for(ie=0;ie<Et;ie++)ot[ie]=ke[ie]}re.putImageData(it,0,0)}else{var mt=L.xgap,tt=L.ygap,Ke=Math.floor(mt/2),Mt=Math.floor(tt/2);for(ie=0;ie<W;ie++)if(se=w[ie],ve.reverse(),ve[Le]=K(ie+1),ve[0]!==ve[1]&&ve[0]!==void 0&&ve[1]!==void 0)for(ae=[he=$(0),he],E=0;E<X;E++)ae.reverse(),ae[Ee]=$(E+1),ae[0]!==ae[1]&&ae[0]!==void 0&&ae[1]!==void 0&&(de=je(se[E],(ae[1]-ae[0])*(ve[1]-ve[0])),re.fillStyle="rgba("+de.join(",")+")",re.fillRect(ae[0]+Ke,ve[0]+Mt,ae[1]-ae[0]-mt,ve[1]-ve[0]-tt))}xe=Math.round(xe/Te),fe=Math.round(fe/Te),ge=Math.round(ge/Te);var Jt=h("rgb("+xe+","+fe+","+ge+")");s._hmpixcount=(s._hmpixcount||0)+Te,s._hmlumcount=(s._hmlumcount||0)+Te*Jt.getLuminance();var $t=A.selectAll("image").data(m);$t.enter().append("svg:image").attr({xmlns:l.svg,preserveAspectRatio:"none"}),$t.attr({height:J,width:N,x:y,y:_,"xlink:href":G.toDataURL("image/png")})}function je(Ct,Ie){if(Ct!==void 0){var be=ne(Ct);return be[0]=Math.round(be[0]),be[1]=Math.round(be[1]),be[2]=Math.round(be[2]),Te+=Ie,xe+=be[0]*Ie,fe+=be[1]*Ie,ge+=be[2]*Ie,be}return[0,0,0,0]}function Ge(Ct,Ie,be,Ae){var Pe=Ct[be.bin0];if(Pe===void 0)return je(void 0,1);var ze,qe=Ct[be.bin1],ht=Ie[be.bin0],at=Ie[be.bin1],nt=qe-Pe||0,xt=ht-Pe||0;return ze=qe===void 0?at===void 0?0:ht===void 0?2*(at-Pe):2*(2*at-ht-Pe)/3:at===void 0?ht===void 0?0:2*(2*Pe-qe-ht)/3:ht===void 0?2*(2*at-qe-Pe)/3:at+Pe-qe-ht,je(Pe+be.frac*nt+Ae.frac*(xt+be.frac*ze))}})}},{"../../components/colorscale":678,"../../constants/xmlns_namespaces":780,"../../lib":803,"../../registry":931,"@plotly/d3":58,tinycolor2:598}],1097:[function(i,B,V){var t=i("@plotly/d3");B.exports=function(h){t.select(h).selectAll(".hm image").style("opacity",function(p){return p.trace.opacity})}},{"@plotly/d3":58}],1098:[function(i,B,V){B.exports=function(t,h,p){p("zsmooth")===!1&&(p("xgap"),p("ygap")),p("zhoverformat")}},{}],1099:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("../../registry");function u(e,l){var o=l(e);return(o?l(e+"type","array"):"scaled")==="scaled"&&(l(e+"0"),l("d"+e)),o}B.exports=function(e,l,o,a,n,s){var r,c,f=o("z");if(n=n||"x",s=s||"y",f===void 0||!f.length)return 0;if(h.isArray1D(e.z)){r=o(n),c=o(s);var d=h.minRowLength(r),g=h.minRowLength(c);if(d===0||g===0)return 0;l._length=Math.min(d,g,f.length)}else{if(r=u(n,o),c=u(s,o),!function(m){for(var y,v=!0,T=!1,_=!1,k=0;k<m.length;k++){if(y=m[k],!h.isArrayOrTypedArray(y)){v=!1;break}y.length>0&&(T=!0);for(var E=0;E<y.length;E++)if(t(y[E])){_=!0;break}}return v&&T&&_}(f))return 0;o("transpose"),l._length=null}return e.type==="heatmapgl"||p.getComponentMethod("calendars","handleTraceDefaults")(e,l,[n,s],a),!0}},{"../../lib":803,"../../registry":931,"fast-isnumeric":249}],1100:[function(i,B,V){for(var t=i("../heatmap/attributes"),h=i("../../components/colorscale/attributes"),p=i("../../lib/extend").extendFlat,u=i("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],l={},o=0;o<e.length;o++){var a=e[o];l[a]=t[a]}l.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},p(l,h("",{cLetter:"z",autoColorDflt:!1})),B.exports=u(l,"calc","nested")},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plot_api/edit_types":836,"../heatmap/attributes":1085}],1101:[function(i,B,V){var t=i("gl-heatmap2d"),h=i("../../plots/cartesian/axes"),p=i("../../lib/str2rgbarray");function u(l,o){this.scene=l,this.uid=o,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=t(l.glplot,this.options),this.heatmap._trace=this}var e=u.prototype;e.handlePick=function(l){var o=this.options,a=o.shape,n=l.pointId,s=n%a[0],r=Math.floor(n/a[0]),c=n;return{trace:this,dataCoord:l.dataCoord,traceCoord:[o.x[s],o.y[r],o.z[c]],textLabel:this.textLabels[n],name:this.name,pointIndex:[r,s],hoverinfo:this.hoverinfo}},e.update=function(l,o){var a=o[0];this.index=l.index,this.name=l.name,this.hoverinfo=l.hoverinfo;var n=a.z;this.options.z=[].concat.apply([],n);var s=n[0].length,r=n.length;this.options.shape=[s,r],this.options.x=a.x,this.options.y=a.y,this.options.zsmooth=l.zsmooth;var c=function(y){for(var v=y.colorscale,T=y.zmin,_=y.zmax,k=v.length,E=new Array(k),A=new Array(4*k),b=0;b<k;b++){var L=v[b],w=p(L[1]);E[b]=T+L[0]*(_-T);for(var C=0;C<4;C++)A[4*b+C]=w[C]}return{colorLevels:E,colorValues:A}}(l);this.options.colorLevels=c.colorLevels,this.options.colorValues=c.colorValues,this.textLabels=[].concat.apply([],l.text),this.heatmap.update(this.options);var f,d,g=this.scene.xaxis,m=this.scene.yaxis;l.zsmooth===!1&&(f={ppad:a.x[1]-a.x[0]},d={ppad:a.y[1]-a.y[0]}),l._extremes[g._id]=h.findExtremes(g,a.x,f),l._extremes[m._id]=h.findExtremes(m,a.y,d)},e.dispose=function(){this.heatmap.dispose()},B.exports=function(l,o,a){var n=new u(l,o.uid);return n.update(o,a),n}},{"../../lib/str2rgbarray":828,"../../plots/cartesian/axes":854,"gl-heatmap2d":278}],1102:[function(i,B,V){var t=i("../../lib"),h=i("../heatmap/xyz_defaults"),p=i("../../components/colorscale/defaults"),u=i("./attributes");B.exports=function(e,l,o,a){function n(s,r){return t.coerce(e,l,u,s,r)}h(e,l,n,a)?(n("text"),n("zsmooth"),p(e,l,a,n,{prefix:"",cLetter:"z"})):l.visible=!1}},{"../../components/colorscale/defaults":676,"../../lib":803,"../heatmap/xyz_defaults":1099,"./attributes":1100}],1103:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../heatmap/colorbar"),calc:i("../heatmap/calc"),plot:i("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:i("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":894,"../heatmap/calc":1086,"../heatmap/colorbar":1088,"./attributes":1100,"./convert":1101,"./defaults":1102}],1104:[function(i,B,V){var t=i("../bar/attributes"),h=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=i("../../plots/template_attributes").hovertemplateAttrs,u=i("./bin_attributes"),e=i("./constants"),l=i("../../lib/extend").extendFlat;B.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:h("x"),yhoverformat:h("y"),text:l({},t.text,{}),hovertext:l({},t.hovertext,{}),orientation:t.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:u("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:u("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:p({},{keys:e.eventDataKeys}),marker:t.marker,offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:t.selected,unselected:t.unselected,_deprecated:{bardir:t._deprecated.bardir}}},{"../../lib/extend":793,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../bar/attributes":941,"./bin_attributes":1106,"./constants":1110}],1105:[function(i,B,V){B.exports=function(t,h){for(var p=t.length,u=0,e=0;e<p;e++)h[e]?(t[e]/=h[e],u+=t[e]):t[e]=null;return u}},{}],1106:[function(i,B,V){B.exports=function(t,h){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],1107:[function(i,B,V){var t=i("fast-isnumeric");B.exports={count:function(h,p,u){return u[h]++,1},sum:function(h,p,u,e){var l=e[p];return t(l)?(l=Number(l),u[h]+=l,l):0},avg:function(h,p,u,e,l){var o=e[p];return t(o)&&(o=Number(o),u[h]+=o,l[h]++),0},min:function(h,p,u,e){var l=e[p];if(t(l)){if(l=Number(l),!t(u[h]))return u[h]=l,l;if(u[h]>l){var o=l-u[h];return u[h]=l,o}}return 0},max:function(h,p,u,e){var l=e[p];if(t(l)){if(l=Number(l),!t(u[h]))return u[h]=l,l;if(u[h]<l){var o=l-u[h];return u[h]=l,o}}return 0}}},{"fast-isnumeric":249}],1108:[function(i,B,V){var t=i("../../constants/numerical"),h=t.ONEAVGYEAR,p=t.ONEAVGMONTH,u=t.ONEDAY,e=t.ONEHOUR,l=t.ONEMIN,o=t.ONESEC,a=i("../../plots/cartesian/axes").tickIncrement;function n(f,d,g,m){if(f*d<=0)return 1/0;for(var y=Math.abs(d-f),v=g.type==="date",T=s(y,v),_=0;_<10;_++){var k=s(80*T,v);if(T===k||!r(k,f,d,v,g,m))break;T=k}return T}function s(f,d){return d&&f>o?f>u?f>1.1*h?h:f>1.1*p?p:u:f>e?e:f>l?l:o:Math.pow(10,Math.floor(Math.log(f)/Math.LN10))}function r(f,d,g,m,y,v){if(m&&f>u){var T=c(d,y,v),_=c(g,y,v),k=f===h?0:1;return T[k]!==_[k]}return Math.floor(g/f)-Math.floor(d/f)>.1}function c(f,d,g){var m=d.c2d(f,h,g).split("-");return m[0]===""&&(m.unshift(),m[0]="-"+m[0]),m}B.exports=function(f,d,g,m,y){var v,T,_=-1.1*d,k=-.1*d,E=f-k,A=g[0],b=g[1],L=Math.min(n(A+k,A+E,m,y),n(b+k,b+E,m,y)),w=Math.min(n(A+_,A+k,m,y),n(b+_,b+k,m,y));if(L>w&&w<Math.abs(b-A)/4e3?(v=L,T=!1):(v=Math.min(L,w),T=!0),m.type==="date"&&v>u){var C=v===h?1:6,S=v===h?"M12":"M1";return function(P,z){var F=m.c2d(P,h,y),q=F.indexOf("-",C);q>0&&(F=F.substr(0,q));var W=m.d2c(F,0,y);if(W<P){var X=a(W,S,!1,y);(W+X)/2<P+f&&(W=X)}return z&&T?a(W,S,!0,y):W}}return function(P,z){var F=v*Math.round(P/v);return F+v/10<P&&F+.9*v<P+f&&(F+=v),z&&T&&(F-=v),F}}},{"../../constants/numerical":779,"../../plots/cartesian/axes":854}],1109:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("../../registry"),u=i("../../plots/cartesian/axes"),e=i("../bar/arrays_to_calcdata"),l=i("./bin_functions"),o=i("./norm_functions"),a=i("./average"),n=i("./bin_label_vals");function s(r,c,f,d,g){var m,y,v,T,_,k,E,A=d+"bins",b=r._fullLayout,L=c["_"+d+"bingroup"],w=b._histogramBinOpts[L],C=b.barmode==="overlay",S=function(ce){return f.r2c(ce,0,T)},P=function(ce){return f.c2r(ce,0,T)},z=f.type==="date"?function(ce){return ce||ce===0?h.cleanDate(ce,null,T):null}:function(ce){return t(ce)?Number(ce):null};function F(ce,ve,Ee){ve[ce+"Found"]?(ve[ce]=z(ve[ce]),ve[ce]===null&&(ve[ce]=Ee[ce])):(k[ce]=ve[ce]=Ee[ce],h.nestedProperty(y[0],A+"."+ce).set(Ee[ce]))}if(c["_"+d+"autoBinFinished"])delete c["_"+d+"autoBinFinished"];else{y=w.traces;var q=[],W=!0,X=!1,Q=!1;for(m=0;m<y.length;m++)if((v=y[m]).visible){var Z=w.dirs[m];_=v["_"+Z+"pos0"]=f.makeCalcdata(v,Z),q=h.concat(q,_),delete v["_"+d+"autoBinFinished"],c.visible===!0&&(W?W=!1:(delete v._autoBin,v["_"+d+"autoBinFinished"]=1),p.traceIs(v,"2dMap")&&(X=!0),v.type==="histogram2dcontour"&&(Q=!0))}T=y[0][d+"calendar"];var Y=u.autoBin(q,f,w.nbins,X,T,w.sizeFound&&w.size),N=y[0]._autoBin={};if(k=N[w.dirs[0]]={},Q&&(w.size||(Y.start=P(u.tickIncrement(S(Y.start),Y.size,!0,T))),w.end===void 0&&(Y.end=P(u.tickIncrement(S(Y.end),Y.size,!1,T)))),C&&!p.traceIs(c,"2dMap")&&Y._dataSpan===0&&f.type!=="category"&&f.type!=="multicategory"){if(g)return[Y,_,!0];Y=function(ce,ve,Ee,Le,Te){var xe,fe,ge,ke=ce._fullLayout,Me=function(ot,Et){for(var mt=Et.xaxis,tt=Et.yaxis,Ke=Et.orientation,Mt=[],Jt=ot._fullData,$t=0;$t<Jt.length;$t++){var je=Jt[$t];je.type==="histogram"&&je.visible===!0&&je.orientation===Ke&&je.xaxis===mt&&je.yaxis===tt&&Mt.push(je)}return Mt}(ce,ve),Se=!1,De=1/0,Be=[ve];for(xe=0;xe<Me.length;xe++)if((fe=Me[xe])===ve)Se=!0;else if(Se){var We=s(ce,fe,Ee,Le,!0),Qe=We[0],Oe=We[2];fe["_"+Le+"autoBinFinished"]=1,fe["_"+Le+"pos0"]=We[1],Oe?Be.push(fe):De=Math.min(De,Qe.size)}else ge=ke._histogramBinOpts[fe["_"+Le+"bingroup"]],De=Math.min(De,ge.size||fe[Te].size);var Ue=new Array(Be.length);for(xe=0;xe<Be.length;xe++)for(var Xe=Be[xe]["_"+Le+"pos0"],Ye=0;Ye<Xe.length;Ye++)if(Xe[Ye]!==void 0){Ue[xe]=Xe[Ye];break}for(isFinite(De)||(De=h.distinctVals(Ue).minDiff),xe=0;xe<Be.length;xe++){var $e=(fe=Be[xe])[Le+"calendar"],it={start:Ee.c2r(Ue[xe]-De/2,0,$e),end:Ee.c2r(Ue[xe]+De/2,0,$e),size:De};fe._input[Te]=fe[Te]=it,(ge=ke._histogramBinOpts[fe["_"+Le+"bingroup"]])&&h.extendFlat(ge,it)}return ve[Te]}(r,c,f,d,A)}(E=v.cumulative||{}).enabled&&E.currentbin!=="include"&&(E.direction==="decreasing"?Y.start=P(u.tickIncrement(S(Y.start),Y.size,!0,T)):Y.end=P(u.tickIncrement(S(Y.end),Y.size,!1,T))),w.size=Y.size,w.sizeFound||(k.size=Y.size,h.nestedProperty(y[0],A+".size").set(Y.size)),F("start",w,Y),F("end",w,Y)}_=c["_"+d+"pos0"],delete c["_"+d+"pos0"];var J=c._input[A]||{},D=h.extendFlat({},w),U=w.start,G=f.r2l(J.start),$=G!==void 0;if((w.startFound||$)&&G!==f.r2l(U)){var K=$?G:h.aggNums(Math.min,null,_),re={type:f.type==="category"||f.type==="multicategory"?"linear":f.type,r2l:f.r2l,dtick:w.size,tick0:U,calendar:T,range:[K,u.tickIncrement(K,w.size,!1,T)].map(f.l2r)},ne=u.tickFirst(re);ne>f.r2l(K)&&(ne=u.tickIncrement(ne,w.size,!0,T)),D.start=f.l2r(ne),$||h.nestedProperty(c,A+".start").set(D.start)}var ae=w.end,ie=f.r2l(J.end),he=ie!==void 0;if((w.endFound||he)&&ie!==f.r2l(ae)){var se=he?ie:h.aggNums(Math.max,null,_);D.end=f.l2r(se),he||h.nestedProperty(c,A+".start").set(D.end)}var de="autobin"+d;return c._input[de]===!1&&(c._input[A]=h.extendFlat({},c[A]||{}),delete c._input[de],delete c[de]),[D,_]}B.exports={calc:function(r,c){var f,d,g,m,y=[],v=[],T=u.getFromId(r,c.orientation==="h"?c.yaxis:c.xaxis),_=c.orientation==="h"?"y":"x",k={x:"y",y:"x"}[_],E=c[_+"calendar"],A=c.cumulative,b=s(r,c,T,_),L=b[0],w=b[1],C=typeof L.size=="string",S=[],P=C?S:L,z=[],F=[],q=[],W=0,X=c.histnorm,Q=c.histfunc,Z=X.indexOf("density")!==-1;A.enabled&&Z&&(X=X.replace(/ ?density$/,""),Z=!1);var Y,N=Q==="max"||Q==="min"?null:0,J=l.count,D=o[X],U=!1,G=function(xe){return T.r2c(xe,0,E)};for(h.isArrayOrTypedArray(c[k])&&Q!=="count"&&(Y=c[k],U=Q==="avg",J=l[Q]),f=G(L.start),g=G(L.end)+(f-u.tickIncrement(f,L.size,!1,E))/1e6;f<g&&y.length<1e6&&(d=u.tickIncrement(f,L.size,!1,E),y.push((f+d)/2),v.push(N),q.push([]),S.push(f),Z&&z.push(1/(d-f)),U&&F.push(0),!(d<=f));)f=d;S.push(f),C||T.type!=="date"||(P={start:G(P.start),end:G(P.end),size:P.size}),r._fullLayout._roundFnOpts||(r._fullLayout._roundFnOpts={});var $=c["_"+_+"bingroup"],K={leftGap:1/0,rightGap:1/0};$&&(r._fullLayout._roundFnOpts[$]||(r._fullLayout._roundFnOpts[$]=K),K=r._fullLayout._roundFnOpts[$]);var re,ne=v.length,ae=!0,ie=K.leftGap,he=K.rightGap,se={};for(f=0;f<w.length;f++){var de=w[f];(m=h.findBin(de,P))>=0&&m<ne&&(W+=J(m,f,v,Y,F),ae&&q[m].length&&de!==w[q[m][0]]&&(ae=!1),q[m].push(f),se[f]=m,ie=Math.min(ie,de-S[m]),he=Math.min(he,S[m+1]-de))}K.leftGap=ie,K.rightGap=he,ae||(re=function(xe,fe){return function(){var ge=r._fullLayout._roundFnOpts[$];return n(ge.leftGap,ge.rightGap,S,T,E)(xe,fe)}}),U&&(W=a(v,F)),D&&D(v,W,z),A.enabled&&function(xe,fe,ge){var ke,Me,Se;function De(We){Se=xe[We],xe[We]/=2}function Be(We){Me=xe[We],xe[We]=Se+Me/2,Se+=Me}if(ge==="half")if(fe==="increasing")for(De(0),ke=1;ke<xe.length;ke++)Be(ke);else for(De(xe.length-1),ke=xe.length-2;ke>=0;ke--)Be(ke);else if(fe==="increasing"){for(ke=1;ke<xe.length;ke++)xe[ke]+=xe[ke-1];ge==="exclude"&&(xe.unshift(0),xe.pop())}else{for(ke=xe.length-2;ke>=0;ke--)xe[ke]+=xe[ke+1];ge==="exclude"&&(xe.push(0),xe.shift())}}(v,A.direction,A.currentbin);var ce=Math.min(y.length,v.length),ve=[],Ee=0,Le=ce-1;for(f=0;f<ce;f++)if(v[f]){Ee=f;break}for(f=ce-1;f>=Ee;f--)if(v[f]){Le=f;break}for(f=Ee;f<=Le;f++)if(t(y[f])&&t(v[f])){var Te={p:y[f],s:v[f],b:0};A.enabled||(Te.pts=q[f],ae?Te.ph0=Te.ph1=q[f].length?w[q[f][0]]:y[f]:(c._computePh=!0,Te.ph0=re(S[f]),Te.ph1=re(S[f+1],!0))),ve.push(Te)}return ve.length===1&&(ve[0].width1=u.tickIncrement(ve[0].p,L.size,!1,E)-ve[0].p),e(ve,c),h.isArrayOrTypedArray(c.selectedpoints)&&h.tagSelected(ve,c,se),ve},calcAllAutoBins:s}},{"../../lib":803,"../../plots/cartesian/axes":854,"../../registry":931,"../bar/arrays_to_calcdata":940,"./average":1105,"./bin_functions":1107,"./bin_label_vals":1108,"./norm_functions":1116,"fast-isnumeric":249}],1110:[function(i,B,V){B.exports={eventDataKeys:["binNumber"]}},{}],1111:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axis_ids"),p=i("../../registry").traceIs,u=i("../bar/defaults").handleGroupingDefaults,e=t.nestedProperty,l=i("../../plots/cartesian/constraints").getAxisGroup,o=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],a=["x","y"];B.exports=function(n,s){var r,c,f,d,g,m,y,v=s._histogramBinOpts={},T=[],_={},k=[];function E(Y,N){return t.coerce(r._input,r,r._module.attributes,Y,N)}function A(Y){return Y.orientation==="v"?"x":"y"}function b(Y,N,J){var D=Y.uid+"__"+J;N||(N=D);var U=function(re,ne){return h.getFromTrace({_fullLayout:s},re,ne).type}(Y,J),G=Y[J+"calendar"]||"",$=v[N],K=!0;$&&(U===$.axType&&G===$.calendar?(K=!1,$.traces.push(Y),$.dirs.push(J)):(N=D,U!==$.axType&&t.warn(["Attempted to group the bins of trace",Y.index,"set on a","type:"+U,"axis","with bins on","type:"+$.axType,"axis."].join(" ")),G!==$.calendar&&t.warn(["Attempted to group the bins of trace",Y.index,"set with a",G,"calendar","with bins",$.calendar?"on a "+$.calendar+" calendar":"w/o a set calendar"].join(" ")))),K&&(v[N]={traces:[Y],dirs:[J],axType:U,calendar:Y[J+"calendar"]||""}),Y["_"+J+"bingroup"]=N}for(g=0;g<n.length;g++)r=n[g],p(r,"histogram")&&(T.push(r),delete r._xautoBinFinished,delete r._yautoBinFinished,p(r,"2dMap")||u(r._input,r,s,E));var L=s._alignmentOpts||{};for(g=0;g<T.length;g++){if(r=T[g],f="",!p(r,"2dMap")){if(d=A(r),s.barmode==="group"&&r.alignmentgroup){var w=r[d+"axis"],C=l(s,w)+r.orientation;(L[C]||{})[r.alignmentgroup]&&(f=C)}f||s.barmode==="overlay"||(f=l(s,r.xaxis)+l(s,r.yaxis)+A(r))}f?(_[f]||(_[f]=[]),_[f].push(r)):k.push(r)}for(f in _)if((c=_[f]).length!==1){var S=!1;for(c.length&&(r=c[0],S=E("bingroup")),f=S||f,g=0;g<c.length;g++){var P=(r=c[g])._input.bingroup;P&&P!==f&&t.warn(["Trace",r.index,"must match","within bingroup",f+".","Ignoring its bingroup:",P,"setting."].join(" ")),r.bingroup=f,b(r,f,A(r))}}else k.push(c[0]);for(g=0;g<k.length;g++){r=k[g];var z=E("bingroup");if(p(r,"2dMap"))for(y=0;y<2;y++){var F=E((d=a[y])+"bingroup",z?z+"__"+d:null);b(r,F,d)}else b(r,z,A(r))}for(f in v){var q=v[f];for(c=q.traces,m=0;m<o.length;m++){var W,X,Q=o[m],Z=Q.name;if(Z!=="nbins"||!q.sizeFound){for(g=0;g<c.length;g++){if(r=c[g],d=q.dirs[g],W=Q.aStr[d],e(r._input,W).get()!==void 0){q[Z]=E(W),q[Z+"Found"]=!0;break}(X=(r._autoBin||{})[d]||{})[Z]&&e(r,W).set(X[Z])}if(Z==="start"||Z==="end")for(;g<c.length;g++)(r=c[g])["_"+d+"bingroup"]&&E(W,(X=(r._autoBin||{})[d]||{})[Z]);Z!=="nbins"||q.sizeFound||q.nbinsFound||(r=c[0],q[Z]=E(W))}}}}},{"../../lib":803,"../../plots/cartesian/axis_ids":858,"../../plots/cartesian/constraints":862,"../../registry":931,"../bar/defaults":945}],1112:[function(i,B,V){var t=i("../../registry"),h=i("../../lib"),p=i("../../components/color"),u=i("../bar/style_defaults"),e=i("./attributes");B.exports=function(l,o,a,n){function s(T,_){return h.coerce(l,o,e,T,_)}var r=s("x"),c=s("y");s("cumulative.enabled")&&(s("cumulative.direction"),s("cumulative.currentbin")),s("text"),s("hovertext"),s("hovertemplate"),s("xhoverformat"),s("yhoverformat");var f=s("orientation",c&&!r?"h":"v"),d=f==="v"?"x":"y",g=f==="v"?"y":"x",m=r&&c?Math.min(h.minRowLength(r)&&h.minRowLength(c)):h.minRowLength(o[d]||[]);if(m){o._length=m,t.getComponentMethod("calendars","handleTraceDefaults")(l,o,["x","y"],n),o[g]&&s("histfunc"),s("histnorm"),s("autobin"+d),u(l,o,s,a,n),h.coerceSelectionMarkerOpacity(o,s);var y=(o.marker.line||{}).color,v=t.getComponentMethod("errorbars","supplyDefaults");v(l,o,y||p.defaultLine,{axis:"y"}),v(l,o,y||p.defaultLine,{axis:"x",inherit:"y"})}else o.visible=!1}},{"../../components/color":666,"../../lib":803,"../../registry":931,"../bar/style_defaults":956,"./attributes":1104}],1113:[function(i,B,V){B.exports=function(t,h,p,u,e){if(t.x="xVal"in h?h.xVal:h.x,t.y="yVal"in h?h.yVal:h.y,"zLabelVal"in h&&(t.z=h.zLabelVal),h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),!(p.cumulative||{}).enabled){var l,o=Array.isArray(e)?u[0].pts[e[0]][e[1]]:u[e].pts;if(t.pointNumbers=o,t.binNumber=t.pointNumber,delete t.pointNumber,delete t.pointIndex,p._indexToPoints){l=[];for(var a=0;a<o.length;a++)l=l.concat(p._indexToPoints[o[a]])}else l=o;t.pointIndices=l}return t}},{}],1114:[function(i,B,V){var t=i("../bar/hover").hoverPoints,h=i("../../plots/cartesian/axes").hoverLabelText;B.exports=function(p,u,e,l,o){var a=t(p,u,e,l,o);if(a){var n=(p=a[0]).cd[p.index],s=p.cd[0].trace;if(!s.cumulative.enabled){var r=s.orientation==="h"?"y":"x";p[r+"Label"]=h(p[r+"a"],[n.ph0,n.ph1],s[r+"hoverformat"])}return a}}},{"../../plots/cartesian/axes":854,"../bar/hover":948}],1115:[function(i,B,V){B.exports={attributes:i("./attributes"),layoutAttributes:i("../bar/layout_attributes"),supplyDefaults:i("./defaults"),crossTraceDefaults:i("./cross_trace_defaults"),supplyLayoutDefaults:i("../bar/layout_defaults"),calc:i("./calc").calc,crossTraceCalc:i("../bar/cross_trace_calc").crossTraceCalc,plot:i("../bar/plot").plot,layerName:"barlayer",style:i("../bar/style").style,styleOnSelect:i("../bar/style").styleOnSelect,colorbar:i("../scatter/marker_colorbar"),hoverPoints:i("./hover"),selectPoints:i("../bar/select"),eventData:i("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:i("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":868,"../bar/cross_trace_calc":944,"../bar/layout_attributes":950,"../bar/layout_defaults":951,"../bar/plot":952,"../bar/select":953,"../bar/style":955,"../scatter/marker_colorbar":1236,"./attributes":1104,"./calc":1109,"./cross_trace_defaults":1111,"./defaults":1112,"./event_data":1113,"./hover":1114}],1116:[function(i,B,V){B.exports={percent:function(t,h){for(var p=t.length,u=100/h,e=0;e<p;e++)t[e]*=u},probability:function(t,h){for(var p=t.length,u=0;u<p;u++)t[u]/=h},density:function(t,h,p,u){var e=t.length;u=u||1;for(var l=0;l<e;l++)t[l]*=p[l]*u},"probability density":function(t,h,p,u){var e=t.length;u&&(h/=u);for(var l=0;l<e;l++)t[l]*=p[l]/h}}},{}],1117:[function(i,B,V){var t=i("../histogram/attributes"),h=i("../histogram/bin_attributes"),p=i("../heatmap/attributes"),u=i("../../plots/attributes"),e=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,l=i("../../plots/template_attributes").hovertemplateAttrs,o=i("../../components/colorscale/attributes"),a=i("../../lib/extend").extendFlat;B.exports=a({x:t.x,y:t.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:t.histnorm,histfunc:t.histfunc,nbinsx:t.nbinsx,xbins:h("x"),nbinsy:t.nbinsy,ybins:h("y"),autobinx:t.autobinx,autobiny:t.autobiny,bingroup:a({},t.bingroup,{}),xbingroup:a({},t.bingroup,{}),ybingroup:a({},t.bingroup,{}),xgap:p.xgap,ygap:p.ygap,zsmooth:p.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:l({},{keys:"z"}),showlegend:a({},u.showlegend,{dflt:!1})},o("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../heatmap/attributes":1085,"../histogram/attributes":1104,"../histogram/bin_attributes":1106}],1118:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes"),p=i("../histogram/bin_functions"),u=i("../histogram/norm_functions"),e=i("../histogram/average"),l=i("../histogram/bin_label_vals"),o=i("../histogram/calc").calcAllAutoBins;function a(r,c,f,d){var g,m=new Array(r);if(d)for(g=0;g<r;g++)m[g]=1/(c[g+1]-c[g]);else{var y=1/f;for(g=0;g<r;g++)m[g]=y}return m}function n(r,c){return{start:r(c.start),end:r(c.end),size:c.size}}function s(r,c,f,d,g,m){var y,v=r.length-1,T=new Array(v),_=l(f,d,r,g,m);for(y=0;y<v;y++){var k=(c||[])[y];T[y]=k===void 0?[_(r[y]),_(r[y+1],!0)]:[k,k]}return T}B.exports=function(r,c){var f,d,g,m,y=h.getFromId(r,c.xaxis),v=h.getFromId(r,c.yaxis),T=c.xcalendar,_=c.ycalendar,k=function(tt){return y.r2c(tt,0,T)},E=function(tt){return v.r2c(tt,0,_)},A=o(r,c,y,"x"),b=A[0],L=A[1],w=o(r,c,v,"y"),C=w[0],S=w[1],P=c._length;L.length>P&&L.splice(P,L.length-P),S.length>P&&S.splice(P,S.length-P);var z=[],F=[],q=[],W=typeof b.size=="string",X=typeof C.size=="string",Q=[],Z=[],Y=W?Q:b,N=X?Z:C,J=0,D=[],U=[],G=c.histnorm,$=c.histfunc,K=G.indexOf("density")!==-1,re=$==="max"||$==="min"?null:0,ne=p.count,ae=u[G],ie=!1,he=[],se=[],de="z"in c?c.z:"marker"in c&&Array.isArray(c.marker.color)?c.marker.color:"";de&&$!=="count"&&(ie=$==="avg",ne=p[$]);var ce=b.size,ve=k(b.start),Ee=k(b.end)+(ve-h.tickIncrement(ve,ce,!1,T))/1e6;for(f=ve;f<Ee;f=h.tickIncrement(f,ce,!1,T))F.push(re),Q.push(f),ie&&q.push(0);Q.push(f);var Le,Te=F.length,xe=(f-ve)/Te,fe=(Le=ve+xe/2,y.c2r(Le,0,T)),ge=C.size,ke=E(C.start),Me=E(C.end)+(ke-h.tickIncrement(ke,ge,!1,_))/1e6;for(f=ke;f<Me;f=h.tickIncrement(f,ge,!1,_)){z.push(F.slice()),Z.push(f);var Se=new Array(Te);for(d=0;d<Te;d++)Se[d]=[];U.push(Se),ie&&D.push(q.slice())}Z.push(f);var De=z.length,Be=(f-ke)/De,We=function(tt){return v.c2r(tt,0,_)}(ke+Be/2);K&&(he=a(F.length,Y,xe,W),se=a(z.length,N,Be,X)),W||y.type!=="date"||(Y=n(k,Y)),X||v.type!=="date"||(N=n(E,N));var Qe=!0,Oe=!0,Ue=new Array(Te),Xe=new Array(De),Ye=1/0,$e=1/0,it=1/0,ot=1/0;for(f=0;f<P;f++){var Et=L[f],mt=S[f];g=t.findBin(Et,Y),m=t.findBin(mt,N),g>=0&&g<Te&&m>=0&&m<De&&(J+=ne(g,f,z[m],de,D[m]),U[m][g].push(f),Qe&&(Ue[g]===void 0?Ue[g]=Et:Ue[g]!==Et&&(Qe=!1)),Oe&&(Xe[m]===void 0?Xe[m]=mt:Xe[m]!==mt&&(Oe=!1)),Ye=Math.min(Ye,Et-Q[g]),$e=Math.min($e,Q[g+1]-Et),it=Math.min(it,mt-Z[m]),ot=Math.min(ot,Z[m+1]-mt))}if(ie)for(m=0;m<De;m++)J+=e(z[m],D[m]);if(ae)for(m=0;m<De;m++)ae(z[m],J,he,se[m]);return{x:L,xRanges:s(Q,Qe&&Ue,Ye,$e,y,T),x0:fe,dx:xe,y:S,yRanges:s(Z,Oe&&Xe,it,ot,v,_),y0:We,dy:Be,z,pts:U}}},{"../../lib":803,"../../plots/cartesian/axes":854,"../histogram/average":1105,"../histogram/bin_functions":1107,"../histogram/bin_label_vals":1108,"../histogram/calc":1109,"../histogram/norm_functions":1116}],1119:[function(i,B,V){var t=i("../../lib"),h=i("./sample_defaults"),p=i("../heatmap/style_defaults"),u=i("../../components/colorscale/defaults"),e=i("./attributes");B.exports=function(l,o,a,n){function s(r,c){return t.coerce(l,o,e,r,c)}h(l,o,s,n),o.visible!==!1&&(p(l,o,s,n),u(l,o,n,s,{prefix:"",cLetter:"z"}),s("hovertemplate"),s("xhoverformat"),s("yhoverformat"))}},{"../../components/colorscale/defaults":676,"../../lib":803,"../heatmap/style_defaults":1098,"./attributes":1117,"./sample_defaults":1122}],1120:[function(i,B,V){var t=i("../heatmap/hover"),h=i("../../plots/cartesian/axes").hoverLabelText;B.exports=function(p,u,e,l,o){var a=t(p,u,e,l,o);if(a){var n=(p=a[0]).index,s=n[0],r=n[1],c=p.cd[0],f=c.trace,d=c.xRanges[r],g=c.yRanges[s];return p.xLabel=h(p.xa,[d[0],d[1]],f.xhoverformat),p.yLabel=h(p.ya,[g[0],g[1]],f.yhoverformat),a}}},{"../../plots/cartesian/axes":854,"../heatmap/hover":1092}],1121:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),crossTraceDefaults:i("../histogram/cross_trace_defaults"),calc:i("../heatmap/calc"),plot:i("../heatmap/plot"),layerName:"heatmaplayer",colorbar:i("../heatmap/colorbar"),style:i("../heatmap/style"),hoverPoints:i("./hover"),eventData:i("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":868,"../heatmap/calc":1086,"../heatmap/colorbar":1088,"../heatmap/plot":1096,"../heatmap/style":1097,"../histogram/cross_trace_defaults":1111,"../histogram/event_data":1113,"./attributes":1117,"./defaults":1119,"./hover":1120}],1122:[function(i,B,V){var t=i("../../registry"),h=i("../../lib");B.exports=function(p,u,e,l){var o=e("x"),a=e("y"),n=h.minRowLength(o),s=h.minRowLength(a);n&&s?(u._length=Math.min(n,s),t.getComponentMethod("calendars","handleTraceDefaults")(p,u,["x","y"],l),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):u.visible=!1}},{"../../lib":803,"../../registry":931}],1123:[function(i,B,V){var t=i("../histogram2d/attributes"),h=i("../contour/attributes"),p=i("../../components/colorscale/attributes"),u=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=i("../../lib/extend").extendFlat;B.exports=e({x:t.x,y:t.y,z:t.z,marker:t.marker,histnorm:t.histnorm,histfunc:t.histfunc,nbinsx:t.nbinsx,xbins:t.xbins,nbinsy:t.nbinsy,ybins:t.ybins,autobinx:t.autobinx,autobiny:t.autobiny,bingroup:t.bingroup,xbingroup:t.xbingroup,ybingroup:t.ybingroup,autocontour:h.autocontour,ncontours:h.ncontours,contours:h.contours,line:{color:h.line.color,width:e({},h.line.width,{dflt:.5}),dash:h.line.dash,smoothing:h.line.smoothing,editType:"plot"},xhoverformat:u("x"),yhoverformat:u("y"),zhoverformat:u("z",1),hovertemplate:t.hovertemplate},p("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/cartesian/axis_format_attributes":857,"../contour/attributes":1028,"../histogram2d/attributes":1117}],1124:[function(i,B,V){var t=i("../../lib"),h=i("../histogram2d/sample_defaults"),p=i("../contour/contours_defaults"),u=i("../contour/style_defaults"),e=i("./attributes");B.exports=function(l,o,a,n){function s(r,c){return t.coerce(l,o,e,r,c)}h(l,o,s,n),o.visible!==!1&&(p(l,o,s,function(r){return t.coerce2(l,o,e,r)}),u(l,o,s,n),s("hovertemplate"),s("xhoverformat"),s("yhoverformat"))}},{"../../lib":803,"../contour/contours_defaults":1035,"../contour/style_defaults":1049,"../histogram2d/sample_defaults":1122,"./attributes":1123}],1125:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),crossTraceDefaults:i("../histogram/cross_trace_defaults"),calc:i("../contour/calc"),plot:i("../contour/plot").plot,layerName:"contourlayer",style:i("../contour/style"),colorbar:i("../contour/colorbar"),hoverPoints:i("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":868,"../contour/calc":1029,"../contour/colorbar":1031,"../contour/hover":1041,"../contour/plot":1046,"../contour/style":1048,"../histogram/cross_trace_defaults":1111,"./attributes":1123,"./defaults":1124}],1126:[function(i,B,V){var t=i("../../plots/template_attributes").hovertemplateAttrs,h=i("../../plots/template_attributes").texttemplateAttrs,p=i("../../components/colorscale/attributes"),u=i("../../plots/domain").attributes,e=i("../pie/attributes"),l=i("../sunburst/attributes"),o=i("../treemap/attributes"),a=i("../treemap/constants"),n=i("../../lib/extend").extendFlat;B.exports={labels:l.labels,parents:l.parents,values:l.values,branchvalues:l.branchvalues,count:l.count,level:l.level,maxdepth:l.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:o.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:n({colors:l.marker.colors,line:l.marker.line,editType:"calc"},p("marker",{colorAttr:"colors",anim:!1})),leaf:l.leaf,pathbar:o.pathbar,text:e.text,textinfo:l.textinfo,texttemplate:h({editType:"plot"},{keys:a.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:l.hoverinfo,hovertemplate:t({},{keys:a.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:o.outsidetextfont,textposition:o.textposition,sort:e.sort,root:l.root,domain:u({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/domain":882,"../../plots/template_attributes":926,"../pie/attributes":1192,"../sunburst/attributes":1330,"../treemap/attributes":1356,"../treemap/constants":1359}],1127:[function(i,B,V){var t=i("../../plots/plots");V.name="icicle",V.plot=function(h,p,u,e){t.plotBasePlot(V.name,h,p,u,e)},V.clean=function(h,p,u,e){t.cleanBasePlot(V.name,h,p,u,e)}},{"../../plots/plots":917}],1128:[function(i,B,V){var t=i("../sunburst/calc");V.calc=function(h,p){return t.calc(h,p)},V.crossTraceCalc=function(h){return t._runCrossTraceCalc("icicle",h)}},{"../sunburst/calc":1332}],1129:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("../../components/color"),u=i("../../plots/domain").defaults,e=i("../bar/defaults").handleText,l=i("../bar/constants").TEXTPAD,o=i("../../components/colorscale"),a=o.hasColorscale,n=o.handleDefaults;B.exports=function(s,r,c,f){function d(k,E){return t.coerce(s,r,h,k,E)}var g=d("labels"),m=d("parents");if(g&&g.length&&m&&m.length){var y=d("values");y&&y.length?d("branchvalues"):d("count"),d("level"),d("maxdepth"),d("tiling.orientation"),d("tiling.flip"),d("tiling.pad");var v=d("text");d("texttemplate"),r.texttemplate||d("textinfo",Array.isArray(v)?"text+label":"label"),d("hovertext"),d("hovertemplate");var T=d("pathbar.visible");e(s,r,f,d,"auto",{hasPathbar:T,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),d("textposition"),d("marker.line.width")&&d("marker.line.color",f.paper_bgcolor),d("marker.colors");var _=r._hasColorscale=a(s,"marker","colors")||(s.marker||{}).coloraxis;_&&n(s,r,f,d,{prefix:"marker.",cLetter:"c"}),d("leaf.opacity",_?1:.7),r._hovered={marker:{line:{width:2,color:p.contrast(f.paper_bgcolor)}}},T&&(d("pathbar.thickness",r.pathbar.textfont.size+2*l),d("pathbar.side"),d("pathbar.edgeshape")),d("sort"),d("root.color"),u(r,f,d),r._length=null}else r.visible=!1}},{"../../components/color":666,"../../components/colorscale":678,"../../lib":803,"../../plots/domain":882,"../bar/constants":943,"../bar/defaults":945,"./attributes":1126}],1130:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../components/drawing"),u=i("../../lib/svg_text_utils"),e=i("./partition"),l=i("./style").styleOne,o=i("../treemap/constants"),a=i("../sunburst/helpers"),n=i("../sunburst/fx"),s=i("../sunburst/plot").formatSliceLabel;B.exports=function(r,c,f,d,g){var m=g.width,y=g.height,v=g.viewX,T=g.viewY,_=g.pathSlice,k=g.toMoveInsideSlice,E=g.strTransform,A=g.hasTransition,b=g.handleSlicesExit,L=g.makeUpdateSliceInterpolator,w=g.makeUpdateTextInterpolator,C=g.prevEntry,S=r._fullLayout,P=c[0].trace,z=P.textposition.indexOf("left")!==-1,F=P.textposition.indexOf("right")!==-1,q=P.textposition.indexOf("bottom")!==-1,W=e(f,[m,y],{flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1,orientation:P.tiling.orientation,pad:{inner:P.tiling.pad},maxDepth:P._maxDepth}).descendants(),X=1/0,Q=-1/0;W.forEach(function(D){var U=D.depth;U>=P._maxDepth?(D.x0=D.x1=(D.x0+D.x1)/2,D.y0=D.y1=(D.y0+D.y1)/2):(X=Math.min(X,U),Q=Math.max(Q,U))}),d=d.data(W,a.getPtId),P._maxVisibleLayers=isFinite(Q)?Q-X+1:0,d.enter().append("g").classed("slice",!0),b(d,!1,{},[m,y],_),d.order();var Z=null;if(A&&C){var Y=a.getPtId(C);d.each(function(D){Z===null&&a.getPtId(D)===Y&&(Z={x0:D.x0,x1:D.x1,y0:D.y0,y1:D.y1})})}var N=function(){return Z||{x0:0,x1:m,y0:0,y1:y}},J=d;return A&&(J=J.transition().each("end",function(){var D=t.select(this);a.setSliceCursor(D,r,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),J.each(function(D){D._hoverX=v(D.x1-P.tiling.pad),D._hoverY=T(q?D.y1-P.tiling.pad/2:D.y0+P.tiling.pad/2);var U=t.select(this),G=h.ensureSingle(U,"path","surface",function(ne){ne.style("pointer-events","all")});A?G.transition().attrTween("d",function(ne){var ae=L(ne,!1,N(),[m,y],{orientation:P.tiling.orientation,flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1});return function(ie){return _(ae(ie))}}):G.attr("d",_),U.call(n,f,r,c,{styleOne:l,eventDataKeys:o.eventDataKeys,transitionTime:o.CLICK_TRANSITION_TIME,transitionEasing:o.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,r,{isTransitioning:r._transitioning}),G.call(l,D,P,{hovered:!1}),D.x0===D.x1||D.y0===D.y1?D._text="":D._text=s(D,f,P,c,S)||"";var $=h.ensureSingle(U,"g","slicetext"),K=h.ensureSingle($,"text","",function(ne){ne.attr("data-notex",1)}),re=h.ensureUniformFontSize(r,a.determineTextFont(P,D,S.font));K.text(D._text||" ").classed("slicetext",!0).attr("text-anchor",F?"end":z?"start":"middle").call(p.font,re).call(u.convertToTspans,r),D.textBB=p.bBox(K.node()),D.transform=k(D,{fontSize:re.size}),D.transform.fontSize=re.size,A?K.transition().attrTween("transform",function(ne){var ae=w(ne,!1,N(),[m,y]);return function(ie){return E(ae(ie))}}):K.attr("transform",E(D))}),Z}},{"../../components/drawing":688,"../../lib":803,"../../lib/svg_text_utils":829,"../sunburst/fx":1335,"../sunburst/helpers":1336,"../sunburst/plot":1340,"../treemap/constants":1359,"./partition":1134,"./style":1136,"@plotly/d3":58}],1131:[function(i,B,V){B.exports={moduleType:"trace",name:"icicle",basePlotModule:i("./base_plot"),categories:[],animatable:!0,attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyDefaults:i("./defaults"),supplyLayoutDefaults:i("./layout_defaults"),calc:i("./calc").calc,crossTraceCalc:i("./calc").crossTraceCalc,plot:i("./plot"),style:i("./style").style,colorbar:i("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1236,"./attributes":1126,"./base_plot":1127,"./calc":1128,"./defaults":1129,"./layout_attributes":1132,"./layout_defaults":1133,"./plot":1135,"./style":1136}],1132:[function(i,B,V){B.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1133:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes");B.exports=function(p,u){function e(l,o){return t.coerce(p,u,h,l,o)}e("iciclecolorway",u.colorway),e("extendiciclecolors")}},{"../../lib":803,"./layout_attributes":1132}],1134:[function(i,B,V){var t=i("d3-hierarchy"),h=i("../treemap/flip_tree");B.exports=function(p,u,e){var l=e.flipX,o=e.flipY,a=e.orientation==="h",n=e.maxDepth,s=u[0],r=u[1];n&&(s=(p.height+1)*u[0]/Math.min(p.height+1,n),r=(p.height+1)*u[1]/Math.min(p.height+1,n));var c=t.partition().padding(e.pad.inner).size(a?[u[1],s]:[u[0],r])(p);return(a||l||o)&&h(c,u,{swapXY:a,flipX:l,flipY:o}),c}},{"../treemap/flip_tree":1364,"d3-hierarchy":170}],1135:[function(i,B,V){var t=i("../treemap/draw"),h=i("./draw_descendants");B.exports=function(p,u,e,l){return t(p,u,e,l,{type:"icicle",drawDescendants:h})}},{"../treemap/draw":1361,"./draw_descendants":1130}],1136:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/color"),p=i("../../lib"),u=i("../bar/uniform_text").resizeText;function e(l,o,a){var n=o.data.data,s=!o.children,r=n.i,c=p.castOption(a,r,"marker.line.color")||h.defaultLine,f=p.castOption(a,r,"marker.line.width")||0;l.style("stroke-width",f).call(h.fill,n.color).call(h.stroke,c).style("opacity",s?a.leaf.opacity:null)}B.exports={style:function(l){var o=l._fullLayout._iciclelayer.selectAll(".trace");u(l,o,"icicle"),o.each(function(a){var n=t.select(this),s=a[0].trace;n.style("opacity",s.opacity),n.selectAll("path.surface").each(function(r){t.select(this).call(e,r,s)})})},styleOne:e}},{"../../components/color":666,"../../lib":803,"../bar/uniform_text":957,"@plotly/d3":58}],1137:[function(i,B,V){for(var t=i("../../plots/attributes"),h=i("../../plots/template_attributes").hovertemplateAttrs,p=i("../../lib/extend").extendFlat,u=i("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],l=[],o=[],a=0;a<e.length;a++){var n=u[e[a]];l.push("For the `"+e[a]+"` colormodel, it is ["+(n.zminDflt||n.min).join(", ")+"]."),o.push("For the `"+e[a]+"` colormodel, it is ["+(n.zmaxDflt||n.max).join(", ")+"].")}B.exports=p({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:p({},t.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:h({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":793,"../../plots/attributes":850,"../../plots/template_attributes":926,"./constants":1139}],1138:[function(i,B,V){var t=i("../../lib"),h=i("./constants"),p=i("fast-isnumeric"),u=i("../../plots/cartesian/axes"),e=i("../../lib").maxRowLength,l=i("./helpers").getImageSize;function o(n,s,r,c){return function(f){return t.constrain((f-n)*s,r,c)}}function a(n,s){return function(r){return t.constrain(r,n,s)}}B.exports=function(n,s){var r,c;if(s._hasZ)r=s.z.length,c=e(s.z);else if(s._hasSource){var f=l(s.source);r=f.height,c=f.width}var d,g=u.getFromId(n,s.xaxis||"x"),m=u.getFromId(n,s.yaxis||"y"),y=g.d2c(s.x0)-s.dx/2,v=m.d2c(s.y0)-s.dy/2,T=[y,y+c*s.dx],_=[v,v+r*s.dy];if(g&&g.type==="log")for(d=0;d<c;d++)T.push(y+d*s.dx);if(m&&m.type==="log")for(d=0;d<r;d++)_.push(v+d*s.dy);return s._extremes[g._id]=u.findExtremes(g,T),s._extremes[m._id]=u.findExtremes(m,_),s._scaler=function(k){var E=h.colormodel[k.colormodel],A=(E.colormodel||k.colormodel).length;k._sArray=[];for(var b=0;b<A;b++)E.min[b]!==k.zmin[b]||E.max[b]!==k.zmax[b]?k._sArray.push(o(k.zmin[b],(E.max[b]-E.min[b])/(k.zmax[b]-k.zmin[b]),E.min[b],E.max[b])):k._sArray.push(a(E.min[b],E.max[b]));return function(L){for(var w=L.slice(0,A),C=0;C<A;C++){var S=w[C];if(!p(S))return!1;w[C]=k._sArray[C](S)}return w}}(s),[{x0:y,y0:v,z:s.z,w:c,h:r}]}},{"../../lib":803,"../../plots/cartesian/axes":854,"./constants":1139,"./helpers":1142,"fast-isnumeric":249}],1139:[function(i,B,V){B.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(t){return t.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(t){return t.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(t){return t.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(t){var h=t.slice(0,3);return h[1]=h[1]+"%",h[2]=h[2]+"%",h},suffix:["°","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(t){var h=t.slice(0,4);return h[1]=h[1]+"%",h[2]=h[2]+"%",h},suffix:["°","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],1140:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("./constants"),u=i("../../snapshot/helpers").IMAGE_URL_PREFIX;B.exports=function(e,l){function o(s,r){return t.coerce(e,l,h,s,r)}o("source"),l.source&&!l.source.match(u)&&delete l.source,l._hasSource=!!l.source;var a,n=o("z");l._hasZ=!(n===void 0||!n.length||!n[0]||!n[0].length),l._hasZ||l._hasSource?(o("x0"),o("y0"),o("dx"),o("dy"),l._hasZ?(o("colormodel","rgb"),o("zmin",(a=p.colormodel[l.colormodel]).zminDflt||a.min),o("zmax",a.zmaxDflt||a.max)):l._hasSource&&(l.colormodel="rgba256",a=p.colormodel[l.colormodel],l.zmin=a.zminDflt,l.zmax=a.zmaxDflt),o("zsmooth"),o("text"),o("hovertext"),o("hovertemplate"),l._length=null):l.visible=!1}},{"../../lib":803,"../../snapshot/helpers":935,"./attributes":1137,"./constants":1139}],1141:[function(i,B,V){B.exports=function(t,h){return"xVal"in h&&(t.x=h.xVal),"yVal"in h&&(t.y=h.yVal),h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),t.color=h.color,t.colormodel=h.trace.colormodel,t.z||(t.z=h.color),t}},{}],1142:[function(i,B,V){var t=i("probe-image-size/sync"),h=i("../../snapshot/helpers").IMAGE_URL_PREFIX,p=i("buffer/").Buffer;V.getImageSize=function(u){var e=u.replace(h,""),l=new p(e,"base64");return t(l)}},{"../../snapshot/helpers":935,"buffer/":117,"probe-image-size/sync":527}],1143:[function(i,B,V){var t=i("../../components/fx"),h=i("../../lib"),p=i("./constants");B.exports=function(u,e,l){var o=u.cd[0],a=o.trace,n=u.xa,s=u.ya;if(!(t.inbox(e-o.x0,e-(o.x0+o.w*a.dx),0)>0||t.inbox(l-o.y0,l-(o.y0+o.h*a.dy),0)>0)){var r,c=Math.floor((e-o.x0)/a.dx),f=Math.floor(Math.abs(l-o.y0)/a.dy);if(a._hasZ?r=o.z[f][c]:a._hasSource&&(r=a._canvas.el.getContext("2d").getImageData(c,f,1,1).data),r){var d,g=o.hi||a.hoverinfo;if(g){var m=g.split("+");m.indexOf("all")!==-1&&(m=["color"]),m.indexOf("color")!==-1&&(d=!0)}var y,v=p.colormodel[a.colormodel],T=v.colormodel||a.colormodel,_=T.length,k=a._scaler(r),E=v.suffix,A=[];(a.hovertemplate||d)&&(A.push("["+[k[0]+E[0],k[1]+E[1],k[2]+E[2]].join(", ")),_===4&&A.push(", "+k[3]+E[3]),A.push("]"),A=A.join(""),u.extraText=T.toUpperCase()+": "+A),Array.isArray(a.hovertext)&&Array.isArray(a.hovertext[f])?y=a.hovertext[f][c]:Array.isArray(a.text)&&Array.isArray(a.text[f])&&(y=a.text[f][c]);var b=s.c2p(o.y0+(f+.5)*a.dy),L=o.x0+(c+.5)*a.dx,w=o.y0+(f+.5)*a.dy,C="["+r.slice(0,a.colormodel.length).join(", ")+"]";return[h.extendFlat(u,{index:[f,c],x0:n.c2p(o.x0+c*a.dx),x1:n.c2p(o.x0+(c+1)*a.dx),y0:b,y1:b,color:k,xVal:L,xLabelVal:L,yVal:w,yLabelVal:w,zLabelVal:C,text:y,hovertemplateLabels:{zLabel:C,colorLabel:A,"color[0]Label":k[0]+E[0],"color[1]Label":k[1]+E[1],"color[2]Label":k[2]+E[2],"color[3]Label":k[3]+E[3]}})]}}}},{"../../components/fx":706,"../../lib":803,"./constants":1139}],1144:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("./calc"),plot:i("./plot"),style:i("./style"),hoverPoints:i("./hover"),eventData:i("./event_data"),moduleType:"trace",name:"image",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":868,"./attributes":1137,"./calc":1138,"./defaults":1140,"./event_data":1141,"./hover":1143,"./plot":1145,"./style":1146}],1145:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=h.strTranslate,u=i("../../constants/xmlns_namespaces"),e=i("./constants"),l=h.isIOS()||h.isSafari()||h.isIE();B.exports=function(o,a,n,s){var r=a.xaxis,c=a.yaxis,f=!(l||o._context._exportedPlot);h.makeTraceGroups(s,n,"im").each(function(d){var g=t.select(this),m=d[0],y=m.trace,v=(y.zsmooth==="fast"||y.zsmooth===!1&&f)&&!y._hasZ&&y._hasSource&&r.type==="linear"&&c.type==="linear";y._realImage=v;var T,_,k,E,A,b,L=m.z,w=m.x0,C=m.y0,S=m.w,P=m.h,z=y.dx,F=y.dy;for(b=0;T===void 0&&b<S;)T=r.c2p(w+b*z),b++;for(b=S;_===void 0&&b>0;)_=r.c2p(w+b*z),b--;for(b=0;E===void 0&&b<P;)E=c.c2p(C+b*F),b++;for(b=P;A===void 0&&b>0;)A=c.c2p(C+b*F),b--;_<T&&(k=_,_=T,T=k),A<E&&(k=E,E=A,A=k),!v&&(T=Math.max(-.5*r._length,T),_=Math.min(1.5*r._length,_),E=Math.max(-.5*c._length,E),A=Math.min(1.5*c._length,A));var q=Math.round(_-T),W=Math.round(A-E);if(q<=0||W<=0)g.selectAll("image").data([]).exit().remove();else{var X=g.selectAll("image").data([d]);X.enter().append("svg:image").attr({xmlns:u.svg,preserveAspectRatio:"none"}),X.exit().remove();var Q=y.zsmooth===!1?e.pixelatedStyle:"";if(v){var Z=h.simpleMap(r.range,r.r2l),Y=h.simpleMap(c.range,c.r2l),N=Z[1]<Z[0],J=Y[1]>Y[0];if(N||J){var D=T+q/2,U=E+W/2;Q+="transform:"+p(D+"px",U+"px")+"scale("+(N?-1:1)+","+(J?-1:1)+")"+p(-D+"px",-U+"px")+";"}}X.attr("style",Q);var G=new Promise(function(K){if(y._hasZ)K();else if(y._hasSource)if(y._canvas&&y._canvas.el.width===S&&y._canvas.el.height===P&&y._canvas.source===y.source)K();else{var re=document.createElement("canvas");re.width=S,re.height=P;var ne=re.getContext("2d");y._image=y._image||new Image;var ae=y._image;ae.onload=function(){ne.drawImage(ae,0,0),y._canvas={el:re,source:y.source},K()},ae.setAttribute("src",y.source)}}).then(function(){var K;if(y._hasZ)K=$(function(ne,ae){return L[ae][ne]}).toDataURL("image/png");else if(y._hasSource)if(v)K=y.source;else{var re=y._canvas.el.getContext("2d").getImageData(0,0,S,P).data;K=$(function(ne,ae){var ie=4*(ae*S+ne);return[re[ie],re[ie+1],re[ie+2],re[ie+3]]}).toDataURL("image/png")}X.attr({"xlink:href":K,height:W,width:q,x:T,y:E})});o._promises.push(G)}function $(K){var re=document.createElement("canvas");re.width=q,re.height=W;var ne,ae=re.getContext("2d"),ie=function(fe){return h.constrain(Math.round(r.c2p(w+fe*z)-T),0,q)},he=function(fe){return h.constrain(Math.round(c.c2p(C+fe*F)-E),0,W)},se=e.colormodel[y.colormodel],de=se.colormodel||y.colormodel,ce=se.fmt;for(b=0;b<m.w;b++){var ve=ie(b),Ee=ie(b+1);if(Ee!==ve&&!isNaN(Ee)&&!isNaN(ve))for(var Le=0;Le<m.h;Le++){var Te=he(Le),xe=he(Le+1);xe===Te||isNaN(xe)||isNaN(Te)||!K(b,Le)||(ne=y._scaler(K(b,Le)),ae.fillStyle=ne?de+"("+ce(ne).join(",")+")":"rgba(0,0,0,0)",ae.fillRect(ve,Te,Ee-ve,xe-Te))}}return re}})}},{"../../constants/xmlns_namespaces":780,"../../lib":803,"./constants":1139,"@plotly/d3":58}],1146:[function(i,B,V){var t=i("@plotly/d3");B.exports=function(h){t.select(h).selectAll(".im image").style("opacity",function(p){return p[0].trace.opacity})}},{"@plotly/d3":58}],1147:[function(i,B,V){var t=i("../../lib/extend").extendFlat,h=i("../../lib/extend").extendDeep,p=i("../../plot_api/edit_types").overrideAll,u=i("../../plots/font_attributes"),e=i("../../components/color/attributes"),l=i("../../plots/domain").attributes,o=i("../../plots/cartesian/layout_attributes"),a=i("../../plot_api/plot_template").templatedArray,n=i("../../constants/delta.js"),s=i("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,r=u({editType:"plot",colorEditType:"plot"}),c={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},f={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},d=a("step",h({},c,{range:f}));B.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:l({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:t({},r,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:s("value")},font:t({},r,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:s("value")},increasing:{symbol:{valType:"string",dflt:n.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:n.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:n.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:n.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:t({},r,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:h({},c,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:p({range:f,visible:t({},o.visible,{dflt:!0}),tickmode:o.tickmode,nticks:o.nticks,tick0:o.tick0,dtick:o.dtick,tickvals:o.tickvals,ticktext:o.ticktext,ticks:t({},o.ticks,{dflt:"outside"}),ticklen:o.ticklen,tickwidth:o.tickwidth,tickcolor:o.tickcolor,showticklabels:o.showticklabels,tickfont:u({}),tickangle:o.tickangle,tickformat:o.tickformat,tickformatstops:o.tickformatstops,tickprefix:o.tickprefix,showtickprefix:o.showtickprefix,ticksuffix:o.ticksuffix,showticksuffix:o.showticksuffix,separatethousands:o.separatethousands,exponentformat:o.exponentformat,minexponent:o.minexponent,showexponent:o.showexponent,editType:"plot"},"plot"),steps:d,threshold:{line:{color:t({},c.line.color,{}),width:t({},c.line.width,{dflt:1}),editType:"plot"},thickness:t({},c.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":665,"../../constants/delta.js":773,"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plot_api/plot_template":843,"../../plots/cartesian/axis_format_attributes":857,"../../plots/cartesian/layout_attributes":869,"../../plots/domain":882,"../../plots/font_attributes":883}],1148:[function(i,B,V){var t=i("../../plots/plots");V.name="indicator",V.plot=function(h,p,u,e){t.plotBasePlot(V.name,h,p,u,e)},V.clean=function(h,p,u,e){t.cleanBasePlot(V.name,h,p,u,e)}},{"../../plots/plots":917}],1149:[function(i,B,V){B.exports={calc:function(t,h){var p=[],u=h.value;typeof h._lastValue!="number"&&(h._lastValue=h.value);var e=h._lastValue,l=e;return h._hasDelta&&typeof h.delta.reference=="number"&&(l=h.delta.reference),p[0]={y:u,lastY:e,delta:u-l,relativeDelta:(u-l)/l},p}}},{}],1150:[function(i,B,V){B.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],1151:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("../../plots/domain").defaults,u=i("../../plot_api/plot_template"),e=i("../../plots/array_container_defaults"),l=i("./constants.js"),o=i("../../plots/cartesian/tick_value_defaults"),a=i("../../plots/cartesian/tick_mark_defaults"),n=i("../../plots/cartesian/tick_label_defaults");function s(r,c){function f(d,g){return t.coerce(r,c,h.gauge.steps,d,g)}f("color"),f("line.color"),f("line.width"),f("range"),f("thickness")}B.exports={supplyDefaults:function(r,c,f,d){function g(C,S){return t.coerce(r,c,h,C,S)}p(c,d,g),g("mode"),c._hasNumber=c.mode.indexOf("number")!==-1,c._hasDelta=c.mode.indexOf("delta")!==-1,c._hasGauge=c.mode.indexOf("gauge")!==-1;var m=g("value");c._range=[0,typeof m=="number"?1.5*m:1];var y,v,T,_,k,E,A=new Array(2);function b(C,S){return t.coerce(T,_,h.gauge,C,S)}function L(C,S){return t.coerce(k,E,h.gauge.axis,C,S)}if(c._hasNumber&&(g("number.valueformat"),g("number.font.color",d.font.color),g("number.font.family",d.font.family),g("number.font.size"),c.number.font.size===void 0&&(c.number.font.size=l.defaultNumberFontSize,A[0]=!0),g("number.prefix"),g("number.suffix"),y=c.number.font.size),c._hasDelta&&(g("delta.font.color",d.font.color),g("delta.font.family",d.font.family),g("delta.font.size"),c.delta.font.size===void 0&&(c.delta.font.size=(c._hasNumber?.5:1)*(y||l.defaultNumberFontSize),A[1]=!0),g("delta.reference",c.value),g("delta.relative"),g("delta.valueformat",c.delta.relative?"2%":""),g("delta.increasing.symbol"),g("delta.increasing.color"),g("delta.decreasing.symbol"),g("delta.decreasing.color"),g("delta.position"),v=c.delta.font.size),c._scaleNumbers=(!c._hasNumber||A[0])&&(!c._hasDelta||A[1])||!1,g("title.font.color",d.font.color),g("title.font.family",d.font.family),g("title.font.size",.25*(y||v||l.defaultNumberFontSize)),g("title.text"),c._hasGauge){(T=r.gauge)||(T={}),_=u.newContainer(c,"gauge"),b("shape"),(c._isBullet=c.gauge.shape==="bullet")||g("title.align","center"),(c._isAngular=c.gauge.shape==="angular")||g("align","center"),b("bgcolor",d.paper_bgcolor),b("borderwidth"),b("bordercolor"),b("bar.color"),b("bar.line.color"),b("bar.line.width"),b("bar.thickness",l.valueThickness*(c.gauge.shape==="bullet"?.5:1)),e(T,_,{name:"steps",handleItemDefaults:s}),b("threshold.value"),b("threshold.thickness"),b("threshold.line.width"),b("threshold.line.color"),k={},T&&(k=T.axis||{}),E=u.newContainer(_,"axis"),L("visible"),c._range=L("range",c._range);var w={outerTicks:!0};o(k,E,L,"linear"),n(k,E,L,"linear",w),a(k,E,L,w)}else g("title.align","center"),g("align","center"),c._isAngular=c._isBullet=!1;c._length=null}}},{"../../lib":803,"../../plot_api/plot_template":843,"../../plots/array_container_defaults":849,"../../plots/cartesian/tick_label_defaults":876,"../../plots/cartesian/tick_mark_defaults":877,"../../plots/cartesian/tick_value_defaults":878,"../../plots/domain":882,"./attributes":1147,"./constants.js":1150}],1152:[function(i,B,V){B.exports={moduleType:"trace",name:"indicator",basePlotModule:i("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:i("./attributes"),supplyDefaults:i("./defaults").supplyDefaults,calc:i("./calc").calc,plot:i("./plot"),meta:{}}},{"./attributes":1147,"./base_plot":1148,"./calc":1149,"./defaults":1151,"./plot":1153}],1153:[function(i,B,V){var t=i("@plotly/d3"),h=i("d3-interpolate").interpolate,p=i("d3-interpolate").interpolateNumber,u=i("../../lib"),e=u.strScale,l=u.strTranslate,o=u.rad2deg,a=i("../../constants/alignment").MID_SHIFT,n=i("../../components/drawing"),s=i("./constants"),r=i("../../lib/svg_text_utils"),c=i("../../plots/cartesian/axes"),f=i("../../plots/cartesian/axis_defaults"),d=i("../../plots/cartesian/position_defaults"),g=i("../../plots/cartesian/layout_attributes"),m=i("../../components/color"),y={left:"start",center:"middle",right:"end"},v={left:0,center:.5,right:1},T=/[yzafpn\xb5mkMGTPEZY]/;function _(w){return w&&w.duration>0}function k(w){w.each(function(C){m.stroke(t.select(this),C.line.color)}).each(function(C){m.fill(t.select(this),C.color)}).style("stroke-width",function(C){return C.line.width})}function E(w,C,S){var P=w._fullLayout,z=u.extendFlat({type:"linear",ticks:"outside",range:S,showline:!0},C),F={type:"linear",_id:"x"+C._id},q={letter:"x",font:P.font,noHover:!0,noTickson:!0};function W(X,Q){return u.coerce(z,F,g,X,Q)}return f(z,F,W,q,P),d(z,F,W,q),F}function A(w,C,S){return[Math.min(C/w.width,S/w.height),w,C+"x"+S]}function b(w,C,S,P){var z=document.createElementNS("http://www.w3.org/2000/svg","text"),F=t.select(z);return F.text(w).attr("x",0).attr("y",0).attr("text-anchor",S).attr("data-unformatted",w).call(r.convertToTspans,P).call(n.font,C),n.bBox(F.node())}function L(w,C,S,P,z,F){var q="_cache"+C;w[q]&&w[q].key===z||(w[q]={key:z,value:S});var W=u.aggNums(F,null,[w[q].value,P],2);return w[q].value=W,W}B.exports=function(w,C,S,P){var z,F=w._fullLayout;_(S)&&P&&(z=P()),u.makeTraceGroups(F._indicatorlayer,C,"trace").each(function(q){var W,X,Q,Z,Y,N=q[0].trace,J=t.select(this),D=N._hasGauge,U=N._isAngular,G=N._isBullet,$=N.domain,K={w:F._size.w*($.x[1]-$.x[0]),h:F._size.h*($.y[1]-$.y[0]),l:F._size.l+F._size.w*$.x[0],r:F._size.r+F._size.w*(1-$.x[1]),t:F._size.t+F._size.h*(1-$.y[1]),b:F._size.b+F._size.h*$.y[0]},re=K.l+K.w/2,ne=K.t+K.h/2,ae=Math.min(K.w/2,K.h),ie=s.innerRadius*ae,he=N.align||"center";if(X=ne,D){if(U&&(W=re,X=ne+ae/2,Q=function(xe){return function(fe,ge){var ke=Math.sqrt(fe.width/2*(fe.width/2)+fe.height*fe.height);return[ge/ke,fe,ge]}(xe,.9*ie)}),G){var se=s.bulletPadding,de=1-s.bulletNumberDomainSize+se;W=K.l+(de+(1-de)*v[he])*K.w,Q=function(xe){return A(xe,(s.bulletNumberDomainSize-se)*K.w,K.h)}}}else W=K.l+v[he]*K.w,Q=function(xe){return A(xe,K.w,K.h)};(function(xe,fe,ge,ke){var Me,Se,De,Be=ge[0].trace,We=ke.numbersX,Qe=ke.numbersY,Oe=Be.align||"center",Ue=y[Oe],Xe=ke.transitionOpts,Ye=ke.onComplete,$e=u.ensureSingle(fe,"g","numbers"),it=[];Be._hasNumber&&it.push("number"),Be._hasDelta&&(it.push("delta"),Be.delta.position==="left"&&it.reverse());var ot=$e.selectAll("text").data(it);function Et(Ge,Ct,Ie,be){if(!Ge.match("s")||Ie>=0==be>=0||Ct(Ie).slice(-1).match(T)||Ct(be).slice(-1).match(T))return Ct;var Ae=Ge.slice().replace("s","f").replace(/\d+/,function(ze){return parseInt(ze)-1}),Pe=E(xe,{tickformat:Ae});return function(ze){return Math.abs(ze)<1?c.tickText(Pe,ze).text:Ct(ze)}}ot.enter().append("text"),ot.attr("text-anchor",function(){return Ue}).attr("class",function(Ge){return Ge}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),ot.exit().remove();var mt,tt=Be.mode+Be.align;if(Be._hasDelta&&(mt=function(){var Ge=E(xe,{tickformat:Be.delta.valueformat},Be._range);Ge.setScale(),c.prepTicks(Ge);var Ct=function(qe){return c.tickText(Ge,qe).text},Ie=function(qe){return Be.delta.relative?qe.relativeDelta:qe.delta},be=function(qe,ht){return qe===0||typeof qe!="number"||isNaN(qe)?"-":(qe>0?Be.delta.increasing.symbol:Be.delta.decreasing.symbol)+ht(qe)},Ae=function(qe){return qe.delta>=0?Be.delta.increasing.color:Be.delta.decreasing.color};Be._deltaLastValue===void 0&&(Be._deltaLastValue=Ie(ge[0]));var Pe=$e.select("text.delta");function ze(){Pe.text(be(Ie(ge[0]),Ct)).call(m.fill,Ae(ge[0])).call(r.convertToTspans,xe)}return Pe.call(n.font,Be.delta.font).call(m.fill,Ae({delta:Be._deltaLastValue})),_(Xe)?Pe.transition().duration(Xe.duration).ease(Xe.easing).tween("text",function(){var qe=t.select(this),ht=Ie(ge[0]),at=Be._deltaLastValue,nt=Et(Be.delta.valueformat,Ct,at,ht),xt=p(at,ht);return Be._deltaLastValue=ht,function(Lt){qe.text(be(xt(Lt),nt)),qe.call(m.fill,Ae({delta:xt(Lt)}))}}).each("end",function(){ze(),Ye&&Ye()}).each("interrupt",function(){ze(),Ye&&Ye()}):ze(),Se=b(be(Ie(ge[0]),Ct),Be.delta.font,Ue,xe),Pe}(),tt+=Be.delta.position+Be.delta.font.size+Be.delta.font.family+Be.delta.valueformat,tt+=Be.delta.increasing.symbol+Be.delta.decreasing.symbol,De=Se),Be._hasNumber&&(function(){var Ge=E(xe,{tickformat:Be.number.valueformat},Be._range);Ge.setScale(),c.prepTicks(Ge);var Ct=function(ze){return c.tickText(Ge,ze).text},Ie=Be.number.suffix,be=Be.number.prefix,Ae=$e.select("text.number");function Pe(){var ze=typeof ge[0].y=="number"?be+Ct(ge[0].y)+Ie:"-";Ae.text(ze).call(n.font,Be.number.font).call(r.convertToTspans,xe)}_(Xe)?Ae.transition().duration(Xe.duration).ease(Xe.easing).each("end",function(){Pe(),Ye&&Ye()}).each("interrupt",function(){Pe(),Ye&&Ye()}).attrTween("text",function(){var ze=t.select(this),qe=p(ge[0].lastY,ge[0].y);Be._lastValue=ge[0].y;var ht=Et(Be.number.valueformat,Ct,ge[0].lastY,ge[0].y);return function(at){ze.text(be+ht(qe(at))+Ie)}}):Pe(),Me=b(be+Ct(ge[0].y)+Ie,Be.number.font,Ue,xe)}(),tt+=Be.number.font.size+Be.number.font.family+Be.number.valueformat+Be.number.suffix+Be.number.prefix,De=Me),Be._hasDelta&&Be._hasNumber){var Ke,Mt,Jt=[(Me.left+Me.right)/2,(Me.top+Me.bottom)/2],$t=[(Se.left+Se.right)/2,(Se.top+Se.bottom)/2],je=.75*Be.delta.font.size;Be.delta.position==="left"&&(Ke=L(Be,"deltaPos",0,-1*(Me.width*v[Be.align]+Se.width*(1-v[Be.align])+je),tt,Math.min),Mt=Jt[1]-$t[1],De={width:Me.width+Se.width+je,height:Math.max(Me.height,Se.height),left:Se.left+Ke,right:Me.right,top:Math.min(Me.top,Se.top+Mt),bottom:Math.max(Me.bottom,Se.bottom+Mt)}),Be.delta.position==="right"&&(Ke=L(Be,"deltaPos",0,Me.width*(1-v[Be.align])+Se.width*v[Be.align]+je,tt,Math.max),Mt=Jt[1]-$t[1],De={width:Me.width+Se.width+je,height:Math.max(Me.height,Se.height),left:Me.left,right:Se.right+Ke,top:Math.min(Me.top,Se.top+Mt),bottom:Math.max(Me.bottom,Se.bottom+Mt)}),Be.delta.position==="bottom"&&(Ke=null,Mt=Se.height,De={width:Math.max(Me.width,Se.width),height:Me.height+Se.height,left:Math.min(Me.left,Se.left),right:Math.max(Me.right,Se.right),top:Me.bottom-Me.height,bottom:Me.bottom+Se.height}),Be.delta.position==="top"&&(Ke=null,Mt=Me.top,De={width:Math.max(Me.width,Se.width),height:Me.height+Se.height,left:Math.min(Me.left,Se.left),right:Math.max(Me.right,Se.right),top:Me.bottom-Me.height-Se.height,bottom:Me.bottom}),mt.attr({dx:Ke,dy:Mt})}(Be._hasNumber||Be._hasDelta)&&$e.attr("transform",function(){var Ge=ke.numbersScaler(De);tt+=Ge[2];var Ct,Ie=L(Be,"numbersScale",1,Ge[0],tt,Math.min);Be._scaleNumbers||(Ie=1),Ct=Be._isAngular?Qe-Ie*De.bottom:Qe-Ie*(De.top+De.bottom)/2,Be._numbersTop=Ie*De.top+Ct;var be=De[Oe];Oe==="center"&&(be=(De.left+De.right)/2);var Ae=We-Ie*be;return Ae=L(Be,"numbersTranslate",0,Ae,tt,Math.max),l(Ae,Ct)+e(Ie)})})(w,J,q,{numbersX:W,numbersY:X,numbersScaler:Q,transitionOpts:S,onComplete:z}),D&&(Z={range:N.gauge.axis.range,color:N.gauge.bgcolor,line:{color:N.gauge.bordercolor,width:0},thickness:1},Y={range:N.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:N.gauge.bordercolor,width:N.gauge.borderwidth},thickness:1});var ce=J.selectAll("g.angular").data(U?q:[]);ce.exit().remove();var ve=J.selectAll("g.angularaxis").data(U?q:[]);ve.exit().remove(),U&&function(xe,fe,ge,ke){var Me,Se,De,Be,We=ge[0].trace,Qe=ke.size,Oe=ke.radius,Ue=ke.innerRadius,Xe=ke.gaugeBg,Ye=ke.gaugeOutline,$e=[Qe.l+Qe.w/2,Qe.t+Qe.h/2+Oe/2],it=ke.gauge,ot=ke.layer,Et=ke.transitionOpts,mt=ke.onComplete,tt=Math.PI/2;function Ke(St){var st=We.gauge.axis.range[0],It=(St-st)/(We.gauge.axis.range[1]-st)*Math.PI-tt;return It<-tt?-tt:It>tt?tt:It}function Mt(St){return t.svg.arc().innerRadius((Ue+Oe)/2-St/2*(Oe-Ue)).outerRadius((Ue+Oe)/2+St/2*(Oe-Ue)).startAngle(-tt)}function Jt(St){St.attr("d",function(st){return Mt(st.thickness).startAngle(Ke(st.range[0])).endAngle(Ke(st.range[1]))()})}it.enter().append("g").classed("angular",!0),it.attr("transform",l($e[0],$e[1])),ot.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),ot.selectAll("g.xangularaxistick,path,text").remove(),(Me=E(xe,We.gauge.axis)).type="linear",Me.range=We.gauge.axis.range,Me._id="xangularaxis",Me.ticklabeloverflow="allow",Me.setScale();var $t=function(St){return(Me.range[0]-St.x)/(Me.range[1]-Me.range[0])*Math.PI+Math.PI},je={},Ge=c.makeLabelFns(Me,0).labelStandoff;je.xFn=function(St){var st=$t(St);return Math.cos(st)*Ge},je.yFn=function(St){var st=$t(St),It=Math.sin(st)>0?.2:1;return-Math.sin(st)*(Ge+St.fontSize*It)+Math.abs(Math.cos(st))*(St.fontSize*a)},je.anchorFn=function(St){var st=$t(St),It=Math.cos(st);return Math.abs(It)<.1?"middle":It>0?"start":"end"},je.heightFn=function(St,st,It){var jt=$t(St);return-.5*(1+Math.sin(jt))*It};var Ct=function(St){return l($e[0]+Oe*Math.cos(St),$e[1]-Oe*Math.sin(St))};if(De=function(St){return Ct($t(St))},Se=c.calcTicks(Me),Be=c.getTickSigns(Me)[2],Me.visible){Be=Me.ticks==="inside"?-1:1;var Ie=(Me.linewidth||1)/2;c.drawTicks(xe,Me,{vals:Se,layer:ot,path:"M"+Be*Ie+",0h"+Be*Me.ticklen,transFn:function(St){var st=$t(St);return Ct(st)+"rotate("+-o(st)+")"}}),c.drawLabels(xe,Me,{vals:Se,layer:ot,transFn:De,labelFns:je})}var be=[Xe].concat(We.gauge.steps),Ae=it.selectAll("g.bg-arc").data(be);Ae.enter().append("g").classed("bg-arc",!0).append("path"),Ae.select("path").call(Jt).call(k),Ae.exit().remove();var Pe=Mt(We.gauge.bar.thickness),ze=it.selectAll("g.value-arc").data([We.gauge.bar]);ze.enter().append("g").classed("value-arc",!0).append("path");var qe=ze.select("path");_(Et)?(qe.transition().duration(Et.duration).ease(Et.easing).each("end",function(){mt&&mt()}).each("interrupt",function(){mt&&mt()}).attrTween("d",(ht=Pe,at=Ke(ge[0].lastY),nt=Ke(ge[0].y),function(){var St=h(at,nt);return function(st){return ht.endAngle(St(st))()}})),We._lastValue=ge[0].y):qe.attr("d",typeof ge[0].y=="number"?Pe.endAngle(Ke(ge[0].y)):"M0,0Z");var ht,at,nt;qe.call(k),ze.exit().remove(),be=[];var xt=We.gauge.threshold.value;(xt||xt===0)&&be.push({range:[xt,xt],color:We.gauge.threshold.color,line:{color:We.gauge.threshold.line.color,width:We.gauge.threshold.line.width},thickness:We.gauge.threshold.thickness});var Lt=it.selectAll("g.threshold-arc").data(be);Lt.enter().append("g").classed("threshold-arc",!0).append("path"),Lt.select("path").call(Jt).call(k),Lt.exit().remove();var bt=it.selectAll("g.gauge-outline").data([Ye]);bt.enter().append("g").classed("gauge-outline",!0).append("path"),bt.select("path").call(Jt).call(k),bt.exit().remove()}(w,0,q,{radius:ae,innerRadius:ie,gauge:ce,layer:ve,size:K,gaugeBg:Z,gaugeOutline:Y,transitionOpts:S,onComplete:z});var Ee=J.selectAll("g.bullet").data(G?q:[]);Ee.exit().remove();var Le=J.selectAll("g.bulletaxis").data(G?q:[]);Le.exit().remove(),G&&function(xe,fe,ge,ke){var Me,Se,De,Be,We,Qe=ge[0].trace,Oe=ke.gauge,Ue=ke.layer,Xe=ke.gaugeBg,Ye=ke.gaugeOutline,$e=ke.size,it=Qe.domain,ot=ke.transitionOpts,Et=ke.onComplete;Oe.enter().append("g").classed("bullet",!0),Oe.attr("transform",l($e.l,$e.t)),Ue.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),Ue.selectAll("g.xbulletaxistick,path,text").remove();var mt=$e.h,tt=Qe.gauge.bar.thickness*mt,Ke=it.x[0],Mt=it.x[0]+(it.x[1]-it.x[0])*(Qe._hasNumber||Qe._hasDelta?1-s.bulletNumberDomainSize:1);(Me=E(xe,Qe.gauge.axis))._id="xbulletaxis",Me.domain=[Ke,Mt],Me.setScale(),Se=c.calcTicks(Me),De=c.makeTransTickFn(Me),Be=c.getTickSigns(Me)[2],We=$e.t+$e.h,Me.visible&&(c.drawTicks(xe,Me,{vals:Me.ticks==="inside"?c.clipEnds(Me,Se):Se,layer:Ue,path:c.makeTickPath(Me,We,Be),transFn:De}),c.drawLabels(xe,Me,{vals:Se,layer:Ue,transFn:De,labelFns:c.makeLabelFns(Me,We)}));function Jt(Ae){Ae.attr("width",function(Pe){return Math.max(0,Me.c2p(Pe.range[1])-Me.c2p(Pe.range[0]))}).attr("x",function(Pe){return Me.c2p(Pe.range[0])}).attr("y",function(Pe){return .5*(1-Pe.thickness)*mt}).attr("height",function(Pe){return Pe.thickness*mt})}var $t=[Xe].concat(Qe.gauge.steps),je=Oe.selectAll("g.bg-bullet").data($t);je.enter().append("g").classed("bg-bullet",!0).append("rect"),je.select("rect").call(Jt).call(k),je.exit().remove();var Ge=Oe.selectAll("g.value-bullet").data([Qe.gauge.bar]);Ge.enter().append("g").classed("value-bullet",!0).append("rect"),Ge.select("rect").attr("height",tt).attr("y",(mt-tt)/2).call(k),_(ot)?Ge.select("rect").transition().duration(ot.duration).ease(ot.easing).each("end",function(){Et&&Et()}).each("interrupt",function(){Et&&Et()}).attr("width",Math.max(0,Me.c2p(Math.min(Qe.gauge.axis.range[1],ge[0].y)))):Ge.select("rect").attr("width",typeof ge[0].y=="number"?Math.max(0,Me.c2p(Math.min(Qe.gauge.axis.range[1],ge[0].y))):0),Ge.exit().remove();var Ct=ge.filter(function(){return Qe.gauge.threshold.value||Qe.gauge.threshold.value===0}),Ie=Oe.selectAll("g.threshold-bullet").data(Ct);Ie.enter().append("g").classed("threshold-bullet",!0).append("line"),Ie.select("line").attr("x1",Me.c2p(Qe.gauge.threshold.value)).attr("x2",Me.c2p(Qe.gauge.threshold.value)).attr("y1",(1-Qe.gauge.threshold.thickness)/2*mt).attr("y2",(1-(1-Qe.gauge.threshold.thickness)/2)*mt).call(m.stroke,Qe.gauge.threshold.line.color).style("stroke-width",Qe.gauge.threshold.line.width),Ie.exit().remove();var be=Oe.selectAll("g.gauge-outline").data([Ye]);be.enter().append("g").classed("gauge-outline",!0).append("rect"),be.select("rect").call(Jt).call(k),be.exit().remove()}(w,0,q,{gauge:Ee,layer:Le,size:K,gaugeBg:Z,gaugeOutline:Y,transitionOpts:S,onComplete:z});var Te=J.selectAll("text.title").data(q);Te.exit().remove(),Te.enter().append("text").classed("title",!0),Te.attr("text-anchor",function(){return G?y.right:y[N.title.align]}).text(N.title.text).call(n.font,N.title.font).call(r.convertToTspans,w),Te.attr("transform",function(){var xe,fe=K.l+K.w*v[N.title.align],ge=s.titlePadding,ke=n.bBox(Te.node());return D?(U&&(N.gauge.axis.visible?xe=n.bBox(ve.node()).top-ge-ke.bottom:xe=K.t+K.h/2-ae/2-ke.bottom-ge),G&&(xe=X-(ke.top+ke.bottom)/2,fe=K.l-s.bulletPadding*K.w)):xe=N._numbersTop-ge-ke.bottom,l(fe,xe)})})}},{"../../components/color":666,"../../components/drawing":688,"../../constants/alignment":771,"../../lib":803,"../../lib/svg_text_utils":829,"../../plots/cartesian/axes":854,"../../plots/cartesian/axis_defaults":856,"../../plots/cartesian/layout_attributes":869,"../../plots/cartesian/position_defaults":872,"./constants":1150,"@plotly/d3":58,"d3-interpolate":171}],1154:[function(i,B,V){var t=i("../../components/colorscale/attributes"),h=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=i("../../plots/template_attributes").hovertemplateAttrs,u=i("../mesh3d/attributes"),e=i("../../plots/attributes"),l=i("../../lib/extend").extendFlat,o=i("../../plot_api/edit_types").overrideAll,a=B.exports=o(l({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:p(),xhoverformat:h("x"),yhoverformat:h("y"),zhoverformat:h("z"),valuehoverformat:h("value",1),showlegend:l({},e.showlegend,{dflt:!1})},t("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:u.opacity,lightposition:u.lightposition,lighting:u.lighting,flatshading:u.flatshading,contour:u.contour,hoverinfo:l({},e.hoverinfo)}),"calc","nested");a.flatshading.dflt=!0,a.lighting.facenormalsepsilon.dflt=0,a.x.editType=a.y.editType=a.z.editType=a.value.editType="calc+clearAxisTypes",a.transforms=void 0},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../mesh3d/attributes":1159}],1155:[function(i,B,V){var t=i("../../components/colorscale/calc"),h=i("../streamtube/calc").processGrid,p=i("../streamtube/calc").filter;B.exports=function(u,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=p(e.x,e._len),e._y=p(e.y,e._len),e._z=p(e.z,e._len),e._value=p(e.value,e._len);var l=h(e);e._gridFill=l.fill,e._Xs=l.Xs,e._Ys=l.Ys,e._Zs=l.Zs,e._len=l.len;for(var o=1/0,a=-1/0,n=0;n<e._len;n++){var s=e._value[n];o=Math.min(o,s),a=Math.max(a,s)}e._minValues=o,e._maxValues=a,e._vMin=e.isomin===void 0||e.isomin===null?o:e.isomin,e._vMax=e.isomax===void 0||e.isomin===null?a:e.isomax,t(u,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":674,"../streamtube/calc":1326}],1156:[function(i,B,V){var t=i("gl-mesh3d"),h=i("../../lib/gl_format_color").parseColorScale,p=i("../../lib/str2rgbarray"),u=i("../../components/colorscale").extractOpts,e=i("../../plots/gl3d/zip3"),l=function(r,c){for(var f=c.length-1;f>0;f--){var d=Math.min(c[f],c[f-1]),g=Math.max(c[f],c[f-1]);if(g>d&&d<r&&r<=g)return{id:f,distRatio:(g-r)/(g-d)}}return{id:0,distRatio:0}};function o(r,c,f){this.scene=r,this.uid=f,this.mesh=c,this.name="",this.data=null,this.showContour=!1}var a=o.prototype;a.handlePick=function(r){if(r.object===this.mesh){var c=r.data.index,f=this.data._meshX[c],d=this.data._meshY[c],g=this.data._meshZ[c],m=this.data._Ys.length,y=this.data._Zs.length,v=l(f,this.data._Xs).id,T=l(d,this.data._Ys).id,_=l(g,this.data._Zs).id,k=r.index=_+y*T+y*m*v;r.traceCoordinate=[this.data._meshX[k],this.data._meshY[k],this.data._meshZ[k],this.data._value[k]];var E=this.data.hovertext||this.data.text;return Array.isArray(E)&&E[k]!==void 0?r.textLabel=E[k]:E&&(r.textLabel=E),!0}},a.update=function(r){var c=this.scene,f=c.fullSceneLayout;function d(y,v,T,_){return v.map(function(k){return y.d2l(k,0,_)*T})}this.data=s(r);var g={positions:e(d(f.xaxis,r._meshX,c.dataScale[0],r.xcalendar),d(f.yaxis,r._meshY,c.dataScale[1],r.ycalendar),d(f.zaxis,r._meshZ,c.dataScale[2],r.zcalendar)),cells:e(r._meshI,r._meshJ,r._meshK),lightPosition:[r.lightposition.x,r.lightposition.y,r.lightposition.z],ambient:r.lighting.ambient,diffuse:r.lighting.diffuse,specular:r.lighting.specular,roughness:r.lighting.roughness,fresnel:r.lighting.fresnel,vertexNormalsEpsilon:r.lighting.vertexnormalsepsilon,faceNormalsEpsilon:r.lighting.facenormalsepsilon,opacity:r.opacity,contourEnable:r.contour.show,contourColor:p(r.contour.color).slice(0,3),contourWidth:r.contour.width,useFacetNormals:r.flatshading},m=u(r);g.vertexIntensity=r._meshIntensity,g.vertexIntensityBounds=[m.min,m.max],g.colormap=h(r),this.mesh.update(g)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var n=["xyz","xzy","yxz","yzx","zxy","zyx"];function s(r){r._meshI=[],r._meshJ=[],r._meshK=[];var c,f,d,g,m,y,v,T=r.surface.show,_=r.spaceframe.show,k=r.surface.fill,E=r.spaceframe.fill,A=!1,b=!1,L=0,w=r._Xs,C=r._Ys,S=r._Zs,P=w.length,z=C.length,F=S.length,q=n.indexOf(r._gridFill.replace(/-/g,"").replace(/\+/g,"")),W=function(Oe,Ue,Xe){switch(q){case 5:return Xe+F*Ue+F*z*Oe;case 4:return Xe+F*Oe+F*P*Ue;case 3:return Ue+z*Xe+z*F*Oe;case 2:return Ue+z*Oe+z*P*Xe;case 1:return Oe+P*Xe+P*F*Ue;default:return Oe+P*Ue+P*z*Xe}},X=r._minValues,Q=r._maxValues,Z=r._vMin,Y=r._vMax;function N(Oe,Ue,Xe){for(var Ye=y.length,$e=f;$e<Ye;$e++)if(Oe===d[$e]&&Ue===g[$e]&&Xe===m[$e])return $e;return-1}function J(){f=c}function D(){d=[],g=[],m=[],y=[],c=0,J()}function U(Oe,Ue,Xe,Ye){return d.push(Oe),g.push(Ue),m.push(Xe),y.push(Ye),++c-1}function G(Oe,Ue,Xe){for(var Ye=[],$e=0;$e<Oe.length;$e++)Ye[$e]=Oe[$e]*(1-Xe)+Xe*Ue[$e];return Ye}function $(Oe){v=Oe}function K(Oe,Ue){return Oe==="all"||Oe===null||Oe.indexOf(Ue)>-1}function re(Oe,Ue){return Oe===null?Ue:Oe}function ne(Oe,Ue,Xe){J();var Ye,$e,it,ot=[Ue],Et=[Xe];if(v>=1)ot=[Ue],Et=[Xe];else if(v>0){var mt=function(Ie,be){var Ae=Ie[0],Pe=Ie[1],ze=Ie[2],qe=function(st,It,jt){for(var Ut=[],zt=0;zt<st.length;zt++)Ut[zt]=(st[zt]+It[zt]+jt[zt])/3;return Ut}(Ae,Pe,ze),ht=Math.sqrt(1-v),at=G(qe,Ae,ht),nt=G(qe,Pe,ht),xt=G(qe,ze,ht),Lt=be[0],bt=be[1],St=be[2];return{xyzv:[[Ae,Pe,nt],[nt,at,Ae],[Pe,ze,xt],[xt,nt,Pe],[ze,Ae,at],[at,xt,ze]],abc:[[Lt,bt,-1],[-1,-1,Lt],[bt,St,-1],[-1,-1,bt],[St,Lt,-1],[-1,-1,St]]}}(Ue,Xe);ot=mt.xyzv,Et=mt.abc}for(var tt=0;tt<ot.length;tt++){Ue=ot[tt],Xe=Et[tt];for(var Ke=[],Mt=0;Mt<3;Mt++){var Jt=Ue[Mt][0],$t=Ue[Mt][1],je=Ue[Mt][2],Ge=Ue[Mt][3],Ct=Xe[Mt]>-1?Xe[Mt]:N(Jt,$t,je);Ke[Mt]=Ct>-1?Ct:U(Jt,$t,je,re(Oe,Ge))}Ye=Ke[0],$e=Ke[1],it=Ke[2],r._meshI.push(Ye),r._meshJ.push($e),r._meshK.push(it),++L}}function ae(Oe,Ue,Xe,Ye){var $e=Oe[3];$e<Xe&&($e=Xe),$e>Ye&&($e=Ye);for(var it=(Oe[3]-$e)/(Oe[3]-Ue[3]+1e-9),ot=[],Et=0;Et<4;Et++)ot[Et]=(1-it)*Oe[Et]+it*Ue[Et];return ot}function ie(Oe,Ue,Xe){return Oe>=Ue&&Oe<=Xe}function he(Oe){var Ue=.001*(Y-Z);return Oe>=Z-Ue&&Oe<=Y+Ue}function se(Oe){for(var Ue=[],Xe=0;Xe<4;Xe++){var Ye=Oe[Xe];Ue.push([r._x[Ye],r._y[Ye],r._z[Ye],r._value[Ye]])}return Ue}function de(Oe,Ue,Xe,Ye,$e,it){it||(it=1),Xe=[-1,-1,-1];var ot=!1,Et=[ie(Ue[0][3],Ye,$e),ie(Ue[1][3],Ye,$e),ie(Ue[2][3],Ye,$e)];if(!Et[0]&&!Et[1]&&!Et[2])return!1;var mt=function(Ke,Mt,Jt){return he(Mt[0][3])&&he(Mt[1][3])&&he(Mt[2][3])?(ne(Ke,Mt,Jt),!0):it<3&&de(Ke,Mt,Jt,Z,Y,++it)};if(Et[0]&&Et[1]&&Et[2])return mt(Oe,Ue,Xe)||ot;var tt=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(Ke){if(Et[Ke[0]]&&Et[Ke[1]]&&!Et[Ke[2]]){var Mt=Ue[Ke[0]],Jt=Ue[Ke[1]],$t=Ue[Ke[2]],je=ae($t,Mt,Ye,$e),Ge=ae($t,Jt,Ye,$e);ot=mt(Oe,[Ge,je,Mt],[-1,-1,Xe[Ke[0]]])||ot,ot=mt(Oe,[Mt,Jt,Ge],[Xe[Ke[0]],Xe[Ke[1]],-1])||ot,tt=!0}}),tt||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(Ke){if(Et[Ke[0]]&&!Et[Ke[1]]&&!Et[Ke[2]]){var Mt=Ue[Ke[0]],Jt=Ue[Ke[1]],$t=Ue[Ke[2]],je=ae(Jt,Mt,Ye,$e),Ge=ae($t,Mt,Ye,$e);ot=mt(Oe,[Ge,je,Mt],[-1,-1,Xe[Ke[0]]])||ot,tt=!0}}),ot}function ce(Oe,Ue,Xe,Ye){var $e=!1,it=se(Ue),ot=[ie(it[0][3],Xe,Ye),ie(it[1][3],Xe,Ye),ie(it[2][3],Xe,Ye),ie(it[3][3],Xe,Ye)];if(!(ot[0]||ot[1]||ot[2]||ot[3]))return $e;if(ot[0]&&ot[1]&&ot[2]&&ot[3])return b&&($e=function(mt,tt,Ke){var Mt=function(Jt,$t,je){ne(mt,[tt[Jt],tt[$t],tt[je]],[Ke[Jt],Ke[$t],Ke[je]])};Mt(0,1,2),Mt(3,0,1),Mt(2,3,0),Mt(1,2,3)}(Oe,it,Ue)||$e),$e;var Et=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(mt){if(ot[mt[0]]&&ot[mt[1]]&&ot[mt[2]]&&!ot[mt[3]]){var tt=it[mt[0]],Ke=it[mt[1]],Mt=it[mt[2]],Jt=it[mt[3]];if(b)$e=ne(Oe,[tt,Ke,Mt],[Ue[mt[0]],Ue[mt[1]],Ue[mt[2]]])||$e;else{var $t=ae(Jt,tt,Xe,Ye),je=ae(Jt,Ke,Xe,Ye),Ge=ae(Jt,Mt,Xe,Ye);$e=ne(null,[$t,je,Ge],[-1,-1,-1])||$e}Et=!0}}),Et||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(mt){if(ot[mt[0]]&&ot[mt[1]]&&!ot[mt[2]]&&!ot[mt[3]]){var tt=it[mt[0]],Ke=it[mt[1]],Mt=it[mt[2]],Jt=it[mt[3]],$t=ae(Mt,tt,Xe,Ye),je=ae(Mt,Ke,Xe,Ye),Ge=ae(Jt,Ke,Xe,Ye),Ct=ae(Jt,tt,Xe,Ye);b?($e=ne(Oe,[tt,Ct,$t],[Ue[mt[0]],-1,-1])||$e,$e=ne(Oe,[Ke,je,Ge],[Ue[mt[1]],-1,-1])||$e):$e=function(Ie,be,Ae){var Pe=function(ze,qe,ht){ne(Ie,[be[ze],be[qe],be[ht]],[Ae[ze],Ae[qe],Ae[ht]])};Pe(0,1,2),Pe(2,3,0)}(null,[$t,je,Ge,Ct],[-1,-1,-1,-1])||$e,Et=!0}}),Et||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(mt){if(ot[mt[0]]&&!ot[mt[1]]&&!ot[mt[2]]&&!ot[mt[3]]){var tt=it[mt[0]],Ke=it[mt[1]],Mt=it[mt[2]],Jt=it[mt[3]],$t=ae(Ke,tt,Xe,Ye),je=ae(Mt,tt,Xe,Ye),Ge=ae(Jt,tt,Xe,Ye);b?($e=ne(Oe,[tt,$t,je],[Ue[mt[0]],-1,-1])||$e,$e=ne(Oe,[tt,je,Ge],[Ue[mt[0]],-1,-1])||$e,$e=ne(Oe,[tt,Ge,$t],[Ue[mt[0]],-1,-1])||$e):$e=ne(null,[$t,je,Ge],[-1,-1,-1])||$e,Et=!0}})),$e}function ve(Oe,Ue,Xe,Ye,$e,it,ot,Et,mt,tt,Ke){var Mt=!1;return A&&(K(Oe,"A")&&(Mt=ce(null,[Ue,Xe,Ye,it],tt,Ke)||Mt),K(Oe,"B")&&(Mt=ce(null,[Xe,Ye,$e,mt],tt,Ke)||Mt),K(Oe,"C")&&(Mt=ce(null,[Xe,it,ot,mt],tt,Ke)||Mt),K(Oe,"D")&&(Mt=ce(null,[Ye,it,Et,mt],tt,Ke)||Mt),K(Oe,"E")&&(Mt=ce(null,[Xe,Ye,it,mt],tt,Ke)||Mt)),b&&(Mt=ce(Oe,[Xe,Ye,it,mt],tt,Ke)||Mt),Mt}function Ee(Oe,Ue,Xe,Ye,$e,it,ot,Et){return[Et[0]===!0||de(Oe,se([Ue,Xe,Ye]),[Ue,Xe,Ye],it,ot),Et[1]===!0||de(Oe,se([Ye,$e,Ue]),[Ye,$e,Ue],it,ot)]}function Le(Oe,Ue,Xe,Ye,$e,it,ot,Et,mt){return Et?Ee(Oe,Ue,Xe,$e,Ye,it,ot,mt):Ee(Oe,Xe,$e,Ye,Ue,it,ot,mt)}function Te(Oe,Ue,Xe,Ye,$e,it,ot){var Et,mt,tt,Ke,Mt=!1,Jt=function(){Mt=de(Oe,[Et,mt,tt],[-1,-1,-1],$e,it)||Mt,Mt=de(Oe,[tt,Ke,Et],[-1,-1,-1],$e,it)||Mt},$t=ot[0],je=ot[1],Ge=ot[2];return $t&&(Et=G(se([W(Ue,Xe-0,Ye-0)])[0],se([W(Ue-1,Xe-0,Ye-0)])[0],$t),mt=G(se([W(Ue,Xe-0,Ye-1)])[0],se([W(Ue-1,Xe-0,Ye-1)])[0],$t),tt=G(se([W(Ue,Xe-1,Ye-1)])[0],se([W(Ue-1,Xe-1,Ye-1)])[0],$t),Ke=G(se([W(Ue,Xe-1,Ye-0)])[0],se([W(Ue-1,Xe-1,Ye-0)])[0],$t),Jt()),je&&(Et=G(se([W(Ue-0,Xe,Ye-0)])[0],se([W(Ue-0,Xe-1,Ye-0)])[0],je),mt=G(se([W(Ue-0,Xe,Ye-1)])[0],se([W(Ue-0,Xe-1,Ye-1)])[0],je),tt=G(se([W(Ue-1,Xe,Ye-1)])[0],se([W(Ue-1,Xe-1,Ye-1)])[0],je),Ke=G(se([W(Ue-1,Xe,Ye-0)])[0],se([W(Ue-1,Xe-1,Ye-0)])[0],je),Jt()),Ge&&(Et=G(se([W(Ue-0,Xe-0,Ye)])[0],se([W(Ue-0,Xe-0,Ye-1)])[0],Ge),mt=G(se([W(Ue-0,Xe-1,Ye)])[0],se([W(Ue-0,Xe-1,Ye-1)])[0],Ge),tt=G(se([W(Ue-1,Xe-1,Ye)])[0],se([W(Ue-1,Xe-1,Ye-1)])[0],Ge),Ke=G(se([W(Ue-1,Xe-0,Ye)])[0],se([W(Ue-1,Xe-0,Ye-1)])[0],Ge),Jt()),Mt}function xe(Oe,Ue,Xe,Ye,$e,it,ot,Et,mt,tt,Ke,Mt){var Jt=Oe;return Mt?(A&&Oe==="even"&&(Jt=null),ve(Jt,Ue,Xe,Ye,$e,it,ot,Et,mt,tt,Ke)):(A&&Oe==="odd"&&(Jt=null),ve(Jt,mt,Et,ot,it,$e,Ye,Xe,Ue,tt,Ke))}function fe(Oe,Ue,Xe,Ye,$e){for(var it=[],ot=0,Et=0;Et<Ue.length;Et++)for(var mt=Ue[Et],tt=1;tt<F;tt++)for(var Ke=1;Ke<z;Ke++)it.push(Le(Oe,W(mt,Ke-1,tt-1),W(mt,Ke-1,tt),W(mt,Ke,tt-1),W(mt,Ke,tt),Xe,Ye,(mt+Ke+tt)%2,$e&&$e[ot]?$e[ot]:[])),ot++;return it}function ge(Oe,Ue,Xe,Ye,$e){for(var it=[],ot=0,Et=0;Et<Ue.length;Et++)for(var mt=Ue[Et],tt=1;tt<P;tt++)for(var Ke=1;Ke<F;Ke++)it.push(Le(Oe,W(tt-1,mt,Ke-1),W(tt,mt,Ke-1),W(tt-1,mt,Ke),W(tt,mt,Ke),Xe,Ye,(tt+mt+Ke)%2,$e&&$e[ot]?$e[ot]:[])),ot++;return it}function ke(Oe,Ue,Xe,Ye,$e){for(var it=[],ot=0,Et=0;Et<Ue.length;Et++)for(var mt=Ue[Et],tt=1;tt<z;tt++)for(var Ke=1;Ke<P;Ke++)it.push(Le(Oe,W(Ke-1,tt-1,mt),W(Ke-1,tt,mt),W(Ke,tt-1,mt),W(Ke,tt,mt),Xe,Ye,(Ke+tt+mt)%2,$e&&$e[ot]?$e[ot]:[])),ot++;return it}function Me(Oe,Ue,Xe){for(var Ye=1;Ye<F;Ye++)for(var $e=1;$e<z;$e++)for(var it=1;it<P;it++)xe(Oe,W(it-1,$e-1,Ye-1),W(it-1,$e-1,Ye),W(it-1,$e,Ye-1),W(it-1,$e,Ye),W(it,$e-1,Ye-1),W(it,$e-1,Ye),W(it,$e,Ye-1),W(it,$e,Ye),Ue,Xe,(it+$e+Ye)%2)}function Se(Oe,Ue,Xe){A=!0,Me(Oe,Ue,Xe),A=!1}function De(Oe,Ue,Xe,Ye,$e,it){for(var ot=[],Et=0,mt=0;mt<Ue.length;mt++)for(var tt=Ue[mt],Ke=1;Ke<F;Ke++)for(var Mt=1;Mt<z;Mt++)ot.push(Te(Oe,tt,Mt,Ke,Xe,Ye,$e[mt],it&&it[Et]&&it[Et])),Et++;return ot}function Be(Oe,Ue,Xe,Ye,$e,it){for(var ot=[],Et=0,mt=0;mt<Ue.length;mt++)for(var tt=Ue[mt],Ke=1;Ke<P;Ke++)for(var Mt=1;Mt<F;Mt++)ot.push(Te(Oe,Ke,tt,Mt,Xe,Ye,$e[mt],it&&it[Et]&&it[Et])),Et++;return ot}function We(Oe,Ue,Xe,Ye,$e,it){for(var ot=[],Et=0,mt=0;mt<Ue.length;mt++)for(var tt=Ue[mt],Ke=1;Ke<z;Ke++)for(var Mt=1;Mt<P;Mt++)ot.push(Te(Oe,Mt,Ke,tt,Xe,Ye,$e[mt],it&&it[Et]&&it[Et])),Et++;return ot}function Qe(Oe,Ue){for(var Xe=[],Ye=Oe;Ye<Ue;Ye++)Xe.push(Ye);return Xe}return function(){if(D(),function(){for(var Et=0;Et<P;Et++)for(var mt=0;mt<z;mt++)for(var tt=0;tt<F;tt++){var Ke=W(Et,mt,tt);U(r._x[Ke],r._y[Ke],r._z[Ke],r._value[Ke])}}(),_&&E&&($(E),b=!0,Me(null,Z,Y),b=!1),T&&k){$(k);for(var Oe=r.surface.pattern,Ue=r.surface.count,Xe=0;Xe<Ue;Xe++){var Ye=Ue===1?.5:Xe/(Ue-1),$e=(1-Ye)*Z+Ye*Y,it=Math.abs($e-X)>Math.abs($e-Q)?[X,$e]:[$e,Q];Se(Oe,it[0],it[1])}}var ot=[[Math.min(Z,Q),Math.max(Z,Q)],[Math.min(X,Y),Math.max(X,Y)]];["x","y","z"].forEach(function(Et){for(var mt=[],tt=0;tt<ot.length;tt++){var Ke=0,Mt=ot[tt][0],Jt=ot[tt][1],$t=r.slices[Et];if($t.show&&$t.fill){$($t.fill);var je=[],Ge=[],Ct=[];if($t.locations.length)for(var Ie=0;Ie<$t.locations.length;Ie++){var be=l($t.locations[Ie],Et==="x"?w:Et==="y"?C:S);be.distRatio===0?je.push(be.id):be.id>0&&(Ge.push(be.id),Et==="x"?Ct.push([be.distRatio,0,0]):Et==="y"?Ct.push([0,be.distRatio,0]):Ct.push([0,0,be.distRatio]))}else je=Qe(1,Et==="x"?P-1:Et==="y"?z-1:F-1);Ge.length>0&&(mt[Ke]=Et==="x"?De(null,Ge,Mt,Jt,Ct,mt[Ke]):Et==="y"?Be(null,Ge,Mt,Jt,Ct,mt[Ke]):We(null,Ge,Mt,Jt,Ct,mt[Ke]),Ke++),je.length>0&&(mt[Ke]=Et==="x"?fe(null,je,Mt,Jt,mt[Ke]):Et==="y"?ge(null,je,Mt,Jt,mt[Ke]):ke(null,je,Mt,Jt,mt[Ke]),Ke++)}var Ae=r.caps[Et];Ae.show&&Ae.fill&&($(Ae.fill),mt[Ke]=Et==="x"?fe(null,[0,P-1],Mt,Jt,mt[Ke]):Et==="y"?ge(null,[0,z-1],Mt,Jt,mt[Ke]):ke(null,[0,F-1],Mt,Jt,mt[Ke]),Ke++)}}),L===0&&D(),r._meshX=d,r._meshY=g,r._meshZ=m,r._meshIntensity=y,r._Xs=w,r._Ys=C,r._Zs=S}(),r}B.exports={findNearestOnAxis:l,generateIsoMeshes:s,createIsosurfaceTrace:function(r,c){var f=r.glplot.gl,d=t({gl:f}),g=new o(r,d,c.uid);return d._trace=g,g.update(c),r.glplot.add(d),g}}},{"../../components/colorscale":678,"../../lib/gl_format_color":799,"../../lib/str2rgbarray":828,"../../plots/gl3d/zip3":907,"gl-mesh3d":315}],1157:[function(i,B,V){var t=i("../../lib"),h=i("../../registry"),p=i("./attributes"),u=i("../../components/colorscale/defaults");function e(l,o,a,n,s){var r=s("isomin"),c=s("isomax");c!=null&&r!=null&&r>c&&(o.isomin=null,o.isomax=null);var f=s("x"),d=s("y"),g=s("z"),m=s("value");f&&f.length&&d&&d.length&&g&&g.length&&m&&m.length?(h.getComponentMethod("calendars","handleTraceDefaults")(l,o,["x","y","z"],n),s("valuehoverformat"),["x","y","z"].forEach(function(y){s(y+"hoverformat");var v="caps."+y;s(v+".show")&&s(v+".fill");var T="slices."+y;s(T+".show")&&(s(T+".fill"),s(T+".locations"))}),s("spaceframe.show")&&s("spaceframe.fill"),s("surface.show")&&(s("surface.count"),s("surface.fill"),s("surface.pattern")),s("contour.show")&&(s("contour.color"),s("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(y){s(y)}),u(l,o,n,s,{prefix:"",cLetter:"c"}),o._length=null):o.visible=!1}B.exports={supplyDefaults:function(l,o,a,n){e(l,o,a,n,function(s,r){return t.coerce(l,o,p,s,r)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":676,"../../lib":803,"../../registry":931,"./attributes":1154}],1158:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults").supplyDefaults,calc:i("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:i("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:i("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":896,"./attributes":1154,"./calc":1155,"./convert":1156,"./defaults":1157}],1159:[function(i,B,V){var t=i("../../components/colorscale/attributes"),h=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=i("../../plots/template_attributes").hovertemplateAttrs,u=i("../surface/attributes"),e=i("../../plots/attributes"),l=i("../../lib/extend").extendFlat;B.exports=l({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:p({editType:"calc"}),xhoverformat:h("x"),yhoverformat:h("y"),zhoverformat:h("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},t("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:u.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:l({},u.contours.x.show,{}),color:u.contours.x.color,width:u.contours.x.width,editType:"calc"},lightposition:{x:l({},u.lightposition.x,{dflt:1e5}),y:l({},u.lightposition.y,{dflt:1e5}),z:l({},u.lightposition.z,{dflt:0}),editType:"calc"},lighting:l({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},u.lighting),hoverinfo:l({},e.hoverinfo,{editType:"calc"}),showlegend:l({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../surface/attributes":1342}],1160:[function(i,B,V){var t=i("../../components/colorscale/calc");B.exports=function(h,p){p.intensity&&t(h,p,{vals:p.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":674}],1161:[function(i,B,V){var t=i("gl-mesh3d"),h=i("delaunay-triangulate"),p=i("alpha-shape"),u=i("convex-hull"),e=i("../../lib/gl_format_color").parseColorScale,l=i("../../lib/str2rgbarray"),o=i("../../components/colorscale").extractOpts,a=i("../../plots/gl3d/zip3");function n(g,m,y){this.scene=g,this.uid=y,this.mesh=m,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var s=n.prototype;function r(g){for(var m=[],y=g.length,v=0;v<y;v++)m[v]=l(g[v]);return m}function c(g,m,y,v){for(var T=[],_=m.length,k=0;k<_;k++)T[k]=g.d2l(m[k],0,v)*y;return T}function f(g){for(var m=[],y=g.length,v=0;v<y;v++)m[v]=Math.round(g[v]);return m}function d(g,m){for(var y=g.length,v=0;v<y;v++)if(g[v]<=-.5||g[v]>=m-.5)return!1;return!0}s.handlePick=function(g){if(g.object===this.mesh){var m=g.index=g.data.index;g.data._cellCenter?g.traceCoordinate=g.data.dataCoordinate:g.traceCoordinate=[this.data.x[m],this.data.y[m],this.data.z[m]];var y=this.data.hovertext||this.data.text;return Array.isArray(y)&&y[m]!==void 0?g.textLabel=y[m]:y&&(g.textLabel=y),!0}},s.update=function(g){var m=this.scene,y=m.fullSceneLayout;this.data=g;var v,T=g.x.length,_=a(c(y.xaxis,g.x,m.dataScale[0],g.xcalendar),c(y.yaxis,g.y,m.dataScale[1],g.ycalendar),c(y.zaxis,g.z,m.dataScale[2],g.zcalendar));if(g.i&&g.j&&g.k){if(g.i.length!==g.j.length||g.j.length!==g.k.length||!d(g.i,T)||!d(g.j,T)||!d(g.k,T))return;v=a(f(g.i),f(g.j),f(g.k))}else v=g.alphahull===0?u(_):g.alphahull>0?p(g.alphahull,_):function(b,L){for(var w=["x","y","z"].indexOf(b),C=[],S=L.length,P=0;P<S;P++)C[P]=[L[P][(w+1)%3],L[P][(w+2)%3]];return h(C)}(g.delaunayaxis,_);var k={positions:_,cells:v,lightPosition:[g.lightposition.x,g.lightposition.y,g.lightposition.z],ambient:g.lighting.ambient,diffuse:g.lighting.diffuse,specular:g.lighting.specular,roughness:g.lighting.roughness,fresnel:g.lighting.fresnel,vertexNormalsEpsilon:g.lighting.vertexnormalsepsilon,faceNormalsEpsilon:g.lighting.facenormalsepsilon,opacity:g.opacity,contourEnable:g.contour.show,contourColor:l(g.contour.color).slice(0,3),contourWidth:g.contour.width,useFacetNormals:g.flatshading};if(g.intensity){var E=o(g);this.color="#fff";var A=g.intensitymode;k[A+"Intensity"]=g.intensity,k[A+"IntensityBounds"]=[E.min,E.max],k.colormap=e(g)}else g.vertexcolor?(this.color=g.vertexcolor[0],k.vertexColors=r(g.vertexcolor)):g.facecolor?(this.color=g.facecolor[0],k.cellColors=r(g.facecolor)):(this.color=g.color,k.meshColor=l(g.color));this.mesh.update(k)},s.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},B.exports=function(g,m){var y=g.glplot.gl,v=t({gl:y}),T=new n(g,v,m.uid);return v._trace=T,T.update(m),g.glplot.add(v),T}},{"../../components/colorscale":678,"../../lib/gl_format_color":799,"../../lib/str2rgbarray":828,"../../plots/gl3d/zip3":907,"alpha-shape":75,"convex-hull":141,"delaunay-triangulate":180,"gl-mesh3d":315}],1162:[function(i,B,V){var t=i("../../registry"),h=i("../../lib"),p=i("../../components/colorscale/defaults"),u=i("./attributes");B.exports=function(e,l,o,a){function n(r,c){return h.coerce(e,l,u,r,c)}function s(r){var c=r.map(function(f){var d=n(f);return d&&h.isArrayOrTypedArray(d)?d:null});return c.every(function(f){return f&&f.length===c[0].length})&&c}s(["x","y","z"])?(s(["i","j","k"]),(!l.i||l.j&&l.k)&&(!l.j||l.k&&l.i)&&(!l.k||l.i&&l.j)?(t.getComponentMethod("calendars","handleTraceDefaults")(e,l,["x","y","z"],a),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(r){n(r)}),n("contour.show")&&(n("contour.color"),n("contour.width")),"intensity"in e?(n("intensity"),n("intensitymode"),p(e,l,a,n,{prefix:"",cLetter:"c"})):(l.showscale=!1,"facecolor"in e?n("facecolor"):"vertexcolor"in e?n("vertexcolor"):n("color",o)),n("text"),n("hovertext"),n("hovertemplate"),n("xhoverformat"),n("yhoverformat"),n("zhoverformat"),l._length=null):l.visible=!1):l.visible=!1}},{"../../components/colorscale/defaults":676,"../../lib":803,"../../registry":931,"./attributes":1159}],1163:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:i("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:i("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":896,"./attributes":1159,"./calc":1160,"./convert":1161,"./defaults":1162}],1164:[function(i,B,V){var t=i("../../lib").extendFlat,h=i("../scatter/attributes"),p=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,u=i("../../components/drawing/attributes").dash,e=i("../../components/fx/attributes"),l=i("../../constants/delta.js"),o=l.INCREASING.COLOR,a=l.DECREASING.COLOR,n=h.line;function s(r){return{line:{color:t({},n.color,{dflt:r}),width:n.width,dash:u,editType:"style"},editType:"style"}}B.exports={xperiod:h.xperiod,xperiod0:h.xperiod0,xperiodalignment:h.xperiodalignment,xhoverformat:p("x"),yhoverformat:p("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:t({},n.width,{}),dash:t({},u,{}),editType:"style"},increasing:s(o),decreasing:s(a),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:t({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":687,"../../components/fx/attributes":697,"../../constants/delta.js":773,"../../lib":803,"../../plots/cartesian/axis_format_attributes":857,"../scatter/attributes":1218}],1165:[function(i,B,V){var t=i("../../lib"),h=t._,p=i("../../plots/cartesian/axes"),u=i("../../plots/cartesian/align_period"),e=i("../../constants/numerical").BADNUM;function l(a,n,s,r){return{o:a,h:n,l:s,c:r}}function o(a,n,s,r,c,f){for(var d=c.makeCalcdata(n,"open"),g=c.makeCalcdata(n,"high"),m=c.makeCalcdata(n,"low"),y=c.makeCalcdata(n,"close"),v=Array.isArray(n.text),T=Array.isArray(n.hovertext),_=!0,k=null,E=!!n.xperiodalignment,A=[],b=0;b<r.length;b++){var L=r[b],w=d[b],C=g[b],S=m[b],P=y[b];if(L!==e&&w!==e&&C!==e&&S!==e&&P!==e){P===w?k!==null&&P!==k&&(_=P>k):_=P>w,k=P;var z=f(w,C,S,P);z.pos=L,z.yc=(w+P)/2,z.i=b,z.dir=_?"increasing":"decreasing",z.x=z.pos,z.y=[S,C],E&&(z.orig_p=s[b]),v&&(z.tx=n.text[b]),T&&(z.htx=n.hovertext[b]),A.push(z)}else A.push({pos:L,empty:!0})}return n._extremes[c._id]=p.findExtremes(c,t.concat(m,g),{padded:!0}),A.length&&(A[0].t={labels:{open:h(a,"open:")+" ",high:h(a,"high:")+" ",low:h(a,"low:")+" ",close:h(a,"close:")+" "}}),A}B.exports={calc:function(a,n){var s=p.getFromId(a,n.xaxis),r=p.getFromId(a,n.yaxis),c=function(y,v,T){var _=T._minDiff;if(!_){var k,E=y._fullData,A=[];for(_=1/0,k=0;k<E.length;k++){var b=E[k];if(b.type==="ohlc"&&b.visible===!0&&b.xaxis===v._id){A.push(b);var L=v.makeCalcdata(b,"x");b._origX=L;var w=u(T,v,"x",L).vals;b._xcalc=w;var C=t.distinctVals(w).minDiff;C&&isFinite(C)&&(_=Math.min(_,C))}}for(_===1/0&&(_=1),k=0;k<A.length;k++)A[k]._minDiff=_}return _*T.tickwidth}(a,s,n),f=n._minDiff;n._minDiff=null;var d=n._origX;n._origX=null;var g=n._xcalc;n._xcalc=null;var m=o(a,n,d,g,r,l);return n._extremes[s._id]=p.findExtremes(s,g,{vpad:f/2}),m.length?(t.extendFlat(m[0].t,{wHover:f/2,tickLen:c}),m):[{t:{empty:!0}}]},calcCommon:o}},{"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/align_period":851,"../../plots/cartesian/axes":854}],1166:[function(i,B,V){var t=i("../../lib"),h=i("./ohlc_defaults"),p=i("../scatter/period_defaults"),u=i("./attributes");function e(l,o,a,n){a(n+".line.color"),a(n+".line.width",o.line.width),a(n+".line.dash",o.line.dash)}B.exports=function(l,o,a,n){function s(r,c){return t.coerce(l,o,u,r,c)}h(l,o,s,n)?(p(l,o,n,s,{x:!0}),s("xhoverformat"),s("yhoverformat"),s("line.width"),s("line.dash"),e(l,o,s,"increasing"),e(l,o,s,"decreasing"),s("text"),s("hovertext"),s("tickwidth"),n._requestRangeslider[o.xaxis]=!0):o.visible=!1}},{"../../lib":803,"../scatter/period_defaults":1238,"./attributes":1164,"./ohlc_defaults":1169}],1167:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../../lib"),p=i("../../components/fx"),u=i("../../components/color"),e=i("../../lib").fillText,l=i("../../constants/delta.js"),o={increasing:l.INCREASING.SYMBOL,decreasing:l.DECREASING.SYMBOL};function a(r,c,f,d){var g,m,y=r.cd,v=r.xa,T=y[0].trace,_=y[0].t,k=T.type,E=k==="ohlc"?"l":"min",A=k==="ohlc"?"h":"max",b=_.bPos||0,L=_.bdPos||_.tickLen,w=_.wHover,C=Math.min(1,L/Math.abs(v.r2c(v.range[1])-v.r2c(v.range[0])));function S(Q){var Z=function(Y){return Y.pos+b-c}(Q);return p.inbox(Z-w,Z+w,g)}function P(Q){var Z=Q[E],Y=Q[A];return Z===Y||p.inbox(Z-f,Y-f,g)}function z(Q){return(S(Q)+P(Q))/2}g=r.maxHoverDistance-C,m=r.maxSpikeDistance-C;var F=p.getDistanceFunction(d,S,P,z);if(p.getClosest(y,F,r),r.index===!1)return null;var q=y[r.index];if(q.empty)return null;var W=T[q.dir],X=W.line.color;return u.opacity(X)&&W.line.width?r.color=X:r.color=W.fillcolor,r.x0=v.c2p(q.pos+b-L,!0),r.x1=v.c2p(q.pos+b+L,!0),r.xLabelVal=q.orig_p!==void 0?q.orig_p:q.pos,r.spikeDistance=z(q)*m/g,r.xSpike=v.c2p(q.pos,!0),r}function n(r,c,f,d){var g=r.cd,m=r.ya,y=g[0].trace,v=g[0].t,T=[],_=a(r,c,f,d);if(!_)return[];var k=g[_.index].hi||y.hoverinfo,E=k.split("+");if(!(k==="all"||E.indexOf("y")!==-1))return[];for(var A=["high","open","close","low"],b={},L=0;L<A.length;L++){var w,C=A[L],S=y[C][_.index],P=m.c2p(S,!0);S in b?(w=b[S]).yLabel+="<br>"+v.labels[C]+t.hoverLabelText(m,S,y.yhoverformat):((w=h.extendFlat({},_)).y0=w.y1=P,w.yLabelVal=S,w.yLabel=v.labels[C]+t.hoverLabelText(m,S,y.yhoverformat),w.name="",T.push(w),b[S]=w)}return T}function s(r,c,f,d){var g=r.cd,m=r.ya,y=g[0].trace,v=g[0].t,T=a(r,c,f,d);if(!T)return[];var _=g[T.index],k=T.index=_.i,E=_.dir;function A(z){return v.labels[z]+t.hoverLabelText(m,y[z][k],y.yhoverformat)}var b=_.hi||y.hoverinfo,L=b.split("+"),w=b==="all",C=w||L.indexOf("y")!==-1,S=w||L.indexOf("text")!==-1,P=C?[A("open"),A("high"),A("low"),A("close")+"  "+o[E]]:[];return S&&e(_,y,P),T.extraText=P.join("<br>"),T.y0=T.y1=m.c2p(_.yc,!0),[T]}B.exports={hoverPoints:function(r,c,f,d){return r.cd[0].trace.hoverlabel.split?n(r,c,f,d):s(r,c,f,d)},hoverSplit:n,hoverOnPoints:s}},{"../../components/color":666,"../../components/fx":706,"../../constants/delta.js":773,"../../lib":803,"../../plots/cartesian/axes":854}],1168:[function(i,B,V){B.exports={moduleType:"trace",name:"ohlc",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("./calc").calc,plot:i("./plot"),style:i("./style"),hoverPoints:i("./hover").hoverPoints,selectPoints:i("./select")}},{"../../plots/cartesian":868,"./attributes":1164,"./calc":1165,"./defaults":1166,"./hover":1167,"./plot":1170,"./select":1171,"./style":1172}],1169:[function(i,B,V){var t=i("../../registry"),h=i("../../lib");B.exports=function(p,u,e,l){var o=e("x"),a=e("open"),n=e("high"),s=e("low"),r=e("close");if(e("hoverlabel.split"),t.getComponentMethod("calendars","handleTraceDefaults")(p,u,["x"],l),a&&n&&s&&r){var c=Math.min(a.length,n.length,s.length,r.length);return o&&(c=Math.min(c,h.minRowLength(o))),u._length=c,c}}},{"../../lib":803,"../../registry":931}],1170:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib");B.exports=function(p,u,e,l){var o=u.yaxis,a=u.xaxis,n=!!a.rangebreaks;h.makeTraceGroups(l,e,"trace ohlc").each(function(s){var r=t.select(this),c=s[0],f=c.t;if(c.trace.visible!==!0||f.empty)r.remove();else{var d=f.tickLen,g=r.selectAll("path").data(h.identity);g.enter().append("path"),g.exit().remove(),g.attr("d",function(m){if(m.empty)return"M0,0Z";var y=a.c2p(m.pos-d,!0),v=a.c2p(m.pos+d,!0),T=n?(y+v)/2:a.c2p(m.pos,!0);return"M"+y+","+o.c2p(m.o,!0)+"H"+T+"M"+T+","+o.c2p(m.h,!0)+"V"+o.c2p(m.l,!0)+"M"+v+","+o.c2p(m.c,!0)+"H"+T})}})}},{"../../lib":803,"@plotly/d3":58}],1171:[function(i,B,V){B.exports=function(t,h){var p,u=t.cd,e=t.xaxis,l=t.yaxis,o=[],a=u[0].t.bPos||0;if(h===!1)for(p=0;p<u.length;p++)u[p].selected=0;else for(p=0;p<u.length;p++){var n=u[p];h.contains([e.c2p(n.pos+a),l.c2p(n.yc)],null,n.i,t)?(o.push({pointNumber:n.i,x:e.c2d(n.pos),y:l.c2d(n.yc)}),n.selected=1):n.selected=0}return o}},{}],1172:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/drawing"),p=i("../../components/color");B.exports=function(u,e,l){var o=l||t.select(u).selectAll("g.ohlclayer").selectAll("g.trace");o.style("opacity",function(a){return a[0].trace.opacity}),o.each(function(a){var n=a[0].trace;t.select(this).selectAll("path").each(function(s){if(!s.empty){var r=n[s.dir].line;t.select(this).style("fill","none").call(p.stroke,r.color).call(h.dashLine,r.dash,r.width).style("opacity",n.selectedpoints&&!s.selected?.3:1)}})})}},{"../../components/color":666,"../../components/drawing":688,"@plotly/d3":58}],1173:[function(i,B,V){var t=i("../../lib/extend").extendFlat,h=i("../../plots/attributes"),p=i("../../plots/font_attributes"),u=i("../../components/colorscale/attributes"),e=i("../../plots/template_attributes").hovertemplateAttrs,l=i("../../plots/domain").attributes,o=t({editType:"calc"},u("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});B.exports={domain:l({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:t({},h.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:p({editType:"calc"}),tickfont:p({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:o,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/domain":882,"../../plots/font_attributes":883,"../../plots/template_attributes":926}],1174:[function(i,B,V){var t=i("../../plots/get_data").getModuleCalcData,h=i("./plot");V.name="parcats",V.plot=function(p,u,e,l){var o=t(p.calcdata,"parcats");if(o.length){var a=o[0];h(p,a,e,l)}},V.clean=function(p,u,e,l){var o=l._has&&l._has("parcats"),a=u._has&&u._has("parcats");o&&!a&&l._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":891,"./plot":1179}],1175:[function(i,B,V){var t=i("../../lib/gup").wrap,h=i("../../components/colorscale/helpers").hasColorscale,p=i("../../components/colorscale/calc"),u=i("../../lib/filter_unique.js"),e=i("../../components/drawing"),l=i("../../lib"),o=i("fast-isnumeric");function a(r,c,f){r.valueInds.push(c),r.count+=f}function n(r,c,f){return{categoryInds:r,color:c,rawColor:f,valueInds:[],count:0}}function s(r,c,f){r.valueInds.push(c),r.count+=f}B.exports=function(r,c){var f=l.filterVisible(c.dimensions);if(f.length===0)return[];var d,g,m,y=f.map(function(N){var J;if(N.categoryorder==="trace")J=null;else if(N.categoryorder==="array")J=N.categoryarray;else{J=u(N.values);for(var D=!0,U=0;U<J.length;U++)if(!o(J[U])){D=!1;break}J.sort(D?l.sorterAsc:void 0),N.categoryorder==="category descending"&&(J=J.reverse())}return function(G,$){$=$==null?[]:$.map(function(de){return de});var K={},re={},ne=[];$.forEach(function(de,ce){K[de]=0,re[de]=ce});for(var ae=0;ae<G.length;ae++){var ie,he=G[ae];K[he]===void 0?(K[he]=1,ie=$.push(he)-1,re[he]=ie):(K[he]++,ie=re[he]),ne.push(ie)}var se=$.map(function(de){return K[de]});return{uniqueValues:$,uniqueCounts:se,inds:ne}}(N.values,J)});d=l.isArrayOrTypedArray(c.counts)?c.counts:[c.counts],function(N){var J;if(function(D){for(var U=new Array(D.length),G=0;G<D.length;G++){if(D[G]<0||D[G]>=D.length||U[D[G]]!==void 0)return!1;U[D[G]]=!0}return!0}(N.map(function(D){return D.displayindex})))for(J=0;J<N.length;J++)N[J]._displayindex=N[J].displayindex;else for(J=0;J<N.length;J++)N[J]._displayindex=J}(f),f.forEach(function(N,J){(function(D,U){D._categoryarray=U.uniqueValues,D.ticktext===null||D.ticktext===void 0?D._ticktext=[]:D._ticktext=D.ticktext.slice();for(var G=D._ticktext.length;G<U.uniqueValues.length;G++)D._ticktext.push(U.uniqueValues[G])})(N,y[J])});var v,T=c.line;T?(h(c,"line")&&p(r,c,{vals:c.line.color,containerStr:"line",cLetter:"c"}),v=e.tryColorscale(T)):v=l.identity;var _,k,E,A,b,L=f[0].values.length,w={},C=y.map(function(N){return N.inds});for(m=0,_=0;_<L;_++){var S=[];for(k=0;k<C.length;k++)S.push(C[k][_]);g=d[_%d.length],m+=g;var P=(E=_,A=void 0,b=void 0,l.isArrayOrTypedArray(T.color)?b=A=T.color[E%T.color.length]:A=T.color,{color:v(A),rawColor:b}),z=S+"-"+P.rawColor;w[z]===void 0&&(w[z]=n(S,P.color,P.rawColor)),s(w[z],_,g)}var F,q=f.map(function(N,J){return function(D,U,G,$,K){return{dimensionInd:D,containerInd:U,displayInd:G,dimensionLabel:$,count:K,categories:[],dragX:null}}(J,N._index,N._displayindex,N.label,m)});for(_=0;_<L;_++)for(g=d[_%d.length],k=0;k<q.length;k++){var W=q[k].containerInd,X=y[k].inds[_],Q=q[k].categories;if(Q[X]===void 0){var Z=c.dimensions[W]._categoryarray[X],Y=c.dimensions[W]._ticktext[X];Q[X]={dimensionInd:k,categoryInd:F=X,categoryValue:Z,displayInd:F,categoryLabel:Y,valueInds:[],count:0,dragY:null}}a(Q[X],_,g)}return t(function(N,J,D){var U=N.map(function(G){return G.categories.length}).reduce(function(G,$){return Math.max(G,$)});return{dimensions:N,paths:J,trace:void 0,maxCats:U,count:D}}(q,w,m))}},{"../../components/colorscale/calc":674,"../../components/colorscale/helpers":677,"../../components/drawing":688,"../../lib":803,"../../lib/filter_unique.js":794,"../../lib/gup":800,"fast-isnumeric":249}],1176:[function(i,B,V){var t=i("../../lib"),h=i("../../components/colorscale/helpers").hasColorscale,p=i("../../components/colorscale/defaults"),u=i("../../plots/domain").defaults,e=i("../../plots/array_container_defaults"),l=i("./attributes"),o=i("../parcoords/merge_length");function a(n,s){function r(v,T){return t.coerce(n,s,l.dimensions,v,T)}var c=r("values"),f=r("visible");if(c&&c.length||(f=s.visible=!1),f){r("label"),r("displayindex",s._index);var d,g=n.categoryarray,m=Array.isArray(g)&&g.length>0;m&&(d="array");var y=r("categoryorder",d);y==="array"?(r("categoryarray"),r("ticktext")):(delete n.categoryarray,delete n.ticktext),m||y!=="array"||(s.categoryorder="trace")}}B.exports=function(n,s,r,c){function f(v,T){return t.coerce(n,s,l,v,T)}var d=e(n,s,{name:"dimensions",handleItemDefaults:a}),g=function(v,T,_,k,E){E("line.shape"),E("line.hovertemplate");var A=E("line.color",k.colorway[0]);if(h(v,"line")&&t.isArrayOrTypedArray(A)){if(A.length)return E("line.colorscale"),p(v,T,k,E,{prefix:"line.",cLetter:"c"}),A.length;T.line.color=_}return 1/0}(n,s,r,c,f);u(s,c,f),Array.isArray(d)&&d.length||(s.visible=!1),o(s,d,"values",g),f("hoveron"),f("hovertemplate"),f("arrangement"),f("bundlecolors"),f("sortpaths"),f("counts");var m={family:c.font.family,size:Math.round(c.font.size),color:c.font.color};t.coerceFont(f,"labelfont",m);var y={family:c.font.family,size:Math.round(c.font.size/1.2),color:c.font.color};t.coerceFont(f,"tickfont",y)}},{"../../components/colorscale/defaults":676,"../../components/colorscale/helpers":677,"../../lib":803,"../../plots/array_container_defaults":849,"../../plots/domain":882,"../parcoords/merge_length":1189,"./attributes":1173}],1177:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("./calc"),plot:i("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:i("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1173,"./base_plot":1174,"./calc":1175,"./defaults":1176,"./plot":1179}],1178:[function(i,B,V){var t=i("@plotly/d3"),h=i("d3-interpolate").interpolateNumber,p=i("../../plot_api/plot_api"),u=i("../../components/fx"),e=i("../../lib"),l=e.strTranslate,o=i("../../components/drawing"),a=i("tinycolor2"),n=i("../../lib/svg_text_utils");function s(D,U,G,$){var K=D.map(Q.bind(0,U,G)),re=$.selectAll("g.parcatslayer").data([null]);re.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var ne=re.selectAll("g.trace.parcats").data(K,r),ae=ne.enter().append("g").attr("class","trace parcats");ne.attr("transform",function(Te){return l(Te.x,Te.y)}),ae.append("g").attr("class","paths");var ie=ne.select("g.paths").selectAll("path.path").data(function(Te){return Te.paths},r);ie.attr("fill",function(Te){return Te.model.color});var he=ie.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(Te){return Te.model.color}).attr("fill-opacity",0);T(he),ie.attr("d",function(Te){return Te.svgD}),he.empty()||ie.sort(f),ie.exit().remove(),ie.on("mouseover",d).on("mouseout",g).on("click",v),ae.append("g").attr("class","dimensions");var se=ne.select("g.dimensions").selectAll("g.dimension").data(function(Te){return Te.dimensions},r);se.enter().append("g").attr("class","dimension"),se.attr("transform",function(Te){return l(Te.x,0)}),se.exit().remove();var de=se.selectAll("g.category").data(function(Te){return Te.categories},r),ce=de.enter().append("g").attr("class","category");de.attr("transform",function(Te){return l(0,Te.y)}),ce.append("rect").attr("class","catrect").attr("pointer-events","none"),de.select("rect.catrect").attr("fill","none").attr("width",function(Te){return Te.width}).attr("height",function(Te){return Te.height}),k(ce);var ve=de.selectAll("rect.bandrect").data(function(Te){return Te.bands},r);ve.each(function(){e.raiseToTop(this)}),ve.attr("fill",function(Te){return Te.color});var Ee=ve.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(Te){return Te.color}).attr("fill-opacity",0);ve.attr("fill",function(Te){return Te.color}).attr("width",function(Te){return Te.width}).attr("height",function(Te){return Te.height}).attr("y",function(Te){return Te.y}).attr("cursor",function(Te){return Te.parcatsViewModel.arrangement==="fixed"?"default":Te.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),E(Ee),ve.exit().remove(),ce.append("text").attr("class","catlabel").attr("pointer-events","none");var Le=U._fullLayout.paper_bgcolor;de.select("text.catlabel").attr("text-anchor",function(Te){return c(Te)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",n.makeTextShadow(Le)).style("fill","rgb(0, 0, 0)").attr("x",function(Te){return c(Te)?Te.width+5:-5}).attr("y",function(Te){return Te.height/2}).text(function(Te){return Te.model.categoryLabel}).each(function(Te){o.font(t.select(this),Te.parcatsViewModel.categorylabelfont),n.convertToTspans(t.select(this),U)}),ce.append("text").attr("class","dimlabel"),de.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(Te){return Te.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(Te){return Te.width/2}).attr("y",-5).text(function(Te,xe){return xe===0?Te.parcatsViewModel.model.dimensions[Te.model.dimensionInd].dimensionLabel:null}).each(function(Te){o.font(t.select(this),Te.parcatsViewModel.labelfont)}),de.selectAll("rect.bandrect").on("mouseover",C).on("mouseout",S),de.exit().remove(),se.call(t.behavior.drag().origin(function(Te){return{x:Te.x,y:0}}).on("dragstart",P).on("drag",z).on("dragend",F)),ne.each(function(Te){Te.traceSelection=t.select(this),Te.pathSelection=t.select(this).selectAll("g.paths").selectAll("path.path"),Te.dimensionSelection=t.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),ne.exit().remove()}function r(D){return D.key}function c(D){var U=D.parcatsViewModel.dimensions.length,G=D.parcatsViewModel.dimensions[U-1].model.dimensionInd;return D.model.dimensionInd===G}function f(D,U){return D.model.rawColor>U.model.rawColor?1:D.model.rawColor<U.model.rawColor?-1:0}function d(D){if(!D.parcatsViewModel.dragDimension&&D.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),_(t.select(this));var U=m(D),G=y(D);if(D.parcatsViewModel.graphDiv.emit("plotly_hover",{points:U,event:t.event,constraints:G}),D.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var $,K,re,ne=t.mouse(this)[0],ae=D.parcatsViewModel.graphDiv,ie=D.parcatsViewModel.trace,he=ae._fullLayout,se=he._paperdiv.node().getBoundingClientRect(),de=D.parcatsViewModel.graphDiv.getBoundingClientRect();for(re=0;re<D.leftXs.length-1;re++)if(D.leftXs[re]+D.dimWidths[re]-2<=ne&&ne<=D.leftXs[re+1]+2){var ce=D.parcatsViewModel.dimensions[re],ve=D.parcatsViewModel.dimensions[re+1];$=(ce.x+ce.width+ve.x)/2,K=(D.topYs[re]+D.topYs[re+1]+D.height)/2;break}var Ee=D.parcatsViewModel.x+$,Le=D.parcatsViewModel.y+K,Te=a.mostReadable(D.model.color,["black","white"]),xe=D.model.count,fe=xe/D.parcatsViewModel.model.count,ge={countLabel:xe,probabilityLabel:fe.toFixed(3)},ke=[];D.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&ke.push(["Count:",ge.countLabel].join(" ")),D.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&ke.push(["P:",ge.probabilityLabel].join(" "));var Me=ke.join("<br>"),Se=t.mouse(ae)[0];u.loneHover({trace:ie,x:Ee-se.left+de.left,y:Le-se.top+de.top,text:Me,color:D.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:Te,idealAlign:Se<Ee?"right":"left",hovertemplate:(ie.line||{}).hovertemplate,hovertemplateLabels:ge,eventData:[{data:ie._input,fullData:ie,count:xe,probability:fe}]},{container:he._hoverlayer.node(),outerContainer:he._paper.node(),gd:ae})}}}function g(D){if(!D.parcatsViewModel.dragDimension&&(T(t.select(this)),u.loneUnhover(D.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),D.parcatsViewModel.pathSelection.sort(f),D.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var U=m(D),G=y(D);D.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:U,event:t.event,constraints:G})}}function m(D){for(var U=[],G=q(D.parcatsViewModel),$=0;$<D.model.valueInds.length;$++){var K=D.model.valueInds[$];U.push({curveNumber:G,pointNumber:K})}return U}function y(D){for(var U={},G=D.parcatsViewModel.model.dimensions,$=0;$<G.length;$++){var K=G[$],re=K.categories[D.model.categoryInds[$]];U[K.containerInd]=re.categoryValue}return D.model.rawColor!==void 0&&(U.color=D.model.rawColor),U}function v(D){if(D.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var U=m(D),G=y(D);D.parcatsViewModel.graphDiv.emit("plotly_click",{points:U,event:t.event,constraints:G})}}function T(D){D.attr("fill",function(U){return U.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function _(D){D.attr("fill-opacity",.8).attr("stroke",function(U){return a.mostReadable(U.model.color,["black","white"])}).attr("stroke-width",.3)}function k(D){D.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function E(D){D.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function A(D){var U=D.parcatsViewModel.pathSelection,G=D.categoryViewModel.model.dimensionInd,$=D.categoryViewModel.model.categoryInd;return U.filter(function(K){return K.model.categoryInds[G]===$&&K.model.color===D.color})}function b(D,U,G){var $=t.select(D).datum(),K=$.categoryViewModel.model,re=$.parcatsViewModel.graphDiv,ne=t.select(D.parentNode).selectAll("rect.bandrect"),ae=[];ne.each(function(he){A(he).each(function(se){Array.prototype.push.apply(ae,m(se))})});var ie={};ie[K.dimensionInd]=K.categoryValue,re.emit(U,{points:ae,event:G,constraints:ie})}function L(D,U,G){var $=t.select(D).datum(),K=$.categoryViewModel.model,re=$.parcatsViewModel.graphDiv,ne=A($),ae=[];ne.each(function(he){Array.prototype.push.apply(ae,m(he))});var ie={};ie[K.dimensionInd]=K.categoryValue,$.rawColor!==void 0&&(ie.color=$.rawColor),re.emit(U,{points:ae,event:G,constraints:ie})}function w(D,U,G){D._fullLayout._calcInverseTransform(D);var $,K,re=D._fullLayout._invScaleX,ne=D._fullLayout._invScaleY,ae=t.select(G.parentNode).select("rect.catrect"),ie=ae.node().getBoundingClientRect(),he=ae.datum(),se=he.parcatsViewModel,de=se.model.dimensions[he.model.dimensionInd],ce=se.trace,ve=ie.top+ie.height/2;se.dimensions.length>1&&de.displayInd===se.dimensions.length-1?($=ie.left,K="left"):($=ie.left+ie.width,K="right");var Ee=he.model.count,Le=he.model.categoryLabel,Te=Ee/he.parcatsViewModel.model.count,xe={countLabel:Ee,categoryLabel:Le,probabilityLabel:Te.toFixed(3)},fe=[];he.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&fe.push(["Count:",xe.countLabel].join(" ")),he.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&fe.push(["P("+xe.categoryLabel+"):",xe.probabilityLabel].join(" "));var ge=fe.join("<br>");return{trace:ce,x:re*($-U.left),y:ne*(ve-U.top),text:ge,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:K,hovertemplate:ce.hovertemplate,hovertemplateLabels:xe,eventData:[{data:ce._input,fullData:ce,count:Ee,category:Le,probability:Te}]}}function C(D){if(!D.parcatsViewModel.dragDimension&&D.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){if(t.mouse(this)[1]<-1)return;var U,G=D.parcatsViewModel.graphDiv,$=G._fullLayout,K=$._paperdiv.node().getBoundingClientRect(),re=D.parcatsViewModel.hoveron;re==="color"?(function(ne){var ae=t.select(ne).datum(),ie=A(ae);_(ie),ie.each(function(){e.raiseToTop(this)}),t.select(ne.parentNode).selectAll("rect.bandrect").filter(function(he){return he.color===ae.color}).each(function(){e.raiseToTop(this),t.select(this).attr("stroke","black").attr("stroke-width",1.5)})}(this),L(this,"plotly_hover",t.event)):(function(ne){t.select(ne.parentNode).selectAll("rect.bandrect").each(function(ae){var ie=A(ae);_(ie),ie.each(function(){e.raiseToTop(this)})}),t.select(ne.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),b(this,"plotly_hover",t.event)),D.parcatsViewModel.hoverinfoItems.indexOf("none")===-1&&(re==="category"?U=w(G,K,this):re==="color"?U=function(ne,ae,ie){ne._fullLayout._calcInverseTransform(ne);var he,se,de=ne._fullLayout._invScaleX,ce=ne._fullLayout._invScaleY,ve=ie.getBoundingClientRect(),Ee=t.select(ie).datum(),Le=Ee.categoryViewModel,Te=Le.parcatsViewModel,xe=Te.model.dimensions[Le.model.dimensionInd],fe=Te.trace,ge=ve.y+ve.height/2;Te.dimensions.length>1&&xe.displayInd===Te.dimensions.length-1?(he=ve.left,se="left"):(he=ve.left+ve.width,se="right");var ke=Le.model.categoryLabel,Me=Ee.parcatsViewModel.model.count,Se=0;Ee.categoryViewModel.bands.forEach(function(it){it.color===Ee.color&&(Se+=it.count)});var De=Le.model.count,Be=0;Te.pathSelection.each(function(it){it.model.color===Ee.color&&(Be+=it.model.count)});var We=Se/Me,Qe=Se/Be,Oe=Se/De,Ue={countLabel:Me,categoryLabel:ke,probabilityLabel:We.toFixed(3)},Xe=[];Le.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Xe.push(["Count:",Ue.countLabel].join(" ")),Le.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(Xe.push("P(color ∩ "+ke+"): "+Ue.probabilityLabel),Xe.push("P("+ke+" | color): "+Qe.toFixed(3)),Xe.push("P(color | "+ke+"): "+Oe.toFixed(3)));var Ye=Xe.join("<br>"),$e=a.mostReadable(Ee.color,["black","white"]);return{trace:fe,x:de*(he-ae.left),y:ce*(ge-ae.top),text:Ye,color:Ee.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:$e,fontSize:10,idealAlign:se,hovertemplate:fe.hovertemplate,hovertemplateLabels:Ue,eventData:[{data:fe._input,fullData:fe,category:ke,count:Me,probability:We,categorycount:De,colorcount:Be,bandcolorcount:Se}]}}(G,K,this):re==="dimension"&&(U=function(ne,ae,ie){var he=[];return t.select(ie.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){he.push(w(ne,ae,this))}),he}(G,K,this)),U&&u.loneHover(U,{container:$._hoverlayer.node(),outerContainer:$._paper.node(),gd:G}))}}function S(D){var U=D.parcatsViewModel;!U.dragDimension&&(T(U.pathSelection),k(U.dimensionSelection.selectAll("g.category")),E(U.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),u.loneUnhover(U.graphDiv._fullLayout._hoverlayer.node()),U.pathSelection.sort(f),U.hoverinfoItems.indexOf("skip")===-1)&&(D.parcatsViewModel.hoveron==="color"?L(this,"plotly_unhover",t.event):b(this,"plotly_unhover",t.event))}function P(D){D.parcatsViewModel.arrangement!=="fixed"&&(D.dragDimensionDisplayInd=D.model.displayInd,D.initialDragDimensionDisplayInds=D.parcatsViewModel.model.dimensions.map(function(U){return U.displayInd}),D.dragHasMoved=!1,D.dragCategoryDisplayInd=null,t.select(this).selectAll("g.category").select("rect.catrect").each(function(U){var G=t.mouse(this)[0],$=t.mouse(this)[1];-2<=G&&G<=U.width+2&&-2<=$&&$<=U.height+2&&(D.dragCategoryDisplayInd=U.model.displayInd,D.initialDragCategoryDisplayInds=D.model.categories.map(function(K){return K.displayInd}),U.model.dragY=U.y,e.raiseToTop(this.parentNode),t.select(this.parentNode).selectAll("rect.bandrect").each(function(K){K.y<$&&$<=K.y+K.height&&(D.potentialClickBand=this)}))}),D.parcatsViewModel.dragDimension=D,u.loneUnhover(D.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function z(D){if(D.parcatsViewModel.arrangement!=="fixed"&&(D.dragHasMoved=!0,D.dragDimensionDisplayInd!==null)){var U=D.dragDimensionDisplayInd,G=U-1,$=U+1,K=D.parcatsViewModel.dimensions[U];if(D.dragCategoryDisplayInd!==null){var re=K.categories[D.dragCategoryDisplayInd];re.model.dragY+=t.event.dy;var ne=re.model.dragY,ae=re.model.displayInd,ie=K.categories,he=ie[ae-1],se=ie[ae+1];he!==void 0&&ne<he.y+he.height/2&&(re.model.displayInd=he.model.displayInd,he.model.displayInd=ae),se!==void 0&&ne+re.height>se.y+se.height/2&&(re.model.displayInd=se.model.displayInd,se.model.displayInd=ae),D.dragCategoryDisplayInd=re.model.displayInd}if(D.dragCategoryDisplayInd===null||D.parcatsViewModel.arrangement==="freeform"){K.model.dragX=t.event.x;var de=D.parcatsViewModel.dimensions[G],ce=D.parcatsViewModel.dimensions[$];de!==void 0&&K.model.dragX<de.x+de.width&&(K.model.displayInd=de.model.displayInd,de.model.displayInd=U),ce!==void 0&&K.model.dragX+K.width>ce.x&&(K.model.displayInd=ce.model.displayInd,ce.model.displayInd=D.dragDimensionDisplayInd),D.dragDimensionDisplayInd=K.model.displayInd}N(D.parcatsViewModel),Y(D.parcatsViewModel),X(D.parcatsViewModel),W(D.parcatsViewModel)}}function F(D){if(D.parcatsViewModel.arrangement!=="fixed"&&D.dragDimensionDisplayInd!==null){t.select(this).selectAll("text").attr("font-weight","normal");var U={},G=q(D.parcatsViewModel),$=D.parcatsViewModel.model.dimensions.map(function(se){return se.displayInd}),K=D.initialDragDimensionDisplayInds.some(function(se,de){return se!==$[de]});K&&$.forEach(function(se,de){var ce=D.parcatsViewModel.model.dimensions[de].containerInd;U["dimensions["+ce+"].displayindex"]=se});var re=!1;if(D.dragCategoryDisplayInd!==null){var ne=D.model.categories.map(function(se){return se.displayInd});if(re=D.initialDragCategoryDisplayInds.some(function(se,de){return se!==ne[de]})){var ae=D.model.categories.slice().sort(function(se,de){return se.displayInd-de.displayInd}),ie=ae.map(function(se){return se.categoryValue}),he=ae.map(function(se){return se.categoryLabel});U["dimensions["+D.model.containerInd+"].categoryarray"]=[ie],U["dimensions["+D.model.containerInd+"].ticktext"]=[he],U["dimensions["+D.model.containerInd+"].categoryorder"]="array"}}D.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!D.dragHasMoved&&D.potentialClickBand&&(D.parcatsViewModel.hoveron==="color"?L(D.potentialClickBand,"plotly_click",t.event.sourceEvent):b(D.potentialClickBand,"plotly_click",t.event.sourceEvent)),D.model.dragX=null,D.dragCategoryDisplayInd!==null&&(D.parcatsViewModel.dimensions[D.dragDimensionDisplayInd].categories[D.dragCategoryDisplayInd].model.dragY=null,D.dragCategoryDisplayInd=null),D.dragDimensionDisplayInd=null,D.parcatsViewModel.dragDimension=null,D.dragHasMoved=null,D.potentialClickBand=null,N(D.parcatsViewModel),Y(D.parcatsViewModel),t.transition().duration(300).ease("cubic-in-out").each(function(){X(D.parcatsViewModel,!0),W(D.parcatsViewModel,!0)}).each("end",function(){(K||re)&&p.restyle(D.parcatsViewModel.graphDiv,U,[G])})}}function q(D){for(var U,G=D.graphDiv._fullData,$=0;$<G.length;$++)if(D.key===G[$].uid){U=$;break}return U}function W(D,U){var G;U===void 0&&(U=!1),D.pathSelection.data(function($){return $.paths},r),(G=D.pathSelection,U?G.transition():G).attr("d",function($){return $.svgD})}function X(D,U){function G(ne){return U?ne.transition():ne}U===void 0&&(U=!1),D.dimensionSelection.data(function(ne){return ne.dimensions},r);var $=D.dimensionSelection.selectAll("g.category").data(function(ne){return ne.categories},r);G(D.dimensionSelection).attr("transform",function(ne){return l(ne.x,0)}),G($).attr("transform",function(ne){return l(0,ne.y)}),$.select(".dimlabel").text(function(ne,ae){return ae===0?ne.parcatsViewModel.model.dimensions[ne.model.dimensionInd].dimensionLabel:null}),$.select(".catlabel").attr("text-anchor",function(ne){return c(ne)?"start":"end"}).attr("x",function(ne){return c(ne)?ne.width+5:-5}).each(function(ne){var ae,ie;c(ne)?(ae=ne.width+5,ie="start"):(ae=-5,ie="end"),t.select(this).selectAll("tspan").attr("x",ae).attr("text-anchor",ie)});var K=$.selectAll("rect.bandrect").data(function(ne){return ne.bands},r),re=K.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(ne){return ne.color}).attr("fill-opacity",0);K.attr("fill",function(ne){return ne.color}).attr("width",function(ne){return ne.width}).attr("height",function(ne){return ne.height}).attr("y",function(ne){return ne.y}),E(re),K.each(function(){e.raiseToTop(this)}),K.exit().remove()}function Q(D,U,G){var $,K=G[0],re=U.margin||{l:80,r:80,t:100,b:80},ne=K.trace,ae=ne.domain,ie=U.width,he=U.height,se=Math.floor(ie*(ae.x[1]-ae.x[0])),de=Math.floor(he*(ae.y[1]-ae.y[0])),ce=ae.x[0]*ie+re.l,ve=U.height-ae.y[1]*U.height+re.t,Ee=ne.line.shape;$=ne.hoverinfo==="all"?["count","probability"]:(ne.hoverinfo||"").split("+");var Le={trace:ne,key:ne.uid,model:K,x:ce,y:ve,width:se,height:de,hoveron:ne.hoveron,hoverinfoItems:$,arrangement:ne.arrangement,bundlecolors:ne.bundlecolors,sortpaths:ne.sortpaths,labelfont:ne.labelfont,categorylabelfont:ne.tickfont,pathShape:Ee,dragDimension:null,margin:re,paths:[],dimensions:[],graphDiv:D,traceSelection:null,pathSelection:null,dimensionSelection:null};return K.dimensions&&(N(Le),Y(Le)),Le}function Z(D,U,G,$,K){var re,ne,ae=[],ie=[];for(ne=0;ne<G.length-1;ne++)re=h(G[ne]+D[ne],D[ne+1]),ae.push(re(K)),ie.push(re(1-K));var he="M "+D[0]+","+U[0];for(he+="l"+G[0]+",0 ",ne=1;ne<G.length;ne++)he+="C"+ae[ne-1]+","+U[ne-1]+" "+ie[ne-1]+","+U[ne]+" "+D[ne]+","+U[ne],he+="l"+G[ne]+",0 ";for(he+="l0,"+$+" ",he+="l -"+G[G.length-1]+",0 ",ne=G.length-2;ne>=0;ne--)he+="C"+ie[ne]+","+(U[ne+1]+$)+" "+ae[ne]+","+(U[ne]+$)+" "+(D[ne]+G[ne])+","+(U[ne]+$),he+="l-"+G[ne]+",0 ";return he+="Z"}function Y(D){var U=D.dimensions,G=D.model,$=U.map(function(Xe){return Xe.categories.map(function(Ye){return Ye.y})}),K=D.model.dimensions.map(function(Xe){return Xe.categories.map(function(Ye){return Ye.displayInd})}),re=D.model.dimensions.map(function(Xe){return Xe.displayInd}),ne=D.dimensions.map(function(Xe){return Xe.model.dimensionInd}),ae=U.map(function(Xe){return Xe.x}),ie=U.map(function(Xe){return Xe.width}),he=[];for(var se in G.paths)G.paths.hasOwnProperty(se)&&he.push(G.paths[se]);function de(Xe){var Ye=Xe.categoryInds.map(function($e,it){return K[it][$e]});return ne.map(function($e){return Ye[$e]})}he.sort(function(Xe,Ye){var $e=de(Xe),it=de(Ye);return D.sortpaths==="backward"&&($e.reverse(),it.reverse()),$e.push(Xe.valueInds[0]),it.push(Ye.valueInds[0]),D.bundlecolors&&($e.unshift(Xe.rawColor),it.unshift(Ye.rawColor)),$e<it?-1:$e>it?1:0});for(var ce=new Array(he.length),ve=U[0].model.count,Ee=U[0].categories.map(function(Xe){return Xe.height}).reduce(function(Xe,Ye){return Xe+Ye}),Le=0;Le<he.length;Le++){var Te,xe=he[Le];Te=ve>0?Ee*(xe.count/ve):0;for(var fe,ge=new Array($.length),ke=0;ke<xe.categoryInds.length;ke++){var Me=xe.categoryInds[ke],Se=K[ke][Me],De=re[ke];ge[De]=$[De][Se],$[De][Se]+=Te;var Be=D.dimensions[De].categories[Se],We=Be.bands.length,Qe=Be.bands[We-1];if(Qe===void 0||xe.rawColor!==Qe.rawColor){var Oe=Qe===void 0?0:Qe.y+Qe.height;Be.bands.push({key:Oe,color:xe.color,rawColor:xe.rawColor,height:Te,width:Be.width,count:xe.count,y:Oe,categoryViewModel:Be,parcatsViewModel:D})}else{var Ue=Be.bands[We-1];Ue.height+=Te,Ue.count+=xe.count}}fe=D.pathShape==="hspline"?Z(ae,ge,ie,Te,.5):Z(ae,ge,ie,Te,0),ce[Le]={key:xe.valueInds[0],model:xe,height:Te,leftXs:ae,topYs:ge,dimWidths:ie,svgD:fe,parcatsViewModel:D}}D.paths=ce}function N(D){var U=D.model.dimensions.map(function(ne){return{displayInd:ne.displayInd,dimensionInd:ne.dimensionInd}});U.sort(function(ne,ae){return ne.displayInd-ae.displayInd});var G=[];for(var $ in U){var K=U[$].dimensionInd,re=D.model.dimensions[K];G.push(J(D,re))}D.dimensions=G}function J(D,U){var G,$=D.model.dimensions.length,K=U.displayInd;G=40+($>1?(D.width-80-16)/($-1):0)*K;var re,ne,ae,ie,he,se=[],de=D.model.maxCats,ce=U.categories.length,ve=U.count,Ee=D.height-8*(de-1),Le=8*(de-ce)/2,Te=U.categories.map(function(xe){return{displayInd:xe.displayInd,categoryInd:xe.categoryInd}});for(Te.sort(function(xe,fe){return xe.displayInd-fe.displayInd}),he=0;he<ce;he++)ie=Te[he].categoryInd,ne=U.categories[ie],re=ve>0?ne.count/ve*Ee:0,ae={key:ne.valueInds[0],model:ne,width:16,height:re,y:ne.dragY!==null?ne.dragY:Le,bands:[],parcatsViewModel:D},Le=Le+re+8,se.push(ae);return{key:U.dimensionInd,x:U.dragX!==null?U.dragX:G,y:0,width:16,model:U,categories:se,parcatsViewModel:D,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}B.exports=function(D,U,G,$){s(G,D,$,U)}},{"../../components/drawing":688,"../../components/fx":706,"../../lib":803,"../../lib/svg_text_utils":829,"../../plot_api/plot_api":840,"@plotly/d3":58,"d3-interpolate":171,tinycolor2:598}],1179:[function(i,B,V){var t=i("./parcats");B.exports=function(h,p,u,e){var l=h._fullLayout,o=l._paper,a=l._size;t(h,o,p,{width:a.w,height:a.h,margin:{t:a.t,r:a.r,b:a.b,l:a.l}},u,e)}},{"./parcats":1178}],1180:[function(i,B,V){var t=i("../../components/colorscale/attributes"),h=i("../../plots/cartesian/layout_attributes"),p=i("../../plots/font_attributes"),u=i("../../plots/domain").attributes,e=i("../../lib/extend").extendFlat,l=i("../../plot_api/plot_template").templatedArray;B.exports={domain:u({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:p({editType:"plot"}),tickfont:p({editType:"plot"}),rangefont:p({editType:"plot"}),dimensions:l("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},h.tickvals,{editType:"plot"}),ticktext:e({},h.ticktext,{editType:"plot"}),tickformat:e({},h.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},t("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plot_api/plot_template":843,"../../plots/cartesian/layout_attributes":869,"../../plots/domain":882,"../../plots/font_attributes":883}],1181:[function(i,B,V){var t=i("./constants"),h=i("@plotly/d3"),p=i("../../lib/gup").keyFun,u=i("../../lib/gup").repeat,e=i("../../lib").sorterAsc,l=i("../../lib").strTranslate,o=t.bar.snapRatio;function a(w,C){return w*(1-o)+C*o}var n=t.bar.snapClose;function s(w,C){return w*(1-n)+C*n}function r(w,C,S,P){if(function(J,D){for(var U=0;U<D.length;U++)if(J>=D[U][0]&&J<=D[U][1])return!0;return!1}(S,P))return S;var z=w?-1:1,F=0,q=C.length-1;if(z<0){var W=F;F=q,q=W}for(var X=C[F],Q=X,Z=F;z*Z<z*q;Z+=z){var Y=Z+z,N=C[Y];if(z*S<z*s(X,N))return a(X,Q);if(z*S<z*N||Y===q)return a(N,X);Q=X,X=N}}function c(w){w.attr("x",-t.bar.captureWidth/2).attr("width",t.bar.captureWidth)}function f(w){w.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function d(w){if(!w.brush.filterSpecified)return"0,"+w.height;for(var C,S,P,z=g(w.brush.filter.getConsolidated(),w.height),F=[0],q=z.length?z[0][0]:null,W=0;W<z.length;W++)S=(C=z[W])[1]-C[0],F.push(q),F.push(S),(P=W+1)<z.length&&(q=z[P][0]-C[1]);return F.push(w.height),F}function g(w,C){return w.map(function(S){return S.map(function(P){return Math.max(0,P*C)}).sort(e)})}function m(){h.select(document.body).style("cursor",null)}function y(w){w.attr("stroke-dasharray",d)}function v(w,C){var S=h.select(w).selectAll(".highlight, .highlight-shadow");y(C?S.transition().duration(t.bar.snapDuration).each("end",C):S)}function T(w,C){var S,P=w.brush,z=NaN,F={};if(P.filterSpecified){var q=w.height,W=P.filter.getConsolidated(),X=g(W,q),Q=NaN,Z=NaN,Y=NaN;for(S=0;S<=X.length;S++){var N=X[S];if(N&&N[0]<=C&&C<=N[1]){Q=S;break}if(Z=S?S-1:NaN,N&&N[0]>C){Y=S;break}}if(z=Q,isNaN(z)&&(z=isNaN(Z)||isNaN(Y)?isNaN(Z)?Y:Z:C-X[Z][1]<X[Y][0]-C?Z:Y),!isNaN(z)){var J=X[z],D=function(K,re){var ne=t.bar.handleHeight;if(!(re>K[1]+ne||re<K[0]-ne))return re>=.9*K[1]+.1*K[0]?"n":re<=.9*K[0]+.1*K[1]?"s":"ns"}(J,C);D&&(F.interval=W[z],F.intervalPix=J,F.region=D)}}if(w.ordinal&&!F.region){var U=w.unitTickvals,G=w.unitToPaddedPx.invert(C);for(S=0;S<U.length;S++){var $=[.25*U[Math.max(S-1,0)]+.75*U[S],.25*U[Math.min(S+1,U.length-1)]+.75*U[S]];if(G>=$[0]&&G<=$[1]){F.clickableOrdinalRange=$;break}}}return F}function _(w,C){h.event.sourceEvent.stopPropagation();var S=C.height-h.mouse(w)[1]-2*t.verticalPadding,P=C.brush.svgBrush;P.wasDragged=!0,P._dragging=!0,P.grabbingBar?P.newExtent=[S-P.grabPoint,S+P.barLength-P.grabPoint].map(C.unitToPaddedPx.invert):P.newExtent=[P.startExtent,C.unitToPaddedPx.invert(S)].sort(e),C.brush.filterSpecified=!0,P.extent=P.stayingIntervals.concat([P.newExtent]),P.brushCallback(C),v(w.parentNode)}function k(w,C){var S=T(C,C.height-h.mouse(w)[1]-2*t.verticalPadding),P="crosshair";S.clickableOrdinalRange?P="pointer":S.region&&(P=S.region+"-resize"),h.select(document.body).style("cursor",P)}function E(w){w.on("mousemove",function(C){h.event.preventDefault(),C.parent.inBrushDrag||k(this,C)}).on("mouseleave",function(C){C.parent.inBrushDrag||m()}).call(h.behavior.drag().on("dragstart",function(C){(function(S,P){h.event.sourceEvent.stopPropagation();var z=P.height-h.mouse(S)[1]-2*t.verticalPadding,F=P.unitToPaddedPx.invert(z),q=P.brush,W=T(P,z),X=W.interval,Q=q.svgBrush;if(Q.wasDragged=!1,Q.grabbingBar=W.region==="ns",Q.grabbingBar){var Z=X.map(P.unitToPaddedPx);Q.grabPoint=z-Z[0]-t.verticalPadding,Q.barLength=Z[1]-Z[0]}Q.clickableOrdinalRange=W.clickableOrdinalRange,Q.stayingIntervals=P.multiselect&&q.filterSpecified?q.filter.getConsolidated():[],X&&(Q.stayingIntervals=Q.stayingIntervals.filter(function(Y){return Y[0]!==X[0]&&Y[1]!==X[1]})),Q.startExtent=W.region?X[W.region==="s"?1:0]:F,P.parent.inBrushDrag=!0,Q.brushStartCallback()})(this,C)}).on("drag",function(C){_(this,C)}).on("dragend",function(C){(function(S,P){var z=P.brush,F=z.filter,q=z.svgBrush;q._dragging||(k(S,P),_(S,P),P.brush.svgBrush.wasDragged=!1),q._dragging=!1,h.event.sourceEvent.stopPropagation();var W=q.grabbingBar;if(q.grabbingBar=!1,q.grabLocation=void 0,P.parent.inBrushDrag=!1,m(),!q.wasDragged)return q.wasDragged=void 0,q.clickableOrdinalRange?z.filterSpecified&&P.multiselect?q.extent.push(q.clickableOrdinalRange):(q.extent=[q.clickableOrdinalRange],z.filterSpecified=!0):W?(q.extent=q.stayingIntervals,q.extent.length===0&&b(z)):b(z),q.brushCallback(P),v(S.parentNode),void q.brushEndCallback(z.filterSpecified?F.getConsolidated():[]);var X=function(){F.set(F.getConsolidated())};if(P.ordinal){var Q=P.unitTickvals;Q[Q.length-1]<Q[0]&&Q.reverse(),q.newExtent=[r(0,Q,q.newExtent[0],q.stayingIntervals),r(1,Q,q.newExtent[1],q.stayingIntervals)];var Z=q.newExtent[1]>q.newExtent[0];q.extent=q.stayingIntervals.concat(Z?[q.newExtent]:[]),q.extent.length||b(z),q.brushCallback(P),Z?v(S.parentNode,X):(X(),v(S.parentNode))}else X();q.brushEndCallback(z.filterSpecified?F.getConsolidated():[])})(this,C)}))}function A(w,C){return w[0]-C[0]}function b(w){w.filterSpecified=!1,w.svgBrush.extent=[[-1/0,1/0]]}function L(w){for(var C,S=w.slice(),P=[],z=S.shift();z;){for(C=z.slice();(z=S.shift())&&z[0]<=C[1];)C[1]=Math.max(C[1],z[1]);P.push(C)}return P.length===1&&P[0][0]>P[0][1]&&(P=[]),P}B.exports={makeBrush:function(w,C,S,P,z,F){var q,W=function(){var X,Q,Z=[];return{set:function(Y){(Z=Y.map(function(N){return N.slice().sort(e)}).sort(A)).length===1&&Z[0][0]===-1/0&&Z[0][1]===1/0&&(Z=[[0,-1]]),X=L(Z),Q=Z.reduce(function(N,J){return[Math.min(N[0],J[0]),Math.max(N[1],J[1])]},[1/0,-1/0])},get:function(){return Z.slice()},getConsolidated:function(){return X},getBounds:function(){return Q}}}();return W.set(S),{filter:W,filterSpecified:C,svgBrush:{extent:[],brushStartCallback:P,brushCallback:(q=z,function(X){var Q=X.brush,Z=function(Y){return Y.svgBrush.extent.map(function(N){return N.slice()})}(Q).slice();Q.filter.set(Z),q()}),brushEndCallback:F}}},ensureAxisBrush:function(w,C){var S=w.selectAll("."+t.cn.axisBrush).data(u,p);S.enter().append("g").classed(t.cn.axisBrush,!0),function(P,z){var F=P.selectAll(".background").data(u);F.enter().append("rect").classed("background",!0).call(c).call(f).style("pointer-events","auto").attr("transform",l(0,t.verticalPadding)),F.call(E).attr("height",function(X){return X.height-t.verticalPadding});var q=P.selectAll(".highlight-shadow").data(u);q.enter().append("line").classed("highlight-shadow",!0).attr("x",-t.bar.width/2).attr("stroke-width",t.bar.width+t.bar.strokeWidth).attr("stroke",z).attr("opacity",t.bar.strokeOpacity).attr("stroke-linecap","butt"),q.attr("y1",function(X){return X.height}).call(y);var W=P.selectAll(".highlight").data(u);W.enter().append("line").classed("highlight",!0).attr("x",-t.bar.width/2).attr("stroke-width",t.bar.width-t.bar.strokeWidth).attr("stroke",t.bar.fillColor).attr("opacity",t.bar.fillOpacity).attr("stroke-linecap","butt"),W.attr("y1",function(X){return X.height}).call(y)}(S,C)},cleanRanges:function(w,C){if(Array.isArray(w[0])?(w=w.map(function(P){return P.sort(e)}),w=C.multiselect?L(w.sort(A)):[w[0]]):w=[w.sort(e)],C.tickvals){var S=C.tickvals.slice().sort(e);if(!(w=w.map(function(P){var z=[r(0,S,P[0],[]),r(1,S,P[1],[])];if(z[1]>z[0])return z}).filter(function(P){return P})).length)return}return w.length>1?w:w[0]}}},{"../../lib":803,"../../lib/gup":800,"./constants":1184,"@plotly/d3":58}],1182:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../plots/get_data").getModuleCalcData,p=i("./plot"),u=i("../../constants/xmlns_namespaces");V.name="parcoords",V.plot=function(e){var l=h(e.calcdata,"parcoords")[0];l.length&&p(e,l)},V.clean=function(e,l,o,a){var n=a._has&&a._has("parcoords"),s=l._has&&l._has("parcoords");n&&!s&&(a._paperdiv.selectAll(".parcoords").remove(),a._glimages.selectAll("*").remove())},V.toSVG=function(e){var l=e._fullLayout._glimages,o=t.select(e).selectAll(".svg-container");o.filter(function(a,n){return n===o.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var a=this.toDataURL("image/png");l.append("svg:image").attr({xmlns:u.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){t.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":780,"../../plots/get_data":891,"./plot":1191,"@plotly/d3":58}],1183:[function(i,B,V){var t=i("../../lib").isArrayOrTypedArray,h=i("../../components/colorscale"),p=i("../../lib/gup").wrap;B.exports=function(u,e){var l,o;return h.hasColorscale(e,"line")&&t(e.line.color)?(l=e.line.color,o=h.extractOpts(e.line).colorscale,h.calc(u,e,{vals:l,containerStr:"line",cLetter:"c"})):(l=function(a){for(var n=new Array(a),s=0;s<a;s++)n[s]=.5;return n}(e._length),o=[[0,e.line.color],[1,e.line.color]]),p({lineColor:l,cscale:o})}},{"../../components/colorscale":678,"../../lib":803,"../../lib/gup":800}],1184:[function(i,B,V){B.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1185:[function(i,B,V){var t=i("../../lib"),h=i("../../components/colorscale/helpers").hasColorscale,p=i("../../components/colorscale/defaults"),u=i("../../plots/domain").defaults,e=i("../../plots/array_container_defaults"),l=i("../../plots/cartesian/axes"),o=i("./attributes"),a=i("./axisbrush"),n=i("./constants").maxDimensionCount,s=i("./merge_length");function r(c,f,d,g){function m(k,E){return t.coerce(c,f,o.dimensions,k,E)}var y=m("values"),v=m("visible");if(y&&y.length||(v=f.visible=!1),v){m("label"),m("tickvals"),m("ticktext"),m("tickformat");var T=m("range");f._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:T},l.setConvert(f._ax,g.layout),m("multiselect");var _=m("constraintrange");_&&(f.constraintrange=a.cleanRanges(_,f))}}B.exports=function(c,f,d,g){function m(k,E){return t.coerce(c,f,o,k,E)}var y=c.dimensions;Array.isArray(y)&&y.length>n&&(t.log("parcoords traces support up to "+n+" dimensions at the moment"),y.splice(n));var v=e(c,f,{name:"dimensions",layout:g,handleItemDefaults:r}),T=function(k,E,A,b,L){var w=L("line.color",A);if(h(k,"line")&&t.isArrayOrTypedArray(w)){if(w.length)return L("line.colorscale"),p(k,E,b,L,{prefix:"line.",cLetter:"c"}),w.length;E.line.color=A}return 1/0}(c,f,d,g,m);u(f,g,m),Array.isArray(v)&&v.length||(f.visible=!1),s(f,v,"values",T);var _={family:g.font.family,size:Math.round(g.font.size/1.2),color:g.font.color};t.coerceFont(m,"labelfont",_),t.coerceFont(m,"tickfont",_),t.coerceFont(m,"rangefont",_),m("labelangle"),m("labelside")}},{"../../components/colorscale/defaults":676,"../../components/colorscale/helpers":677,"../../lib":803,"../../plots/array_container_defaults":849,"../../plots/cartesian/axes":854,"../../plots/domain":882,"./attributes":1180,"./axisbrush":1181,"./constants":1184,"./merge_length":1189}],1186:[function(i,B,V){var t=i("../../lib").isTypedArray;V.convertTypedArray=function(h){return t(h)?Array.prototype.slice.call(h):h},V.isOrdinal=function(h){return!!h.tickvals},V.isVisible=function(h){return h.visible||!("visible"in h)}},{"../../lib":803}],1187:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("./calc"),plot:i("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:i("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1180,"./base_plot":1182,"./calc":1183,"./defaults":1185,"./plot":1191}],1188:[function(i,B,V){var t=i("glslify"),h=t([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform sampler2D mask, palette;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(mask,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),p=t([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),u=i("./constants").maxDimensionCount,e=i("../../lib"),l=new Uint8Array(4),o=new Uint8Array(4),a={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function n(v,T,_,k,E){var A=v._gl;A.enable(A.SCISSOR_TEST),A.scissor(T,_,k,E),v.clear({color:[0,0,0,0],depth:1})}function s(v,T,_,k,E,A){var b=A.key;_.drawCompleted||(function(L){L.read({x:0,y:0,width:1,height:1,data:l})}(v),_.drawCompleted=!0),function L(w){var C=Math.min(k,E-w*k);w===0&&(window.cancelAnimationFrame(_.currentRafs[b]),delete _.currentRafs[b],n(v,A.scissorX,A.scissorY,A.scissorWidth,A.viewBoxSize[1])),_.clearOnly||(A.count=2*C,A.offset=2*w*k,T(A),w*k+C<E&&(_.currentRafs[b]=window.requestAnimationFrame(function(){L(w+1)})),_.drawCompleted=!1)}(0)}function r(v,T){for(var _=new Array(256),k=0;k<256;k++)_[k]=v(k/255).concat(T);return _}function c(v,T){return(v>>>8*T)%256/255}function f(v,T,_){for(var k=new Array(8*T),E=0,A=0;A<T;A++)for(var b=0;b<2;b++)for(var L=0;L<4;L++){var w=4*v+L,C=_[64*A+w];w===63&&b===0&&(C*=-1),k[E++]=C}return k}function d(v){var T="0"+v;return T.substr(T.length-2)}function g(v){return v<u?"p"+d(v+1)+"_"+d(v+4):"colors"}function m(v,T,_,k,E,A,b,L,w,C,S,P,z,F){for(var q=[[],[]],W=0;W<64;W++)q[0][W]=W===E?1:0,q[1][W]=W===A?1:0;b*=F,L*=F,w*=F,C*=F;var X=v.lines.canvasOverdrag*F,Q=v.domain,Z=v.canvasWidth*F,Y=v.canvasHeight*F,N=v.pad.l*F,J=v.pad.b*F,D=v.layoutHeight*F,U=v.layoutWidth*F,G=v.deselectedLines.color;return e.extendFlat({key:S,resolution:[Z,Y],viewBoxPos:[b+X,L],viewBoxSize:[w,C],i0:E,i1:A,dim0A:q[0].slice(0,16),dim0B:q[0].slice(16,32),dim0C:q[0].slice(32,48),dim0D:q[0].slice(48,64),dim1A:q[1].slice(0,16),dim1B:q[1].slice(16,32),dim1C:q[1].slice(32,48),dim1D:q[1].slice(48,64),drwLayer:P,contextColor:[G[0]/255,G[1]/255,G[2]/255,G[3]<1?G[3]:Math.max(1/255,Math.pow(1/v.lines.color.length,1/3))],scissorX:(k===T?0:b+X)+(N-X)+U*Q.x[0],scissorWidth:(k===_?Z-b+X:w+.5)+(k===T?b+X:0),scissorY:L+J+D*Q.y[0],scissorHeight:C,viewportX:N-X+U*Q.x[0],viewportY:J+D*Q.y[0],viewportWidth:Z,viewportHeight:Y},z)}function y(v){var T=Math.max(0,Math.floor(2047*v[0]),0),_=Math.min(2047,Math.ceil(2047*v[1]),2047);return[Math.min(T,_),Math.max(T,_)]}B.exports=function(v,T){var _,k,E,A,b,L=T.context,w=T.pick,C=T.regl,S=C._gl,P=S.getParameter(S.ALIASED_LINE_WIDTH_RANGE),z=Math.max(P[0],Math.min(P[1],T.viewModel.plotGlPixelRatio)),F={currentRafs:{},drawCompleted:!0,clearOnly:!1},q=function(Y){for(var N={},J=0;J<=u;J+=4)N[g(J)]=Y.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return N}(C),W=C.texture(a),X=[];Z(T);var Q=C({profile:!1,blend:{enable:L,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!L,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:C.prop("scissorX"),y:C.prop("scissorY"),width:C.prop("scissorWidth"),height:C.prop("scissorHeight")}},viewport:{x:C.prop("viewportX"),y:C.prop("viewportY"),width:C.prop("viewportWidth"),height:C.prop("viewportHeight")},dither:!1,vert:h,frag:p,primitive:"lines",lineWidth:z,attributes:q,uniforms:{resolution:C.prop("resolution"),viewBoxPos:C.prop("viewBoxPos"),viewBoxSize:C.prop("viewBoxSize"),dim0A:C.prop("dim0A"),dim1A:C.prop("dim1A"),dim0B:C.prop("dim0B"),dim1B:C.prop("dim1B"),dim0C:C.prop("dim0C"),dim1C:C.prop("dim1C"),dim0D:C.prop("dim0D"),dim1D:C.prop("dim1D"),loA:C.prop("loA"),hiA:C.prop("hiA"),loB:C.prop("loB"),hiB:C.prop("hiB"),loC:C.prop("loC"),hiC:C.prop("hiC"),loD:C.prop("loD"),hiD:C.prop("hiD"),palette:W,contextColor:C.prop("contextColor"),mask:C.prop("maskTexture"),drwLayer:C.prop("drwLayer"),maskHeight:C.prop("maskHeight")},offset:C.prop("offset"),count:C.prop("count")});function Z(Y){_=Y.model,k=Y.viewModel,E=k.dimensions.slice(),A=E[0]?E[0].values.length:0;var N=_.lines,J=w?N.color.map(function(U,G){return G/N.color.length}):N.color,D=function(U,G,$){for(var K,re=new Array(U*(u+4)),ne=0,ae=0;ae<U;ae++){for(var ie=0;ie<u;ie++)re[ne++]=ie<G.length?G[ie].paddedUnitValues[ae]:.5;re[ne++]=c(ae,2),re[ne++]=c(ae,1),re[ne++]=c(ae,0),re[ne++]=(K=$[ae],Math.max(1e-6,Math.min(.999999,K)))}return re}(A,E,J);(function(U,G,$){for(var K=0;K<=u;K+=4)U[g(K)](f(K/4,G,$))})(q,A,D),L||w||(W=C.texture(e.extendFlat({data:r(_.unitToColor,255)},a)))}return{render:function(Y,N,J){var D,U,G,$=Y.length,K=1/0,re=-1/0;for(D=0;D<$;D++)Y[D].dim0.canvasX<K&&(K=Y[D].dim0.canvasX,U=D),Y[D].dim1.canvasX>re&&(re=Y[D].dim1.canvasX,G=D);$===0&&n(C,0,0,_.canvasWidth,_.canvasHeight);var ne=function(Te){var xe,fe,ge,ke=[[],[]];for(ge=0;ge<64;ge++){var Me=!Te&&ge<E.length?E[ge].brush.filter.getBounds():[-1/0,1/0];ke[0][ge]=Me[0],ke[1][ge]=Me[1]}var Se=new Array(16384);for(xe=0;xe<16384;xe++)Se[xe]=255;if(!Te)for(xe=0;xe<E.length;xe++){var De=xe%8,Be=(xe-De)/8,We=Math.pow(2,De),Qe=E[xe].brush.filter.get();if(!(Qe.length<2)){var Oe=y(Qe[0])[1];for(fe=1;fe<Qe.length;fe++){var Ue=y(Qe[fe]);for(ge=Oe+1;ge<Ue[0];ge++)Se[8*ge+Be]&=~We;Oe=Math.max(Oe,Ue[1])}}}var Xe={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:Se};return b?b(Xe):b=C.texture(Xe),{maskTexture:b,maskHeight:2048,loA:ke[0].slice(0,16),loB:ke[0].slice(16,32),loC:ke[0].slice(32,48),loD:ke[0].slice(48,64),hiA:ke[1].slice(0,16),hiB:ke[1].slice(16,32),hiC:ke[1].slice(32,48),hiD:ke[1].slice(48,64)}}(L);for(D=0;D<$;D++){var ae=Y[D],ie=ae.dim0.crossfilterDimensionIndex,he=ae.dim1.crossfilterDimensionIndex,se=ae.canvasX,de=ae.canvasY,ce=se+ae.panelSizeX,ve=ae.plotGlPixelRatio;if(N||!X[ie]||X[ie][0]!==se||X[ie][1]!==ce){X[ie]=[se,ce];var Ee=m(_,U,G,D,ie,he,se,de,ae.panelSizeX,ae.panelSizeY,ae.dim0.crossfilterDimensionIndex,L?0:w?2:1,ne,ve);F.clearOnly=J;var Le=N?_.lines.blockLineCount:A;s(C,Q,F,Le,A,Ee)}}},readPixel:function(Y,N){return C.read({x:Y,y:N,width:1,height:1,data:o}),o},readPixels:function(Y,N,J,D){var U=new Uint8Array(4*J*D);return C.read({x:Y,y:N,width:J,height:D,data:U}),U},destroy:function(){for(var Y in v.style["pointer-events"]="none",W.destroy(),b&&b.destroy(),q)q[Y].destroy()},update:Z}}},{"../../lib":803,"./constants":1184,glslify:442}],1189:[function(i,B,V){B.exports=function(t,h,p,u){var e,l;for(u||(u=1/0),e=0;e<h.length;e++)(l=h[e]).visible&&(u=Math.min(u,l[p].length));for(u===1/0&&(u=0),t._length=u,e=0;e<h.length;e++)(l=h[e]).visible&&(l._length=u);return u}},{}],1190:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=h.numberFormat,u=i("color-rgba"),e=i("../../plots/cartesian/axes"),l=h.strRotate,o=h.strTranslate,a=i("../../lib/svg_text_utils"),n=i("../../components/drawing"),s=i("../../components/colorscale"),r=i("../../lib/gup"),c=r.keyFun,f=r.repeat,d=r.unwrap,g=i("./helpers"),m=i("./constants"),y=i("./axisbrush"),v=i("./lines");function T(X,Q,Z){return h.aggNums(X,null,Q,Z)}function _(X,Q){return E(T(Math.min,X,Q),T(Math.max,X,Q))}function k(X){var Q=X.range;return Q?E(Q[0],Q[1]):_(X.values,X._length)}function E(X,Q){return!isNaN(X)&&isFinite(X)||(X=0),!isNaN(Q)&&isFinite(Q)||(Q=0),X===Q&&(X===0?(X-=1,Q+=1):(X*=.9,Q*=1.1)),[X,Q]}function A(X,Q,Z,Y,N){var J,D,U=k(Z);return Y?t.scale.ordinal().domain(Y.map((J=p(Z.tickformat),D=N,D?function(G,$){var K=D[$];return K??J(G)}:J))).range(Y.map(function(G){var $=(G-U[0])/(U[1]-U[0]);return X-Q+$*(2*Q-X)})):t.scale.linear().domain(U).range([X-Q,Q])}function b(X){if(X.tickvals){var Q=k(X);return t.scale.ordinal().domain(X.tickvals).range(X.tickvals.map(function(Z){return(Z-Q[0])/(Q[1]-Q[0])}))}}function L(X){var Q=X.map(function(N){return N[0]}),Z=X.map(function(N){var J=u(N[1]);return t.rgb("rgb("+J[0]+","+J[1]+","+J[2]+")")}),Y="rgb".split("").map(function(N){return t.scale.linear().clamp(!0).domain(Q).range(Z.map((J=N,function(D){return D[J]})));var J});return function(N){return Y.map(function(J){return J(N)})}}function w(X){return X.dimensions.some(function(Q){return Q.brush.filterSpecified})}function C(X,Q,Z){var Y=d(Q),N=Y.trace,J=g.convertTypedArray(Y.lineColor),D=N.line,U={color:u(m.deselectedLineColor)},G=s.extractOpts(D),$=G.reversescale?s.flipScale(Y.cscale):Y.cscale,K=N.domain,re=N.dimensions,ne=X.width,ae=N.labelangle,ie=N.labelside,he=N.labelfont,se=N.tickfont,de=N.rangefont,ce=h.extendDeepNoArrays({},D,{color:J.map(t.scale.linear().domain(k({values:J,range:[G.min,G.max],_length:N._length}))),blockLineCount:m.blockLineCount,canvasOverdrag:m.overdrag*m.canvasPixelRatio}),ve=Math.floor(ne*(K.x[1]-K.x[0])),Ee=Math.floor(X.height*(K.y[1]-K.y[0])),Le=X.margin||{l:80,r:80,t:100,b:80},Te=ve,xe=Ee;return{key:Z,colCount:re.filter(g.isVisible).length,dimensions:re,tickDistance:m.tickDistance,unitToColor:L($),lines:ce,deselectedLines:U,labelAngle:ae,labelSide:ie,labelFont:he,tickFont:se,rangeFont:de,layoutWidth:ne,layoutHeight:X.height,domain:K,translateX:K.x[0]*ne,translateY:X.height-K.y[1]*X.height,pad:Le,canvasWidth:Te*m.canvasPixelRatio+2*ce.canvasOverdrag,canvasHeight:xe*m.canvasPixelRatio,width:Te,height:xe,canvasPixelRatio:m.canvasPixelRatio}}function S(X,Q,Z){var Y=Z.width,N=Z.height,J=Z.dimensions,D=Z.canvasPixelRatio,U=function(ne){return Y*ne/Math.max(1,Z.colCount-1)},G=m.verticalPadding/N,$=function(ne,ae){return t.scale.linear().range([ae,ne-ae])}(N,m.verticalPadding),K={key:Z.key,xScale:U,model:Z,inBrushDrag:!1},re={};return K.dimensions=J.filter(g.isVisible).map(function(ne,ae){var ie=function(Se,De){return t.scale.linear().domain(k(Se)).range([De,1-De])}(ne,G),he=re[ne.label];re[ne.label]=(he||0)+1;var se=ne.label+(he?"__"+he:""),de=ne.constraintrange,ce=de&&de.length;ce&&!Array.isArray(de[0])&&(de=[de]);var ve=ce?de.map(function(Se){return Se.map(ie)}):[[-1/0,1/0]],Ee=ne.values;Ee.length>ne._length&&(Ee=Ee.slice(0,ne._length));var Le,Te=ne.tickvals;function xe(Se,De){return{val:Se,text:Le[De]}}function fe(Se,De){return Se.val-De.val}if(Array.isArray(Te)&&Te.length){Le=ne.ticktext,Array.isArray(Le)&&Le.length?Le.length>Te.length?Le=Le.slice(0,Te.length):Te.length>Le.length&&(Te=Te.slice(0,Le.length)):Le=Te.map(p(ne.tickformat));for(var ge=1;ge<Te.length;ge++)if(Te[ge]<Te[ge-1]){for(var ke=Te.map(xe).sort(fe),Me=0;Me<Te.length;Me++)Te[Me]=ke[Me].val,Le[Me]=ke[Me].text;break}}else Te=void 0;return Ee=g.convertTypedArray(Ee),{key:se,label:ne.label,tickFormat:ne.tickformat,tickvals:Te,ticktext:Le,ordinal:g.isOrdinal(ne),multiselect:ne.multiselect,xIndex:ae,crossfilterDimensionIndex:ae,visibleIndex:ne._index,height:N,values:Ee,paddedUnitValues:Ee.map(ie),unitTickvals:Te&&Te.map(ie),xScale:U,x:U(ae),canvasX:U(ae)*D,unitToPaddedPx:$,domainScale:A(N,m.verticalPadding,ne,Te,Le),ordinalScale:b(ne),parent:K,model:Z,brush:y.makeBrush(X,ce,ve,function(){X.linePickActive(!1)},function(){var Se=K;Se.focusLayer&&Se.focusLayer.render(Se.panels,!0);var De=w(Se);!X.contextShown()&&De?(Se.contextLayer&&Se.contextLayer.render(Se.panels,!0),X.contextShown(!0)):X.contextShown()&&!De&&(Se.contextLayer&&Se.contextLayer.render(Se.panels,!0,!0),X.contextShown(!1))},function(Se){if(K.focusLayer.render(K.panels,!0),K.pickLayer&&K.pickLayer.render(K.panels,!0),X.linePickActive(!0),Q&&Q.filterChanged){var De=ie.invert,Be=Se.map(function(We){return We.map(De).sort(h.sorterAsc)}).sort(function(We,Qe){return We[0]-Qe[0]});Q.filterChanged(K.key,ne._index,Be)}})}}),K}function P(X){X.classed(m.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function z(X,Q){var Z=Q==="top"?1:-1,Y=X*Math.PI/180;return{dir:Z,dx:Math.sin(Y),dy:Math.cos(Y),degrees:X}}function F(X,Q,Z){for(var Y=Q.panels||(Q.panels=[]),N=X.data(),J=0;J<N.length-1;J++){var D=Y[J]||(Y[J]={}),U=N[J],G=N[J+1];D.dim0=U,D.dim1=G,D.canvasX=U.canvasX,D.panelSizeX=G.canvasX-U.canvasX,D.panelSizeY=Q.model.canvasHeight,D.y=0,D.canvasY=0,D.plotGlPixelRatio=Z}}function q(X,Q){return e.tickText(X._ax,Q,!1).text}function W(X,Q){if(X.ordinal)return"";var Z=X.domainScale.domain(),Y=Z[Q?Z.length-1:0];return q(X.model.dimensions[X.visibleIndex],Y)}B.exports=function(X,Q,Z,Y){var N=X._fullLayout,J=N._toppaper,D=N._glcontainer,U=X._context.plotGlPixelRatio,G=X._fullLayout.paper_bgcolor;(function(Me){for(var Se=0;Se<Me.length;Se++)for(var De=0;De<Me[Se].length;De++)for(var Be=Me[Se][De].trace,We=Be.dimensions,Qe=0;Qe<We.length;Qe++){var Oe=We[Qe].values,Ue=We[Qe]._ax;Ue&&(Ue.range?Ue.range=E(Ue.range[0],Ue.range[1]):Ue.range=_(Oe,Be._length),Ue.dtick||(Ue.dtick=.01*(Math.abs(Ue.range[1]-Ue.range[0])||1)),Ue.tickformat=We[Qe].tickformat,e.calcTicks(Ue),Ue.cleanRange())}})(Q);var $,K,re=($=!0,K=!1,{linePickActive:function(Me){return arguments.length?$=!!Me:$},contextShown:function(Me){return arguments.length?K=!!Me:K}}),ne=Q.filter(function(Me){return d(Me).trace.visible}).map(C.bind(0,Z)).map(S.bind(0,re,Y));D.each(function(Me,Se){return h.extendFlat(Me,ne[Se])});var ae=D.selectAll(".gl-canvas").each(function(Me){Me.viewModel=ne[0],Me.viewModel.plotGlPixelRatio=U,Me.viewModel.paperColor=G,Me.model=Me.viewModel?Me.viewModel.model:null}),ie=null;ae.filter(function(Me){return Me.pick}).style("pointer-events","auto").on("mousemove",function(Me){if(re.linePickActive()&&Me.lineLayer&&Y&&Y.hover){var Se=t.event,De=this.width,Be=this.height,We=t.mouse(this),Qe=We[0],Oe=We[1];if(Qe<0||Oe<0||Qe>=De||Oe>=Be)return;var Ue=Me.lineLayer.readPixel(Qe,Be-1-Oe),Xe=Ue[3]!==0,Ye=Xe?Ue[2]+256*(Ue[1]+256*Ue[0]):null,$e={x:Qe,y:Oe,clientX:Se.clientX,clientY:Se.clientY,dataIndex:Me.model.key,curveNumber:Ye};Ye!==ie&&(Xe?Y.hover($e):Y.unhover&&Y.unhover($e),ie=Ye)}}),ae.style("opacity",function(Me){return Me.pick?0:1}),J.style("background","rgba(255, 255, 255, 0)");var he=J.selectAll("."+m.cn.parcoords).data(ne,c);he.exit().remove(),he.enter().append("g").classed(m.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),he.attr("transform",function(Me){return o(Me.model.translateX,Me.model.translateY)});var se=he.selectAll("."+m.cn.parcoordsControlView).data(f,c);se.enter().append("g").classed(m.cn.parcoordsControlView,!0),se.attr("transform",function(Me){return o(Me.model.pad.l,Me.model.pad.t)});var de=se.selectAll("."+m.cn.yAxis).data(function(Me){return Me.dimensions},c);de.enter().append("g").classed(m.cn.yAxis,!0),se.each(function(Me){F(de,Me,U)}),ae.each(function(Me){if(Me.viewModel){!Me.lineLayer||Y?Me.lineLayer=v(this,Me):Me.lineLayer.update(Me),(Me.key||Me.key===0)&&(Me.viewModel[Me.key]=Me.lineLayer);var Se=!Me.context||Y;Me.lineLayer.render(Me.viewModel.panels,Se)}}),de.attr("transform",function(Me){return o(Me.xScale(Me.xIndex),0)}),de.call(t.behavior.drag().origin(function(Me){return Me}).on("drag",function(Me){var Se=Me.parent;re.linePickActive(!1),Me.x=Math.max(-m.overdrag,Math.min(Me.model.width+m.overdrag,t.event.x)),Me.canvasX=Me.x*Me.model.canvasPixelRatio,de.sort(function(De,Be){return De.x-Be.x}).each(function(De,Be){De.xIndex=Be,De.x=Me===De?De.x:De.xScale(De.xIndex),De.canvasX=De.x*De.model.canvasPixelRatio}),F(de,Se,U),de.filter(function(De){return Math.abs(Me.xIndex-De.xIndex)!==0}).attr("transform",function(De){return o(De.xScale(De.xIndex),0)}),t.select(this).attr("transform",o(Me.x,0)),de.each(function(De,Be,We){We===Me.parent.key&&(Se.dimensions[Be]=De)}),Se.contextLayer&&Se.contextLayer.render(Se.panels,!1,!w(Se)),Se.focusLayer.render&&Se.focusLayer.render(Se.panels)}).on("dragend",function(Me){var Se=Me.parent;Me.x=Me.xScale(Me.xIndex),Me.canvasX=Me.x*Me.model.canvasPixelRatio,F(de,Se,U),t.select(this).attr("transform",function(De){return o(De.x,0)}),Se.contextLayer&&Se.contextLayer.render(Se.panels,!1,!w(Se)),Se.focusLayer&&Se.focusLayer.render(Se.panels),Se.pickLayer&&Se.pickLayer.render(Se.panels,!0),re.linePickActive(!0),Y&&Y.axesMoved&&Y.axesMoved(Se.key,Se.dimensions.map(function(De){return De.crossfilterDimensionIndex}))})),de.exit().remove();var ce=de.selectAll("."+m.cn.axisOverlays).data(f,c);ce.enter().append("g").classed(m.cn.axisOverlays,!0),ce.selectAll("."+m.cn.axis).remove();var ve=ce.selectAll("."+m.cn.axis).data(f,c);ve.enter().append("g").classed(m.cn.axis,!0),ve.each(function(Me){var Se=Me.model.height/Me.model.tickDistance,De=Me.domainScale,Be=De.domain();t.select(this).call(t.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Se,Me.tickFormat).tickValues(Me.ordinal?Be:null).tickFormat(function(We){return g.isOrdinal(Me)?We:q(Me.model.dimensions[Me.visibleIndex],We)}).scale(De)),n.font(ve.selectAll("text"),Me.model.tickFont)}),ve.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),ve.selectAll("text").style("text-shadow",a.makeTextShadow(G)).style("cursor","default");var Ee=ce.selectAll("."+m.cn.axisHeading).data(f,c);Ee.enter().append("g").classed(m.cn.axisHeading,!0);var Le=Ee.selectAll("."+m.cn.axisTitle).data(f,c);Le.enter().append("text").classed(m.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),Le.text(function(Me){return Me.label}).each(function(Me){var Se=t.select(this);n.font(Se,Me.model.labelFont),a.convertToTspans(Se,X)}).attr("transform",function(Me){var Se=z(Me.model.labelAngle,Me.model.labelSide),De=m.axisTitleOffset;return(Se.dir>0?"":o(0,2*De+Me.model.height))+l(Se.degrees)+o(-De*Se.dx,-De*Se.dy)}).attr("text-anchor",function(Me){var Se=z(Me.model.labelAngle,Me.model.labelSide);return 2*Math.abs(Se.dx)>Math.abs(Se.dy)?Se.dir*Se.dx<0?"start":"end":"middle"});var Te=ce.selectAll("."+m.cn.axisExtent).data(f,c);Te.enter().append("g").classed(m.cn.axisExtent,!0);var xe=Te.selectAll("."+m.cn.axisExtentTop).data(f,c);xe.enter().append("g").classed(m.cn.axisExtentTop,!0),xe.attr("transform",o(0,-m.axisExtentOffset));var fe=xe.selectAll("."+m.cn.axisExtentTopText).data(f,c);fe.enter().append("text").classed(m.cn.axisExtentTopText,!0).call(P),fe.text(function(Me){return W(Me,!0)}).each(function(Me){n.font(t.select(this),Me.model.rangeFont)});var ge=Te.selectAll("."+m.cn.axisExtentBottom).data(f,c);ge.enter().append("g").classed(m.cn.axisExtentBottom,!0),ge.attr("transform",function(Me){return o(0,Me.model.height+m.axisExtentOffset)});var ke=ge.selectAll("."+m.cn.axisExtentBottomText).data(f,c);ke.enter().append("text").classed(m.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(P),ke.text(function(Me){return W(Me,!1)}).each(function(Me){n.font(t.select(this),Me.model.rangeFont)}),y.ensureAxisBrush(ce,G)}},{"../../components/colorscale":678,"../../components/drawing":688,"../../lib":803,"../../lib/gup":800,"../../lib/svg_text_utils":829,"../../plots/cartesian/axes":854,"./axisbrush":1181,"./constants":1184,"./helpers":1186,"./lines":1188,"@plotly/d3":58,"color-rgba":133}],1191:[function(i,B,V){var t=i("./parcoords"),h=i("../../lib/prepare_regl"),p=i("./helpers").isVisible;function u(e,l,o){var a=l.indexOf(o),n=e.indexOf(a);return n===-1&&(n+=l.length),n}B.exports=function(e,l){var o=e._fullLayout;if(h(e)){var a={},n={},s={},r={},c=o._size;l.forEach(function(f,d){var g=f[0].trace;s[d]=g.index;var m=r[d]=g._fullInput.index;a[d]=e.data[m].dimensions,n[d]=e.data[m].dimensions.slice()}),t(e,l,{width:c.w,height:c.h,margin:{t:c.t,r:c.r,b:c.b,l:c.l}},{filterChanged:function(f,d,g){var m=n[f][d],y=g.map(function(A){return A.slice()}),v="dimensions["+d+"].constraintrange",T=o._tracePreGUI[e._fullData[s[f]]._fullInput.uid];if(T[v]===void 0){var _=m.constraintrange;T[v]=_||null}var k=e._fullData[s[f]].dimensions[d];y.length?(y.length===1&&(y=y[0]),m.constraintrange=y,k.constraintrange=y.slice(),y=[y]):(delete m.constraintrange,delete k.constraintrange,y=null);var E={};E[v]=y,e.emit("plotly_restyle",[E,[r[f]]])},hover:function(f){e.emit("plotly_hover",f)},unhover:function(f){e.emit("plotly_unhover",f)},axesMoved:function(f,d){var g=function(m,y){return function(v,T){return u(m,y,v)-u(m,y,T)}}(d,n[f].filter(p));a[f].sort(g),n[f].filter(function(m){return!p(m)}).sort(function(m){return n[f].indexOf(m)}).forEach(function(m){a[f].splice(a[f].indexOf(m),1),a[f].splice(n[f].indexOf(m),0,m)}),e.emit("plotly_restyle",[{dimensions:[a[f]]},[r[f]]])}})}}},{"../../lib/prepare_regl":816,"./helpers":1186,"./parcoords":1190}],1192:[function(i,B,V){var t=i("../../plots/attributes"),h=i("../../plots/domain").attributes,p=i("../../plots/font_attributes"),u=i("../../components/color/attributes"),e=i("../../plots/template_attributes").hovertemplateAttrs,l=i("../../plots/template_attributes").texttemplateAttrs,o=i("../../lib/extend").extendFlat,a=p({editType:"plot",arrayOk:!0,colorEditType:"plot"});B.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:u.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:o({},t.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:l({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:o({},a,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:o({},a,{}),outsidetextfont:o({},a,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:o({},a,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:h({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:o({},a,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":665,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/domain":882,"../../plots/font_attributes":883,"../../plots/template_attributes":926}],1193:[function(i,B,V){var t=i("../../plots/plots");V.name="pie",V.plot=function(h,p,u,e){t.plotBasePlot(V.name,h,p,u,e)},V.clean=function(h,p,u,e){t.cleanBasePlot(V.name,h,p,u,e)}},{"../../plots/plots":917}],1194:[function(i,B,V){var t=i("fast-isnumeric"),h=i("tinycolor2"),p=i("../../components/color"),u={};function e(o){return function(a,n){return!!a&&!!(a=h(a)).isValid()&&(a=p.addOpacity(a,a.getAlpha()),o[n]||(o[n]=a),a)}}function l(o,a){var n,s=JSON.stringify(o),r=a[s];if(!r){for(r=o.slice(),n=0;n<o.length;n++)r.push(h(o[n]).lighten(20).toHexString());for(n=0;n<o.length;n++)r.push(h(o[n]).darken(20).toHexString());a[s]=r}return r}B.exports={calc:function(o,a){var n,s,r=[],c=o._fullLayout,f=c.hiddenlabels||[],d=a.labels,g=a.marker.colors||[],m=a.values,y=a._length,v=a._hasValues&&y;if(a.dlabel)for(d=new Array(y),n=0;n<y;n++)d[n]=String(a.label0+n*a.dlabel);var T={},_=e(c["_"+a.type+"colormap"]),k=0,E=!1;for(n=0;n<y;n++){var A,b,L;if(v){if(A=m[n],!t(A)||(A=+A)<0)continue}else A=1;(b=d[n])!==void 0&&b!==""||(b=n);var w=T[b=String(b)];w===void 0?(T[b]=r.length,(L=f.indexOf(b)!==-1)||(k+=A),r.push({v:A,label:b,color:_(g[n],b),i:n,pts:[n],hidden:L})):(E=!0,(s=r[w]).v+=A,s.pts.push(n),s.hidden||(k+=A),s.color===!1&&g[n]&&(s.color=_(g[n],b)))}return(a.type==="funnelarea"?E:a.sort)&&r.sort(function(C,S){return S.v-C.v}),r[0]&&(r[0].vTotal=k),r},crossTraceCalc:function(o,a){var n=(a||{}).type;n||(n="pie");var s=o._fullLayout,r=o.calcdata,c=s[n+"colorway"],f=s["_"+n+"colormap"];s["extend"+n+"colors"]&&(c=l(c,u));for(var d=0,g=0;g<r.length;g++){var m=r[g];if(m[0].trace.type===n)for(var y=0;y<m.length;y++){var v=m[y];v.color===!1&&(f[v.label]?v.color=f[v.label]:(f[v.label]=v.color=c[d%c.length],d++))}}},makePullColorFn:e,generateExtendedColors:l}},{"../../components/color":666,"fast-isnumeric":249,tinycolor2:598}],1195:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("./attributes"),u=i("../../plots/domain").defaults,e=i("../bar/defaults").handleText;function l(o,a){var n=Array.isArray(o),s=h.isArrayOrTypedArray(a),r=Math.min(n?o.length:1/0,s?a.length:1/0);if(isFinite(r)||(r=0),r&&s){for(var c,f=0;f<r;f++){var d=a[f];if(t(d)&&d>0){c=!0;break}}c||(r=0)}return{hasLabels:n,hasValues:s,len:r}}B.exports={handleLabelsAndValues:l,supplyDefaults:function(o,a,n,s){function r(_,k){return h.coerce(o,a,p,_,k)}var c=l(r("labels"),r("values")),f=c.len;if(a._hasLabels=c.hasLabels,a._hasValues=c.hasValues,!a._hasLabels&&a._hasValues&&(r("label0"),r("dlabel")),f){a._length=f,r("marker.line.width")&&r("marker.line.color"),r("marker.colors"),r("scalegroup");var d,g=r("text"),m=r("texttemplate");if(m||(d=r("textinfo",Array.isArray(g)?"text+percent":"percent")),r("hovertext"),r("hovertemplate"),m||d&&d!=="none"){var y=r("textposition");e(o,a,s,r,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(y)||y==="auto"||y==="outside")&&r("automargin"),(y==="inside"||y==="auto"||Array.isArray(y))&&r("insidetextorientation")}u(a,s,r);var v=r("hole");if(r("title.text")){var T=r("title.position",v?"middle center":"top center");v||T!=="middle center"||(a.title.position="top center"),h.coerceFont(r,"title.font",s.font)}r("sort"),r("direction"),r("rotation"),r("pull")}else a.visible=!1}}},{"../../lib":803,"../../plots/domain":882,"../bar/defaults":945,"./attributes":1192,"fast-isnumeric":249}],1196:[function(i,B,V){var t=i("../../components/fx/helpers").appendArrayMultiPointValues;B.exports=function(h,p){var u={curveNumber:p.index,pointNumbers:h.pts,data:p._input,fullData:p,label:h.label,color:h.color,value:h.v,percent:h.percent,text:h.text,v:h.v};return h.pts.length===1&&(u.pointNumber=u.i=h.pts[0]),t(u,p,h.pts),p.type==="funnelarea"&&(delete u.v,delete u.i),u}},{"../../components/fx/helpers":702}],1197:[function(i,B,V){var t=i("../../lib");function h(p){return p.indexOf("e")!==-1?p.replace(/[.]?0+e/,"e"):p.indexOf(".")!==-1?p.replace(/[.]?0+$/,""):p}V.formatPiePercent=function(p,u){var e=h((100*p).toPrecision(3));return t.numSeparate(e,u)+"%"},V.formatPieValue=function(p,u){var e=h(p.toPrecision(10));return t.numSeparate(e,u)},V.getFirstFilled=function(p,u){if(Array.isArray(p))for(var e=0;e<u.length;e++){var l=p[u[e]];if(l||l===0||l==="")return l}},V.castOption=function(p,u){return Array.isArray(p)?V.getFirstFilled(p,u):p||void 0},V.getRotationAngle=function(p){return(p==="auto"?0:p)*Math.PI/180}},{"../../lib":803}],1198:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults").supplyDefaults,supplyLayoutDefaults:i("./layout_defaults"),layoutAttributes:i("./layout_attributes"),calc:i("./calc").calc,crossTraceCalc:i("./calc").crossTraceCalc,plot:i("./plot").plot,style:i("./style"),styleOne:i("./style_one"),moduleType:"trace",name:"pie",basePlotModule:i("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1192,"./base_plot":1193,"./calc":1194,"./defaults":1195,"./layout_attributes":1199,"./layout_defaults":1200,"./plot":1201,"./style":1202,"./style_one":1203}],1199:[function(i,B,V){B.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1200:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes");B.exports=function(p,u){function e(l,o){return t.coerce(p,u,h,l,o)}e("hiddenlabels"),e("piecolorway",u.colorway),e("extendpiecolors")}},{"../../lib":803,"./layout_attributes":1199}],1201:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../plots/plots"),p=i("../../components/fx"),u=i("../../components/color"),e=i("../../components/drawing"),l=i("../../lib"),o=l.strScale,a=l.strTranslate,n=i("../../lib/svg_text_utils"),s=i("../bar/uniform_text"),r=s.recordMinTextSize,c=s.clearMinTextSize,f=i("../bar/constants").TEXTPAD,d=i("./helpers"),g=i("./event_data"),m=i("../../lib").isValidTextValue;function y(Q,Z,Y){var N=Y[0],J=N.trace,D=N.cx,U=N.cy;"_hasHoverLabel"in J||(J._hasHoverLabel=!1),"_hasHoverEvent"in J||(J._hasHoverEvent=!1),Q.on("mouseover",function(G){var $=Z._fullLayout,K=Z._fullData[J.index];if(!Z._dragging&&$.hovermode!==!1){var re=K.hoverinfo;if(Array.isArray(re)&&(re=p.castHoverinfo({hoverinfo:[d.castOption(re,G.pts)],_module:J._module},$,0)),re==="all"&&(re="label+text+value+percent+name"),K.hovertemplate||re!=="none"&&re!=="skip"&&re){var ne=G.rInscribed||0,ae=D+G.pxmid[0]*(1-ne),ie=U+G.pxmid[1]*(1-ne),he=$.separators,se=[];if(re&&re.indexOf("label")!==-1&&se.push(G.label),G.text=d.castOption(K.hovertext||K.text,G.pts),re&&re.indexOf("text")!==-1){var de=G.text;l.isValidTextValue(de)&&se.push(de)}G.value=G.v,G.valueLabel=d.formatPieValue(G.v,he),re&&re.indexOf("value")!==-1&&se.push(G.valueLabel),G.percent=G.v/N.vTotal,G.percentLabel=d.formatPiePercent(G.percent,he),re&&re.indexOf("percent")!==-1&&se.push(G.percentLabel);var ce=K.hoverlabel,ve=ce.font;p.loneHover({trace:J,x0:ae-ne*N.r,x1:ae+ne*N.r,y:ie,text:se.join("<br>"),name:K.hovertemplate||re.indexOf("name")!==-1?K.name:void 0,idealAlign:G.pxmid[0]<0?"left":"right",color:d.castOption(ce.bgcolor,G.pts)||G.color,borderColor:d.castOption(ce.bordercolor,G.pts),fontFamily:d.castOption(ve.family,G.pts),fontSize:d.castOption(ve.size,G.pts),fontColor:d.castOption(ve.color,G.pts),nameLength:d.castOption(ce.namelength,G.pts),textAlign:d.castOption(ce.align,G.pts),hovertemplate:d.castOption(K.hovertemplate,G.pts),hovertemplateLabels:G,eventData:[g(G,K)]},{container:$._hoverlayer.node(),outerContainer:$._paper.node(),gd:Z}),J._hasHoverLabel=!0}J._hasHoverEvent=!0,Z.emit("plotly_hover",{points:[g(G,K)],event:t.event})}}),Q.on("mouseout",function(G){var $=Z._fullLayout,K=Z._fullData[J.index],re=t.select(this).datum();J._hasHoverEvent&&(G.originalEvent=t.event,Z.emit("plotly_unhover",{points:[g(re,K)],event:t.event}),J._hasHoverEvent=!1),J._hasHoverLabel&&(p.loneUnhover($._hoverlayer.node()),J._hasHoverLabel=!1)}),Q.on("click",function(G){var $=Z._fullLayout,K=Z._fullData[J.index];Z._dragging||$.hovermode===!1||(Z._hoverdata=[g(G,K)],p.click(Z,t.event))})}function v(Q,Z,Y){var N=d.castOption(Q.insidetextfont.color,Z.pts);!N&&Q._input.textfont&&(N=d.castOption(Q._input.textfont.color,Z.pts));var J=d.castOption(Q.insidetextfont.family,Z.pts)||d.castOption(Q.textfont.family,Z.pts)||Y.family,D=d.castOption(Q.insidetextfont.size,Z.pts)||d.castOption(Q.textfont.size,Z.pts)||Y.size;return{color:N||u.contrast(Z.color),family:J,size:D}}function T(Q,Z){for(var Y,N,J=0;J<Q.length;J++)if((N=(Y=Q[J][0]).trace).title.text){var D=N.title.text;N._meta&&(D=l.templateString(D,N._meta));var U=e.tester.append("text").attr("data-notex",1).text(D).call(e.font,N.title.font).call(n.convertToTspans,Z),G=e.bBox(U.node(),!0);Y.titleBox={width:G.width,height:G.height},U.remove()}}function _(Q,Z,Y){var N=Y.r||Z.rpx1,J=Z.rInscribed;if(Z.startangle===Z.stopangle)return{rCenter:1-J,scale:0,rotate:0,textPosAngle:0};var D,U=Z.ring,G=U===1&&Math.abs(Z.startangle-Z.stopangle)===2*Math.PI,$=Z.halfangle,K=Z.midangle,re=Y.trace.insidetextorientation,ne=re==="horizontal",ae=re==="tangential",ie=re==="radial",he=re==="auto",se=[];if(!he){var de,ce=function(fe,ge){if(function(De,Be){var We=De.startangle,Qe=De.stopangle;return We>Be&&Be>Qe||We<Be&&Be<Qe}(Z,fe)){var ke=Math.abs(fe-Z.startangle),Me=Math.abs(fe-Z.stopangle),Se=ke<Me?ke:Me;(D=ge==="tan"?E(Q,N,U,Se,0):k(Q,N,U,Se,Math.PI/2)).textPosAngle=fe,se.push(D)}};if(ne||ae){for(de=4;de>=-4;de-=2)ce(Math.PI*de,"tan");for(de=4;de>=-4;de-=2)ce(Math.PI*(de+1),"tan")}if(ne||ie){for(de=4;de>=-4;de-=2)ce(Math.PI*(de+1.5),"rad");for(de=4;de>=-4;de-=2)ce(Math.PI*(de+.5),"rad")}}if(G||he||ne){var ve=Math.sqrt(Q.width*Q.width+Q.height*Q.height);if((D={scale:J*N*2/ve,rCenter:1-J,rotate:0}).textPosAngle=(Z.startangle+Z.stopangle)/2,D.scale>=1)return D;se.push(D)}(he||ie)&&((D=k(Q,N,U,$,K)).textPosAngle=(Z.startangle+Z.stopangle)/2,se.push(D)),(he||ae)&&((D=E(Q,N,U,$,K)).textPosAngle=(Z.startangle+Z.stopangle)/2,se.push(D));for(var Ee=0,Le=0,Te=0;Te<se.length;Te++){var xe=se[Te].scale;if(Le<xe&&(Le=xe,Ee=Te),!he&&Le>=1)break}return se[Ee]}function k(Q,Z,Y,N,J){Z=Math.max(0,Z-2*f);var D=Q.width/Q.height,U=L(D,N,Z,Y);return{scale:2*U/Q.height,rCenter:A(D,U/Z),rotate:b(J)}}function E(Q,Z,Y,N,J){Z=Math.max(0,Z-2*f);var D=Q.height/Q.width,U=L(D,N,Z,Y);return{scale:2*U/Q.width,rCenter:A(D,U/Z),rotate:b(J+Math.PI/2)}}function A(Q,Z){return Math.cos(Z)-Q*Z}function b(Q){return(180/Math.PI*Q+720)%180-90}function L(Q,Z,Y,N){var J=Q+1/(2*Math.tan(Z));return Y*Math.min(1/(Math.sqrt(J*J+.5)+J),N/(Math.sqrt(Q*Q+N/2)+Q))}function w(Q,Z){return Q.v!==Z.vTotal||Z.trace.hole?Math.min(1/(1+1/Math.sin(Q.halfangle)),Q.ring/2):1}function C(Q,Z){var Y=Z.pxmid[0],N=Z.pxmid[1],J=Q.width/2,D=Q.height/2;return Y<0&&(J*=-1),N<0&&(D*=-1),{scale:1,rCenter:1,rotate:0,x:J+Math.abs(D)*(J>0?1:-1)/2,y:D/(1+Y*Y/(N*N)),outside:!0}}function S(Q,Z){var Y,N,J,D=Q.trace,U={x:Q.cx,y:Q.cy},G={tx:0,ty:0};G.ty+=D.title.font.size,J=z(D),D.title.position.indexOf("top")!==-1?(U.y-=(1+J)*Q.r,G.ty-=Q.titleBox.height):D.title.position.indexOf("bottom")!==-1&&(U.y+=(1+J)*Q.r);var $,K,re=($=Q.r,K=Q.trace.aspectratio,$/(K===void 0?1:K)),ne=Z.w*(D.domain.x[1]-D.domain.x[0])/2;return D.title.position.indexOf("left")!==-1?(ne+=re,U.x-=(1+J)*re,G.tx+=Q.titleBox.width/2):D.title.position.indexOf("center")!==-1?ne*=2:D.title.position.indexOf("right")!==-1&&(ne+=re,U.x+=(1+J)*re,G.tx-=Q.titleBox.width/2),Y=ne/Q.titleBox.width,N=P(Q,Z)/Q.titleBox.height,{x:U.x,y:U.y,scale:Math.min(Y,N),tx:G.tx,ty:G.ty}}function P(Q,Z){var Y=Q.trace,N=Z.h*(Y.domain.y[1]-Y.domain.y[0]);return Math.min(Q.titleBox.height,N/2)}function z(Q){var Z,Y=Q.pull;if(!Y)return 0;if(Array.isArray(Y))for(Y=0,Z=0;Z<Q.pull.length;Z++)Q.pull[Z]>Y&&(Y=Q.pull[Z]);return Y}function F(Q,Z){for(var Y=[],N=0;N<Q.length;N++){var J=Q[N][0],D=J.trace,U=D.domain,G=Z.w*(U.x[1]-U.x[0]),$=Z.h*(U.y[1]-U.y[0]);D.title.text&&D.title.position!=="middle center"&&($-=P(J,Z));var K=G/2,re=$/2;D.type!=="funnelarea"||D.scalegroup||(re/=D.aspectratio),J.r=Math.min(K,re)/(1+z(D)),J.cx=Z.l+Z.w*(D.domain.x[1]+D.domain.x[0])/2,J.cy=Z.t+Z.h*(1-D.domain.y[0])-$/2,D.title.text&&D.title.position.indexOf("bottom")!==-1&&(J.cy-=P(J,Z)),D.scalegroup&&Y.indexOf(D.scalegroup)===-1&&Y.push(D.scalegroup)}(function(ne,ae){for(var ie,he,se,de=0;de<ae.length;de++){var ce=1/0,ve=ae[de];for(he=0;he<ne.length;he++)if(ie=ne[he][0],(se=ie.trace).scalegroup===ve){var Ee;if(se.type==="pie")Ee=ie.r*ie.r;else if(se.type==="funnelarea"){var Le,Te;se.aspectratio>1?(Le=ie.r,Te=Le/se.aspectratio):(Te=ie.r,Le=Te*se.aspectratio),Le*=(1+se.baseratio)/2,Ee=Le*Te}ce=Math.min(ce,Ee/ie.vTotal)}for(he=0;he<ne.length;he++)if(ie=ne[he][0],(se=ie.trace).scalegroup===ve){var xe=ce*ie.vTotal;se.type==="funnelarea"&&(xe/=(1+se.baseratio)/2,xe/=se.aspectratio),ie.r=Math.sqrt(xe)}}})(Q,Y)}function q(Q,Z){return[Q*Math.sin(Z),-Q*Math.cos(Z)]}function W(Q,Z,Y){var N=Q._fullLayout,J=Y.trace,D=J.texttemplate,U=J.textinfo;if(!D&&U&&U!=="none"){var G,$=U.split("+"),K=function(Ee){return $.indexOf(Ee)!==-1},re=K("label"),ne=K("text"),ae=K("value"),ie=K("percent"),he=N.separators;if(G=re?[Z.label]:[],ne){var se=d.getFirstFilled(J.text,Z.pts);m(se)&&G.push(se)}ae&&G.push(d.formatPieValue(Z.v,he)),ie&&G.push(d.formatPiePercent(Z.v/Y.vTotal,he)),Z.text=G.join("<br>")}if(D){var de=l.castOption(J,Z.i,"texttemplate");if(de){var ce=function(Ee){return{label:Ee.label,value:Ee.v,valueLabel:d.formatPieValue(Ee.v,N.separators),percent:Ee.v/Y.vTotal,percentLabel:d.formatPiePercent(Ee.v/Y.vTotal,N.separators),color:Ee.color,text:Ee.text,customdata:l.castOption(J,Ee.i,"customdata")}}(Z),ve=d.getFirstFilled(J.text,Z.pts);(m(ve)||ve==="")&&(ce.text=ve),Z.text=l.texttemplateString(de,ce,Q._fullLayout._d3locale,ce,J._meta||{})}else Z.text=""}}function X(Q,Z){var Y=Q.rotate*Math.PI/180,N=Math.cos(Y),J=Math.sin(Y),D=(Z.left+Z.right)/2,U=(Z.top+Z.bottom)/2;Q.textX=D*N-U*J,Q.textY=D*J+U*N,Q.noCenter=!0}B.exports={plot:function(Q,Z){var Y=Q._fullLayout,N=Y._size;c("pie",Y),T(Z,Q),F(Z,N);var J=l.makeTraceGroups(Y._pielayer,Z,"trace").each(function(D){var U=t.select(this),G=D[0],$=G.trace;(function(K){var re,ne,ae,ie=K[0],he=ie.r,se=ie.trace,de=d.getRotationAngle(se.rotation),ce=2*Math.PI/ie.vTotal,ve="px0",Ee="px1";if(se.direction==="counterclockwise"){for(re=0;re<K.length&&K[re].hidden;re++);if(re===K.length)return;de+=ce*K[re].v,ce*=-1,ve="px1",Ee="px0"}for(ae=q(he,de),re=0;re<K.length;re++)(ne=K[re]).hidden||(ne[ve]=ae,ne.startangle=de,de+=ce*ne.v/2,ne.pxmid=q(he,de),ne.midangle=de,de+=ce*ne.v/2,ae=q(he,de),ne.stopangle=de,ne[Ee]=ae,ne.largeArc=ne.v>ie.vTotal/2?1:0,ne.halfangle=Math.PI*Math.min(ne.v/ie.vTotal,.5),ne.ring=1-se.hole,ne.rInscribed=w(ne,ie))})(D),U.attr("stroke-linejoin","round"),U.each(function(){var K=t.select(this).selectAll("g.slice").data(D);K.enter().append("g").classed("slice",!0),K.exit().remove();var re=[[[],[]],[[],[]]],ne=!1;K.each(function(Ee,Le){if(Ee.hidden)t.select(this).selectAll("path,g").remove();else{Ee.pointNumber=Ee.i,Ee.curveNumber=$.index,re[Ee.pxmid[1]<0?0:1][Ee.pxmid[0]<0?0:1].push(Ee);var Te=G.cx,xe=G.cy,fe=t.select(this),ge=fe.selectAll("path.surface").data([Ee]);if(ge.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),fe.call(y,Q,D),$.pull){var ke=+d.castOption($.pull,Ee.pts)||0;ke>0&&(Te+=ke*Ee.pxmid[0],xe+=ke*Ee.pxmid[1])}Ee.cxFinal=Te,Ee.cyFinal=xe;var Me=$.hole;if(Ee.v===G.vTotal){var Se="M"+(Te+Ee.px0[0])+","+(xe+Ee.px0[1])+Oe(Ee.px0,Ee.pxmid,!0,1)+Oe(Ee.pxmid,Ee.px0,!0,1)+"Z";Me?ge.attr("d","M"+(Te+Me*Ee.px0[0])+","+(xe+Me*Ee.px0[1])+Oe(Ee.px0,Ee.pxmid,!1,Me)+Oe(Ee.pxmid,Ee.px0,!1,Me)+"Z"+Se):ge.attr("d",Se)}else{var De=Oe(Ee.px0,Ee.px1,!0,1);if(Me){var Be=1-Me;ge.attr("d","M"+(Te+Me*Ee.px1[0])+","+(xe+Me*Ee.px1[1])+Oe(Ee.px1,Ee.px0,!1,Me)+"l"+Be*Ee.px0[0]+","+Be*Ee.px0[1]+De+"Z")}else ge.attr("d","M"+Te+","+xe+"l"+Ee.px0[0]+","+Ee.px0[1]+De+"Z")}W(Q,Ee,G);var We=d.castOption($.textposition,Ee.pts),Qe=fe.selectAll("g.slicetext").data(Ee.text&&We!=="none"?[0]:[]);Qe.enter().append("g").classed("slicetext",!0),Qe.exit().remove(),Qe.each(function(){var Ue=l.ensureSingle(t.select(this),"text","",function(tt){tt.attr("data-notex",1)}),Xe=l.ensureUniformFontSize(Q,We==="outside"?function(tt,Ke,Mt){var Jt=d.castOption(tt.outsidetextfont.color,Ke.pts)||d.castOption(tt.textfont.color,Ke.pts)||Mt.color,$t=d.castOption(tt.outsidetextfont.family,Ke.pts)||d.castOption(tt.textfont.family,Ke.pts)||Mt.family,je=d.castOption(tt.outsidetextfont.size,Ke.pts)||d.castOption(tt.textfont.size,Ke.pts)||Mt.size;return{color:Jt,family:$t,size:je}}($,Ee,Y.font):v($,Ee,Y.font));Ue.text(Ee.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,Xe).call(n.convertToTspans,Q);var Ye,$e=e.bBox(Ue.node());if(We==="outside")Ye=C($e,Ee);else if(Ye=_($e,Ee,G),We==="auto"&&Ye.scale<1){var it=l.ensureUniformFontSize(Q,$.outsidetextfont);Ue.call(e.font,it),Ye=C($e=e.bBox(Ue.node()),Ee)}var ot=Ye.textPosAngle,Et=ot===void 0?Ee.pxmid:q(G.r,ot);if(Ye.targetX=Te+Et[0]*Ye.rCenter+(Ye.x||0),Ye.targetY=xe+Et[1]*Ye.rCenter+(Ye.y||0),X(Ye,$e),Ye.outside){var mt=Ye.targetY;Ee.yLabelMin=mt-$e.height/2,Ee.yLabelMid=mt,Ee.yLabelMax=mt+$e.height/2,Ee.labelExtraX=0,Ee.labelExtraY=0,ne=!0}Ye.fontSize=Xe.size,r($.type,Ye,Y),D[Le].transform=Ye,Ue.attr("transform",l.getTextTransform(Ye))})}function Oe(Ue,Xe,Ye,$e){var it=$e*(Xe[0]-Ue[0]),ot=$e*(Xe[1]-Ue[1]);return"a"+$e*G.r+","+$e*G.r+" 0 "+Ee.largeArc+(Ye?" 1 ":" 0 ")+it+","+ot}});var ae=t.select(this).selectAll("g.titletext").data($.title.text?[0]:[]);if(ae.enter().append("g").classed("titletext",!0),ae.exit().remove(),ae.each(function(){var Ee,Le=l.ensureSingle(t.select(this),"text","",function(xe){xe.attr("data-notex",1)}),Te=$.title.text;$._meta&&(Te=l.templateString(Te,$._meta)),Le.text(Te).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,$.title.font).call(n.convertToTspans,Q),Ee=$.title.position==="middle center"?function(xe){var fe=Math.sqrt(xe.titleBox.width*xe.titleBox.width+xe.titleBox.height*xe.titleBox.height);return{x:xe.cx,y:xe.cy,scale:xe.trace.hole*xe.r*2/fe,tx:0,ty:-xe.titleBox.height/2+xe.trace.title.font.size}}(G):S(G,N),Le.attr("transform",a(Ee.x,Ee.y)+o(Math.min(1,Ee.scale))+a(Ee.tx,Ee.ty))}),ne&&function(Ee,Le){var Te,xe,fe,ge,ke,Me,Se,De,Be,We,Qe,Oe,Ue;function Xe(ot,Et){return ot.pxmid[1]-Et.pxmid[1]}function Ye(ot,Et){return Et.pxmid[1]-ot.pxmid[1]}function $e(ot,Et){Et||(Et={});var mt,tt,Ke,Mt,Jt=Et.labelExtraY+(xe?Et.yLabelMax:Et.yLabelMin),$t=xe?ot.yLabelMin:ot.yLabelMax,je=xe?ot.yLabelMax:ot.yLabelMin,Ge=ot.cyFinal+ke(ot.px0[1],ot.px1[1]),Ct=Jt-$t;if(Ct*Se>0&&(ot.labelExtraY=Ct),Array.isArray(Le.pull))for(tt=0;tt<We.length;tt++)(Ke=We[tt])===ot||(d.castOption(Le.pull,ot.pts)||0)>=(d.castOption(Le.pull,Ke.pts)||0)||((ot.pxmid[1]-Ke.pxmid[1])*Se>0?(Ct=Ke.cyFinal+ke(Ke.px0[1],Ke.px1[1])-$t-ot.labelExtraY)*Se>0&&(ot.labelExtraY+=Ct):(je+ot.labelExtraY-Ge)*Se>0&&(mt=3*Me*Math.abs(tt-We.indexOf(ot)),(Mt=Ke.cxFinal+ge(Ke.px0[0],Ke.px1[0])+mt-(ot.cxFinal+ot.pxmid[0])-ot.labelExtraX)*Me>0&&(ot.labelExtraX+=Mt)))}for(xe=0;xe<2;xe++)for(fe=xe?Xe:Ye,ke=xe?Math.max:Math.min,Se=xe?1:-1,Te=0;Te<2;Te++){for(ge=Te?Math.max:Math.min,Me=Te?1:-1,(De=Ee[xe][Te]).sort(fe),Be=Ee[1-xe][Te],We=Be.concat(De),Oe=[],Qe=0;Qe<De.length;Qe++)De[Qe].yLabelMid!==void 0&&Oe.push(De[Qe]);for(Ue=!1,Qe=0;xe&&Qe<Be.length;Qe++)if(Be[Qe].yLabelMid!==void 0){Ue=Be[Qe];break}for(Qe=0;Qe<Oe.length;Qe++){var it=Qe&&Oe[Qe-1];Ue&&!Qe&&(it=Ue),$e(Oe[Qe],it)}}}(re,$),function(Ee,Le){Ee.each(function(Te){var xe=t.select(this);if(Te.labelExtraX||Te.labelExtraY){var fe=xe.select("g.slicetext text");Te.transform.targetX+=Te.labelExtraX,Te.transform.targetY+=Te.labelExtraY,fe.attr("transform",l.getTextTransform(Te.transform));var ge=Te.cxFinal+Te.pxmid[0],ke="M"+ge+","+(Te.cyFinal+Te.pxmid[1]),Me=(Te.yLabelMax-Te.yLabelMin)*(Te.pxmid[0]<0?-1:1)/4;if(Te.labelExtraX){var Se=Te.labelExtraX*Te.pxmid[1]/Te.pxmid[0],De=Te.yLabelMid+Te.labelExtraY-(Te.cyFinal+Te.pxmid[1]);Math.abs(Se)>Math.abs(De)?ke+="l"+De*Te.pxmid[0]/Te.pxmid[1]+","+De+"H"+(ge+Te.labelExtraX+Me):ke+="l"+Te.labelExtraX+","+Se+"v"+(De-Se)+"h"+Me}else ke+="V"+(Te.yLabelMid+Te.labelExtraY)+"h"+Me;l.ensureSingle(xe,"path","textline").call(u.stroke,Le.outsidetextfont.color).attr({"stroke-width":Math.min(2,Le.outsidetextfont.size/8),d:ke,fill:"none"})}else xe.select("path.textline").remove()})}(K,$),ne&&$.automargin){var ie=e.bBox(U.node()),he=$.domain,se=N.w*(he.x[1]-he.x[0]),de=N.h*(he.y[1]-he.y[0]),ce=(.5*se-G.r)/N.w,ve=(.5*de-G.r)/N.h;h.autoMargin(Q,"pie."+$.uid+".automargin",{xl:he.x[0]-ce,xr:he.x[1]+ce,yb:he.y[0]-ve,yt:he.y[1]+ve,l:Math.max(G.cx-G.r-ie.left,0),r:Math.max(ie.right-(G.cx+G.r),0),b:Math.max(ie.bottom-(G.cy+G.r),0),t:Math.max(G.cy-G.r-ie.top,0),pad:5})}})});setTimeout(function(){J.selectAll("tspan").each(function(){var D=t.select(this);D.attr("dy")&&D.attr("dy",D.attr("dy"))})},0)},formatSliceLabel:W,transformInsideText:_,determineInsideTextFont:v,positionTitleOutside:S,prerenderTitles:T,layoutAreas:F,attachFxHandlers:y,computeTransform:X}},{"../../components/color":666,"../../components/drawing":688,"../../components/fx":706,"../../lib":803,"../../lib/svg_text_utils":829,"../../plots/plots":917,"../bar/constants":943,"../bar/uniform_text":957,"./event_data":1196,"./helpers":1197,"@plotly/d3":58}],1202:[function(i,B,V){var t=i("@plotly/d3"),h=i("./style_one"),p=i("../bar/uniform_text").resizeText;B.exports=function(u){var e=u._fullLayout._pielayer.selectAll(".trace");p(u,e,"pie"),e.each(function(l){var o=l[0].trace,a=t.select(this);a.style({opacity:o.opacity}),a.selectAll("path.surface").each(function(n){t.select(this).call(h,n,o)})})}},{"../bar/uniform_text":957,"./style_one":1203,"@plotly/d3":58}],1203:[function(i,B,V){var t=i("../../components/color"),h=i("./helpers").castOption;B.exports=function(p,u,e){var l=e.marker.line,o=h(l.color,u.pts)||t.defaultLine,a=h(l.width,u.pts)||0;p.style("stroke-width",a).call(t.fill,u.color).call(t.stroke,o)}},{"../../components/color":666,"./helpers":1197}],1204:[function(i,B,V){var t=i("../scatter/attributes");B.exports={x:t.x,y:t.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:t.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":1218}],1205:[function(i,B,V){var t=i("gl-pointcloud2d"),h=i("../../lib/str2rgbarray"),p=i("../../plots/cartesian/autorange").findExtremes,u=i("../scatter/get_trace_color");function e(o,a){this.scene=o,this.uid=a,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=t(o.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var l=e.prototype;l.handlePick=function(o){var a=this.idToIndex[o.pointId];return{trace:this,dataCoord:o.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*a],this.pickXYData[2*a+1]]:[this.pickXData[a],this.pickYData[a]],textLabel:Array.isArray(this.textLabels)?this.textLabels[a]:this.textLabels,color:this.color,name:this.name,pointIndex:a,hoverinfo:this.hoverinfo}},l.update=function(o){this.index=o.index,this.textLabels=o.text,this.name=o.name,this.hoverinfo=o.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(o),this.color=u(o,{})},l.updateFast=function(o){var a,n,s,r,c,f,d=this.xData=this.pickXData=o.x,g=this.yData=this.pickYData=o.y,m=this.pickXYData=o.xy,y=o.xbounds&&o.ybounds,v=o.indices,T=this.bounds;if(m){if(s=m,a=m.length>>>1,y)T[0]=o.xbounds[0],T[2]=o.xbounds[1],T[1]=o.ybounds[0],T[3]=o.ybounds[1];else for(f=0;f<a;f++)r=s[2*f],c=s[2*f+1],r<T[0]&&(T[0]=r),r>T[2]&&(T[2]=r),c<T[1]&&(T[1]=c),c>T[3]&&(T[3]=c);if(v)n=v;else for(n=new Int32Array(a),f=0;f<a;f++)n[f]=f}else for(a=d.length,s=new Float32Array(2*a),n=new Int32Array(a),f=0;f<a;f++)r=d[f],c=g[f],n[f]=f,s[2*f]=r,s[2*f+1]=c,r<T[0]&&(T[0]=r),r>T[2]&&(T[2]=r),c<T[1]&&(T[1]=c),c>T[3]&&(T[3]=c);this.idToIndex=n,this.pointcloudOptions.idToIndex=n,this.pointcloudOptions.positions=s;var _=h(o.marker.color),k=h(o.marker.border.color),E=o.opacity*o.marker.opacity;_[3]*=E,this.pointcloudOptions.color=_;var A=o.marker.blend;A===null&&(A=d.length<100||g.length<100),this.pointcloudOptions.blend=A,k[3]*=E,this.pointcloudOptions.borderColor=k;var b=o.marker.sizemin,L=Math.max(o.marker.sizemax,o.marker.sizemin);this.pointcloudOptions.sizeMin=b,this.pointcloudOptions.sizeMax=L,this.pointcloudOptions.areaRatio=o.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var w=this.scene.xaxis,C=this.scene.yaxis,S=L/2||.5;o._extremes[w._id]=p(w,[T[0],T[2]],{ppad:S}),o._extremes[C._id]=p(C,[T[1],T[3]],{ppad:S})},l.dispose=function(){this.pointcloud.dispose()},B.exports=function(o,a){var n=new e(o,a.uid);return n.update(a),n}},{"../../lib/str2rgbarray":828,"../../plots/cartesian/autorange":853,"../scatter/get_trace_color":1228,"gl-pointcloud2d":328}],1206:[function(i,B,V){var t=i("../../lib"),h=i("./attributes");B.exports=function(p,u,e){function l(o,a){return t.coerce(p,u,h,o,a)}l("x"),l("y"),l("xbounds"),l("ybounds"),p.xy&&p.xy instanceof Float32Array&&(u.xy=p.xy),p.indices&&p.indices instanceof Int32Array&&(u.indices=p.indices),l("text"),l("marker.color",e),l("marker.opacity"),l("marker.blend"),l("marker.sizemin"),l("marker.sizemax"),l("marker.border.color",e),l("marker.border.arearatio"),u._length=null}},{"../../lib":803,"./attributes":1204}],1207:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("../scatter3d/calc"),plot:i("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:i("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":894,"../scatter3d/calc":1247,"./attributes":1204,"./convert":1205,"./defaults":1206}],1208:[function(i,B,V){var t=i("../../plots/font_attributes"),h=i("../../plots/attributes"),p=i("../../components/color/attributes"),u=i("../../components/fx/attributes"),e=i("../../plots/domain").attributes,l=i("../../plots/template_attributes").hovertemplateAttrs,o=i("../../components/colorscale/attributes"),a=i("../../plot_api/plot_template").templatedArray,n=i("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,s=i("../../lib/extend").extendFlat,r=i("../../plot_api/edit_types").overrideAll;(B.exports=r({hoverinfo:s({},h.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:u.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:n("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:t({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:p.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:u.hoverlabel,hovertemplate:l({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:p.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:u.hoverlabel,hovertemplate:l({},{keys:["value","label"]}),colorscales:a("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:s(o().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":665,"../../components/colorscale/attributes":673,"../../components/fx/attributes":697,"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plot_api/plot_template":843,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/domain":882,"../../plots/font_attributes":883,"../../plots/template_attributes":926}],1209:[function(i,B,V){var t=i("../../plot_api/edit_types").overrideAll,h=i("../../plots/get_data").getModuleCalcData,p=i("./plot"),u=i("../../components/fx/layout_attributes"),e=i("../../lib/setcursor"),l=i("../../components/dragelement"),o=i("../../plots/cartesian/select").prepSelect,a=i("../../lib"),n=i("../../registry");function s(r,c){var f=r._fullData[c],d=r._fullLayout,g=d.dragmode,m=d.dragmode==="pan"?"move":"crosshair",y=f._bgRect;if(g!=="pan"&&g!=="zoom"){e(y,m);var v={_id:"x",c2p:a.identity,_offset:f._sankey.translateX,_length:f._sankey.width},T={_id:"y",c2p:a.identity,_offset:f._sankey.translateY,_length:f._sankey.height},_={gd:r,element:y.node(),plotinfo:{id:c,xaxis:v,yaxis:T,fillRangeItems:a.noop},subplot:c,xaxes:[v],yaxes:[T],doneFnCompleted:function(k){var E,A=r._fullData[c],b=A.node.groups.slice(),L=[];function w(z){for(var F=A._sankey.graph.nodes,q=0;q<F.length;q++)if(F[q].pointNumber===z)return F[q]}for(var C=0;C<k.length;C++){var S=w(k[C].pointNumber);if(S)if(S.group){for(var P=0;P<S.childrenNodes.length;P++)L.push(S.childrenNodes[P].pointNumber);b[S.pointNumber-A.node._count]=!1}else L.push(S.pointNumber)}E=b.filter(Boolean).concat([L]),n.call("_guiRestyle",r,{"node.groups":[E]},c)},prepFn:function(k,E,A){o(k,E,A,_,g)}};l.init(_)}}V.name="sankey",V.baseLayoutAttrOverrides=t({hoverlabel:u.hoverlabel},"plot","nested"),V.plot=function(r){var c=h(r.calcdata,"sankey")[0];p(r,c),V.updateFx(r)},V.clean=function(r,c,f,d){var g=d._has&&d._has("sankey"),m=c._has&&c._has("sankey");g&&!m&&(d._paperdiv.selectAll(".sankey").remove(),d._paperdiv.selectAll(".bgsankey").remove())},V.updateFx=function(r){for(var c=0;c<r._fullData.length;c++)s(r,c)}},{"../../components/dragelement":685,"../../components/fx/layout_attributes":707,"../../lib":803,"../../lib/setcursor":824,"../../plot_api/edit_types":836,"../../plots/cartesian/select":874,"../../plots/get_data":891,"../../registry":931,"./plot":1214}],1210:[function(i,B,V){var t=i("strongly-connected-components"),h=i("../../lib"),p=i("../../lib/gup").wrap,u=h.isArrayOrTypedArray,e=h.isIndex,l=i("../../components/colorscale");function o(a){var n,s=a.node,r=a.link,c=[],f=u(r.color),d=u(r.customdata),g={},m={},y=r.colorscales.length;for(n=0;n<y;n++){var v=r.colorscales[n],T=l.extractScale(v,{cLetter:"c"}),_=l.makeColorScaleFunc(T);m[v.label]=_}var k=0;for(n=0;n<r.value.length;n++)r.source[n]>k&&(k=r.source[n]),r.target[n]>k&&(k=r.target[n]);var E,A=k+1;a.node._count=A;var b=a.node.groups,L={};for(n=0;n<b.length;n++){var w=b[n];for(E=0;E<w.length;E++){var C=w[E],S=A+n;L.hasOwnProperty(C)?h.warn("Node "+C+" is already part of a group."):L[C]=S}}var P={source:[],target:[]};for(n=0;n<r.value.length;n++){var z=r.value[n],F=r.source[n],q=r.target[n];if(z>0&&e(F,A)&&e(q,A)&&(!L.hasOwnProperty(F)||!L.hasOwnProperty(q)||L[F]!==L[q])){L.hasOwnProperty(q)&&(q=L[q]),L.hasOwnProperty(F)&&(F=L[F]),q=+q,g[F=+F]=g[q]=!0;var W="";r.label&&r.label[n]&&(W=r.label[n]);var X=null;W&&m.hasOwnProperty(W)&&(X=m[W]),c.push({pointNumber:n,label:W,color:f?r.color[n]:r.color,customdata:d?r.customdata[n]:r.customdata,concentrationscale:X,source:F,target:q,value:+z}),P.source.push(F),P.target.push(q)}}var Q=A+b.length,Z=u(s.color),Y=u(s.customdata),N=[];for(n=0;n<Q;n++)if(g[n]){var J=s.label[n];N.push({group:n>A-1,childrenNodes:[],pointNumber:n,label:J,color:Z?s.color[n]:s.color,customdata:Y?s.customdata[n]:s.customdata})}var D=!1;return function(U,G,$){for(var K=h.init2dArray(U,0),re=0;re<Math.min(G.length,$.length);re++)if(h.isIndex(G[re],U)&&h.isIndex($[re],U)){if(G[re]===$[re])return!0;K[G[re]].push($[re])}return t(K).components.some(function(ne){return ne.length>1})}(Q,P.source,P.target)&&(D=!0),{circular:D,links:c,nodes:N,groups:b,groupLookup:L}}B.exports=function(a,n){var s=o(n);return p({circular:s.circular,_nodes:s.nodes,_links:s.links,_groups:s.groups,_groupLookup:s.groupLookup})}},{"../../components/colorscale":678,"../../lib":803,"../../lib/gup":800,"strongly-connected-components":590}],1211:[function(i,B,V){B.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],1212:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("../../components/color"),u=i("tinycolor2"),e=i("../../plots/domain").defaults,l=i("../../components/fx/hoverlabel_defaults"),o=i("../../plot_api/plot_template"),a=i("../../plots/array_container_defaults");function n(s,r){function c(f,d){return t.coerce(s,r,h.link.colorscales,f,d)}c("label"),c("cmin"),c("cmax"),c("colorscale")}B.exports=function(s,r,c,f){function d(L,w){return t.coerce(s,r,h,L,w)}var g=t.extendDeep(f.hoverlabel,s.hoverlabel),m=s.node,y=o.newContainer(r,"node");function v(L,w){return t.coerce(m,y,h.node,L,w)}v("label"),v("groups"),v("x"),v("y"),v("pad"),v("thickness"),v("line.color"),v("line.width"),v("hoverinfo",s.hoverinfo),l(m,y,v,g),v("hovertemplate");var T=f.colorway;v("color",y.label.map(function(L,w){return p.addOpacity(function(C){return T[C%T.length]}(w),.8)})),v("customdata");var _=s.link||{},k=o.newContainer(r,"link");function E(L,w){return t.coerce(_,k,h.link,L,w)}E("label"),E("source"),E("target"),E("value"),E("line.color"),E("line.width"),E("hoverinfo",s.hoverinfo),l(_,k,E,g),E("hovertemplate");var A,b=u(f.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";E("color",t.repeat(b,k.value.length)),E("customdata"),a(_,k,{name:"colorscales",handleItemDefaults:n}),e(r,f,d),d("orientation"),d("valueformat"),d("valuesuffix"),y.x.length&&y.y.length&&(A="freeform"),d("arrangement",A),t.coerceFont(d,"textfont",t.extendFlat({},f.font)),r._length=null}},{"../../components/color":666,"../../components/fx/hoverlabel_defaults":704,"../../lib":803,"../../plot_api/plot_template":843,"../../plots/array_container_defaults":849,"../../plots/domain":882,"./attributes":1208,tinycolor2:598}],1213:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("./calc"),plot:i("./plot"),moduleType:"trace",name:"sankey",basePlotModule:i("./base_plot"),selectPoints:i("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1208,"./base_plot":1209,"./calc":1210,"./defaults":1212,"./plot":1214,"./select.js":1216}],1214:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=h.numberFormat,u=i("./render"),e=i("../../components/fx"),l=i("../../components/color"),o=i("./constants").cn,a=h._;function n(_){return _!==""}function s(_,k){return _.filter(function(E){return E.key===k.traceId})}function r(_,k){t.select(_).select("path").style("fill-opacity",k),t.select(_).select("rect").style("fill-opacity",k)}function c(_){t.select(_).select("text.name").style("fill","black")}function f(_){return function(k){return _.node.sourceLinks.indexOf(k.link)!==-1||_.node.targetLinks.indexOf(k.link)!==-1}}function d(_){return function(k){return k.node.sourceLinks.indexOf(_.link)!==-1||k.node.targetLinks.indexOf(_.link)!==-1}}function g(_,k,E){k&&E&&s(E,k).selectAll("."+o.sankeyLink).filter(f(k)).call(y.bind(0,k,E,!1))}function m(_,k,E){k&&E&&s(E,k).selectAll("."+o.sankeyLink).filter(f(k)).call(v.bind(0,k,E,!1))}function y(_,k,E,A){var b=A.datum().link.label;A.style("fill-opacity",function(L){if(!L.link.concentrationscale)return .4}),b&&s(k,_).selectAll("."+o.sankeyLink).filter(function(L){return L.link.label===b}).style("fill-opacity",function(L){if(!L.link.concentrationscale)return .4}),E&&s(k,_).selectAll("."+o.sankeyNode).filter(d(_)).call(g)}function v(_,k,E,A){var b=A.datum().link.label;A.style("fill-opacity",function(L){return L.tinyColorAlpha}),b&&s(k,_).selectAll("."+o.sankeyLink).filter(function(L){return L.link.label===b}).style("fill-opacity",function(L){return L.tinyColorAlpha}),E&&s(k,_).selectAll(o.sankeyNode).filter(d(_)).call(m)}function T(_,k){var E=_.hoverlabel||{},A=h.nestedProperty(E,k).get();return!Array.isArray(A)&&A}B.exports=function(_,k){for(var E=_._fullLayout,A=E._paper,b=E._size,L=0;L<_._fullData.length;L++)if(_._fullData[L].visible&&_._fullData[L].type===o.sankey&&!_._fullData[L]._viewInitial){var w=_._fullData[L].node;_._fullData[L]._viewInitial={node:{groups:w.groups.slice(),x:w.x.slice(),y:w.y.slice()}}}var C=a(_,"source:")+" ",S=a(_,"target:")+" ",P=a(_,"concentration:")+" ",z=a(_,"incoming flow count:")+" ",F=a(_,"outgoing flow count:")+" ";u(_,A,k,{width:b.w,height:b.h,margin:{t:b.t,r:b.r,b:b.b,l:b.l}},{linkEvents:{hover:function(q,W,X){_._fullLayout.hovermode!==!1&&(t.select(q).call(y.bind(0,W,X,!0)),W.link.trace.link.hoverinfo!=="skip"&&(W.link.fullData=W.link.trace,_.emit("plotly_hover",{event:t.event,points:[W.link]})))},follow:function(q,W){if(_._fullLayout.hovermode!==!1){var X=W.link.trace.link;if(X.hoverinfo!=="none"&&X.hoverinfo!=="skip"){for(var Q=[],Z=0,Y=0;Y<W.flow.links.length;Y++){var N=W.flow.links[Y];if(_._fullLayout.hovermode!=="closest"||W.link.pointNumber===N.pointNumber){W.link.pointNumber===N.pointNumber&&(Z=Y),N.fullData=N.trace,X=W.link.trace.link;var J=U(N),D={valueLabel:p(W.valueFormat)(N.value)+W.valueSuffix};Q.push({x:J[0],y:J[1],name:D.valueLabel,text:[N.label||"",C+N.source.label,S+N.target.label,N.concentrationscale?P+p("%0.2f")(N.flow.labelConcentration):""].filter(n).join("<br>"),color:T(X,"bgcolor")||l.addOpacity(N.color,1),borderColor:T(X,"bordercolor"),fontFamily:T(X,"font.family"),fontSize:T(X,"font.size"),fontColor:T(X,"font.color"),nameLength:T(X,"namelength"),textAlign:T(X,"align"),idealAlign:t.event.x<J[0]?"right":"left",hovertemplate:X.hovertemplate,hovertemplateLabels:D,eventData:[N]})}}e.loneHover(Q,{container:E._hoverlayer.node(),outerContainer:E._paper.node(),gd:_,anchorIndex:Z}).each(function(){W.link.concentrationscale||r(this,.65),c(this)})}}function U(G){var $,K;G.circular?($=(G.circularPathData.leftInnerExtent+G.circularPathData.rightInnerExtent)/2,K=G.circularPathData.verticalFullExtent):($=(G.source.x1+G.target.x0)/2,K=(G.y0+G.y1)/2);var re=[$,K];return G.trace.orientation==="v"&&re.reverse(),re[0]+=W.parent.translateX,re[1]+=W.parent.translateY,re}},unhover:function(q,W,X){_._fullLayout.hovermode!==!1&&(t.select(q).call(v.bind(0,W,X,!0)),W.link.trace.link.hoverinfo!=="skip"&&(W.link.fullData=W.link.trace,_.emit("plotly_unhover",{event:t.event,points:[W.link]})),e.loneUnhover(E._hoverlayer.node()))},select:function(q,W){var X=W.link;X.originalEvent=t.event,_._hoverdata=[X],e.click(_,{target:!0})}},nodeEvents:{hover:function(q,W,X){_._fullLayout.hovermode!==!1&&(t.select(q).call(g,W,X),W.node.trace.node.hoverinfo!=="skip"&&(W.node.fullData=W.node.trace,_.emit("plotly_hover",{event:t.event,points:[W.node]})))},follow:function(q,W){if(_._fullLayout.hovermode!==!1){var X=W.node.trace.node;if(X.hoverinfo!=="none"&&X.hoverinfo!=="skip"){var Q=t.select(q).select("."+o.nodeRect),Z=_._fullLayout._paperdiv.node().getBoundingClientRect(),Y=Q.node().getBoundingClientRect(),N=Y.left-2-Z.left,J=Y.right+2-Z.left,D=Y.top+Y.height/4-Z.top,U={valueLabel:p(W.valueFormat)(W.node.value)+W.valueSuffix};W.node.fullData=W.node.trace,_._fullLayout._calcInverseTransform(_);var G=_._fullLayout._invScaleX,$=_._fullLayout._invScaleY,K=e.loneHover({x0:G*N,x1:G*J,y:$*D,name:p(W.valueFormat)(W.node.value)+W.valueSuffix,text:[W.node.label,z+W.node.targetLinks.length,F+W.node.sourceLinks.length].filter(n).join("<br>"),color:T(X,"bgcolor")||W.tinyColorHue,borderColor:T(X,"bordercolor"),fontFamily:T(X,"font.family"),fontSize:T(X,"font.size"),fontColor:T(X,"font.color"),nameLength:T(X,"namelength"),textAlign:T(X,"align"),idealAlign:"left",hovertemplate:X.hovertemplate,hovertemplateLabels:U,eventData:[W.node]},{container:E._hoverlayer.node(),outerContainer:E._paper.node(),gd:_});r(K,.85),c(K)}}},unhover:function(q,W,X){_._fullLayout.hovermode!==!1&&(t.select(q).call(m,W,X),W.node.trace.node.hoverinfo!=="skip"&&(W.node.fullData=W.node.trace,_.emit("plotly_unhover",{event:t.event,points:[W.node]})),e.loneUnhover(E._hoverlayer.node()))},select:function(q,W,X){var Q=W.node;Q.originalEvent=t.event,_._hoverdata=[Q],t.select(q).call(m,W,X),e.click(_,{target:!0})}}})}},{"../../components/color":666,"../../components/fx":706,"../../lib":803,"./constants":1211,"./render":1215,"@plotly/d3":58}],1215:[function(i,B,V){var t=i("d3-force"),h=i("d3-interpolate").interpolateNumber,p=i("@plotly/d3"),u=i("@plotly/d3-sankey"),e=i("@plotly/d3-sankey-circular"),l=i("./constants"),o=i("tinycolor2"),a=i("../../components/color"),n=i("../../components/drawing"),s=i("../../lib"),r=s.strTranslate,c=s.strRotate,f=i("../../lib/gup"),d=f.keyFun,g=f.repeat,m=f.unwrap,y=i("../../lib/svg_text_utils"),v=i("../../registry"),T=i("../../constants/alignment"),_=T.CAP_SHIFT,k=T.LINE_SPACING;function E(Y,N,J){var D,U=m(N),G=U.trace,$=G.domain,K=G.orientation==="h",re=G.node.pad,ne=G.node.thickness,ae=Y.width*($.x[1]-$.x[0]),ie=Y.height*($.y[1]-$.y[0]),he=U._nodes,se=U._links,de=U.circular;(D=de?e.sankeyCircular().circularLinkGap(0):u.sankey()).iterations(l.sankeyIterations).size(K?[ae,ie]:[ie,ae]).nodeWidth(ne).nodePadding(re).nodeId(function(Se){return Se.pointNumber}).nodes(he).links(se);var ce,ve,Ee,Le=D();for(var Te in D.nodePadding()<re&&s.warn("node.pad was reduced to ",D.nodePadding()," to fit within the figure."),U._groupLookup){var xe,fe=parseInt(U._groupLookup[Te]);for(ce=0;ce<Le.nodes.length;ce++)if(Le.nodes[ce].pointNumber===fe){xe=Le.nodes[ce];break}if(xe){var ge={pointNumber:parseInt(Te),x0:xe.x0,x1:xe.x1,y0:xe.y0,y1:xe.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};Le.nodes.unshift(ge),xe.childrenNodes.unshift(ge)}}if(function(){for(ce=0;ce<Le.nodes.length;ce++){var Se,De,Be=Le.nodes[ce],We={};for(ve=0;ve<Be.targetLinks.length;ve++)Se=(De=Be.targetLinks[ve]).source.pointNumber+":"+De.target.pointNumber,We.hasOwnProperty(Se)||(We[Se]=[]),We[Se].push(De);var Qe=Object.keys(We);for(ve=0;ve<Qe.length;ve++){var Oe=We[Se=Qe[ve]],Ue=0,Xe={};for(Ee=0;Ee<Oe.length;Ee++)Xe[(De=Oe[Ee]).label]||(Xe[De.label]=0),Xe[De.label]+=De.value,Ue+=De.value;for(Ee=0;Ee<Oe.length;Ee++)(De=Oe[Ee]).flow={value:Ue,labelConcentration:Xe[De.label]/Ue,concentration:De.value/Ue,links:Oe},De.concentrationscale&&(De.color=o(De.concentrationscale(De.flow.labelConcentration)))}var Ye=0;for(ve=0;ve<Be.sourceLinks.length;ve++)Ye+=Be.sourceLinks[ve].value;for(ve=0;ve<Be.sourceLinks.length;ve++)(De=Be.sourceLinks[ve]).concentrationOut=De.value/Ye;var $e=0;for(ve=0;ve<Be.targetLinks.length;ve++)$e+=Be.targetLinks[ve].value;for(ve=0;ve<Be.targetLinks.length;ve++)(De=Be.targetLinks[ve]).concenrationIn=De.value/$e}}(),G.node.x.length&&G.node.y.length){for(ce=0;ce<Math.min(G.node.x.length,G.node.y.length,Le.nodes.length);ce++)if(G.node.x[ce]&&G.node.y[ce]){var ke=[G.node.x[ce]*ae,G.node.y[ce]*ie];Le.nodes[ce].x0=ke[0]-ne/2,Le.nodes[ce].x1=ke[0]+ne/2;var Me=Le.nodes[ce].y1-Le.nodes[ce].y0;Le.nodes[ce].y0=ke[1]-Me/2,Le.nodes[ce].y1=ke[1]+Me/2}G.arrangement==="snap"&&function(Se){Se.forEach(function(De){var Be,We,Qe,Oe=0,Ue=De.length;for(De.sort(function(Xe,Ye){return Xe.y0-Ye.y0}),Qe=0;Qe<Ue;++Qe)(Be=De[Qe]).y0>=Oe||(We=Oe-Be.y0)>1e-6&&(Be.y0+=We,Be.y1+=We),Oe=Be.y1+re})}(function(Se){var De,Be,We=Se.map(function(Ye,$e){return{x0:Ye.x0,index:$e}}).sort(function(Ye,$e){return Ye.x0-$e.x0}),Qe=[],Oe=-1,Ue=-1/0;for(ce=0;ce<We.length;ce++){var Xe=Se[We[ce].index];Xe.x0>Ue+ne&&(Oe+=1,De=Xe.x0),Ue=Xe.x0,Qe[Oe]||(Qe[Oe]=[]),Qe[Oe].push(Xe),Be=De-Xe.x0,Xe.x0+=Be,Xe.x1+=Be}return Qe}(he=Le.nodes)),D.update(Le)}return{circular:de,key:J,trace:G,guid:s.randstr(),horizontal:K,width:ae,height:ie,nodePad:G.node.pad,nodeLineColor:G.node.line.color,nodeLineWidth:G.node.line.width,linkLineColor:G.link.line.color,linkLineWidth:G.link.line.width,valueFormat:G.valueformat,valueSuffix:G.valuesuffix,textFont:G.textfont,translateX:$.x[0]*Y.width+Y.margin.l,translateY:Y.height-$.y[1]*Y.height+Y.margin.t,dragParallel:K?ie:ae,dragPerpendicular:K?ae:ie,arrangement:G.arrangement,sankey:D,graph:Le,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function A(Y,N,J){var D=o(N.color),U=N.source.label+"|"+N.target.label+"__"+J;return N.trace=Y.trace,N.curveNumber=Y.trace.index,{circular:Y.circular,key:U,traceId:Y.key,pointNumber:N.pointNumber,link:N,tinyColorHue:a.tinyRGB(D),tinyColorAlpha:D.getAlpha(),linkPath:b,linkLineColor:Y.linkLineColor,linkLineWidth:Y.linkLineWidth,valueFormat:Y.valueFormat,valueSuffix:Y.valueSuffix,sankey:Y.sankey,parent:Y,interactionState:Y.interactionState,flow:N.flow}}function b(){return function(Y){if(Y.link.circular)return N=Y.link,J=N.width/2,D=N.circularPathData,N.circularLinkType==="top"?"M "+D.targetX+" "+(D.targetY+J)+" L"+D.rightInnerExtent+" "+(D.targetY+J)+"A"+(D.rightLargeArcRadius+J)+" "+(D.rightSmallArcRadius+J)+" 0 0 1 "+(D.rightFullExtent-J)+" "+(D.targetY-D.rightSmallArcRadius)+"L"+(D.rightFullExtent-J)+" "+D.verticalRightInnerExtent+"A"+(D.rightLargeArcRadius+J)+" "+(D.rightLargeArcRadius+J)+" 0 0 1 "+D.rightInnerExtent+" "+(D.verticalFullExtent-J)+"L"+D.leftInnerExtent+" "+(D.verticalFullExtent-J)+"A"+(D.leftLargeArcRadius+J)+" "+(D.leftLargeArcRadius+J)+" 0 0 1 "+(D.leftFullExtent+J)+" "+D.verticalLeftInnerExtent+"L"+(D.leftFullExtent+J)+" "+(D.sourceY-D.leftSmallArcRadius)+"A"+(D.leftLargeArcRadius+J)+" "+(D.leftSmallArcRadius+J)+" 0 0 1 "+D.leftInnerExtent+" "+(D.sourceY+J)+"L"+D.sourceX+" "+(D.sourceY+J)+"L"+D.sourceX+" "+(D.sourceY-J)+"L"+D.leftInnerExtent+" "+(D.sourceY-J)+"A"+(D.leftLargeArcRadius-J)+" "+(D.leftSmallArcRadius-J)+" 0 0 0 "+(D.leftFullExtent-J)+" "+(D.sourceY-D.leftSmallArcRadius)+"L"+(D.leftFullExtent-J)+" "+D.verticalLeftInnerExtent+"A"+(D.leftLargeArcRadius-J)+" "+(D.leftLargeArcRadius-J)+" 0 0 0 "+D.leftInnerExtent+" "+(D.verticalFullExtent+J)+"L"+D.rightInnerExtent+" "+(D.verticalFullExtent+J)+"A"+(D.rightLargeArcRadius-J)+" "+(D.rightLargeArcRadius-J)+" 0 0 0 "+(D.rightFullExtent+J)+" "+D.verticalRightInnerExtent+"L"+(D.rightFullExtent+J)+" "+(D.targetY-D.rightSmallArcRadius)+"A"+(D.rightLargeArcRadius-J)+" "+(D.rightSmallArcRadius-J)+" 0 0 0 "+D.rightInnerExtent+" "+(D.targetY-J)+"L"+D.targetX+" "+(D.targetY-J)+"Z":"M "+D.targetX+" "+(D.targetY-J)+" L"+D.rightInnerExtent+" "+(D.targetY-J)+"A"+(D.rightLargeArcRadius+J)+" "+(D.rightSmallArcRadius+J)+" 0 0 0 "+(D.rightFullExtent-J)+" "+(D.targetY+D.rightSmallArcRadius)+"L"+(D.rightFullExtent-J)+" "+D.verticalRightInnerExtent+"A"+(D.rightLargeArcRadius+J)+" "+(D.rightLargeArcRadius+J)+" 0 0 0 "+D.rightInnerExtent+" "+(D.verticalFullExtent+J)+"L"+D.leftInnerExtent+" "+(D.verticalFullExtent+J)+"A"+(D.leftLargeArcRadius+J)+" "+(D.leftLargeArcRadius+J)+" 0 0 0 "+(D.leftFullExtent+J)+" "+D.verticalLeftInnerExtent+"L"+(D.leftFullExtent+J)+" "+(D.sourceY+D.leftSmallArcRadius)+"A"+(D.leftLargeArcRadius+J)+" "+(D.leftSmallArcRadius+J)+" 0 0 0 "+D.leftInnerExtent+" "+(D.sourceY-J)+"L"+D.sourceX+" "+(D.sourceY-J)+"L"+D.sourceX+" "+(D.sourceY+J)+"L"+D.leftInnerExtent+" "+(D.sourceY+J)+"A"+(D.leftLargeArcRadius-J)+" "+(D.leftSmallArcRadius-J)+" 0 0 1 "+(D.leftFullExtent-J)+" "+(D.sourceY+D.leftSmallArcRadius)+"L"+(D.leftFullExtent-J)+" "+D.verticalLeftInnerExtent+"A"+(D.leftLargeArcRadius-J)+" "+(D.leftLargeArcRadius-J)+" 0 0 1 "+D.leftInnerExtent+" "+(D.verticalFullExtent-J)+"L"+D.rightInnerExtent+" "+(D.verticalFullExtent-J)+"A"+(D.rightLargeArcRadius-J)+" "+(D.rightLargeArcRadius-J)+" 0 0 1 "+(D.rightFullExtent+J)+" "+D.verticalRightInnerExtent+"L"+(D.rightFullExtent+J)+" "+(D.targetY+D.rightSmallArcRadius)+"A"+(D.rightLargeArcRadius-J)+" "+(D.rightSmallArcRadius-J)+" 0 0 1 "+D.rightInnerExtent+" "+(D.targetY+J)+"L"+D.targetX+" "+(D.targetY+J)+"Z";var N,J,D,U=Y.link.source.x1,G=Y.link.target.x0,$=h(U,G),K=$(.5),re=$(.5),ne=Y.link.y0-Y.link.width/2,ae=Y.link.y0+Y.link.width/2,ie=Y.link.y1-Y.link.width/2,he=Y.link.y1+Y.link.width/2;return"M"+U+","+ne+"C"+K+","+ne+" "+re+","+ie+" "+G+","+ie+"L"+G+","+he+"C"+re+","+he+" "+K+","+ae+" "+U+","+ae+"Z"}}function L(Y,N){var J=o(N.color),D=l.nodePadAcross,U=Y.nodePad/2;N.dx=N.x1-N.x0,N.dy=N.y1-N.y0;var G=N.dx,$=Math.max(.5,N.dy),K="node_"+N.pointNumber;return N.group&&(K=s.randstr()),N.trace=Y.trace,N.curveNumber=Y.trace.index,{index:N.pointNumber,key:K,partOfGroup:N.partOfGroup||!1,group:N.group,traceId:Y.key,trace:Y.trace,node:N,nodePad:Y.nodePad,nodeLineColor:Y.nodeLineColor,nodeLineWidth:Y.nodeLineWidth,textFont:Y.textFont,size:Y.horizontal?Y.height:Y.width,visibleWidth:Math.ceil(G),visibleHeight:$,zoneX:-D,zoneY:-U,zoneWidth:G+2*D,zoneHeight:$+2*U,labelY:Y.horizontal?N.dy/2+1:N.dx/2+1,left:N.originalLayer===1,sizeAcross:Y.width,forceLayouts:Y.forceLayouts,horizontal:Y.horizontal,darkBackground:J.getBrightness()<=128,tinyColorHue:a.tinyRGB(J),tinyColorAlpha:J.getAlpha(),valueFormat:Y.valueFormat,valueSuffix:Y.valueSuffix,sankey:Y.sankey,graph:Y.graph,arrangement:Y.arrangement,uniqueNodeLabelPathId:[Y.guid,Y.key,K].join("_"),interactionState:Y.interactionState,figure:Y}}function w(Y){Y.attr("transform",function(N){return r(N.node.x0.toFixed(3),N.node.y0.toFixed(3))})}function C(Y){Y.call(w)}function S(Y,N){Y.call(C),N.attr("d",b())}function P(Y){Y.attr("width",function(N){return N.node.x1-N.node.x0}).attr("height",function(N){return N.visibleHeight})}function z(Y){return Y.link.width>1||Y.linkLineWidth>0}function F(Y){return r(Y.translateX,Y.translateY)+(Y.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function q(Y,N,J){Y.on(".basic",null).on("mouseover.basic",function(D){D.interactionState.dragInProgress||D.partOfGroup||(J.hover(this,D,N),D.interactionState.hovered=[this,D])}).on("mousemove.basic",function(D){D.interactionState.dragInProgress||D.partOfGroup||(J.follow(this,D),D.interactionState.hovered=[this,D])}).on("mouseout.basic",function(D){D.interactionState.dragInProgress||D.partOfGroup||(J.unhover(this,D,N),D.interactionState.hovered=!1)}).on("click.basic",function(D){D.interactionState.hovered&&(J.unhover(this,D,N),D.interactionState.hovered=!1),D.interactionState.dragInProgress||D.partOfGroup||J.select(this,D,N)})}function W(Y,N,J,D){var U=p.behavior.drag().origin(function(G){return{x:G.node.x0+G.visibleWidth/2,y:G.node.y0+G.visibleHeight/2}}).on("dragstart",function(G){if(G.arrangement!=="fixed"&&(s.ensureSingle(D._fullLayout._infolayer,"g","dragcover",function(K){D._fullLayout._dragCover=K}),s.raiseToTop(this),G.interactionState.dragInProgress=G.node,Q(G.node),G.interactionState.hovered&&(J.nodeEvents.unhover.apply(0,G.interactionState.hovered),G.interactionState.hovered=!1),G.arrangement==="snap")){var $=G.traceId+"|"+G.key;G.forceLayouts[$]?G.forceLayouts[$].alpha(1):function(K,re,ne,ae){(function(he){for(var se=0;se<he.length;se++)he[se].y=(he[se].y0+he[se].y1)/2,he[se].x=(he[se].x0+he[se].x1)/2})(ne.graph.nodes);var ie=ne.graph.nodes.filter(function(he){return he.originalX===ne.node.originalX}).filter(function(he){return!he.partOfGroup});ne.forceLayouts[re]=t.forceSimulation(ie).alphaDecay(0).force("collide",t.forceCollide().radius(function(he){return he.dy/2+ne.nodePad/2}).strength(1).iterations(l.forceIterations)).force("constrain",function(he,se,de,ce){return function(){for(var ve=0,Ee=0;Ee<de.length;Ee++){var Le=de[Ee];Le===ce.interactionState.dragInProgress?(Le.x=Le.lastDraggedX,Le.y=Le.lastDraggedY):(Le.vx=(Le.originalX-Le.x)/l.forceTicksPerFrame,Le.y=Math.min(ce.size-Le.dy/2,Math.max(Le.dy/2,Le.y))),ve=Math.max(ve,Math.abs(Le.vx),Math.abs(Le.vy))}!ce.interactionState.dragInProgress&&ve<.1&&ce.forceLayouts[se].alpha()>0&&ce.forceLayouts[se].alpha(0)}}(0,re,ie,ne)).stop()}(0,$,G),function(K,re,ne,ae,ie){window.requestAnimationFrame(function he(){var se;for(se=0;se<l.forceTicksPerFrame;se++)ne.forceLayouts[ae].tick();if(function(ce){for(var ve=0;ve<ce.length;ve++)ce[ve].y0=ce[ve].y-ce[ve].dy/2,ce[ve].y1=ce[ve].y0+ce[ve].dy,ce[ve].x0=ce[ve].x-ce[ve].dx/2,ce[ve].x1=ce[ve].x0+ce[ve].dx}(ne.graph.nodes),ne.sankey.update(ne.graph),S(K.filter(Z(ne)),re),ne.forceLayouts[ae].alpha()>0)window.requestAnimationFrame(he);else{var de=ne.node.originalX;ne.node.x0=de-ne.visibleWidth/2,ne.node.x1=de+ne.visibleWidth/2,X(ne,ie)}})}(Y,N,G,$,D)}}).on("drag",function(G){if(G.arrangement!=="fixed"){var $=p.event.x,K=p.event.y;G.arrangement==="snap"?(G.node.x0=$-G.visibleWidth/2,G.node.x1=$+G.visibleWidth/2,G.node.y0=K-G.visibleHeight/2,G.node.y1=K+G.visibleHeight/2):(G.arrangement==="freeform"&&(G.node.x0=$-G.visibleWidth/2,G.node.x1=$+G.visibleWidth/2),K=Math.max(0,Math.min(G.size-G.visibleHeight/2,K)),G.node.y0=K-G.visibleHeight/2,G.node.y1=K+G.visibleHeight/2),Q(G.node),G.arrangement!=="snap"&&(G.sankey.update(G.graph),S(Y.filter(Z(G)),N))}}).on("dragend",function(G){if(G.arrangement!=="fixed"){G.interactionState.dragInProgress=!1;for(var $=0;$<G.node.childrenNodes.length;$++)G.node.childrenNodes[$].x=G.node.x,G.node.childrenNodes[$].y=G.node.y;G.arrangement!=="snap"&&X(G,D)}});Y.on(".drag",null).call(U)}function X(Y,N){for(var J=[],D=[],U=0;U<Y.graph.nodes.length;U++){var G=(Y.graph.nodes[U].x0+Y.graph.nodes[U].x1)/2,$=(Y.graph.nodes[U].y0+Y.graph.nodes[U].y1)/2;J.push(G/Y.figure.width),D.push($/Y.figure.height)}v.call("_guiRestyle",N,{"node.x":[J],"node.y":[D]},Y.trace.index).then(function(){N._fullLayout._dragCover&&N._fullLayout._dragCover.remove()})}function Q(Y){Y.lastDraggedX=Y.x0+Y.dx/2,Y.lastDraggedY=Y.y0+Y.dy/2}function Z(Y){return function(N){return N.node.originalX===Y.node.originalX}}B.exports=function(Y,N,J,D,U){var G=!1;s.ensureSingle(Y._fullLayout._infolayer,"g","first-render",function(){G=!0});var $=Y._fullLayout._dragCover,K=J.filter(function(ce){return m(ce).trace.visible}).map(E.bind(null,D)),re=N.selectAll("."+l.cn.sankey).data(K,d);re.exit().remove(),re.enter().append("g").classed(l.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",F),re.each(function(ce,ve){Y._fullData[ve]._sankey=ce;var Ee="bgsankey-"+ce.trace.uid+"-"+ve;s.ensureSingle(Y._fullLayout._draggers,"rect",Ee),Y._fullData[ve]._bgRect=p.select("."+Ee),Y._fullData[ve]._bgRect.style("pointer-events","all").attr("width",ce.width).attr("height",ce.height).attr("x",ce.translateX).attr("y",ce.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),re.transition().ease(l.ease).duration(l.duration).attr("transform",F);var ne=re.selectAll("."+l.cn.sankeyLinks).data(g,d);ne.enter().append("g").classed(l.cn.sankeyLinks,!0).style("fill","none");var ae=ne.selectAll("."+l.cn.sankeyLink).data(function(ce){return ce.graph.links.filter(function(ve){return ve.value}).map(A.bind(null,ce))},d);ae.enter().append("path").classed(l.cn.sankeyLink,!0).call(q,re,U.linkEvents),ae.style("stroke",function(ce){return z(ce)?a.tinyRGB(o(ce.linkLineColor)):ce.tinyColorHue}).style("stroke-opacity",function(ce){return z(ce)?a.opacity(ce.linkLineColor):ce.tinyColorAlpha}).style("fill",function(ce){return ce.tinyColorHue}).style("fill-opacity",function(ce){return ce.tinyColorAlpha}).style("stroke-width",function(ce){return z(ce)?ce.linkLineWidth:1}).attr("d",b()),ae.style("opacity",function(){return Y._context.staticPlot||G||$?1:0}).transition().ease(l.ease).duration(l.duration).style("opacity",1),ae.exit().transition().ease(l.ease).duration(l.duration).style("opacity",0).remove();var ie=re.selectAll("."+l.cn.sankeyNodeSet).data(g,d);ie.enter().append("g").classed(l.cn.sankeyNodeSet,!0),ie.style("cursor",function(ce){switch(ce.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var he=ie.selectAll("."+l.cn.sankeyNode).data(function(ce){var ve=ce.graph.nodes;return function(Ee){var Le,Te=[];for(Le=0;Le<Ee.length;Le++)Ee[Le].originalX=(Ee[Le].x0+Ee[Le].x1)/2,Ee[Le].originalY=(Ee[Le].y0+Ee[Le].y1)/2,Te.indexOf(Ee[Le].originalX)===-1&&Te.push(Ee[Le].originalX);for(Te.sort(function(xe,fe){return xe-fe}),Le=0;Le<Ee.length;Le++)Ee[Le].originalLayerIndex=Te.indexOf(Ee[Le].originalX),Ee[Le].originalLayer=Ee[Le].originalLayerIndex/(Te.length-1)}(ve),ve.map(L.bind(null,ce))},d);he.enter().append("g").classed(l.cn.sankeyNode,!0).call(w).style("opacity",function(ce){return!Y._context.staticPlot&&!G||ce.partOfGroup?0:1}),he.call(q,re,U.nodeEvents).call(W,ae,U,Y),he.transition().ease(l.ease).duration(l.duration).call(w).style("opacity",function(ce){return ce.partOfGroup?0:1}),he.exit().transition().ease(l.ease).duration(l.duration).style("opacity",0).remove();var se=he.selectAll("."+l.cn.nodeRect).data(g);se.enter().append("rect").classed(l.cn.nodeRect,!0).call(P),se.style("stroke-width",function(ce){return ce.nodeLineWidth}).style("stroke",function(ce){return a.tinyRGB(o(ce.nodeLineColor))}).style("stroke-opacity",function(ce){return a.opacity(ce.nodeLineColor)}).style("fill",function(ce){return ce.tinyColorHue}).style("fill-opacity",function(ce){return ce.tinyColorAlpha}),se.transition().ease(l.ease).duration(l.duration).call(P);var de=he.selectAll("."+l.cn.nodeLabel).data(g);de.enter().append("text").classed(l.cn.nodeLabel,!0).style("cursor","default"),de.attr("data-notex",1).text(function(ce){return ce.node.label}).each(function(ce){var ve=p.select(this);n.font(ve,ce.textFont),y.convertToTspans(ve,Y)}).style("text-shadow",y.makeTextShadow(Y._fullLayout.paper_bgcolor)).attr("text-anchor",function(ce){return ce.horizontal&&ce.left?"end":"start"}).attr("transform",function(ce){var ve=p.select(this),Ee=y.lineCount(ve),Le=ce.textFont.size*((Ee-1)*k-_),Te=ce.nodeLineWidth/2+3,xe=((ce.horizontal?ce.visibleHeight:ce.visibleWidth)-Le)/2;ce.horizontal&&(ce.left?Te=-Te:Te+=ce.visibleWidth);var fe=ce.horizontal?"":"scale(-1,1)"+c(90);return r(ce.horizontal?Te:xe,ce.horizontal?xe:Te)+fe}),de.transition().ease(l.ease).duration(l.duration)}},{"../../components/color":666,"../../components/drawing":688,"../../constants/alignment":771,"../../lib":803,"../../lib/gup":800,"../../lib/svg_text_utils":829,"../../registry":931,"./constants":1211,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":166,"d3-interpolate":171,tinycolor2:598}],1216:[function(i,B,V){B.exports=function(t,h){for(var p=[],u=t.cd[0].trace,e=u._sankey.graph.nodes,l=0;l<e.length;l++){var o=e[l];if(!o.partOfGroup){var a=[(o.x0+o.x1)/2,(o.y0+o.y1)/2];u.orientation==="v"&&a.reverse(),h&&h.contains(a,!1,l,t)&&p.push({pointNumber:o.pointNumber})}}return p}},{}],1217:[function(i,B,V){var t=i("../../lib");B.exports=function(h,p){for(var u=0;u<h.length;u++)h[u].i=u;t.mergeArray(p.text,h,"tx"),t.mergeArray(p.texttemplate,h,"txt"),t.mergeArray(p.hovertext,h,"htx"),t.mergeArray(p.customdata,h,"data"),t.mergeArray(p.textposition,h,"tp"),p.textfont&&(t.mergeArrayCastPositive(p.textfont.size,h,"ts"),t.mergeArray(p.textfont.color,h,"tc"),t.mergeArray(p.textfont.family,h,"tf"));var e=p.marker;if(e){t.mergeArrayCastPositive(e.size,h,"ms"),t.mergeArrayCastPositive(e.opacity,h,"mo"),t.mergeArray(e.symbol,h,"mx"),t.mergeArray(e.color,h,"mc");var l=e.line;e.line&&(t.mergeArray(l.color,h,"mlc"),t.mergeArrayCastPositive(l.width,h,"mlw"));var o=e.gradient;o&&o.type!=="none"&&(t.mergeArray(o.type,h,"mgt"),t.mergeArray(o.color,h,"mgc"))}}},{"../../lib":803}],1218:[function(i,B,V){var t=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=i("../../plots/template_attributes").texttemplateAttrs,p=i("../../plots/template_attributes").hovertemplateAttrs,u=i("../../components/colorscale/attributes"),e=i("../../plots/font_attributes"),l=i("../../components/drawing/attributes").dash,o=i("../../components/drawing"),a=i("./constants"),n=i("../../lib/extend").extendFlat;B.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:t("x"),yhoverformat:t("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:h({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:p({},{keys:a.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:n({},l,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},marker:n({symbol:{valType:"enumerated",values:o.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:n({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},u("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},u("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":673,"../../components/drawing":688,"../../components/drawing/attributes":687,"../../lib/extend":793,"../../plots/cartesian/axis_format_attributes":857,"../../plots/font_attributes":883,"../../plots/template_attributes":926,"./constants":1222}],1219:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("../../plots/cartesian/axes"),u=i("../../plots/cartesian/align_period"),e=i("../../constants/numerical").BADNUM,l=i("./subtypes"),o=i("./colorscale_calc"),a=i("./arrays_to_calcdata"),n=i("./calc_selection");function s(g,m,y,v,T,_,k){var E=m._length,A=g._fullLayout,b=y._id,L=v._id,w=A._firstScatter[f(m)]===m.uid,C=(d(m,A,y,v)||{}).orientation,S=m.fill;y._minDtick=0,v._minDtick=0;var P={padded:!0},z={padded:!0};k&&(P.ppad=z.ppad=k);var F=E<2||T[0]!==T[E-1]||_[0]!==_[E-1];F&&(S==="tozerox"||S==="tonextx"&&(w||C==="h"))?P.tozero=!0:(m.error_y||{}).visible||S!=="tonexty"&&S!=="tozeroy"&&(l.hasMarkers(m)||l.hasText(m))||(P.padded=!1,P.ppad=0),F&&(S==="tozeroy"||S==="tonexty"&&(w||C==="v"))?z.tozero=!0:S!=="tonextx"&&S!=="tozerox"||(z.padded=!1),b&&(m._extremes[b]=p.findExtremes(y,T,P)),L&&(m._extremes[L]=p.findExtremes(v,_,z))}function r(g,m){if(l.hasMarkers(g)){var y,v=g.marker,T=1.6*(g.marker.sizeref||1);if(y=g.marker.sizemode==="area"?function(b){return Math.max(Math.sqrt((b||0)/T),3)}:function(b){return Math.max((b||0)/T,3)},h.isArrayOrTypedArray(v.size)){var _={type:"linear"};p.setConvert(_);for(var k=_.makeCalcdata(g.marker,"size"),E=new Array(m),A=0;A<m;A++)E[A]=y(k[A]);return E}return y(v.size)}}function c(g,m){var y=f(m),v=g._firstScatter;v[y]||(v[y]=m.uid)}function f(g){var m=g.stackgroup;return g.xaxis+g.yaxis+g.type+(m?"-"+m:"")}function d(g,m,y,v){var T=g.stackgroup;if(T){var _=m._scatterStackOpts[y._id+v._id][T],k=_.orientation==="v"?v:y;return k.type==="linear"||k.type==="log"?_:void 0}}B.exports={calc:function(g,m){var y,v,T,_,k,E,A=g._fullLayout,b=p.getFromId(g,m.xaxis||"x"),L=p.getFromId(g,m.yaxis||"y"),w=b.makeCalcdata(m,"x"),C=L.makeCalcdata(m,"y"),S=u(m,b,"x",w),P=u(m,L,"y",C),z=S.vals,F=P.vals,q=m._length,W=new Array(q),X=m.ids,Q=d(m,A,b,L),Z=!1;c(A,m);var Y,N="x",J="y";Q?(h.pushUnique(Q.traceIndices,m._expandedIndex),(y=Q.orientation==="v")?(J="s",Y="x"):(N="s",Y="y"),k=Q.stackgaps==="interpolate"):s(g,m,b,L,z,F,r(m,q));var D=!!m.xperiodalignment,U=!!m.yperiodalignment;for(v=0;v<q;v++){var G=W[v]={},$=t(z[v]),K=t(F[v]);$&&K?(G[N]=z[v],G[J]=F[v],D&&(G.orig_x=w[v],G.xEnd=S.ends[v],G.xStart=S.starts[v]),U&&(G.orig_y=C[v],G.yEnd=P.ends[v],G.yStart=P.starts[v])):Q&&(y?$:K)?(G[Y]=y?z[v]:F[v],G.gap=!0,k?(G.s=e,Z=!0):G.s=0):G[N]=G[J]=e,X&&(G.id=String(X[v]))}if(a(W,m),o(g,m),n(W,m),Q){for(v=0;v<W.length;)W[v][Y]===e?W.splice(v,1):v++;if(h.sort(W,function(ie,he){return ie[Y]-he[Y]||ie.i-he.i}),Z){for(v=0;v<W.length-1&&W[v].gap;)v++;for((E=W[v].s)||(E=W[v].s=0),T=0;T<v;T++)W[T].s=E;for(_=W.length-1;_>v&&W[_].gap;)_--;for(E=W[_].s,T=W.length-1;T>_;T--)W[T].s=E;for(;v<_;)if(W[++v].gap){for(T=v+1;W[T].gap;)T++;for(var re=W[v-1][Y],ne=W[v-1].s,ae=(W[T].s-ne)/(W[T][Y]-re);v<T;)W[v].s=ne+(W[v][Y]-re)*ae,v++}}}return W},calcMarkerSize:r,calcAxisExpansion:s,setFirstScatter:c,getStackOpts:d}},{"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/align_period":851,"../../plots/cartesian/axes":854,"./arrays_to_calcdata":1217,"./calc_selection":1220,"./colorscale_calc":1221,"./subtypes":1243,"fast-isnumeric":249}],1220:[function(i,B,V){var t=i("../../lib");B.exports=function(h,p){t.isArrayOrTypedArray(p.selectedpoints)&&t.tagSelected(h,p)}},{"../../lib":803}],1221:[function(i,B,V){var t=i("../../components/colorscale/helpers").hasColorscale,h=i("../../components/colorscale/calc"),p=i("./subtypes");B.exports=function(u,e){p.hasLines(e)&&t(e,"line")&&h(u,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),p.hasMarkers(e)&&(t(e,"marker")&&h(u,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),t(e,"marker.line")&&h(u,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":674,"../../components/colorscale/helpers":677,"./subtypes":1243}],1222:[function(i,B,V){B.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1223:[function(i,B,V){var t=i("./calc");function h(p,u,e,l,o,a,n){o[l]=!0;var s={i:null,gap:!0,s:0};if(s[n]=e,p.splice(u,0,s),u&&e===p[u-1][n]){var r=p[u-1];s.s=r.s,s.i=r.i,s.gap=r.gap}else a&&(s.s=function(c,f,d,g){var m=c[f-1],y=c[f+1];return y?m?m.s+(y.s-m.s)*(d-m[g])/(y[g]-m[g]):y.s:m.s}(p,u,e,n));u||(p[0].t=p[1].t,p[0].trace=p[1].trace,delete p[1].t,delete p[1].trace)}B.exports=function(p,u){var e=u.xaxis,l=u.yaxis,o=e._id+l._id,a=p._fullLayout._scatterStackOpts[o];if(a){var n,s,r,c,f,d,g,m,y,v,T,_,k,E,A,b=p.calcdata;for(var L in a){var w=(v=a[L]).traceIndices;if(w.length){for(T=v.stackgaps==="interpolate",_=v.groupnorm,v.orientation==="v"?(k="x",E="y"):(k="y",E="x"),A=new Array(w.length),n=0;n<A.length;n++)A[n]=!1;d=b[w[0]];var C=new Array(d.length);for(n=0;n<d.length;n++)C[n]=d[n][k];for(n=1;n<w.length;n++){for(f=b[w[n]],s=r=0;s<f.length;s++){for(g=f[s][k];g>C[r]&&r<C.length;r++)h(f,s,C[r],n,A,T,k),s++;if(g!==C[r]){for(c=0;c<n;c++)h(b[w[c]],r,g,c,A,T,k);C.splice(r,0,g)}r++}for(;r<C.length;r++)h(f,s,C[r],n,A,T,k),s++}var S=C.length;for(s=0;s<d.length;s++){for(m=d[s][E]=d[s].s,n=1;n<w.length;n++)(f=b[w[n]])[0].trace._rawLength=f[0].trace._length,f[0].trace._length=S,m+=f[s].s,f[s][E]=m;if(_)for(y=(_==="fraction"?m:m/100)||1,n=0;n<w.length;n++){var P=b[w[n]][s];P[E]/=y,P.sNorm=P.s/y}}for(n=0;n<w.length;n++){var z=(f=b[w[n]])[0].trace,F=t.calcMarkerSize(z,z._rawLength),q=Array.isArray(F);if(F&&A[n]||q){var W=F;for(F=new Array(S),s=0;s<S;s++)F[s]=f[s].gap?0:q?W[f[s].i]:W}var X=new Array(S),Q=new Array(S);for(s=0;s<S;s++)X[s]=f[s].x,Q[s]=f[s].y;t.calcAxisExpansion(p,z,e,l,X,Q,F),f[0].t.orientation=v.orientation}}}}}},{"./calc":1219}],1224:[function(i,B,V){B.exports=function(t){for(var h=0;h<t.length;h++){var p=t[h];if(p.type==="scatter"){var u=p.fill;if(u!=="none"&&u!=="toself"&&(p.opacity=void 0,u==="tonexty"||u==="tonextx"))for(var e=h-1;e>=0;e--){var l=t[e];if(l.type==="scatter"&&l.xaxis===p.xaxis&&l.yaxis===p.yaxis){l.opacity=void 0;break}}}}}},{}],1225:[function(i,B,V){var t=i("../../lib"),h=i("../../registry"),p=i("./attributes"),u=i("./constants"),e=i("./subtypes"),l=i("./xy_defaults"),o=i("./period_defaults"),a=i("./stack_defaults"),n=i("./marker_defaults"),s=i("./line_defaults"),r=i("./line_shape_defaults"),c=i("./text_defaults"),f=i("./fillcolor_defaults");B.exports=function(d,g,m,y){function v(w,C){return t.coerce(d,g,p,w,C)}var T=l(d,g,y,v);if(T||(g.visible=!1),g.visible){o(d,g,y,v),v("xhoverformat"),v("yhoverformat");var _=a(d,g,y,v),k=!_&&T<u.PTS_LINESONLY?"lines+markers":"lines";v("text"),v("hovertext"),v("mode",k),e.hasLines(g)&&(s(d,g,m,y,v),r(d,g,v),v("connectgaps"),v("line.simplify")),e.hasMarkers(g)&&n(d,g,m,y,v,{gradient:!0}),e.hasText(g)&&(v("texttemplate"),c(d,g,y,v));var E=[];(e.hasMarkers(g)||e.hasText(g))&&(v("cliponaxis"),v("marker.maxdisplayed"),E.push("points")),v("fill",_?_.fillDflt:"none"),g.fill!=="none"&&(f(d,g,m,v),e.hasLines(g)||r(d,g,v));var A=(g.line||{}).color,b=(g.marker||{}).color;g.fill!=="tonext"&&g.fill!=="toself"||E.push("fills"),v("hoveron",E.join("+")||"points"),g.hoveron!=="fills"&&v("hovertemplate");var L=h.getComponentMethod("errorbars","supplyDefaults");L(d,g,A||b||m,{axis:"y"}),L(d,g,A||b||m,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(g,v)}}},{"../../lib":803,"../../registry":931,"./attributes":1218,"./constants":1222,"./fillcolor_defaults":1226,"./line_defaults":1231,"./line_shape_defaults":1233,"./marker_defaults":1237,"./period_defaults":1238,"./stack_defaults":1241,"./subtypes":1243,"./text_defaults":1244,"./xy_defaults":1245}],1226:[function(i,B,V){var t=i("../../components/color"),h=i("../../lib").isArrayOrTypedArray;B.exports=function(p,u,e,l){var o=!1;if(u.marker){var a=u.marker.color,n=(u.marker.line||{}).color;a&&!h(a)?o=a:n&&!h(n)&&(o=n)}l("fillcolor",t.addOpacity((u.line||{}).color||o||e,.5))}},{"../../components/color":666,"../../lib":803}],1227:[function(i,B,V){var t=i("../../plots/cartesian/axes");B.exports=function(h,p,u){var e={},l={_fullLayout:u},o=t.getFromTrace(l,p,"x"),a=t.getFromTrace(l,p,"y");return e.xLabel=t.tickText(o,o.c2l(h.x),!0).text,e.yLabel=t.tickText(a,a.c2l(h.y),!0).text,e}},{"../../plots/cartesian/axes":854}],1228:[function(i,B,V){var t=i("../../components/color"),h=i("./subtypes");B.exports=function(p,u){var e,l;if(p.mode==="lines")return(e=p.line.color)&&t.opacity(e)?e:p.fillcolor;if(p.mode==="none")return p.fill?p.fillcolor:"";var o=u.mcc||(p.marker||{}).color,a=u.mlcc||((p.marker||{}).line||{}).color;return(l=o&&t.opacity(o)?o:a&&t.opacity(a)&&(u.mlw||((p.marker||{}).line||{}).width)?a:"")?t.opacity(l)<.3?t.addOpacity(l,.3):l:(e=(p.line||{}).color)&&t.opacity(e)&&h.hasLines(p)&&p.line.width?e:p.fillcolor}},{"../../components/color":666,"./subtypes":1243}],1229:[function(i,B,V){var t=i("../../lib"),h=i("../../components/fx"),p=i("../../registry"),u=i("./get_trace_color"),e=i("../../components/color"),l=t.fillText;B.exports=function(o,a,n,s){var r=o.cd,c=r[0].trace,f=o.xa,d=o.ya,g=f.c2p(a),m=d.c2p(n),y=[g,m],v=c.hoveron||"",T=c.mode.indexOf("markers")!==-1?3:.5,_=!!c.xperiodalignment,k=!!c.yperiodalignment;if(v.indexOf("points")!==-1){var E=function(se){var de=Math.max(T,se.mrc||0),ce=f.c2p(se.x)-g,ve=d.c2p(se.y)-m;return Math.max(Math.sqrt(ce*ce+ve*ve)-de,1-T/de)},A=h.getDistanceFunction(s,function(se){if(_){var de=f.c2p(se.xStart),ce=f.c2p(se.xEnd);return g>=Math.min(de,ce)&&g<=Math.max(de,ce)?0:1/0}var ve=Math.max(3,se.mrc||0),Ee=1-1/ve,Le=Math.abs(f.c2p(se.x)-g);return Le<ve?Ee*Le/ve:Le-ve+Ee},function(se){if(k){var de=d.c2p(se.yStart),ce=d.c2p(se.yEnd);return m>=Math.min(de,ce)&&m<=Math.max(de,ce)?0:1/0}var ve=Math.max(3,se.mrc||0),Ee=1-1/ve,Le=Math.abs(d.c2p(se.y)-m);return Le<ve?Ee*Le/ve:Le-ve+Ee},E);if(h.getClosest(r,A,o),o.index!==!1){var b=r[o.index],L=f.c2p(b.x,!0),w=d.c2p(b.y,!0),C=b.mrc||1;o.index=b.i;var S=r[0].t.orientation,P=S&&(b.sNorm||b.s),z=S==="h"?P:b.orig_x!==void 0?b.orig_x:b.x,F=S==="v"?P:b.orig_y!==void 0?b.orig_y:b.y;return t.extendFlat(o,{color:u(c,b),x0:L-C,x1:L+C,xLabelVal:z,y0:w-C,y1:w+C,yLabelVal:F,spikeDistance:E(b),hovertemplate:c.hovertemplate}),l(b,c,o),p.getComponentMethod("errorbars","hoverInfo")(b,c,o),[o]}}if(v.indexOf("fills")!==-1&&c._polygons){var q,W,X,Q,Z,Y,N,J,D,U=c._polygons,G=[],$=!1,K=1/0,re=-1/0,ne=1/0,ae=-1/0;for(q=0;q<U.length;q++)(X=U[q]).contains(y)&&($=!$,G.push(X),ne=Math.min(ne,X.ymin),ae=Math.max(ae,X.ymax));if($){var ie=((ne=Math.max(ne,0))+(ae=Math.min(ae,d._length)))/2;for(q=0;q<G.length;q++)for(Q=G[q].pts,W=1;W<Q.length;W++)(J=Q[W-1][1])>ie!=(D=Q[W][1])>=ie&&(Y=Q[W-1][0],N=Q[W][0],D-J&&(Z=Y+(N-Y)*(ie-J)/(D-J),K=Math.min(K,Z),re=Math.max(re,Z)));K=Math.max(K,0),re=Math.min(re,f._length);var he=e.defaultLine;return e.opacity(c.fillcolor)?he=c.fillcolor:e.opacity((c.line||{}).color)&&(he=c.line.color),t.extendFlat(o,{distance:o.maxHoverDistance,x0:K,x1:re,y0:ie,y1:ie,color:he,hovertemplate:!1}),delete o.index,c.text&&!Array.isArray(c.text)?o.text=String(c.text):o.text=c.name,[o]}}}},{"../../components/color":666,"../../components/fx":706,"../../lib":803,"../../registry":931,"./get_trace_color":1228}],1230:[function(i,B,V){var t=i("./subtypes");B.exports={hasLines:t.hasLines,hasMarkers:t.hasMarkers,hasText:t.hasText,isBubble:t.isBubble,attributes:i("./attributes"),supplyDefaults:i("./defaults"),crossTraceDefaults:i("./cross_trace_defaults"),calc:i("./calc").calc,crossTraceCalc:i("./cross_trace_calc"),arraysToCalcdata:i("./arrays_to_calcdata"),plot:i("./plot"),colorbar:i("./marker_colorbar"),formatLabels:i("./format_labels"),style:i("./style").style,styleOnSelect:i("./style").styleOnSelect,hoverPoints:i("./hover"),selectPoints:i("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":868,"./arrays_to_calcdata":1217,"./attributes":1218,"./calc":1219,"./cross_trace_calc":1223,"./cross_trace_defaults":1224,"./defaults":1225,"./format_labels":1227,"./hover":1229,"./marker_colorbar":1236,"./plot":1239,"./select":1240,"./style":1242,"./subtypes":1243}],1231:[function(i,B,V){var t=i("../../lib").isArrayOrTypedArray,h=i("../../components/colorscale/helpers").hasColorscale,p=i("../../components/colorscale/defaults");B.exports=function(u,e,l,o,a,n){var s=(u.marker||{}).color;a("line.color",l),h(u,"line")?p(u,e,o,a,{prefix:"line.",cLetter:"c"}):a("line.color",!t(s)&&s||l),a("line.width"),(n||{}).noDash||a("line.dash")}},{"../../components/colorscale/defaults":676,"../../components/colorscale/helpers":677,"../../lib":803}],1232:[function(i,B,V){var t=i("../../constants/numerical"),h=t.BADNUM,p=t.LOG_CLIP,u=p+.5,e=p-.5,l=i("../../lib"),o=l.segmentsIntersect,a=l.constrain,n=i("./constants");B.exports=function(s,r){var c,f,d,g,m,y,v,T,_,k,E,A,b,L,w,C,S,P,z=r.xaxis,F=r.yaxis,q=z.type==="log",W=F.type==="log",X=z._length,Q=F._length,Z=r.connectGaps,Y=r.baseTolerance,N=r.shape,J=N==="linear",D=r.fill&&r.fill!=="none",U=[],G=n.minTolerance,$=s.length,K=new Array($),re=0;function ne(Ye){var $e=s[Ye];if(!$e)return!1;var it=r.linearized?z.l2p($e.x):z.c2p($e.x),ot=r.linearized?F.l2p($e.y):F.c2p($e.y);if(it===h){if(q&&(it=z.c2p($e.x,!0)),it===h)return!1;W&&ot===h&&(it*=Math.abs(z._m*Q*(z._m>0?u:e)/(F._m*X*(F._m>0?u:e)))),it*=1e3}if(ot===h){if(W&&(ot=F.c2p($e.y,!0)),ot===h)return!1;ot*=1e3}return[it,ot]}function ae(Ye,$e,it,ot){var Et=it-Ye,mt=ot-$e,tt=.5-Ye,Ke=.5-$e,Mt=Et*Et+mt*mt,Jt=Et*tt+mt*Ke;if(Jt>0&&Jt<Mt){var $t=tt*mt-Ke*Et;if($t*$t<Mt)return!0}}function ie(Ye,$e){var it=Ye[0]/X,ot=Ye[1]/Q,Et=Math.max(0,-it,it-1,-ot,ot-1);return Et&&S!==void 0&&ae(it,ot,S,P)&&(Et=0),Et&&$e&&ae(it,ot,$e[0]/X,$e[1]/Q)&&(Et=0),(1+n.toleranceGrowth*Et)*Y}function he(Ye,$e){var it=Ye[0]-$e[0],ot=Ye[1]-$e[1];return Math.sqrt(it*it+ot*ot)}var se,de,ce,ve,Ee,Le,Te,xe=n.maxScreensAway,fe=-X*xe,ge=X*(1+xe),ke=-Q*xe,Me=Q*(1+xe),Se=[[fe,ke,ge,ke],[ge,ke,ge,Me],[ge,Me,fe,Me],[fe,Me,fe,ke]];function De(Ye){if(Ye[0]<fe||Ye[0]>ge||Ye[1]<ke||Ye[1]>Me)return[a(Ye[0],fe,ge),a(Ye[1],ke,Me)]}function Be(Ye,$e){return Ye[0]===$e[0]&&(Ye[0]===fe||Ye[0]===ge)||Ye[1]===$e[1]&&(Ye[1]===ke||Ye[1]===Me)||void 0}function We(Ye,$e,it){return function(ot,Et){var mt=De(ot),tt=De(Et),Ke=[];if(mt&&tt&&Be(mt,tt))return Ke;mt&&Ke.push(mt),tt&&Ke.push(tt);var Mt=2*l.constrain((ot[Ye]+Et[Ye])/2,$e,it)-((mt||ot)[Ye]+(tt||Et)[Ye]);return Mt&&((mt&&tt?Mt>0==mt[Ye]>tt[Ye]?mt:tt:mt||tt)[Ye]+=Mt),Ke}}function Qe(Ye){var $e=Ye[0],it=Ye[1],ot=$e===K[re-1][0],Et=it===K[re-1][1];if(!ot||!Et)if(re>1){var mt=$e===K[re-2][0],tt=it===K[re-2][1];ot&&($e===fe||$e===ge)&&mt?tt?re--:K[re-1]=Ye:Et&&(it===ke||it===Me)&&tt?mt?re--:K[re-1]=Ye:K[re++]=Ye}else K[re++]=Ye}function Oe(Ye){K[re-1][0]!==Ye[0]&&K[re-1][1]!==Ye[1]&&Qe([ce,ve]),Qe(Ye),Ee=null,ce=ve=0}function Ue(Ye){if(S=Ye[0]/X,P=Ye[1]/Q,se=Ye[0]<fe?fe:Ye[0]>ge?ge:0,de=Ye[1]<ke?ke:Ye[1]>Me?Me:0,se||de){if(re)if(Ee){var $e=Te(Ee,Ye);$e.length>1&&(Oe($e[0]),K[re++]=$e[1])}else Le=Te(K[re-1],Ye)[0],K[re++]=Le;else K[re++]=[se||Ye[0],de||Ye[1]];var it=K[re-1];se&&de&&(it[0]!==se||it[1]!==de)?(Ee&&(ce!==se&&ve!==de?Qe(ce&&ve?(ot=Ee,mt=(Et=Ye)[0]-ot[0],tt=(Et[1]-ot[1])/mt,(ot[1]*Et[0]-Et[1]*ot[0])/mt>0?[tt>0?fe:ge,Me]:[tt>0?ge:fe,ke]):[ce||se,ve||de]):ce&&ve&&Qe([ce,ve])),Qe([se,de])):ce-se&&ve-de&&Qe([se||ce,de||ve]),Ee=Ye,ce=se,ve=de}else Ee&&Oe(Te(Ee,Ye)[0]),K[re++]=Ye;var ot,Et,mt,tt}for(N==="linear"||N==="spline"?Te=function(Ye,$e){for(var it=[],ot=0,Et=0;Et<4;Et++){var mt=Se[Et],tt=o(Ye[0],Ye[1],$e[0],$e[1],mt[0],mt[1],mt[2],mt[3]);tt&&(!ot||Math.abs(tt.x-it[0][0])>1||Math.abs(tt.y-it[0][1])>1)&&(tt=[tt.x,tt.y],ot&&he(tt,Ye)<he(it[0],Ye)?it.unshift(tt):it.push(tt),ot++)}return it}:N==="hv"||N==="vh"?Te=function(Ye,$e){var it=[],ot=De(Ye),Et=De($e);return ot&&Et&&Be(ot,Et)||(ot&&it.push(ot),Et&&it.push(Et)),it}:N==="hvh"?Te=We(0,fe,ge):N==="vhv"&&(Te=We(1,ke,Me)),c=0;c<$;c++)if(f=ne(c)){for(re=0,Ee=null,Ue(f),c++;c<$;c++){if(!(g=ne(c))){if(Z)continue;break}if(J&&r.simplify){var Xe=ne(c+1);if(k=he(g,f),D&&(re===0||re===$-1)||!(k<ie(g,Xe)*G)){for(T=[(g[0]-f[0])/k,(g[1]-f[1])/k],m=f,E=k,A=L=w=0,v=!1,d=g,c++;c<s.length;c++){if(y=Xe,Xe=ne(c+1),!y){if(Z)continue;break}if(C=(_=[y[0]-f[0],y[1]-f[1]])[0]*T[1]-_[1]*T[0],L=Math.min(L,C),(w=Math.max(w,C))-L>ie(y,Xe))break;d=y,(b=_[0]*T[0]+_[1]*T[1])>E?(E=b,g=y,v=!1):b<A&&(A=b,m=y,v=!0)}if(v?(Ue(g),d!==m&&Ue(m)):(m!==f&&Ue(m),d!==g&&Ue(g)),Ue(d),c>=s.length||!y)break;Ue(y),f=y}}else Ue(g)}Ee&&Qe([ce||Ee[0],ve||Ee[1]]),U.push(K.slice(0,re))}return U}},{"../../constants/numerical":779,"../../lib":803,"./constants":1222}],1233:[function(i,B,V){B.exports=function(t,h,p){p("line.shape")==="spline"&&p("line.smoothing")}},{}],1234:[function(i,B,V){var t={tonextx:1,tonexty:1,tonext:1};B.exports=function(h,p,u){var e,l,o,a,n,s={},r=!1,c=-1,f=0,d=-1;for(l=0;l<u.length;l++)(o=(e=u[l][0].trace).stackgroup||"")?o in s?n=s[o]:(n=s[o]=f,f++):e.fill in t&&d>=0?n=d:(n=d=f,f++),n<c&&(r=!0),e._groupIndex=c=n;var g=u.slice();r&&g.sort(function(y,v){var T=y[0].trace,_=v[0].trace;return T._groupIndex-_._groupIndex||T.index-_.index});var m={};for(l=0;l<g.length;l++)o=(e=g[l][0].trace).stackgroup||"",e.visible===!0?(e._nexttrace=null,e.fill in t&&(a=m[o],e._prevtrace=a||null,a&&(a._nexttrace=e)),e._ownfill=e.fill&&(e.fill.substr(0,6)==="tozero"||e.fill==="toself"||e.fill.substr(0,2)==="to"&&!e._prevtrace),m[o]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return g}},{}],1235:[function(i,B,V){var t=i("fast-isnumeric");B.exports=function(h,p){p||(p=2);var u=h.marker,e=u.sizeref||1,l=u.sizemin||0,o=u.sizemode==="area"?function(a){return Math.sqrt(a/e)}:function(a){return a/e};return function(a){var n=o(a/p);return t(n)&&n>0?Math.max(n,l):0}}},{"fast-isnumeric":249}],1236:[function(i,B,V){B.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1237:[function(i,B,V){var t=i("../../components/color"),h=i("../../components/colorscale/helpers").hasColorscale,p=i("../../components/colorscale/defaults"),u=i("./subtypes");B.exports=function(e,l,o,a,n,s){var r=u.isBubble(e),c=(e.line||{}).color;s=s||{},c&&(o=c),n("marker.symbol"),n("marker.opacity",r?.7:1),n("marker.size"),n("marker.color",o),h(e,"marker")&&p(e,l,a,n,{prefix:"marker.",cLetter:"c"}),s.noSelect||(n("selected.marker.color"),n("unselected.marker.color"),n("selected.marker.size"),n("unselected.marker.size")),s.noLine||(n("marker.line.color",c&&!Array.isArray(c)&&l.marker.color!==c?c:r?t.background:t.defaultLine),h(e,"marker.line")&&p(e,l,a,n,{prefix:"marker.line.",cLetter:"c"}),n("marker.line.width",r?1:0)),r&&(n("marker.sizeref"),n("marker.sizemin"),n("marker.sizemode")),s.gradient&&n("marker.gradient.type")!=="none"&&n("marker.gradient.color")}},{"../../components/color":666,"../../components/colorscale/defaults":676,"../../components/colorscale/helpers":677,"./subtypes":1243}],1238:[function(i,B,V){var t=i("../../lib").dateTick0,h=i("../../constants/numerical").ONEWEEK;function p(u,e){return t(e,u%h==0?1:0)}B.exports=function(u,e,l,o,a){if(a||(a={x:!0,y:!0}),a.x){var n=o("xperiod");n&&(o("xperiod0",p(n,e.xcalendar)),o("xperiodalignment"))}if(a.y){var s=o("yperiod");s&&(o("yperiod0",p(s,e.ycalendar)),o("yperiodalignment"))}}},{"../../constants/numerical":779,"../../lib":803}],1239:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../registry"),p=i("../../lib"),u=p.ensureSingle,e=p.identity,l=i("../../components/drawing"),o=i("./subtypes"),a=i("./line_points"),n=i("./link_traces"),s=i("../../lib/polygon").tester;function r(c,f,d,g,m,y,v){var T;(function(ge,ke,Me,Se,De){var Be=Me.xaxis,We=Me.yaxis,Qe=t.extent(p.simpleMap(Be.range,Be.r2c)),Oe=t.extent(p.simpleMap(We.range,We.r2c)),Ue=Se[0].trace;if(o.hasMarkers(Ue)){var Xe=Ue.marker.maxdisplayed;if(Xe!==0){var Ye=Se.filter(function(Et){return Et.x>=Qe[0]&&Et.x<=Qe[1]&&Et.y>=Oe[0]&&Et.y<=Oe[1]}),$e=Math.ceil(Ye.length/Xe),it=0;De.forEach(function(Et,mt){var tt=Et[0].trace;o.hasMarkers(tt)&&tt.marker.maxdisplayed>0&&mt<ke&&it++});var ot=Math.round(it*$e/3+Math.floor(it/3)*$e/7.1);Se.forEach(function(Et){delete Et.vis}),Ye.forEach(function(Et,mt){Math.round((mt+ot)%$e)===0&&(Et.vis=!0)})}}})(0,f,d,g,m);var _=!!v&&v.duration>0;function k(ge){return _?ge.transition():ge}var E=d.xaxis,A=d.yaxis,b=g[0].trace,L=b.line,w=t.select(y),C=u(w,"g","errorbars"),S=u(w,"g","lines"),P=u(w,"g","points"),z=u(w,"g","text");if(h.getComponentMethod("errorbars","plot")(c,C,d,v),b.visible===!0){var F,q;k(w).style("opacity",b.opacity);var W=b.fill.charAt(b.fill.length-1);W!=="x"&&W!=="y"&&(W=""),g[0][d.isRangePlot?"nodeRangePlot3":"node3"]=w;var X,Q,Z="",Y=[],N=b._prevtrace;N&&(Z=N._prevRevpath||"",q=N._nextFill,Y=N._polygons);var J,D,U,G,$,K,re,ne="",ae="",ie=[],he=p.noop;if(F=b._ownFill,o.hasLines(b)||b.fill!=="none"){for(q&&q.datum(g),["hv","vh","hvh","vhv"].indexOf(L.shape)!==-1?(J=l.steps(L.shape),D=l.steps(L.shape.split("").reverse().join(""))):J=D=L.shape==="spline"?function(ge){var ke=ge[ge.length-1];return ge.length>1&&ge[0][0]===ke[0]&&ge[0][1]===ke[1]?l.smoothclosed(ge.slice(1),L.smoothing):l.smoothopen(ge,L.smoothing)}:function(ge){return"M"+ge.join("L")},U=function(ge){return D(ge.reverse())},ie=a(g,{xaxis:E,yaxis:A,connectGaps:b.connectgaps,baseTolerance:Math.max(L.width||1,3)/4,shape:L.shape,simplify:L.simplify,fill:b.fill}),re=b._polygons=new Array(ie.length),T=0;T<ie.length;T++)b._polygons[T]=s(ie[T]);ie.length&&(G=ie[0][0],K=($=ie[ie.length-1])[$.length-1]),he=function(ge){return function(ke){if(X=J(ke),Q=U(ke),ne?W?(ne+="L"+X.substr(1),ae=Q+"L"+ae.substr(1)):(ne+="Z"+X,ae=Q+"Z"+ae):(ne=X,ae=Q),o.hasLines(b)&&ke.length>1){var Me=t.select(this);if(Me.datum(g),ge)k(Me.style("opacity",0).attr("d",X).call(l.lineGroupStyle)).style("opacity",1);else{var Se=k(Me);Se.attr("d",X),l.singleLineStyle(g,Se)}}}}}var se=S.selectAll(".js-line").data(ie);k(se.exit()).style("opacity",0).remove(),se.each(he(!1)),se.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(l.lineGroupStyle).each(he(!0)),l.setClipUrl(se,d.layerClipId,c),ie.length?(F?(F.datum(g),G&&K&&(W?(W==="y"?G[1]=K[1]=A.c2p(0,!0):W==="x"&&(G[0]=K[0]=E.c2p(0,!0)),k(F).attr("d","M"+K+"L"+G+"L"+ne.substr(1)).call(l.singleFillStyle)):k(F).attr("d",ne+"Z").call(l.singleFillStyle))):q&&(b.fill.substr(0,6)==="tonext"&&ne&&Z?(b.fill==="tonext"?k(q).attr("d",ne+"Z"+Z+"Z").call(l.singleFillStyle):k(q).attr("d",ne+"L"+Z.substr(1)+"Z").call(l.singleFillStyle),b._polygons=b._polygons.concat(Y)):(ce(q),b._polygons=null)),b._prevRevpath=ae,b._prevPolygons=re):(F?ce(F):q&&ce(q),b._polygons=b._prevRevpath=b._prevPolygons=null),P.datum(g),z.datum(g),function(ge,ke,Me){var Se,De=Me[0].trace,Be=o.hasMarkers(De),We=o.hasText(De),Qe=xe(De),Oe=fe,Ue=fe;if(Be||We){var Xe=e,Ye=De.stackgroup,$e=Ye&&c._fullLayout._scatterStackOpts[E._id+A._id][Ye].stackgaps==="infer zero";De.marker.maxdisplayed||De._needsCull?Xe=$e?Ee:ve:Ye&&!$e&&(Xe=Le),Be&&(Oe=Xe),We&&(Ue=Xe)}var it,ot=(Se=ge.selectAll("path.point").data(Oe,Qe)).enter().append("path").classed("point",!0);_&&ot.call(l.pointStyle,De,c).call(l.translatePoints,E,A).style("opacity",0).transition().style("opacity",1),Se.order(),Be&&(it=l.makePointStyleFns(De)),Se.each(function(Et){var mt=t.select(this),tt=k(mt);l.translatePoint(Et,tt,E,A)?(l.singlePointStyle(Et,tt,De,it,c),d.layerClipId&&l.hideOutsideRangePoint(Et,tt,E,A,De.xcalendar,De.ycalendar),De.customdata&&mt.classed("plotly-customdata",Et.data!==null&&Et.data!==void 0)):tt.remove()}),_?Se.exit().transition().style("opacity",0).remove():Se.exit().remove(),(Se=ke.selectAll("g").data(Ue,Qe)).enter().append("g").classed("textpoint",!0).append("text"),Se.order(),Se.each(function(Et){var mt=t.select(this),tt=k(mt.select("text"));l.translatePoint(Et,tt,E,A)?d.layerClipId&&l.hideOutsideRangePoint(Et,mt,E,A,De.xcalendar,De.ycalendar):mt.remove()}),Se.selectAll("text").call(l.textPointStyle,De,c).each(function(Et){var mt=E.c2p(Et.x),tt=A.c2p(Et.y);t.select(this).selectAll("tspan.line").each(function(){k(t.select(this)).attr({x:mt,y:tt})})}),Se.exit().remove()}(P,z,g);var de=b.cliponaxis===!1?null:d.layerClipId;l.setClipUrl(P,de,c),l.setClipUrl(z,de,c)}function ce(ge){k(ge).attr("d","M0,0Z")}function ve(ge){return ge.filter(function(ke){return!ke.gap&&ke.vis})}function Ee(ge){return ge.filter(function(ke){return ke.vis})}function Le(ge){return ge.filter(function(ke){return!ke.gap})}function Te(ge){return ge.id}function xe(ge){if(ge.ids)return Te}function fe(){return!1}}B.exports=function(c,f,d,g,m,y){var v,T,_=!m,k=!!m&&m.duration>0,E=n(c,f,d);(v=g.selectAll("g.trace").data(E,function(A){return A[0].trace.uid})).enter().append("g").attr("class",function(A){return"trace scatter trace"+A[0].trace.uid}).style("stroke-miterlimit",2),v.order(),function(A,b,L){b.each(function(w){var C=u(t.select(this),"g","fills");l.setClipUrl(C,L.layerClipId,A);var S=w[0].trace,P=[];S._ownfill&&P.push("_ownFill"),S._nexttrace&&P.push("_nextFill");var z=C.selectAll("g").data(P,e);z.enter().append("g"),z.exit().each(function(F){S[F]=null}).remove(),z.order().each(function(F){S[F]=u(t.select(this),"path","js-fill")})})}(c,v,f),k?(y&&(T=y()),t.transition().duration(m.duration).ease(m.easing).each("end",function(){T&&T()}).each("interrupt",function(){T&&T()}).each(function(){g.selectAll("g.trace").each(function(A,b){r(c,b,f,A,E,this,m)})})):v.each(function(A,b){r(c,b,f,A,E,this,m)}),_&&v.exit().remove(),g.selectAll("path:not([d])").remove()}},{"../../components/drawing":688,"../../lib":803,"../../lib/polygon":815,"../../registry":931,"./line_points":1232,"./link_traces":1234,"./subtypes":1243,"@plotly/d3":58}],1240:[function(i,B,V){var t=i("./subtypes");B.exports=function(h,p){var u,e,l,o,a=h.cd,n=h.xaxis,s=h.yaxis,r=[],c=a[0].trace;if(!t.hasMarkers(c)&&!t.hasText(c))return[];if(p===!1)for(u=0;u<a.length;u++)a[u].selected=0;else for(u=0;u<a.length;u++)e=a[u],l=n.c2p(e.x),o=s.c2p(e.y),e.i!==null&&p.contains([l,o],!1,u,h)?(r.push({pointNumber:e.i,x:n.c2d(e.x),y:s.c2d(e.y)}),e.selected=1):e.selected=0;return r}},{"./subtypes":1243}],1241:[function(i,B,V){var t=["orientation","groupnorm","stackgaps"];B.exports=function(h,p,u,e){var l=u._scatterStackOpts,o=e("stackgroup");if(o){var a=p.xaxis+p.yaxis,n=l[a];n||(n=l[a]={});var s=n[o],r=!1;s?s.traces.push(p):(s=n[o]={traceIndices:[],traces:[p]},r=!0);for(var c={orientation:p.x&&!p.y?"h":"v"},f=0;f<t.length;f++){var d=t[f],g=d+"Found";if(!s[g]){var m=h[d]!==void 0,y=d==="orientation";if((m||r)&&(s[d]=e(d,c[d]),y&&(s.fillDflt=s[d]==="h"?"tonextx":"tonexty"),m&&(s[g]=!0,!r&&(delete s.traces[0][d],y))))for(var v=0;v<s.traces.length-1;v++){var T=s.traces[v];T._input.fill!==T.fill&&(T.fill=s.fillDflt)}}}return s}}},{}],1242:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/drawing"),p=i("../../registry");function u(l,o,a){h.pointStyle(l.selectAll("path.point"),o,a)}function e(l,o,a){h.textPointStyle(l.selectAll("text"),o,a)}B.exports={style:function(l){var o=t.select(l).selectAll("g.trace.scatter");o.style("opacity",function(a){return a[0].trace.opacity}),o.selectAll("g.points").each(function(a){u(t.select(this),a.trace||a[0].trace,l)}),o.selectAll("g.text").each(function(a){e(t.select(this),a.trace||a[0].trace,l)}),o.selectAll("g.trace path.js-line").call(h.lineGroupStyle),o.selectAll("g.trace path.js-fill").call(h.fillGroupStyle),p.getComponentMethod("errorbars","style")(o)},stylePoints:u,styleText:e,styleOnSelect:function(l,o,a){var n=o[0].trace;n.selectedpoints?(h.selectedPointStyle(a.selectAll("path.point"),n),h.selectedTextStyle(a.selectAll("text"),n)):(u(a,n,l),e(a,n,l))}}},{"../../components/drawing":688,"../../registry":931,"@plotly/d3":58}],1243:[function(i,B,V){var t=i("../../lib");B.exports={hasLines:function(h){return h.visible&&h.mode&&h.mode.indexOf("lines")!==-1},hasMarkers:function(h){return h.visible&&(h.mode&&h.mode.indexOf("markers")!==-1||h.type==="splom")},hasText:function(h){return h.visible&&h.mode&&h.mode.indexOf("text")!==-1},isBubble:function(h){return t.isPlainObject(h.marker)&&t.isArrayOrTypedArray(h.marker.size)}}},{"../../lib":803}],1244:[function(i,B,V){var t=i("../../lib");B.exports=function(h,p,u,e,l){l=l||{},e("textposition"),t.coerceFont(e,"textfont",u.font),l.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":803}],1245:[function(i,B,V){var t=i("../../lib"),h=i("../../registry");B.exports=function(p,u,e,l){var o,a=l("x"),n=l("y");if(h.getComponentMethod("calendars","handleTraceDefaults")(p,u,["x","y"],e),a){var s=t.minRowLength(a);n?o=Math.min(s,t.minRowLength(n)):(o=s,l("y0"),l("dy"))}else{if(!n)return 0;o=t.minRowLength(n),l("x0"),l("dx")}return u._length=o,o}},{"../../lib":803,"../../registry":931}],1246:[function(i,B,V){var t=i("../scatter/attributes"),h=i("../../components/colorscale/attributes"),p=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,u=i("../../plots/template_attributes").hovertemplateAttrs,e=i("../../plots/template_attributes").texttemplateAttrs,l=i("../../plots/attributes"),o=i("../../constants/gl3d_dashes"),a=i("../../constants/gl3d_markers"),n=i("../../lib/extend").extendFlat,s=i("../../plot_api/edit_types").overrideAll,r=i("../../lib/sort_object_keys"),c=t.line,f=t.marker,d=f.line,g=n({width:c.width,dash:{valType:"enumerated",values:r(o),dflt:"solid"}},h("line")),m=B.exports=s({x:t.x,y:t.y,z:{valType:"data_array"},text:n({},t.text,{}),texttemplate:e({},{}),hovertext:n({},t.hovertext,{}),hovertemplate:u(),xhoverformat:p("x"),yhoverformat:p("y"),zhoverformat:p("z"),mode:n({},t.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:t.connectgaps,line:g,marker:n({symbol:{valType:"enumerated",values:r(a),dflt:"circle",arrayOk:!0},size:n({},f.size,{dflt:8}),sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,opacity:n({},f.opacity,{arrayOk:!1}),colorbar:f.colorbar,line:n({width:n({},d.width,{arrayOk:!1})},h("marker.line"))},h("marker")),textposition:n({},t.textposition,{dflt:"top center"}),textfont:{color:t.textfont.color,size:t.textfont.size,family:n({},t.textfont.family,{arrayOk:!1})},hoverinfo:n({},l.hoverinfo)},"calc","nested");m.x.editType=m.y.editType=m.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":673,"../../constants/gl3d_dashes":776,"../../constants/gl3d_markers":777,"../../lib/extend":793,"../../lib/sort_object_keys":826,"../../plot_api/edit_types":836,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../scatter/attributes":1218}],1247:[function(i,B,V){var t=i("../scatter/arrays_to_calcdata"),h=i("../scatter/colorscale_calc");B.exports=function(p,u){var e=[{x:!1,y:!1,trace:u,t:{}}];return t(e,u),h(p,u),e}},{"../scatter/arrays_to_calcdata":1217,"../scatter/colorscale_calc":1221}],1248:[function(i,B,V){var t=i("../../registry");function h(p,u,e,l){if(!u||!u.visible)return null;for(var o=t.getComponentMethod("errorbars","makeComputeError")(u),a=new Array(p.length),n=0;n<p.length;n++){var s=o(+p[n],n);if(l.type==="log"){var r=l.c2l(p[n]),c=p[n]-s[0],f=p[n]+s[1];if(a[n]=[(l.c2l(c,!0)-r)*e,(l.c2l(f,!0)-r)*e],c>0){var d=l.c2l(c);l._lowerLogErrorBound||(l._lowerLogErrorBound=d),l._lowerErrorBound=Math.min(l._lowerLogErrorBound,d)}}else a[n]=[-s[0]*e,s[1]*e]}return a}B.exports=function(p,u,e){var l=[h(p.x,p.error_x,u[0],e.xaxis),h(p.y,p.error_y,u[1],e.yaxis),h(p.z,p.error_z,u[2],e.zaxis)],o=function(f){for(var d=0;d<f.length;d++)if(f[d])return f[d].length;return 0}(l);if(o===0)return null;for(var a=new Array(o),n=0;n<o;n++){for(var s=[[0,0,0],[0,0,0]],r=0;r<3;r++)if(l[r])for(var c=0;c<2;c++)s[c][r]=l[r][n][c];a[n]=s}return a}},{"../../registry":931}],1249:[function(i,B,V){var t=i("gl-line3d"),h=i("gl-scatter3d"),p=i("gl-error3d"),u=i("gl-mesh3d"),e=i("delaunay-triangulate"),l=i("../../lib"),o=i("../../lib/str2rgbarray"),a=i("../../lib/gl_format_color").formatColor,n=i("../scatter/make_bubble_size_func"),s=i("../../constants/gl3d_dashes"),r=i("../../constants/gl3d_markers"),c=i("../../plots/cartesian/axes"),f=i("../../components/fx/helpers").appendArrayPointValue,d=i("./calc_errors");function g(L,w){this.scene=L,this.uid=w,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var m=g.prototype;function y(L){return L==null?0:L.indexOf("left")>-1?-1:L.indexOf("right")>-1?1:0}function v(L){return L==null?0:L.indexOf("top")>-1?-1:L.indexOf("bottom")>-1?1:0}function T(L,w){return w(4*L)}function _(L){return r[L]}function k(L,w,C,S,P){var z=null;if(l.isArrayOrTypedArray(L)){z=[];for(var F=0;F<w;F++)L[F]===void 0?z[F]=S:z[F]=C(L[F],P)}else z=C(L,l.identity);return z}function E(L,w){var C,S,P,z,F,q,W=[],X=L.fullSceneLayout,Q=L.dataScale,Z=X.xaxis,Y=X.yaxis,N=X.zaxis,J=w.marker,D=w.line,U=w.x||[],G=w.y||[],$=w.z||[],K=U.length,re=w.xcalendar,ne=w.ycalendar,ae=w.zcalendar;for(F=0;F<K;F++)C=Z.d2l(U[F],0,re)*Q[0],S=Y.d2l(G[F],0,ne)*Q[1],P=N.d2l($[F],0,ae)*Q[2],W[F]=[C,S,P];if(Array.isArray(w.text))q=w.text;else if(w.text!==void 0)for(q=new Array(K),F=0;F<K;F++)q[F]=w.text;function ie(Se,De){var Be=X[Se];return c.tickText(Be,Be.d2l(De),!0).text}var he=w.texttemplate;if(he){var se=L.fullLayout._d3locale,de=Array.isArray(he),ce=de?Math.min(he.length,K):K,ve=de?function(Se){return he[Se]}:function(){return he};for(q=new Array(ce),F=0;F<ce;F++){var Ee={x:U[F],y:G[F],z:$[F]},Le={xLabel:ie("xaxis",U[F]),yLabel:ie("yaxis",G[F]),zLabel:ie("zaxis",$[F])},Te={};f(Te,w,F);var xe=w._meta||{};q[F]=l.texttemplateString(ve(F),Le,se,Te,Ee,xe)}}if(z={position:W,mode:w.mode,text:q},"line"in w&&(z.lineColor=a(D,1,K),z.lineWidth=D.width,z.lineDashes=D.dash),"marker"in w){var fe=n(w);z.scatterColor=a(J,1,K),z.scatterSize=k(J.size,K,T,20,fe),z.scatterMarker=k(J.symbol,K,_,"●"),z.scatterLineWidth=J.line.width,z.scatterLineColor=a(J.line,1,K),z.scatterAngle=0}"textposition"in w&&(z.textOffset=function(Se){var De=[0,0];if(Array.isArray(Se))for(var Be=0;Be<Se.length;Be++)De[Be]=[0,0],Se[Be]&&(De[Be][0]=y(Se[Be]),De[Be][1]=v(Se[Be]));else De[0]=y(Se),De[1]=v(Se);return De}(w.textposition),z.textColor=a(w.textfont,1,K),z.textSize=k(w.textfont.size,K,l.identity,12),z.textFont=w.textfont.family,z.textAngle=0);var ge=["x","y","z"];for(z.project=[!1,!1,!1],z.projectScale=[1,1,1],z.projectOpacity=[1,1,1],F=0;F<3;++F){var ke=w.projection[ge[F]];(z.project[F]=ke.show)&&(z.projectOpacity[F]=ke.opacity,z.projectScale[F]=ke.scale)}z.errorBounds=d(w,Q,X);var Me=function(Se){for(var De=[0,0,0],Be=[[0,0,0],[0,0,0],[0,0,0]],We=[1,1,1],Qe=0;Qe<3;Qe++){var Oe=Se[Qe];Oe&&Oe.copy_zstyle!==!1&&Se[2].visible!==!1&&(Oe=Se[2]),Oe&&Oe.visible&&(De[Qe]=Oe.width/2,Be[Qe]=o(Oe.color),We[Qe]=Oe.thickness)}return{capSize:De,color:Be,lineWidth:We}}([w.error_x,w.error_y,w.error_z]);return z.errorColor=Me.color,z.errorLineWidth=Me.lineWidth,z.errorCapSize=Me.capSize,z.delaunayAxis=w.surfaceaxis,z.delaunayColor=o(w.surfacecolor),z}function A(L){if(l.isArrayOrTypedArray(L)){var w=L[0];return l.isArrayOrTypedArray(w)&&(L=w),"rgb("+L.slice(0,3).map(function(C){return Math.round(255*C)})+")"}return null}function b(L){return l.isArrayOrTypedArray(L)?L.length===4&&typeof L[0]=="number"?A(L):L.map(A):null}m.handlePick=function(L){if(L.object&&(L.object===this.linePlot||L.object===this.delaunayMesh||L.object===this.textMarkers||L.object===this.scatterPlot)){var w=L.index=L.data.index;return L.object.highlight&&L.object.highlight(null),this.scatterPlot&&(L.object=this.scatterPlot,this.scatterPlot.highlight(L.data)),L.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[w]||this.textLabels[w]===0)&&(L.textLabel=this.textLabels[w]):L.textLabel=this.textLabels),L.traceCoordinate=[this.data.x[w],this.data.y[w],this.data.z[w]],!0}},m.update=function(L){var w,C,S,P,z=this.scene.glplot.gl,F=s.solid;this.data=L;var q=E(this.scene,L);"mode"in q&&(this.mode=q.mode),"lineDashes"in q&&q.lineDashes in s&&(F=s[q.lineDashes]),this.color=b(q.scatterColor)||b(q.lineColor),this.dataPoints=q.position,w={gl:this.scene.glplot.gl,position:q.position,color:q.lineColor,lineWidth:q.lineWidth||1,dashes:F[0],dashScale:F[1],opacity:L.opacity,connectGaps:L.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(w):(this.linePlot=t(w),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var W=L.opacity;if(L.marker&&L.marker.opacity&&(W*=L.marker.opacity),C={gl:this.scene.glplot.gl,position:q.position,color:q.scatterColor,size:q.scatterSize,glyph:q.scatterMarker,opacity:W,orthographic:!0,lineWidth:q.scatterLineWidth,lineColor:q.scatterLineColor,project:q.project,projectScale:q.projectScale,projectOpacity:q.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(C):(this.scatterPlot=h(C),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),P={gl:this.scene.glplot.gl,position:q.position,glyph:q.text,color:q.textColor,size:q.textSize,angle:q.textAngle,alignment:q.textOffset,font:q.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:L.opacity},this.textLabels=L.hovertext||L.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(P):(this.textMarkers=h(P),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),S={gl:this.scene.glplot.gl,position:q.position,color:q.errorColor,error:q.errorBounds,lineWidth:q.errorLineWidth,capSize:q.errorCapSize,opacity:L.opacity},this.errorBars?q.errorBounds?this.errorBars.update(S):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):q.errorBounds&&(this.errorBars=p(S),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),q.delaunayAxis>=0){var X=function(Q,Z,Y){var N,J=(Y+1)%3,D=(Y+2)%3,U=[],G=[];for(N=0;N<Q.length;++N){var $=Q[N];!isNaN($[J])&&isFinite($[J])&&!isNaN($[D])&&isFinite($[D])&&(U.push([$[J],$[D]]),G.push(N))}var K=e(U);for(N=0;N<K.length;++N)for(var re=K[N],ne=0;ne<re.length;++ne)re[ne]=G[re[ne]];return{positions:Q,cells:K,meshColor:Z}}(q.position,q.delaunayColor,q.delaunayAxis);X.opacity=L.opacity,this.delaunayMesh?this.delaunayMesh.update(X):(X.gl=z,this.delaunayMesh=u(X),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},m.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},B.exports=function(L,w){var C=new g(L,w.uid);return C.update(w),C}},{"../../components/fx/helpers":702,"../../constants/gl3d_dashes":776,"../../constants/gl3d_markers":777,"../../lib":803,"../../lib/gl_format_color":799,"../../lib/str2rgbarray":828,"../../plots/cartesian/axes":854,"../scatter/make_bubble_size_func":1235,"./calc_errors":1248,"delaunay-triangulate":180,"gl-error3d":273,"gl-line3d":281,"gl-mesh3d":315,"gl-scatter3d":334}],1250:[function(i,B,V){var t=i("../../registry"),h=i("../../lib"),p=i("../scatter/subtypes"),u=i("../scatter/marker_defaults"),e=i("../scatter/line_defaults"),l=i("../scatter/text_defaults"),o=i("./attributes");B.exports=function(a,n,s,r){function c(T,_){return h.coerce(a,n,o,T,_)}if(function(T,_,k,E){var A=0,b=k("x"),L=k("y"),w=k("z");return t.getComponentMethod("calendars","handleTraceDefaults")(T,_,["x","y","z"],E),b&&L&&w&&(A=Math.min(b.length,L.length,w.length),_._length=_._xlength=_._ylength=_._zlength=A),A}(a,n,c,r)){c("text"),c("hovertext"),c("hovertemplate"),c("xhoverformat"),c("yhoverformat"),c("zhoverformat"),c("mode"),p.hasLines(n)&&(c("connectgaps"),e(a,n,s,r,c)),p.hasMarkers(n)&&u(a,n,s,r,c,{noSelect:!0}),p.hasText(n)&&(c("texttemplate"),l(a,n,r,c,{noSelect:!0}));var f=(n.line||{}).color,d=(n.marker||{}).color;c("surfaceaxis")>=0&&c("surfacecolor",f||d);for(var g=["x","y","z"],m=0;m<3;++m){var y="projection."+g[m];c(y+".show")&&(c(y+".opacity"),c(y+".scale"))}var v=t.getComponentMethod("errorbars","supplyDefaults");v(a,n,f||d||s,{axis:"z"}),v(a,n,f||d||s,{axis:"y",inherit:"z"}),v(a,n,f||d||s,{axis:"x",inherit:"z"})}else n.visible=!1}},{"../../lib":803,"../../registry":931,"../scatter/line_defaults":1231,"../scatter/marker_defaults":1237,"../scatter/subtypes":1243,"../scatter/text_defaults":1244,"./attributes":1246}],1251:[function(i,B,V){B.exports={plot:i("./convert"),attributes:i("./attributes"),markerSymbols:i("../../constants/gl3d_markers"),supplyDefaults:i("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:i("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:i("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":777,"../../plots/gl3d":896,"./attributes":1246,"./calc":1247,"./convert":1249,"./defaults":1250}],1252:[function(i,B,V){var t=i("../scatter/attributes"),h=i("../../plots/attributes"),p=i("../../plots/template_attributes").hovertemplateAttrs,u=i("../../plots/template_attributes").texttemplateAttrs,e=i("../../components/colorscale/attributes"),l=i("../../lib/extend").extendFlat,o=t.marker,a=t.line,n=o.line;B.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:l({},t.mode,{dflt:"markers"}),text:l({},t.text,{}),texttemplate:u({editType:"plot"},{keys:["a","b","text"]}),hovertext:l({},t.hovertext,{}),line:{color:a.color,width:a.width,dash:a.dash,shape:l({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:t.connectgaps,fill:l({},t.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:t.fillcolor,marker:l({symbol:o.symbol,opacity:o.opacity,maxdisplayed:o.maxdisplayed,size:o.size,sizeref:o.sizeref,sizemin:o.sizemin,sizemode:o.sizemode,line:l({width:n.width,editType:"calc"},e("marker.line")),gradient:o.gradient,editType:"calc"},e("marker")),textfont:t.textfont,textposition:t.textposition,selected:t.selected,unselected:t.unselected,hoverinfo:l({},h.hoverinfo,{flags:["a","b","text","name"]}),hoveron:t.hoveron,hovertemplate:p()}},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/template_attributes":926,"../scatter/attributes":1218}],1253:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../scatter/colorscale_calc"),p=i("../scatter/arrays_to_calcdata"),u=i("../scatter/calc_selection"),e=i("../scatter/calc").calcMarkerSize,l=i("../carpet/lookup_carpetid");B.exports=function(o,a){var n=a._carpetTrace=l(o,a);if(n&&n.visible&&n.visible!=="legendonly"){var s;a.xaxis=n.xaxis,a.yaxis=n.yaxis;var r,c,f=a._length,d=new Array(f),g=!1;for(s=0;s<f;s++)if(r=a.a[s],c=a.b[s],t(r)&&t(c)){var m=n.ab2xy(+r,+c,!0),y=n.isVisible(+r,+c);y||(g=!0),d[s]={x:m[0],y:m[1],a:r,b:c,vis:y}}else d[s]={x:!1,y:!1};return a._needsCull=g,d[0].carpet=n,d[0].trace=a,e(a,f),h(o,a),p(d,a),u(d,a),d}}},{"../carpet/lookup_carpetid":1001,"../scatter/arrays_to_calcdata":1217,"../scatter/calc":1219,"../scatter/calc_selection":1220,"../scatter/colorscale_calc":1221,"fast-isnumeric":249}],1254:[function(i,B,V){var t=i("../../lib"),h=i("../scatter/constants"),p=i("../scatter/subtypes"),u=i("../scatter/marker_defaults"),e=i("../scatter/line_defaults"),l=i("../scatter/line_shape_defaults"),o=i("../scatter/text_defaults"),a=i("../scatter/fillcolor_defaults"),n=i("./attributes");B.exports=function(s,r,c,f){function d(T,_){return t.coerce(s,r,n,T,_)}d("carpet"),r.xaxis="x",r.yaxis="y";var g=d("a"),m=d("b"),y=Math.min(g.length,m.length);if(y){r._length=y,d("text"),d("texttemplate"),d("hovertext"),d("mode",y<h.PTS_LINESONLY?"lines+markers":"lines"),p.hasLines(r)&&(e(s,r,c,f,d),l(s,r,d),d("connectgaps")),p.hasMarkers(r)&&u(s,r,c,f,d,{gradient:!0}),p.hasText(r)&&o(s,r,f,d);var v=[];(p.hasMarkers(r)||p.hasText(r))&&(d("marker.maxdisplayed"),v.push("points")),d("fill"),r.fill!=="none"&&(a(s,r,c,d),p.hasLines(r)||l(s,r,d)),r.fill!=="tonext"&&r.fill!=="toself"||v.push("fills"),d("hoveron",v.join("+")||"points")!=="fills"&&d("hovertemplate"),t.coerceSelectionMarkerOpacity(r,d)}else r.visible=!1}},{"../../lib":803,"../scatter/constants":1222,"../scatter/fillcolor_defaults":1226,"../scatter/line_defaults":1231,"../scatter/line_shape_defaults":1233,"../scatter/marker_defaults":1237,"../scatter/subtypes":1243,"../scatter/text_defaults":1244,"./attributes":1252}],1255:[function(i,B,V){B.exports=function(t,h,p,u,e){var l=u[e];return t.a=l.a,t.b=l.b,t.y=l.y,t}},{}],1256:[function(i,B,V){B.exports=function(t,h){var p={},u=h._carpet,e=u.ab2ij([t.a,t.b]),l=Math.floor(e[0]),o=e[0]-l,a=Math.floor(e[1]),n=e[1]-a,s=u.evalxy([],l,a,o,n);return p.yLabel=s[1].toFixed(3),p}},{}],1257:[function(i,B,V){var t=i("../scatter/hover"),h=i("../../lib").fillText;B.exports=function(p,u,e,l){var o=t(p,u,e,l);if(o&&o[0].index!==!1){var a=o[0];if(a.index===void 0){var n=1-a.y0/p.ya._length,s=p.xa._length,r=s*n/2,c=s-r;return a.x0=Math.max(Math.min(a.x0,c),r),a.x1=Math.max(Math.min(a.x1,c),r),o}var f=a.cd[a.index];a.a=f.a,a.b=f.b,a.xLabelVal=void 0,a.yLabelVal=void 0;var d=a.trace,g=d._carpet,m=d._module.formatLabels(f,d);a.yLabel=m.yLabel,delete a.text;var y=[];if(!d.hovertemplate){var v=(f.hi||d.hoverinfo).split("+");v.indexOf("all")!==-1&&(v=["a","b","text"]),v.indexOf("a")!==-1&&T(g.aaxis,f.a),v.indexOf("b")!==-1&&T(g.baxis,f.b),y.push("y: "+a.yLabel),v.indexOf("text")!==-1&&h(f,d,y),a.extraText=y.join("<br>")}return o}function T(_,k){var E;E=_.labelprefix&&_.labelprefix.length>0?_.labelprefix.replace(/ = $/,""):_._hovertitle,y.push(E+": "+k.toFixed(3)+_.labelsuffix)}}},{"../../lib":803,"../scatter/hover":1229}],1258:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../scatter/marker_colorbar"),formatLabels:i("./format_labels"),calc:i("./calc"),plot:i("./plot"),style:i("../scatter/style").style,styleOnSelect:i("../scatter/style").styleOnSelect,hoverPoints:i("./hover"),selectPoints:i("../scatter/select"),eventData:i("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:i("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":868,"../scatter/marker_colorbar":1236,"../scatter/select":1240,"../scatter/style":1242,"./attributes":1252,"./calc":1253,"./defaults":1254,"./event_data":1255,"./format_labels":1256,"./hover":1257,"./plot":1259}],1259:[function(i,B,V){var t=i("../scatter/plot"),h=i("../../plots/cartesian/axes"),p=i("../../components/drawing");B.exports=function(u,e,l,o){var a,n,s,r=l[0][0].carpet,c={xaxis:h.getFromId(u,r.xaxis||"x"),yaxis:h.getFromId(u,r.yaxis||"y"),plot:e.plot};for(t(u,c,l,o),a=0;a<l.length;a++)n=l[a][0].trace,s=o.selectAll("g.trace"+n.uid+" .js-line"),p.setClipUrl(s,l[a][0].carpet._clipPathId,u)}},{"../../components/drawing":688,"../../plots/cartesian/axes":854,"../scatter/plot":1239}],1260:[function(i,B,V){var t=i("../../plots/template_attributes").hovertemplateAttrs,h=i("../../plots/template_attributes").texttemplateAttrs,p=i("../scatter/attributes"),u=i("../../plots/attributes"),e=i("../../components/colorscale/attributes"),l=i("../../components/drawing/attributes").dash,o=i("../../lib/extend").extendFlat,a=i("../../plot_api/edit_types").overrideAll,n=p.marker,s=p.line,r=n.line;B.exports=a({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:o({},p.mode,{dflt:"markers"}),text:o({},p.text,{}),texttemplate:h({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:o({},p.hovertext,{}),textfont:p.textfont,textposition:p.textposition,line:{color:s.color,width:s.width,dash:l},connectgaps:p.connectgaps,marker:o({symbol:n.symbol,opacity:n.opacity,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,colorbar:n.colorbar,line:o({width:r.width},e("marker.line")),gradient:n.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:p.fillcolor,selected:p.selected,unselected:p.unselected,hoverinfo:o({},u.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:t()},"calc","nested")},{"../../components/colorscale/attributes":673,"../../components/drawing/attributes":687,"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plots/attributes":850,"../../plots/template_attributes":926,"../scatter/attributes":1218}],1261:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../constants/numerical").BADNUM,p=i("../scatter/colorscale_calc"),u=i("../scatter/arrays_to_calcdata"),e=i("../scatter/calc_selection"),l=i("../../lib")._;function o(a){return a&&typeof a=="string"}B.exports=function(a,n){var s,r=Array.isArray(n.locations),c=r?n.locations.length:n._length,f=new Array(c);s=n.geojson?function(T){return o(T)||t(T)}:o;for(var d=0;d<c;d++){var g=f[d]={};if(r){var m=n.locations[d];g.loc=s(m)?m:null}else{var y=n.lon[d],v=n.lat[d];t(y)&&t(v)?g.lonlat=[+y,+v]:g.lonlat=[h,h]}}return u(f,n),p(a,n),e(f,n),c&&(f[0].t={labels:{lat:l(a,"lat:")+" ",lon:l(a,"lon:")+" "}}),f}},{"../../constants/numerical":779,"../../lib":803,"../scatter/arrays_to_calcdata":1217,"../scatter/calc_selection":1220,"../scatter/colorscale_calc":1221,"fast-isnumeric":249}],1262:[function(i,B,V){var t=i("../../lib"),h=i("../scatter/subtypes"),p=i("../scatter/marker_defaults"),u=i("../scatter/line_defaults"),e=i("../scatter/text_defaults"),l=i("../scatter/fillcolor_defaults"),o=i("./attributes");B.exports=function(a,n,s,r){function c(T,_){return t.coerce(a,n,o,T,_)}var f,d=c("locations");if(d&&d.length){var g,m=c("geojson");(typeof m=="string"&&m!==""||t.isPlainObject(m))&&(g="geojson-id"),c("locationmode",g)==="geojson-id"&&c("featureidkey"),f=d.length}else{var y=c("lon")||[],v=c("lat")||[];f=Math.min(y.length,v.length)}f?(n._length=f,c("text"),c("hovertext"),c("hovertemplate"),c("mode"),h.hasLines(n)&&(u(a,n,s,r,c),c("connectgaps")),h.hasMarkers(n)&&p(a,n,s,r,c,{gradient:!0}),h.hasText(n)&&(c("texttemplate"),e(a,n,r,c)),c("fill"),n.fill!=="none"&&l(a,n,s,c),t.coerceSelectionMarkerOpacity(n,c)):n.visible=!1}},{"../../lib":803,"../scatter/fillcolor_defaults":1226,"../scatter/line_defaults":1231,"../scatter/marker_defaults":1237,"../scatter/subtypes":1243,"../scatter/text_defaults":1244,"./attributes":1260}],1263:[function(i,B,V){B.exports=function(t,h,p,u,e){t.lon=h.lon,t.lat=h.lat,t.location=h.loc?h.loc:null;var l=u[e];return l.fIn&&l.fIn.properties&&(t.properties=l.fIn.properties),t}},{}],1264:[function(i,B,V){var t=i("../../plots/cartesian/axes");B.exports=function(h,p,u){var e={},l=u[p.geo]._subplot.mockAxis,o=h.lonlat;return e.lonLabel=t.tickText(l,l.c2l(o[0]),!0).text,e.latLabel=t.tickText(l,l.c2l(o[1]),!0).text,e}},{"../../plots/cartesian/axes":854}],1265:[function(i,B,V){var t=i("../../components/fx"),h=i("../../constants/numerical").BADNUM,p=i("../scatter/get_trace_color"),u=i("../../lib").fillText,e=i("./attributes");B.exports=function(l,o,a){var n=l.cd,s=n[0].trace,r=l.xa,c=l.ya,f=l.subplot,d=f.projection.isLonLatOverEdges,g=f.project;if(t.getClosest(n,function(E){var A=E.lonlat;if(A[0]===h||d(A))return 1/0;var b=g(A),L=g([o,a]),w=Math.abs(b[0]-L[0]),C=Math.abs(b[1]-L[1]),S=Math.max(3,E.mrc||0);return Math.max(Math.sqrt(w*w+C*C)-S,1-3/S)},l),l.index!==!1){var m=n[l.index],y=m.lonlat,v=[r.c2p(y),c.c2p(y)],T=m.mrc||1;l.x0=v[0]-T,l.x1=v[0]+T,l.y0=v[1]-T,l.y1=v[1]+T,l.loc=m.loc,l.lon=y[0],l.lat=y[1];var _={};_[s.geo]={_subplot:f};var k=s._module.formatLabels(m,s,_);return l.lonLabel=k.lonLabel,l.latLabel=k.latLabel,l.color=p(s,m),l.extraText=function(E,A,b,L){if(E.hovertemplate)return;var w=A.hi||E.hoverinfo,C=w==="all"?e.hoverinfo.flags:w.split("+"),S=C.indexOf("location")!==-1&&Array.isArray(E.locations),P=C.indexOf("lon")!==-1,z=C.indexOf("lat")!==-1,F=C.indexOf("text")!==-1,q=[];function W(X){return X+"°"}return S?q.push(A.loc):P&&z?q.push("("+W(b.latLabel)+", "+W(b.lonLabel)+")"):P?q.push(L.lon+W(b.lonLabel)):z&&q.push(L.lat+W(b.latLabel)),F&&u(A,E,q),q.join("<br>")}(s,m,l,n[0].t.labels),l.hovertemplate=s.hovertemplate,[l]}}},{"../../components/fx":706,"../../constants/numerical":779,"../../lib":803,"../scatter/get_trace_color":1228,"./attributes":1260}],1266:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../scatter/marker_colorbar"),formatLabels:i("./format_labels"),calc:i("./calc"),calcGeoJSON:i("./plot").calcGeoJSON,plot:i("./plot").plot,style:i("./style"),styleOnSelect:i("../scatter/style").styleOnSelect,hoverPoints:i("./hover"),eventData:i("./event_data"),selectPoints:i("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:i("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":887,"../scatter/marker_colorbar":1236,"../scatter/style":1242,"./attributes":1260,"./calc":1261,"./defaults":1262,"./event_data":1263,"./format_labels":1264,"./hover":1265,"./plot":1267,"./select":1268,"./style":1269}],1267:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../lib/topojson_utils").getTopojsonFeatures,u=i("../../lib/geojson_utils"),e=i("../../lib/geo_location_utils"),l=i("../../plots/cartesian/autorange").findExtremes,o=i("../../constants/numerical").BADNUM,a=i("../scatter/calc").calcMarkerSize,n=i("../scatter/subtypes"),s=i("./style");B.exports={calcGeoJSON:function(r,c){var f,d,g=r[0].trace,m=c[g.geo],y=m._subplot,v=g._length;if(Array.isArray(g.locations)){var T=g.locationmode,_=T==="geojson-id"?e.extractTraceFeature(r):p(g,y.topojson);for(f=0;f<v;f++){d=r[f];var k=T==="geojson-id"?d.fOut:e.locationToFeature(T,d.loc,_);d.lonlat=k?k.properties.ct:[o,o]}}var E,A,b={padded:!0};if(m.fitbounds==="geojson"&&g.locationmode==="geojson-id"){var L=e.computeBbox(e.getTraceGeojson(g));E=[L[0],L[2]],A=[L[1],L[3]]}else{for(E=new Array(v),A=new Array(v),f=0;f<v;f++)d=r[f],E[f]=d.lonlat[0],A[f]=d.lonlat[1];b.ppad=a(g,v)}g._extremes.lon=l(m.lonaxis._ax,E,b),g._extremes.lat=l(m.lataxis._ax,A,b)},plot:function(r,c,f){var d=c.layers.frontplot.select(".scatterlayer"),g=h.makeTraceGroups(d,f,"trace scattergeo");function m(y,v){y.lonlat[0]===o&&t.select(v).remove()}g.selectAll("*").remove(),g.each(function(y){var v=t.select(this),T=y[0].trace;if(n.hasLines(T)||T.fill!=="none"){var _=u.calcTraceToLineCoords(y),k=T.fill!=="none"?u.makePolygon(_):u.makeLine(_);v.selectAll("path.js-line").data([{geojson:k,trace:T}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}n.hasMarkers(T)&&v.selectAll("path.point").data(h.identity).enter().append("path").classed("point",!0).each(function(E){m(E,this)}),n.hasText(T)&&v.selectAll("g").data(h.identity).enter().append("g").append("text").each(function(E){m(E,this)}),s(r,y)})}}},{"../../constants/numerical":779,"../../lib":803,"../../lib/geo_location_utils":796,"../../lib/geojson_utils":797,"../../lib/topojson_utils":832,"../../plots/cartesian/autorange":853,"../scatter/calc":1219,"../scatter/subtypes":1243,"./style":1269,"@plotly/d3":58}],1268:[function(i,B,V){var t=i("../scatter/subtypes"),h=i("../../constants/numerical").BADNUM;B.exports=function(p,u){var e,l,o,a,n,s=p.cd,r=p.xaxis,c=p.yaxis,f=[],d=s[0].trace;if(!t.hasMarkers(d)&&!t.hasText(d))return[];if(u===!1)for(n=0;n<s.length;n++)s[n].selected=0;else for(n=0;n<s.length;n++)(l=(e=s[n]).lonlat)[0]!==h&&(o=r.c2p(l),a=c.c2p(l),u.contains([o,a],null,n,p)?(f.push({pointNumber:n,lon:l[0],lat:l[1]}),e.selected=1):e.selected=0);return f}},{"../../constants/numerical":779,"../scatter/subtypes":1243}],1269:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/drawing"),p=i("../../components/color"),u=i("../scatter/style"),e=u.stylePoints,l=u.styleText;B.exports=function(o,a){a&&function(n,s){var r=s[0].trace,c=s[0].node3;c.style("opacity",s[0].trace.opacity),e(c,r,n),l(c,r,n),c.selectAll("path.js-line").style("fill","none").each(function(f){var d=t.select(this),g=f.trace,m=g.line||{};d.call(p.stroke,m.color).call(h.dashLine,m.dash||"",m.width||0),g.fill!=="none"&&d.call(p.fill,g.fillcolor)})}(o,a)}},{"../../components/color":666,"../../components/drawing":688,"../scatter/style":1242,"@plotly/d3":58}],1270:[function(i,B,V){var t=i("../../plots/attributes"),h=i("../scatter/attributes"),p=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,u=i("../../components/colorscale/attributes"),e=i("../../lib/sort_object_keys"),l=i("../../lib/extend").extendFlat,o=i("../../plot_api/edit_types").overrideAll,a=i("./constants").DASHES,n=h.line,s=h.marker,r=s.line,c=B.exports=o({x:h.x,x0:h.x0,dx:h.dx,y:h.y,y0:h.y0,dy:h.dy,xperiod:h.xperiod,yperiod:h.yperiod,xperiod0:h.xperiod0,yperiod0:h.yperiod0,xperiodalignment:h.xperiodalignment,yperiodalignment:h.yperiodalignment,xhoverformat:p("x"),yhoverformat:p("y"),text:h.text,hovertext:h.hovertext,textposition:h.textposition,textfont:h.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:n.color,width:n.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(a),dflt:"solid"}},marker:l({},u("marker"),{symbol:s.symbol,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode,opacity:s.opacity,colorbar:s.colorbar,line:l({},u("marker.line"),{width:r.width})}),connectgaps:h.connectgaps,fill:l({},h.fill,{dflt:"none"}),fillcolor:h.fillcolor,selected:{marker:h.selected.marker,textfont:h.selected.textfont},unselected:{marker:h.unselected.marker,textfont:h.unselected.textfont},opacity:t.opacity},"calc","nested");c.x.editType=c.y.editType=c.x0.editType=c.y0.editType="calc+clearAxisTypes",c.hovertemplate=h.hovertemplate,c.texttemplate=h.texttemplate},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../lib/sort_object_keys":826,"../../plot_api/edit_types":836,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../scatter/attributes":1218,"./constants":1272}],1271:[function(i,B,V){var t=i("@plotly/point-cluster"),h=i("../../lib"),p=i("../../plots/cartesian/axis_ids"),u=i("../../plots/cartesian/autorange").findExtremes,e=i("../../plots/cartesian/align_period"),l=i("../scatter/calc"),o=l.calcMarkerSize,a=l.calcAxisExpansion,n=l.setFirstScatter,s=i("../scatter/colorscale_calc"),r=i("./convert"),c=i("./scene_update"),f=i("../../constants/numerical").BADNUM,d=i("./constants").TOO_MANY_POINTS;function g(m,y,v){var T=m._extremes[y._id],_=u(y,v._bnds,{padded:!0});T.min=T.min.concat(_.min),T.max=T.max.concat(_.max)}B.exports=function(m,y){var v,T=m._fullLayout,_=p.getFromId(m,y.xaxis),k=p.getFromId(m,y.yaxis),E=T._plots[y.xaxis+y.yaxis],A=y._length,b=A>=d,L=2*A,w={},C=_.makeCalcdata(y,"x"),S=k.makeCalcdata(y,"y"),P=e(y,_,"x",C),z=e(y,k,"y",S),F=P.vals,q=z.vals;y._x=F,y._y=q,y.xperiodalignment&&(y._origX=C,y._xStarts=P.starts,y._xEnds=P.ends),y.yperiodalignment&&(y._origY=S,y._yStarts=z.starts,y._yEnds=z.ends);var W=new Array(L),X=new Array(A);for(v=0;v<A;v++)W[2*v]=F[v]===f?NaN:F[v],W[2*v+1]=q[v]===f?NaN:q[v],X[v]=v;if(_.type==="log")for(v=0;v<L;v+=2)W[v]=_.c2l(W[v]);if(k.type==="log")for(v=1;v<L;v+=2)W[v]=k.c2l(W[v]);b&&_.type!=="log"&&k.type!=="log"?w.tree=t(W):w.ids=X,s(m,y);var Q,Z=function(N,J,D,U,G,$){var K=r.style(N,D);if(K.marker&&(K.marker.positions=U),K.line&&U.length>1&&h.extendFlat(K.line,r.linePositions(N,D,U)),K.errorX||K.errorY){var re=r.errorBarPositions(N,D,U,G,$);K.errorX&&h.extendFlat(K.errorX,re.x),K.errorY&&h.extendFlat(K.errorY,re.y)}return K.text&&(h.extendFlat(K.text,{positions:U},r.textPosition(N,D,K.text,K.marker)),h.extendFlat(K.textSel,{positions:U},r.textPosition(N,D,K.text,K.markerSel)),h.extendFlat(K.textUnsel,{positions:U},r.textPosition(N,D,K.text,K.markerUnsel))),K}(m,0,y,W,F,q),Y=c(m,E);return n(T,y),b?Z.marker&&(Q=Z.marker.sizeAvg||Math.max(Z.marker.size,3)):Q=o(y,A),a(m,y,_,k,F,q,Q),Z.errorX&&g(y,_,Z.errorX),Z.errorY&&g(y,k,Z.errorY),Z.fill&&!Y.fill2d&&(Y.fill2d=!0),Z.marker&&!Y.scatter2d&&(Y.scatter2d=!0),Z.line&&!Y.line2d&&(Y.line2d=!0),!Z.errorX&&!Z.errorY||Y.error2d||(Y.error2d=!0),Z.text&&!Y.glText&&(Y.glText=!0),Z.marker&&(Z.marker.snap=A),Y.lineOptions.push(Z.line),Y.errorXOptions.push(Z.errorX),Y.errorYOptions.push(Z.errorY),Y.fillOptions.push(Z.fill),Y.markerOptions.push(Z.marker),Y.markerSelectedOptions.push(Z.markerSel),Y.markerUnselectedOptions.push(Z.markerUnsel),Y.textOptions.push(Z.text),Y.textSelectedOptions.push(Z.textSel),Y.textUnselectedOptions.push(Z.textUnsel),Y.selectBatch.push([]),Y.unselectBatch.push([]),w._scene=Y,w.index=Y.count,w.x=F,w.y=q,w.positions=W,Y.count++,[{x:!1,y:!1,t:w,trace:y}]}},{"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/align_period":851,"../../plots/cartesian/autorange":853,"../../plots/cartesian/axis_ids":858,"../scatter/calc":1219,"../scatter/colorscale_calc":1221,"./constants":1272,"./convert":1273,"./scene_update":1281,"@plotly/point-cluster":59}],1272:[function(i,B,V){B.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1273:[function(i,B,V){var t=i("fast-isnumeric"),h=i("svg-path-sdf"),p=i("color-normalize"),u=i("../../registry"),e=i("../../lib"),l=i("../../components/drawing"),o=i("../../plots/cartesian/axis_ids"),a=i("../../lib/gl_format_color").formatColor,n=i("../scatter/subtypes"),s=i("../scatter/make_bubble_size_func"),r=i("./helpers"),c=i("./constants"),f=i("../../constants/interactions").DESELECTDIM,d={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},g=i("../../components/fx/helpers").appendArrayPointValue;function m(C,S){var P,z=C._fullLayout,F=S._length,q=S.textfont,W=S.textposition,X=Array.isArray(W)?W:[W],Q=q.color,Z=q.size,Y=q.family,N={},J=C._context.plotGlPixelRatio,D=S.texttemplate;if(D){N.text=[];var U=z._d3locale,G=Array.isArray(D),$=G?Math.min(D.length,F):F,K=G?function(de){return D[de]}:function(){return D};for(P=0;P<$;P++){var re={i:P},ne=S._module.formatLabels(re,S,z),ae={};g(ae,S,P);var ie=S._meta||{};N.text.push(e.texttemplateString(K(P),ne,U,ae,re,ie))}}else Array.isArray(S.text)&&S.text.length<F?N.text=S.text.slice():N.text=S.text;if(Array.isArray(N.text))for(P=N.text.length;P<F;P++)N.text[P]="";for(N.opacity=S.opacity,N.font={},N.align=[],N.baseline=[],P=0;P<X.length;P++){var he=X[P].split(/\s+/);switch(he[1]){case"left":N.align.push("right");break;case"right":N.align.push("left");break;default:N.align.push(he[1])}switch(he[0]){case"top":N.baseline.push("bottom");break;case"bottom":N.baseline.push("top");break;default:N.baseline.push(he[0])}}if(Array.isArray(Q))for(N.color=new Array(F),P=0;P<F;P++)N.color[P]=Q[P];else N.color=Q;if(e.isArrayOrTypedArray(Z)||Array.isArray(Y))for(N.font=new Array(F),P=0;P<F;P++){var se=N.font[P]={};se.size=(e.isTypedArray(Z)?Z[P]:Array.isArray(Z)?t(Z[P])?Z[P]:0:Z)*J,se.family=Array.isArray(Y)?Y[P]:Y}else N.font={size:Z*J,family:Y};return N}function y(C){var S,P,z=C._length,F=C.marker,q={},W=e.isArrayOrTypedArray(F.symbol),X=e.isArrayOrTypedArray(F.color),Q=e.isArrayOrTypedArray(F.line.color),Z=e.isArrayOrTypedArray(F.opacity),Y=e.isArrayOrTypedArray(F.size),N=e.isArrayOrTypedArray(F.line.width);if(W||(P=r.isOpenSymbol(F.symbol)),W||X||Q||Z){q.colors=new Array(z),q.borderColors=new Array(z);var J=a(F,F.opacity,z),D=a(F.line,F.opacity,z);if(!Array.isArray(D[0])){var U=D;for(D=Array(z),S=0;S<z;S++)D[S]=U}if(!Array.isArray(J[0])){var G=J;for(J=Array(z),S=0;S<z;S++)J[S]=G}for(q.colors=J,q.borderColors=D,S=0;S<z;S++){if(W){var $=F.symbol[S];P=r.isOpenSymbol($)}P&&(D[S]=J[S].slice(),J[S]=J[S].slice(),J[S][3]=0)}q.opacity=C.opacity}else P?(q.color=p(F.color,"uint8"),q.color[3]=0,q.borderColor=p(F.color,"uint8")):(q.color=p(F.color,"uint8"),q.borderColor=p(F.line.color,"uint8")),q.opacity=C.opacity*F.opacity;if(W)for(q.markers=new Array(z),S=0;S<z;S++)q.markers[S]=w(F.symbol[S]);else q.marker=w(F.symbol);var K,re=s(C,1);if(Y||N){var ne,ae=q.sizes=new Array(z),ie=q.borderSizes=new Array(z),he=0;if(Y){for(S=0;S<z;S++)ae[S]=re(F.size[S]),he+=ae[S];ne=he/z}else for(K=re(F.size),S=0;S<z;S++)ae[S]=K;if(N)for(S=0;S<z;S++)ie[S]=F.line.width[S];else for(K=F.line.width,S=0;S<z;S++)ie[S]=K;q.sizeAvg=ne}else q.size=re(F&&F.size||10),q.borderSizes=re(F.line.width);return q}function v(C,S){var P=C.marker,z={};return S&&(S.marker&&S.marker.symbol?z=y(e.extendFlat({},P,S.marker)):S.marker&&(S.marker.size&&(z.size=S.marker.size),S.marker.color&&(z.colors=S.marker.color),S.marker.opacity!==void 0&&(z.opacity=S.marker.opacity))),z}function T(C,S,P){var z={};if(!P)return z;if(P.textfont){var F={opacity:1,text:S.text,texttemplate:S.texttemplate,textposition:S.textposition,textfont:e.extendFlat({},S.textfont)};P.textfont&&e.extendFlat(F.textfont,P.textfont),z=m(C,F)}return z}function _(C,S,P){var z={capSize:2*S.width*P,lineWidth:S.thickness*P,color:S.color};return S.copy_ystyle&&(z=C.error_y),z}var k=c.SYMBOL_SDF_SIZE,E=c.SYMBOL_SIZE,A=c.SYMBOL_STROKE,b={},L=l.symbolFuncs[0](.05*E);function w(C){if(C==="circle")return null;var S,P,z=l.symbolNumber(C),F=l.symbolFuncs[z%100],q=!!l.symbolNoDot[z%100],W=!!l.symbolNoFill[z%100],X=r.isDotSymbol(C);return b[C]?b[C]:(S=X&&!q?F(1.1*E)+L:F(E),P=h(S,{w:k,h:k,viewBox:[-E,-E,E,E],stroke:W?A:-A}),b[C]=P,P||null)}B.exports={style:function(C,S){var P,z={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},F=C._context.plotGlPixelRatio;if(S.visible!==!0)return z;if(n.hasText(S)&&(z.text=m(C,S),z.textSel=T(C,S,S.selected),z.textUnsel=T(C,S,S.unselected)),n.hasMarkers(S)&&(z.marker=y(S),z.markerSel=v(S,S.selected),z.markerUnsel=v(S,S.unselected),!S.unselected&&e.isArrayOrTypedArray(S.marker.opacity))){var q=S.marker.opacity;for(z.markerUnsel.opacity=new Array(q.length),P=0;P<q.length;P++)z.markerUnsel.opacity[P]=f*q[P]}if(n.hasLines(S)){z.line={overlay:!0,thickness:S.line.width*F,color:S.line.color,opacity:S.opacity};var W=(c.DASHES[S.line.dash]||[1]).slice();for(P=0;P<W.length;++P)W[P]*=S.line.width*F;z.line.dashes=W}return S.error_x&&S.error_x.visible&&(z.errorX=_(S,S.error_x,F)),S.error_y&&S.error_y.visible&&(z.errorY=_(S,S.error_y,F)),S.fill&&S.fill!=="none"&&(z.fill={closed:!0,fill:S.fillcolor,thickness:0}),z},markerStyle:y,markerSelection:v,linePositions:function(C,S,P){var z,F,q=P.length,W=q/2;if(n.hasLines(S)&&W)if(S.line.shape==="hv"){for(z=[],F=0;F<W-1;F++)isNaN(P[2*F])||isNaN(P[2*F+1])?z.push(NaN,NaN,NaN,NaN):(z.push(P[2*F],P[2*F+1]),isNaN(P[2*F+2])||isNaN(P[2*F+3])?z.push(NaN,NaN):z.push(P[2*F+2],P[2*F+1]));z.push(P[q-2],P[q-1])}else if(S.line.shape==="hvh"){for(z=[],F=0;F<W-1;F++)if(isNaN(P[2*F])||isNaN(P[2*F+1])||isNaN(P[2*F+2])||isNaN(P[2*F+3]))isNaN(P[2*F])||isNaN(P[2*F+1])?z.push(NaN,NaN):z.push(P[2*F],P[2*F+1]),z.push(NaN,NaN);else{var X=(P[2*F]+P[2*F+2])/2;z.push(P[2*F],P[2*F+1],X,P[2*F+1],X,P[2*F+3])}z.push(P[q-2],P[q-1])}else if(S.line.shape==="vhv"){for(z=[],F=0;F<W-1;F++)if(isNaN(P[2*F])||isNaN(P[2*F+1])||isNaN(P[2*F+2])||isNaN(P[2*F+3]))isNaN(P[2*F])||isNaN(P[2*F+1])?z.push(NaN,NaN):z.push(P[2*F],P[2*F+1]),z.push(NaN,NaN);else{var Q=(P[2*F+1]+P[2*F+3])/2;z.push(P[2*F],P[2*F+1],P[2*F],Q,P[2*F+2],Q)}z.push(P[q-2],P[q-1])}else if(S.line.shape==="vh"){for(z=[],F=0;F<W-1;F++)isNaN(P[2*F])||isNaN(P[2*F+1])?z.push(NaN,NaN,NaN,NaN):(z.push(P[2*F],P[2*F+1]),isNaN(P[2*F+2])||isNaN(P[2*F+3])?z.push(NaN,NaN):z.push(P[2*F],P[2*F+3]));z.push(P[q-2],P[q-1])}else z=P;var Z=!1;for(F=0;F<z.length;F++)if(isNaN(z[F])){Z=!0;break}var Y=Z||z.length>c.TOO_MANY_POINTS||n.hasMarkers(S)?"rect":"round";if(Z&&S.connectgaps){var N=z[0],J=z[1];for(F=0;F<z.length;F+=2)isNaN(z[F])||isNaN(z[F+1])?(z[F]=N,z[F+1]=J):(N=z[F],J=z[F+1])}return{join:Y,positions:z}},errorBarPositions:function(C,S,P,z,F){var q=u.getComponentMethod("errorbars","makeComputeError"),W=o.getFromId(C,S.xaxis),X=o.getFromId(C,S.yaxis),Q=P.length/2,Z={};function Y(N,J){var D=J._id.charAt(0),U=S["error_"+D];if(U&&U.visible&&(J.type==="linear"||J.type==="log")){for(var G=q(U),$={x:0,y:1}[D],K={x:[0,1,2,3],y:[2,3,0,1]}[D],re=new Float64Array(4*Q),ne=1/0,ae=-1/0,ie=0,he=0;ie<Q;ie++,he+=4){var se=N[ie];if(t(se)){var de=P[2*ie+$],ce=G(se,ie),ve=ce[0],Ee=ce[1];if(t(ve)&&t(Ee)){var Le=se-ve,Te=se+Ee;re[he+K[0]]=de-J.c2l(Le),re[he+K[1]]=J.c2l(Te)-de,re[he+K[2]]=0,re[he+K[3]]=0,ne=Math.min(ne,se-ve),ae=Math.max(ae,se+Ee)}}}Z[D]={positions:P,errors:re,_bnds:[ne,ae]}}}return Y(z,W),Y(F,X),Z},textPosition:function(C,S,P,z){var F,q=S._length,W={};if(n.hasMarkers(S)){var X=P.font,Q=P.align,Z=P.baseline;for(W.offset=new Array(q),F=0;F<q;F++){var Y=z.sizes?z.sizes[F]:z.size,N=Array.isArray(X)?X[F].size:X.size,J=Array.isArray(Q)?Q.length>1?Q[F]:Q[0]:Q,D=Array.isArray(Z)?Z.length>1?Z[F]:Z[0]:Z,U=d[J],G=d[D],$=Y?Y/.8+1:0,K=-G*$-.5*G;W.offset[F]=[U*$/N,K/N]}}return W}}},{"../../components/drawing":688,"../../components/fx/helpers":702,"../../constants/interactions":778,"../../lib":803,"../../lib/gl_format_color":799,"../../plots/cartesian/axis_ids":858,"../../registry":931,"../scatter/make_bubble_size_func":1235,"../scatter/subtypes":1243,"./constants":1272,"./helpers":1277,"color-normalize":131,"fast-isnumeric":249,"svg-path-sdf":595}],1274:[function(i,B,V){var t=i("../../lib"),h=i("../../registry"),p=i("./helpers"),u=i("./attributes"),e=i("../scatter/constants"),l=i("../scatter/subtypes"),o=i("../scatter/xy_defaults"),a=i("../scatter/period_defaults"),n=i("../scatter/marker_defaults"),s=i("../scatter/line_defaults"),r=i("../scatter/fillcolor_defaults"),c=i("../scatter/text_defaults");B.exports=function(f,d,g,m){function y(L,w){return t.coerce(f,d,u,L,w)}var v=!!f.marker&&p.isOpenSymbol(f.marker.symbol),T=l.isBubble(f),_=o(f,d,m,y);if(_){a(f,d,m,y),y("xhoverformat"),y("yhoverformat");var k=_<e.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("hovertemplate"),y("mode",k),l.hasLines(d)&&(y("connectgaps"),s(f,d,g,m,y),y("line.shape")),l.hasMarkers(d)&&(n(f,d,g,m,y),y("marker.line.width",v||T?1:0)),l.hasText(d)&&(y("texttemplate"),c(f,d,m,y));var E=(d.line||{}).color,A=(d.marker||{}).color;y("fill"),d.fill!=="none"&&r(f,d,g,y);var b=h.getComponentMethod("errorbars","supplyDefaults");b(f,d,E||A||g,{axis:"y"}),b(f,d,E||A||g,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(d,y)}else d.visible=!1}},{"../../lib":803,"../../registry":931,"../scatter/constants":1222,"../scatter/fillcolor_defaults":1226,"../scatter/line_defaults":1231,"../scatter/marker_defaults":1237,"../scatter/period_defaults":1238,"../scatter/subtypes":1243,"../scatter/text_defaults":1244,"../scatter/xy_defaults":1245,"./attributes":1270,"./helpers":1277}],1275:[function(i,B,V){var t=i("../../lib"),h=i("../../components/color"),p=i("../../constants/interactions").DESELECTDIM;B.exports={styleTextSelection:function(u){var e,l,o=u[0],a=o.trace,n=o.t,s=n._scene,r=n.index,c=s.selectBatch[r],f=s.unselectBatch[r],d=s.textOptions[r],g=s.textSelectedOptions[r]||{},m=s.textUnselectedOptions[r]||{},y=t.extendFlat({},d);if(c.length||f.length){var v=g.color,T=m.color,_=d.color,k=Array.isArray(_);for(y.color=new Array(a._length),e=0;e<c.length;e++)l=c[e],y.color[l]=v||(k?_[l]:_);for(e=0;e<f.length;e++){l=f[e];var E=k?_[l]:_;y.color[l]=T||(v?E:h.addOpacity(E,p))}}s.glText[r].update(y)}}},{"../../components/color":666,"../../constants/interactions":778,"../../lib":803}],1276:[function(i,B,V){var t=i("../scatter/format_labels");B.exports=function(h,p,u){var e=h.i;return"x"in h||(h.x=p._x[e]),"y"in h||(h.y=p._y[e]),t(h,p,u)}},{"../scatter/format_labels":1227}],1277:[function(i,B,V){var t=i("./constants");V.isOpenSymbol=function(h){return typeof h=="string"?t.OPEN_RE.test(h):h%200>100},V.isDotSymbol=function(h){return typeof h=="string"?t.DOT_RE.test(h):h>200}},{"./constants":1272}],1278:[function(i,B,V){var t=i("../../registry"),h=i("../../lib"),p=i("../scatter/get_trace_color");function u(e,l,o,a){var n=e.xa,s=e.ya,r=e.distance,c=e.dxy,f=e.index,d={pointNumber:f,x:l[f],y:o[f]};d.tx=Array.isArray(a.text)?a.text[f]:a.text,d.htx=Array.isArray(a.hovertext)?a.hovertext[f]:a.hovertext,d.data=Array.isArray(a.customdata)?a.customdata[f]:a.customdata,d.tp=Array.isArray(a.textposition)?a.textposition[f]:a.textposition;var g=a.textfont;g&&(d.ts=h.isArrayOrTypedArray(g.size)?g.size[f]:g.size,d.tc=Array.isArray(g.color)?g.color[f]:g.color,d.tf=Array.isArray(g.family)?g.family[f]:g.family);var m=a.marker;m&&(d.ms=h.isArrayOrTypedArray(m.size)?m.size[f]:m.size,d.mo=h.isArrayOrTypedArray(m.opacity)?m.opacity[f]:m.opacity,d.mx=h.isArrayOrTypedArray(m.symbol)?m.symbol[f]:m.symbol,d.mc=h.isArrayOrTypedArray(m.color)?m.color[f]:m.color);var y=m&&m.line;y&&(d.mlc=Array.isArray(y.color)?y.color[f]:y.color,d.mlw=h.isArrayOrTypedArray(y.width)?y.width[f]:y.width);var v=m&&m.gradient;v&&v.type!=="none"&&(d.mgt=Array.isArray(v.type)?v.type[f]:v.type,d.mgc=Array.isArray(v.color)?v.color[f]:v.color);var T=n.c2p(d.x,!0),_=s.c2p(d.y,!0),k=d.mrc||1,E=a.hoverlabel;E&&(d.hbg=Array.isArray(E.bgcolor)?E.bgcolor[f]:E.bgcolor,d.hbc=Array.isArray(E.bordercolor)?E.bordercolor[f]:E.bordercolor,d.hts=h.isArrayOrTypedArray(E.font.size)?E.font.size[f]:E.font.size,d.htc=Array.isArray(E.font.color)?E.font.color[f]:E.font.color,d.htf=Array.isArray(E.font.family)?E.font.family[f]:E.font.family,d.hnl=h.isArrayOrTypedArray(E.namelength)?E.namelength[f]:E.namelength);var A=a.hoverinfo;A&&(d.hi=Array.isArray(A)?A[f]:A);var b=a.hovertemplate;b&&(d.ht=Array.isArray(b)?b[f]:b);var L={};L[e.index]=d;var w=a._origX,C=a._origY,S=h.extendFlat({},e,{color:p(a,d),x0:T-k,x1:T+k,xLabelVal:w?w[f]:d.x,y0:_-k,y1:_+k,yLabelVal:C?C[f]:d.y,cd:L,distance:r,spikeDistance:c,hovertemplate:d.ht});return d.htx?S.text=d.htx:d.tx?S.text=d.tx:a.text&&(S.text=a.text),h.fillText(d,a,S),t.getComponentMethod("errorbars","hoverInfo")(d,a,S),S}B.exports={hoverPoints:function(e,l,o,a){var n,s,r,c,f,d,g,m,y,v,T=e.cd,_=T[0].t,k=T[0].trace,E=e.xa,A=e.ya,b=_.x,L=_.y,w=E.c2p(l),C=A.c2p(o),S=e.distance;if(_.tree){var P=E.p2c(w-S),z=E.p2c(w+S),F=A.p2c(C-S),q=A.p2c(C+S);n=a==="x"?_.tree.range(Math.min(P,z),Math.min(A._rl[0],A._rl[1]),Math.max(P,z),Math.max(A._rl[0],A._rl[1])):_.tree.range(Math.min(P,z),Math.min(F,q),Math.max(P,z),Math.max(F,q))}else n=_.ids;var W=S;if(a==="x"){var X=!!k.xperiodalignment,Q=!!k.yperiodalignment;for(d=0;d<n.length;d++){if(c=b[s=n[d]],g=Math.abs(E.c2p(c)-w),X){var Z=E.c2p(k._xStarts[s]),Y=E.c2p(k._xEnds[s]);g=w>=Math.min(Z,Y)&&w<=Math.max(Z,Y)?0:1/0}if(g<W){if(W=g,f=L[s],m=A.c2p(f)-C,Q){var N=A.c2p(k._yStarts[s]),J=A.c2p(k._yEnds[s]);m=C>=Math.min(N,J)&&C<=Math.max(N,J)?0:1/0}v=Math.sqrt(g*g+m*m),r=n[d]}}}else for(d=n.length-1;d>-1;d--)c=b[s=n[d]],f=L[s],g=E.c2p(c)-w,m=A.c2p(f)-C,(y=Math.sqrt(g*g+m*m))<W&&(W=v=y,r=s);return e.index=r,e.distance=W,e.dxy=v,r===void 0?[e]:[u(e,b,L,k)]},calcHover:u}},{"../../lib":803,"../../registry":931,"../scatter/get_trace_color":1228}],1279:[function(i,B,V){var t=i("./hover");B.exports={moduleType:"trace",name:"scattergl",basePlotModule:i("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:i("./attributes"),supplyDefaults:i("./defaults"),crossTraceDefaults:i("../scatter/cross_trace_defaults"),colorbar:i("../scatter/marker_colorbar"),formatLabels:i("./format_labels"),calc:i("./calc"),plot:i("./plot"),hoverPoints:t.hoverPoints,selectPoints:i("./select"),meta:{}}},{"../../plots/cartesian":868,"../scatter/cross_trace_defaults":1224,"../scatter/marker_colorbar":1236,"./attributes":1270,"./calc":1271,"./defaults":1274,"./format_labels":1276,"./hover":1278,"./plot":1280,"./select":1282}],1280:[function(i,B,V){var t=i("regl-scatter2d"),h=i("regl-line2d"),p=i("regl-error2d"),u=i("gl-text"),e=i("../../lib"),l=i("../../components/dragelement/helpers").selectMode,o=i("../../lib/prepare_regl"),a=i("../scatter/subtypes"),n=i("../scatter/link_traces"),s=i("./edit_style").styleTextSelection;function r(c,f,d,g){var m=c._size,y=c.width*g,v=c.height*g,T=m.l*g,_=m.b*g,k=m.r*g,E=m.t*g,A=m.w*g,b=m.h*g;return[T+f.domain[0]*A,_+d.domain[0]*b,y-k-(1-f.domain[1])*A,v-E-(1-d.domain[1])*b]}B.exports=function(c,f,d){if(d.length){var g,m,y=c._fullLayout,v=f._scene,T=f.xaxis,_=f.yaxis;if(v)if(o(c,["ANGLE_instanced_arrays","OES_element_index_uint"])){var k=v.count,E=y._glcanvas.data()[0].regl;if(n(c,f,d),v.dirty){if(v.error2d===!0&&(v.error2d=p(E)),v.line2d===!0&&(v.line2d=h(E)),v.scatter2d===!0&&(v.scatter2d=t(E)),v.fill2d===!0&&(v.fill2d=h(E)),v.glText===!0)for(v.glText=new Array(k),g=0;g<k;g++)v.glText[g]=new u(E);if(v.glText){if(k>v.glText.length){var A=k-v.glText.length;for(g=0;g<A;g++)v.glText.push(new u(E))}else if(k<v.glText.length){var b=v.glText.length-k;v.glText.splice(k,b).forEach(function(K){K.destroy()})}for(g=0;g<k;g++)v.glText[g].update(v.textOptions[g])}if(v.line2d&&(v.line2d.update(v.lineOptions),v.lineOptions=v.lineOptions.map(function(K){if(K&&K.positions){for(var re=K.positions,ne=0;ne<re.length&&(isNaN(re[ne])||isNaN(re[ne+1]));)ne+=2;for(var ae=re.length-2;ae>ne&&(isNaN(re[ae])||isNaN(re[ae+1]));)ae-=2;K.positions=re.slice(ne,ae+2)}return K}),v.line2d.update(v.lineOptions)),v.error2d){var L=(v.errorXOptions||[]).concat(v.errorYOptions||[]);v.error2d.update(L)}v.scatter2d&&v.scatter2d.update(v.markerOptions),v.fillOrder=e.repeat(null,k),v.fill2d&&(v.fillOptions=v.fillOptions.map(function(K,re){var ne=d[re];if(K&&ne&&ne[0]&&ne[0].trace){var ae,ie,he=ne[0],se=he.trace,de=he.t,ce=v.lineOptions[re],ve=[];se._ownfill&&ve.push(re),se._nexttrace&&ve.push(re+1),ve.length&&(v.fillOrder[re]=ve);var Ee,Le,Te=[],xe=ce&&ce.positions||de.positions;if(se.fill==="tozeroy"){for(Ee=0;Ee<xe.length&&isNaN(xe[Ee+1]);)Ee+=2;for(Le=xe.length-2;Le>Ee&&isNaN(xe[Le+1]);)Le-=2;xe[Ee+1]!==0&&(Te=[xe[Ee],0]),Te=Te.concat(xe.slice(Ee,Le+2)),xe[Le+1]!==0&&(Te=Te.concat([xe[Le],0]))}else if(se.fill==="tozerox"){for(Ee=0;Ee<xe.length&&isNaN(xe[Ee]);)Ee+=2;for(Le=xe.length-2;Le>Ee&&isNaN(xe[Le]);)Le-=2;xe[Ee]!==0&&(Te=[0,xe[Ee+1]]),Te=Te.concat(xe.slice(Ee,Le+2)),xe[Le]!==0&&(Te=Te.concat([0,xe[Le+1]]))}else if(se.fill==="toself"||se.fill==="tonext"){for(Te=[],ae=0,K.splitNull=!0,ie=0;ie<xe.length;ie+=2)(isNaN(xe[ie])||isNaN(xe[ie+1]))&&((Te=Te.concat(xe.slice(ae,ie))).push(xe[ae],xe[ae+1]),Te.push(null,null),ae=ie+2);Te=Te.concat(xe.slice(ae)),ae&&Te.push(xe[ae],xe[ae+1])}else{var fe=se._nexttrace;if(fe){var ge=v.lineOptions[re+1];if(ge){var ke=ge.positions;if(se.fill==="tonexty"){for(Te=xe.slice(),re=Math.floor(ke.length/2);re--;){var Me=ke[2*re],Se=ke[2*re+1];isNaN(Me)||isNaN(Se)||Te.push(Me,Se)}K.fill=fe.fillcolor}}}}if(se._prevtrace&&se._prevtrace.fill==="tonext"){var De=v.lineOptions[re-1].positions,Be=Te.length/2,We=[ae=Be];for(ie=0;ie<De.length;ie+=2)(isNaN(De[ie])||isNaN(De[ie+1]))&&(We.push(ie/2+Be+1),ae=ie+2);Te=Te.concat(De),K.hole=We}return K.fillmode=se.fill,K.opacity=se.opacity,K.positions=Te,K}}),v.fill2d.update(v.fillOptions))}var w=y.dragmode,C=l(w),S=y.clickmode.indexOf("select")>-1;for(g=0;g<k;g++){var P=d[g][0],z=P.trace,F=P.t,q=F.index,W=z._length,X=F.x,Q=F.y;if(z.selectedpoints||C||S){if(C||(C=!0),z.selectedpoints){var Z=v.selectBatch[q]=e.selIndices2selPoints(z),Y={};for(m=0;m<Z.length;m++)Y[Z[m]]=1;var N=[];for(m=0;m<W;m++)Y[m]||N.push(m);v.unselectBatch[q]=N}var J=F.xpx=new Array(W),D=F.ypx=new Array(W);for(m=0;m<W;m++)J[m]=T.c2p(X[m]),D[m]=_.c2p(Q[m])}else F.xpx=F.ypx=null}if(C){if(v.select2d||(v.select2d=t(y._glcanvas.data()[1].regl)),v.scatter2d){var U=new Array(k);for(g=0;g<k;g++)U[g]=v.selectBatch[g].length||v.unselectBatch[g].length?v.markerUnselectedOptions[g]:{};v.scatter2d.update(U)}v.select2d&&(v.select2d.update(v.markerOptions),v.select2d.update(v.markerSelectedOptions)),v.glText&&d.forEach(function(K){var re=((K||[])[0]||{}).trace||{};a.hasText(re)&&s(K)})}else v.scatter2d&&v.scatter2d.update(v.markerOptions);var G={viewport:r(y,T,_,c._context.plotGlPixelRatio),range:[(T._rl||T.range)[0],(_._rl||_.range)[0],(T._rl||T.range)[1],(_._rl||_.range)[1]]},$=e.repeat(G,v.count);v.fill2d&&v.fill2d.update($),v.line2d&&v.line2d.update($),v.error2d&&v.error2d.update($.concat($)),v.scatter2d&&v.scatter2d.update($),v.select2d&&v.select2d.update($),v.glText&&v.glText.forEach(function(K){K.update(G)})}else v.init()}}},{"../../components/dragelement/helpers":684,"../../lib":803,"../../lib/prepare_regl":816,"../scatter/link_traces":1234,"../scatter/subtypes":1243,"./edit_style":1275,"gl-text":355,"regl-error2d":536,"regl-line2d":537,"regl-scatter2d":538}],1281:[function(i,B,V){var t=i("../../lib");B.exports=function(h,p){var u=p._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},l={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return p._scene||((u=p._scene={}).init=function(){t.extendFlat(u,l,e)},u.init(),u.update=function(o){var a=t.repeat(o,u.count);if(u.fill2d&&u.fill2d.update(a),u.scatter2d&&u.scatter2d.update(a),u.line2d&&u.line2d.update(a),u.error2d&&u.error2d.update(a.concat(a)),u.select2d&&u.select2d.update(a),u.glText)for(var n=0;n<u.count;n++)u.glText[n].update(o)},u.draw=function(){for(var o=u.count,a=u.fill2d,n=u.error2d,s=u.line2d,r=u.scatter2d,c=u.glText,f=u.select2d,d=u.selectBatch,g=u.unselectBatch,m=0;m<o;m++){if(a&&u.fillOrder[m]&&a.draw(u.fillOrder[m]),s&&u.lineOptions[m]&&s.draw(m),n&&(u.errorXOptions[m]&&n.draw(m),u.errorYOptions[m]&&n.draw(m+o)),r&&u.markerOptions[m])if(g[m].length){var y=t.repeat([],u.count);y[m]=g[m],r.draw(y)}else d[m].length||r.draw(m);c[m]&&u.textOptions[m]&&c[m].render()}f&&f.draw(d),u.dirty=!1},u.destroy=function(){u.fill2d&&u.fill2d.destroy&&u.fill2d.destroy(),u.scatter2d&&u.scatter2d.destroy&&u.scatter2d.destroy(),u.error2d&&u.error2d.destroy&&u.error2d.destroy(),u.line2d&&u.line2d.destroy&&u.line2d.destroy(),u.select2d&&u.select2d.destroy&&u.select2d.destroy(),u.glText&&u.glText.forEach(function(o){o.destroy&&o.destroy()}),u.lineOptions=null,u.fillOptions=null,u.markerOptions=null,u.markerSelectedOptions=null,u.markerUnselectedOptions=null,u.errorXOptions=null,u.errorYOptions=null,u.textOptions=null,u.textSelectedOptions=null,u.textUnselectedOptions=null,u.selectBatch=null,u.unselectBatch=null,p._scene=null}),u.dirty||t.extendFlat(u,e),u}},{"../../lib":803}],1282:[function(i,B,V){var t=i("../scatter/subtypes"),h=i("./edit_style").styleTextSelection;B.exports=function(p,u){var e=p.cd,l=p.xaxis,o=p.yaxis,a=[],n=e[0].trace,s=e[0].t,r=n._length,c=s.x,f=s.y,d=s._scene,g=s.index;if(!d)return a;var m=t.hasText(n),y=t.hasMarkers(n),v=!y&&!m;if(n.visible!==!0||v)return a;var T=[],_=[];if(u!==!1&&!u.degenerate)for(var k=0;k<r;k++)u.contains([s.xpx[k],s.ypx[k]],!1,k,p)?(T.push(k),a.push({pointNumber:k,x:l.c2d(c[k]),y:o.c2d(f[k])})):_.push(k);if(y){var E=d.scatter2d;if(T.length||_.length){if(!d.selectBatch[g].length&&!d.unselectBatch[g].length){var A=new Array(d.count);A[g]=d.markerUnselectedOptions[g],E.update.apply(E,A)}}else{var b=new Array(d.count);b[g]=d.markerOptions[g],E.update.apply(E,b)}}return d.selectBatch[g]=T,d.unselectBatch[g]=_,m&&h(e),a}},{"../scatter/subtypes":1243,"./edit_style":1275}],1283:[function(i,B,V){var t=i("../../plots/template_attributes").hovertemplateAttrs,h=i("../../plots/template_attributes").texttemplateAttrs,p=i("../scattergeo/attributes"),u=i("../scatter/attributes"),e=i("../../plots/mapbox/layout_attributes"),l=i("../../plots/attributes"),o=i("../../components/colorscale/attributes"),a=i("../../lib/extend").extendFlat,n=i("../../plot_api/edit_types").overrideAll,s=p.line,r=p.marker;B.exports=n({lon:p.lon,lat:p.lat,mode:a({},u.mode,{dflt:"markers"}),text:a({},u.text,{}),texttemplate:h({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:a({},u.hovertext,{}),line:{color:s.color,width:s.width},connectgaps:u.connectgaps,marker:a({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:r.opacity,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode},o("marker")),fill:p.fill,fillcolor:u.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:u.selected.marker},unselected:{marker:u.unselected.marker},hoverinfo:a({},l.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:t()},"calc","nested")},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plots/attributes":850,"../../plots/mapbox/layout_attributes":913,"../../plots/template_attributes":926,"../scatter/attributes":1218,"../scattergeo/attributes":1260}],1284:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../lib"),p=i("../../constants/numerical").BADNUM,u=i("../../lib/geojson_utils"),e=i("../../components/colorscale"),l=i("../../components/drawing"),o=i("../scatter/make_bubble_size_func"),a=i("../scatter/subtypes"),n=i("../../plots/mapbox/convert_text_opts"),s=i("../../components/fx/helpers").appendArrayPointValue,r=i("../../lib/svg_text_utils").NEWLINES,c=i("../../lib/svg_text_utils").BR_TAG_ALL;function f(){return{geojson:u.makeBlank(),layout:{visibility:"none"},paint:{}}}function d(y,v){return h.isArrayOrTypedArray(y)?v?function(T){return t(y[T])?+y[T]:0}:function(T){return y[T]}:y?function(){return y}:g}function g(){return""}function m(y){return y[0]===p}B.exports=function(y,v){var T,_=v[0].trace,k=_.visible===!0&&_._length!==0,E=_.fill!=="none",A=a.hasLines(_),b=a.hasMarkers(_),L=a.hasText(_),w=b&&_.marker.symbol==="circle",C=b&&_.marker.symbol!=="circle",S=f(),P=f(),z=f(),F=f(),q={fill:S,line:P,circle:z,symbol:F};if(!k)return q;if((E||A)&&(T=u.calcTraceToLineCoords(v)),E&&(S.geojson=u.makePolygon(T),S.layout.visibility="visible",h.extendFlat(S.paint,{"fill-color":_.fillcolor})),A&&(P.geojson=u.makeLine(T),P.layout.visibility="visible",h.extendFlat(P.paint,{"line-width":_.line.width,"line-color":_.line.color,"line-opacity":_.opacity})),w){var W=function(Z){var Y,N,J,D,U=Z[0].trace,G=U.marker,$=U.selectedpoints,K=h.isArrayOrTypedArray(G.color),re=h.isArrayOrTypedArray(G.size),ne=h.isArrayOrTypedArray(G.opacity);function ae(Le){return U.opacity*Le}K&&(N=e.hasColorscale(U,"marker")?e.makeColorScaleFuncFromTrace(G):h.identity),re&&(J=o(U)),ne&&(D=function(Le){return ae(t(Le)?+h.constrain(Le,0,1):0)});var ie,he=[];for(Y=0;Y<Z.length;Y++){var se=Z[Y],de=se.lonlat;if(!m(de)){var ce={};N&&(ce.mcc=se.mcc=N(se.mc)),J&&(ce.mrc=se.mrc=J(se.ms)),D&&(ce.mo=D(se.mo)),$&&(ce.selected=se.selected||0),he.push({type:"Feature",geometry:{type:"Point",coordinates:de},properties:ce})}}if($)for(ie=l.makeSelectedPointStyleFns(U),Y=0;Y<he.length;Y++){var ve=he[Y].properties;ie.selectedOpacityFn&&(ve.mo=ae(ie.selectedOpacityFn(ve))),ie.selectedColorFn&&(ve.mcc=ie.selectedColorFn(ve)),ie.selectedSizeFn&&(ve.mrc=ie.selectedSizeFn(ve))}return{geojson:{type:"FeatureCollection",features:he},mcc:K||ie&&ie.selectedColorFn?{type:"identity",property:"mcc"}:G.color,mrc:re||ie&&ie.selectedSizeFn?{type:"identity",property:"mrc"}:(Ee=G.size,Ee/2),mo:ne||ie&&ie.selectedOpacityFn?{type:"identity",property:"mo"}:ae(G.opacity)};var Ee}(v);z.geojson=W.geojson,z.layout.visibility="visible",h.extendFlat(z.paint,{"circle-color":W.mcc,"circle-radius":W.mrc,"circle-opacity":W.mo})}if((C||L)&&(F.geojson=function(Z,Y){for(var N=Y._fullLayout,J=Z[0].trace,D=J.marker||{},U=D.symbol,G=D.angle,$=U!=="circle"?d(U):g,K=G!=="auto"?d(G,!0):g,re=a.hasText(J)?d(J.text):g,ne=[],ae=0;ae<Z.length;ae++){var ie=Z[ae];if(!m(ie.lonlat)){var he,se=J.texttemplate;if(se){var de=Array.isArray(se)?se[ae]||"":se,ce=J._module.formatLabels(ie,J,N),ve={};s(ve,J,ie.i);var Ee=J._meta||{};he=h.texttemplateString(de,ce,N._d3locale,ve,ie,Ee)}else he=re(ae);he&&(he=he.replace(r,"").replace(c,`
`)),ne.push({type:"Feature",geometry:{type:"Point",coordinates:ie.lonlat},properties:{symbol:$(ae),angle:K(ae),text:he}})}}return{type:"FeatureCollection",features:ne}}(v,y),h.extendFlat(F.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),C&&(h.extendFlat(F.layout,{"icon-size":_.marker.size/10}),"angle"in _.marker&&_.marker.angle!=="auto"&&h.extendFlat(F.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),F.layout["icon-allow-overlap"]=_.marker.allowoverlap,h.extendFlat(F.paint,{"icon-opacity":_.opacity*_.marker.opacity,"icon-color":_.marker.color})),L)){var X=(_.marker||{}).size,Q=n(_.textposition,X);h.extendFlat(F.layout,{"text-size":_.textfont.size,"text-anchor":Q.anchor,"text-offset":Q.offset}),h.extendFlat(F.paint,{"text-color":_.textfont.color,"text-opacity":_.opacity})}return q}},{"../../components/colorscale":678,"../../components/drawing":688,"../../components/fx/helpers":702,"../../constants/numerical":779,"../../lib":803,"../../lib/geojson_utils":797,"../../lib/svg_text_utils":829,"../../plots/mapbox/convert_text_opts":910,"../scatter/make_bubble_size_func":1235,"../scatter/subtypes":1243,"fast-isnumeric":249}],1285:[function(i,B,V){var t=i("../../lib"),h=i("../scatter/subtypes"),p=i("../scatter/marker_defaults"),u=i("../scatter/line_defaults"),e=i("../scatter/text_defaults"),l=i("../scatter/fillcolor_defaults"),o=i("./attributes");B.exports=function(a,n,s,r){function c(d,g){return t.coerce(a,n,o,d,g)}if(function(d,g,m){var y=m("lon")||[],v=m("lat")||[],T=Math.min(y.length,v.length);return g._length=T,T}(0,n,c)){if(c("text"),c("texttemplate"),c("hovertext"),c("hovertemplate"),c("mode"),c("below"),h.hasLines(n)&&(u(a,n,s,r,c,{noDash:!0}),c("connectgaps")),h.hasMarkers(n)){p(a,n,s,r,c,{noLine:!0}),c("marker.allowoverlap"),c("marker.angle");var f=n.marker;f.symbol!=="circle"&&(t.isArrayOrTypedArray(f.size)&&(f.size=f.size[0]),t.isArrayOrTypedArray(f.color)&&(f.color=f.color[0]))}h.hasText(n)&&e(a,n,r,c,{noSelect:!0}),c("fill"),n.fill!=="none"&&l(a,n,s,c),t.coerceSelectionMarkerOpacity(n,c)}else n.visible=!1}},{"../../lib":803,"../scatter/fillcolor_defaults":1226,"../scatter/line_defaults":1231,"../scatter/marker_defaults":1237,"../scatter/subtypes":1243,"../scatter/text_defaults":1244,"./attributes":1283}],1286:[function(i,B,V){B.exports=function(t,h){return t.lon=h.lon,t.lat=h.lat,t}},{}],1287:[function(i,B,V){var t=i("../../plots/cartesian/axes");B.exports=function(h,p,u){var e={},l=u[p.subplot]._subplot.mockAxis,o=h.lonlat;return e.lonLabel=t.tickText(l,l.c2l(o[0]),!0).text,e.latLabel=t.tickText(l,l.c2l(o[1]),!0).text,e}},{"../../plots/cartesian/axes":854}],1288:[function(i,B,V){var t=i("../../components/fx"),h=i("../../lib"),p=i("../scatter/get_trace_color"),u=h.fillText,e=i("../../constants/numerical").BADNUM;function l(o,a,n){if(!o.hovertemplate){var s=(a.hi||o.hoverinfo).split("+"),r=s.indexOf("all")!==-1,c=s.indexOf("lon")!==-1,f=s.indexOf("lat")!==-1,d=a.lonlat,g=[];return r||c&&f?g.push("("+m(d[1])+", "+m(d[0])+")"):c?g.push(n.lon+m(d[0])):f&&g.push(n.lat+m(d[1])),(r||s.indexOf("text")!==-1)&&u(a,o,g),g.join("<br>")}function m(y){return y+"°"}}B.exports={hoverPoints:function(o,a,n){var s=o.cd,r=s[0].trace,c=o.xa,f=o.ya,d=o.subplot,g=360*(a>=0?Math.floor((a+180)/360):Math.ceil((a-180)/360)),m=a-g;if(t.getClosest(s,function(L){var w=L.lonlat;if(w[0]===e)return 1/0;var C=h.modHalf(w[0],360),S=w[1],P=d.project([C,S]),z=P.x-c.c2p([m,S]),F=P.y-f.c2p([C,n]),q=Math.max(3,L.mrc||0);return Math.max(Math.sqrt(z*z+F*F)-q,1-3/q)},o),o.index!==!1){var y=s[o.index],v=y.lonlat,T=[h.modHalf(v[0],360)+g,v[1]],_=c.c2p(T),k=f.c2p(T),E=y.mrc||1;o.x0=_-E,o.x1=_+E,o.y0=k-E,o.y1=k+E;var A={};A[r.subplot]={_subplot:d};var b=r._module.formatLabels(y,r,A);return o.lonLabel=b.lonLabel,o.latLabel=b.latLabel,o.color=p(r,y),o.extraText=l(r,y,s[0].t.labels),o.hovertemplate=r.hovertemplate,[o]}},getExtraText:l}},{"../../components/fx":706,"../../constants/numerical":779,"../../lib":803,"../scatter/get_trace_color":1228}],1289:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../scatter/marker_colorbar"),formatLabels:i("./format_labels"),calc:i("../scattergeo/calc"),plot:i("./plot"),hoverPoints:i("./hover").hoverPoints,eventData:i("./event_data"),selectPoints:i("./select"),styleOnSelect:function(t,h){h&&h[0].trace._glTrace.update(h)},moduleType:"trace",name:"scattermapbox",basePlotModule:i("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":911,"../scatter/marker_colorbar":1236,"../scattergeo/calc":1261,"./attributes":1283,"./defaults":1285,"./event_data":1286,"./format_labels":1287,"./hover":1288,"./plot":1290,"./select":1291}],1290:[function(i,B,V){var t=i("./convert"),h=i("../../plots/mapbox/constants").traceLayerPrefix,p=["fill","line","circle","symbol"];function u(l,o){this.type="scattermapbox",this.subplot=l,this.uid=o,this.sourceIds={fill:"source-"+o+"-fill",line:"source-"+o+"-line",circle:"source-"+o+"-circle",symbol:"source-"+o+"-symbol"},this.layerIds={fill:h+o+"-fill",line:h+o+"-line",circle:h+o+"-circle",symbol:h+o+"-symbol"},this.below=null}var e=u.prototype;e.addSource=function(l,o){this.subplot.map.addSource(this.sourceIds[l],{type:"geojson",data:o.geojson})},e.setSourceData=function(l,o){this.subplot.map.getSource(this.sourceIds[l]).setData(o.geojson)},e.addLayer=function(l,o,a){this.subplot.addLayer({type:l,id:this.layerIds[l],source:this.sourceIds[l],layout:o.layout,paint:o.paint},a)},e.update=function(l){var o,a,n,s=this.subplot,r=s.map,c=t(s.gd,l),f=s.belowLookup["trace-"+this.uid];if(f!==this.below){for(o=p.length-1;o>=0;o--)a=p[o],r.removeLayer(this.layerIds[a]);for(o=0;o<p.length;o++)n=c[a=p[o]],this.addLayer(a,n,f);this.below=f}for(o=0;o<p.length;o++)n=c[a=p[o]],s.setOptions(this.layerIds[a],"setLayoutProperty",n.layout),n.layout.visibility==="visible"&&(this.setSourceData(a,n),s.setOptions(this.layerIds[a],"setPaintProperty",n.paint));l[0].trace._glTrace=this},e.dispose=function(){for(var l=this.subplot.map,o=p.length-1;o>=0;o--){var a=p[o];l.removeLayer(this.layerIds[a]),l.removeSource(this.sourceIds[a])}},B.exports=function(l,o){for(var a=o[0].trace,n=new u(l,a.uid),s=t(l.gd,o),r=n.below=l.belowLookup["trace-"+a.uid],c=0;c<p.length;c++){var f=p[c],d=s[f];n.addSource(f,d),n.addLayer(f,d,r)}return o[0].trace._glTrace=n,n}},{"../../plots/mapbox/constants":909,"./convert":1284}],1291:[function(i,B,V){var t=i("../../lib"),h=i("../scatter/subtypes"),p=i("../../constants/numerical").BADNUM;B.exports=function(u,e){var l,o=u.cd,a=u.xaxis,n=u.yaxis,s=[],r=o[0].trace;if(!h.hasMarkers(r))return[];if(e===!1)for(l=0;l<o.length;l++)o[l].selected=0;else for(l=0;l<o.length;l++){var c=o[l],f=c.lonlat;if(f[0]!==p){var d=[t.modHalf(f[0],360),f[1]],g=[a.c2p(d),n.c2p(d)];e.contains(g,null,l,u)?(s.push({pointNumber:l,lon:f[0],lat:f[1]}),c.selected=1):c.selected=0}}return s}},{"../../constants/numerical":779,"../../lib":803,"../scatter/subtypes":1243}],1292:[function(i,B,V){var t=i("../../plots/template_attributes").hovertemplateAttrs,h=i("../../plots/template_attributes").texttemplateAttrs,p=i("../../lib/extend").extendFlat,u=i("../scatter/attributes"),e=i("../../plots/attributes"),l=u.line;B.exports={mode:u.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:u.text,texttemplate:h({editType:"plot"},{keys:["r","theta","text"]}),hovertext:u.hovertext,line:{color:l.color,width:l.width,dash:l.dash,shape:p({},l.shape,{values:["linear","spline"]}),smoothing:l.smoothing,editType:"calc"},connectgaps:u.connectgaps,marker:u.marker,cliponaxis:p({},u.cliponaxis,{dflt:!1}),textposition:u.textposition,textfont:u.textfont,fill:p({},u.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:u.fillcolor,hoverinfo:p({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:u.hoveron,hovertemplate:t(),selected:u.selected,unselected:u.unselected}},{"../../lib/extend":793,"../../plots/attributes":850,"../../plots/template_attributes":926,"../scatter/attributes":1218}],1293:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../../constants/numerical").BADNUM,p=i("../../plots/cartesian/axes"),u=i("../scatter/colorscale_calc"),e=i("../scatter/arrays_to_calcdata"),l=i("../scatter/calc_selection"),o=i("../scatter/calc").calcMarkerSize;B.exports=function(a,n){for(var s=a._fullLayout,r=n.subplot,c=s[r].radialaxis,f=s[r].angularaxis,d=c.makeCalcdata(n,"r"),g=f.makeCalcdata(n,"theta"),m=n._length,y=new Array(m),v=0;v<m;v++){var T=d[v],_=g[v],k=y[v]={};t(T)&&t(_)?(k.r=T,k.theta=_):k.r=h}var E=o(n,m);return n._extremes.x=p.findExtremes(c,d,{ppad:E}),u(a,n),e(y,n),l(y,n),y}},{"../../constants/numerical":779,"../../plots/cartesian/axes":854,"../scatter/arrays_to_calcdata":1217,"../scatter/calc":1219,"../scatter/calc_selection":1220,"../scatter/colorscale_calc":1221,"fast-isnumeric":249}],1294:[function(i,B,V){var t=i("../../lib"),h=i("../scatter/subtypes"),p=i("../scatter/marker_defaults"),u=i("../scatter/line_defaults"),e=i("../scatter/line_shape_defaults"),l=i("../scatter/text_defaults"),o=i("../scatter/fillcolor_defaults"),a=i("../scatter/constants").PTS_LINESONLY,n=i("./attributes");function s(r,c,f,d){var g,m=d("r"),y=d("theta");if(m)y?g=Math.min(m.length,y.length):(g=m.length,d("theta0"),d("dtheta"));else{if(!y)return 0;g=c.theta.length,d("r0"),d("dr")}return c._length=g,g}B.exports={handleRThetaDefaults:s,supplyDefaults:function(r,c,f,d){function g(v,T){return t.coerce(r,c,n,v,T)}var m=s(r,c,d,g);if(m){g("thetaunit"),g("mode",m<a?"lines+markers":"lines"),g("text"),g("hovertext"),c.hoveron!=="fills"&&g("hovertemplate"),h.hasLines(c)&&(u(r,c,f,d,g),e(r,c,g),g("connectgaps")),h.hasMarkers(c)&&p(r,c,f,d,g,{gradient:!0}),h.hasText(c)&&(g("texttemplate"),l(r,c,d,g));var y=[];(h.hasMarkers(c)||h.hasText(c))&&(g("cliponaxis"),g("marker.maxdisplayed"),y.push("points")),g("fill"),c.fill!=="none"&&(o(r,c,f,g),h.hasLines(c)||e(r,c,g)),c.fill!=="tonext"&&c.fill!=="toself"||y.push("fills"),g("hoveron",y.join("+")||"points"),t.coerceSelectionMarkerOpacity(c,g)}else c.visible=!1}}},{"../../lib":803,"../scatter/constants":1222,"../scatter/fillcolor_defaults":1226,"../scatter/line_defaults":1231,"../scatter/line_shape_defaults":1233,"../scatter/marker_defaults":1237,"../scatter/subtypes":1243,"../scatter/text_defaults":1244,"./attributes":1292}],1295:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes");B.exports=function(p,u,e){var l,o,a={},n=e[u.subplot]._subplot;n?(l=n.radialAxis,o=n.angularAxis):(l=(n=e[u.subplot]).radialaxis,o=n.angularaxis);var s=l.c2l(p.r);a.rLabel=h.tickText(l,s,!0).text;var r=o.thetaunit==="degrees"?t.rad2deg(p.theta):p.theta;return a.thetaLabel=h.tickText(o,r,!0).text,a}},{"../../lib":803,"../../plots/cartesian/axes":854}],1296:[function(i,B,V){var t=i("../scatter/hover");function h(p,u,e,l){var o=e.radialAxis,a=e.angularAxis;o._hovertitle="r",a._hovertitle="θ";var n={};n[u.subplot]={_subplot:e};var s=u._module.formatLabels(p,u,n);l.rLabel=s.rLabel,l.thetaLabel=s.thetaLabel;var r=p.hi||u.hoverinfo,c=[];function f(g,m){c.push(g._hovertitle+": "+m)}if(!u.hovertemplate){var d=r.split("+");d.indexOf("all")!==-1&&(d=["r","theta","text"]),d.indexOf("r")!==-1&&f(o,l.rLabel),d.indexOf("theta")!==-1&&f(a,l.thetaLabel),d.indexOf("text")!==-1&&l.text&&(c.push(l.text),delete l.text),l.extraText=c.join("<br>")}}B.exports={hoverPoints:function(p,u,e,l){var o=t(p,u,e,l);if(o&&o[0].index!==!1){var a=o[0];if(a.index===void 0)return o;var n=p.subplot,s=a.cd[a.index],r=a.trace;if(n.isPtInside(s))return a.xLabelVal=void 0,a.yLabelVal=void 0,h(s,r,n,a),a.hovertemplate=r.hovertemplate,o}},makeHoverPointText:h}},{"../scatter/hover":1229}],1297:[function(i,B,V){B.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:i("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:i("./attributes"),supplyDefaults:i("./defaults").supplyDefaults,colorbar:i("../scatter/marker_colorbar"),formatLabels:i("./format_labels"),calc:i("./calc"),plot:i("./plot"),style:i("../scatter/style").style,styleOnSelect:i("../scatter/style").styleOnSelect,hoverPoints:i("./hover").hoverPoints,selectPoints:i("../scatter/select"),meta:{}}},{"../../plots/polar":920,"../scatter/marker_colorbar":1236,"../scatter/select":1240,"../scatter/style":1242,"./attributes":1292,"./calc":1293,"./defaults":1294,"./format_labels":1295,"./hover":1296,"./plot":1298}],1298:[function(i,B,V){var t=i("../scatter/plot"),h=i("../../constants/numerical").BADNUM;B.exports=function(p,u,e){for(var l=u.layers.frontplot.select("g.scatterlayer"),o={xaxis:u.xaxis,yaxis:u.yaxis,plot:u.framework,layerClipId:u._hasClipOnAxisFalse?u.clipIds.forTraces:null},a=u.radialAxis,n=u.angularAxis,s=0;s<e.length;s++)for(var r=e[s],c=0;c<r.length;c++){var f=r[c],d=f.r;if(d===h)f.x=f.y=h;else{var g=a.c2g(d),m=n.c2g(f.theta);f.x=g*Math.cos(m),f.y=g*Math.sin(m)}}t(p,o,e,l)}},{"../../constants/numerical":779,"../scatter/plot":1239}],1299:[function(i,B,V){var t=i("../scatterpolar/attributes"),h=i("../scattergl/attributes"),p=i("../../plots/template_attributes").texttemplateAttrs;B.exports={mode:t.mode,r:t.r,theta:t.theta,r0:t.r0,dr:t.dr,theta0:t.theta0,dtheta:t.dtheta,thetaunit:t.thetaunit,text:t.text,texttemplate:p({editType:"plot"},{keys:["r","theta","text"]}),hovertext:t.hovertext,hovertemplate:t.hovertemplate,line:h.line,connectgaps:h.connectgaps,marker:h.marker,fill:h.fill,fillcolor:h.fillcolor,textposition:h.textposition,textfont:h.textfont,hoverinfo:t.hoverinfo,selected:t.selected,unselected:t.unselected}},{"../../plots/template_attributes":926,"../scattergl/attributes":1270,"../scatterpolar/attributes":1292}],1300:[function(i,B,V){var t=i("../scatter/colorscale_calc"),h=i("../scatter/calc").calcMarkerSize,p=i("../scattergl/convert"),u=i("../../plots/cartesian/axes"),e=i("../scattergl/constants").TOO_MANY_POINTS;B.exports=function(l,o){var a=l._fullLayout,n=o.subplot,s=a[n].radialaxis,r=a[n].angularaxis,c=o._r=s.makeCalcdata(o,"r"),f=o._theta=r.makeCalcdata(o,"theta"),d=o._length,g={};d<c.length&&(c=c.slice(0,d)),d<f.length&&(f=f.slice(0,d)),g.r=c,g.theta=f,t(l,o);var m,y=g.opts=p.style(l,o);return d<e?m=h(o,d):y.marker&&(m=2*(y.marker.sizeAvg||Math.max(y.marker.size,3))),o._extremes.x=u.findExtremes(s,c,{ppad:m}),[{x:!1,y:!1,t:g,trace:o}]}},{"../../plots/cartesian/axes":854,"../scatter/calc":1219,"../scatter/colorscale_calc":1221,"../scattergl/constants":1272,"../scattergl/convert":1273}],1301:[function(i,B,V){var t=i("../../lib"),h=i("../scatter/subtypes"),p=i("../scatterpolar/defaults").handleRThetaDefaults,u=i("../scatter/marker_defaults"),e=i("../scatter/line_defaults"),l=i("../scatter/text_defaults"),o=i("../scatter/fillcolor_defaults"),a=i("../scatter/constants").PTS_LINESONLY,n=i("./attributes");B.exports=function(s,r,c,f){function d(m,y){return t.coerce(s,r,n,m,y)}var g=p(s,r,f,d);g?(d("thetaunit"),d("mode",g<a?"lines+markers":"lines"),d("text"),d("hovertext"),r.hoveron!=="fills"&&d("hovertemplate"),h.hasLines(r)&&(e(s,r,c,f,d),d("connectgaps")),h.hasMarkers(r)&&u(s,r,c,f,d),h.hasText(r)&&(d("texttemplate"),l(s,r,f,d)),d("fill"),r.fill!=="none"&&o(s,r,c,d),t.coerceSelectionMarkerOpacity(r,d)):r.visible=!1}},{"../../lib":803,"../scatter/constants":1222,"../scatter/fillcolor_defaults":1226,"../scatter/line_defaults":1231,"../scatter/marker_defaults":1237,"../scatter/subtypes":1243,"../scatter/text_defaults":1244,"../scatterpolar/defaults":1294,"./attributes":1299}],1302:[function(i,B,V){var t=i("../scatterpolar/format_labels");B.exports=function(h,p,u){var e=h.i;return"r"in h||(h.r=p._r[e]),"theta"in h||(h.theta=p._theta[e]),t(h,p,u)}},{"../scatterpolar/format_labels":1295}],1303:[function(i,B,V){var t=i("../scattergl/hover"),h=i("../scatterpolar/hover").makeHoverPointText;B.exports={hoverPoints:function(p,u,e,l){var o=p.cd[0].t,a=o.r,n=o.theta,s=t.hoverPoints(p,u,e,l);if(s&&s[0].index!==!1){var r=s[0];if(r.index===void 0)return s;var c=p.subplot,f=r.cd[r.index],d=r.trace;if(f.r=a[r.index],f.theta=n[r.index],c.isPtInside(f))return r.xLabelVal=void 0,r.yLabelVal=void 0,h(f,d,c,r),s}}}},{"../scattergl/hover":1278,"../scatterpolar/hover":1296}],1304:[function(i,B,V){B.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:i("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../scatter/marker_colorbar"),formatLabels:i("./format_labels"),calc:i("./calc"),plot:i("./plot"),hoverPoints:i("./hover").hoverPoints,selectPoints:i("../scattergl/select"),meta:{}}},{"../../plots/polar":920,"../scatter/marker_colorbar":1236,"../scattergl/select":1282,"./attributes":1299,"./calc":1300,"./defaults":1301,"./format_labels":1302,"./hover":1303,"./plot":1305}],1305:[function(i,B,V){var t=i("@plotly/point-cluster"),h=i("fast-isnumeric"),p=i("../scattergl/plot"),u=i("../scattergl/scene_update"),e=i("../scattergl/convert"),l=i("../../lib"),o=i("../scattergl/constants").TOO_MANY_POINTS;B.exports=function(a,n,s){if(s.length){var r=n.radialAxis,c=n.angularAxis,f=u(a,n);return s.forEach(function(d){if(d&&d[0]&&d[0].trace){var g,m=d[0],y=m.trace,v=m.t,T=y._length,_=v.r,k=v.theta,E=v.opts,A=_.slice(),b=k.slice();for(g=0;g<_.length;g++)n.isPtInside({r:_[g],theta:k[g]})||(A[g]=NaN,b[g]=NaN);var L=new Array(2*T),w=Array(T),C=Array(T);for(g=0;g<T;g++){var S,P,z=A[g];if(h(z)){var F=r.c2g(z),q=c.c2g(b[g],y.thetaunit);S=F*Math.cos(q),P=F*Math.sin(q)}else S=P=NaN;w[g]=L[2*g]=S,C[g]=L[2*g+1]=P}v.tree=t(L),E.marker&&T>=o&&(E.marker.cluster=v.tree),E.marker&&(E.markerSel.positions=E.markerUnsel.positions=E.marker.positions=L),E.line&&L.length>1&&l.extendFlat(E.line,e.linePositions(a,y,L)),E.text&&(l.extendFlat(E.text,{positions:L},e.textPosition(a,y,E.text,E.marker)),l.extendFlat(E.textSel,{positions:L},e.textPosition(a,y,E.text,E.markerSel)),l.extendFlat(E.textUnsel,{positions:L},e.textPosition(a,y,E.text,E.markerUnsel))),E.fill&&!f.fill2d&&(f.fill2d=!0),E.marker&&!f.scatter2d&&(f.scatter2d=!0),E.line&&!f.line2d&&(f.line2d=!0),E.text&&!f.glText&&(f.glText=!0),f.lineOptions.push(E.line),f.fillOptions.push(E.fill),f.markerOptions.push(E.marker),f.markerSelectedOptions.push(E.markerSel),f.markerUnselectedOptions.push(E.markerUnsel),f.textOptions.push(E.text),f.textSelectedOptions.push(E.textSel),f.textUnselectedOptions.push(E.textUnsel),f.selectBatch.push([]),f.unselectBatch.push([]),v.x=w,v.y=C,v.rawx=w,v.rawy=C,v.r=_,v.theta=k,v.positions=L,v._scene=f,v.index=f.count,f.count++}}),p(a,n,s)}}},{"../../lib":803,"../scattergl/constants":1272,"../scattergl/convert":1273,"../scattergl/plot":1280,"../scattergl/scene_update":1281,"@plotly/point-cluster":59,"fast-isnumeric":249}],1306:[function(i,B,V){var t=i("../../plots/template_attributes").hovertemplateAttrs,h=i("../../plots/template_attributes").texttemplateAttrs,p=i("../scatter/attributes"),u=i("../../plots/attributes"),e=i("../../components/colorscale/attributes"),l=i("../../components/drawing/attributes").dash,o=i("../../lib/extend").extendFlat,a=p.marker,n=p.line,s=a.line;B.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:o({},p.mode,{dflt:"markers"}),text:o({},p.text,{}),texttemplate:h({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:o({},p.hovertext,{}),line:{color:n.color,width:n.width,dash:l,shape:o({},n.shape,{values:["linear","spline"]}),smoothing:n.smoothing,editType:"calc"},connectgaps:p.connectgaps,cliponaxis:p.cliponaxis,fill:o({},p.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:p.fillcolor,marker:o({symbol:a.symbol,opacity:a.opacity,maxdisplayed:a.maxdisplayed,size:a.size,sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode,line:o({width:s.width,editType:"calc"},e("marker.line")),gradient:a.gradient,editType:"calc"},e("marker")),textfont:p.textfont,textposition:p.textposition,selected:p.selected,unselected:p.unselected,hoverinfo:o({},u.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:p.hoveron,hovertemplate:t()}},{"../../components/colorscale/attributes":673,"../../components/drawing/attributes":687,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/template_attributes":926,"../scatter/attributes":1218}],1307:[function(i,B,V){var t=i("fast-isnumeric"),h=i("../scatter/colorscale_calc"),p=i("../scatter/arrays_to_calcdata"),u=i("../scatter/calc_selection"),e=i("../scatter/calc").calcMarkerSize,l=["a","b","c"],o={a:["b","c"],b:["a","c"],c:["a","b"]};B.exports=function(a,n){var s,r,c,f,d,g,m=a._fullLayout[n.subplot].sum,y=n.sum||m,v={a:n.a,b:n.b,c:n.c};for(s=0;s<l.length;s++)if(!v[c=l[s]]){for(d=v[o[c][0]],g=v[o[c][1]],f=new Array(d.length),r=0;r<d.length;r++)f[r]=y-d[r]-g[r];v[c]=f}var T,_,k,E,A,b,L=n._length,w=new Array(L);for(s=0;s<L;s++)T=v.a[s],_=v.b[s],k=v.c[s],t(T)&&t(_)&&t(k)?((E=m/((T=+T)+(_=+_)+(k=+k)))!==1&&(T*=E,_*=E,k*=E),b=T,A=k-_,w[s]={x:A,y:b,a:T,b:_,c:k}):w[s]={x:!1,y:!1};return e(n,L),h(a,n),p(w,n),u(w,n),w}},{"../scatter/arrays_to_calcdata":1217,"../scatter/calc":1219,"../scatter/calc_selection":1220,"../scatter/colorscale_calc":1221,"fast-isnumeric":249}],1308:[function(i,B,V){var t=i("../../lib"),h=i("../scatter/constants"),p=i("../scatter/subtypes"),u=i("../scatter/marker_defaults"),e=i("../scatter/line_defaults"),l=i("../scatter/line_shape_defaults"),o=i("../scatter/text_defaults"),a=i("../scatter/fillcolor_defaults"),n=i("./attributes");B.exports=function(s,r,c,f){function d(_,k){return t.coerce(s,r,n,_,k)}var g,m=d("a"),y=d("b"),v=d("c");if(m?(g=m.length,y?(g=Math.min(g,y.length),v&&(g=Math.min(g,v.length))):g=v?Math.min(g,v.length):0):y&&v&&(g=Math.min(y.length,v.length)),g){r._length=g,d("sum"),d("text"),d("hovertext"),r.hoveron!=="fills"&&d("hovertemplate"),d("mode",g<h.PTS_LINESONLY?"lines+markers":"lines"),p.hasLines(r)&&(e(s,r,c,f,d),l(s,r,d),d("connectgaps")),p.hasMarkers(r)&&u(s,r,c,f,d,{gradient:!0}),p.hasText(r)&&(d("texttemplate"),o(s,r,f,d));var T=[];(p.hasMarkers(r)||p.hasText(r))&&(d("cliponaxis"),d("marker.maxdisplayed"),T.push("points")),d("fill"),r.fill!=="none"&&(a(s,r,c,d),p.hasLines(r)||l(s,r,d)),r.fill!=="tonext"&&r.fill!=="toself"||T.push("fills"),d("hoveron",T.join("+")||"points"),t.coerceSelectionMarkerOpacity(r,d)}else r.visible=!1}},{"../../lib":803,"../scatter/constants":1222,"../scatter/fillcolor_defaults":1226,"../scatter/line_defaults":1231,"../scatter/line_shape_defaults":1233,"../scatter/marker_defaults":1237,"../scatter/subtypes":1243,"../scatter/text_defaults":1244,"./attributes":1306}],1309:[function(i,B,V){B.exports=function(t,h,p,u,e){if(h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),u[e]){var l=u[e];t.a=l.a,t.b=l.b,t.c=l.c}else t.a=h.a,t.b=h.b,t.c=h.c;return t}},{}],1310:[function(i,B,V){var t=i("../../plots/cartesian/axes");B.exports=function(h,p,u){var e={},l=u[p.subplot]._subplot;return e.aLabel=t.tickText(l.aaxis,h.a,!0).text,e.bLabel=t.tickText(l.baxis,h.b,!0).text,e.cLabel=t.tickText(l.caxis,h.c,!0).text,e}},{"../../plots/cartesian/axes":854}],1311:[function(i,B,V){var t=i("../scatter/hover");B.exports=function(h,p,u,e){var l=t(h,p,u,e);if(l&&l[0].index!==!1){var o=l[0];if(o.index===void 0){var a=1-o.y0/h.ya._length,n=h.xa._length,s=n*a/2,r=n-s;return o.x0=Math.max(Math.min(o.x0,r),s),o.x1=Math.max(Math.min(o.x1,r),s),l}var c=o.cd[o.index],f=o.trace,d=o.subplot;o.a=c.a,o.b=c.b,o.c=c.c,o.xLabelVal=void 0,o.yLabelVal=void 0;var g={};g[f.subplot]={_subplot:d};var m=f._module.formatLabels(c,f,g);o.aLabel=m.aLabel,o.bLabel=m.bLabel,o.cLabel=m.cLabel;var y=c.hi||f.hoverinfo,v=[];if(!f.hovertemplate){var T=y.split("+");T.indexOf("all")!==-1&&(T=["a","b","c"]),T.indexOf("a")!==-1&&_(d.aaxis,o.aLabel),T.indexOf("b")!==-1&&_(d.baxis,o.bLabel),T.indexOf("c")!==-1&&_(d.caxis,o.cLabel)}return o.extraText=v.join("<br>"),o.hovertemplate=f.hovertemplate,l}function _(k,E){v.push(k._hovertitle+": "+E)}}},{"../scatter/hover":1229}],1312:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../scatter/marker_colorbar"),formatLabels:i("./format_labels"),calc:i("./calc"),plot:i("./plot"),style:i("../scatter/style").style,styleOnSelect:i("../scatter/style").styleOnSelect,hoverPoints:i("./hover"),selectPoints:i("../scatter/select"),eventData:i("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:i("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":927,"../scatter/marker_colorbar":1236,"../scatter/select":1240,"../scatter/style":1242,"./attributes":1306,"./calc":1307,"./defaults":1308,"./event_data":1309,"./format_labels":1310,"./hover":1311,"./plot":1313}],1313:[function(i,B,V){var t=i("../scatter/plot");B.exports=function(h,p,u){var e=p.plotContainer;e.select(".scatterlayer").selectAll("*").remove();var l={xaxis:p.xaxis,yaxis:p.yaxis,plot:e,layerClipId:p._hasClipOnAxisFalse?p.clipIdRelative:null},o=p.layers.frontplot.select("g.scatterlayer");t(h,l,u,o)}},{"../scatter/plot":1239}],1314:[function(i,B,V){var t=i("../scatter/attributes"),h=i("../../components/colorscale/attributes"),p=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,u=i("../../plots/template_attributes").hovertemplateAttrs,e=i("../scattergl/attributes"),l=i("../../plots/cartesian/constants").idRegex,o=i("../../plot_api/plot_template").templatedArray,a=i("../../lib/extend").extendFlat,n=t.marker,s=n.line,r=a(h("marker.line",{editTypeOverride:"calc"}),{width:a({},s.width,{editType:"calc"}),editType:"calc"}),c=a(h("marker"),{symbol:n.symbol,size:a({},n.size,{editType:"markerSize"}),sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,opacity:n.opacity,colorbar:n.colorbar,line:r,editType:"calc"});function f(d){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:l[d],editType:"plot"}}}c.color.editType=c.cmin.editType=c.cmax.editType="style",B.exports={dimensions:o("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:a({},e.text,{}),hovertext:a({},e.hovertext,{}),hovertemplate:u(),xhoverformat:p("x"),yhoverformat:p("y"),marker:c,xaxes:f("x"),yaxes:f("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plot_api/plot_template":843,"../../plots/cartesian/axis_format_attributes":857,"../../plots/cartesian/constants":861,"../../plots/template_attributes":926,"../scatter/attributes":1218,"../scattergl/attributes":1270}],1315:[function(i,B,V){var t=i("regl-line2d"),h=i("../../registry"),p=i("../../lib/prepare_regl"),u=i("../../plots/get_data").getModuleCalcData,e=i("../../plots/cartesian"),l=i("../../plots/cartesian/axis_ids").getFromId,o=i("../../plots/cartesian/axes").shouldShowZeroLine;function a(s,r,c){for(var f=c.matrixOptions.data.length,d=r._visibleDims,g=c.viewOpts.ranges=new Array(f),m=0;m<d.length;m++){var y=d[m],v=g[m]=new Array(4),T=l(s,r._diag[y][0]);T&&(v[0]=T.r2l(T.range[0]),v[2]=T.r2l(T.range[1]));var _=l(s,r._diag[y][1]);_&&(v[1]=_.r2l(_.range[0]),v[3]=_.r2l(_.range[1]))}c.selectBatch.length||c.unselectBatch.length?c.matrix.update({ranges:g},{ranges:g}):c.matrix.update({ranges:g})}function n(s){var r=s._fullLayout,c=r._glcanvas.data()[0].regl,f=r._splomGrid;f||(f=r._splomGrid=t(c)),f.update(function(d){var g,m=d._context.plotGlPixelRatio,y=d._fullLayout,v=y._size,T=[0,0,y.width*m,y.height*m],_={};function k(Z,Y,N,J,D,U){N*=m,J*=m,D*=m,U*=m;var G=Y[Z+"color"],$=Y[Z+"width"],K=String(G+$);K in _?_[K].data.push(NaN,NaN,N,J,D,U):_[K]={data:[N,J,D,U],join:"rect",thickness:$*m,color:G,viewport:T,range:T,overlay:!1}}for(g in y._splomSubplots){var E,A,b=y._plots[g],L=b.xaxis,w=b.yaxis,C=L._gridVals,S=w._gridVals,P=L._offset,z=L._length,F=w._length,q=v.b+w.domain[0]*v.h,W=-w._m,X=-W*w.r2l(w.range[0],w.calendar);if(L.showgrid)for(g=0;g<C.length;g++)E=P+L.l2p(C[g].x),k("grid",L,E,q,E,q+F);if(w.showgrid)for(g=0;g<S.length;g++)A=q+X+W*S[g].x,k("grid",w,P,A,P+z,A);o(d,L,w)&&(E=P+L.l2p(0),k("zeroline",L,E,q,E,q+F)),o(d,w,L)&&k("zeroline",w,P,A=q+X+0,P+z,A)}var Q=[];for(g in _)Q.push(_[g]);return Q}(s))}B.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(s){var r=s._fullLayout,c=h.getModule("splom"),f=u(s.calcdata,c)[0];p(s,["ANGLE_instanced_arrays","OES_element_index_uint"])&&(r._hasOnlyLargeSploms&&n(s),c.plot(s,{},f))},drag:function(s){var r=s.calcdata,c=s._fullLayout;c._hasOnlyLargeSploms&&n(s);for(var f=0;f<r.length;f++){var d=r[f][0].trace,g=c._splomScenes[d.uid];d.type==="splom"&&g&&g.matrix&&a(s,d,g)}},updateGrid:n,clean:function(s,r,c,f){var d,g={};if(f._splomScenes){for(d=0;d<s.length;d++){var m=s[d];m.type==="splom"&&(g[m.uid]=1)}for(d=0;d<c.length;d++){var y=c[d];if(!g[y.uid]){var v=f._splomScenes[y.uid];v&&v.destroy&&v.destroy(),f._splomScenes[y.uid]=null,delete f._splomScenes[y.uid]}}}Object.keys(f._splomScenes||{}).length===0&&delete f._splomScenes,f._splomGrid&&!r._hasOnlyLargeSploms&&f._hasOnlyLargeSploms&&(f._splomGrid.destroy(),f._splomGrid=null,delete f._splomGrid),e.clean(s,r,c,f)},updateFx:e.updateFx,toSVG:e.toSVG}},{"../../lib/prepare_regl":816,"../../plots/cartesian":868,"../../plots/cartesian/axes":854,"../../plots/cartesian/axis_ids":858,"../../plots/get_data":891,"../../registry":931,"regl-line2d":537}],1316:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axis_ids"),p=i("../scatter/calc").calcMarkerSize,u=i("../scatter/calc").calcAxisExpansion,e=i("../scatter/colorscale_calc"),l=i("../scattergl/convert").markerSelection,o=i("../scattergl/convert").markerStyle,a=i("./scene_update"),n=i("../../constants/numerical").BADNUM,s=i("../scattergl/constants").TOO_MANY_POINTS;B.exports=function(r,c){var f,d,g,m,y,v,T=c.dimensions,_=c._length,k={},E=k.cdata=[],A=k.data=[],b=c._visibleDims=[];function L(C,S){for(var P=C.makeCalcdata({v:S.values,vcalendar:c.calendar},"v"),z=0;z<P.length;z++)P[z]=P[z]===n?NaN:P[z];E.push(P),A.push(C.type==="log"?t.simpleMap(P,C.c2l):P)}for(f=0;f<T.length;f++)if((g=T[f]).visible){if(m=h.getFromId(r,c._diag[f][0]),y=h.getFromId(r,c._diag[f][1]),m&&y&&m.type!==y.type){t.log("Skipping splom dimension "+f+" with conflicting axis types");continue}m?(L(m,g),y&&y.type==="category"&&(y._categories=m._categories.slice())):L(y,g),b.push(f)}for(e(r,c),t.extendFlat(k,o(c)),v=E.length*_>s?k.sizeAvg||Math.max(k.size,3):p(c,_),d=0;d<b.length;d++)g=T[f=b[d]],m=h.getFromId(r,c._diag[f][0])||{},y=h.getFromId(r,c._diag[f][1])||{},u(r,c,m,y,E[d],E[d],v);var w=a(r,c);return w.matrix||(w.matrix=!0),w.matrixOptions=k,w.selectedOptions=l(c,c.selected),w.unselectedOptions=l(c,c.unselected),[{x:!1,y:!1,t:{},trace:c}]}},{"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/axis_ids":858,"../scatter/calc":1219,"../scatter/colorscale_calc":1221,"../scattergl/constants":1272,"../scattergl/convert":1273,"./scene_update":1323}],1317:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/array_container_defaults"),p=i("./attributes"),u=i("../scatter/subtypes"),e=i("../scatter/marker_defaults"),l=i("../parcoords/merge_length"),o=i("../scattergl/helpers").isOpenSymbol;function a(n,s){function r(f,d){return t.coerce(n,s,p.dimensions,f,d)}r("label");var c=r("values");c&&c.length?r("visible"):s.visible=!1,r("axis.type"),r("axis.matches")}B.exports=function(n,s,r,c){function f(_,k){return t.coerce(n,s,p,_,k)}var d=h(n,s,{name:"dimensions",handleItemDefaults:a}),g=f("diagonal.visible"),m=f("showupperhalf"),y=f("showlowerhalf");if(l(s,d,"values")&&(g||m||y)){f("text"),f("hovertext"),f("hovertemplate"),f("xhoverformat"),f("yhoverformat"),e(n,s,r,c,f);var v=o(s.marker.symbol),T=u.isBubble(s);f("marker.line.width",v||T?1:0),function(_,k,E,A){var b,L,w=k.dimensions,C=w.length,S=k.showupperhalf,P=k.showlowerhalf,z=k.diagonal.visible,F=new Array(C),q=new Array(C);for(b=0;b<C;b++){var W=b?b+1:"";F[b]="x"+W,q[b]="y"+W}var X=A("xaxes",F),Q=A("yaxes",q),Z=k._diag=new Array(C);k._xaxes={},k._yaxes={};var Y=[],N=[];function J(ie,he,se,de){if(ie){var ce=ie.charAt(0),ve=E._splomAxes[ce];if(k["_"+ce+"axes"][ie]=1,de.push(ie),!(ie in ve)){var Ee=ve[ie]={};se&&(Ee.label=se.label||"",se.visible&&se.axis&&(se.axis.type&&(Ee.type=se.axis.type),se.axis.matches&&(Ee.matches=he)))}}}var D=!z&&!P,U=!z&&!S;for(k._axesDim={},b=0;b<C;b++){var G=w[b],$=b===0,K=b===C-1,re=$&&D||K&&U?void 0:X[b],ne=$&&U||K&&D?void 0:Q[b];J(re,ne,G,Y),J(ne,re,G,N),Z[b]=[re,ne],k._axesDim[re]=b,k._axesDim[ne]=b}for(b=0;b<Y.length;b++)for(L=0;L<N.length;L++){var ae=Y[b]+N[L];b>L&&S||b<L&&P?E._splomSubplots[ae]=1:b!==L||!z&&P&&S||(E._splomSubplots[ae]=1)}(!P||!z&&S&&P)&&(E._splomGridDflt.xside="bottom",E._splomGridDflt.yside="left")}(0,s,c,f),t.coerceSelectionMarkerOpacity(s,f)}else s.visible=!1}},{"../../lib":803,"../../plots/array_container_defaults":849,"../parcoords/merge_length":1189,"../scatter/marker_defaults":1237,"../scatter/subtypes":1243,"../scattergl/helpers":1277,"./attributes":1314}],1318:[function(i,B,V){var t=i("../../lib"),h=i("../scatter/colorscale_calc"),p=i("../scattergl/convert").markerStyle;B.exports=function(u,e){var l=e.trace,o=u._fullLayout._splomScenes[l.uid];if(o){h(u,l),t.extendFlat(o.matrixOptions,p(l));var a=t.extendFlat({},o.matrixOptions,o.viewOpts);o.matrix.update(a,null)}}},{"../../lib":803,"../scatter/colorscale_calc":1221,"../scattergl/convert":1273}],1319:[function(i,B,V){V.getDimIndex=function(t,h){for(var p=h._id,u={x:0,y:1}[p.charAt(0)],e=t._visibleDims,l=0;l<e.length;l++){var o=e[l];if(t._diag[o][u]===p)return l}return!1}},{}],1320:[function(i,B,V){var t=i("./helpers"),h=i("../scattergl/hover").calcHover;B.exports={hoverPoints:function(p,u,e){var l=p.cd[0].trace,o=p.scene.matrixOptions.cdata,a=p.xa,n=p.ya,s=a.c2p(u),r=n.c2p(e),c=p.distance,f=t.getDimIndex(l,a),d=t.getDimIndex(l,n);if(f===!1||d===!1)return[p];for(var g,m,y=o[f],v=o[d],T=c,_=0;_<y.length;_++){var k=y[_],E=v[_],A=a.c2p(k)-s,b=n.c2p(E)-r,L=Math.sqrt(A*A+b*b);L<T&&(T=m=L,g=_)}return p.index=g,p.distance=T,p.dxy=m,g===void 0?[p]:[h(p,y,v,l)]}}},{"../scattergl/hover":1278,"./helpers":1319}],1321:[function(i,B,V){var t=i("../../registry"),h=i("../../components/grid");B.exports={moduleType:"trace",name:"splom",basePlotModule:i("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:i("../scatter/marker_colorbar"),calc:i("./calc"),plot:i("./plot"),hoverPoints:i("./hover").hoverPoints,selectPoints:i("./select"),editStyle:i("./edit_style"),meta:{}},t.register(h)},{"../../components/grid":710,"../../registry":931,"../scatter/marker_colorbar":1236,"./attributes":1314,"./base_plot":1315,"./calc":1316,"./defaults":1317,"./edit_style":1318,"./hover":1320,"./plot":1322,"./select":1324}],1322:[function(i,B,V){var t=i("regl-splom"),h=i("../../lib"),p=i("../../plots/cartesian/axis_ids"),u=i("../../components/dragelement/helpers").selectMode;function e(l,o){var a,n,s,r,c,f=l._fullLayout,d=f._size,g=o.trace,m=o.t,y=f._splomScenes[g.uid],v=y.matrixOptions,T=v.cdata,_=f._glcanvas.data()[0].regl,k=f.dragmode;if(T.length!==0){v.lower=g.showupperhalf,v.upper=g.showlowerhalf,v.diagonal=g.diagonal.visible;var E=g._visibleDims,A=T.length,b=y.viewOpts={};for(b.ranges=new Array(A),b.domains=new Array(A),c=0;c<E.length;c++){s=E[c];var L=b.ranges[c]=new Array(4),w=b.domains[c]=new Array(4);(a=p.getFromId(l,g._diag[s][0]))&&(L[0]=a._rl[0],L[2]=a._rl[1],w[0]=a.domain[0],w[2]=a.domain[1]),(n=p.getFromId(l,g._diag[s][1]))&&(L[1]=n._rl[0],L[3]=n._rl[1],w[1]=n.domain[0],w[3]=n.domain[1])}var C=l._context.plotGlPixelRatio,S=d.l*C,P=d.b*C,z=d.w*C,F=d.h*C;b.viewport=[S,P,z+S,F+P],y.matrix===!0&&(y.matrix=t(_));var q=f.clickmode.indexOf("select")>-1,W=!0;if(u(k)||g.selectedpoints||q){var X=g._length;if(g.selectedpoints){y.selectBatch=g.selectedpoints;var Q=g.selectedpoints,Z={};for(s=0;s<Q.length;s++)Z[Q[s]]=!0;var Y=[];for(s=0;s<X;s++)Z[s]||Y.push(s);y.unselectBatch=Y}var N=m.xpx=new Array(A),J=m.ypx=new Array(A);for(c=0;c<E.length;c++){if(s=E[c],a=p.getFromId(l,g._diag[s][0]))for(N[c]=new Array(X),r=0;r<X;r++)N[c][r]=a.c2p(T[c][r]);if(n=p.getFromId(l,g._diag[s][1]))for(J[c]=new Array(X),r=0;r<X;r++)J[c][r]=n.c2p(T[c][r])}if(y.selectBatch.length||y.unselectBatch.length){var D=h.extendFlat({},v,y.unselectedOptions,b),U=h.extendFlat({},v,y.selectedOptions,b);y.matrix.update(D,U),W=!1}}else m.xpx=m.ypx=null;if(W){var G=h.extendFlat({},v,b);y.matrix.update(G,null)}}}B.exports=function(l,o,a){if(a.length)for(var n=0;n<a.length;n++)e(l,a[n][0])}},{"../../components/dragelement/helpers":684,"../../lib":803,"../../plots/cartesian/axis_ids":858,"regl-splom":539}],1323:[function(i,B,V){var t=i("../../lib");B.exports=function(h,p){var u=h._fullLayout,e=p.uid,l=u._splomScenes;l||(l=u._splomScenes={});var o={dirty:!0,selectBatch:[],unselectBatch:[]},a=l[p.uid];return a||((a=l[e]=t.extendFlat({},o,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){a.matrix&&a.matrix.draw&&(a.selectBatch.length||a.unselectBatch.length?a.matrix.draw(a.unselectBatch,a.selectBatch):a.matrix.draw()),a.dirty=!1},a.destroy=function(){a.matrix&&a.matrix.destroy&&a.matrix.destroy(),a.matrixOptions=null,a.selectBatch=null,a.unselectBatch=null,a=null}),a.dirty||t.extendFlat(a,o),a}},{"../../lib":803}],1324:[function(i,B,V){var t=i("../../lib"),h=i("../scatter/subtypes"),p=i("./helpers");B.exports=function(u,e){var l=u.cd,o=l[0].trace,a=l[0].t,n=u.scene,s=n.matrixOptions.cdata,r=u.xaxis,c=u.yaxis,f=[];if(!n)return f;var d=!h.hasMarkers(o)&&!h.hasText(o);if(o.visible!==!0||d)return f;var g=p.getDimIndex(o,r),m=p.getDimIndex(o,c);if(g===!1||m===!1)return f;var y=a.xpx[g],v=a.ypx[m],T=s[g],_=s[m],k=[],E=[];if(e!==!1&&!e.degenerate)for(var A=0;A<T.length;A++)e.contains([y[A],v[A]],null,A,u)?(k.push(A),f.push({pointNumber:A,x:T[A],y:_[A]})):E.push(A);var b=n.matrixOptions;return k.length||E.length?n.selectBatch.length||n.unselectBatch.length||n.matrix.update(n.unselectedOptions,t.extendFlat({},b,n.selectedOptions,n.viewOpts)):n.matrix.update(b,null),n.selectBatch=k,n.unselectBatch=E,f}},{"../../lib":803,"../scatter/subtypes":1243,"./helpers":1319}],1325:[function(i,B,V){var t=i("../../components/colorscale/attributes"),h=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=i("../../plots/template_attributes").hovertemplateAttrs,u=i("../mesh3d/attributes"),e=i("../../plots/attributes"),l=i("../../lib/extend").extendFlat,o={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:p({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:h("u",1),vhoverformat:h("v",1),whoverformat:h("w",1),xhoverformat:h("x"),yhoverformat:h("y"),zhoverformat:h("z"),showlegend:l({},e.showlegend,{dflt:!1})};l(o,t("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){o[a]=u[a]}),o.hoverinfo=l({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),o.transforms=void 0,B.exports=o},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../mesh3d/attributes":1159}],1326:[function(i,B,V){var t=i("../../lib"),h=i("../../components/colorscale/calc");function p(l){var o,a,n,s,r,c,f,d,g,m,y,v,T=l._x,_=l._y,k=l._z,E=l._len,A=-1/0,b=1/0,L=-1/0,w=1/0,C=-1/0,S=1/0,P="";for(E&&(f=T[0],g=_[0],y=k[0]),E>1&&(d=T[E-1],m=_[E-1],v=k[E-1]),o=0;o<E;o++)A=Math.max(A,T[o]),b=Math.min(b,T[o]),L=Math.max(L,_[o]),w=Math.min(w,_[o]),C=Math.max(C,k[o]),S=Math.min(S,k[o]),s||T[o]===f||(s=!0,P+="x"),r||_[o]===g||(r=!0,P+="y"),c||k[o]===y||(c=!0,P+="z");s||(P+="x"),r||(P+="y"),c||(P+="z");var z=u(l._x),F=u(l._y),q=u(l._z);P=(P=(P=P.replace("x",(f>d?"-":"+")+"x")).replace("y",(g>m?"-":"+")+"y")).replace("z",(y>v?"-":"+")+"z");var W=function(){E=0,z=[],F=[],q=[]};(!E||E<z.length*F.length*q.length)&&W();var X=function(ce){return ce==="x"?T:ce==="y"?_:k},Q=function(ce){return ce==="x"?z:ce==="y"?F:q},Z=function(ce){return ce[E-1]<ce[0]?-1:1},Y=X(P[1]),N=X(P[3]),J=X(P[5]),D=Q(P[1]).length,U=Q(P[3]).length,G=Q(P[5]).length,$=!1,K=function(ce,ve,Ee){return D*(U*ce+ve)+Ee},re=Z(X(P[1])),ne=Z(X(P[3])),ae=Z(X(P[5]));for(o=0;o<G-1;o++){for(a=0;a<U-1;a++){for(n=0;n<D-1;n++){var ie=K(o,a,n),he=K(o,a,n+1),se=K(o,a+1,n),de=K(o+1,a,n);if(Y[ie]*re<Y[he]*re&&N[ie]*ne<N[se]*ne&&J[ie]*ae<J[de]*ae||($=!0),$)break}if($)break}if($)break}return $&&(t.warn("Encountered arbitrary coordinates! Unable to input data grid."),W()),{xMin:b,yMin:w,zMin:S,xMax:A,yMax:L,zMax:C,Xs:z,Ys:F,Zs:q,len:E,fill:P}}function u(l){return t.distinctVals(l).vals}function e(l,o){if(o===void 0&&(o=l.length),t.isTypedArray(l))return l.subarray(0,o);for(var a=[],n=0;n<o;n++)a[n]=+l[n];return a}B.exports={calc:function(l,o){o._len=Math.min(o.u.length,o.v.length,o.w.length,o.x.length,o.y.length,o.z.length),o._u=e(o.u,o._len),o._v=e(o.v,o._len),o._w=e(o.w,o._len),o._x=e(o.x,o._len),o._y=e(o.y,o._len),o._z=e(o.z,o._len);var a=p(o);o._gridFill=a.fill,o._Xs=a.Xs,o._Ys=a.Ys,o._Zs=a.Zs,o._len=a.len;var n,s,r,c=0;o.starts&&(n=e(o.starts.x||[]),s=e(o.starts.y||[]),r=e(o.starts.z||[]),c=Math.min(n.length,s.length,r.length)),o._startsX=n||[],o._startsY=s||[],o._startsZ=r||[];var f,d=0,g=1/0;for(f=0;f<o._len;f++){var m=o._u[f],y=o._v[f],v=o._w[f],T=Math.sqrt(m*m+y*y+v*v);d=Math.max(d,T),g=Math.min(g,T)}for(h(l,o,{vals:[g,d],containerStr:"",cLetter:"c"}),f=0;f<c;f++){var _=n[f];a.xMax=Math.max(a.xMax,_),a.xMin=Math.min(a.xMin,_);var k=s[f];a.yMax=Math.max(a.yMax,k),a.yMin=Math.min(a.yMin,k);var E=r[f];a.zMax=Math.max(a.zMax,E),a.zMin=Math.min(a.zMin,E)}o._slen=c,o._normMax=d,o._xbnds=[a.xMin,a.xMax],o._ybnds=[a.yMin,a.yMax],o._zbnds=[a.zMin,a.zMax]},filter:e,processGrid:p}},{"../../components/colorscale/calc":674,"../../lib":803}],1327:[function(i,B,V){var t=i("gl-streamtube3d"),h=t.createTubeMesh,p=i("../../lib"),u=i("../../lib/gl_format_color").parseColorScale,e=i("../../components/colorscale").extractOpts,l=i("../../plots/gl3d/zip3"),o={xaxis:0,yaxis:1,zaxis:2};function a(f,d){this.scene=f,this.uid=d,this.mesh=null,this.data=null}var n=a.prototype;function s(f){var d=f.length;return d>2?f.slice(1,d-1):d===2?[(f[0]+f[1])/2]:f}function r(f){var d=f.length;return d===1?[.5,.5]:[f[1]-f[0],f[d-1]-f[d-2]]}function c(f,d){var g=f.fullSceneLayout,m=f.dataScale,y=d._len,v={};function T(D,U){var G=g[U],$=m[o[U]];return p.simpleMap(D,function(K){return G.d2l(K)*$})}if(v.vectors=l(T(d._u,"xaxis"),T(d._v,"yaxis"),T(d._w,"zaxis"),y),!y)return{positions:[],cells:[]};var _=T(d._Xs,"xaxis"),k=T(d._Ys,"yaxis"),E=T(d._Zs,"zaxis");if(v.meshgrid=[_,k,E],v.gridFill=d._gridFill,d._slen)v.startingPositions=l(T(d._startsX,"xaxis"),T(d._startsY,"yaxis"),T(d._startsZ,"zaxis"));else{for(var A=k[0],b=s(_),L=s(E),w=new Array(b.length*L.length),C=0,S=0;S<b.length;S++)for(var P=0;P<L.length;P++)w[C++]=[b[S],A,L[P]];v.startingPositions=w}v.colormap=u(d),v.tubeSize=d.sizeref,v.maxLength=d.maxdisplayed;var z=T(d._xbnds,"xaxis"),F=T(d._ybnds,"yaxis"),q=T(d._zbnds,"zaxis"),W=r(_),X=r(k),Q=r(E),Z=[[z[0]-W[0],F[0]-X[0],q[0]-Q[0]],[z[1]+W[1],F[1]+X[1],q[1]+Q[1]]],Y=t(v,Z),N=e(d);Y.vertexIntensityBounds=[N.min/d._normMax,N.max/d._normMax];var J=d.lightposition;return Y.lightPosition=[J.x,J.y,J.z],Y.ambient=d.lighting.ambient,Y.diffuse=d.lighting.diffuse,Y.specular=d.lighting.specular,Y.roughness=d.lighting.roughness,Y.fresnel=d.lighting.fresnel,Y.opacity=d.opacity,d._pad=Y.tubeScale*d.sizeref*2,Y}n.handlePick=function(f){var d=this.scene.fullSceneLayout,g=this.scene.dataScale;function m(T,_){var k=d[_],E=g[o[_]];return k.l2c(T)/E}if(f.object===this.mesh){var y=f.data.position,v=f.data.velocity;return f.traceCoordinate=[m(y[0],"xaxis"),m(y[1],"yaxis"),m(y[2],"zaxis"),m(v[0],"xaxis"),m(v[1],"yaxis"),m(v[2],"zaxis"),f.data.intensity*this.data._normMax,f.data.divergence],f.textLabel=this.data.hovertext||this.data.text,!0}},n.update=function(f){this.data=f;var d=c(this.scene,f);this.mesh.update(d)},n.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},B.exports=function(f,d){var g=f.glplot.gl,m=c(f,d),y=h(g,m),v=new a(f,d.uid);return v.mesh=y,v.data=d,y._trace=v,f.glplot.add(y),v}},{"../../components/colorscale":678,"../../lib":803,"../../lib/gl_format_color":799,"../../plots/gl3d/zip3":907,"gl-streamtube3d":352}],1328:[function(i,B,V){var t=i("../../lib"),h=i("../../components/colorscale/defaults"),p=i("./attributes");B.exports=function(u,e,l,o){function a(g,m){return t.coerce(u,e,p,g,m)}var n=a("u"),s=a("v"),r=a("w"),c=a("x"),f=a("y"),d=a("z");n&&n.length&&s&&s.length&&r&&r.length&&c&&c.length&&f&&f.length&&d&&d.length?(a("starts.x"),a("starts.y"),a("starts.z"),a("maxdisplayed"),a("sizeref"),a("lighting.ambient"),a("lighting.diffuse"),a("lighting.specular"),a("lighting.roughness"),a("lighting.fresnel"),a("lightposition.x"),a("lightposition.y"),a("lightposition.z"),h(u,e,o,a,{prefix:"",cLetter:"c"}),a("text"),a("hovertext"),a("hovertemplate"),a("uhoverformat"),a("vhoverformat"),a("whoverformat"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":676,"../../lib":803,"./attributes":1325}],1329:[function(i,B,V){B.exports={moduleType:"trace",name:"streamtube",basePlotModule:i("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:i("./attributes"),supplyDefaults:i("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:i("./calc").calc,plot:i("./convert"),eventData:function(t,h){return t.tubex=t.x,t.tubey=t.y,t.tubez=t.z,t.tubeu=h.traceCoordinate[3],t.tubev=h.traceCoordinate[4],t.tubew=h.traceCoordinate[5],t.norm=h.traceCoordinate[6],t.divergence=h.traceCoordinate[7],delete t.x,delete t.y,delete t.z,t},meta:{}}},{"../../plots/gl3d":896,"./attributes":1325,"./calc":1326,"./convert":1327,"./defaults":1328}],1330:[function(i,B,V){var t=i("../../plots/attributes"),h=i("../../plots/template_attributes").hovertemplateAttrs,p=i("../../plots/template_attributes").texttemplateAttrs,u=i("../../components/colorscale/attributes"),e=i("../../plots/domain").attributes,l=i("../pie/attributes"),o=i("./constants"),a=i("../../lib/extend").extendFlat;B.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:a({colors:{valType:"data_array",editType:"calc"},line:{color:a({},l.marker.line.color,{dflt:null}),width:a({},l.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},u("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:l.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:p({editType:"plot"},{keys:o.eventDataKeys.concat(["label","value"])}),hovertext:l.hovertext,hoverinfo:a({},t.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:h({},{keys:o.eventDataKeys}),textfont:l.textfont,insidetextorientation:l.insidetextorientation,insidetextfont:l.insidetextfont,outsidetextfont:a({},l.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:l.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/domain":882,"../../plots/template_attributes":926,"../pie/attributes":1192,"./constants":1333}],1331:[function(i,B,V){var t=i("../../plots/plots");V.name="sunburst",V.plot=function(h,p,u,e){t.plotBasePlot(V.name,h,p,u,e)},V.clean=function(h,p,u,e){t.cleanBasePlot(V.name,h,p,u,e)}},{"../../plots/plots":917}],1332:[function(i,B,V){var t=i("d3-hierarchy"),h=i("fast-isnumeric"),p=i("../../lib"),u=i("../../components/colorscale").makeColorScaleFuncFromTrace,e=i("../pie/calc").makePullColorFn,l=i("../pie/calc").generateExtendedColors,o=i("../../components/colorscale").calc,a=i("../../constants/numerical").ALMOST_EQUAL,n={},s={},r={};V.calc=function(c,f){var d,g,m,y,v,T,_=c._fullLayout,k=f.ids,E=p.isArrayOrTypedArray(k),A=f.labels,b=f.parents,L=f.values,w=p.isArrayOrTypedArray(L),C=[],S={},P={},z=function(ne){return ne||typeof ne=="number"},F=function(ne){return!w||h(L[ne])&&L[ne]>=0};E?(d=Math.min(k.length,b.length),g=function(ne){return z(k[ne])&&F(ne)},m=function(ne){return String(k[ne])}):(d=Math.min(A.length,b.length),g=function(ne){return z(A[ne])&&F(ne)},m=function(ne){return String(A[ne])}),w&&(d=Math.min(d,L.length));for(var q=0;q<d;q++)if(g(q)){var W=m(q),X=z(b[q])?String(b[q]):"",Q={i:q,id:W,pid:X,label:z(A[q])?String(A[q]):""};w&&(Q.v=+L[q]),C.push(Q),v=W,S[y=X]?S[y].push(v):S[y]=[v],P[v]=1}if(S[""]){if(S[""].length>1){for(var Z=p.randstr(),Y=0;Y<C.length;Y++)C[Y].pid===""&&(C[Y].pid=Z);C.unshift({hasMultipleRoots:!0,id:Z,pid:"",label:""})}}else{var N,J=[];for(N in S)P[N]||J.push(N);if(J.length!==1)return p.warn(["Multiple implied roots, cannot build",f.type,"hierarchy of",f.name+".","These roots include:",J.join(", ")].join(" "));N=J[0],C.unshift({hasImpliedRoot:!0,id:N,pid:"",label:N})}try{T=t.stratify().id(function(ne){return ne.id}).parentId(function(ne){return ne.pid})(C)}catch(ne){return p.warn(["Failed to build",f.type,"hierarchy of",f.name+".","Error:",ne.message].join(" "))}var D=t.hierarchy(T),U=!1;if(w)switch(f.branchvalues){case"remainder":D.sum(function(ne){return ne.data.v});break;case"total":D.each(function(ne){var ae=ne.data.data,ie=ae.v;if(ne.children){var he=ne.children.reduce(function(se,de){return se+de.data.data.v},0);if((ae.hasImpliedRoot||ae.hasMultipleRoots)&&(ie=he),ie<he*a)return U=!0,p.warn(["Total value for node",ne.data.data.id,"of",f.name,"is smaller than the sum of its children.",`
parent value =`,ie,`
children sum =`,he].join(" "))}ne.value=ie})}else(function ne(ae,ie,he){var se=0,de=ae.children;if(de){for(var ce=de.length,ve=0;ve<ce;ve++)se+=ne(de[ve],ie,he);he.branches&&se++}else he.leaves&&se++;return ae.value=ae.data.data.value=se,ie._values||(ie._values=[]),ie._values[ae.data.data.i]=se,se})(D,f,{branches:f.count.indexOf("branches")!==-1,leaves:f.count.indexOf("leaves")!==-1});if(!U){var G,$;f.sort&&D.sort(function(ne,ae){return ae.value-ne.value});var K=f.marker.colors||[],re=!!K.length;return f._hasColorscale?(re||(K=w?f.values:f._values),o(c,f,{vals:K,containerStr:"marker",cLetter:"c"}),$=u(f.marker)):G=e(_["_"+f.type+"colormap"]),D.each(function(ne){var ae=ne.data.data;ae.color=f._hasColorscale?$(K[ae.i]):G(K[ae.i],ae.id)}),C[0].hierarchy=D,C}},V._runCrossTraceCalc=function(c,f){var d=f._fullLayout,g=f.calcdata,m=d[c+"colorway"],y=d["_"+c+"colormap"];d["extend"+c+"colors"]&&(m=l(m,c==="icicle"?r:c==="treemap"?s:n));var v,T=0;function _(A){var b=A.data.data,L=b.id;b.color===!1&&(y[L]?b.color=y[L]:A.parent?A.parent.parent?b.color=A.parent.data.data.color:(y[L]=b.color=m[T%m.length],T++):b.color=v)}for(var k=0;k<g.length;k++){var E=g[k][0];E.trace.type===c&&E.hierarchy&&(v=E.trace.root.color,E.hierarchy.each(_))}},V.crossTraceCalc=function(c){return V._runCrossTraceCalc("sunburst",c)}},{"../../components/colorscale":678,"../../constants/numerical":779,"../../lib":803,"../pie/calc":1194,"d3-hierarchy":170,"fast-isnumeric":249}],1333:[function(i,B,V){B.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1334:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("../../plots/domain").defaults,u=i("../bar/defaults").handleText,e=i("../../components/colorscale"),l=e.hasColorscale,o=e.handleDefaults;B.exports=function(a,n,s,r){function c(v,T){return t.coerce(a,n,h,v,T)}var f=c("labels"),d=c("parents");if(f&&f.length&&d&&d.length){var g=c("values");g&&g.length?c("branchvalues"):c("count"),c("level"),c("maxdepth"),c("marker.line.width")&&c("marker.line.color",r.paper_bgcolor),c("marker.colors");var m=n._hasColorscale=l(a,"marker","colors")||(a.marker||{}).coloraxis;m&&o(a,n,r,c,{prefix:"marker.",cLetter:"c"}),c("leaf.opacity",m?1:.7);var y=c("text");c("texttemplate"),n.texttemplate||c("textinfo",Array.isArray(y)?"text+label":"label"),c("hovertext"),c("hovertemplate"),u(a,n,r,c,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),c("insidetextorientation"),c("sort"),c("rotation"),c("root.color"),p(n,r,c),n._length=null}else n.visible=!1}},{"../../components/colorscale":678,"../../lib":803,"../../plots/domain":882,"../bar/defaults":945,"./attributes":1330}],1335:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../registry"),p=i("../../components/fx/helpers").appendArrayPointValue,u=i("../../components/fx"),e=i("../../lib"),l=i("../../lib/events"),o=i("./helpers"),a=i("../pie/helpers").formatPieValue;function n(s,r,c){for(var f=s.data.data,d={curveNumber:r.index,pointNumber:f.i,data:r._input,fullData:r},g=0;g<c.length;g++){var m=c[g];m in s&&(d[m]=s[m])}return"parentString"in s&&!o.isHierarchyRoot(s)&&(d.parent=s.parentString),p(d,r,f.i),d}B.exports=function(s,r,c,f,d){var g=f[0],m=g.trace,y=g.hierarchy,v=m.type==="sunburst",T=m.type==="treemap"||m.type==="icicle";"_hasHoverLabel"in m||(m._hasHoverLabel=!1),"_hasHoverEvent"in m||(m._hasHoverEvent=!1),s.on("mouseover",function(_){var k=c._fullLayout;if(!c._dragging&&k.hovermode!==!1){var E=c._fullData[m.index],A=_.data.data,b=A.i,L=o.isHierarchyRoot(_),w=o.getParent(y,_),C=o.getValue(_),S=function($){return e.castOption(E,b,$)},P=S("hovertemplate"),z=u.castHoverinfo(E,k,b),F=k.separators;if(P||z&&z!=="none"&&z!=="skip"){var q,W;v&&(q=g.cx+_.pxmid[0]*(1-_.rInscribed),W=g.cy+_.pxmid[1]*(1-_.rInscribed)),T&&(q=_._hoverX,W=_._hoverY);var X,Q={},Z=[],Y=[],N=function($){return Z.indexOf($)!==-1};z&&(Z=z==="all"?E._module.attributes.hoverinfo.flags:z.split("+")),Q.label=A.label,N("label")&&Q.label&&Y.push(Q.label),A.hasOwnProperty("v")&&(Q.value=A.v,Q.valueLabel=a(Q.value,F),N("value")&&Y.push(Q.valueLabel)),Q.currentPath=_.currentPath=o.getPath(_.data),N("current path")&&!L&&Y.push(Q.currentPath);var J=[],D=function(){J.indexOf(X)===-1&&(Y.push(X),J.push(X))};Q.percentParent=_.percentParent=C/o.getValue(w),Q.parent=_.parentString=o.getPtLabel(w),N("percent parent")&&(X=o.formatPercent(Q.percentParent,F)+" of "+Q.parent,D()),Q.percentEntry=_.percentEntry=C/o.getValue(r),Q.entry=_.entry=o.getPtLabel(r),!N("percent entry")||L||_.onPathbar||(X=o.formatPercent(Q.percentEntry,F)+" of "+Q.entry,D()),Q.percentRoot=_.percentRoot=C/o.getValue(y),Q.root=_.root=o.getPtLabel(y),N("percent root")&&!L&&(X=o.formatPercent(Q.percentRoot,F)+" of "+Q.root,D()),Q.text=S("hovertext")||S("text"),N("text")&&(X=Q.text,e.isValidTextValue(X)&&Y.push(X));var U={trace:E,y:W,text:Y.join("<br>"),name:P||N("name")?E.name:void 0,color:S("hoverlabel.bgcolor")||A.color,borderColor:S("hoverlabel.bordercolor"),fontFamily:S("hoverlabel.font.family"),fontSize:S("hoverlabel.font.size"),fontColor:S("hoverlabel.font.color"),nameLength:S("hoverlabel.namelength"),textAlign:S("hoverlabel.align"),hovertemplate:P,hovertemplateLabels:Q,eventData:[n(_,E,d.eventDataKeys)]};v&&(U.x0=q-_.rInscribed*_.rpx1,U.x1=q+_.rInscribed*_.rpx1,U.idealAlign=_.pxmid[0]<0?"left":"right"),T&&(U.x=q,U.idealAlign=q<0?"left":"right"),u.loneHover(U,{container:k._hoverlayer.node(),outerContainer:k._paper.node(),gd:c}),m._hasHoverLabel=!0}if(T){var G=s.select("path.surface");d.styleOne(G,_,E,{hovered:!0})}m._hasHoverEvent=!0,c.emit("plotly_hover",{points:[n(_,E,d.eventDataKeys)],event:t.event})}}),s.on("mouseout",function(_){var k=c._fullLayout,E=c._fullData[m.index],A=t.select(this).datum();if(m._hasHoverEvent&&(_.originalEvent=t.event,c.emit("plotly_unhover",{points:[n(A,E,d.eventDataKeys)],event:t.event}),m._hasHoverEvent=!1),m._hasHoverLabel&&(u.loneUnhover(k._hoverlayer.node()),m._hasHoverLabel=!1),T){var b=s.select("path.surface");d.styleOne(b,A,E,{hovered:!1})}}),s.on("click",function(_){var k=c._fullLayout,E=c._fullData[m.index],A=v&&(o.isHierarchyRoot(_)||o.isLeaf(_)),b=o.getPtId(_),L=o.isEntry(_)?o.findEntryWithChild(y,b):o.findEntryWithLevel(y,b),w=o.getPtId(L),C={points:[n(_,E,d.eventDataKeys)],event:t.event};A||(C.nextLevel=w);var S=l.triggerHandler(c,"plotly_"+m.type+"click",C);if(S!==!1&&k.hovermode&&(c._hoverdata=[n(_,E,d.eventDataKeys)],u.click(c,t.event)),!A&&S!==!1&&!c._dragging&&!c._transitioning){h.call("_storeDirectGUIEdit",E,k._tracePreGUI[E.uid],{level:E.level});var P={data:[{level:w}],traces:[m.index]},z={frame:{redraw:!1,duration:d.transitionTime},transition:{duration:d.transitionTime,easing:d.transitionEasing},mode:"immediate",fromcurrent:!0};u.loneUnhover(k._hoverlayer.node()),h.call("animate",c,P,z)}})}},{"../../components/fx":706,"../../components/fx/helpers":702,"../../lib":803,"../../lib/events":792,"../../registry":931,"../pie/helpers":1197,"./helpers":1336,"@plotly/d3":58}],1336:[function(i,B,V){var t=i("../../lib"),h=i("../../components/color"),p=i("../../lib/setcursor"),u=i("../pie/helpers");function e(l){return l.data.data.pid}V.findEntryWithLevel=function(l,o){var a;return o&&l.eachAfter(function(n){if(V.getPtId(n)===o)return a=n.copy()}),a||l},V.findEntryWithChild=function(l,o){var a;return l.eachAfter(function(n){for(var s=n.children||[],r=0;r<s.length;r++){var c=s[r];if(V.getPtId(c)===o)return a=n.copy()}}),a||l},V.isEntry=function(l){return!l.parent},V.isLeaf=function(l){return!l.children},V.getPtId=function(l){return l.data.data.id},V.getPtLabel=function(l){return l.data.data.label},V.getValue=function(l){return l.value},V.isHierarchyRoot=function(l){return e(l)===""},V.setSliceCursor=function(l,o,a){var n=a.isTransitioning;if(!n){var s=l.datum();n=a.hideOnRoot&&V.isHierarchyRoot(s)||a.hideOnLeaves&&V.isLeaf(s)}p(l,n?null:"pointer")},V.getInsideTextFontKey=function(l,o,a,n,s){var r=(s||{}).onPathbar?"pathbar.textfont":"insidetextfont",c=a.data.data.i;return t.castOption(o,c,r+"."+l)||t.castOption(o,c,"textfont."+l)||n.size},V.getOutsideTextFontKey=function(l,o,a,n){var s=a.data.data.i;return t.castOption(o,s,"outsidetextfont."+l)||t.castOption(o,s,"textfont."+l)||n.size},V.isOutsideText=function(l,o){return!l._hasColorscale&&V.isHierarchyRoot(o)},V.determineTextFont=function(l,o,a,n){return V.isOutsideText(l,o)?function(s,r,c){return{color:V.getOutsideTextFontKey("color",s,r,c),family:V.getOutsideTextFontKey("family",s,r,c),size:V.getOutsideTextFontKey("size",s,r,c)}}(l,o,a):function(s,r,c,f){var d=(f||{}).onPathbar,g=r.data.data,m=g.i,y=t.castOption(s,m,(d?"pathbar.textfont":"insidetextfont")+".color");return!y&&s._input.textfont&&(y=t.castOption(s._input,m,"textfont.color")),{color:y||h.contrast(g.color),family:V.getInsideTextFontKey("family",s,r,c,f),size:V.getInsideTextFontKey("size",s,r,c,f)}}(l,o,a,n)},V.hasTransition=function(l){return!!(l&&l.duration>0)},V.getMaxDepth=function(l){return l.maxdepth>=0?l.maxdepth:1/0},V.isHeader=function(l,o){return!(V.isLeaf(l)||l.depth===o._maxDepth-1)},V.getParent=function(l,o){return V.findEntryWithLevel(l,e(o))},V.listPath=function(l,o){var a=l.parent;if(!a)return[];var n=o?[a.data[o]]:[a];return V.listPath(a,o).concat(n)},V.getPath=function(l){return V.listPath(l,"label").join("/")+"/"},V.formatValue=u.formatPieValue,V.formatPercent=function(l,o){var a=t.formatPercent(l,0);return a==="0%"&&(a=u.formatPiePercent(l,o)),a}},{"../../components/color":666,"../../lib":803,"../../lib/setcursor":824,"../pie/helpers":1197}],1337:[function(i,B,V){B.exports={moduleType:"trace",name:"sunburst",basePlotModule:i("./base_plot"),categories:[],animatable:!0,attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyDefaults:i("./defaults"),supplyLayoutDefaults:i("./layout_defaults"),calc:i("./calc").calc,crossTraceCalc:i("./calc").crossTraceCalc,plot:i("./plot").plot,style:i("./style").style,colorbar:i("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1236,"./attributes":1330,"./base_plot":1331,"./calc":1332,"./defaults":1334,"./layout_attributes":1338,"./layout_defaults":1339,"./plot":1340,"./style":1341}],1338:[function(i,B,V){B.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1339:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes");B.exports=function(p,u){function e(l,o){return t.coerce(p,u,h,l,o)}e("sunburstcolorway",u.colorway),e("extendsunburstcolors")}},{"../../lib":803,"./layout_attributes":1338}],1340:[function(i,B,V){var t=i("@plotly/d3"),h=i("d3-hierarchy"),p=i("d3-interpolate").interpolate,u=i("../../components/drawing"),e=i("../../lib"),l=i("../../lib/svg_text_utils"),o=i("../bar/uniform_text"),a=o.recordMinTextSize,n=o.clearMinTextSize,s=i("../pie/plot"),r=i("../pie/helpers").getRotationAngle,c=s.computeTransform,f=s.transformInsideText,d=i("./style").styleOne,g=i("../bar/style").resizeText,m=i("./fx"),y=i("./constants"),v=i("./helpers");function T(k,E,A,b){var L=k._fullLayout,w=!L.uniformtext.mode&&v.hasTransition(b),C=t.select(A).selectAll("g.slice"),S=E[0],P=S.trace,z=S.hierarchy,F=v.findEntryWithLevel(z,P.level),q=v.getMaxDepth(P),W=L._size,X=P.domain,Q=W.w*(X.x[1]-X.x[0]),Z=W.h*(X.y[1]-X.y[0]),Y=.5*Math.min(Q,Z),N=S.cx=W.l+W.w*(X.x[1]+X.x[0])/2,J=S.cy=W.t+W.h*(1-X.y[0])-Z/2;if(!F)return C.remove();var D=null,U={};w&&C.each(function(xe){U[v.getPtId(xe)]={rpx0:xe.rpx0,rpx1:xe.rpx1,x0:xe.x0,x1:xe.x1,transform:xe.transform},!D&&v.isEntry(xe)&&(D=xe)});var G=function(xe){return h.partition().size([2*Math.PI,xe.height+1])(xe)}(F).descendants(),$=F.height+1,K=0,re=q;S.hasMultipleRoots&&v.isHierarchyRoot(F)&&(G=G.slice(1),$-=1,K=1,re+=1),G=G.filter(function(xe){return xe.y1<=re});var ne=r(P.rotation);ne&&G.forEach(function(xe){xe.x0+=ne,xe.x1+=ne});var ae=Math.min($,q),ie=function(xe){return(xe-K)/ae*Y},he=function(xe,fe){return[xe*Math.cos(fe),-xe*Math.sin(fe)]},se=function(xe){return e.pathAnnulus(xe.rpx0,xe.rpx1,xe.x0,xe.x1,N,J)},de=function(xe){return N+_(xe)[0]*(xe.transform.rCenter||0)+(xe.transform.x||0)},ce=function(xe){return J+_(xe)[1]*(xe.transform.rCenter||0)+(xe.transform.y||0)};(C=C.data(G,v.getPtId)).enter().append("g").classed("slice",!0),w?C.exit().transition().each(function(){var xe=t.select(this);xe.select("path.surface").transition().attrTween("d",function(fe){var ge=function(ke){var Me,Se=v.getPtId(ke),De=U[Se],Be=U[v.getPtId(F)];if(Be){var We=(ke.x1>Be.x1?2*Math.PI:0)+ne;Me=ke.rpx1<Be.rpx1?{x0:ke.x0,x1:ke.x1,rpx0:0,rpx1:0}:{x0:We,x1:We,rpx0:ke.rpx0,rpx1:ke.rpx1}}else{var Qe,Oe=v.getPtId(ke.parent);C.each(function(it){if(v.getPtId(it)===Oe)return Qe=it});var Ue,Xe=Qe.children;Xe.forEach(function(it,ot){if(v.getPtId(it)===Se)return Ue=ot});var Ye=Xe.length,$e=p(Qe.x0,Qe.x1);Me={rpx0:Y,rpx1:Y,x0:$e(Ue/Ye),x1:$e((Ue+1)/Ye)}}return p(De,Me)}(fe);return function(ke){return se(ge(ke))}}),xe.select("g.slicetext").attr("opacity",0)}).remove():C.exit().remove(),C.order();var ve=null;if(w&&D){var Ee=v.getPtId(D);C.each(function(xe){ve===null&&v.getPtId(xe)===Ee&&(ve=xe.x1)})}var Le=C;function Te(xe){var fe=xe.parent,ge=U[v.getPtId(fe)],ke={};if(ge){var Me=fe.children,Se=Me.indexOf(xe),De=Me.length,Be=p(ge.x0,ge.x1);ke.x0=Be(Se/De),ke.x1=Be(Se/De)}else ke.x0=ke.x1=0;return ke}w&&(Le=Le.transition().each("end",function(){var xe=t.select(this);v.setSliceCursor(xe,k,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),Le.each(function(xe){var fe=t.select(this),ge=e.ensureSingle(fe,"path","surface",function(We){We.style("pointer-events","all")});xe.rpx0=ie(xe.y0),xe.rpx1=ie(xe.y1),xe.xmid=(xe.x0+xe.x1)/2,xe.pxmid=he(xe.rpx1,xe.xmid),xe.midangle=-(xe.xmid-Math.PI/2),xe.startangle=-(xe.x0-Math.PI/2),xe.stopangle=-(xe.x1-Math.PI/2),xe.halfangle=.5*Math.min(e.angleDelta(xe.x0,xe.x1)||Math.PI,Math.PI),xe.ring=1-xe.rpx0/xe.rpx1,xe.rInscribed=function(We){return We.rpx0===0&&e.isFullCircle([We.x0,We.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(We.halfangle)),We.ring/2))}(xe),w?ge.transition().attrTween("d",function(We){var Qe=function(Oe){var Ue,Xe=U[v.getPtId(Oe)],Ye={x0:Oe.x0,x1:Oe.x1,rpx0:Oe.rpx0,rpx1:Oe.rpx1};if(Xe)Ue=Xe;else if(D)if(Oe.parent)if(ve){var $e=(Oe.x1>ve?2*Math.PI:0)+ne;Ue={x0:$e,x1:$e}}else Ue={rpx0:Y,rpx1:Y},e.extendFlat(Ue,Te(Oe));else Ue={rpx0:0,rpx1:0};else Ue={x0:ne,x1:ne};return p(Ue,Ye)}(We);return function(Oe){return se(Qe(Oe))}}):ge.attr("d",se),fe.call(m,F,k,E,{eventDataKeys:y.eventDataKeys,transitionTime:y.CLICK_TRANSITION_TIME,transitionEasing:y.CLICK_TRANSITION_EASING}).call(v.setSliceCursor,k,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:k._transitioning}),ge.call(d,xe,P);var ke=e.ensureSingle(fe,"g","slicetext"),Me=e.ensureSingle(ke,"text","",function(We){We.attr("data-notex",1)}),Se=e.ensureUniformFontSize(k,v.determineTextFont(P,xe,L.font));Me.text(V.formatSliceLabel(xe,F,P,E,L)).classed("slicetext",!0).attr("text-anchor","middle").call(u.font,Se).call(l.convertToTspans,k);var De=u.bBox(Me.node());xe.transform=f(De,xe,S),xe.transform.targetX=de(xe),xe.transform.targetY=ce(xe);var Be=function(We,Qe){var Oe=We.transform;return c(Oe,Qe),Oe.fontSize=Se.size,a(P.type,Oe,L),e.getTextTransform(Oe)};w?Me.transition().attrTween("transform",function(We){var Qe=function(Oe){var Ue,Xe=U[v.getPtId(Oe)],Ye=Oe.transform;if(Xe)Ue=Xe;else if(Ue={rpx1:Oe.rpx1,transform:{textPosAngle:Ye.textPosAngle,scale:0,rotate:Ye.rotate,rCenter:Ye.rCenter,x:Ye.x,y:Ye.y}},D)if(Oe.parent)if(ve){var $e=Oe.x1>ve?2*Math.PI:0;Ue.x0=Ue.x1=$e}else e.extendFlat(Ue,Te(Oe));else Ue.x0=Ue.x1=ne;else Ue.x0=Ue.x1=ne;var it=p(Ue.transform.textPosAngle,Oe.transform.textPosAngle),ot=p(Ue.rpx1,Oe.rpx1),Et=p(Ue.x0,Oe.x0),mt=p(Ue.x1,Oe.x1),tt=p(Ue.transform.scale,Ye.scale),Ke=p(Ue.transform.rotate,Ye.rotate),Mt=Ye.rCenter===0?3:Ue.transform.rCenter===0?1/3:1,Jt=p(Ue.transform.rCenter,Ye.rCenter);return function($t){var je=ot($t),Ge=Et($t),Ct=mt($t),Ie=function(Ae){return Jt(Math.pow(Ae,Mt))}($t),be={pxmid:he(je,(Ge+Ct)/2),rpx1:je,transform:{textPosAngle:it($t),rCenter:Ie,x:Ye.x,y:Ye.y}};return a(P.type,Ye,L),{transform:{targetX:de(be),targetY:ce(be),scale:tt($t),rotate:Ke($t),rCenter:Ie}}}}(We);return function(Oe){return Be(Qe(Oe),De)}}):Me.attr("transform",Be(xe,De))})}function _(k){return E=k.rpx1,A=k.transform.textPosAngle,[E*Math.sin(A),-E*Math.cos(A)];var E,A}V.plot=function(k,E,A,b){var L,w,C=k._fullLayout,S=C._sunburstlayer,P=!A,z=!C.uniformtext.mode&&v.hasTransition(A);n("sunburst",C),(L=S.selectAll("g.trace.sunburst").data(E,function(F){return F[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),L.order(),z?(b&&(w=b()),t.transition().duration(A.duration).ease(A.easing).each("end",function(){w&&w()}).each("interrupt",function(){w&&w()}).each(function(){S.selectAll("g.trace").each(function(F){T(k,F,this,A)})})):(L.each(function(F){T(k,F,this,A)}),C.uniformtext.mode&&g(k,C._sunburstlayer.selectAll(".trace"),"sunburst")),P&&L.exit().remove()},V.formatSliceLabel=function(k,E,A,b,L){var w=A.texttemplate,C=A.textinfo;if(!(w||C&&C!=="none"))return"";var S=L.separators,P=b[0],z=k.data.data,F=P.hierarchy,q=v.isHierarchyRoot(k),W=v.getParent(F,k),X=v.getValue(k);if(!w){var Q,Z=C.split("+"),Y=function(ne){return Z.indexOf(ne)!==-1},N=[];if(Y("label")&&z.label&&N.push(z.label),z.hasOwnProperty("v")&&Y("value")&&N.push(v.formatValue(z.v,S)),!q){Y("current path")&&N.push(v.getPath(k.data));var J=0;Y("percent parent")&&J++,Y("percent entry")&&J++,Y("percent root")&&J++;var D=J>1;if(J){var U,G=function(ne){Q=v.formatPercent(U,S),D&&(Q+=" of "+ne),N.push(Q)};Y("percent parent")&&!q&&(U=X/v.getValue(W),G("parent")),Y("percent entry")&&(U=X/v.getValue(E),G("entry")),Y("percent root")&&(U=X/v.getValue(F),G("root"))}}return Y("text")&&(Q=e.castOption(A,z.i,"text"),e.isValidTextValue(Q)&&N.push(Q)),N.join("<br>")}var $=e.castOption(A,z.i,"texttemplate");if(!$)return"";var K={};z.label&&(K.label=z.label),z.hasOwnProperty("v")&&(K.value=z.v,K.valueLabel=v.formatValue(z.v,S)),K.currentPath=v.getPath(k.data),q||(K.percentParent=X/v.getValue(W),K.percentParentLabel=v.formatPercent(K.percentParent,S),K.parent=v.getPtLabel(W)),K.percentEntry=X/v.getValue(E),K.percentEntryLabel=v.formatPercent(K.percentEntry,S),K.entry=v.getPtLabel(E),K.percentRoot=X/v.getValue(F),K.percentRootLabel=v.formatPercent(K.percentRoot,S),K.root=v.getPtLabel(F),z.hasOwnProperty("color")&&(K.color=z.color);var re=e.castOption(A,z.i,"text");return(e.isValidTextValue(re)||re==="")&&(K.text=re),K.customdata=e.castOption(A,z.i,"customdata"),e.texttemplateString($,K,L._d3locale,K,A._meta||{})}},{"../../components/drawing":688,"../../lib":803,"../../lib/svg_text_utils":829,"../bar/style":955,"../bar/uniform_text":957,"../pie/helpers":1197,"../pie/plot":1201,"./constants":1333,"./fx":1335,"./helpers":1336,"./style":1341,"@plotly/d3":58,"d3-hierarchy":170,"d3-interpolate":171}],1341:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/color"),p=i("../../lib"),u=i("../bar/uniform_text").resizeText;function e(l,o,a){var n=o.data.data,s=!o.children,r=n.i,c=p.castOption(a,r,"marker.line.color")||h.defaultLine,f=p.castOption(a,r,"marker.line.width")||0;l.style("stroke-width",f).call(h.fill,n.color).call(h.stroke,c).style("opacity",s?a.leaf.opacity:null)}B.exports={style:function(l){var o=l._fullLayout._sunburstlayer.selectAll(".trace");u(l,o,"sunburst"),o.each(function(a){var n=t.select(this),s=a[0].trace;n.style("opacity",s.opacity),n.selectAll("path.surface").each(function(r){t.select(this).call(e,r,s)})})},styleOne:e}},{"../../components/color":666,"../../lib":803,"../bar/uniform_text":957,"@plotly/d3":58}],1342:[function(i,B,V){var t=i("../../components/color"),h=i("../../components/colorscale/attributes"),p=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,u=i("../../plots/template_attributes").hovertemplateAttrs,e=i("../../plots/attributes"),l=i("../../lib/extend").extendFlat,o=i("../../plot_api/edit_types").overrideAll;function a(s){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:t.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:t.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var n=B.exports=o(l({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:u(),xhoverformat:p("x"),yhoverformat:p("y"),zhoverformat:p("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},h("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:a(),y:a(),z:a()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:l({},h.zauto,{}),zmin:l({},h.zmin,{}),zmax:l({},h.zmax,{})},hoverinfo:l({},e.hoverinfo),showlegend:l({},e.showlegend,{dflt:!1})}),"calc","nested");n.x.editType=n.y.editType=n.z.editType="calc+clearAxisTypes",n.transforms=void 0},{"../../components/color":666,"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926}],1343:[function(i,B,V){var t=i("../../components/colorscale/calc");B.exports=function(h,p){p.surfacecolor?t(h,p,{vals:p.surfacecolor,containerStr:"",cLetter:"c"}):t(h,p,{vals:p.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":674}],1344:[function(i,B,V){var t=i("gl-surface3d"),h=i("ndarray"),p=i("ndarray-linear-interpolate").d2,u=i("../heatmap/interp2d"),e=i("../heatmap/find_empties"),l=i("../../lib").isArrayOrTypedArray,o=i("../../lib/gl_format_color").parseColorScale,a=i("../../lib/str2rgbarray"),n=i("../../components/colorscale").extractOpts;function s(A,b,L){this.scene=A,this.uid=L,this.surface=b,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var r=s.prototype;r.getXat=function(A,b,L,w){var C=l(this.data.x)?l(this.data.x[0])?this.data.x[b][A]:this.data.x[A]:A;return L===void 0?C:w.d2l(C,0,L)},r.getYat=function(A,b,L,w){var C=l(this.data.y)?l(this.data.y[0])?this.data.y[b][A]:this.data.y[b]:b;return L===void 0?C:w.d2l(C,0,L)},r.getZat=function(A,b,L,w){var C=this.data.z[b][A];return C===null&&this.data.connectgaps&&this.data._interpolatedZ&&(C=this.data._interpolatedZ[b][A]),L===void 0?C:w.d2l(C,0,L)},r.handlePick=function(A){if(A.object===this.surface){var b=(A.data.index[0]-1)/this.dataScaleX-1,L=(A.data.index[1]-1)/this.dataScaleY-1,w=Math.max(Math.min(Math.round(b),this.data.z[0].length-1),0),C=Math.max(Math.min(Math.round(L),this.data._ylength-1),0);A.index=[w,C],A.traceCoordinate=[this.getXat(w,C),this.getYat(w,C),this.getZat(w,C)],A.dataCoordinate=[this.getXat(w,C,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(w,C,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(w,C,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var S=0;S<3;S++){var P=A.dataCoordinate[S];P!=null&&(A.dataCoordinate[S]*=this.scene.dataScale[S])}var z=this.data.hovertext||this.data.text;return Array.isArray(z)&&z[C]&&z[C][w]!==void 0?A.textLabel=z[C][w]:A.textLabel=z||"",A.data.dataCoordinate=A.dataCoordinate.slice(),this.surface.highlight(A.data),this.scene.glplot.spikes.position=A.dataCoordinate,!0}};var c=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function f(A,b){if(A<b)return 0;for(var L=0;Math.floor(A%b)===0;)A/=b,L++;return L}function d(A){for(var b=[],L=0;L<c.length;L++){var w=c[L];b.push(f(A,w))}return b}function g(A){for(var b=d(A),L=A,w=0;w<c.length;w++)if(b[w]>0){L=c[w];break}return L}function m(A,b){if(!(A<1||b<1)){for(var L=d(A),w=d(b),C=1,S=0;S<c.length;S++)C*=Math.pow(c[S],Math.max(L[S],w[S]));return C}}r.calcXnums=function(A){var b,L=[];for(b=1;b<A;b++){var w=this.getXat(b-1,0),C=this.getXat(b,0);L[b-1]=C!==w&&w!=null&&C!=null?Math.abs(C-w):0}var S=0;for(b=1;b<A;b++)S+=L[b-1];for(b=1;b<A;b++)L[b-1]===0?L[b-1]=1:L[b-1]=Math.round(S/L[b-1]);return L},r.calcYnums=function(A){var b,L=[];for(b=1;b<A;b++){var w=this.getYat(0,b-1),C=this.getYat(0,b);L[b-1]=C!==w&&w!=null&&C!=null?Math.abs(C-w):0}var S=0;for(b=1;b<A;b++)S+=L[b-1];for(b=1;b<A;b++)L[b-1]===0?L[b-1]=1:L[b-1]=Math.round(S/L[b-1]);return L};var y=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],v=y[9],T=y[13];function _(A,b,L){var w=L[8]+L[2]*b[0]+L[5]*b[1];return A[0]=(L[6]+L[0]*b[0]+L[3]*b[1])/w,A[1]=(L[7]+L[1]*b[0]+L[4]*b[1])/w,A}function k(A,b,L){return function(w,C,S,P){for(var z=[0,0],F=w.shape[0],q=w.shape[1],W=0;W<F;W++)for(var X=0;X<q;X++)S(z,[W,X],P),w.set(W,X,p(C,z[0],z[1]))}(A,b,_,L),A}function E(A,b){for(var L=!1,w=0;w<A.length;w++)if(b===A[w]){L=!0;break}L===!1&&A.push(b)}r.estimateScale=function(A,b){for(var L=1+function(C){if(C.length!==0){for(var S=1,P=0;P<C.length;P++)S=m(S,C[P]);return S}}(b===0?this.calcXnums(A):this.calcYnums(A));L<v;)L*=2;for(;L>T;)L--,L/=g(L),++L<v&&(L=T);var w=Math.round(L/A);return w>1?w:1},r.refineCoords=function(A){for(var b=this.dataScaleX,L=this.dataScaleY,w=A[0].shape[0],C=A[0].shape[1],S=0|Math.floor(A[0].shape[0]*b+1),P=0|Math.floor(A[0].shape[1]*L+1),z=1+w+1,F=1+C+1,q=h(new Float32Array(z*F),[z,F]),W=[1/b,0,0,0,1/L,0,0,0,1],X=0;X<A.length;++X){this.surface.padField(q,A[X]);var Q=h(new Float32Array(S*P),[S,P]);k(Q,q,W),A[X]=Q}},r.setContourLevels=function(){var A,b,L,w=[[],[],[]],C=[!1,!1,!1],S=!1;for(A=0;A<3;++A)if(this.showContour[A]&&(S=!0,this.contourSize[A]>0&&this.contourStart[A]!==null&&this.contourEnd[A]!==null&&this.contourEnd[A]>this.contourStart[A]))for(C[A]=!0,b=this.contourStart[A];b<this.contourEnd[A];b+=this.contourSize[A])L=b*this.scene.dataScale[A],E(w[A],L);if(S){var P=[[],[],[]];for(A=0;A<3;++A)this.showContour[A]&&(P[A]=C[A]?w[A]:this.scene.contourLevels[A]);this.surface.update({levels:P})}},r.update=function(A){var b,L,w,C,S=this.scene,P=S.fullSceneLayout,z=this.surface,F=o(A),q=S.dataScale,W=A.z[0].length,X=A._ylength,Q=S.contourLevels;this.data=A;var Z=[];for(b=0;b<3;b++)for(Z[b]=[],L=0;L<W;L++)Z[b][L]=[];for(L=0;L<W;L++)for(w=0;w<X;w++)Z[0][L][w]=this.getXat(L,w,A.xcalendar,P.xaxis),Z[1][L][w]=this.getYat(L,w,A.ycalendar,P.yaxis),Z[2][L][w]=this.getZat(L,w,A.zcalendar,P.zaxis);if(A.connectgaps)for(A._emptypoints=e(Z[2]),u(Z[2],A._emptypoints),A._interpolatedZ=[],L=0;L<W;L++)for(A._interpolatedZ[L]=[],w=0;w<X;w++)A._interpolatedZ[L][w]=Z[2][L][w];for(b=0;b<3;b++)for(L=0;L<W;L++)for(w=0;w<X;w++)(C=Z[b][L][w])==null?Z[b][L][w]=NaN:C=Z[b][L][w]*=q[b];for(b=0;b<3;b++)for(L=0;L<W;L++)for(w=0;w<X;w++)(C=Z[b][L][w])!=null&&(this.minValues[b]>C&&(this.minValues[b]=C),this.maxValues[b]<C&&(this.maxValues[b]=C));for(b=0;b<3;b++)this.objectOffset[b]=.5*(this.minValues[b]+this.maxValues[b]);for(b=0;b<3;b++)for(L=0;L<W;L++)for(w=0;w<X;w++)(C=Z[b][L][w])!=null&&(Z[b][L][w]-=this.objectOffset[b]);var Y=[h(new Float32Array(W*X),[W,X]),h(new Float32Array(W*X),[W,X]),h(new Float32Array(W*X),[W,X])];for(b=0;b<3;b++)for(L=0;L<W;L++)for(w=0;w<X;w++)Y[b].set(L,w,Z[b][L][w]);Z=[];var N={colormap:F,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!A.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:A.opacityscale,opacity:A.opacity},J=n(A);if(N.intensityBounds=[J.min,J.max],A.surfacecolor){var D=h(new Float32Array(W*X),[W,X]);for(L=0;L<W;L++)for(w=0;w<X;w++)D.set(L,w,A.surfacecolor[w][L]);Y.push(D)}else N.intensityBounds[0]*=q[2],N.intensityBounds[1]*=q[2];(T<Y[0].shape[0]||T<Y[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(Y[0].shape[0],0),this.dataScaleY=this.estimateScale(Y[0].shape[1],1),this.dataScaleX===1&&this.dataScaleY===1||this.refineCoords(Y)),A.surfacecolor&&(N.intensity=Y.pop());var U=[!0,!0,!0],G=["x","y","z"];for(b=0;b<3;++b){var $=A.contours[G[b]];U[b]=$.highlight,N.showContour[b]=$.show||$.highlight,N.showContour[b]&&(N.contourProject[b]=[$.project.x,$.project.y,$.project.z],$.show?(this.showContour[b]=!0,N.levels[b]=Q[b],z.highlightColor[b]=N.contourColor[b]=a($.color),$.usecolormap?z.highlightTint[b]=N.contourTint[b]=0:z.highlightTint[b]=N.contourTint[b]=1,N.contourWidth[b]=$.width,this.contourStart[b]=$.start,this.contourEnd[b]=$.end,this.contourSize[b]=$.size):(this.showContour[b]=!1,this.contourStart[b]=null,this.contourEnd[b]=null,this.contourSize[b]=0),$.highlight&&(N.dynamicColor[b]=a($.highlightcolor),N.dynamicWidth[b]=$.highlightwidth))}(function(K){var re=K[0].rgb,ne=K[K.length-1].rgb;return re[0]===ne[0]&&re[1]===ne[1]&&re[2]===ne[2]&&re[3]===ne[3]})(F)&&(N.vertexColor=!0),N.objectOffset=this.objectOffset,N.coords=Y,z.update(N),z.visible=A.visible,z.enableDynamic=U,z.enableHighlight=U,z.snapToData=!0,"lighting"in A&&(z.ambientLight=A.lighting.ambient,z.diffuseLight=A.lighting.diffuse,z.specularLight=A.lighting.specular,z.roughness=A.lighting.roughness,z.fresnel=A.lighting.fresnel),"lightposition"in A&&(z.lightPosition=[A.lightposition.x,A.lightposition.y,A.lightposition.z])},r.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},B.exports=function(A,b){var L=A.glplot.gl,w=t({gl:L}),C=new s(A,w,b.uid);return w._trace=C,C.update(b),A.glplot.add(w),C}},{"../../components/colorscale":678,"../../lib":803,"../../lib/gl_format_color":799,"../../lib/str2rgbarray":828,"../heatmap/find_empties":1091,"../heatmap/interp2d":1094,"gl-surface3d":354,ndarray:483,"ndarray-linear-interpolate":477}],1345:[function(i,B,V){var t=i("../../registry"),h=i("../../lib"),p=i("../../components/colorscale/defaults"),u=i("./attributes");function e(o,a,n,s){var r=s("opacityscale");r==="max"?a.opacityscale=[[0,.1],[1,1]]:r==="min"?a.opacityscale=[[0,1],[1,.1]]:r==="extremes"?a.opacityscale=function(c,f){for(var d=[],g=0;g<32;g++){var m=g/31,y=f+(1-f)*(1-Math.pow(Math.sin(c*m*Math.PI),2));d.push([m,Math.max(0,Math.min(1,y))])}return d}(1,.1):function(c){var f=0;if(!Array.isArray(c)||c.length<2||!c[0]||!c[c.length-1]||+c[0][0]!=0||+c[c.length-1][0]!=1)return!1;for(var d=0;d<c.length;d++){var g=c[d];if(g.length!==2||+g[0]<f)return!1;f=+g[0]}return!0}(r)||(a.opacityscale=void 0)}function l(o,a,n){a in o&&!(n in o)&&(o[n]=o[a])}B.exports={supplyDefaults:function(o,a,n,s){var r,c;function f(E,A){return h.coerce(o,a,u,E,A)}var d=f("x"),g=f("y"),m=f("z");if(!m||!m.length||d&&d.length<1||g&&g.length<1)a.visible=!1;else{a._xlength=Array.isArray(d)&&h.isArrayOrTypedArray(d[0])?m.length:m[0].length,a._ylength=m.length,t.getComponentMethod("calendars","handleTraceDefaults")(o,a,["x","y","z"],s),f("text"),f("hovertext"),f("hovertemplate"),f("xhoverformat"),f("yhoverformat"),f("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(E){f(E)});var y=f("surfacecolor"),v=["x","y","z"];for(r=0;r<3;++r){var T="contours."+v[r],_=f(T+".show"),k=f(T+".highlight");if(_||k)for(c=0;c<3;++c)f(T+".project."+v[c]);_&&(f(T+".color"),f(T+".width"),f(T+".usecolormap")),k&&(f(T+".highlightcolor"),f(T+".highlightwidth")),f(T+".start"),f(T+".end"),f(T+".size")}y||(l(o,"zmin","cmin"),l(o,"zmax","cmax"),l(o,"zauto","cauto")),p(o,a,s,f,{prefix:"",cLetter:"c"}),e(o,a,s,f),a._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":676,"../../lib":803,"../../registry":931,"./attributes":1342}],1346:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:i("./calc"),plot:i("./convert"),moduleType:"trace",name:"surface",basePlotModule:i("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":896,"./attributes":1342,"./calc":1343,"./convert":1344,"./defaults":1345}],1347:[function(i,B,V){var t=i("../../components/annotations/attributes"),h=i("../../lib/extend").extendFlat,p=i("../../plot_api/edit_types").overrideAll,u=i("../../plots/font_attributes"),e=i("../../plots/domain").attributes,l=i("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;(B.exports=p({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:l("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:h({},t.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:h({},u({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:l("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:h({},t.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:h({},u({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":649,"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plots/cartesian/axis_format_attributes":857,"../../plots/domain":882,"../../plots/font_attributes":883}],1348:[function(i,B,V){var t=i("../../plots/get_data").getModuleCalcData,h=i("./plot");V.name="table",V.plot=function(p){var u=t(p.calcdata,"table")[0];u.length&&h(p,u)},V.clean=function(p,u,e,l){var o=l._has&&l._has("table"),a=u._has&&u._has("table");o&&!a&&l._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":891,"./plot":1355}],1349:[function(i,B,V){var t=i("../../lib/gup").wrap;B.exports=function(){return t({})}},{"../../lib/gup":800}],1350:[function(i,B,V){B.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1351:[function(i,B,V){var t=i("./constants"),h=i("../../lib/extend").extendFlat,p=i("fast-isnumeric");function u(r){if(Array.isArray(r)){for(var c=0,f=0;f<r.length;f++)c=Math.max(c,u(r[f]));return c}return r}function e(r,c){return r+c}function l(r){var c,f=r.slice(),d=1/0,g=0;for(c=0;c<f.length;c++)Array.isArray(f[c])||(f[c]=[f[c]]),d=Math.min(d,f[c].length),g=Math.max(g,f[c].length);if(d!==g)for(c=0;c<f.length;c++){var m=g-f[c].length;m&&(f[c]=f[c].concat(o(m)))}return f}function o(r){for(var c=new Array(r),f=0;f<r;f++)c[f]="";return c}function a(r){return r.calcdata.columns.reduce(function(c,f){return f.xIndex<r.xIndex?c+f.columnWidth:c},0)}function n(r,c){return Object.keys(r).map(function(f){return h({},r[f],{auxiliaryBlocks:c})})}function s(r,c){for(var f,d={},g=0,m=0,y={firstRowIndex:null,lastRowIndex:null,rows:[]},v=0,T=0,_=0;_<r.length;_++)f=r[_],y.rows.push({rowIndex:_,rowHeight:f}),((m+=f)>=c||_===r.length-1)&&(d[g]=y,y.key=T++,y.firstRowIndex=v,y.lastRowIndex=_,y={firstRowIndex:null,lastRowIndex:null,rows:[]},g+=m,v=_+1,m=0);return d}B.exports=function(r,c){var f=l(c.cells.values),d=function(q){return q.slice(c.header.values.length,q.length)},g=l(c.header.values);g.length&&!g[0].length&&(g[0]=[""],g=l(g));var m=g.concat(d(f).map(function(){return o((g[0]||[""]).length)})),y=c.domain,v=Math.floor(r._fullLayout._size.w*(y.x[1]-y.x[0])),T=Math.floor(r._fullLayout._size.h*(y.y[1]-y.y[0])),_=c.header.values.length?m[0].map(function(){return c.header.height}):[t.emptyHeaderHeight],k=f.length?f[0].map(function(){return c.cells.height}):[],E=_.reduce(e,0),A=s(k,T-E+t.uplift),b=n(s(_,E),[]),L=n(A,b),w={},C=c._fullInput.columnorder.concat(d(f.map(function(q,W){return W}))),S=m.map(function(q,W){var X=Array.isArray(c.columnwidth)?c.columnwidth[Math.min(W,c.columnwidth.length-1)]:c.columnwidth;return p(X)?Number(X):1}),P=S.reduce(e,0);S=S.map(function(q){return q/P*v});var z=Math.max(u(c.header.line.width),u(c.cells.line.width)),F={key:c.uid+r._context.staticPlot,translateX:y.x[0]*r._fullLayout._size.w,translateY:r._fullLayout._size.h*(1-y.y[1]),size:r._fullLayout._size,width:v,maxLineWidth:z,height:T,columnOrder:C,groupHeight:T,rowBlocks:L,headerRowBlocks:b,scrollY:0,cells:h({},c.cells,{values:f}),headerCells:h({},c.header,{values:m}),gdColumns:m.map(function(q){return q[0]}),gdColumnsOriginalOrder:m.map(function(q){return q[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:m.map(function(q,W){var X=w[q];return w[q]=(X||0)+1,{key:q+"__"+w[q],label:q,specIndex:W,xIndex:C[W],xScale:a,x:void 0,calcdata:void 0,columnWidth:S[W]}})};return F.columns.forEach(function(q){q.calcdata=F,q.x=a(q)}),F}},{"../../lib/extend":793,"./constants":1350,"fast-isnumeric":249}],1352:[function(i,B,V){var t=i("../../lib/extend").extendFlat;V.splitToPanels=function(h){var p=[0,0],u=t({},h,{key:"header",type:"header",page:0,prevPages:p,currentRepaint:[null,null],dragHandle:!0,values:h.calcdata.headerCells.values[h.specIndex],rowBlocks:h.calcdata.headerRowBlocks,calcdata:t({},h.calcdata,{cells:h.calcdata.headerCells})});return[t({},h,{key:"cells1",type:"cells",page:0,prevPages:p,currentRepaint:[null,null],dragHandle:!1,values:h.calcdata.cells.values[h.specIndex],rowBlocks:h.calcdata.rowBlocks}),t({},h,{key:"cells2",type:"cells",page:1,prevPages:p,currentRepaint:[null,null],dragHandle:!1,values:h.calcdata.cells.values[h.specIndex],rowBlocks:h.calcdata.rowBlocks}),u]},V.splitToCells=function(h){var p=function(u){var e=u.rowBlocks[u.page],l=e?e.rows[0].rowIndex:0,o=e?l+e.rows.length:0;return[l,o]}(h);return(h.values||[]).slice(p[0],p[1]).map(function(u,e){return{keyWithinBlock:e+(typeof u=="string"&&u.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:p[0]+e,column:h,calcdata:h.calcdata,page:h.page,rowBlocks:h.rowBlocks,value:u}})}},{"../../lib/extend":793}],1353:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("../../plots/domain").defaults;B.exports=function(u,e,l,o){function a(n,s){return t.coerce(u,e,h,n,s)}p(e,o,a),a("columnwidth"),a("header.values"),a("header.format"),a("header.align"),a("header.prefix"),a("header.suffix"),a("header.height"),a("header.line.width"),a("header.line.color"),a("header.fill.color"),t.coerceFont(a,"header.font",t.extendFlat({},o.font)),function(n,s){for(var r=n.columnorder||[],c=n.header.values.length,f=r.slice(0,c),d=f.slice().sort(function(y,v){return y-v}),g=f.map(function(y){return d.indexOf(y)}),m=g.length;m<c;m++)g.push(m);s("columnorder",g)}(e,a),a("cells.values"),a("cells.format"),a("cells.align"),a("cells.prefix"),a("cells.suffix"),a("cells.height"),a("cells.line.width"),a("cells.line.color"),a("cells.fill.color"),t.coerceFont(a,"cells.font",t.extendFlat({},o.font)),e._length=null}},{"../../lib":803,"../../plots/domain":882,"./attributes":1347}],1354:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("./calc"),plot:i("./plot"),moduleType:"trace",name:"table",basePlotModule:i("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1347,"./base_plot":1348,"./calc":1349,"./defaults":1353,"./plot":1355}],1355:[function(i,B,V){var t=i("./constants"),h=i("@plotly/d3"),p=i("../../lib").numberFormat,u=i("../../lib/gup"),e=i("../../components/drawing"),l=i("../../lib/svg_text_utils"),o=i("../../lib").raiseToTop,a=i("../../lib").strTranslate,n=i("../../lib").cancelTransition,s=i("./data_preparation_helper"),r=i("./data_split_helpers"),c=i("../../components/color");function f(Y){return Math.ceil(Y.calcdata.maxLineWidth/2)}function d(Y,N){return"clip"+Y._fullLayout._uid+"_scrollAreaBottomClip_"+N.key}function g(Y,N){return"clip"+Y._fullLayout._uid+"_columnBoundaryClippath_"+N.calcdata.key+"_"+N.specIndex}function m(Y){return[].concat.apply([],Y.map(function(N){return N})).map(function(N){return N.__data__})}function y(Y,N,J){var D=Y.selectAll("."+t.cn.scrollbarKit).data(u.repeat,u.keyFun);D.enter().append("g").classed(t.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),D.each(function(re){var ne=re.scrollbarState;ne.totalHeight=function(ae){var ie=ae.rowBlocks;return W(ie,ie.length-1)+(ie.length?X(ie[ie.length-1],1/0):1)}(re),ne.scrollableAreaHeight=re.groupHeight-L(re),ne.currentlyVisibleHeight=Math.min(ne.totalHeight,ne.scrollableAreaHeight),ne.ratio=ne.currentlyVisibleHeight/ne.totalHeight,ne.barLength=Math.max(ne.ratio*ne.currentlyVisibleHeight,t.goldenRatio*t.scrollbarWidth),ne.barWiggleRoom=ne.currentlyVisibleHeight-ne.barLength,ne.wiggleRoom=Math.max(0,ne.totalHeight-ne.scrollableAreaHeight),ne.topY=ne.barWiggleRoom===0?0:re.scrollY/ne.wiggleRoom*ne.barWiggleRoom,ne.bottomY=ne.topY+ne.barLength,ne.dragMultiplier=ne.wiggleRoom/ne.barWiggleRoom}).attr("transform",function(re){var ne=re.width+t.scrollbarWidth/2+t.scrollbarOffset;return a(ne,L(re))});var U=D.selectAll("."+t.cn.scrollbar).data(u.repeat,u.keyFun);U.enter().append("g").classed(t.cn.scrollbar,!0);var G=U.selectAll("."+t.cn.scrollbarSlider).data(u.repeat,u.keyFun);G.enter().append("g").classed(t.cn.scrollbarSlider,!0),G.attr("transform",function(re){return a(0,re.scrollbarState.topY||0)});var $=G.selectAll("."+t.cn.scrollbarGlyph).data(u.repeat,u.keyFun);$.enter().append("line").classed(t.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",t.scrollbarWidth).attr("stroke-linecap","round").attr("y1",t.scrollbarWidth/2),$.attr("y2",function(re){return re.scrollbarState.barLength-t.scrollbarWidth/2}).attr("stroke-opacity",function(re){return re.columnDragInProgress||!re.scrollbarState.barWiggleRoom||J?0:.4}),$.transition().delay(0).duration(0),$.transition().delay(t.scrollbarHideDelay).duration(t.scrollbarHideDuration).attr("stroke-opacity",0);var K=U.selectAll("."+t.cn.scrollbarCaptureZone).data(u.repeat,u.keyFun);K.enter().append("line").classed(t.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",t.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(re){var ne=h.event.y,ae=this.getBoundingClientRect(),ie=re.scrollbarState,he=ne-ae.top,se=h.scale.linear().domain([0,ie.scrollableAreaHeight]).range([0,ie.totalHeight]).clamp(!0);ie.topY<=he&&he<=ie.bottomY||C(N,Y,null,se(he-ie.barLength/2))(re)}).call(h.behavior.drag().origin(function(re){return h.event.stopPropagation(),re.scrollbarState.scrollbarScrollInProgress=!0,re}).on("drag",C(N,Y)).on("dragend",function(){})),K.attr("y2",function(re){return re.scrollbarState.scrollableAreaHeight}),N._context.staticPlot&&($.remove(),K.remove())}function v(Y,N,J,D){var U=function($){var K=$.selectAll("."+t.cn.columnCell).data(r.splitToCells,function(re){return re.keyWithinBlock});return K.enter().append("g").classed(t.cn.columnCell,!0),K.exit().remove(),K}(function($){var K=$.selectAll("."+t.cn.columnCells).data(u.repeat,u.keyFun);return K.enter().append("g").classed(t.cn.columnCells,!0),K.exit().remove(),K}(J));(function($){$.each(function(K,re){var ne=K.calcdata.cells.font,ae=K.column.specIndex,ie={size:k(ne.size,ae,re),color:k(ne.color,ae,re),family:k(ne.family,ae,re)};K.rowNumber=K.key,K.align=k(K.calcdata.cells.align,ae,re),K.cellBorderWidth=k(K.calcdata.cells.line.width,ae,re),K.font=ie})})(U),function($){$.attr("width",function(K){return K.column.columnWidth}).attr("stroke-width",function(K){return K.cellBorderWidth}).each(function(K){var re=h.select(this);c.stroke(re,k(K.calcdata.cells.line.color,K.column.specIndex,K.rowNumber)),c.fill(re,k(K.calcdata.cells.fill.color,K.column.specIndex,K.rowNumber))})}(function($){var K=$.selectAll("."+t.cn.cellRect).data(u.repeat,function(re){return re.keyWithinBlock});return K.enter().append("rect").classed(t.cn.cellRect,!0),K}(U));var G=function($){var K=$.selectAll("."+t.cn.cellText).data(u.repeat,function(re){return re.keyWithinBlock});return K.enter().append("text").classed(t.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){h.event.stopPropagation()}),K}(function($){var K=$.selectAll("."+t.cn.cellTextHolder).data(u.repeat,function(re){return re.keyWithinBlock});return K.enter().append("g").classed(t.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),K}(U));(function($){$.each(function(K){e.font(h.select(this),K.font)})})(G),T(G,N,D,Y),q(U)}function T(Y,N,J,D){Y.text(function(U){var G=U.column.specIndex,$=U.rowNumber,K=U.value,re=typeof K=="string",ne=re&&K.match(/<br>/i),ae=!re||ne;U.mayHaveMarkup=re&&K.match(/[<&>]/);var ie,he=typeof(ie=K)=="string"&&ie.match(t.latexCheck);U.latex=he;var se,de,ce=he?"":k(U.calcdata.cells.prefix,G,$)||"",ve=he?"":k(U.calcdata.cells.suffix,G,$)||"",Ee=he?null:k(U.calcdata.cells.format,G,$)||null,Le=ce+(Ee?p(Ee)(U.value):U.value)+ve;if(U.wrappingNeeded=!U.wrapped&&!ae&&!he&&(se=_(Le)),U.cellHeightMayIncrease=ne||he||U.mayHaveMarkup||(se===void 0?_(Le):se),U.needsConvertToTspans=U.mayHaveMarkup||U.wrappingNeeded||U.latex,U.wrappingNeeded){var Te=(t.wrapSplitCharacter===" "?Le.replace(/<a href=/gi,"<a_href="):Le).split(t.wrapSplitCharacter),xe=t.wrapSplitCharacter===" "?Te.map(function(fe){return fe.replace(/<a_href=/gi,"<a href=")}):Te;U.fragments=xe.map(function(fe){return{text:fe,width:null}}),U.fragments.push({fragment:t.wrapSpacer,width:null}),de=xe.join(t.lineBreaker)+t.lineBreaker+t.wrapSpacer}else delete U.fragments,de=Le;return de}).attr("dy",function(U){return U.needsConvertToTspans?0:"0.75em"}).each(function(U){var G=h.select(this),$=U.wrappingNeeded?P:z;U.needsConvertToTspans?l.convertToTspans(G,D,$(J,this,N,D,U)):h.select(this.parentNode).attr("transform",function(K){return a(F(K),t.cellPad)}).attr("text-anchor",function(K){return{left:"start",center:"middle",right:"end"}[K.align]})})}function _(Y){return Y.indexOf(t.wrapSplitCharacter)!==-1}function k(Y,N,J){if(Array.isArray(Y)){var D=Y[Math.min(N,Y.length-1)];return Array.isArray(D)?D[Math.min(J,D.length-1)]:D}return Y}function E(Y,N,J){Y.transition().ease(t.releaseTransitionEase).duration(t.releaseTransitionDuration).attr("transform",a(N.x,J))}function A(Y){return Y.type==="cells"}function b(Y){return Y.type==="header"}function L(Y){return(Y.rowBlocks.length?Y.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(N,J){return N+X(J,1/0)},0)}function w(Y,N,J){var D=m(N)[0];if(D!==void 0){var U=D.rowBlocks,G=D.calcdata,$=W(U,U.length),K=D.calcdata.groupHeight-L(D),re=G.scrollY=Math.max(0,Math.min($-K,G.scrollY)),ne=function(ae,ie,he){for(var se=[],de=0,ce=0;ce<ae.length;ce++){for(var ve=ae[ce],Ee=ve.rows,Le=0,Te=0;Te<Ee.length;Te++)Le+=Ee[Te].rowHeight;ve.allRowsHeight=Le,ie<de+Le&&ie+he>de&&se.push(ce),de+=Le}return se}(U,re,K);ne.length===1&&(ne[0]===U.length-1?ne.unshift(ne[0]-1):ne.push(ne[0]+1)),ne[0]%2&&ne.reverse(),N.each(function(ae,ie){ae.page=ne[ie],ae.scrollY=re}),N.attr("transform",function(ae){var ie=W(ae.rowBlocks,ae.page)-ae.scrollY;return a(0,ie)}),Y&&(S(Y,J,N,ne,D.prevPages,D,0),S(Y,J,N,ne,D.prevPages,D,1),y(J,Y))}}function C(Y,N,J,D){return function(U){var G=U.calcdata?U.calcdata:U,$=N.filter(function(ae){return G.key===ae.key}),K=J||G.scrollbarState.dragMultiplier,re=G.scrollY;G.scrollY=D===void 0?G.scrollY+K*h.event.dy:D;var ne=$.selectAll("."+t.cn.yColumn).selectAll("."+t.cn.columnBlock).filter(A);return w(Y,ne,$),G.scrollY===re}}function S(Y,N,J,D,U,G,$){D[$]!==U[$]&&(clearTimeout(G.currentRepaint[$]),G.currentRepaint[$]=setTimeout(function(){var K=J.filter(function(re,ne){return ne===$&&D[ne]!==U[ne]});v(Y,N,K,J),U[$]=D[$]}))}function P(Y,N,J,D){return function(){var U=h.select(N.parentNode);U.each(function(G){var $=G.fragments;U.selectAll("tspan.line").each(function(de,ce){$[ce].width=this.getComputedTextLength()});var K,re,ne=$[$.length-1].width,ae=$.slice(0,-1),ie=[],he=0,se=G.column.columnWidth-2*t.cellPad;for(G.value="";ae.length;)he+(re=(K=ae.shift()).width+ne)>se&&(G.value+=ie.join(t.wrapSpacer)+t.lineBreaker,ie=[],he=0),ie.push(K.text),he+=re;he&&(G.value+=ie.join(t.wrapSpacer)),G.wrapped=!0}),U.selectAll("tspan.line").remove(),T(U.select("."+t.cn.cellText),J,Y,D),h.select(N.parentNode.parentNode).call(q)}}function z(Y,N,J,D,U){return function(){if(!U.settledY){var G=h.select(N.parentNode),$=Z(U),K=U.key-$.firstRowIndex,re=$.rows[K].rowHeight,ne=U.cellHeightMayIncrease?N.parentNode.getBoundingClientRect().height+2*t.cellPad:re,ae=Math.max(ne,re);ae-$.rows[K].rowHeight&&($.rows[K].rowHeight=ae,Y.selectAll("."+t.cn.columnCell).call(q),w(null,Y.filter(A),0),y(J,D,!0)),G.attr("transform",function(){var ie=this.parentNode.getBoundingClientRect(),he=h.select(this.parentNode).select("."+t.cn.cellRect).node().getBoundingClientRect(),se=this.transform.baseVal.consolidate(),de=he.top-ie.top+(se?se.matrix.f:t.cellPad);return a(F(U,h.select(this.parentNode).select("."+t.cn.cellTextHolder).node().getBoundingClientRect().width),de)}),U.settledY=!0}}}function F(Y,N){switch(Y.align){case"left":return t.cellPad;case"right":return Y.column.columnWidth-(N||0)-t.cellPad;case"center":return(Y.column.columnWidth-(N||0))/2;default:return t.cellPad}}function q(Y){Y.attr("transform",function(N){var J=N.rowBlocks[0].auxiliaryBlocks.reduce(function(U,G){return U+X(G,1/0)},0),D=X(Z(N),N.key);return a(0,D+J)}).selectAll("."+t.cn.cellRect).attr("height",function(N){return(J=Z(N),D=N.key,J.rows[D-J.firstRowIndex]).rowHeight;var J,D})}function W(Y,N){for(var J=0,D=N-1;D>=0;D--)J+=Q(Y[D]);return J}function X(Y,N){for(var J=0,D=0;D<Y.rows.length&&Y.rows[D].rowIndex<N;D++)J+=Y.rows[D].rowHeight;return J}function Q(Y){var N=Y.allRowsHeight;if(N!==void 0)return N;for(var J=0,D=0;D<Y.rows.length;D++)J+=Y.rows[D].rowHeight;return Y.allRowsHeight=J,J}function Z(Y){return Y.rowBlocks[Y.page]}B.exports=function(Y,N){var J=!Y._context.staticPlot,D=Y._fullLayout._paper.selectAll("."+t.cn.table).data(N.map(function(ve){var Ee=u.unwrap(ve).trace;return s(Y,Ee)}),u.keyFun);D.exit().remove(),D.enter().append("g").classed(t.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),D.attr("width",function(ve){return ve.width+ve.size.l+ve.size.r}).attr("height",function(ve){return ve.height+ve.size.t+ve.size.b}).attr("transform",function(ve){return a(ve.translateX,ve.translateY)});var U=D.selectAll("."+t.cn.tableControlView).data(u.repeat,u.keyFun),G=U.enter().append("g").classed(t.cn.tableControlView,!0).style("box-sizing","content-box");if(J){var $="onwheel"in document?"wheel":"mousewheel";G.on("mousemove",function(ve){U.filter(function(Ee){return ve===Ee}).call(y,Y)}).on($,function(ve){if(!ve.scrollbarState.wheeling){ve.scrollbarState.wheeling=!0;var Ee=ve.scrollY+h.event.deltaY;C(Y,U,null,Ee)(ve)||(h.event.stopPropagation(),h.event.preventDefault()),ve.scrollbarState.wheeling=!1}}).call(y,Y,!0)}U.attr("transform",function(ve){return a(ve.size.l,ve.size.t)});var K=U.selectAll("."+t.cn.scrollBackground).data(u.repeat,u.keyFun);K.enter().append("rect").classed(t.cn.scrollBackground,!0).attr("fill","none"),K.attr("width",function(ve){return ve.width}).attr("height",function(ve){return ve.height}),U.each(function(ve){e.setClipUrl(h.select(this),d(Y,ve),Y)});var re=U.selectAll("."+t.cn.yColumn).data(function(ve){return ve.columns},u.keyFun);re.enter().append("g").classed(t.cn.yColumn,!0),re.exit().remove(),re.attr("transform",function(ve){return a(ve.x,0)}),J&&re.call(h.behavior.drag().origin(function(ve){return E(h.select(this),ve,-t.uplift),o(this),ve.calcdata.columnDragInProgress=!0,y(U.filter(function(Ee){return ve.calcdata.key===Ee.key}),Y),ve}).on("drag",function(ve){var Ee=h.select(this),Le=function(Te){return(ve===Te?h.event.x:Te.x)+Te.columnWidth/2};ve.x=Math.max(-t.overdrag,Math.min(ve.calcdata.width+t.overdrag-ve.columnWidth,h.event.x)),m(re).filter(function(Te){return Te.calcdata.key===ve.calcdata.key}).sort(function(Te,xe){return Le(Te)-Le(xe)}).forEach(function(Te,xe){Te.xIndex=xe,Te.x=ve===Te?Te.x:Te.xScale(Te)}),re.filter(function(Te){return ve!==Te}).transition().ease(t.transitionEase).duration(t.transitionDuration).attr("transform",function(Te){return a(Te.x,0)}),Ee.call(n).attr("transform",a(ve.x,-t.uplift))}).on("dragend",function(ve){var Ee=h.select(this),Le=ve.calcdata;ve.x=ve.xScale(ve),ve.calcdata.columnDragInProgress=!1,E(Ee,ve,0),function(Te,xe,fe){var ge=xe.gdColumnsOriginalOrder;xe.gdColumns.sort(function(ke,Me){return fe[ge.indexOf(ke)]-fe[ge.indexOf(Me)]}),xe.columnorder=fe,Te.emit("plotly_restyle")}(Y,Le,Le.columns.map(function(Te){return Te.xIndex}))})),re.each(function(ve){e.setClipUrl(h.select(this),g(Y,ve),Y)});var ne=re.selectAll("."+t.cn.columnBlock).data(r.splitToPanels,u.keyFun);ne.enter().append("g").classed(t.cn.columnBlock,!0).attr("id",function(ve){return ve.key}),ne.style("cursor",function(ve){return ve.dragHandle?"ew-resize":ve.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var ae=ne.filter(b),ie=ne.filter(A);J&&ie.call(h.behavior.drag().origin(function(ve){return h.event.stopPropagation(),ve}).on("drag",C(Y,U,-1)).on("dragend",function(){})),v(Y,U,ae,ne),v(Y,U,ie,ne);var he=U.selectAll("."+t.cn.scrollAreaClip).data(u.repeat,u.keyFun);he.enter().append("clipPath").classed(t.cn.scrollAreaClip,!0).attr("id",function(ve){return d(Y,ve)});var se=he.selectAll("."+t.cn.scrollAreaClipRect).data(u.repeat,u.keyFun);se.enter().append("rect").classed(t.cn.scrollAreaClipRect,!0).attr("x",-t.overdrag).attr("y",-t.uplift).attr("fill","none"),se.attr("width",function(ve){return ve.width+2*t.overdrag}).attr("height",function(ve){return ve.height+t.uplift}),re.selectAll("."+t.cn.columnBoundary).data(u.repeat,u.keyFun).enter().append("g").classed(t.cn.columnBoundary,!0);var de=re.selectAll("."+t.cn.columnBoundaryClippath).data(u.repeat,u.keyFun);de.enter().append("clipPath").classed(t.cn.columnBoundaryClippath,!0),de.attr("id",function(ve){return g(Y,ve)});var ce=de.selectAll("."+t.cn.columnBoundaryRect).data(u.repeat,u.keyFun);ce.enter().append("rect").classed(t.cn.columnBoundaryRect,!0).attr("fill","none"),ce.attr("width",function(ve){return ve.columnWidth+2*f(ve)}).attr("height",function(ve){return ve.calcdata.height+2*f(ve)+t.uplift}).attr("x",function(ve){return-f(ve)}).attr("y",function(ve){return-f(ve)}),w(null,ie,U)}},{"../../components/color":666,"../../components/drawing":688,"../../lib":803,"../../lib/gup":800,"../../lib/svg_text_utils":829,"./constants":1350,"./data_preparation_helper":1351,"./data_split_helpers":1352,"@plotly/d3":58}],1356:[function(i,B,V){var t=i("../../plots/template_attributes").hovertemplateAttrs,h=i("../../plots/template_attributes").texttemplateAttrs,p=i("../../components/colorscale/attributes"),u=i("../../plots/domain").attributes,e=i("../pie/attributes"),l=i("../sunburst/attributes"),o=i("./constants"),a=i("../../lib/extend").extendFlat;B.exports={labels:l.labels,parents:l.parents,values:l.values,branchvalues:l.branchvalues,count:l.count,level:l.level,maxdepth:l.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:a({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:l.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:l.marker.line,editType:"calc"},p("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:a({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:l.textinfo,texttemplate:h({editType:"plot"},{keys:o.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:l.hoverinfo,hovertemplate:t({},{keys:o.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:a({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:l.root,domain:u({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plots/domain":882,"../../plots/template_attributes":926,"../pie/attributes":1192,"../sunburst/attributes":1330,"./constants":1359}],1357:[function(i,B,V){var t=i("../../plots/plots");V.name="treemap",V.plot=function(h,p,u,e){t.plotBasePlot(V.name,h,p,u,e)},V.clean=function(h,p,u,e){t.cleanBasePlot(V.name,h,p,u,e)}},{"../../plots/plots":917}],1358:[function(i,B,V){var t=i("../sunburst/calc");V.calc=function(h,p){return t.calc(h,p)},V.crossTraceCalc=function(h){return t._runCrossTraceCalc("treemap",h)}},{"../sunburst/calc":1332}],1359:[function(i,B,V){B.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1360:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("../../components/color"),u=i("../../plots/domain").defaults,e=i("../bar/defaults").handleText,l=i("../bar/constants").TEXTPAD,o=i("../../components/colorscale"),a=o.hasColorscale,n=o.handleDefaults;B.exports=function(s,r,c,f){function d(A,b){return t.coerce(s,r,h,A,b)}var g=d("labels"),m=d("parents");if(g&&g.length&&m&&m.length){var y=d("values");y&&y.length?d("branchvalues"):d("count"),d("level"),d("maxdepth"),d("tiling.packing")==="squarify"&&d("tiling.squarifyratio"),d("tiling.flip"),d("tiling.pad");var v=d("text");d("texttemplate"),r.texttemplate||d("textinfo",Array.isArray(v)?"text+label":"label"),d("hovertext"),d("hovertemplate");var T=d("pathbar.visible");e(s,r,f,d,"auto",{hasPathbar:T,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),d("textposition");var _=r.textposition.indexOf("bottom")!==-1;d("marker.line.width")&&d("marker.line.color",f.paper_bgcolor);var k=d("marker.colors");(r._hasColorscale=a(s,"marker","colors")||(s.marker||{}).coloraxis)?n(s,r,f,d,{prefix:"marker.",cLetter:"c"}):d("marker.depthfade",!(k||[]).length);var E=2*r.textfont.size;d("marker.pad.t",_?E/4:E),d("marker.pad.l",E/4),d("marker.pad.r",E/4),d("marker.pad.b",_?E:E/4),r._hovered={marker:{line:{width:2,color:p.contrast(f.paper_bgcolor)}}},T&&(d("pathbar.thickness",r.pathbar.textfont.size+2*l),d("pathbar.side"),d("pathbar.edgeshape")),d("sort"),d("root.color"),u(r,f,d),r._length=null}else r.visible=!1}},{"../../components/color":666,"../../components/colorscale":678,"../../lib":803,"../../plots/domain":882,"../bar/constants":943,"../bar/defaults":945,"./attributes":1356}],1361:[function(i,B,V){var t=i("@plotly/d3"),h=i("../sunburst/helpers"),p=i("../bar/uniform_text").clearMinTextSize,u=i("../bar/style").resizeText,e=i("./plot_one");B.exports=function(l,o,a,n,s){var r,c,f=s.type,d=s.drawDescendants,g=l._fullLayout,m=g["_"+f+"layer"],y=!a;p(f,g),(r=m.selectAll("g.trace."+f).data(o,function(v){return v[0].trace.uid})).enter().append("g").classed("trace",!0).classed(f,!0),r.order(),!g.uniformtext.mode&&h.hasTransition(a)?(n&&(c=n()),t.transition().duration(a.duration).ease(a.easing).each("end",function(){c&&c()}).each("interrupt",function(){c&&c()}).each(function(){m.selectAll("g.trace").each(function(v){e(l,v,this,a,d)})})):(r.each(function(v){e(l,v,this,a,d)}),g.uniformtext.mode&&u(l,m.selectAll(".trace"),f)),y&&r.exit().remove()}},{"../bar/style":955,"../bar/uniform_text":957,"../sunburst/helpers":1336,"./plot_one":1370,"@plotly/d3":58}],1362:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../components/drawing"),u=i("../../lib/svg_text_utils"),e=i("./partition"),l=i("./style").styleOne,o=i("./constants"),a=i("../sunburst/helpers"),n=i("../sunburst/fx");B.exports=function(s,r,c,f,d){var g=d.barDifY,m=d.width,y=d.height,v=d.viewX,T=d.viewY,_=d.pathSlice,k=d.toMoveInsideSlice,E=d.strTransform,A=d.hasTransition,b=d.handleSlicesExit,L=d.makeUpdateSliceInterpolator,w=d.makeUpdateTextInterpolator,C={},S=s._fullLayout,P=r[0],z=P.trace,F=P.hierarchy,q=m/z._entryDepth,W=a.listPath(c.data,"id"),X=e(F.copy(),[m,y],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(X=X.filter(function(Z){var Y=W.indexOf(Z.data.id);return Y!==-1&&(Z.x0=q*Y,Z.x1=q*(Y+1),Z.y0=g,Z.y1=g+y,Z.onPathbar=!0,!0)})).reverse(),(f=f.data(X,a.getPtId)).enter().append("g").classed("pathbar",!0),b(f,!0,C,[m,y],_),f.order();var Q=f;A&&(Q=Q.transition().each("end",function(){var Z=t.select(this);a.setSliceCursor(Z,s,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),Q.each(function(Z){Z._hoverX=v(Z.x1-Math.min(m,y)/2),Z._hoverY=T(Z.y1-y/2);var Y=t.select(this),N=h.ensureSingle(Y,"path","surface",function(G){G.style("pointer-events","all")});A?N.transition().attrTween("d",function(G){var $=L(G,!0,C,[m,y]);return function(K){return _($(K))}}):N.attr("d",_),Y.call(n,c,s,r,{styleOne:l,eventDataKeys:o.eventDataKeys,transitionTime:o.CLICK_TRANSITION_TIME,transitionEasing:o.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,s,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:s._transitioning}),N.call(l,Z,z,{hovered:!1}),Z._text=(a.getPtLabel(Z)||"").split("<br>").join(" ")||"";var J=h.ensureSingle(Y,"g","slicetext"),D=h.ensureSingle(J,"text","",function(G){G.attr("data-notex",1)}),U=h.ensureUniformFontSize(s,a.determineTextFont(z,Z,S.font,{onPathbar:!0}));D.text(Z._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(p.font,U).call(u.convertToTspans,s),Z.textBB=p.bBox(D.node()),Z.transform=k(Z,{fontSize:U.size,onPathbar:!0}),Z.transform.fontSize=U.size,A?D.transition().attrTween("transform",function(G){var $=w(G,!0,C,[m,y]);return function(K){return E($(K))}}):D.attr("transform",E(Z))})}},{"../../components/drawing":688,"../../lib":803,"../../lib/svg_text_utils":829,"../sunburst/fx":1335,"../sunburst/helpers":1336,"./constants":1359,"./partition":1368,"./style":1371,"@plotly/d3":58}],1363:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../components/drawing"),u=i("../../lib/svg_text_utils"),e=i("./partition"),l=i("./style").styleOne,o=i("./constants"),a=i("../sunburst/helpers"),n=i("../sunburst/fx"),s=i("../sunburst/plot").formatSliceLabel;B.exports=function(r,c,f,d,g){var m=g.width,y=g.height,v=g.viewX,T=g.viewY,_=g.pathSlice,k=g.toMoveInsideSlice,E=g.strTransform,A=g.hasTransition,b=g.handleSlicesExit,L=g.makeUpdateSliceInterpolator,w=g.makeUpdateTextInterpolator,C=g.prevEntry,S=r._fullLayout,P=c[0].trace,z=P.textposition.indexOf("left")!==-1,F=P.textposition.indexOf("right")!==-1,q=P.textposition.indexOf("bottom")!==-1,W=!q&&!P.marker.pad.t||q&&!P.marker.pad.b,X=e(f,[m,y],{packing:P.tiling.packing,squarifyratio:P.tiling.squarifyratio,flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1,pad:{inner:P.tiling.pad,top:P.marker.pad.t,left:P.marker.pad.l,right:P.marker.pad.r,bottom:P.marker.pad.b}}).descendants(),Q=1/0,Z=-1/0;X.forEach(function(U){var G=U.depth;G>=P._maxDepth?(U.x0=U.x1=(U.x0+U.x1)/2,U.y0=U.y1=(U.y0+U.y1)/2):(Q=Math.min(Q,G),Z=Math.max(Z,G))}),d=d.data(X,a.getPtId),P._maxVisibleLayers=isFinite(Z)?Z-Q+1:0,d.enter().append("g").classed("slice",!0),b(d,!1,{},[m,y],_),d.order();var Y=null;if(A&&C){var N=a.getPtId(C);d.each(function(U){Y===null&&a.getPtId(U)===N&&(Y={x0:U.x0,x1:U.x1,y0:U.y0,y1:U.y1})})}var J=function(){return Y||{x0:0,x1:m,y0:0,y1:y}},D=d;return A&&(D=D.transition().each("end",function(){var U=t.select(this);a.setSliceCursor(U,r,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),D.each(function(U){var G=a.isHeader(U,P);U._hoverX=v(U.x1-P.marker.pad.r),U._hoverY=T(q?U.y1-P.marker.pad.b/2:U.y0+P.marker.pad.t/2);var $=t.select(this),K=h.ensureSingle($,"path","surface",function(ie){ie.style("pointer-events","all")});A?K.transition().attrTween("d",function(ie){var he=L(ie,!1,J(),[m,y]);return function(se){return _(he(se))}}):K.attr("d",_),$.call(n,f,r,c,{styleOne:l,eventDataKeys:o.eventDataKeys,transitionTime:o.CLICK_TRANSITION_TIME,transitionEasing:o.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,r,{isTransitioning:r._transitioning}),K.call(l,U,P,{hovered:!1}),U.x0===U.x1||U.y0===U.y1?U._text="":U._text=G?W?"":a.getPtLabel(U)||"":s(U,f,P,c,S)||"";var re=h.ensureSingle($,"g","slicetext"),ne=h.ensureSingle(re,"text","",function(ie){ie.attr("data-notex",1)}),ae=h.ensureUniformFontSize(r,a.determineTextFont(P,U,S.font));ne.text(U._text||" ").classed("slicetext",!0).attr("text-anchor",F?"end":z||G?"start":"middle").call(p.font,ae).call(u.convertToTspans,r),U.textBB=p.bBox(ne.node()),U.transform=k(U,{fontSize:ae.size,isHeader:G}),U.transform.fontSize=ae.size,A?ne.transition().attrTween("transform",function(ie){var he=w(ie,!1,J(),[m,y]);return function(se){return E(he(se))}}):ne.attr("transform",E(U))}),Y}},{"../../components/drawing":688,"../../lib":803,"../../lib/svg_text_utils":829,"../sunburst/fx":1335,"../sunburst/helpers":1336,"../sunburst/plot":1340,"./constants":1359,"./partition":1368,"./style":1371,"@plotly/d3":58}],1364:[function(i,B,V){B.exports=function t(h,p,u){var e;u.swapXY&&(e=h.x0,h.x0=h.y0,h.y0=e,e=h.x1,h.x1=h.y1,h.y1=e),u.flipX&&(e=h.x0,h.x0=p[0]-h.x1,h.x1=p[0]-e),u.flipY&&(e=h.y0,h.y0=p[1]-h.y1,h.y1=p[1]-e);var l=h.children;if(l)for(var o=0;o<l.length;o++)t(l[o],p,u)}},{}],1365:[function(i,B,V){B.exports={moduleType:"trace",name:"treemap",basePlotModule:i("./base_plot"),categories:[],animatable:!0,attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyDefaults:i("./defaults"),supplyLayoutDefaults:i("./layout_defaults"),calc:i("./calc").calc,crossTraceCalc:i("./calc").crossTraceCalc,plot:i("./plot"),style:i("./style").style,colorbar:i("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1236,"./attributes":1356,"./base_plot":1357,"./calc":1358,"./defaults":1360,"./layout_attributes":1366,"./layout_defaults":1367,"./plot":1369,"./style":1371}],1366:[function(i,B,V){B.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1367:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes");B.exports=function(p,u){function e(l,o){return t.coerce(p,u,h,l,o)}e("treemapcolorway",u.colorway),e("extendtreemapcolors")}},{"../../lib":803,"./layout_attributes":1366}],1368:[function(i,B,V){var t=i("d3-hierarchy"),h=i("./flip_tree");B.exports=function(p,u,e){var l,o=e.flipX,a=e.flipY,n=e.packing==="dice-slice",s=e.pad[a?"bottom":"top"],r=e.pad[o?"right":"left"],c=e.pad[o?"left":"right"],f=e.pad[a?"top":"bottom"];n&&(l=r,r=s,s=l,l=c,c=f,f=l);var d=t.treemap().tile(function(g,m){switch(g){case"squarify":return t.treemapSquarify.ratio(m);case"binary":return t.treemapBinary;case"dice":return t.treemapDice;case"slice":return t.treemapSlice;default:return t.treemapSliceDice}}(e.packing,e.squarifyratio)).paddingInner(e.pad.inner).paddingLeft(r).paddingRight(c).paddingTop(s).paddingBottom(f).size(n?[u[1],u[0]]:u)(p);return(n||o||a)&&h(d,u,{swapXY:n,flipX:o,flipY:a}),d}},{"./flip_tree":1364,"d3-hierarchy":170}],1369:[function(i,B,V){var t=i("./draw"),h=i("./draw_descendants");B.exports=function(p,u,e,l){return t(p,u,e,l,{type:"treemap",drawDescendants:h})}},{"./draw":1361,"./draw_descendants":1363}],1370:[function(i,B,V){var t=i("@plotly/d3"),h=i("d3-interpolate").interpolate,p=i("../sunburst/helpers"),u=i("../../lib"),e=i("../bar/constants").TEXTPAD,l=i("../bar/plot").toMoveInsideBar,o=i("../bar/uniform_text").recordMinTextSize,a=i("./constants"),n=i("./draw_ancestors");function s(r){return p.isHierarchyRoot(r)?"":p.getPtId(r)}B.exports=function(r,c,f,d,g){var m=r._fullLayout,y=c[0],v=y.trace,T=v.type==="icicle",_=y.hierarchy,k=p.findEntryWithLevel(_,v.level),E=t.select(f),A=E.selectAll("g.pathbar"),b=E.selectAll("g.slice");if(!k)return A.remove(),void b.remove();var L=p.isHierarchyRoot(k),w=!m.uniformtext.mode&&p.hasTransition(d),C=p.getMaxDepth(v),S=m._size,P=v.domain,z=S.w*(P.x[1]-P.x[0]),F=S.h*(P.y[1]-P.y[0]),q=z,W=v.pathbar.thickness,X=v.marker.line.width+a.gapWithPathbar,Q=v.pathbar.visible?v.pathbar.side.indexOf("bottom")>-1?F+X:-(W+X):0,Z={x0:q,x1:q,y0:Q,y1:Q+W},Y=function(Se,De,Be){var We=v.tiling.pad,Qe=function(Ye){return Ye-We<=De.x0},Oe=function(Ye){return Ye+We>=De.x1},Ue=function(Ye){return Ye-We<=De.y0},Xe=function(Ye){return Ye+We>=De.y1};return Se.x0===De.x0&&Se.x1===De.x1&&Se.y0===De.y0&&Se.y1===De.y1?{x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1}:{x0:Qe(Se.x0-We)?0:Oe(Se.x0-We)?Be[0]:Se.x0,x1:Qe(Se.x1+We)?0:Oe(Se.x1+We)?Be[0]:Se.x1,y0:Ue(Se.y0-We)?0:Xe(Se.y0-We)?Be[1]:Se.y0,y1:Ue(Se.y1+We)?0:Xe(Se.y1+We)?Be[1]:Se.y1}},N=null,J={},D={},U=null,G=function(Se,De){return De?J[s(Se)]:D[s(Se)]},$=function(Se,De,Be,We){if(De)return J[s(_)]||Z;var Qe=D[v.level]||Be;return function(Oe){return Oe.data.depth-k.data.depth<C}(Se)?Y(Se,Qe,We):{}};y.hasMultipleRoots&&L&&C++,v._maxDepth=C,v._backgroundColor=m.paper_bgcolor,v._entryDepth=k.data.depth,v._atRootLevel=L;var K=-z/2+S.l+S.w*(P.x[1]+P.x[0])/2,re=-F/2+S.t+S.h*(1-(P.y[1]+P.y[0])/2),ne=function(Se){return K+Se},ae=function(Se){return re+Se},ie=ae(0),he=ne(0),se=function(Se){return he+Se},de=function(Se){return ie+Se};function ce(Se,De){return Se+","+De}var ve=se(0),Ee=function(Se){Se.x=Math.max(ve,Se.x)},Le=v.pathbar.edgeshape,Te=function(Se,De){var Be=Se.x0,We=Se.x1,Qe=Se.y0,Oe=Se.y1,Ue=Se.textBB,Xe=function(Mt){return v.textposition.indexOf(Mt)!==-1},Ye=Xe("bottom"),$e=Xe("top")||De.isHeader&&!Ye?"start":Ye?"end":"middle",it=Xe("right"),ot=Xe("left")||De.onPathbar?-1:it?1:0,Et=v[T?"tiling":"marker"].pad;if(De.isHeader){if((Be+=(T?Et:Et.l)-e)>=(We-=(T?Et:Et.r)-e)){var mt=(Be+We)/2;Be=mt,We=mt}var tt;Ye?Qe<(tt=Oe-(T?Et:Et.b))&&tt<Oe&&(Qe=tt):Qe<(tt=Qe+(T?Et:Et.t))&&tt<Oe&&(Oe=tt)}var Ke=l(Be,We,Qe,Oe,Ue,{isHorizontal:!1,constrained:!0,angle:0,anchor:$e,leftToRight:ot});return Ke.fontSize=De.fontSize,Ke.targetX=ne(Ke.targetX),Ke.targetY=ae(Ke.targetY),isNaN(Ke.targetX)||isNaN(Ke.targetY)?{}:(Be!==We&&Qe!==Oe&&o(v.type,Ke,m),{scale:Ke.scale,rotate:Ke.rotate,textX:Ke.textX,textY:Ke.textY,anchorX:Ke.anchorX,anchorY:Ke.anchorY,targetX:Ke.targetX,targetY:Ke.targetY})},xe=function(Se,De){for(var Be,We=0,Qe=Se;!Be&&We<C;)We++,(Qe=Qe.parent)?Be=G(Qe,De):We=C;return Be||{}},fe=function(Se,De,Be,We,Qe){var Oe,Ue=G(Se,De);if(Ue)Oe=Ue;else if(De)Oe=Z;else if(N)if(Se.parent){var Xe=U||Be;Xe&&!De?Oe=Y(Se,Xe,We):(Oe={},u.extendFlat(Oe,xe(Se,De)))}else Oe=u.extendFlat({},Se),T&&(Qe.orientation==="h"?Qe.flipX?Oe.x0=Se.x1:Oe.x1=0:Qe.flipY?Oe.y0=Se.y1:Oe.y1=0);else Oe={};return h(Oe,{x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1})},ge=function(Se,De,Be,We){var Qe=G(Se,De),Oe={},Ue=$(Se,De,Be,We);u.extendFlat(Oe,{transform:Te({x0:Ue.x0,x1:Ue.x1,y0:Ue.y0,y1:Ue.y1,textBB:Se.textBB,_text:Se._text},{isHeader:p.isHeader(Se,v)})}),Qe?Oe=Qe:Se.parent&&u.extendFlat(Oe,xe(Se,De));var Xe=Se.transform;return Se.x0!==Se.x1&&Se.y0!==Se.y1&&o(v.type,Xe,m),h(Oe,{transform:{scale:Xe.scale,rotate:Xe.rotate,textX:Xe.textX,textY:Xe.textY,anchorX:Xe.anchorX,anchorY:Xe.anchorY,targetX:Xe.targetX,targetY:Xe.targetY}})},ke=function(Se,De,Be,We,Qe){var Oe=We[0],Ue=We[1];w?Se.exit().transition().each(function(){var Xe=t.select(this);Xe.select("path.surface").transition().attrTween("d",function(Ye){var $e=function(it,ot,Et,mt){var tt,Ke=G(it,ot);if(ot)tt=Z;else{var Mt=G(k,ot);tt=Mt?Y(it,Mt,mt):{}}return h(Ke,tt)}(Ye,De,0,[Oe,Ue]);return function(it){return Qe($e(it))}}),Xe.select("g.slicetext").attr("opacity",0)}).remove():Se.exit().remove()},Me=function(Se){var De=Se.transform;return Se.x0!==Se.x1&&Se.y0!==Se.y1&&o(v.type,De,m),u.getTextTransform({textX:De.textX,textY:De.textY,anchorX:De.anchorX,anchorY:De.anchorY,targetX:De.targetX,targetY:De.targetY,scale:De.scale,rotate:De.rotate})};w&&(A.each(function(Se){J[s(Se)]={x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1},Se.transform&&(J[s(Se)].transform={textX:Se.transform.textX,textY:Se.transform.textY,anchorX:Se.transform.anchorX,anchorY:Se.transform.anchorY,targetX:Se.transform.targetX,targetY:Se.transform.targetY,scale:Se.transform.scale,rotate:Se.transform.rotate})}),b.each(function(Se){D[s(Se)]={x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1},Se.transform&&(D[s(Se)].transform={textX:Se.transform.textX,textY:Se.transform.textY,anchorX:Se.transform.anchorX,anchorY:Se.transform.anchorY,targetX:Se.transform.targetX,targetY:Se.transform.targetY,scale:Se.transform.scale,rotate:Se.transform.rotate}),!N&&p.isEntry(Se)&&(N=Se)})),U=g(r,c,k,b,{width:z,height:F,viewX:ne,viewY:ae,pathSlice:function(Se){var De=ne(Se.x0),Be=ne(Se.x1),We=ae(Se.y0),Qe=ae(Se.y1),Oe=Be-De,Ue=Qe-We;return!Oe||!Ue?"":"M"+ce(De,We+0)+"L"+ce(Be-0,We)+"L"+ce(Be,Qe-0)+"L"+ce(De+0,Qe)+"Z"},toMoveInsideSlice:Te,prevEntry:N,makeUpdateSliceInterpolator:fe,makeUpdateTextInterpolator:ge,handleSlicesExit:ke,hasTransition:w,strTransform:Me}),v.pathbar.visible?n(r,c,k,A,{barDifY:Q,width:q,height:W,viewX:se,viewY:de,pathSlice:function(Se){var De=se(Math.max(Math.min(Se.x0,Se.x0),0)),Be=se(Math.min(Math.max(Se.x1,Se.x1),q)),We=de(Se.y0),Qe=de(Se.y1),Oe=W/2,Ue={},Xe={};Ue.x=De,Xe.x=Be,Ue.y=Xe.y=(We+Qe)/2;var Ye={x:De,y:We},$e={x:Be,y:We},it={x:Be,y:Qe},ot={x:De,y:Qe};return Le===">"?(Ye.x-=Oe,$e.x-=Oe,it.x-=Oe,ot.x-=Oe):Le==="/"?(it.x-=Oe,ot.x-=Oe,Ue.x-=Oe/2,Xe.x-=Oe/2):Le==="\\"?(Ye.x-=Oe,$e.x-=Oe,Ue.x-=Oe/2,Xe.x-=Oe/2):Le==="<"&&(Ue.x-=Oe,Xe.x-=Oe),Ee(Ye),Ee(ot),Ee(Ue),Ee($e),Ee(it),Ee(Xe),"M"+ce(Ye.x,Ye.y)+"L"+ce($e.x,$e.y)+"L"+ce(Xe.x,Xe.y)+"L"+ce(it.x,it.y)+"L"+ce(ot.x,ot.y)+"L"+ce(Ue.x,Ue.y)+"Z"},toMoveInsideSlice:Te,makeUpdateSliceInterpolator:fe,makeUpdateTextInterpolator:ge,handleSlicesExit:ke,hasTransition:w,strTransform:Me}):A.remove()}},{"../../lib":803,"../bar/constants":943,"../bar/plot":952,"../bar/uniform_text":957,"../sunburst/helpers":1336,"./constants":1359,"./draw_ancestors":1362,"@plotly/d3":58,"d3-interpolate":171}],1371:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/color"),p=i("../../lib"),u=i("../sunburst/helpers"),e=i("../bar/uniform_text").resizeText;function l(o,a,n,s){var r,c,f=(s||{}).hovered,d=a.data.data,g=d.i,m=d.color,y=u.isHierarchyRoot(a),v=1;if(f)r=n._hovered.marker.line.color,c=n._hovered.marker.line.width;else if(y&&m===n.root.color)v=100,r="rgba(0,0,0,0)",c=0;else if(r=p.castOption(n,g,"marker.line.color")||h.defaultLine,c=p.castOption(n,g,"marker.line.width")||0,!n._hasColorscale&&!a.onPathbar){var T=n.marker.depthfade;if(T){var _,k=h.combine(h.addOpacity(n._backgroundColor,.75),m);if(T===!0){var E=u.getMaxDepth(n);_=isFinite(E)?u.isLeaf(a)?0:n._maxVisibleLayers-(a.data.depth-n._entryDepth):a.data.height+1}else _=a.data.depth-n._entryDepth,n._atRootLevel||_++;if(_>0)for(var A=0;A<_;A++){var b=.5*A/_;m=h.combine(h.addOpacity(k,b),m)}}}o.style("stroke-width",c).call(h.fill,m).call(h.stroke,r).style("opacity",v)}B.exports={style:function(o){var a=o._fullLayout._treemaplayer.selectAll(".trace");e(o,a,"treemap"),a.each(function(n){var s=t.select(this),r=n[0].trace;s.style("opacity",r.opacity),s.selectAll("path.surface").each(function(c){t.select(this).call(l,c,r,{hovered:!1})})})},styleOne:l}},{"../../components/color":666,"../../lib":803,"../bar/uniform_text":957,"../sunburst/helpers":1336,"@plotly/d3":58}],1372:[function(i,B,V){var t=i("../box/attributes"),h=i("../../lib/extend").extendFlat,p=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat;B.exports={y:t.y,x:t.x,x0:t.x0,y0:t.y0,xhoverformat:p("x"),yhoverformat:p("y"),name:h({},t.name,{}),orientation:h({},t.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:t.fillcolor,points:h({},t.boxpoints,{}),jitter:h({},t.jitter,{}),pointpos:h({},t.pointpos,{}),width:h({},t.width,{}),marker:t.marker,text:t.text,hovertext:t.hovertext,hovertemplate:t.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:t.selected,unselected:t.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":793,"../../plots/cartesian/axis_format_attributes":857,"../box/attributes":966}],1373:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes"),p=i("../box/calc"),u=i("./helpers"),e=i("../../constants/numerical").BADNUM;function l(a,n,s){var r=n.max-n.min;if(!r)return a.bandwidth?a.bandwidth:0;if(a.bandwidth)return Math.max(a.bandwidth,r/1e4);var c=s.length,f=t.stdev(s,c-1,n.mean);return Math.max(function(d,g,m){return 1.059*Math.min(g,m/1.349)*Math.pow(d,-.2)}(c,f,n.q3-n.q1),r/100)}function o(a,n,s,r){var c,f=a.spanmode,d=a.span||[],g=[n.min,n.max],m=[n.min-2*r,n.max+2*r];function y(T){var _=d[T],k=s.type==="multicategory"?s.r2c(_):s.d2c(_,0,a[n.valLetter+"calendar"]);return k===e?m[T]:k}var v={type:"linear",range:c=f==="soft"?m:f==="hard"?g:[y(0),y(1)]};return h.setConvert(v),v.cleanRange(),c}B.exports=function(a,n){var s=p(a,n);if(s[0].t.empty)return s;for(var r=a._fullLayout,c=h.getFromId(a,n[n.orientation==="h"?"xaxis":"yaxis"]),f=1/0,d=-1/0,g=0,m=0,y=0;y<s.length;y++){var v=s[y],T=v.pts.map(u.extractVal),_=v.bandwidth=l(n,v,T),k=v.span=o(n,v,c,_);if(v.min===v.max&&_===0)k=v.span=[v.min,v.max],v.density=[{v:1,t:k[0]}],v.bandwidth=_,g=Math.max(g,1);else{var E=k[1]-k[0],A=Math.ceil(E/(_/3)),b=E/A;if(!isFinite(b)||!isFinite(A))return t.error("Something went wrong with computing the violin span"),s[0].t.empty=!0,s;var L=u.makeKDE(v,n,T);v.density=new Array(A);for(var w=0,C=k[0];C<k[1]+b/2;w++,C+=b){var S=L(C);v.density[w]={v:S,t:C},g=Math.max(g,S)}}m=Math.max(m,T.length),f=Math.min(f,k[0]),d=Math.max(d,k[1])}var P=h.findExtremes(c,[f,d],{padded:!0});if(n._extremes[c._id]=P,n.width)s[0].t.maxKDE=g;else{var z=r._violinScaleGroupStats,F=n.scalegroup,q=z[F];q?(q.maxKDE=Math.max(q.maxKDE,g),q.maxCount=Math.max(q.maxCount,m)):z[F]={maxKDE:g,maxCount:m}}return s[0].t.labels.kde=t._(a,"kde:"),s}},{"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/axes":854,"../box/calc":967,"./helpers":1376}],1374:[function(i,B,V){var t=i("../box/cross_trace_calc").setPositionOffset,h=["v","h"];B.exports=function(p,u){for(var e=p.calcdata,l=u.xaxis,o=u.yaxis,a=0;a<h.length;a++){for(var n=h[a],s=n==="h"?o:l,r=[],c=0;c<e.length;c++){var f=e[c],d=f[0].t,g=f[0].trace;g.visible!==!0||g.type!=="violin"||d.empty||g.orientation!==n||g.xaxis!==l._id||g.yaxis!==o._id||r.push(c)}t("violin",p,r,s)}}},{"../box/cross_trace_calc":968}],1375:[function(i,B,V){var t=i("../../lib"),h=i("../../components/color"),p=i("../box/defaults"),u=i("./attributes");B.exports=function(e,l,o,a){function n(E,A){return t.coerce(e,l,u,E,A)}function s(E,A){return t.coerce2(e,l,u,E,A)}if(p.handleSampleDefaults(e,l,n,a),l.visible!==!1){n("bandwidth"),n("side"),n("width")||(n("scalegroup",l.name),n("scalemode"));var r,c=n("span");Array.isArray(c)&&(r="manual"),n("spanmode",r);var f=n("line.color",(e.marker||{}).color||o),d=n("line.width"),g=n("fillcolor",h.addOpacity(l.line.color,.5));p.handlePointsDefaults(e,l,n,{prefix:""});var m=s("box.width"),y=s("box.fillcolor",g),v=s("box.line.color",f),T=s("box.line.width",d);n("box.visible",!!(m||y||v||T))||(l.box={visible:!1});var _=s("meanline.color",f),k=s("meanline.width",d);n("meanline.visible",!!(_||k))||(l.meanline={visible:!1})}}},{"../../components/color":666,"../../lib":803,"../box/defaults":969,"./attributes":1372}],1376:[function(i,B,V){var t=i("../../lib"),h=function(p){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*p*p)};V.makeKDE=function(p,u,e){var l=e.length,o=h,a=p.bandwidth,n=1/(l*a);return function(s){for(var r=0,c=0;c<l;c++)r+=o((s-e[c])/a);return n*r}},V.getPositionOnKdePath=function(p,u,e){var l,o;u.orientation==="h"?(l="y",o="x"):(l="x",o="y");var a=t.findPointOnPath(p.path,e,o,{pathLength:p.pathLength}),n=p.posCenterPx,s=a[l];return[s,u.side==="both"?2*n-s:n]},V.getKdeValue=function(p,u,e){var l=p.pts.map(V.extractVal);return V.makeKDE(p,u,l)(e)/p.posDensityScale},V.extractVal=function(p){return p.v}},{"../../lib":803}],1377:[function(i,B,V){var t=i("../../lib"),h=i("../../plots/cartesian/axes"),p=i("../box/hover"),u=i("./helpers");B.exports=function(e,l,o,a,n){n||(n={});var s,r,c=n.hoverLayer,f=e.cd,d=f[0].trace,g=d.hoveron,m=g.indexOf("violins")!==-1,y=g.indexOf("kde")!==-1,v=[];if(m||y){var T=p.hoverOnBoxes(e,l,o,a);if(y&&T.length>0){var _,k,E,A,b,L=e.xa,w=e.ya;d.orientation==="h"?(b=l,_="y",E=w,k="x",A=L):(b=o,_="x",E=L,k="y",A=w);var C=f[e.index];if(b>=C.span[0]&&b<=C.span[1]){var S=t.extendFlat({},e),P=A.c2p(b,!0),z=u.getKdeValue(C,d,b),F=u.getPositionOnKdePath(C,d,P),q=E._offset,W=E._length;S[_+"0"]=F[0],S[_+"1"]=F[1],S[k+"0"]=S[k+"1"]=P,S[k+"Label"]=k+": "+h.hoverLabelText(A,b,d[k+"hoverformat"])+", "+f[0].t.labels.kde+" "+z.toFixed(3),S.spikeDistance=T[0].spikeDistance;var X=_+"Spike";S[X]=T[0][X],T[0].spikeDistance=void 0,T[0][X]=void 0,S.hovertemplate=!1,v.push(S),(r={stroke:e.color})[_+"1"]=t.constrain(q+F[0],q,q+W),r[_+"2"]=t.constrain(q+F[1],q,q+W),r[k+"1"]=r[k+"2"]=A._offset+P}}m&&(v=v.concat(T))}g.indexOf("points")!==-1&&(s=p.hoverOnPoints(e,l,o));var Q=c.selectAll(".violinline-"+d.uid).data(r?[0]:[]);return Q.enter().append("line").classed("violinline-"+d.uid,!0).attr("stroke-width",1.5),Q.exit().remove(),Q.attr(r),a==="closest"?s?[s]:v:(s&&v.push(s),v)}},{"../../lib":803,"../../plots/cartesian/axes":854,"../box/hover":971,"./helpers":1376}],1378:[function(i,B,V){B.exports={attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyDefaults:i("./defaults"),crossTraceDefaults:i("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:i("./layout_defaults"),calc:i("./calc"),crossTraceCalc:i("./cross_trace_calc"),plot:i("./plot"),style:i("./style"),styleOnSelect:i("../scatter/style").styleOnSelect,hoverPoints:i("./hover"),selectPoints:i("../box/select"),moduleType:"trace",name:"violin",basePlotModule:i("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":868,"../box/defaults":969,"../box/select":976,"../scatter/style":1242,"./attributes":1372,"./calc":1373,"./cross_trace_calc":1374,"./defaults":1375,"./hover":1377,"./layout_attributes":1379,"./layout_defaults":1380,"./plot":1381,"./style":1382}],1379:[function(i,B,V){var t=i("../box/layout_attributes"),h=i("../../lib").extendFlat;B.exports={violinmode:h({},t.boxmode,{}),violingap:h({},t.boxgap,{}),violingroupgap:h({},t.boxgroupgap,{})}},{"../../lib":803,"../box/layout_attributes":973}],1380:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes"),p=i("../box/layout_defaults");B.exports=function(u,e,l){p._supply(u,e,l,function(o,a){return t.coerce(u,e,h,o,a)},"violin")}},{"../../lib":803,"../box/layout_defaults":974,"./layout_attributes":1379}],1381:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../components/drawing"),u=i("../box/plot"),e=i("../scatter/line_points"),l=i("./helpers");B.exports=function(o,a,n,s){var r=o._fullLayout,c=a.xaxis,f=a.yaxis;function d(g){var m=e(g,{xaxis:c,yaxis:f,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return p.smoothopen(m[0],1)}h.makeTraceGroups(s,n,"trace violins").each(function(g){var m=t.select(this),y=g[0],v=y.t,T=y.trace;if(T.visible!==!0||v.empty)m.remove();else{var _=v.bPos,k=v.bdPos,E=a[v.valLetter+"axis"],A=a[v.posLetter+"axis"],b=T.side==="both",L=b||T.side==="positive",w=b||T.side==="negative",C=m.selectAll("path.violin").data(h.identity);C.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),C.exit().remove(),C.each(function(Q){var Z,Y,N,J,D,U,G,$,K=t.select(this),re=Q.density,ne=re.length,ae=A.c2l(Q.pos+_,!0),ie=A.l2p(ae);if(T.width)Z=v.maxKDE/k;else{var he=r._violinScaleGroupStats[T.scalegroup];Z=T.scalemode==="count"?he.maxKDE/k*(he.maxCount/Q.pts.length):he.maxKDE/k}if(L){for(G=new Array(ne),D=0;D<ne;D++)($=G[D]={})[v.posLetter]=ae+re[D].v/Z,$[v.valLetter]=E.c2l(re[D].t,!0);Y=d(G)}if(w){for(G=new Array(ne),U=0,D=ne-1;U<ne;U++,D--)($=G[U]={})[v.posLetter]=ae-re[D].v/Z,$[v.valLetter]=E.c2l(re[D].t,!0);N=d(G)}if(b)J=Y+"L"+N.substr(1)+"Z";else{var se=[ie,E.c2p(re[0].t)],de=[ie,E.c2p(re[ne-1].t)];T.orientation==="h"&&(se.reverse(),de.reverse()),J=L?"M"+se+"L"+Y.substr(1)+"L"+de:"M"+de+"L"+N.substr(1)+"L"+se}K.attr("d",J),Q.posCenterPx=ie,Q.posDensityScale=Z*k,Q.path=K.node(),Q.pathLength=Q.path.getTotalLength()/(b?2:1)});var S,P,z,F=T.box,q=F.width,W=(F.line||{}).width;b?(S=k*q,P=0):L?(S=[0,k*q/2],P=W*{x:1,y:-1}[v.posLetter]):(S=[k*q/2,0],P=W*{x:-1,y:1}[v.posLetter]),u.plotBoxAndWhiskers(m,{pos:A,val:E},T,{bPos:_,bdPos:S,bPosPxOffset:P}),u.plotBoxMean(m,{pos:A,val:E},T,{bPos:_,bdPos:S,bPosPxOffset:P}),!T.box.visible&&T.meanline.visible&&(z=h.identity);var X=m.selectAll("path.meanline").data(z||[]);X.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),X.exit().remove(),X.each(function(Q){var Z=E.c2p(Q.mean,!0),Y=l.getPositionOnKdePath(Q,T,Z);t.select(this).attr("d",T.orientation==="h"?"M"+Z+","+Y[0]+"V"+Y[1]:"M"+Y[0]+","+Z+"H"+Y[1])}),u.plotPoints(m,{x:c,y:f},T,v)}})}},{"../../components/drawing":688,"../../lib":803,"../box/plot":975,"../scatter/line_points":1232,"./helpers":1376,"@plotly/d3":58}],1382:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/color"),p=i("../scatter/style").stylePoints;B.exports=function(u){var e=t.select(u).selectAll("g.trace.violins");e.style("opacity",function(l){return l[0].trace.opacity}),e.each(function(l){var o=l[0].trace,a=t.select(this),n=o.box||{},s=n.line||{},r=o.meanline||{},c=r.width;a.selectAll("path.violin").style("stroke-width",o.line.width+"px").call(h.stroke,o.line.color).call(h.fill,o.fillcolor),a.selectAll("path.box").style("stroke-width",s.width+"px").call(h.stroke,s.color).call(h.fill,n.fillcolor);var f={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};a.selectAll("path.mean").style(f).call(h.stroke,r.color),a.selectAll("path.meanline").style(f).call(h.stroke,r.color),p(a,o,u)})}},{"../../components/color":666,"../scatter/style":1242,"@plotly/d3":58}],1383:[function(i,B,V){var t=i("../../components/colorscale/attributes"),h=i("../isosurface/attributes"),p=i("../surface/attributes"),u=i("../../plots/attributes"),e=i("../../lib/extend").extendFlat,l=i("../../plot_api/edit_types").overrideAll,o=B.exports=l(e({x:h.x,y:h.y,z:h.z,value:h.value,isomin:h.isomin,isomax:h.isomax,surface:h.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:h.slices,caps:h.caps,text:h.text,hovertext:h.hovertext,xhoverformat:h.xhoverformat,yhoverformat:h.yhoverformat,zhoverformat:h.zhoverformat,valuehoverformat:h.valuehoverformat,hovertemplate:h.hovertemplate},t("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:h.colorbar,opacity:h.opacity,opacityscale:p.opacityscale,lightposition:h.lightposition,lighting:h.lighting,flatshading:h.flatshading,contour:h.contour,hoverinfo:e({},u.hoverinfo),showlegend:e({},u.showlegend,{dflt:!1})}),"calc","nested");o.x.editType=o.y.editType=o.z.editType=o.value.editType="calc+clearAxisTypes",o.transforms=void 0},{"../../components/colorscale/attributes":673,"../../lib/extend":793,"../../plot_api/edit_types":836,"../../plots/attributes":850,"../isosurface/attributes":1154,"../surface/attributes":1342}],1384:[function(i,B,V){var t=i("gl-mesh3d"),h=i("../../lib/gl_format_color").parseColorScale,p=i("../../lib/str2rgbarray"),u=i("../../components/colorscale").extractOpts,e=i("../../plots/gl3d/zip3"),l=i("../isosurface/convert").findNearestOnAxis,o=i("../isosurface/convert").generateIsoMeshes;function a(s,r,c){this.scene=s,this.uid=c,this.mesh=r,this.name="",this.data=null,this.showContour=!1}var n=a.prototype;n.handlePick=function(s){if(s.object===this.mesh){var r=s.data.index,c=this.data._meshX[r],f=this.data._meshY[r],d=this.data._meshZ[r],g=this.data._Ys.length,m=this.data._Zs.length,y=l(c,this.data._Xs).id,v=l(f,this.data._Ys).id,T=l(d,this.data._Zs).id,_=s.index=T+m*v+m*g*y;s.traceCoordinate=[this.data._meshX[_],this.data._meshY[_],this.data._meshZ[_],this.data._value[_]];var k=this.data.hovertext||this.data.text;return Array.isArray(k)&&k[_]!==void 0?s.textLabel=k[_]:k&&(s.textLabel=k),!0}},n.update=function(s){var r=this.scene,c=r.fullSceneLayout;function f(m,y,v,T){return y.map(function(_){return m.d2l(_,0,T)*v})}this.data=o(s);var d={positions:e(f(c.xaxis,s._meshX,r.dataScale[0],s.xcalendar),f(c.yaxis,s._meshY,r.dataScale[1],s.ycalendar),f(c.zaxis,s._meshZ,r.dataScale[2],s.zcalendar)),cells:e(s._meshI,s._meshJ,s._meshK),lightPosition:[s.lightposition.x,s.lightposition.y,s.lightposition.z],ambient:s.lighting.ambient,diffuse:s.lighting.diffuse,specular:s.lighting.specular,roughness:s.lighting.roughness,fresnel:s.lighting.fresnel,vertexNormalsEpsilon:s.lighting.vertexnormalsepsilon,faceNormalsEpsilon:s.lighting.facenormalsepsilon,opacity:s.opacity,opacityscale:s.opacityscale,contourEnable:s.contour.show,contourColor:p(s.contour.color).slice(0,3),contourWidth:s.contour.width,useFacetNormals:s.flatshading},g=u(s);d.vertexIntensity=s._meshIntensity,d.vertexIntensityBounds=[g.min,g.max],d.colormap=h(s),this.mesh.update(d)},n.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},B.exports=function(s,r){var c=s.glplot.gl,f=t({gl:c}),d=new a(s,f,r.uid);return f._trace=d,d.update(r),s.glplot.add(f),d}},{"../../components/colorscale":678,"../../lib/gl_format_color":799,"../../lib/str2rgbarray":828,"../../plots/gl3d/zip3":907,"../isosurface/convert":1156,"gl-mesh3d":315}],1385:[function(i,B,V){var t=i("../../lib"),h=i("./attributes"),p=i("../isosurface/defaults").supplyIsoDefaults,u=i("../surface/defaults").opacityscaleDefaults;B.exports=function(e,l,o,a){function n(s,r){return t.coerce(e,l,h,s,r)}p(e,l,o,a,n),u(e,l,a,n)}},{"../../lib":803,"../isosurface/defaults":1157,"../surface/defaults":1345,"./attributes":1383}],1386:[function(i,B,V){B.exports={attributes:i("./attributes"),supplyDefaults:i("./defaults"),calc:i("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:i("./convert"),moduleType:"trace",name:"volume",basePlotModule:i("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":896,"../isosurface/calc":1155,"./attributes":1383,"./convert":1384,"./defaults":1385}],1387:[function(i,B,V){var t=i("../bar/attributes"),h=i("../scatter/attributes").line,p=i("../../plots/attributes"),u=i("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=i("../../plots/template_attributes").hovertemplateAttrs,l=i("../../plots/template_attributes").texttemplateAttrs,o=i("./constants"),a=i("../../lib/extend").extendFlat,n=i("../../components/color");function s(r){return{marker:{color:a({},t.marker.color,{arrayOk:!1,editType:"style"}),line:{color:a({},t.marker.line.color,{arrayOk:!1,editType:"style"}),width:a({},t.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}B.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:u("x"),yhoverformat:u("y"),hovertext:t.hovertext,hovertemplate:e({},{keys:o.eventDataKeys}),hoverinfo:a({},p.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:l({editType:"plot"},{keys:o.eventDataKeys.concat(["label"])}),text:t.text,textposition:t.textposition,insidetextanchor:t.insidetextanchor,textangle:t.textangle,textfont:t.textfont,insidetextfont:t.insidetextfont,outsidetextfont:t.outsidetextfont,constraintext:t.constraintext,cliponaxis:t.cliponaxis,orientation:t.orientation,offset:t.offset,width:t.width,increasing:s(),decreasing:s(),totals:s(),connector:{line:{color:a({},h.color,{dflt:n.defaultLine}),width:a({},h.width,{editType:"plot"}),dash:h.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup}},{"../../components/color":666,"../../lib/extend":793,"../../plots/attributes":850,"../../plots/cartesian/axis_format_attributes":857,"../../plots/template_attributes":926,"../bar/attributes":941,"../scatter/attributes":1218,"./constants":1389}],1388:[function(i,B,V){var t=i("../../plots/cartesian/axes"),h=i("../../plots/cartesian/align_period"),p=i("../../lib").mergeArray,u=i("../scatter/calc_selection"),e=i("../../constants/numerical").BADNUM;function l(a){return a==="a"||a==="absolute"}function o(a){return a==="t"||a==="total"}B.exports=function(a,n){var s,r,c,f,d,g,m=t.getFromId(a,n.xaxis||"x"),y=t.getFromId(a,n.yaxis||"y");n.orientation==="h"?(s=m.makeCalcdata(n,"x"),c=y.makeCalcdata(n,"y"),f=h(n,y,"y",c),d=!!n.yperiodalignment,g="y"):(s=y.makeCalcdata(n,"y"),c=m.makeCalcdata(n,"x"),f=h(n,m,"x",c),d=!!n.xperiodalignment,g="x"),r=f.vals;for(var v,T=Math.min(r.length,s.length),_=new Array(T),k=0,E=!1,A=0;A<T;A++){var b=s[A]||0,L=!1;(s[A]!==e||o(n.measure[A])||l(n.measure[A]))&&A+1<T&&(s[A+1]!==e||o(n.measure[A+1])||l(n.measure[A+1]))&&(L=!0);var w=_[A]={i:A,p:r[A],s:b,rawS:b,cNext:L};l(n.measure[A])?(k=w.s,w.isSum=!0,w.dir="totals",w.s=k):o(n.measure[A])?(w.isSum=!0,w.dir="totals",w.s=k):(w.isSum=!1,w.dir=w.rawS<0?"decreasing":"increasing",v=w.s,w.s=k+v,k+=v),w.dir==="totals"&&(E=!0),d&&(_[A].orig_p=c[A],_[A][g+"End"]=f.ends[A],_[A][g+"Start"]=f.starts[A]),n.ids&&(w.id=String(n.ids[A])),w.v=(n.base||0)+k}return _.length&&(_[0].hasTotals=E),p(n.text,_,"tx"),p(n.hovertext,_,"htx"),u(_,n),_}},{"../../constants/numerical":779,"../../lib":803,"../../plots/cartesian/align_period":851,"../../plots/cartesian/axes":854,"../scatter/calc_selection":1220}],1389:[function(i,B,V){B.exports={eventDataKeys:["initial","delta","final"]}},{}],1390:[function(i,B,V){var t=i("../bar/cross_trace_calc").setGroupPositions;B.exports=function(h,p){var u,e,l=h._fullLayout,o=h._fullData,a=h.calcdata,n=p.xaxis,s=p.yaxis,r=[],c=[],f=[];for(e=0;e<o.length;e++){var d=o[e];d.visible===!0&&d.xaxis===n._id&&d.yaxis===s._id&&d.type==="waterfall"&&(u=a[e],d.orientation==="h"?f.push(u):c.push(u),r.push(u))}var g={mode:l.waterfallmode,norm:l.waterfallnorm,gap:l.waterfallgap,groupgap:l.waterfallgroupgap};for(t(h,n,s,c,g),t(h,s,n,f,g),e=0;e<r.length;e++){u=r[e];for(var m=0;m<u.length;m++){var y=u[m];y.isSum===!1&&(y.s0+=m===0?0:u[m-1].s),m+1<u.length&&(u[m].nextP0=u[m+1].p0,u[m].nextS0=u[m+1].s0)}}}},{"../bar/cross_trace_calc":944}],1391:[function(i,B,V){var t=i("../../lib"),h=i("../bar/defaults").handleGroupingDefaults,p=i("../bar/defaults").handleText,u=i("../scatter/xy_defaults"),e=i("../scatter/period_defaults"),l=i("./attributes"),o=i("../../components/color"),a=i("../../constants/delta.js"),n=a.INCREASING.COLOR,s=a.DECREASING.COLOR;function r(c,f,d){c(f+".marker.color",d),c(f+".marker.line.color",o.defaultLine),c(f+".marker.line.width")}B.exports={supplyDefaults:function(c,f,d,g){function m(v,T){return t.coerce(c,f,l,v,T)}if(u(c,f,g,m)){e(c,f,g,m),m("xhoverformat"),m("yhoverformat"),m("measure"),m("orientation",f.x&&!f.y?"h":"v"),m("base"),m("offset"),m("width"),m("text"),m("hovertext"),m("hovertemplate");var y=m("textposition");p(c,f,g,m,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),f.textposition!=="none"&&(m("texttemplate"),f.texttemplate||m("textinfo")),r(m,"increasing",n),r(m,"decreasing",s),r(m,"totals","#4499FF"),m("connector.visible")&&(m("connector.mode"),m("connector.line.width")&&(m("connector.line.color"),m("connector.line.dash")))}else f.visible=!1},crossTraceDefaults:function(c,f){var d,g;function m(v){return t.coerce(g._input,g,l,v)}if(f.waterfallmode==="group")for(var y=0;y<c.length;y++)d=(g=c[y])._input,h(d,g,f,m)}}},{"../../components/color":666,"../../constants/delta.js":773,"../../lib":803,"../bar/defaults":945,"../scatter/period_defaults":1238,"../scatter/xy_defaults":1245,"./attributes":1387}],1392:[function(i,B,V){B.exports=function(t,h){return t.x="xVal"in h?h.xVal:h.x,t.y="yVal"in h?h.yVal:h.y,"initial"in h&&(t.initial=h.initial),"delta"in h&&(t.delta=h.delta),"final"in h&&(t.final=h.final),h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),t}},{}],1393:[function(i,B,V){var t=i("../../plots/cartesian/axes").hoverLabelText,h=i("../../components/color").opacity,p=i("../bar/hover").hoverOnBars,u=i("../../constants/delta.js"),e=u.INCREASING.SYMBOL,l=u.DECREASING.SYMBOL;B.exports=function(o,a,n,s,r){var c=p(o,a,n,s,r);if(c){var f=c.cd,d=f[0].trace,g=d.orientation==="h",m=g?"x":"y",y=g?o.xa:o.ya,v=f[c.index],T=v.isSum?v.b+v.s:v.rawS;if(!v.isSum){c.initial=v.b+v.s-T,c.delta=T,c.final=c.initial+c.delta;var _=w(Math.abs(c.delta));c.deltaLabel=T<0?"("+_+")":_,c.finalLabel=w(c.final),c.initialLabel=w(c.initial)}var k=v.hi||d.hoverinfo,E=[];if(k&&k!=="none"&&k!=="skip"){var A=k==="all",b=k.split("+"),L=function(C){return A||b.indexOf(C)!==-1};v.isSum||(!L("final")||L(g?"x":"y")||E.push(c.finalLabel),L("delta")&&(T<0?E.push(c.deltaLabel+" "+l):E.push(c.deltaLabel+" "+e)),L("initial")&&E.push("Initial: "+c.initialLabel))}return E.length&&(c.extraText=E.join("<br>")),c.color=function(C,S){var P=C[S.dir].marker,z=P.color,F=P.line.color,q=P.line.width;if(h(z))return z;if(h(F)&&q)return F}(d,v),[c]}function w(C){return t(y,C,d[m+"hoverformat"])}}},{"../../components/color":666,"../../constants/delta.js":773,"../../plots/cartesian/axes":854,"../bar/hover":948}],1394:[function(i,B,V){B.exports={attributes:i("./attributes"),layoutAttributes:i("./layout_attributes"),supplyDefaults:i("./defaults").supplyDefaults,crossTraceDefaults:i("./defaults").crossTraceDefaults,supplyLayoutDefaults:i("./layout_defaults"),calc:i("./calc"),crossTraceCalc:i("./cross_trace_calc"),plot:i("./plot"),style:i("./style").style,hoverPoints:i("./hover"),eventData:i("./event_data"),selectPoints:i("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:i("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":868,"../bar/select":953,"./attributes":1387,"./calc":1388,"./cross_trace_calc":1390,"./defaults":1391,"./event_data":1392,"./hover":1393,"./layout_attributes":1395,"./layout_defaults":1396,"./plot":1397,"./style":1398}],1395:[function(i,B,V){B.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1396:[function(i,B,V){var t=i("../../lib"),h=i("./layout_attributes");B.exports=function(p,u,e){var l=!1;function o(s,r){return t.coerce(p,u,h,s,r)}for(var a=0;a<e.length;a++){var n=e[a];if(n.visible&&n.type==="waterfall"){l=!0;break}}l&&(o("waterfallmode"),o("waterfallgap",.2),o("waterfallgroupgap"))}},{"../../lib":803,"./layout_attributes":1395}],1397:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../lib"),p=i("../../components/drawing"),u=i("../../constants/numerical").BADNUM,e=i("../bar/plot"),l=i("../bar/uniform_text").clearMinTextSize;B.exports=function(o,a,n,s){var r=o._fullLayout;l("waterfall",r),e.plot(o,a,n,s,{mode:r.waterfallmode,norm:r.waterfallmode,gap:r.waterfallgap,groupgap:r.waterfallgroupgap}),function(c,f,d,g){var m=f.xaxis,y=f.yaxis;h.makeTraceGroups(g,d,"trace bars").each(function(v){var T=t.select(this),_=v[0].trace,k=h.ensureSingle(T,"g","lines");if(_.connector&&_.connector.visible){var E=_.orientation==="h",A=_.connector.mode,b=k.selectAll("g.line").data(h.identity);b.enter().append("g").classed("line",!0),b.exit().remove();var L=b.size();b.each(function(w,C){if(C===L-1||w.cNext){var S=function(q,W,X,Q){var Z=[],Y=[],N=Q?W:X,J=Q?X:W;return Z[0]=N.c2p(q.s0,!0),Y[0]=J.c2p(q.p0,!0),Z[1]=N.c2p(q.s1,!0),Y[1]=J.c2p(q.p1,!0),Z[2]=N.c2p(q.nextS0,!0),Y[2]=J.c2p(q.nextP0,!0),Q?[Z,Y]:[Y,Z]}(w,m,y,E),P=S[0],z=S[1],F="";P[0]!==u&&z[0]!==u&&P[1]!==u&&z[1]!==u&&(A==="spanning"&&!w.isSum&&C>0&&(F+=E?"M"+P[0]+","+z[1]+"V"+z[0]:"M"+P[1]+","+z[0]+"H"+P[0]),A!=="between"&&(w.isSum||C<L-1)&&(F+=E?"M"+P[1]+","+z[0]+"V"+z[1]:"M"+P[0]+","+z[1]+"H"+P[1]),P[2]!==u&&z[2]!==u&&(F+=E?"M"+P[1]+","+z[1]+"V"+z[2]:"M"+P[1]+","+z[1]+"H"+P[2])),F===""&&(F="M0,0Z"),h.ensureSingle(t.select(this),"path").attr("d",F).call(p.setClipUrl,f.layerClipId,c)}})}else k.remove()})}(o,a,n,s)}},{"../../components/drawing":688,"../../constants/numerical":779,"../../lib":803,"../bar/plot":952,"../bar/uniform_text":957,"@plotly/d3":58}],1398:[function(i,B,V){var t=i("@plotly/d3"),h=i("../../components/drawing"),p=i("../../components/color"),u=i("../../constants/interactions").DESELECTDIM,e=i("../bar/style"),l=i("../bar/uniform_text").resizeText,o=e.styleTextPoints;B.exports={style:function(a,n,s){var r=s||t.select(a).selectAll("g.waterfalllayer").selectAll("g.trace");l(a,r,"waterfall"),r.style("opacity",function(c){return c[0].trace.opacity}),r.each(function(c){var f=t.select(this),d=c[0].trace;f.selectAll(".point > path").each(function(g){if(!g.isBlank){var m=d[g.dir].marker;t.select(this).call(p.fill,m.color).call(p.stroke,m.line.color).call(h.dashLine,m.line.dash,m.line.width).style("opacity",d.selectedpoints&&!g.selected?u:1)}}),o(f,d,a),f.selectAll(".lines").each(function(){var g=d.connector.line;h.lineGroupStyle(t.select(this).selectAll("path"),g.width,g.color,g.dash)})})}}},{"../../components/color":666,"../../components/drawing":688,"../../constants/interactions":778,"../bar/style":955,"../bar/uniform_text":957,"@plotly/d3":58}],1399:[function(i,B,V){var t=i("../plots/cartesian/axes"),h=i("../lib"),p=i("../plot_api/plot_schema"),u=i("./helpers").pointsAccessorFunction,e=i("../constants/numerical").BADNUM;V.moduleType="transform",V.name="aggregate";var l=V.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},o=l.aggregations;function a(c,f,d,g){if(g.enabled){for(var m=g.target,y=h.nestedProperty(f,m),v=y.get(),T=function(E,A){var b=E.func,L=A.d2c,w=A.c2d;switch(b){case"count":return n;case"first":return s;case"last":return r;case"sum":return function(C,S){for(var P=0,z=0;z<S.length;z++){var F=L(C[S[z]]);F!==e&&(P+=F)}return w(P)};case"avg":return function(C,S){for(var P=0,z=0,F=0;F<S.length;F++){var q=L(C[S[F]]);q!==e&&(P+=q,z++)}return z?w(P/z):e};case"min":return function(C,S){for(var P=1/0,z=0;z<S.length;z++){var F=L(C[S[z]]);F!==e&&(P=Math.min(P,F))}return P===1/0?e:w(P)};case"max":return function(C,S){for(var P=-1/0,z=0;z<S.length;z++){var F=L(C[S[z]]);F!==e&&(P=Math.max(P,F))}return P===-1/0?e:w(P)};case"range":return function(C,S){for(var P=1/0,z=-1/0,F=0;F<S.length;F++){var q=L(C[S[F]]);q!==e&&(P=Math.min(P,q),z=Math.max(z,q))}return z===-1/0||P===1/0?e:w(z-P)};case"change":return function(C,S){var P=L(C[S[0]]),z=L(C[S[S.length-1]]);return P===e||z===e?e:w(z-P)};case"median":return function(C,S){for(var P=[],z=0;z<S.length;z++){var F=L(C[S[z]]);F!==e&&P.push(F)}if(!P.length)return e;P.sort(h.sorterAsc);var q=(P.length-1)/2;return w((P[Math.floor(q)]+P[Math.ceil(q)])/2)};case"mode":return function(C,S){for(var P={},z=0,F=e,q=0;q<S.length;q++){var W=L(C[S[q]]);if(W!==e){var X=P[W]=(P[W]||0)+1;X>z&&(z=X,F=W)}}return z?w(F):e};case"rms":return function(C,S){for(var P=0,z=0,F=0;F<S.length;F++){var q=L(C[S[F]]);q!==e&&(P+=q*q,z++)}return z?w(Math.sqrt(P/z)):e};case"stddev":return function(C,S){var P,z=0,F=0,q=1,W=e;for(P=0;P<S.length&&W===e;P++)W=L(C[S[P]]);if(W===e)return e;for(;P<S.length;P++){var X=L(C[S[P]]);if(X!==e){var Q=X-W;z+=Q,F+=Q*Q,q++}}var Z=E.funcmode==="sample"?q-1:q;return Z?Math.sqrt((F-z*z/q)/Z):0}}}(g,t.getDataConversions(c,f,m,v)),_=new Array(d.length),k=0;k<d.length;k++)_[k]=T(v,d[k]);y.set(_),g.func==="count"&&h.pushUnique(f._arrayAttrs,m)}}function n(c,f){return f.length}function s(c,f){return c[f[0]]}function r(c,f){return c[f[f.length-1]]}V.supplyDefaults=function(c,f){var d,g={};function m(w,C){return h.coerce(c,g,l,w,C)}if(!m("enabled"))return g;var y=p.findArrayAttributes(f),v={};for(d=0;d<y.length;d++)v[y[d]]=1;var T=m("groups");if(!Array.isArray(T)){if(!v[T])return g.enabled=!1,g;v[T]=0}var _,k=c.aggregations||[],E=g.aggregations=new Array(k.length);function A(w,C){return h.coerce(k[d],_,o,w,C)}for(d=0;d<k.length;d++){_={_index:d};var b=A("target"),L=A("func");A("enabled")&&b&&(v[b]||L==="count"&&v[b]===void 0)?(L==="stddev"&&A("funcmode"),v[b]=0,E[d]=_):E[d]={enabled:!1,_index:d}}for(d=0;d<y.length;d++)v[y[d]]&&E.push({target:y[d],func:o.func.dflt,enabled:!0,_index:-1});return g},V.calcTransform=function(c,f,d){if(d.enabled){var g=d.groups,m=h.getTargetArray(f,{target:g});if(m){var y,v,T,_,k={},E={},A=[],b=u(f.transforms,d),L=m.length;for(f._length&&(L=Math.min(L,f._length)),y=0;y<L;y++)(T=k[v=m[y]])===void 0?(k[v]=A.length,_=[y],A.push(_),E[k[v]]=b(y)):(A[T].push(y),E[k[v]]=(E[k[v]]||[]).concat(b(y)));d._indexToPoints=E;var w=d.aggregations;for(y=0;y<w.length;y++)a(c,f,A,w[y]);typeof g=="string"&&a(c,f,A,{target:g,func:"first",enabled:!0}),f._length=A.length}}}},{"../constants/numerical":779,"../lib":803,"../plot_api/plot_schema":842,"../plots/cartesian/axes":854,"./helpers":1402}],1400:[function(i,B,V){var t=i("../lib"),h=i("../registry"),p=i("../plots/cartesian/axes"),u=i("./helpers").pointsAccessorFunction,e=i("../constants/filter_ops"),l=e.COMPARISON_OPS,o=e.INTERVAL_OPS,a=e.SET_OPS;V.moduleType="transform",V.name="filter",V.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(l).concat(o).concat(a),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},V.supplyDefaults=function(n){var s={};function r(d,g){return t.coerce(n,s,V.attributes,d,g)}if(r("enabled")){var c=r("target");if(t.isArrayOrTypedArray(c)&&c.length===0)return s.enabled=!1,s;r("preservegaps"),r("operation"),r("value");var f=h.getComponentMethod("calendars","handleDefaults");f(n,s,"valuecalendar",null),f(n,s,"targetcalendar",null)}return s},V.calcTransform=function(n,s,r){if(r.enabled){var c=t.getTargetArray(s,r);if(c){var f=r.target,d=c.length;s._length&&(d=Math.min(d,s._length));var g=r.targetcalendar,m=s._arrayAttrs,y=r.preservegaps;if(typeof f=="string"){var v=t.nestedProperty(s,f+"calendar").get();v&&(g=v)}var T,_,k=function(S,P,z){var F=S.operation,q=S.value,W=Array.isArray(q);function X(N){return N.indexOf(F)!==-1}var Q,Z=function(N){return P(N,0,S.valuecalendar)},Y=function(N){return P(N,0,z)};switch(X(l)?Q=Z(W?q[0]:q):X(o)?Q=W?[Z(q[0]),Z(q[1])]:[Z(q),Z(q)]:X(a)&&(Q=W?q.map(Z):[Z(q)]),F){case"=":return function(N){return Y(N)===Q};case"!=":return function(N){return Y(N)!==Q};case"<":return function(N){return Y(N)<Q};case"<=":return function(N){return Y(N)<=Q};case">":return function(N){return Y(N)>Q};case">=":return function(N){return Y(N)>=Q};case"[]":return function(N){var J=Y(N);return J>=Q[0]&&J<=Q[1]};case"()":return function(N){var J=Y(N);return J>Q[0]&&J<Q[1]};case"[)":return function(N){var J=Y(N);return J>=Q[0]&&J<Q[1]};case"(]":return function(N){var J=Y(N);return J>Q[0]&&J<=Q[1]};case"][":return function(N){var J=Y(N);return J<=Q[0]||J>=Q[1]};case")(":return function(N){var J=Y(N);return J<Q[0]||J>Q[1]};case"](":return function(N){var J=Y(N);return J<=Q[0]||J>Q[1]};case")[":return function(N){var J=Y(N);return J<Q[0]||J>=Q[1]};case"{}":return function(N){return Q.indexOf(Y(N))!==-1};case"}{":return function(N){return Q.indexOf(Y(N))===-1}}}(r,p.getDataToCoordFunc(n,s,f,c),g),E={},A={},b=0;y?(T=function(S){E[S.astr]=t.extendDeep([],S.get()),S.set(new Array(d))},_=function(S,P){var z=E[S.astr][P];S.get()[P]=z}):(T=function(S){E[S.astr]=t.extendDeep([],S.get()),S.set([])},_=function(S,P){var z=E[S.astr][P];S.get().push(z)}),C(T);for(var L=u(s.transforms,r),w=0;w<d;w++)k(c[w])?(C(_,w),A[b++]=L(w)):y&&b++;r._indexToPoints=A,s._length=b}}function C(S,P){for(var z=0;z<m.length;z++)S(t.nestedProperty(s,m[z]),P)}}},{"../constants/filter_ops":775,"../lib":803,"../plots/cartesian/axes":854,"../registry":931,"./helpers":1402}],1401:[function(i,B,V){var t=i("../lib"),h=i("../plot_api/plot_schema"),p=i("../plots/plots"),u=i("./helpers").pointsAccessorFunction;function e(l,o){var a,n,s,r,c,f,d,g,m,y,v=o.transform,T=o.transformIndex,_=l.transforms[T].groups,k=u(l.transforms,v);if(!t.isArrayOrTypedArray(_)||_.length===0)return[l];var E=t.filterUnique(_),A=new Array(E.length),b=_.length,L=h.findArrayAttributes(l),w=v.styles||[],C={};for(a=0;a<w.length;a++)C[w[a].target]=w[a].value;v.styles&&(y=t.keyedContainer(v,"styles","target","value.name"));var S={},P={};for(a=0;a<E.length;a++){S[f=E[a]]=a,P[f]=0,(d=A[a]=t.extendDeepNoArrays({},l))._group=f,d.transforms[T]._indexToPoints={};var z=null;for(y&&(z=y.get(f)),d.name=z||z===""?z:t.templateString(v.nameformat,{trace:l.name,group:f}),g=d.transforms,d.transforms=[],n=0;n<g.length;n++)d.transforms[n]=t.extendDeepNoArrays({},g[n]);for(n=0;n<L.length;n++)t.nestedProperty(d,L[n]).set([])}for(s=0;s<L.length;s++){for(r=L[s],n=0,m=[];n<E.length;n++)m[n]=t.nestedProperty(A[n],r).get();for(c=t.nestedProperty(l,r).get(),n=0;n<b;n++)m[S[_[n]]].push(c[n])}for(n=0;n<b;n++)(d=A[S[_[n]]]).transforms[T]._indexToPoints[P[_[n]]]=k(n),P[_[n]]++;for(a=0;a<E.length;a++)f=E[a],d=A[a],p.clearExpandedTraceDefaultColors(d),d=t.extendDeepNoArrays(d,C[f]||{});return A}V.moduleType="transform",V.name="groupby",V.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},V.supplyDefaults=function(l,o,a){var n,s={};function r(m,y){return t.coerce(l,s,V.attributes,m,y)}if(!r("enabled"))return s;r("groups"),r("nameformat",a._dataLength>1?"%{group} (%{trace})":"%{group}");var c=l.styles,f=s.styles=[];if(c)for(n=0;n<c.length;n++){var d=f[n]={};t.coerce(c[n],f[n],V.attributes.styles,"target");var g=t.coerce(c[n],f[n],V.attributes.styles,"value");t.isPlainObject(g)?d.value=t.extendDeep({},g):g&&delete d.value}return s},V.transform=function(l,o){var a,n,s,r=[];for(n=0;n<l.length;n++)for(a=e(l[n],o),s=0;s<a.length;s++)r.push(a[s]);return r}},{"../lib":803,"../plot_api/plot_schema":842,"../plots/plots":917,"./helpers":1402}],1402:[function(i,B,V){V.pointsAccessorFunction=function(t,h){for(var p,u,e=0;e<t.length&&(p=t[e])!==h;e++)p._indexToPoints&&p.enabled!==!1&&(u=p._indexToPoints);return u?function(l){return u[l]}:function(l){return[l]}}},{}],1403:[function(i,B,V){var t=i("../lib"),h=i("../plots/cartesian/axes"),p=i("./helpers").pointsAccessorFunction,u=i("../constants/numerical").BADNUM;V.moduleType="transform",V.name="sort",V.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},V.supplyDefaults=function(e){var l={};function o(a,n){return t.coerce(e,l,V.attributes,a,n)}return o("enabled")&&(o("target"),o("order")),l},V.calcTransform=function(e,l,o){if(o.enabled){var a=t.getTargetArray(l,o);if(a){var n=o.target,s=a.length;l._length&&(s=Math.min(s,l._length));var r,c,f=l._arrayAttrs,d=function(_,k,E,A){var b,L=new Array(A),w=new Array(A);for(b=0;b<A;b++)L[b]={v:k[b],i:b};for(L.sort(function(C,S){switch(C.order){case"ascending":return function(P,z){var F=S(P.v),q=S(z.v);return F===u?1:q===u?-1:F-q};case"descending":return function(P,z){var F=S(P.v),q=S(z.v);return F===u?1:q===u?-1:q-F}}}(_,E)),b=0;b<A;b++)w[b]=L[b].i;return w}(o,a,h.getDataToCoordFunc(e,l,n,a),s),g=p(l.transforms,o),m={};for(r=0;r<f.length;r++){var y=t.nestedProperty(l,f[r]),v=y.get(),T=new Array(s);for(c=0;c<s;c++)T[c]=v[d[c]];y.set(T)}for(c=0;c<s;c++)m[c]=g(d[c]);o._indexToPoints=m,l._length=s}}}},{"../constants/numerical":779,"../lib":803,"../plots/cartesian/axes":854,"./helpers":1402}],1404:[function(i,B,V){V.version="2.3.1"},{}]},{},[27])(27)})})(vh);var Kp=vh.exports;const yc=mh(Kp);var yh={exports:{}};(function(Gn,da){(function(i,B){B(Gn)})(zi,function(i){function B(a,n,s){return n in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s,a}var V=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(a[r]=s[r])}return a};function t(a){if(Array.isArray(a)){for(var n=0,s=Array(a.length);n<a.length;n++)s[n]=a[n];return s}else return Array.from(a)}var h={order:2,precision:2,period:null};function p(a,n){var s=[],r=[];a.forEach(function(m,y){m[1]!==null&&(r.push(m),s.push(n[y]))});var c=r.reduce(function(m,y){return m+y[1]},0),f=c/r.length,d=r.reduce(function(m,y){var v=y[1]-f;return m+v*v},0),g=r.reduce(function(m,y,v){var T=s[v],_=y[1]-T[1];return m+_*_},0);return 1-g/d}function u(a,n){for(var s=a,r=a.length-1,c=[n],f=0;f<r;f++){for(var d=f,g=f+1;g<r;g++)Math.abs(s[f][g])>Math.abs(s[f][d])&&(d=g);for(var m=f;m<r+1;m++){var y=s[m][f];s[m][f]=s[m][d],s[m][d]=y}for(var v=f+1;v<r;v++)for(var T=r;T>=f;T--)s[T][v]-=s[T][f]*s[f][v]/s[f][f]}for(var _=r-1;_>=0;_--){for(var k=0,E=_+1;E<r;E++)k+=s[E][_]*c[E];c[_]=(s[r][_]-k)/s[_][_]}return c}function e(a,n){var s=Math.pow(10,n);return Math.round(a*s)/s}var l={linear:function(n,s){for(var r=[0,0,0,0,0],c=0,f=0;f<n.length;f++)n[f][1]!==null&&(c++,r[0]+=n[f][0],r[1]+=n[f][1],r[2]+=n[f][0]*n[f][0],r[3]+=n[f][0]*n[f][1],r[4]+=n[f][1]*n[f][1]);var d=c*r[2]-r[0]*r[0],g=c*r[3]-r[0]*r[1],m=d===0?0:e(g/d,s.precision),y=e(r[1]/c-m*r[0]/c,s.precision),v=function(k){return[e(k,s.precision),e(m*k+y,s.precision)]},T=n.map(function(_){return v(_[0])});return{points:T,predict:v,equation:[m,y],r2:e(p(n,T),s.precision),string:y===0?"y = "+m+"x":"y = "+m+"x + "+y}},exponential:function(n,s){for(var r=[0,0,0,0,0,0],c=0;c<n.length;c++)n[c][1]!==null&&(r[0]+=n[c][0],r[1]+=n[c][1],r[2]+=n[c][0]*n[c][0]*n[c][1],r[3]+=n[c][1]*Math.log(n[c][1]),r[4]+=n[c][0]*n[c][1]*Math.log(n[c][1]),r[5]+=n[c][0]*n[c][1]);var f=r[1]*r[2]-r[5]*r[5],d=Math.exp((r[2]*r[3]-r[5]*r[4])/f),g=(r[1]*r[4]-r[5]*r[3])/f,m=e(d,s.precision),y=e(g,s.precision),v=function(k){return[e(k,s.precision),e(m*Math.exp(y*k),s.precision)]},T=n.map(function(_){return v(_[0])});return{points:T,predict:v,equation:[m,y],string:"y = "+m+"e^("+y+"x)",r2:e(p(n,T),s.precision)}},logarithmic:function(n,s){for(var r=[0,0,0,0],c=n.length,f=0;f<c;f++)n[f][1]!==null&&(r[0]+=Math.log(n[f][0]),r[1]+=n[f][1]*Math.log(n[f][0]),r[2]+=n[f][1],r[3]+=Math.pow(Math.log(n[f][0]),2));var d=(c*r[1]-r[2]*r[0])/(c*r[3]-r[0]*r[0]),g=e(d,s.precision),m=e((r[2]-g*r[0])/c,s.precision),y=function(_){return[e(_,s.precision),e(e(m+g*Math.log(_),s.precision),s.precision)]},v=n.map(function(T){return y(T[0])});return{points:v,predict:y,equation:[m,g],string:"y = "+m+" + "+g+" ln(x)",r2:e(p(n,v),s.precision)}},power:function(n,s){for(var r=[0,0,0,0,0],c=n.length,f=0;f<c;f++)n[f][1]!==null&&(r[0]+=Math.log(n[f][0]),r[1]+=Math.log(n[f][1])*Math.log(n[f][0]),r[2]+=Math.log(n[f][1]),r[3]+=Math.pow(Math.log(n[f][0]),2));var d=(c*r[1]-r[0]*r[2])/(c*r[3]-Math.pow(r[0],2)),g=(r[2]-d*r[0])/c,m=e(Math.exp(g),s.precision),y=e(d,s.precision),v=function(k){return[e(k,s.precision),e(e(m*Math.pow(k,y),s.precision),s.precision)]},T=n.map(function(_){return v(_[0])});return{points:T,predict:v,equation:[m,y],string:"y = "+m+"x^"+y,r2:e(p(n,T),s.precision)}},polynomial:function(n,s){for(var r=[],c=[],f=0,d=0,g=n.length,m=s.order+1,y=0;y<m;y++){for(var v=0;v<g;v++)n[v][1]!==null&&(f+=Math.pow(n[v][0],y)*n[v][1]);r.push(f),f=0;for(var T=[],_=0;_<m;_++){for(var k=0;k<g;k++)n[k][1]!==null&&(d+=Math.pow(n[k][0],y+_));T.push(d),d=0}c.push(T)}c.push(r);for(var E=u(c,m).map(function(C){return e(C,s.precision)}),A=function(S){return[e(S,s.precision),e(E.reduce(function(P,z,F){return P+z*Math.pow(S,F)},0),s.precision)]},b=n.map(function(C){return A(C[0])}),L="y = ",w=E.length-1;w>=0;w--)w>1?L+=E[w]+"x^"+w+" + ":w===1?L+=E[w]+"x + ":L+=E[w];return{string:L,points:b,predict:A,equation:[].concat(t(E)).reverse(),r2:e(p(n,b),s.precision)}}};function o(){var a=function(s,r){return V({_round:e},s,B({},r,function(c,f){return l[r](c,V({},h,f))}))};return Object.keys(l).reduce(a,{})}i.exports=o()})})(yh);var Qp=yh.exports;const $p=mh(Qp);function gh(Gn){let da=0,i=0;for(let B=0;B<Gn.length;B++){const V=Gn[B]-i,t=da+V;i=t-da-V,da=t}return da}function ed(Gn,da){return gh(Gn.map((i,B)=>i*da[B]))/gh(Gn.map(i=>i*i))}function td(Gn,da){const i=Gn.reduce((l,o)=>l+o,0)/Gn.length,B=da.reduce((l,o)=>l+o,0)/da.length,V=Gn.reduce((l,o)=>Math.max(l,Math.abs(o-i)),0),t=da.reduce((l,o)=>Math.max(l,Math.abs(o-B)),0),h=Gn.map((l,o)=>[(l-i)/V,(da[o]-B)/t]),p=$p.linear(h),[u,e]=p.equation;return[u*t/V,e*t-u*i*t/V+B]}function rd(Gn,da){return da.slice(2).map((i,B)=>(i-da[B])/(Gn[B+2]-Gn[B]))}const Uu=65536;function nd(Gn,da){let i=Gn&65535;return i+=i%20/4*Uu,i+=Math.round((da-i)/(5*Uu))*5*Uu,i}function Xl(Gn,da,i){if(Gn.length!==da.length||Gn.length!==i.length)throw new Error(`${Gn.length} !== ${da.length} !== ${i.length}`);return rd(Gn,da).map((B,V)=>nd(i[V+1],B))}async function bl(Gn,da,i,B,V){if(da.length!==i.length)throw new Error(`${da.length} !== ${i.length}`);const t="#777",h="#bbb";let p=da.map(()=>!0);function u(k,E){return B.intercept===void 0?[ed(k,E),0]:td(k,E)}const[e,l]=u(da,i);V&&V(e,l);const o=da.reduce((k,E)=>Math.min(k,E),0),a=da.reduce((k,E)=>Math.max(k,E),0),n=document.createElement("div"),s=Math.max(0,window.innerWidth-50),r=await yc.newPlot(n,[{type:"scatter",mode:"markers",x:da,y:i,name:"Samples",marker:{color:p.map(k=>k?t:h),size:5}},{type:"scatter",mode:"lines",x:[o,a],y:[e*o+l,e*a+l],name:"Regression Line",line:{color:"red"}}],{title:B.title||"",dragmode:"select",showlegend:!1,hovermode:!1,width:s,height:s*9/16,xaxis:{title:{text:B.xLabel||""}},yaxis:{title:{text:B.yLabel||""}}},{modeBarButtonsToRemove:[]}),c=document.createElement("p");function f(k,E){c.innerText=`${B.slope||"slope"}: ${k}, ${B.intercept||"y-intercept"}: ${E}`}f(e,l);function d(){yc.restyle(n,"marker.color",[p.map(L=>L?t:h)],[0]);const[k,E]=u(da.filter((L,w)=>p[w]),i.filter((L,w)=>p[w]));f(k,E),V&&V(k,E);const A=da.reduce((L,w)=>Math.min(L,w)),b=da.reduce((L,w)=>Math.max(L,w));yc.restyle(n,{x:[[A,b]],y:[[k*A+E,k*b+E]]},[1])}let g=null;r.on("plotly_selected",function(k){k!==void 0&&(g=k)});function m(k){if(g===null)return!1;for(const E of g.points)p[E.pointIndex]=k;return yc.restyle(n,{selectedpoints:[null]},[0]),g=null,!0}const y=document.createElement("button");y.innerText="[i]nclude",y.addEventListener("click",()=>{m(!0)&&d()});const v=document.createElement("button");for(v.innerText="[e]xclude",v.addEventListener("click",()=>{m(!1)&&d()}),document.addEventListener("keydown",k=>{if(k.key==="i"){if(!m(!0))return;d()}else if(k.key==="e"){if(!m(!1))return;d()}});Gn.firstChild;)Gn.removeChild(Gn.firstChild);const T=document.createElement("div");T.appendChild(y),T.appendChild(v);const _=document.createElement("div");return _.setAttribute("class","bar"),_.appendChild(T),_.appendChild(c),Gn.appendChild(_),Gn.appendChild(n),function(k,E){if(k.length!==E.length)throw new Error(`${k.length} !== ${E.length}`);da=k,i=E,p=da.map(()=>!0),yc.restyle(n,{x:[da],y:[i]},[0]),d()}}function xh(Gn){const da=Gn.angVels.reduce((i,B,V)=>{const t=B.values.slice(0,-1),h=t.reduce((a,n)=>Math.max(a,n),0),p=t.reduce((a,n)=>Math.max(a,n),0),[u,e,l,o]=i;if(h>=-p){if(h>=u)return[h,V,!1,t]}else if(-p>=u)return[-p,V,!0,t];return i},[0,-1,!1,[]]);if(da[1]!==2||da[2]!==!1)throw new Error(`More rotation about the ${da[2]?"-":"+"}${["x","y","z"][da[1]]}-axis than the +z-axis. Fix the IMU orientation and run again.`);return da[3]}async function ad(Gn){const da=xh(Gn),i=document.getElementById("deadWheelCharts");Gn.parEncVels.forEach((h,p)=>{const u=document.createElement("div");bl(u,da.slice(1,-1),Xl(h.times.slice(0,-1),Gn.parEncPositions[p].values.slice(0,-1),h.values.slice(0,-1)),{title:`Parallel Wheel ${p} Regression`,slope:"y-position",xLabel:"angular velocity [rad/s]",yLabel:"wheel velocity [ticks/s]"}),i.appendChild(u)}),Gn.perpEncVels.forEach((h,p)=>{const u=document.createElement("div");bl(u,da.slice(1,-1),Xl(h.times.slice(0,-1),Gn.perpEncPositions[p].values.slice(0,-1),h.values.slice(0,-1)),{title:`Perpendicular Wheel ${p} Regression`,slope:"x-position",xLabel:"angular velocity [rad/s]",yLabel:"wheel velocity [ticks/s]"}),i.appendChild(u)});const B=await(async()=>{const h=[...Gn.leftPowers,...Gn.rightPowers],p=Gn.voltages.values.slice(0,-1).map((e,l)=>h.reduce((o,a)=>Math.max(o,a.values[l]),0)*e),u=await bl(document.getElementById("trackWidthChart"),[],[],{title:"Track Width Regression",slope:"track width",xLabel:"angular velocity [rad/s]",yLabel:"wheel velocity [ticks/s]"});return(e,l)=>u(da,p.map(o=>(o-l)/e*(Gn.type==="mecanum"?2:1)))})(),V=document.getElementById("kv"),t=document.getElementById("ks");return document.getElementById("update").addEventListener("click",()=>{B(parseFloat(V.value),parseFloat(t.value))}),B(parseFloat(V.value),parseFloat(t.value)),[]}async function id(Gn){const da=Gn.leftEncVels.map((V,t)=>Xl(V.times.slice(0,-1),Gn.leftEncPositions[t].values.slice(0,-1),V.values.slice(0,-1))),i=Gn.rightEncVels.map((V,t)=>Xl(V.times.slice(0,-1),Gn.rightEncPositions[t].values.slice(0,-1),V.values.slice(0,-1)));await bl(document.getElementById("rampChart"),[...da.flatMap(V=>V.map(t=>-t)),...i.flatMap(V=>V)],[...Gn.leftPowers.flatMap(V=>V.values.slice(0,-1).map((h,p)=>-h*Gn.voltages.values[p]).slice(1,-1)),...Gn.rightPowers.flatMap(V=>V.values.slice(0,-1).map((h,p)=>h*Gn.voltages.values[p]).slice(1,-1))],{title:"Angular Ramp Regression",slope:"kV",intercept:"kS",xLabel:"wheel velocity [ticks/s]",yLabel:"applied voltage [V]"});const B=xh(Gn).slice(1,-1);return await bl(document.getElementById("trackWidthChart"),B,B.map((V,t)=>(da.reduce((h,p)=>h-p[t],0)/Gn.leftEncVels.length+i.reduce((h,p)=>h+p[t],0)/Gn.rightEncVels.length)*(Gn.type==="mecanum"?.5:1)),{title:"Track Width Regression",slope:"track width",xLabel:"angular velocity [rad/s]",yLabel:"wheel velocity [ticks/s]"}),[]}async function od(Gn){const da=Gn.forwardEncVels.flatMap((B,V)=>Xl(B.times.slice(0,-1),Gn.forwardEncPositions[V].values.slice(0,-1),B.values.slice(0,-1))),i=Gn.forwardEncVels.flatMap(()=>{const B=Gn.voltages.values.slice(0,-1).map((V,t)=>Gn.powers.reduce((h,p)=>Math.max(h,p.values[t]),0)*V);return B.slice(1,B.length-1)});return await bl(document.getElementById("rampChart"),da,i,{title:"Forward Ramp Regression",slope:"kV",intercept:"kS",xLabel:"forward velocity [ticks/s]",yLabel:"applied voltage [V]"}),[]}async function sd(Gn){const da=Gn.perpEncVels.flatMap((e,l)=>Xl(e.times.slice(0,-1),Gn.perpEncPositions[l].values.slice(0,-1),e.values.slice(0,-1))),i=Gn.perpEncVels.flatMap(()=>{const e=Gn.voltages.values.slice(0,-1).map((l,o)=>Math.max(-Gn.frontLeftPower.values[o],Gn.backLeftPower.values[o],Gn.frontRightPower.values[o],-Gn.backRightPower.values[o],0)*l);return e.slice(1,e.length-1)}),B=await(async()=>{const e=await bl(document.getElementById("rampChart"),[],[],{title:"Lateral Ramp Regression",slope:"lateral in per tick",xLabel:"expected velocity from feedforward [ticks/s]",yLabel:"actual velocity [in/s]"});return(l,o,a)=>{const n=i.map(r=>(r-a)/o),s=da.map(r=>r*l);e(n,s)}})(),V=document.getElementById("inPerTick"),t=document.getElementById("kv"),h=document.getElementById("ks");document.getElementById("update").addEventListener("click",()=>{B(parseFloat(V.value),parseFloat(t.value),parseFloat(h.value))}),B(parseFloat(V.value),parseFloat(t.value),parseFloat(h.value));const p=da.reduce((e,l)=>Math.min(e,l),0),u=da.reduce((e,l)=>Math.max(e,Math.abs(l)),0);return-p>.2*u?["Warning: Lateral velocity should not go negative. Make sure the robot is pushed rightward and the encoders are oriented correctly."]:[]}function ld(Gn,da){document.getElementById("latest").addEventListener("click",async function(){document.getElementById("error").innerText="",document.getElementById("warning").innerText="";try{const V=await fetch(`/tuning/${Gn}/latest.json`);if(V.ok){const t=V.headers.get("X-Filename"),h=document.createElement("a");h.innerText="Download",h.href=`/tuning/${Gn}/${t}`,h.download=`${Gn}-${t}`;const p=document.getElementById("download");p.innerHTML="",p.appendChild(h);const u=await V.json(),e=await da(u);e.length>0&&(document.getElementById("warning").innerText=e.join(`
`))}else throw new Error("No data files found")}catch(V){console.error(V),typeof V=="string"?document.getElementById("error").innerText=V:V instanceof Error&&(document.getElementById("error").innerText=V.message)}});const B=document.getElementById("browse");B.addEventListener("change",function(){const V=new FileReader;V.onload=async function(){if(typeof V.result=="string"){document.getElementById("error").innerText="",document.getElementById("warning").innerText="";try{const t=await da(JSON.parse(V.result.trim()));t.length>0&&(document.getElementById("warning").innerText=t.join(`
`))}catch(t){console.error(t),typeof t=="string"?document.getElementById("error").innerText=t:t instanceof Error&&(document.getElementById("error").innerText=t.message)}}},V.readAsText(B.files[0])})}export{id as a,od as b,sd as c,ld as i,ad as l};
